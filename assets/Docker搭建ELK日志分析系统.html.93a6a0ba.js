import{_ as l}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as i,c as o,a as n,b as s,e,d as t,r as c}from"./app.51ad39b7.js";const p={},u=t('<h1 id="docker\u642D\u5EFAelk\u65E5\u5FD7\u5206\u6790\u7CFB\u7EDF" tabindex="-1"><a class="header-anchor" href="#docker\u642D\u5EFAelk\u65E5\u5FD7\u5206\u6790\u7CFB\u7EDF" aria-hidden="true">#</a> Docker\u642D\u5EFAELK\u65E5\u5FD7\u5206\u6790\u7CFB\u7EDF</h1><h2 id="\u65B9\u6CD5\u4E00" tabindex="-1"><a class="header-anchor" href="#\u65B9\u6CD5\u4E00" aria-hidden="true">#</a> \u65B9\u6CD5\u4E00</h2><ul><li><p>ElasticSearch \u6709\u5F3A\u5927\u7684\u641C\u7D22\u529F\u80FD\u7684\u65E0\u6A21\u5F0F\u6570\u636E\u5E93\uFF0C\u53EF\u4EE5\u7B80\u5355\u7684\u5F88\u60F3\u6269\u5C55\uFF0C\u7D22\u5F15\u6BCF\u4E00\u4E2A\u5B57\u6BB5\uFF0C\u53EF\u4EE5\u805A\u5408\u5206\u7EC4\u6570\u636E\u3002</p></li><li><p>Logstash \u7528Ruby\u7F16\u5199\u7684\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528\u7BA1\u9053\u8F93\u5165\u548C\u8F93\u51FA\u6570\u636E\u5230\u4EFB\u4F55\u4F4D\u7F6E\u3002\u4E00\u4E2A\u53EF\u4EE5\u6293\u53D6\uFF0C\u8F6C\u6362\uFF0C\u5B58\u50A8\u4E8B\u4EF6\u5230ElasticSearch\u7684ETL\u7BA1\u9053\u3002\u6253\u5305\u7248\u672C\u5728JRuby\u4E0A\u8FD0\u884C\uFF0C\u5E76\u4F7F\u7528\u51E0\u5341\u4E2A\u7EBF\u7A0B\u8FDB\u884C\u5E76\u884C\u7684\u6570\u636E\u5904\u7406\uFF0C\u5229\u7528\u4E86JVM\u7684\u7EBF\u7A0B\u529F\u80FD\u3002</p></li><li><p>Kibana \u57FA\u4E8Eweb\u7684\u6570\u636E\u5206\u6790\uFF0C\u4E3AElasticSearch\u4EEA\u8868\u677F\u7684\u5DE5\u5177\u3002\u5145\u5206\u5229\u7528ElasticSearch\u7684\u641C\u7D22\u529F\u80FD\uFF0C\u4EE5\u79D2\u4E3A\u5355\u4F4D\u53EF\u89C6\u5316\u6570\u636E\u3002\u652F\u6301Lucene\u7684\u67E5\u8BE2\u5B57\u7B26\u4E32\u7684\u8BED\u6CD5\u548CElasticsearch\u7684\u8FC7\u6EE4\u529F\u80FD\u3002</p></li></ul><h3 id="\u524D\u63D0" tabindex="-1"><a class="header-anchor" href="#\u524D\u63D0" aria-hidden="true">#</a> \u524D\u63D0</h3><ul><li>\u672C\u6587\u4E2D\u67B6\u6784\u57FA\u4E8Edocker\u642D\u5EFA\uFF0C\u9700\u8981\u60A8\u4E86\u89E3docker\u7684\u57FA\u672C\u6982\u5FF5\uFF0C\u57FA\u672C\u64CD\u4F5C\u548Cdocker1.9\u4E4B\u540E\u7684\u81EA\u5B9A\u4E49overlay\u7F51\u7EDC</li></ul>',5),r={href:"https://hub.docker.com/_/elasticsearch/",target:"_blank",rel:"noopener noreferrer"},d=t(`<h3 id="docker\u642D\u5EFAelk\u7684javaweb\u5E94\u7528\u65E5\u5FD7\u6536\u96C6\u5B58\u50A8\u5206\u6790\u7CFB\u7EDF" tabindex="-1"><a class="header-anchor" href="#docker\u642D\u5EFAelk\u7684javaweb\u5E94\u7528\u65E5\u5FD7\u6536\u96C6\u5B58\u50A8\u5206\u6790\u7CFB\u7EDF" aria-hidden="true">#</a> Docker\u642D\u5EFAELK\u7684javaweb\u5E94\u7528\u65E5\u5FD7\u6536\u96C6\u5B58\u50A8\u5206\u6790\u7CFB\u7EDF</h3><h3 id="\u7B2C\u4E00\u6B65-\u542F\u52A8elasticsearch" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u4E00\u6B65-\u542F\u52A8elasticsearch" aria-hidden="true">#</a> \u7B2C\u4E00\u6B65\uFF1A\u542F\u52A8elasticsearch</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>docker run -d --name myes  \\
           --net=multihost --ip=192.168.2.51 \\
           elasticsearch:2.3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u91C7\u7528docker\u81EA\u5B9A\u4E49overlay\u7F51\u7EDCmultihost\uFF0C\u8BBE\u7F6E\u5BB9\u5668ip\u4E3A192.168.2.51</li></ul><h3 id="\u7B2C\u4E8C\u6B65-\u542F\u52A8kibana" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u4E8C\u6B65-\u542F\u52A8kibana" aria-hidden="true">#</a> \u7B2C\u4E8C\u6B65\uFF1A\u542F\u52A8kibana</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>docker run --name mykibana \\
      -e ELASTICSEARCH_URL=http://192.168.2.51:9200 \\
      --net=multihost \\
      -p 5601:5601 \\
      -d kibana:4.5
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u91C7\u7528\u81EA\u5B9A\u4E49\u7F51\u7EDCmultihost\uFF0Cip\u968F\u673A\u5206\u914D</li><li>\u5728\u5BBF\u4E3B\u673A\u542F\u52A8kibana\uFF0C\u5BB9\u5668\u7AEF\u53E35601\u6620\u5C04\u5230\u5BBF\u4E3B\u673A\u7AEF\u53E35601\uFF0C\u53EF\u4EE5\u901A\u8FC7http://&lt;\u5BBF\u4E3B\u673Aip&gt;:5601\u8BBF\u95EEkibana</li><li>\u53C2\u6570ELASTICSEARCH_URL\u6307\u5411\u7B2C\u4E00\u6B65\u4E2D\u542F\u52A8\u7684elasticsearch</li></ul><h3 id="\u7B2C\u4E09\u6B65-logstash\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u4E09\u6B65-logstash\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> \u7B2C\u4E09\u6B65\uFF1Alogstash\u914D\u7F6E\u6587\u4EF6</h3><ul><li>logstash.conf,\u8FD9\u4E2A\u6587\u4EF6\u540D\u5B57\u53EF\u4EE5\u968F\u4FBF\u8D77</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>input { 
  log4j {
    mode =&gt; &quot;server&quot;
    host =&gt; &quot;0.0.0.0&quot;
    port =&gt; 3456
    type =&gt; &quot;log4j&quot;
  }
}
output {
  elasticsearch { hosts =&gt; [&quot;192.168.2.51&quot;] }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u8F93\u5165\u6A21\u5F0Flog4j\u7684\u670D\u52A1\uFF0C\u76D1\u542C\u4E8E\u5F53\u524D\u5BB9\u5668\u76843456\u7AEF\u53E3\u3002\u4E5F\u5C31\u662F\u6570\u636E\u6E90\u9700\u8981\u5411\u5BB9\u5668\u76843456\u7AEF\u53E3\u53D1\u9001\u65E5\u5FD7\u3002</li></ul><h3 id="\u7B2C\u56DB\u6B65-\u542F\u52A8logstash" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u56DB\u6B65-\u542F\u52A8logstash" aria-hidden="true">#</a> \u7B2C\u56DB\u6B65\uFF1A\u542F\u52A8logstash</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>docker run  -d \\
            -v &quot;$PWD&quot;:/config-dir \\
            -p 3456:3456 \\
            --net multihost \\
            logstash:2.3 \\
            logstash -f /config-dir/logstash.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u91C7\u7528\u81EA\u5B9A\u4E49\u7F51\u7EDCmultihost\uFF0Cip\u968F\u673A\u5206\u914D</li><li>\u5728\u5BBF\u4E3B\u673A\u542F\u52A8logstash\uFF0C\u5BB9\u5668\u7AEF\u53E33456\u6620\u5C04\u5230\u5BBF\u4E3B\u673A\u7AEF\u53E33456.(\u8FD9\u4E48\u505A\u662F\u5047\u8BBE\u60A8\u7684\u5E94\u7528\u4E0D\u662Fdocker\u5316\u7684\uFF0C\u6240\u4EE5ip\u4E0D\u5728\u81EA\u5B9A\u4E49\u7F51\u7EDCmultihost\u5185.\u5982\u679Cweb\u5E94\u7528docker\u5316\uFF0C\u5E76\u4E0Elogstash\u5171\u540C\u4F7F\u7528\u540C\u4E00\u4E2A\u81EA\u5B9A\u4E49\u7F51\u7EDC\uFF0C\u5219\u7AEF\u53E3\u4E0D\u9700\u8981\u5BF9\u5916\u6620\u5C04)</li><li>\u5BB9\u5668\u914D\u7F6E\u6587\u4EF6/config-dir/logstash.conf\u6620\u5C04\u5230\u5BBF\u4E3B\u673A\u5F53\u524D\u76EE\u5F55\u4E0B\u9762\u3002\u5373\u4F60\u9700\u8981\u5C06logstash.conf\u653E\u5230\u5F53\u524D\u76EE\u5F55&quot;$PWD&quot;\u4E0B\u542F\u52A8\u3002\uFF08\u8FD9\u4E2A\u76EE\u5F55\u53EF\u4EE5\u8C03\u6574\uFF09</li></ul><h3 id="\u7B2C\u4E94\u6B65-web\u5E94\u7528log4j\u65E5\u5FD7tcp\u8F93\u51FA" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u4E94\u6B65-web\u5E94\u7528log4j\u65E5\u5FD7tcp\u8F93\u51FA" aria-hidden="true">#</a> \u7B2C\u4E94\u6B65\uFF1Aweb\u5E94\u7528log4j\u65E5\u5FD7TCP\u8F93\u51FA</h3><ul><li>\u4E3Alog4j.properties\u6DFB\u52A0tcp\u8F93\u51FA\uFF0C\u4EE3\u7801\u7247\u6BB5\u5982\u4E0B\uFF1A</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>log4j.rootLogger = DEBUG,tcp

log4j.appender.tcp=org.apache.log4j.net.SocketAppender
log4j.appender.tcp.Port=3456
log4j.appender.tcp.RemoteHost=192.168.1.158
log4j.appender.tcp.ReconnectionDelay=10000
log4j.appender.tcp.Application=ssmm
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>RemoteHost\u662Flogstash\u6240\u5728\u7684\u5BBF\u4E3B\u673Aip.\u5982\u679C\u60A8\u7684web\u5E94\u7528docker\u5316\uFF0C\u53EF\u4EE5\u662F\u5BB9\u5668ip</li><li>\u53D1\u9001\u65E5\u5FD7\u52303456\u7AEF\u53E3</li></ul><blockquote><p>\u6700\u91CD\u8981\u7684\u4E8B\u4E0D\u8981\u5FD8\u4E86\uFF0C\u542F\u52A8\u60A8\u7684web\u5E94\u7528\u3002\u65E5\u5FD7\u624D\u80FD\u53D1\u8FC7\u53BB\uFF01</p></blockquote><h2 id="\u65B9\u6CD5\u4E8C" tabindex="-1"><a class="header-anchor" href="#\u65B9\u6CD5\u4E8C" aria-hidden="true">#</a> \u65B9\u6CD5\u4E8C</h2><h3 id="\u5199\u5728\u524D\u9762" tabindex="-1"><a class="header-anchor" href="#\u5199\u5728\u524D\u9762" aria-hidden="true">#</a> \u5199\u5728\u524D\u9762</h3>`,21),k={href:"https://github.com/deviantony/docker-elk",target:"_blank",rel:"noopener noreferrer"},v=t(`<p>\u7528\u4E8E\u5F00\u53D1\u6D4B\u8BD5\u7684\u57FA\u7840\u73AF\u5883\u4F7F\u7528\u4E00\u53F01c2g\u7684\u865A\u62DF\u673A\u5373\u53EF\uFF0C\u5F53\u7136\u673A\u5668\u8D44\u6E90\u8D8A\u591A\u6211\u4EEC\u7684\u670D\u52A1\u8FD0\u884C\u6548\u7387\u4E5F\u4F1A\u8D8A\u9AD8\u3001\u76F8\u540C\u65F6\u95F4\u5185\u6570\u636E\u5904\u7406\u80FD\u529B\u4E5F\u5C31\u8D8A\u5927\u3002\u800C\u7528\u4E8E\u4E00\u822C\u751F\u4EA7\u73AF\u5883\u5EFA\u8BAE\u6839\u636E\u81EA\u5DF1\u5177\u4F53\u60C5\u51B5\u7ED9\u4E88\u66F4\u591A\u8D44\u6E90\u3002</p><p>\u5148\u804A\u804A\u6D4B\u8BD5\u73AF\u5883\u642D\u5EFA\u3002</p><h3 id="\u6D4B\u8BD5\u5F00\u53D1\u73AF\u5883" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u5F00\u53D1\u73AF\u5883" aria-hidden="true">#</a> \u6D4B\u8BD5\u5F00\u53D1\u73AF\u5883</h3><p>\u4F7F\u7528 Git Clone \u547D\u4EE4\u5C06\u9879\u76EE\u4E0B\u8F7D\u5230\u6240\u9700\u8981\u7684\u4F4D\u7F6E\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>git clone https://github.com/deviantony/docker-elk.git /app/docker-elk

Cloning into &#39;/app/docker-elk&#39;...
remote: Enumerating objects: 1729, done.
remote: Total 1729 (delta 0), reused 0 (delta 0), pack-reused 1729
Receiving objects: 100% (1729/1729), 410.25 KiB | 11.00 KiB/s, done.
Resolving deltas: 100% (705/705), done.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u542F\u52A8\u9879\u76EE\u524D\uFF0C\u6211\u4EEC\u5148\u4E86\u89E3\u4E0B\u57FA\u7840\u7684\u76EE\u5F55\u7ED3\u6784\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u251C\u2500\u2500 docker-compose.yml
\u251C\u2500\u2500 docker-stack.yml
\u251C\u2500\u2500 elasticsearch
\u2502   \u251C\u2500\u2500 config
\u2502   \u2502   \u2514\u2500\u2500 elasticsearch.yml
\u2502   \u2514\u2500\u2500 Dockerfile
\u251C\u2500\u2500 extensions
\u2502   \u251C\u2500\u2500 apm-server
\u2502   \u251C\u2500\u2500 app-search
\u2502   \u251C\u2500\u2500 curator
\u2502   \u251C\u2500\u2500 logspout
\u251C\u2500\u2500 kibana
\u2502   \u251C\u2500\u2500 config
\u2502   \u2502   \u2514\u2500\u2500 kibana.yml
\u2502   \u2514\u2500\u2500 Dockerfile
\u251C\u2500\u2500 LICENSE
\u251C\u2500\u2500 logstash
\u2502   \u251C\u2500\u2500 config
\u2502   \u2502   \u2514\u2500\u2500 logstash.yml
\u2502   \u251C\u2500\u2500 Dockerfile
\u2502   \u2514\u2500\u2500 pipeline
\u2502       \u2514\u2500\u2500 logstash.conf
\u2514\u2500\u2500 README.md
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u6E05\u695A\u770B\u5230\uFF0C\u9879\u76EE\u4E3B\u8981\u4F7F\u7528\u6839\u76EE\u5F55\u7684 <strong>docker-compose.yml</strong> \u4F5C\u4E3A\u542F\u52A8\u914D\u7F6E\uFF0C\u5E76\u5728\u9996\u6B21\u542F\u52A8\u65F6\uFF0C\u6784\u5EFA\u76F8\u5173\u670D\u52A1\u7684\u5BB9\u5668\u955C\u50CF\u3002</p><p>\u4E86\u89E3\u4E86\u9879\u76EE\u5DE5\u4F5C\u65B9\u5F0F\u540E\uFF0C\u53EF\u4EE5\u4F7F\u7528 <code>docker-compose up</code> \u6765\u542F\u52A8\u9879\u76EE\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker-compose</span> up

Creating network <span class="token string">&quot;docker-elk_elk&quot;</span> with driver <span class="token string">&quot;bridge&quot;</span>
Creating volume <span class="token string">&quot;docker-elk_elasticsearch&quot;</span> with default driver
Building elasticsearch
Step <span class="token number">1</span>/2 <span class="token builtin class-name">:</span> ARG ELK_VERSION
Step <span class="token number">2</span>/2 <span class="token builtin class-name">:</span> FROM docker.elastic.co/elasticsearch/elasticsearch:<span class="token variable">\${ELK_VERSION}</span>
<span class="token number">7.6</span>.2: Pulling from elasticsearch/elasticsearch
c808caf183b6: Downloading <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">&gt;</span>                                                <span class="token punctuation">]</span>  <span class="token number">3</span>.736MB/85.21MB
d6caf8e15a64: Downloading <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span>                               <span class="token punctuation">]</span>  <span class="token number">13</span>.69MB/34.71MB
b0ba5f324e82: Download complete
d7e8c1e99b9a: Downloading <span class="token punctuation">[</span><span class="token operator">=</span><span class="token operator">&gt;</span>                                                 <span class="token punctuation">]</span>  <span class="token number">11</span>.71MB/321.6MB
85c4d6c81438: Waiting
3119218fac98: Waiting
914accf214bb: Waiting
<span class="token punctuation">..</span>.

Creating docker-elk_elasticsearch_1 <span class="token punctuation">..</span>. <span class="token keyword">done</span>
Creating docker-elk_logstash_1      <span class="token punctuation">..</span>. <span class="token keyword">done</span>
Creating docker-elk_kibana_1        <span class="token punctuation">..</span>. <span class="token keyword">done</span>
Attaching to docker-elk_elasticsearch_1, docker-elk_logstash_1, docker-elk_kibana_1
logstash_1       <span class="token operator">|</span> OpenJDK <span class="token number">64</span>-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated <span class="token keyword">in</span> version <span class="token number">9.0</span> and will likely be removed <span class="token keyword">in</span> a future release.
elasticsearch_1  <span class="token operator">|</span> Created elasticsearch keystore <span class="token keyword">in</span> /usr/share/elasticsearch/config
logstash_1       <span class="token operator">|</span> WARNING: An illegal reflective access operation has occurred
logstash_1       <span class="token operator">|</span> WARNING: Illegal reflective access by com.headius.backport9.modules.Modules <span class="token punctuation">(</span>file:/usr/share/logstash/logstash-core/lib/jars/jruby-complete-9.2.9.0.jar<span class="token punctuation">)</span> to method sun.nio.ch.NativeThread.signal<span class="token punctuation">(</span>long<span class="token punctuation">)</span>
logstash_1       <span class="token operator">|</span> WARNING: Please consider reporting this to the maintainers of com.headius.backport9.modules.Modules
logstash_1       <span class="token operator">|</span> WARNING: Use --illegal-access<span class="token operator">=</span>warn to <span class="token builtin class-name">enable</span> warnings of further illegal reflective access operations
logstash_1       <span class="token operator">|</span> WARNING: All illegal access operations will be denied <span class="token keyword">in</span> a future release
elasticsearch_1  <span class="token operator">|</span> OpenJDK <span class="token number">64</span>-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated <span class="token keyword">in</span> version <span class="token number">9.0</span> and will likely be removed <span class="token keyword">in</span> a future release.
elasticsearch_1  <span class="token operator">|</span> <span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;server&quot;</span>, <span class="token string">&quot;timestamp&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2020-05-03T03:47:40,483Z&quot;</span>, <span class="token string">&quot;level&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;INFO&quot;</span>, <span class="token string">&quot;component&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;o.e.e.NodeEnvironment&quot;</span>, <span class="token string">&quot;cluster.name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;docker-cluster&quot;</span>, <span class="token string">&quot;node.name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0d05db8360df&quot;</span>, <span class="token string">&quot;message&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;using [1] data paths, mounts [[/usr/share/elasticsearch/data (/dev/sda2)]], net usable_space [83.6gb], net total_space [97.9gb], types [ext4]&quot;</span> <span class="token punctuation">}</span>
elasticsearch_1  <span class="token operator">|</span> <span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;server&quot;</span>, <span class="token string">&quot;timestamp&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2020-05-03T03:47:40,493Z&quot;</span>, <span class="token string">&quot;level&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;INFO&quot;</span>, <span class="token string">&quot;component&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;o.e.e.NodeEnvironment&quot;</span>, <span class="token string">&quot;cluster.name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;docker-cluster&quot;</span>, <span class="token string">&quot;node.name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0d05db8360df&quot;</span>, <span class="token string">&quot;message&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;heap size [247.5mb], compressed ordinary object pointers [true]&quot;</span> <span class="token punctuation">}</span>
kibana_1         <span class="token operator">|</span> <span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;log&quot;</span>,<span class="token string">&quot;@timestamp&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;2020-05-03T03:47:40Z&quot;</span>,<span class="token string">&quot;tags&quot;</span>:<span class="token punctuation">[</span><span class="token string">&quot;info&quot;</span>,<span class="token string">&quot;plugins-service&quot;</span><span class="token punctuation">]</span>,<span class="token string">&quot;pid&quot;</span>:6,<span class="token string">&quot;message&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Plugin <span class="token entity" title="\\&quot;">\\&quot;</span>case<span class="token entity" title="\\&quot;">\\&quot;</span> is disabled.&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u542F\u52A8\u8FC7\u7A0B\u4E2D\u7684\u65E5\u5FD7\u4F1A\u7C7B\u4F3C\u4E0A\u9762\u8FD9\u6837\uFF0C\u56E0\u4E3A\u9996\u6B21\u542F\u52A8\u9700\u8981\u4ECE\u5B98\u7F51\u955C\u50CF\u4ED3\u5E93\u4E2D\u4E0B\u8F7D\u76F8\u5173\u955C\u50CF\uFF0C\u6240\u4EE5\u4F1A\u6162\u4E00\u4E9B\u3002\u5F53\u4F60\u770B\u5230\u7EC8\u7AEF\u8F93\u51FA\u7C7B\u4F3C\u4E0A\u9762\u7684\u65E5\u5FD7\u65F6\uFF0C\u8BF4\u660E\u670D\u52A1\u5DF2\u7ECF\u542F\u52A8\u5B8C\u6BD5\u3002</p><p>\u4E3A\u4E86\u9A8C\u8BC1\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528\u6D4F\u89C8\u5668\u6216\u8005 curl \u7B49\u5DE5\u5177\u8BBF\u95EE\u673A\u5668\u5730\u5740\u52A0\u7AEF\u53E3\u53F7 9200\uFF0C\u5E76\u4F7F\u7528\u9ED8\u8BA4\u7528\u6237\u540D <code>elastic</code> \u548C\u9ED8\u8BA4\u5BC6\u7801 <code>changeme</code> \u6765\u8BBF\u95EE Elasticsearch HTTP \u7AEF\u53E3\uFF0C\u5982\u679C\u4E00\u5207\u6B63\u5E38\uFF0C\u4F60\u5C06\u770B\u5230\u7C7B\u4F3C\u4E0B\u9762\u7684\u7ED3\u679C\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;0d05db8360df&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;cluster_name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;docker-cluster&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;cluster_uuid&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Mq2EZX59TqW7ysGx7Y-jIw&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;number&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;7.6.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build_flavor&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;docker&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build_hash&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build_date&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2020-03-26T06:34:37.794943Z&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build_snapshot&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lucene_version&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;8.4.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;minimum_wire_compatibility_version&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;6.8.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;minimum_index_compatibility_version&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;6.0.0-beta1&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;tagline&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;You Know, for Search&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u73B0\u5728\u4E0D\u7740\u6025\u8BBF\u95EE Kibana \uFF0C\u6211\u4EEC\u7EE7\u7EED\u8FDB\u884C\u914D\u7F6E\u8C03\u6574\u3002</p><h3 id="\u91CD\u7F6E\u5185\u5EFA\u7528\u6237\u5BC6\u7801" tabindex="-1"><a class="header-anchor" href="#\u91CD\u7F6E\u5185\u5EFA\u7528\u6237\u5BC6\u7801" aria-hidden="true">#</a> \u91CD\u7F6E\u5185\u5EFA\u7528\u6237\u5BC6\u7801</h3><p>\u4F7F\u7528 <code>docker-compose exec -T elasticsearch bin/elasticsearch-setup-passwords auto --batch</code> \u547D\u4EE4\u5BF9\u670D\u52A1\u9ED8\u8BA4\u7684\u8D26\u6237\u8FDB\u884C\u9ED8\u8BA4\u5BC6\u7801\u91CD\u7F6E\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker-compose</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-T</span> elasticsearch bin/elasticsearch-setup-passwords auto <span class="token parameter variable">--batch</span>

Changed password <span class="token keyword">for</span> user apm_system
PASSWORD apm_system <span class="token operator">=</span> YkELBJGOT6AxqsPqsi7I

Changed password <span class="token keyword">for</span> user kibana
PASSWORD kibana <span class="token operator">=</span> FxRwjm5KRYvHhGEnYTM9

Changed password <span class="token keyword">for</span> user logstash_system
PASSWORD logstash_system <span class="token operator">=</span> A4f5VOfjVWSdi0KAZWGu

Changed password <span class="token keyword">for</span> user beats_system
PASSWORD beats_system <span class="token operator">=</span> QnW8xxhnn7LMlA7vuI7B

Changed password <span class="token keyword">for</span> user remote_monitoring_user
PASSWORD remote_monitoring_user <span class="token operator">=</span> OvjEGR13wjkOkIbWqaEM

Changed password <span class="token keyword">for</span> user elastic
PASSWORD elastic <span class="token operator">=</span> PGevNMuv7PhVnaYg7vJw
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5C06\u5BC6\u7801\u59A5\u5584\u4FDD\u5B58\u540E\uFF0C\u6211\u4EEC\u9700\u8981\u5C06 <code>docker-compose.yml</code> \u914D\u7F6E\u6587\u4EF6\u4E2D\u7684 elasticsearch \u670D\u52A1\u7684 <code>ELASTIC_PASSWORD</code> \u53BB\u6389\uFF0C\u8FD9\u6837\u53EF\u4EE5\u786E\u4FDD\u670D\u52A1\u542F\u52A8\u53EA\u4F7F\u7528\u6211\u4EEC\u521A\u521A\u91CD\u7F6E\u540E\u7684\u5BC6\u7801\uFF08keystore\uFF09\u3002\u4EE5\u53CA\u9700\u8981\u5BF9 kibana \u3001 logstash \u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u4FE1\u606F\u8FDB\u884C\u66FF\u6362\uFF0C\u5C06\u6587\u4EF6\u4E2D\u7684 <strong>elastic</strong> \u7528\u6237\u7684\u5BC6\u7801\u8FDB\u884C\u66F4\u65B0\uFF0C\u76F8\u5173\u6587\u4EF6\u6211\u4EEC\u5728\u5F00\u7BC7\u7684\u76EE\u5F55\u7ED3\u6784\u4E2D\u6709\u63D0\u8FC7\uFF0C\u6682\u65F6\u5148\u4FEE\u6539\u4E0B\u9762\u4E09\u4E2A\u6587\u4EF6\u5C31\u53EF\u4EE5\u4E86\uFF1A</p><ul><li>kibana/config/kibana.yml</li><li>logstash/config/logstash.yml</li><li>logstash/pipeline/logstash.conf</li></ul>`,19),m={href:"https://www.elastic.co/guide/en/logstash/current/ls-security.html",target:"_blank",rel:"noopener noreferrer"},b=t(`<p>\u5728\u914D\u7F6E\u4FEE\u6539\u5B8C\u6BD5\u540E\uFF0C\u6211\u4EEC\u6267\u884C <code>docker-compose restart</code> \u91CD\u542F\u76F8\u5173\u670D\u52A1\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker-compose</span> restart

Restarting docker-elk_kibana_1        <span class="token punctuation">..</span>. <span class="token keyword">done</span>
Restarting docker-elk_logstash_1      <span class="token punctuation">..</span>. <span class="token keyword">done</span>
Restarting docker-elk_elasticsearch_1 <span class="token punctuation">..</span>. <span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u65E5\u5FD7\u4E2D\u6CA1\u6709\u51FA\u73B0\u4EFB\u4F55 401 \u6216\u8005\u8BBF\u95EE\u62D2\u7EDD\u7684\u5185\u5BB9\uFF0C\u8BF4\u660E\u670D\u52A1\u4E00\u5207\u6B63\u5E38\u3002</p><h3 id="\u4F7F\u7528-kibana-\u63A7\u5236\u53F0" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528-kibana-\u63A7\u5236\u53F0" aria-hidden="true">#</a> \u4F7F\u7528 Kibana \u63A7\u5236\u53F0</h3><p>\u542F\u52A8\u4E4B\u540E\uFF0C\u6211\u4EEC\u4F7F\u7528\u6D4F\u89C8\u5668\u8BBF\u95EE\u670D\u52A1\u5668IP+\u7AEF\u53E35601\uFF0C\u6253\u5F00 kibana \u63A7\u5236\u53F0\u3002</p><p><img src="http://122.9.159.116:5244/d/ecloud180/images/blogImage/v2-6e81c345d57b1ed67e834c655a3082e0_r.jpg" alt="img" loading="lazy"></p><p>\u4F7F\u7528elastic \u8D26\u53F7\u548C\u5BC6\u7801\u767B\u5F55\u540E\uFF0C\u5C31\u80FD\u591F\u770B\u5230 Kibana \u7684\u754C\u9762\u4E86\uFF0C\u5982\u679C\u7B2C\u4E00\u6B21\u4F7F\u7528\uFF0C\u4F1A\u770B\u5230\u6B22\u8FCE\u754C\u9762\u3002</p><p><img src="http://122.9.159.116:5244/d/ecloud180/images/blogImage/v2-30151461a0b7a7412a7063e446439074_r.jpg" alt="img" loading="lazy"></p><p>\u5728\u767B\u9646\u4E4B\u540E\uFF0C\u7B2C\u4E00\u6B21\u4F7F\u7528\uFF0C\u53EF\u4EE5\u8003\u8651\u5BFC\u5165\u793A\u4F8B\u6570\u636E\uFF0C\u6765\u5E2E\u52A9\u4E86\u89E3 Kibana \u7684\u57FA\u7840\u529F\u80FD\u3002</p><p><img src="http://122.9.159.116:5244/d/ecloud180/images/blogImage/v2-b0ea3bd33d02838d4e15d0787a7a4659_r.jpg" alt="img" loading="lazy"></p><p>\u63A5\u4E0B\u6765\u5C31\u662F\u81EA\u7531\u63A2\u7D22\u7684\u8FC7\u7A0B\u4E86\uFF0C: )</p><p><img src="http://122.9.159.116:5244/d/ecloud180/images/blogImage/v2-c97fac3f23e7d384ba71843dfdfe64d7_r.jpg" alt="img" loading="lazy"></p><h3 id="\u5173\u95ED\u4ED8\u8D39\u7EC4\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u5173\u95ED\u4ED8\u8D39\u7EC4\u4EF6" aria-hidden="true">#</a> \u5173\u95ED\u4ED8\u8D39\u7EC4\u4EF6</h3><p>\u6253\u5F00\u8BBE\u7F6E\u754C\u9762\uFF0C\u9009\u62E9 Elasticsearch \u6A21\u5757\u4E2D\u7684 License Management \uFF0C\u53EF\u4EE5\u770B\u5230\u9ED8\u8BA4\u8F6F\u4EF6\u4F1A\u542F\u52A8\u4E3A\u671F\u4E00\u4E2A\u6708\u7684\u9AD8\u7EA7\u529F\u80FD\u8BD5\u7528\u3002</p><p><img src="http://122.9.159.116:5244/d/ecloud180/images/blogImage/v2-423450e256c5e034f24a9aa2ca0494b6_r.jpg" alt="img" loading="lazy"></p>`,15),g={href:"https://www.elastic.co/cn/subscriptions",target:"_blank",rel:"noopener noreferrer"},h=t(`<p><img src="http://122.9.159.116:5244/d/ecloud180/images/blogImage/v2-7aa7bf6822c363babdb3cb1eee874383_r.jpg" alt="img" loading="lazy"></p><p>\u5982\u679C\u4F60\u60F3\u8981\u4E86\u89E3\u8F6F\u4EF6\u5F53\u524D\u8FD0\u884C\u72B6\u6001\uFF0C\u9664\u4E86\u767B\u9646\u673A\u5668\uFF0C\u67E5\u770B\u5BBF\u4E3B\u673A\u548C\u5BB9\u5668\u72B6\u6001\u5916\uFF0C\u5728\u76D1\u63A7\u754C\u9762\uFF0C\u6211\u4EEC\u4E5F\u53EF\u4EE5\u65B9\u4FBF\u5FEB\u6377\u7684\u770B\u5230\u5355\u8282\u70B9\u4E2D\u5404\u4E2A\u670D\u52A1\u7684\u8FD0\u884C\u72B6\u6001\u548C\u8D44\u6E90\u5360\u7528\u3002</p><p><img src="http://122.9.159.116:5244/d/ecloud180/images/blogImage/v2-36d9b830184f14f9e36e03943150c3e9_r.jpg" alt="img" loading="lazy"></p><p>\u9009\u62E9\u201CRevert to Basic license\u201D\uFF0C\u9009\u62E9\u56DE\u9000\u5230\u57FA\u7840\u7248\u672C\uFF0C\u53EF\u4EE5\u770B\u5230\u6574\u4E2A\u754C\u9762\u90FD\u7B80\u6D01\u4E86\u4E0D\u5C11\uFF0C\u81F3\u6B64\u5982\u679C\u4E0D\u4ED8\u8D39\u7684\u8BDD\uFF0C\u5C31\u53EF\u4EE5\u5B89\u5FC3\u5408\u6CD5\u7684\u4F7F\u7528\u8F6F\u4EF6\u4E86\u3002</p><p><img src="http://122.9.159.116:5244/d/ecloud180/images/blogImage/v2-7303bb065fbfdf67f66064f7a9d9246f_r.jpg" alt="img" loading="lazy"></p><p>\u5F53\u7136\uFF0C\u4F60\u4E5F\u53EF\u4EE5\u5728 elasticsearch.yml \u914D\u7F6E\u6587\u4EF6\u4E2D\u7684 <code>xpack.license.self_generated.type</code> \u4FEE\u6539\u4E3A <code>basic</code> \u6765\u7981\u7528 X-Pack \u76F8\u5173\u529F\u80FD\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>xpack.license.self_generated.type: basic
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5BF9\u63A5\u5404\u79CD\u8F6F\u4EF6/\u7CFB\u7EDF\u8FDB\u884C\u65E5\u5FD7\u6536\u96C6\uFF0C\u4EE5\u53CA\u5B9A\u5236\u4F60\u7684\u53EF\u89C6\u5316\u754C\u9762\u6216\u8005 API \u6211\u4EEC\u540E\u9762\u6709\u673A\u4F1A\u518D\u804A\uFF0C\u63A5\u4E0B\u6765\u7EE7\u7EED\u804A\u804A\uFF0C\u5982\u4F55\u8FDB\u4E00\u6B65\u642D\u5EFA\u914D\u7F6E ELK \u3002</p><h3 id="\u4FEE\u6539\u81EA\u5B98\u65B9\u793A\u4F8B\u7684\u751F\u4EA7\u73AF\u5883" tabindex="-1"><a class="header-anchor" href="#\u4FEE\u6539\u81EA\u5B98\u65B9\u793A\u4F8B\u7684\u751F\u4EA7\u73AF\u5883" aria-hidden="true">#</a> \u4FEE\u6539\u81EA\u5B98\u65B9\u793A\u4F8B\u7684\u751F\u4EA7\u73AF\u5883</h3><p>\u751F\u4EA7\u73AF\u5883\u7684\u57FA\u7840\u8981\u6C42\u662F\u9AD8\u53EF\u7528\u6027\uFF0C\u5E38\u89C4\u5B9E\u73B0\u65B9\u6848\u4E2D\u89C1\u7684\u6BD4\u8F83\u591A\u7684\u662F\u201C\u591A\u526F\u672C/\u5B9E\u4F8B\u201D\uFF0C\u591A\u673A\u5668\uFF0C\u591A\u673A\u67B6\uFF0C\u751A\u81F3\u591A\u533A\u57DF\u90E8\u7F72\u3002</p><p>\u672C\u6587\u6211\u4EEC\u5148\u804A\u804A\u6700\u7B80\u5355\u7684\u591A\u5B9E\u4F8B\u3002</p><h3 id="\u524D\u7F6E\u51C6\u5907" tabindex="-1"><a class="header-anchor" href="#\u524D\u7F6E\u51C6\u5907" aria-hidden="true">#</a> \u524D\u7F6E\u51C6\u5907</h3><p>\u5982\u679C\u60F3\u8BA9\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528 Docker \u8FD0\u884C ELK\uFF0C\u6709\u4E00\u4E9B\u5FC5\u5907\u7684\u7CFB\u7EDF\u8BBE\u7F6E\u5FC5\u4E0D\u53EF\u5C11\u3002</p><p>\u9996\u5148\u8C03\u6574 <code>vm.max_map_count</code> \u7684\u6570\u503C\uFF0C\u81F3\u5C11\u8C03\u6574\u5230 262144 \u4EE5\u4E0A\u3002\u5728 <code>/etc/sysctl.conf</code> \u6DFB\u52A0\u4E0B\u9762\u7684\u5185\u5BB9\u5373\u53EF\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>vm.max_map_count = 262144

sysctl -w vm.max_map_count=262144
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7136\u540E\u8C03\u6574 <code>ulimits</code> \u4EE5\u53CA <code>nprocedit</code>\uFF0C\u56E0\u4E3A\u6211\u4EEC\u4F7F\u7528\u5BB9\u5668\u8FD0\u884C ELK \u76F8\u5173\u5E94\u7528\uFF0C\u6240\u4EE5\u76F4\u63A5\u4FEE\u6539 compose \u914D\u7F6E\u6587\u4EF6\u4E2D\u7684 ES \u914D\u7F6E\u5C31\u53EF\u4EE5\u4E86\uFF1A</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">ulimits</span><span class="token punctuation">:</span>
  <span class="token key atrule">memlock</span><span class="token punctuation">:</span>
    <span class="token key atrule">soft</span><span class="token punctuation">:</span> <span class="token number">-1</span>
    <span class="token key atrule">hard</span><span class="token punctuation">:</span> <span class="token number">-1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6211\u4EEC\u7EE7\u7EED\u8C03\u6574\uFF0C\u5173\u95ED\u5185\u5B58\u4EA4\u6362\uFF0C\u540C\u6837\u4FEE\u6539 compose \u914D\u7F6E\u6587\u4EF6\u4E2D\u7684 ES \u914D\u7F6E\u5373\u53EF\uFF1A</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">environment</span><span class="token punctuation">:</span>
  <span class="token key atrule">bootstrap.memory_lock</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,19),y={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/heap-size.html",target:"_blank",rel:"noopener noreferrer"},q=t(`<div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">environment</span><span class="token punctuation">:</span>
  <span class="token key atrule">ES_JAVA_OPTS</span><span class="token punctuation">:</span> <span class="token string">&quot;-Xmx1g -Xms1g&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u4F60\u771F\u5B9E\u4F7F\u7528\u5728\u751F\u4EA7\u73AF\u8282\uFF0C\u52A1\u5FC5\u5F00\u542F TLS \u548C\u5BC6\u7801\u8BA4\u8BC1\uFF0C\u6B64\u5904\u4E3A\u4E86\u4E0D\u989D\u5916\u6269\u5C55\u7BC7\u5E45\uFF08\u4EE5\u53CA\u61D2\u5F97\u7533\u8BF7\u901A\u914D\u7B26\u8BC1\u4E66/\u914D\u7F6E\u81EA\u7B7E\u540D\uFF09\u5148\u4F7F\u7528\u5173\u95ED\u5B89\u5168\u914D\u7F6E\u7684\u65B9\u5F0F\u5FFD\u7565\u8FD9\u4E2A\u8BBE\u7F6E : )</p><h3 id="\u4FEE\u6539\u914D\u7F6E\u652F\u6301\u591A\u5B9E\u4F8B" tabindex="-1"><a class="header-anchor" href="#\u4FEE\u6539\u914D\u7F6E\u652F\u6301\u591A\u5B9E\u4F8B" aria-hidden="true">#</a> \u4FEE\u6539\u914D\u7F6E\u652F\u6301\u591A\u5B9E\u4F8B</h3>`,3),_={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/docker.html",target:"_blank",rel:"noopener noreferrer"},f=t(`<p>\u9996\u5148\u521B\u5EFA\u670D\u52A1\u6240\u9700\u8981\u7684\u6570\u636E\u76EE\u5F55\uFF0C\u5E76\u8D4B\u4E88\u6240\u9700\u8981\u7684\u6743\u9650\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> data/<span class="token punctuation">{</span>es01,es02,es03<span class="token punctuation">}</span>
<span class="token function">chmod</span> g+rwx data/*
<span class="token function">chgrp</span> <span class="token number">0</span> data/*
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),x={href:"https://docs.docker.com/engine/extend/legacy_plugins/",target:"_blank",rel:"noopener noreferrer"},w=t(`<div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> ./elasticsearch/config/elasticsearch.yml<span class="token punctuation">:</span>/usr/share/elasticsearch/config/elasticsearch.yml<span class="token punctuation">:</span>ro
  <span class="token punctuation">-</span> ./data<span class="token punctuation">:</span>/usr/share/elasticsearch/data<span class="token punctuation">:</span>rw
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8003\u8651\u5230\u591A\u5B9E\u4F8B\u4E4B\u95F4\u914D\u7F6E\u51E0\u4E4E\u4E00\u81F4\uFF0C\u5E76\u4E14\u5982\u679C\u8981\u5355\u72EC\u7EF4\u62A4\u592A\u8FC7\u5570\u55E6\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5C06 <code>elasticsearch.yml</code> \u5185\u7684\u914D\u7F6E\u4F7F\u7528\u73AF\u5883\u53D8\u91CF\u7684\u65B9\u5F0F\u5199\u5728 compose \u914D\u7F6E\u6587\u4EF6\u4E2D\uFF1A</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">environment</span><span class="token punctuation">:</span>
  <span class="token key atrule">cluster.name</span><span class="token punctuation">:</span> <span class="token string">&quot;docker-cluster&quot;</span>
  <span class="token key atrule">network.host</span><span class="token punctuation">:</span> <span class="token string">&quot;0.0.0.0&quot;</span>
  <span class="token key atrule">bootstrap.memory_lock</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
  <span class="token key atrule">xpack.license.self_generated.type</span><span class="token punctuation">:</span> <span class="token string">&quot;basic&quot;</span>
  <span class="token key atrule">xpack.security.enabled</span><span class="token punctuation">:</span> <span class="token string">&quot;false&quot;</span>
  <span class="token key atrule">xpack.monitoring.collection.enabled</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
  <span class="token key atrule">ES_JAVA_OPTS</span><span class="token punctuation">:</span> <span class="token string">&quot;-Xmx1g -Xms1g&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6B64\u5916\uFF0C\u56E0\u4E3A\u6D89\u53CA\u5230\u591A\u4E2A\u8282\u70B9\u7EC4\u7F51\uFF0C\u6240\u4EE5\u8FD9\u91CC\u9700\u8981\u989D\u5916\u6307\u5B9A\u8FD9\u4E9B\u5B9E\u4F8B\u7684\u8282\u70B9\u540D\u79F0\u7B49\u4FE1\u606F\uFF1A</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.2&quot;</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">elasticsearch01</span><span class="token punctuation">:</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">node.name</span><span class="token punctuation">:</span> <span class="token string">&quot;es01&quot;</span>
      <span class="token key atrule">discovery.seed_hosts</span><span class="token punctuation">:</span> <span class="token string">&quot;es02,es03&quot;</span>
      <span class="token key atrule">cluster.initial_master_nodes</span><span class="token punctuation">:</span> <span class="token string">&quot;es01,es02,es03&quot;</span>

  <span class="token key atrule">elasticsearch02</span><span class="token punctuation">:</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">node.name</span><span class="token punctuation">:</span> <span class="token string">&quot;es02&quot;</span>
      <span class="token key atrule">discovery.seed_hosts</span><span class="token punctuation">:</span> <span class="token string">&quot;es01,es03&quot;</span>
      <span class="token key atrule">cluster.initial_master_nodes</span><span class="token punctuation">:</span> <span class="token string">&quot;es01,es02,es03&quot;</span>

  <span class="token key atrule">elasticsearch03</span><span class="token punctuation">:</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">node.name</span><span class="token punctuation">:</span> <span class="token string">&quot;es03&quot;</span>
      <span class="token key atrule">discovery.seed_hosts</span><span class="token punctuation">:</span> <span class="token string">&quot;es01,es02&quot;</span>
      <span class="token key atrule">cluster.initial_master_nodes</span><span class="token punctuation">:</span> <span class="token string">&quot;es01,es02,es03&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6700\u540E\uFF0C\u6309\u7167\u5B98\u7F51\u7684\u63A8\u8350\u7684\u6A21\u5F0F\uFF0C\u8BA9\u5176\u4E2D\u4E00\u53F0\u673A\u5668\u652F\u6301\u5BF9\u5916\u66B4\u9732\u7AEF\u53E3\uFF0C\u4E0E\u5916\u90E8\u8FDB\u884C\u6570\u636E\u4EA4\u6362\u5373\u53EF\u3002</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> 9200<span class="token punctuation">:</span><span class="token number">9200</span>
  <span class="token punctuation">-</span> 9300<span class="token punctuation">:</span><span class="token number">9300</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5230\u8FD9\u91CC\u591A\u5B9E\u4F8B\u5C31\u914D\u7F6E\u5B8C\u6210\u4E86\u3002</p><h3 id="\u66F4\u65B0-logstash-\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u66F4\u65B0-logstash-\u914D\u7F6E" aria-hidden="true">#</a> \u66F4\u65B0 Logstash \u914D\u7F6E</h3><p>logstash \u9700\u8981\u66F4\u65B0\u7684\u6709\u4E24\u5904\uFF0C\u4E00\u5904\u662F\u8981\u8BA9\u670D\u52A1\u5728 \u521A\u521A\u5B9A\u4E49\u7684 elasticsearch \u5B9E\u4F8B\u542F\u52A8\u4E4B\u540E\u518D\u542F\u52A8\uFF0C\u53E6\u5916\u53EF\u4EE5\u5C06\u914D\u7F6E\u4EE5\u76F8\u540C\u65B9\u5F0F\u6539\u5199\uFF0C\u65B9\u4FBF\u540E\u7EED\u7EF4\u62A4\u3002</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">logstash</span><span class="token punctuation">:</span>
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> ./logstash/config/logstash.yml<span class="token punctuation">:</span>/usr/share/logstash/config/logstash.yml<span class="token punctuation">:</span>ro
    <span class="token punctuation">-</span> ./logstash/pipeline<span class="token punctuation">:</span>/usr/share/logstash/pipeline<span class="token punctuation">:</span>ro
  <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> elasticsearch01
    <span class="token punctuation">-</span> elasticsearch02
    <span class="token punctuation">-</span> elasticsearch03
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u63A5\u7740\u9700\u8981\u66F4\u65B0 <code>logstash/config/logstash.yml</code> \u914D\u7F6E\u4E2D\u7684 <code>xpack.monitoring.elasticsearch.host</code> \u4FE1\u606F\uFF0C\u786E\u4FDD\u542F\u52A8\u4E0D\u4F1A\u51FA\u73B0\u95EE\u9898\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>xpack.monitoring.elasticsearch.hosts: [ &quot;http://es01:9200&quot; ]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4EE5\u53CA <code>logstash/pipeline/logstash.conf</code> \u914D\u7F6E\u4E2D\u7684 <code>output. elasticsearch</code> \u4FE1\u606F\u4E3A <code>hosts =&gt; &quot;es01:9200&quot;</code>\u3002</p><h3 id="\u66F4\u65B0-kibana-\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u66F4\u65B0-kibana-\u914D\u7F6E" aria-hidden="true">#</a> \u66F4\u65B0 Kibana \u914D\u7F6E</h3><p>\u9700\u8981\u66F4\u65B0\u7684\u5730\u65B9\u6709\u4E09\u5904\uFF0C\u4E24\u5904\u540C Logstash \uFF0C\u989D\u5916\u8FD8\u6709\u4E00\u5904\u662F\u6307\u5B9A <code>ELASTICSEARCH_URL</code> \u5730\u5740\u4E3A\u6211\u4EEC\u66B4\u9732\u670D\u52A1\u7684 elasticsearch \u5B9E\u4F8B\u7684\u5730\u5740\u3002</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">kibana</span><span class="token punctuation">:</span>
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> ./kibana/config/kibana.yml<span class="token punctuation">:</span>/usr/share/kibana/config/kibana.yml<span class="token punctuation">:</span>ro
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;5601:5601&quot;</span>
  <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> elasticsearch01
    <span class="token punctuation">-</span> elasticsearch02
    <span class="token punctuation">-</span> elasticsearch03
  <span class="token key atrule">environment</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> ELASTICSEARCH_URL=http<span class="token punctuation">:</span>//es01<span class="token punctuation">:</span><span class="token number">9200</span>
    <span class="token punctuation">-</span> xpack.security.enabled=false
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE5\u53CA\u9700\u8981\u989D\u5916\u66F4\u65B0 <code>kibana/config/kibana.yml</code> \u914D\u7F6E\u4E2D\u7684 <code>elasticsearch.hosts</code> \u5B57\u6BB5\u4FE1\u606F\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>elasticsearch.hosts: [ &quot;http://es01:9200&quot; ]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u5B8C\u6574\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u5B8C\u6574\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> \u5B8C\u6574\u914D\u7F6E\u6587\u4EF6</h3><p>\u4E0A\u8FF0\u914D\u7F6E\u5B8C\u6210\u5185\u5BB9\u5982\u4E0B\uFF1A</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.2&quot;</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">elasticsearch01</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> docker.elastic.co/elasticsearch/elasticsearch<span class="token punctuation">:</span>7.6.2
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> es01
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./data/es01<span class="token punctuation">:</span>/usr/share/elasticsearch/data<span class="token punctuation">:</span>rw
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 9200<span class="token punctuation">:</span><span class="token number">9200</span>
      <span class="token punctuation">-</span> 9300<span class="token punctuation">:</span><span class="token number">9300</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">node.name</span><span class="token punctuation">:</span> <span class="token string">&quot;es01&quot;</span>
      <span class="token key atrule">cluster.name</span><span class="token punctuation">:</span> <span class="token string">&quot;docker-cluster&quot;</span>
      <span class="token key atrule">network.host</span><span class="token punctuation">:</span> <span class="token string">&quot;0.0.0.0&quot;</span>
      <span class="token key atrule">discovery.seed_hosts</span><span class="token punctuation">:</span> <span class="token string">&quot;es02,es03&quot;</span>
      <span class="token key atrule">cluster.initial_master_nodes</span><span class="token punctuation">:</span> <span class="token string">&quot;es01,es02,es03&quot;</span>
      <span class="token key atrule">bootstrap.memory_lock</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
      <span class="token key atrule">xpack.license.self_generated.type</span><span class="token punctuation">:</span> <span class="token string">&quot;basic&quot;</span>
      <span class="token key atrule">xpack.security.enabled</span><span class="token punctuation">:</span> <span class="token string">&quot;false&quot;</span>
      <span class="token key atrule">xpack.monitoring.collection.enabled</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
      <span class="token key atrule">ES_JAVA_OPTS</span><span class="token punctuation">:</span> <span class="token string">&quot;-Xmx1g -Xms1g&quot;</span>
    <span class="token key atrule">ulimits</span><span class="token punctuation">:</span>
      <span class="token key atrule">memlock</span><span class="token punctuation">:</span>
        <span class="token key atrule">soft</span><span class="token punctuation">:</span> <span class="token number">-1</span>
        <span class="token key atrule">hard</span><span class="token punctuation">:</span> <span class="token number">-1</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> elk

  <span class="token key atrule">elasticsearch02</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> docker.elastic.co/elasticsearch/elasticsearch<span class="token punctuation">:</span>7.6.2
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> es02
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./data/es02<span class="token punctuation">:</span>/usr/share/elasticsearch/data<span class="token punctuation">:</span>rw
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">node.name</span><span class="token punctuation">:</span> <span class="token string">&quot;es02&quot;</span>
      <span class="token key atrule">cluster.name</span><span class="token punctuation">:</span> <span class="token string">&quot;docker-cluster&quot;</span>
      <span class="token key atrule">network.host</span><span class="token punctuation">:</span> <span class="token string">&quot;0.0.0.0&quot;</span>
      <span class="token key atrule">discovery.seed_hosts</span><span class="token punctuation">:</span> <span class="token string">&quot;es01,es03&quot;</span>
      <span class="token key atrule">cluster.initial_master_nodes</span><span class="token punctuation">:</span> <span class="token string">&quot;es01,es02,es03&quot;</span>
      <span class="token key atrule">bootstrap.memory_lock</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
      <span class="token key atrule">xpack.license.self_generated.type</span><span class="token punctuation">:</span> <span class="token string">&quot;basic&quot;</span>
      <span class="token key atrule">xpack.security.enabled</span><span class="token punctuation">:</span> <span class="token string">&quot;false&quot;</span>
      <span class="token key atrule">xpack.monitoring.collection.enabled</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
      <span class="token key atrule">ES_JAVA_OPTS</span><span class="token punctuation">:</span> <span class="token string">&quot;-Xmx1g -Xms1g&quot;</span>
    <span class="token key atrule">ulimits</span><span class="token punctuation">:</span>
      <span class="token key atrule">memlock</span><span class="token punctuation">:</span>
        <span class="token key atrule">soft</span><span class="token punctuation">:</span> <span class="token number">-1</span>
        <span class="token key atrule">hard</span><span class="token punctuation">:</span> <span class="token number">-1</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> elk

  <span class="token key atrule">elasticsearch03</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> docker.elastic.co/elasticsearch/elasticsearch<span class="token punctuation">:</span>7.6.2
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> es03
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./data/es03<span class="token punctuation">:</span>/usr/share/elasticsearch/data<span class="token punctuation">:</span>rw
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">node.name</span><span class="token punctuation">:</span> <span class="token string">&quot;es03&quot;</span>
      <span class="token key atrule">cluster.name</span><span class="token punctuation">:</span> <span class="token string">&quot;docker-cluster&quot;</span>
      <span class="token key atrule">network.host</span><span class="token punctuation">:</span> <span class="token string">&quot;0.0.0.0&quot;</span>
      <span class="token key atrule">discovery.seed_hosts</span><span class="token punctuation">:</span> <span class="token string">&quot;es01,es02&quot;</span>
      <span class="token key atrule">cluster.initial_master_nodes</span><span class="token punctuation">:</span> <span class="token string">&quot;es01,es02,es03&quot;</span>
      <span class="token key atrule">bootstrap.memory_lock</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
      <span class="token key atrule">xpack.license.self_generated.type</span><span class="token punctuation">:</span> <span class="token string">&quot;basic&quot;</span>
      <span class="token key atrule">xpack.security.enabled</span><span class="token punctuation">:</span> <span class="token string">&quot;false&quot;</span>
      <span class="token key atrule">xpack.monitoring.collection.enabled</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
      <span class="token key atrule">ES_JAVA_OPTS</span><span class="token punctuation">:</span> <span class="token string">&quot;-Xmx1g -Xms1g&quot;</span>
    <span class="token key atrule">ulimits</span><span class="token punctuation">:</span>
      <span class="token key atrule">memlock</span><span class="token punctuation">:</span>
        <span class="token key atrule">soft</span><span class="token punctuation">:</span> <span class="token number">-1</span>
        <span class="token key atrule">hard</span><span class="token punctuation">:</span> <span class="token number">-1</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> elk

  <span class="token key atrule">logstash</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span>
      <span class="token key atrule">context</span><span class="token punctuation">:</span> logstash/
      <span class="token key atrule">args</span><span class="token punctuation">:</span>
        <span class="token key atrule">ELK_VERSION</span><span class="token punctuation">:</span> $ELK_VERSION
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./logstash/config/logstash.yml<span class="token punctuation">:</span>/usr/share/logstash/config/logstash.yml<span class="token punctuation">:</span>ro
      <span class="token punctuation">-</span> ./logstash/pipeline<span class="token punctuation">:</span>/usr/share/logstash/pipeline<span class="token punctuation">:</span>ro
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;5000:5000/tcp&quot;</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;5000:5000/udp&quot;</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;9600:9600&quot;</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">LS_JAVA_OPTS</span><span class="token punctuation">:</span> <span class="token string">&quot;-Xmx1g -Xms1g&quot;</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> elk
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> elasticsearch01
      <span class="token punctuation">-</span> elasticsearch02
      <span class="token punctuation">-</span> elasticsearch03

  <span class="token key atrule">kibana</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span>
      <span class="token key atrule">context</span><span class="token punctuation">:</span> kibana/
      <span class="token key atrule">args</span><span class="token punctuation">:</span>
        <span class="token key atrule">ELK_VERSION</span><span class="token punctuation">:</span> $ELK_VERSION
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./kibana/config/kibana.yml<span class="token punctuation">:</span>/usr/share/kibana/config/kibana.yml<span class="token punctuation">:</span>ro
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;5601:5601&quot;</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> elk
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> elasticsearch01
      <span class="token punctuation">-</span> elasticsearch02
      <span class="token punctuation">-</span> elasticsearch03
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ELASTICSEARCH_URL=http<span class="token punctuation">:</span>//es01<span class="token punctuation">:</span><span class="token number">9200</span>
      <span class="token punctuation">-</span> xpack.security.enabled=false

<span class="token key atrule">networks</span><span class="token punctuation">:</span>
  <span class="token key atrule">elk</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5176\u5B9E\u5982\u679C\u4F60\u5168\u90E8\u4F7F\u7528\u5B98\u65B9\u955C\u50CF\uFF0C\u800C\u4E0D\u505A\u4E8C\u6B21\u5B9A\u5236\uFF0C\u6BD4\u5982\u5B89\u88C5\u63D2\u4EF6\u7684\u8BDD\uFF0C\u90A3\u4E48\u90FD\u6539\u4E3A\u5B98\u65B9\u955C\u50CF\u540D\u79F0\u5373\u53EF\u3002</p><p>\u542F\u52A8\u670D\u52A1\u4E4B\u540E\uFF0C\u6253\u5F00 kibana \u53EF\u4EE5\u770B\u5230\u591A\u5B9E\u4F8B\u7684 ELK \u73AF\u5883\u5C31\u914D\u7F6E\u5B8C\u6BD5\u4E86\u3002</p><p><img src="http://122.9.159.116:5244/d/ecloud180/images/blogImage/v2-c83ad60df4275a2343c45b92f09ab8ae_r.jpg" alt="img" loading="lazy"></p><h3 id="\u5176\u4ED6" tabindex="-1"><a class="header-anchor" href="#\u5176\u4ED6" aria-hidden="true">#</a> \u5176\u4ED6</h3>`,26),E={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/system-config.html",target:"_blank",rel:"noopener noreferrer"},S={href:"https://github.com/elastic/stack-docker/blob/master/docker-compose.yml",target:"_blank",rel:"noopener noreferrer"},A=n("h3",{id:"\u6700\u540E",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u6700\u540E","aria-hidden":"true"},"#"),s(" \u6700\u540E")],-1),R=n("p",null,"\u63A5\u4E0B\u6765\u6211\u4F1A\u56F4\u7ED5\u65E5\u5FD7\u5199\u4E00\u4E9B\u6709\u8DA3\u53C8\u7B80\u5355\u6613\u7528\u7684\u5185\u5BB9\uFF0C\u672C\u7BC7\u662F\u7B2C\u4E00\u7BC7\u5185\u5BB9\u3002",-1);function L(j,I){const a=c("ExternalLinkIcon");return i(),o("div",null,[u,n("blockquote",null,[n("p",null,[s("\u672C\u6587\u53EA\u4ECB\u7ECD\u4E86\u6700\u7B80\u5316\u642D\u5EFA\u3002\u5982\u679C\u60A8\u7528\u4E8E\u751F\u4EA7\uFF0C\u8FD8\u9700\u8981\u5728\u5982\u4E0B\u65B9\u9762\u5B8C\u5584 1.elastic\u662F\u6709\u5B58\u50A8\u76EE\u5F55\uFF0C\u9700\u8981\u5728docker\u4E2D\u8FDB\u884C\u6570\u636E\u5377\u6620\u5C04\u3002\u914D\u7F6E\u6587\u4EF6elasticsearch.yml\u9700\u8981\u6839\u636E\u81EA\u5DF1\u9700\u6C42\u81EA\u884C\u914D\u7F6E\u3002\u8BF7\u53C2\u8003\uFF1A"),n("a",r,[s("https://hub.docker.com/_/elasticsearch/"),e(a)]),s(" 2.Dockerhub\u5B98\u65B9\u63D0\u4F9B\u7684\u955C\u50CF\u57FA\u4E8E\u4E0D\u540C\u7684\u57FA\u7840\u955C\u50CF\uFF0C\u4E0D\u5229\u4E8E\u7F51\u7EDC\u4F20\u8F93\uFF01\u5EFA\u8BAE\u6839\u636E\u81EA\u5DF1\u7EC4\u7EC7\u5185\u90E8\u955C\u50CF\u91CD\u65B0\u521B\u5EFA\uFF01")])]),d,n("p",null,[s("\u4E3A\u4E86\u65B9\u4FBF\u642D\u5EFA\uFF0C\u6211\u4EEC\u4F7F\u7528 "),n("a",k,[s("https://github.com/deviantony/docker-elk"),e(a)]),s(" \u8FD9\u4E2A\u5F00\u6E90\u9879\u76EE\uFF0C\u8FD9\u4E2A\u9879\u76EE\u7EF4\u62A4\u4E86 ELK \u6280\u672F\u6808\u6700\u8FD1\u7684\u4E09\u4E2A\u7248\u672C\uFF0C\u4E5F\u5C31\u662F 7.x\u30016.x\u30015.x \uFF0C\u672C\u6587\u5C06\u4F7F\u7528\u6700\u65B0\u7248\u672C\u3002")]),v,n("p",null,[s("\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0C logstash pipeline \u9700\u8981\u4E00\u4E2A\u9AD8\u6743\u9650\u8D26\u53F7\uFF0C\u5F53\u524D\u6D4B\u8BD5\u5F00\u53D1\u8FC7\u7A0B\u4E2D\uFF0C\u53EF\u4EE5\u4F7F\u7528\u4E0A\u9762\u91CD\u7F6E\u540E\u7684 elastic \u8D26\u53F7\u548C\u5BC6\u7801\uFF0C\u5982\u679C\u662F\u751F\u4EA7\u4F7F\u7528\u53EF\u4EE5\u53C2\u8003\u5B98\u65B9\u6587\u6863 "),n("a",m,[s("Configuring Security in Logstash"),e(a)]),s(" \u8FDB\u884C\u64CD\u4F5C\uFF0C\u5206\u914D\u4E00\u4E2A\u65B0\u7684\u4E13\u7528\u8D26\u53F7\u3002")]),b,n("p",null,[s("\u5728 "),n("a",g,[s("\u5B98\u65B9\u8BA2\u9605"),e(a)]),s(" \u9875\u9762\uFF0C\u6211\u4EEC\u53EF\u4EE5\u770B\u5230\u5B98\u65B9\u652F\u6301\u7684\u8BA2\u9605\u7C7B\u578B\uFF0C\u4E00\u822C\u6765\u8BF4\uFF0C\u5982\u679C\u6CA1\u6709\u7279\u6B8A\u9700\u6C42\uFF0C\u4F7F\u7528\u57FA\u7840\u7248\u672C\u5C31\u597D\u3002")]),h,n("p",null,[s("Java \u5806\u5927\u5C0F\u540C\u6837\u9700\u8981\u8C03\u6574\uFF0C\u9ED8\u8BA4\u7684\u6570\u503C\u5982\u4E0B\uFF0C\u5728\u751F\u4EA7\u73AF\u5883\u4E2D\u592A\u5C0F\u4E86\uFF0C\u66F4\u8BE6\u7EC6\u7684\u5185\u5BB9\u53EF\u4EE5\u53C2\u8003"),n("a",y,[s("\u8FD9\u91CC"),e(a)]),s("\u3002")]),q,n("p",null,[s("\u5B98\u65B9\u591A\u5B9E\u4F8B\u65B9\u6848\uFF08"),n("a",_,[s("\u8FD9\u7BC7\u5B98\u65B9\u6307\u5F15"),e(a)]),s("\uFF09\uFF0C\u91C7\u53D6\u5728 compose \u4E2D\u5B9A\u4E49\u4E09\u4E2A\u4E0D\u540C\u7684\u670D\u52A1\uFF0C\u7136\u540E\u4F7F\u7528\u7B2C\u4E00\u4E2A\u670D\u52A1\u4F5C\u4E3A Master \u5BF9\u5916\u66B4\u9732\u670D\u52A1\uFF0C\u6211\u4EEC\u5148\u4EE5\u8BE5\u65B9\u6848\u4E3A\u57FA\u7840\uFF0C\u5E76\u8FDB\u884C\u4E00\u4E9B\u8C03\u6574\u3002")]),f,n("p",null,[s("\u4E4B\u524D\u5728\u5355\u8282\u70B9\u4E2D\uFF0C\u6211\u4EEC\u6302\u8F7D\u7684\u6570\u636E\u4F7F\u7528\u7684\u662F\u5BB9\u5668\u7684\u6570\u636E\u5377\u65B9\u6848\uFF0C\u5728\u8FD9\u91CC\uFF0C\u6211\u4EEC\u53EF\u4EE5\u8003\u8651\u4F7F\u7528\u6027\u80FD\u66F4\u597D\u7684\u6587\u4EF6\u6620\u5C04\u66FF\u6362\u4E4B\u524D\u7684\u65B9\u6848\uFF0C\u5F53\u7136\u4E5F\u53EF\u4EE5\u914D\u5408"),n("a",x,[s("\u50A8\u5B58\u63D2\u4EF6"),e(a)]),s("\u4F7F\u7528\uFF1A")]),w,n("p",null,[s("\u5B98\u7F51\u6587\u6863\u5BF9\u4E8E\u914D\u7F6E\u7684\u5185\u5BB9\u63CF\u8FF0\u6709\u4E0D\u5C11\uFF0C\u611F\u5174\u8DA3\u7684\u540C\u5B66\u53EF\u4EE5\u8FDB\u4E00\u6B65\u4E86\u89E3\uFF0C\u6BD4\u5982\u8FD9\u7BC7"),n("a",E,[s(" Important System Configuration "),e(a)]),s("\uFF0C\u539F\u7406\u540C\u6837\u9002\u7528\u4E8E\u4E00\u4E9B\u5176\u4ED6\u7684\u5E94\u7528\u3002")]),n("p",null,[s("\u5173\u4E8E\u5982\u4F55\u4F7F\u7528\u5404\u79CD beat \u670D\u52A1\u8FDB\u884C\u65E5\u5FD7\u4E0A\u62A5\uFF0C\u53EF\u4EE5\u53C2\u8003\u5B98\u65B9\u4E4B\u524D\u7ED9\u51FA\u7684"),n("a",S,[s("\u793A\u4F8B\u6587\u4EF6"),e(a)]),s("\u3002")]),A,R])}const T=l(p,[["render",L],["__file","Docker\u642D\u5EFAELK\u65E5\u5FD7\u5206\u6790\u7CFB\u7EDF.html.vue"]]);export{T as default};
