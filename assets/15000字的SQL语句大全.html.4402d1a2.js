import{_ as t}from"./plugin-vue_export-helper.21dcd24c.js";import{r as o,o as l,c,a as s,e,d as p,b as n}from"./app.490ae90a.js";const i={},r=p(`<h1 id="_15000-\u5B57\u7684-sql-\u8BED\u53E5\u5927\u5168" tabindex="-1"><a class="header-anchor" href="#_15000-\u5B57\u7684-sql-\u8BED\u53E5\u5927\u5168" aria-hidden="true">#</a> 15000 \u5B57\u7684 SQL \u8BED\u53E5\u5927\u5168</h1><p><strong>\u4E00\u3001\u57FA\u7840</strong></p><p><strong>1\u3001\u8BF4\u660E\uFF1A\u521B\u5EFA\u6570\u636E\u5E93</strong></p><p>CREATE DATABASE database-name</p><p><strong>2</strong>**\u3001\u8BF4\u660E\uFF1A\u5220\u9664\u6570\u636E\u5E93**</p><p><strong>d</strong>rop database dbname</p><p><strong>3\u3001\u8BF4\u660E\uFF1A\u5907\u4EFDsql server</strong></p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">--- \u521B\u5EFA \u5907\u4EFD\u6570\u636E\u7684 device</span>
<span class="token keyword">USE</span> master
<span class="token keyword">EXEC</span> sp_addumpdevice <span class="token string">&#39;disk&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;testBack&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c:\\mssql7backup\\MyNwind_1.dat&#39;</span>
<span class="token comment">--- \u5F00\u59CB \u5907\u4EFD</span>
<span class="token keyword">BACKUP</span> <span class="token keyword">DATABASE</span> pubs <span class="token keyword">TO</span> testBack 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>4\u3001\u8BF4\u660E\uFF1A\u521B\u5EFA\u65B0\u8868</strong></p><p>create table tabname(col1 type1 [not null] [primary key],col2 type2 [not null],..)</p><p><strong>\u6839\u636E\u5DF2\u6709\u7684\u8868\u521B\u5EFA\u65B0\u8868\uFF1A</strong></p><p>**A\uFF1A<strong>create table tab_new like tab_old (\u4F7F\u7528\u65E7\u8868\u521B\u5EFA\u65B0\u8868) <strong>B</strong></strong>\uFF1A**create table tab_new as select col1,col2\u2026 from tab_old definition only</p><p><strong>5\u3001\u8BF4\u660E\uFF1A\u5220\u9664\u65B0\u8868</strong></p><p>drop table tabname</p><p><strong>6\u3001\u8BF4\u660E\uFF1A\u589E\u52A0\u4E00\u4E2A\u5217</strong></p><p>Alter table tabname add column col type</p><p><strong>\u6CE8</strong>\uFF1A\u5217\u589E\u52A0\u540E\u5C06\u4E0D\u80FD\u5220\u9664\u3002DB2\u4E2D\u5217\u52A0\u4E0A\u540E\u6570\u636E\u7C7B\u578B\u4E5F\u4E0D\u80FD\u6539\u53D8\uFF0C\u552F\u4E00\u80FD\u6539\u53D8\u7684\u662F\u589E\u52A0varchar\u7C7B\u578B\u7684\u957F\u5EA6\u3002</p><p><strong>7\u3001\u8BF4\u660E\uFF1A\u6DFB\u52A0\u4E3B\u952E</strong>\uFF1AAlter table tabname add primary key(col) \u8BF4\u660E\uFF1A\u5220\u9664\u4E3B\u952E\uFF1AAlter table tabname drop primary key(col)</p><p><strong>8\u3001\u8BF4\u660E\uFF1A\u521B\u5EFA\u7D22\u5F15</strong>\uFF1Acreate [unique] index idxname on tabname(col\u2026.)</p><p>\u5220\u9664\u7D22\u5F15\uFF1Adrop index idxname** **</p><p>\u6CE8\uFF1A\u7D22\u5F15\u662F\u4E0D\u53EF\u66F4\u6539\u7684\uFF0C\u60F3\u66F4\u6539\u5FC5\u987B\u5220\u9664\u91CD\u65B0\u5EFA\u3002</p><p><strong>9</strong>**\u3001\u8BF4\u660E\uFF1A\u521B\u5EFA\u89C6\u56FE**\uFF1Acreate view viewname as select statement</p><p><strong>\u5220\u9664\u89C6\u56FE</strong>\uFF1Adrop view viewname</p><p><strong>10</strong>**\u3001\u8BF4\u660E\uFF1A\u51E0\u4E2A\u7B80\u5355\u7684\u57FA\u672C\u7684sql\u8BED\u53E5**</p><p>**\u9009\u62E9\uFF1A**select * from table1 where \u8303\u56F4 **\u63D2\u5165\uFF1A**insert into table1(field1,field2) values(value1,value2) <strong>\u5220\u9664\uFF1A<strong>delete from table1 where \u8303\u56F4</strong>\u66F4\u65B0</strong>\uFF1Aupdate table1 set field1=value1 where \u8303\u56F4 <strong>\u67E5\u627E</strong>\uFF1Aselect * from table1 where field1 like \u2019%value1%\u2019 ---like\u7684\u8BED\u6CD5\u5F88\u7CBE\u5999\uFF0C\u67E5\u8D44\u6599! <strong>\u6392\u5E8F</strong>\uFF1Aselect * from table1 order by field1,field2 [desc] <strong>\u603B\u6570</strong>\uFF1Aselect count as totalcount from table1 <strong>\u6C42\u548C</strong>\uFF1Aselect sum(field1) as sumvalue from table1 <strong>\u5E73\u5747</strong>\uFF1Aselect avg(field1) as avgvalue from table1 <strong>\u6700\u5927</strong>\uFF1Aselect max(field1) as maxvalue from table1 <strong>\u6700\u5C0F</strong>\uFF1Aselect min(field1) as minvalue from table1</p><p><strong>11\u3001\u8BF4\u660E\uFF1A\u51E0\u4E2A\u9AD8\u7EA7\u67E5\u8BE2\u8FD0\u7B97\u8BCD</strong></p><p><strong>A\uFF1AUNION \u8FD0\u7B97\u7B26</strong></p><p>UNION \u8FD0\u7B97\u7B26\u901A\u8FC7\u7EC4\u5408\u5176\u4ED6\u4E24\u4E2A\u7ED3\u679C\u8868\uFF08\u4F8B\u5982 TABLE1 \u548C TABLE2\uFF09\u5E76\u6D88\u53BB\u8868\u4E2D\u4EFB\u4F55\u91CD\u590D\u884C\u800C\u6D3E\u751F\u51FA\u4E00\u4E2A\u7ED3\u679C\u8868\u3002\u5F53 ALL \u968F UNION \u4E00\u8D77\u4F7F\u7528\u65F6\uFF08\u5373 UNION ALL\uFF09\uFF0C\u4E0D\u6D88\u9664\u91CD\u590D\u884C\u3002\u4E24\u79CD\u60C5\u51B5\u4E0B\uFF0C\u6D3E\u751F\u8868\u7684\u6BCF\u4E00\u884C\u4E0D\u662F\u6765\u81EA TABLE1 \u5C31\u662F\u6765\u81EA TABLE2\u3002</p><p><strong>B\uFF1AEXCEPT \u8FD0\u7B97\u7B26</strong></p><p><strong>EXCEPT</strong>\u8FD0\u7B97\u7B26\u901A\u8FC7\u5305\u62EC\u6240\u6709\u5728 TABLE1 \u4E2D\u4F46\u4E0D\u5728 TABLE2 \u4E2D\u7684\u884C\u5E76\u6D88\u9664\u6240\u6709\u91CD\u590D\u884C\u800C\u6D3E\u751F\u51FA\u4E00\u4E2A\u7ED3\u679C\u8868\u3002\u5F53 ALL \u968F EXCEPT \u4E00\u8D77\u4F7F\u7528\u65F6 (EXCEPT ALL)\uFF0C\u4E0D\u6D88\u9664\u91CD\u590D\u884C\u3002** **</p><p><strong>C\uFF1AINTERSECT \u8FD0\u7B97\u7B26</strong></p><p><strong>INTERSECT</strong>\u8FD0\u7B97\u7B26\u901A\u8FC7\u53EA\u5305\u62EC TABLE1 \u548C TABLE2 \u4E2D\u90FD\u6709\u7684\u884C\u5E76\u6D88\u9664\u6240\u6709\u91CD\u590D\u884C\u800C\u6D3E\u751F\u51FA\u4E00\u4E2A\u7ED3\u679C\u8868\u3002\u5F53 <strong>ALL</strong>\u968F INTERSECT \u4E00\u8D77\u4F7F\u7528\u65F6 (INTERSECT ALL)\uFF0C\u4E0D\u6D88\u9664\u91CD\u590D\u884C\u3002 **\u6CE8\uFF1A**\u4F7F\u7528\u8FD0\u7B97\u8BCD\u7684\u51E0\u4E2A\u67E5\u8BE2\u7ED3\u679C\u884C\u5FC5\u987B\u662F\u4E00\u81F4\u7684\u3002</p><p><strong>12</strong>**\u3001\u8BF4\u660E\uFF1A\u4F7F\u7528\u5916\u8FDE\u63A5**</p><p>A\u3001<strong>left \uFF08outer\uFF09 join</strong>\uFF1A</p><p>\u5DE6\u5916\u8FDE\u63A5\uFF08\u5DE6\u8FDE\u63A5\uFF09\uFF1A\u7ED3\u679C\u96C6\u51E0\u5305\u62EC\u8FDE\u63A5\u8868\u7684\u5339\u914D\u884C\uFF0C\u4E5F\u5305\u62EC\u5DE6\u8FDE\u63A5\u8868\u7684\u6240\u6709\u884C\u3002</p><p>SQL: select a.a, a.b, a.c, b.c, b.d, b.f from a LEFT OUT JOIN b ON a.a = b.c</p><p><strong>B\uFF1Aright \uFF08outer\uFF09 join:</strong></p><p>\u53F3\u5916\u8FDE\u63A5(\u53F3\u8FDE\u63A5)\uFF1A\u7ED3\u679C\u96C6\u65E2\u5305\u62EC\u8FDE\u63A5\u8868\u7684\u5339\u914D\u8FDE\u63A5\u884C\uFF0C\u4E5F\u5305\u62EC\u53F3\u8FDE\u63A5\u8868\u7684\u6240\u6709\u884C\u3002</p><p><strong>C\uFF1Afull/cross \uFF08outer\uFF09 join</strong>\uFF1A</p><p>\u5168\u5916\u8FDE\u63A5\uFF1A\u4E0D\u4EC5\u5305\u62EC\u7B26\u53F7\u8FDE\u63A5\u8868\u7684\u5339\u914D\u884C\uFF0C\u8FD8\u5305\u62EC\u4E24\u4E2A\u8FDE\u63A5\u8868\u4E2D\u7684\u6240\u6709\u8BB0\u5F55\u3002</p><p><strong>12</strong>**\u3001\u5206\u7EC4:Group by: **</p><p>\u4E00\u5F20\u8868\uFF0C\u4E00\u65E6\u5206\u7EC4 \u5B8C\u6210\u540E\uFF0C\u67E5\u8BE2\u540E\u53EA\u80FD\u5F97\u5230\u7EC4\u76F8\u5173\u7684\u4FE1\u606F\u3002</p><p><strong>\u7EC4\u76F8\u5173\u7684\u4FE1\u606F\uFF1A</strong>\uFF08\u7EDF\u8BA1\u4FE1\u606F\uFF09 count,sum,max,min,avg <strong>\u5206\u7EC4\u7684\u6807\u51C6)</strong></p><p><strong>\u5728SQLServer\u4E2D\u5206\u7EC4\u65F6\uFF1A\u4E0D\u80FD\u4EE5text,ntext,image\u7C7B\u578B\u7684\u5B57\u6BB5\u4F5C\u4E3A\u5206\u7EC4\u4F9D\u636E</strong></p><p><strong>\u5728selecte\u7EDF\u8BA1\u51FD\u6570\u4E2D\u7684\u5B57\u6BB5\uFF0C\u4E0D\u80FD\u548C\u666E\u901A\u7684\u5B57\u6BB5\u653E\u5728\u4E00\u8D77\uFF1B</strong></p><p><strong>13\u3001\u5BF9\u6570\u636E\u5E93\u8FDB\u884C\u64CD\u4F5C\uFF1A</strong></p><p>** **</p><p><strong>\u5206\u79BB\u6570\u636E\u5E93</strong>\uFF1A <strong>sp_detach_db;</strong></p><p><strong>\u9644\u52A0\u6570\u636E\u5E93</strong>\uFF1A<strong>sp_attach_db</strong> \u540E\u63A5\u8868\u660E\uFF0C\u9644\u52A0\u9700\u8981\u5B8C\u6574\u7684\u8DEF\u5F84\u540D</p><p>**14.**<strong>\u5982\u4F55\u4FEE\u6539\u6570\u636E\u5E93\u7684\u540D\u79F0:</strong></p><p>sp_renamedb &#39;old_name&#39;, &#39;new_name&#39;</p><p>\u5BF9\u4E86\uFF0C\u6211\u628A MySQL \u76F8\u5173\u7684\u6587\u7AE0\u6574\u7406\u6210\u4E86 PDF\uFF0C\u6709\u9700\u8981\u7684\u5173\u6CE8\u5FAE\u4FE1\u516C\u4F17\u53F7 Java\u540E\u7AEF\uFF0C\u56DE\u590D 666 \u4E0B\u8F7D\u3002</p><p><strong>\u4E8C\u3001\u63D0\u5347</strong></p><p>**1\u3001\u8BF4\u660E\uFF1A\u590D\u5236\u8868(\u53EA\u590D\u5236\u7ED3\u6784,\u6E90\u8868\u540D\uFF1Aa \u65B0\u8868\u540D\uFF1Ab) (Access\u53EF\u7528) **</p><p>**\u6CD5\u4E00\uFF1A**select * into b from a where 1&lt;&gt;1\uFF08\u4EC5\u7528\u4E8ESQlServer\uFF09</p><p>**\u6CD5\u4E8C\uFF1A**select top 0 * into b from a ** **</p><p>**2\u3001\u8BF4\u660E\uFF1A\u62F7\u8D1D\u8868(\u62F7\u8D1D\u6570\u636E,\u6E90\u8868\u540D\uFF1Aa \u76EE\u6807\u8868\u540D\uFF1Ab) (Access\u53EF\u7528) **</p><p>insert into b(a, b, c) select d,e,f from b;</p><p>**3\u3001\u8BF4\u660E\uFF1A\u8DE8\u6570\u636E\u5E93\u4E4B\u95F4\u8868\u7684\u62F7\u8D1D(\u5177\u4F53\u6570\u636E\u4F7F\u7528\u7EDD\u5BF9\u8DEF\u5F84) (Access\u53EF\u7528) **</p><p>insert into b(a, b, c) select d,e,f from b in \u2018\u5177\u4F53\u6570\u636E\u5E93\u2019 where \u6761\u4EF6 \u4F8B\u5B50\uFF1A..from b in &#39;&quot;&amp;Server.MapPath(&quot;.&quot;)&amp;&quot;\\data.mdb&quot; &amp;&quot;&#39; where..</p><p>**4\u3001\u8BF4\u660E\uFF1A\u5B50\u67E5\u8BE2(\u8868\u540D1\uFF1Aa \u8868\u540D2\uFF1Ab) **</p><p>select a,b,c from a where a IN (select d from b ) \u6216\u8005: select a,b,c from a where a IN (1,2,3)</p><p>**5\u3001\u8BF4\u660E\uFF1A\u663E\u793A\u6587\u7AE0\u3001\u63D0\u4EA4\u4EBA\u548C\u6700\u540E\u56DE\u590D\u65F6\u95F4 **</p><p>select a.title,a.username,b.adddate from table a,(select max(adddate) adddate from table where table.title=a.title) b</p><p>**6\u3001\u8BF4\u660E\uFF1A\u5916\u8FDE\u63A5\u67E5\u8BE2(\u8868\u540D1\uFF1Aa \u8868\u540D2\uFF1Ab) **</p><p>select a.a, a.b, a.c, b.c, b.d, b.f from a LEFT OUT JOIN b ON a.a = b.c</p><p>**7\u3001\u8BF4\u660E\uFF1A\u5728\u7EBF\u89C6\u56FE\u67E5\u8BE2(\u8868\u540D1\uFF1Aa ) **select * from (SELECT a,b,c FROM a) T where t.a &gt; 1;</p><p>**8\u3001\u8BF4\u660E\uFF1Abetween\u7684\u7528\u6CD5,between\u9650\u5236\u67E5\u8BE2\u6570\u636E\u8303\u56F4\u65F6\u5305\u62EC\u4E86\u8FB9\u754C\u503C,not between\u4E0D\u5305\u62EC **</p><p>select * from table1 where time between time1 and time2 select a,b,c, from table1 where a not between \u6570\u503C1 and \u6570\u503C2</p><p>**9\u3001\u8BF4\u660E\uFF1Ain \u7684\u4F7F\u7528\u65B9\u6CD5 **</p><p>select * from table1 where a [not] in (\u2018\u503C1\u2019,\u2019\u503C2\u2019,\u2019\u503C4\u2019,\u2019\u503C6\u2019)</p><p>**10\u3001\u8BF4\u660E\uFF1A\u4E24\u5F20\u5173\u8054\u8868\uFF0C\u5220\u9664\u4E3B\u8868\u4E2D\u5DF2\u7ECF\u5728\u526F\u8868\u4E2D\u6CA1\u6709\u7684\u4FE1\u606F **</p><p>delete from table1 where not exists ( select * from table2 where table1.field1=table2.field1 )</p><p>**11\u3001\u8BF4\u660E\uFF1A\u56DB\u8868\u8054\u67E5\u95EE\u9898\uFF1A **</p><p>select * from a left inner join b on a.a=b.b right inner join c on a.a=c.c inner join d on a.a=d.d where .....</p><p>**12\u3001\u8BF4\u660E\uFF1A\u65E5\u7A0B\u5B89\u6392\u63D0\u524D\u4E94\u5206\u949F\u63D0\u9192 **</p><p>SQL: select * from \u65E5\u7A0B\u5B89\u6392 where datediff(&#39;minute&#39;,f\u5F00\u59CB\u65F6\u95F4,getdate())&gt;5</p><p><strong>13</strong>**\u3001\u8BF4\u660E\uFF1A\u4E00\u6761****sql** <strong>\u8BED\u53E5\u641E\u5B9A\u6570\u636E\u5E93\u5206\u9875</strong></p><p>select top 10 b.* from (select top 20 \u4E3B\u952E\u5B57\u6BB5,\u6392\u5E8F\u5B57\u6BB5 from \u8868\u540D order by \u6392\u5E8F\u5B57\u6BB5 desc) a,\u8868\u540D b where b.\u4E3B\u952E\u5B57\u6BB5 = a.\u4E3B\u952E\u5B57\u6BB5 order by a.\u6392\u5E8F\u5B57\u6BB5</p><p>** **</p><p>**\u5177\u4F53\u5B9E\u73B0\uFF1A**\u5173\u4E8E\u6570\u636E\u5E93\u5206\u9875\uFF1A</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">declare</span> <span class="token variable">@start</span> <span class="token keyword">int</span><span class="token punctuation">,</span><span class="token variable">@end</span> <span class="token keyword">int</span>
  <span class="token variable">@sql</span>  nvarchar<span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">)</span>
  <span class="token keyword">set</span> <span class="token variable">@sql</span><span class="token operator">=</span>\u2019<span class="token keyword">select</span> <span class="token keyword">top</span>\u2019<span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token variable">@end</span><span class="token operator">-</span><span class="token variable">@start</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>\u2019<span class="token operator">+</span><span class="token keyword">from</span> T <span class="token keyword">where</span> rid <span class="token operator">not</span> <span class="token operator">in</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">top</span>\u2019<span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token variable">@str</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>\u2019Rid <span class="token keyword">from</span> T <span class="token keyword">where</span> Rid<span class="token operator">&gt;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>\u2019
  <span class="token keyword">exec</span> sp_executesql <span class="token variable">@sql</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>**\u6CE8\u610F\uFF1A**\u5728top\u540E\u4E0D\u80FD\u76F4\u63A5\u8DDF\u4E00\u4E2A\u53D8\u91CF\uFF0C\u6240\u4EE5\u5728\u5B9E\u9645\u5E94\u7528\u4E2D\u53EA\u6709\u8FD9\u6837\u7684\u8FDB\u884C\u7279\u6B8A\u7684\u5904\u7406\u3002Rid\u4E3A\u4E00\u4E2A\u6807\u8BC6\u5217\uFF0C\u5982\u679Ctop\u540E\u8FD8\u6709\u5177\u4F53\u7684\u5B57\u6BB5\uFF0C\u8FD9\u6837\u505A\u662F\u975E\u5E38\u6709\u597D\u5904\u7684\u3002\u56E0\u4E3A\u8FD9\u6837\u53EF\u4EE5\u907F\u514D top\u7684\u5B57\u6BB5\u5982\u679C\u662F\u903B\u8F91\u7D22\u5F15\u7684\uFF0C\u67E5\u8BE2\u7684\u7ED3\u679C\u540E\u5B9E\u9645\u8868\u4E2D\u7684\u4E0D\u4E00\u81F4\uFF08\u903B\u8F91\u7D22\u5F15\u4E2D\u7684\u6570\u636E\u6709\u53EF\u80FD\u548C\u6570\u636E\u8868\u4E2D\u7684\u4E0D\u4E00\u81F4\uFF0C\u800C\u67E5\u8BE2\u65F6\u5982\u679C\u5904\u5728\u7D22\u5F15\u5219\u9996\u5148\u67E5\u8BE2\u7D22\u5F15\uFF09</p><p>**14\u3001\u8BF4\u660E\uFF1A\u524D10\u6761\u8BB0\u5F55 **</p><p>select top 10 * form table1 where \u8303\u56F4</p><p>**15\u3001\u8BF4\u660E\uFF1A<strong>\u9009\u62E9\u5728\u6BCF\u4E00\u7EC4b\u503C\u76F8\u540C\u7684\u6570\u636E\u4E2D\u5BF9\u5E94\u7684a\u6700\u5927\u7684\u8BB0\u5F55\u7684\u6240\u6709\u4FE1\u606F(\u7C7B\u4F3C\u8FD9\u6837\u7684\u7528\u6CD5\u53EF\u4EE5\u7528\u4E8E\u8BBA\u575B\u6BCF\u6708\u6392\u884C\u699C,\u6BCF\u6708\u70ED\u9500\u4EA7\u54C1\u5206\u6790,\u6309\u79D1\u76EE\u6210\u7EE9\u6392\u540D,\u7B49\u7B49.)</strong> **</p><p>select a,b,c from tablename ta where a=(select max(a) from tablename tb where tb.b=ta.b)</p><p>**16\u3001\u8BF4\u660E\uFF1A<strong>\u5305\u62EC\u6240\u6709\u5728 TableA\u4E2D\u4F46\u4E0D\u5728 TableB\u548CTableC\u4E2D\u7684\u884C\u5E76\u6D88\u9664\u6240\u6709\u91CD\u590D\u884C\u800C\u6D3E\u751F\u51FA\u4E00\u4E2A\u7ED3\u679C\u8868</strong> **</p><p>(select a from tableA ) except (select a from tableB) except (select a from tableC)</p><p>**17\u3001\u8BF4\u660E\uFF1A\u968F\u673A\u53D6\u51FA10\u6761\u6570\u636E **</p><p>select top 10 * from tablename order by newid()</p><p>**18\u3001\u8BF4\u660E\uFF1A\u968F\u673A\u9009\u62E9\u8BB0\u5F55 **</p><p>select newid()</p><p>**19\u3001\u8BF4\u660E\uFF1A\u5220\u9664\u91CD\u590D\u8BB0\u5F55 **</p><p><strong>1)</strong> delete from tablename where id not in (select max(id) from tablename group by col1,col2,...)</p><p><strong>2)</strong> select distinct * into temp from tablename delete from tablename insert into tablename select * from temp ** **</p><p>**\u8BC4\u4EF7\uFF1A**\u8FD9\u79CD\u64CD\u4F5C\u7275\u8FDE\u5927\u91CF\u7684\u6570\u636E\u7684\u79FB\u52A8\uFF0C\u8FD9\u79CD\u505A\u6CD5\u4E0D\u9002\u5408\u5927\u5BB9\u91CF\u4F46\u6570\u636E\u64CD\u4F5C3),\u4F8B\u5982\uFF1A\u5728\u4E00\u4E2A\u5916\u90E8\u8868\u4E2D\u5BFC\u5165\u6570\u636E\uFF0C\u7531\u4E8E\u67D0\u4E9B\u539F\u56E0\u7B2C\u4E00\u6B21\u53EA\u5BFC\u5165\u4E86\u4E00\u90E8\u5206\uFF0C\u4F46\u5F88\u96BE\u5224\u65AD\u5177\u4F53\u4F4D\u7F6E\uFF0C\u8FD9\u6837\u53EA\u6709\u5728\u4E0B\u4E00\u6B21\u5168\u90E8\u5BFC\u5165\uFF0C\u8FD9\u6837\u4E5F\u5C31\u4EA7\u751F\u597D\u591A\u91CD\u590D\u7684\u5B57\u6BB5\uFF0C\u600E\u6837\u5220\u9664\u91CD\u590D\u5B57\u6BB5</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> tablename
<span class="token comment">--\u6DFB\u52A0\u4E00\u4E2A\u81EA\u589E\u5217</span>
<span class="token keyword">add</span>  column_b <span class="token keyword">int</span> <span class="token keyword">identity</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
 <span class="token keyword">delete</span> <span class="token keyword">from</span> tablename <span class="token keyword">where</span> column_b <span class="token operator">not</span> <span class="token operator">in</span><span class="token punctuation">(</span>
<span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>column_b<span class="token punctuation">)</span> <span class="token keyword">from</span> tablename <span class="token keyword">group</span> <span class="token keyword">by</span> column1<span class="token punctuation">,</span>column2<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> tablename <span class="token keyword">drop</span> <span class="token keyword">column</span> column_b
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>**20\u3001\u8BF4\u660E\uFF1A\u5217\u51FA\u6570\u636E\u5E93\u91CC\u6240\u6709\u7684\u8868\u540D **</p><p>select name from sysobjects where type=&#39;U&#39; // U\u4EE3\u8868\u7528\u6237</p><p>**21\u3001\u8BF4\u660E\uFF1A\u5217\u51FA\u8868\u91CC\u7684\u6240\u6709\u7684\u5217\u540D **</p><p>select name from syscolumns where id=object_id(&#39;TableName&#39;)</p><p>**22\u3001\u8BF4\u660E\uFF1A<strong>\u5217\u793Atype\u3001vender\u3001pcs\u5B57\u6BB5\uFF0C\u4EE5type\u5B57\u6BB5\u6392\u5217\uFF0Ccase\u53EF\u4EE5\u65B9\u4FBF\u5730\u5B9E\u73B0\u591A\u91CD\u9009\u62E9\uFF0C\u7C7B\u4F3Cselect \u4E2D\u7684case\u3002</strong> **</p><p>select type,sum(case vender when &#39;A&#39; then pcs else 0 end),sum(case vender when &#39;C&#39; then pcs else 0 end),sum(case vender when &#39;B&#39; then pcs else 0 end) FROM tablename group by type ** **</p><p>**\u663E\u793A\u7ED3\u679C\uFF1A type vender pcs **\u7535\u8111 A 1 \u7535\u8111 A 1 \u5149\u76D8 B 2 \u5149\u76D8 A 2 \u624B\u673A B 3 \u624B\u673A C 3</p><p><strong>23\u3001\u8BF4\u660E\uFF1A\u521D\u59CB\u5316\u8868table1</strong></p><p>TRUNCATE TABLE table1</p><p>**24\u3001\u8BF4\u660E\uFF1A\u9009\u62E9\u4ECE10\u523015\u7684\u8BB0\u5F55 **</p><p>select top 5 * from (select top 15 * from table order by id asc) table_\u522B\u540D order by id desc</p><p><strong>\u4E09\u3001\u6280\u5DE7</strong></p><p><strong>1\u30011=1\uFF0C1=2\u7684\u4F7F\u7528\uFF0C\u5728SQL\u8BED\u53E5\u7EC4\u5408\u65F6\u7528\u7684\u8F83\u591A</strong></p><p><strong>\u201Cwhere 1=1\u201D \u662F\u8868\u793A\u9009\u62E9\u5168\u90E8 \u201Cwhere 1=2\u201D\u5168\u90E8\u4E0D\u9009\uFF0C</strong> \u5982\uFF1A</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">if</span> <span class="token variable">@strWhere</span> <span class="token operator">!=</span><span class="token string">&#39;&#39;</span> 
<span class="token keyword">begin</span>
<span class="token keyword">set</span> <span class="token variable">@strSQL</span> <span class="token operator">=</span> <span class="token string">&#39;select count(*) as Total from [&#39;</span> <span class="token operator">+</span> <span class="token variable">@tblName</span> <span class="token operator">+</span> <span class="token string">&#39;] where &#39;</span> <span class="token operator">+</span> <span class="token variable">@strWhere</span>
<span class="token keyword">end</span>
<span class="token keyword">else</span> 
<span class="token keyword">begin</span>
<span class="token keyword">set</span> <span class="token variable">@strSQL</span> <span class="token operator">=</span> <span class="token string">&#39;select count(*) as Total from [&#39;</span> <span class="token operator">+</span> <span class="token variable">@tblName</span> <span class="token operator">+</span> <span class="token string">&#39;]&#39;</span> 
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6211\u4EEC\u53EF\u4EE5\u76F4\u63A5\u5199\u6210</strong></p><p>set @strSQL = &#39;select count(*) as Total from [&#39; + @tblName + &#39;] where 1=1 \u5B89\u5B9A &#39;+ @strWhere</p><p>** **</p><p><strong>2\u3001\u6536\u7F29\u6570\u636E\u5E93</strong></p><p>** **--\u91CD\u5EFA\u7D22\u5F15 DBCC REINDEX DBCC INDEXDEFRAG --\u6536\u7F29\u6570\u636E\u548C\u65E5\u5FD7 DBCC SHRINKDB DBCC SHRINKFILE</p><p><strong>3\u3001\u538B\u7F29\u6570\u636E\u5E93</strong></p><p>** **dbcc shrinkdatabase(dbname)</p><p><strong>4\u3001\u8F6C\u79FB\u6570\u636E\u5E93\u7ED9\u65B0\u7528\u6237\u4EE5\u5DF2\u5B58\u5728\u7528\u6237\u6743\u9650</strong></p><p>** **exec sp_change_users_login &#39;update_one&#39;,&#39;newname&#39;,&#39;oldname&#39; go</p><p>**5\u3001\u68C0\u67E5\u5907\u4EFD\u96C6 **RESTORE VERIFYONLY from disk=&#39;E:\\dvbbs.bak&#39;</p><p><strong>6\u3001\u4FEE\u590D\u6570\u636E\u5E93</strong></p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> <span class="token punctuation">[</span>dvbbs<span class="token punctuation">]</span> <span class="token keyword">SET</span> SINGLE_USER
GO
<span class="token keyword">DBCC</span> CHECKDB<span class="token punctuation">(</span><span class="token string">&#39;dvbbs&#39;</span><span class="token punctuation">,</span>repair_allow_data_loss<span class="token punctuation">)</span> <span class="token keyword">WITH</span> TABLOCK
GO
<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> <span class="token punctuation">[</span>dvbbs<span class="token punctuation">]</span> <span class="token keyword">SET</span> MULTI_USER
GO
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>7\u3001\u65E5\u5FD7\u6E05\u9664</strong></p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SET</span> NOCOUNT <span class="token keyword">ON</span>
<span class="token keyword">DECLARE</span> <span class="token variable">@LogicalFileName</span> sysname<span class="token punctuation">,</span>
 <span class="token variable">@MaxMinutes</span> <span class="token keyword">INT</span><span class="token punctuation">,</span>
 <span class="token variable">@NewSize</span> <span class="token keyword">INT</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">USE</span> tablename <span class="token comment">-- \u8981\u64CD\u4F5C\u7684\u6570\u636E\u5E93\u540D</span>
<span class="token keyword">SELECT</span> <span class="token variable">@LogicalFileName</span> <span class="token operator">=</span> <span class="token string">&#39;tablename_log&#39;</span><span class="token punctuation">,</span> <span class="token comment">-- \u65E5\u5FD7\u6587\u4EF6\u540D</span>
<span class="token variable">@MaxMinutes</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment">-- Limit on time allowed to wrap log.</span>
 <span class="token variable">@NewSize</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">-- \u4F60\u60F3\u8BBE\u5B9A\u7684\u65E5\u5FD7\u6587\u4EF6\u7684\u5927\u5C0F(M)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>Setup <span class="token operator">/</span> initialize
<span class="token keyword">DECLARE</span> <span class="token variable">@OriginalSize</span> <span class="token keyword">int</span>
<span class="token keyword">SELECT</span> <span class="token variable">@OriginalSize</span> <span class="token operator">=</span> size 
 <span class="token keyword">FROM</span> sysfiles
 <span class="token keyword">WHERE</span> name <span class="token operator">=</span> <span class="token variable">@LogicalFileName</span>
<span class="token keyword">SELECT</span> <span class="token string">&#39;Original Size of &#39;</span> <span class="token operator">+</span> db_name<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39; LOG is &#39;</span> <span class="token operator">+</span> 
 <span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">@OriginalSize</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39; 8K pages or &#39;</span> <span class="token operator">+</span> 
 <span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token variable">@OriginalSize</span><span class="token operator">*</span><span class="token number">8</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;MB&#39;</span>
 <span class="token keyword">FROM</span> sysfiles
 <span class="token keyword">WHERE</span> name <span class="token operator">=</span> <span class="token variable">@LogicalFileName</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> DummyTrans
 <span class="token punctuation">(</span>DummyColumn <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@Counter</span>  <span class="token keyword">INT</span><span class="token punctuation">,</span>
 <span class="token variable">@StartTime</span> <span class="token keyword">DATETIME</span><span class="token punctuation">,</span>
 <span class="token variable">@TruncLog</span>  <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> <span class="token variable">@StartTime</span> <span class="token operator">=</span> GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token variable">@TruncLog</span> <span class="token operator">=</span> <span class="token string">&#39;BACKUP LOG &#39;</span> <span class="token operator">+</span> db_name<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39; WITH TRUNCATE_ONLY&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DBCC</span> SHRINKFILE <span class="token punctuation">(</span><span class="token variable">@LogicalFileName</span><span class="token punctuation">,</span> <span class="token variable">@NewSize</span><span class="token punctuation">)</span>
<span class="token keyword">EXEC</span> <span class="token punctuation">(</span><span class="token variable">@TruncLog</span><span class="token punctuation">)</span>
<span class="token comment">-- Wrap the log if necessary.</span>
<span class="token keyword">WHILE</span> <span class="token variable">@MaxMinutes</span> <span class="token operator">&gt;</span> DATEDIFF <span class="token punctuation">(</span>mi<span class="token punctuation">,</span> <span class="token variable">@StartTime</span><span class="token punctuation">,</span> GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- time has not expired</span>
 <span class="token operator">AND</span> <span class="token variable">@OriginalSize</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> size <span class="token keyword">FROM</span> sysfiles <span class="token keyword">WHERE</span> name <span class="token operator">=</span> <span class="token variable">@LogicalFileName</span><span class="token punctuation">)</span> 
 <span class="token operator">AND</span> <span class="token punctuation">(</span><span class="token variable">@OriginalSize</span> <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token variable">@NewSize</span> 
 <span class="token keyword">BEGIN</span> <span class="token comment">-- Outer loop.</span>
<span class="token keyword">SELECT</span> <span class="token variable">@Counter</span> <span class="token operator">=</span> <span class="token number">0</span>
 <span class="token keyword">WHILE</span>  <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">@Counter</span> <span class="token operator">&lt;</span> <span class="token variable">@OriginalSize</span> <span class="token operator">/</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token punctuation">(</span><span class="token variable">@Counter</span> <span class="token operator">&lt;</span> <span class="token number">50000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token keyword">BEGIN</span> <span class="token comment">-- update</span>
 <span class="token keyword">INSERT</span> DummyTrans <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;Fill Log&#39;</span><span class="token punctuation">)</span> <span class="token keyword">DELETE</span> DummyTrans
 <span class="token keyword">SELECT</span> <span class="token variable">@Counter</span> <span class="token operator">=</span> <span class="token variable">@Counter</span> <span class="token operator">+</span> <span class="token number">1</span>
 <span class="token keyword">END</span>
 <span class="token keyword">EXEC</span> <span class="token punctuation">(</span><span class="token variable">@TruncLog</span><span class="token punctuation">)</span> 
 <span class="token keyword">END</span>
<span class="token keyword">SELECT</span> <span class="token string">&#39;Final Size of &#39;</span> <span class="token operator">+</span> db_name<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39; LOG is &#39;</span> <span class="token operator">+</span>
 <span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>size<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39; 8K pages or &#39;</span> <span class="token operator">+</span> 
 <span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>size<span class="token operator">*</span><span class="token number">8</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;MB&#39;</span>
 <span class="token keyword">FROM</span> sysfiles 
 <span class="token keyword">WHERE</span> name <span class="token operator">=</span> <span class="token variable">@LogicalFileName</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> DummyTrans
<span class="token keyword">SET</span> NOCOUNT <span class="token keyword">OFF</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>8\u3001\u8BF4\u660E\uFF1A\u66F4\u6539\u67D0\u4E2A\u8868</strong></p><p>** **exec sp_changeobjectowner &#39;tablename&#39;,&#39;dbo&#39;</p><p><strong>9\u3001\u5B58\u50A8\u66F4\u6539\u5168\u90E8\u8868</strong></p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> dbo<span class="token punctuation">.</span>User_ChangeObjectOwnerBatch
<span class="token variable">@OldOwner</span> <span class="token keyword">as</span> NVARCHAR<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token variable">@NewOwner</span> <span class="token keyword">as</span> NVARCHAR<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>
<span class="token keyword">AS</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@Name</span>  <span class="token keyword">as</span> NVARCHAR<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>
<span class="token keyword">DECLARE</span> <span class="token variable">@Owner</span>  <span class="token keyword">as</span> NVARCHAR<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>
<span class="token keyword">DECLARE</span> <span class="token variable">@OwnerName</span>  <span class="token keyword">as</span> NVARCHAR<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> curObject <span class="token keyword">CURSOR</span> <span class="token keyword">FOR</span> 
<span class="token keyword">select</span> <span class="token string">&#39;Name&#39;</span>  <span class="token operator">=</span> name<span class="token punctuation">,</span>
  <span class="token string">&#39;Owner&#39;</span>  <span class="token operator">=</span> user_name<span class="token punctuation">(</span>uid<span class="token punctuation">)</span>
<span class="token keyword">from</span> sysobjects
<span class="token keyword">where</span> user_name<span class="token punctuation">(</span>uid<span class="token punctuation">)</span><span class="token operator">=</span><span class="token variable">@OldOwner</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> name
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">OPEN</span>  curObject
<span class="token keyword">FETCH</span> <span class="token keyword">NEXT</span> <span class="token keyword">FROM</span> curObject <span class="token keyword">INTO</span> <span class="token variable">@Name</span><span class="token punctuation">,</span> <span class="token variable">@Owner</span>
<span class="token keyword">WHILE</span><span class="token punctuation">(</span>@<span class="token variable">@FETCH_STATUS</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>   
<span class="token keyword">if</span> <span class="token variable">@Owner</span><span class="token operator">=</span><span class="token variable">@OldOwner</span> 
<span class="token keyword">begin</span>
  <span class="token keyword">set</span> <span class="token variable">@OwnerName</span> <span class="token operator">=</span> <span class="token variable">@OldOwner</span> <span class="token operator">+</span> <span class="token string">&#39;.&#39;</span> <span class="token operator">+</span> rtrim<span class="token punctuation">(</span><span class="token variable">@Name</span><span class="token punctuation">)</span>
  <span class="token keyword">exec</span> sp_changeobjectowner <span class="token variable">@OwnerName</span><span class="token punctuation">,</span> <span class="token variable">@NewOwner</span>
<span class="token keyword">end</span>
<span class="token comment">-- select @name,@NewOwner,@OldOwner</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">FETCH</span> <span class="token keyword">NEXT</span> <span class="token keyword">FROM</span> curObject <span class="token keyword">INTO</span> <span class="token variable">@Name</span><span class="token punctuation">,</span> <span class="token variable">@Owner</span>
<span class="token keyword">END</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">close</span> curObject
<span class="token keyword">deallocate</span> curObject
GO
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>10\u3001SQL SERVER\u4E2D\u76F4\u63A5\u5FAA\u73AF\u5199\u5165\u6570\u636E</strong></p><p>** **declare @i int set @i=1 while @i&lt;30 begin insert into test (userid) values(@i) set @i=@i+1 end ** **</p><p><strong>\u6848\u4F8B</strong>**\uFF1A**</p><p>** **\u6709\u5982\u4E0B\u8868\uFF0C\u8981\u6C42\u5C31\u88F1\u4E2D\u6240\u6709\u6C92\u6709\u53CA\u683C\u7684\u6210\u7E3E\uFF0C\u5728\u6BCF\u6B21\u589E\u95770.1\u7684\u57FA\u790E\u4E0A\uFF0C\u4F7F\u4ED6\u5011\u525B\u597D\u53CA\u683C:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Name   scor
Zhangshan 80
Lishi 59
Wangwu 50
Songquan 69
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>while((select</strong> <strong>min</strong>**(score) from tb_table)&lt;<strong><strong>60</strong></strong>)**</p><p><strong>begin</strong></p><p><strong>update tb_table set score</strong> **=****score***<strong>1.01</strong></p><p><strong>where score</strong>**&lt;60**</p><p><strong>if (select</strong> <strong>min</strong>**(score) from tb_table)****&gt;60**</p><p><strong>break</strong></p><p><strong>else</strong></p><p><strong>continue</strong></p><p><strong>end</strong></p><p><strong>\u6570\u636E\u5F00\u53D1-\u7ECF\u5178</strong></p><p><strong>1.\u6309\u59D3\u6C0F\u7B14\u753B\u6392\u5E8F:</strong></p><p>** **</p><p>Select * From TableName Order By CustomerName Collate Chinese_PRC_Stroke_ci_as //\u4ECE\u5C11\u5230\u591A</p><p><strong>2.\u6570\u636E\u5E93\u52A0\u5BC6:</strong></p><p>select encrypt(&#39;\u539F\u59CB\u5BC6\u7801&#39;) select pwdencrypt(&#39;\u539F\u59CB\u5BC6\u7801&#39;) select pwdcompare(&#39;\u539F\u59CB\u5BC6\u7801&#39;,&#39;\u52A0\u5BC6\u540E\u5BC6\u7801&#39;) = 1--\u76F8\u540C\uFF1B\u5426\u5219\u4E0D\u76F8\u540C encrypt(&#39;\u539F\u59CB\u5BC6\u7801&#39;) select pwdencrypt(&#39;\u539F\u59CB\u5BC6\u7801&#39;) select pwdcompare(&#39;\u539F\u59CB\u5BC6\u7801&#39;,&#39;\u52A0\u5BC6\u540E\u5BC6\u7801&#39;) = 1--\u76F8\u540C\uFF1B\u5426\u5219\u4E0D\u76F8\u540C</p><p><strong>3.\u53D6\u56DE\u8868\u4E2D\u5B57\u6BB5:</strong></p>`,161),u=n("declare @list varchar(1000), @sql nvarchar(1000) select @list=@list+','+"),d={href:"http://b.name",target:"_blank",rel:"noopener noreferrer"},k=n("b.name"),m=n(" from sysobjects a,syscolumns b where "),v={href:"http://a.id=b.id",target:"_blank",rel:"noopener noreferrer"},b=n("a.id=b.id"),g=n(" and a.name='\u8868A' set @sql='select '+right(@list,len(@list)-1)+' from \u8868A' exec (@sql)"),w=p('<p><strong>4.\u67E5\u770B\u786C\u76D8\u5206\u533A:</strong></p><p><strong>EXEC master..xp_fixeddrives</strong></p><p><strong>5.\u6BD4\u8F83A,B\u8868\u662F\u5426\u76F8\u7B49:</strong></p><h1 id="if-select-checksum-agg-binary-checksum-from-a" tabindex="-1"><a class="header-anchor" href="#if-select-checksum-agg-binary-checksum-from-a" aria-hidden="true">#</a> if (select checksum_agg(binary_checksum(*)) from A)</h1><p>(select checksum_agg(binary_checksum(*)) from B) print &#39;\u76F8\u7B49&#39; else print &#39;\u4E0D\u76F8\u7B49&#39;</p><p><strong>6.\u6740\u6389\u6240\u6709\u7684\u4E8B\u4EF6\u63A2\u5BDF\u5668\u8FDB\u7A0B:</strong></p><p>DECLARE hcforeach CURSOR GLOBAL FOR SELECT &#39;kill &#39;+RTRIM(spid) FROM master.dbo.sysprocesses WHERE program_name IN(&#39;SQL profiler&#39;,N&#39;SQL \u4E8B\u4EF6\u63A2\u67E5\u5668&#39;) EXEC sp_msforeach_worker &#39;?&#39;</p><p><strong>7.<strong><strong>\u8BB0\u5F55\u641C\u7D22</strong></strong>:</strong></p><p>** **</p><p><strong>\u5F00\u5934\u5230<strong><strong>N</strong></strong>\u6761\u8BB0\u5F55</strong>Select Top N * From \u8868</p><p>------------------------------- **N<strong><strong>\u5230</strong></strong>M<strong><strong>\u6761\u8BB0\u5F55</strong></strong>(<strong><strong>\u8981\u6709\u4E3B\u7D22\u5F15</strong></strong>ID) **Select Top M-N * From \u8868 Where ID in (Select Top M ID From \u8868) Order by ID Desc ---------------------------------- <strong>N****\u5230\u7ED3\u5C3E\u8BB0\u5F55</strong>Select Top N * From \u8868 Order by ID Desc <strong>\u6848\u4F8B<strong><strong>\u4F8B\u59821\uFF1A\u4E00\u5F20\u8868\u6709\u4E00\u4E07\u591A\u6761\u8BB0\u5F55\uFF0C\u8868\u7684\u7B2C\u4E00\u4E2A\u5B57\u6BB5 RecID \u662F\u81EA\u589E\u957F\u5B57\u6BB5\uFF0C \u5199\u4E00\u4E2ASQL\u8BED\u53E5\uFF0C \u627E\u51FA\u8868\u7684\u7B2C</strong></strong>31<strong><strong>\u5230\u7B2C</strong></strong>40****\u4E2A\u8BB0\u5F55\u3002</strong></p><p>select top 10 recid from A where recid not in(select top 30 recid from A)</p><p>\u5206\u6790\uFF1A\u5982\u679C\u8FD9\u6837\u5199\u4F1A\u4EA7\u751F\u67D0\u4E9B\u95EE\u9898\uFF0C\u5982\u679Crecid\u5728\u8868\u4E2D\u5B58\u5728\u903B\u8F91\u7D22\u5F15\u3002</p><p>select top 10 recid from A where\u2026\u2026\u662F\u4ECE\u7D22\u5F15\u4E2D\u67E5\u627E\uFF0C\u800C\u540E\u9762\u7684select top 30 recid from A\u5219\u5728\u6570\u636E\u8868\u4E2D\u67E5\u627E\uFF0C\u8FD9\u6837\u7531\u4E8E\u7D22\u5F15\u4E2D\u7684\u987A\u5E8F\u6709\u53EF\u80FD\u548C\u6570\u636E\u8868\u4E2D\u7684\u4E0D\u4E00\u81F4\uFF0C\u8FD9\u6837\u5C31\u5BFC\u81F4\u67E5\u8BE2\u5230\u7684\u4E0D\u662F\u672C\u6765\u7684\u6B32\u5F97\u5230\u7684\u6570\u636E\u3002</p><p><strong>\u89E3\u51B3\u65B9\u6848</strong></p><p>**1\uFF0C**<strong>\u7528order by</strong> select top 30 recid from A order by ricid <strong>\u5982\u679C\u8BE5\u5B57\u6BB5\u4E0D\u662F\u81EA\u589E\u957F\uFF0C\u5C31\u4F1A\u51FA\u73B0\u95EE\u9898</strong></p><p>**2\uFF0C****\u5728\u90A3\u4E2A\u5B50\u67E5\u8BE2\u4E2D\u4E5F\u52A0\u6761\u4EF6\uFF1A**select top 30 recid from A where recid&gt;-1</p><p><strong>\u4F8B2</strong>**\uFF1A\u67E5\u8BE2\u8868\u4E2D\u7684\u6700\u540E\u4EE5\u6761\u8BB0\u5F55\uFF0C\u5E76\u4E0D\u77E5\u9053\u8FD9\u4E2A\u8868\u5171\u6709\u591A\u5C11\u6570\u636E,**<strong>\u4EE5\u53CA\u8868\u7ED3\u6784\u3002 set @s = &#39;select top 1 * from T where pid not in (select top &#39; + str(@count-1) + &#39; pid from T)&#39;</strong></p><p><strong>print @s exec sp_executesql @s</strong></p><p><strong>9\uFF1A\u83B7\u53D6\u5F53\u524D\u6570\u636E\u5E93\u4E2D\u7684\u6240\u6709\u7528\u6237\u8868</strong></p><p>** **</p><p>select Name from sysobjects where xtype=&#39;u&#39; and status&gt;=0</p><p><strong>10\uFF1A\u83B7\u53D6\u67D0\u4E00\u4E2A\u8868\u7684\u6240\u6709\u5B57\u6BB5</strong></p><p>** **select name from syscolumns where id=object_id(&#39;\u8868\u540D&#39;)</p><p>select name from syscolumns where id in (select id from sysobjects where type = &#39;u&#39; and name = &#39;\u8868\u540D&#39;)</p><p>\u4E24\u79CD\u65B9\u5F0F\u7684\u6548\u679C\u76F8\u540C</p><p><strong>11\uFF1A\u67E5\u770B\u4E0E\u67D0\u4E00\u4E2A\u8868\u76F8\u5173\u7684\u89C6\u56FE\u3001\u5B58\u50A8\u8FC7\u7A0B\u3001\u51FD\u6570</strong></p>',27),y=n("select a.* from sysobjects a, syscomments b where "),h={href:"http://a.id",target:"_blank",rel:"noopener noreferrer"},E=n("a.id"),S=n(" = "),f={href:"http://b.id",target:"_blank",rel:"noopener noreferrer"},L=n("b.id"),T=n(" and b.text like '%\u8868\u540D%'"),_=p(`<p><strong>12\uFF1A\u67E5\u770B\u5F53\u524D\u6570\u636E\u5E93\u4E2D\u6240\u6709\u5B58\u50A8\u8FC7\u7A0B</strong></p><p>** **select name as \u5B58\u50A8\u8FC7\u7A0B\u540D\u79F0 from sysobjects where xtype=&#39;P&#39;</p><p><strong>13\uFF1A\u67E5\u8BE2\u7528\u6237\u521B\u5EFA\u7684\u6240\u6709\u6570\u636E\u5E93</strong></p><p>select * from master..sysdatabases D where sid not in(select sid from master..syslogins where name=&#39;sa&#39;) \u6216\u8005 select dbid, name AS DB_NAME from master..sysdatabases where sid &lt;&gt; 0x01</p><p><strong>14\uFF1A\u67E5\u8BE2\u67D0\u4E00\u4E2A\u8868\u7684\u5B57\u6BB5\u548C\u6570\u636E\u7C7B\u578B</strong></p><p>** **select column_name,data_type from information_schema.columns where table_name = &#39;\u8868\u540D&#39;</p><p><strong>15</strong>**\uFF1A\u4E0D\u540C\u670D\u52A1\u5668\u6570\u636E\u5E93\u4E4B\u95F4\u7684\u6570\u636E\u64CD\u4F5C**</p><p>** **</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">--\u521B\u5EFA\u94FE\u63A5\u670D\u52A1\u5668</span>

<span class="token keyword">exec</span> sp_addlinkedserver <span class="token string">&#39;ITSV &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;SQLOLEDB &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;\u8FDC\u7A0B\u670D\u52A1\u5668\u540D\u6216ip\u5730\u5740 &#39;</span>

<span class="token keyword">exec</span> sp_addlinkedsrvlogin <span class="token string">&#39;ITSV &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;false &#39;</span><span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">&#39;\u7528\u6237\u540D &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;\u5BC6\u7801 &#39;</span>

<span class="token comment">--\u67E5\u8BE2\u793A\u4F8B</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> ITSV<span class="token punctuation">.</span>\u6570\u636E\u5E93\u540D<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>\u8868\u540D

<span class="token comment">--\u5BFC\u5165\u793A\u4F8B</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">into</span> \u8868 <span class="token keyword">from</span> ITSV<span class="token punctuation">.</span>\u6570\u636E\u5E93\u540D<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>\u8868\u540D

<span class="token comment">--\u4EE5\u540E\u4E0D\u518D\u4F7F\u7528\u65F6\u5220\u9664\u94FE\u63A5\u670D\u52A1\u5668</span>

<span class="token keyword">exec</span> sp_dropserver <span class="token string">&#39;ITSV &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;droplogins &#39;</span>

<span class="token comment">--\u8FDE\u63A5\u8FDC\u7A0B/\u5C40\u57DF\u7F51\u6570\u636E(openrowset/openquery/opendatasource)</span>

<span class="token comment">--1\u3001openrowset</span>

<span class="token comment">--\u67E5\u8BE2\u793A\u4F8B</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">openrowset</span><span class="token punctuation">(</span> <span class="token string">&#39;SQLOLEDB &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sql\u670D\u52A1\u5668\u540D &#39;</span><span class="token punctuation">;</span> <span class="token string">&#39;\u7528\u6237\u540D &#39;</span><span class="token punctuation">;</span> <span class="token string">&#39;\u5BC6\u7801 &#39;</span><span class="token punctuation">,</span>\u6570\u636E\u5E93\u540D<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>\u8868\u540D<span class="token punctuation">)</span>

<span class="token comment">--\u751F\u6210\u672C\u5730\u8868</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">into</span> \u8868 <span class="token keyword">from</span> <span class="token keyword">openrowset</span><span class="token punctuation">(</span> <span class="token string">&#39;SQLOLEDB &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sql\u670D\u52A1\u5668\u540D &#39;</span><span class="token punctuation">;</span> <span class="token string">&#39;\u7528\u6237\u540D &#39;</span><span class="token punctuation">;</span> <span class="token string">&#39;\u5BC6\u7801 &#39;</span><span class="token punctuation">,</span>\u6570\u636E\u5E93\u540D<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>\u8868\u540D<span class="token punctuation">)</span>

<span class="token comment">--\u628A\u672C\u5730\u8868\u5BFC\u5165\u8FDC\u7A0B\u8868</span>

<span class="token keyword">insert</span> <span class="token keyword">openrowset</span><span class="token punctuation">(</span> <span class="token string">&#39;SQLOLEDB &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sql\u670D\u52A1\u5668\u540D &#39;</span><span class="token punctuation">;</span> <span class="token string">&#39;\u7528\u6237\u540D &#39;</span><span class="token punctuation">;</span> <span class="token string">&#39;\u5BC6\u7801 &#39;</span><span class="token punctuation">,</span>\u6570\u636E\u5E93\u540D<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>\u8868\u540D<span class="token punctuation">)</span>

<span class="token keyword">select</span> <span class="token operator">*</span><span class="token keyword">from</span> \u672C\u5730\u8868

<span class="token comment">--\u66F4\u65B0\u672C\u5730\u8868</span>

<span class="token keyword">update</span> b

<span class="token keyword">set</span> b<span class="token punctuation">.</span>\u5217A<span class="token operator">=</span>a<span class="token punctuation">.</span>\u5217A

 <span class="token keyword">from</span> <span class="token keyword">openrowset</span><span class="token punctuation">(</span> <span class="token string">&#39;SQLOLEDB &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sql\u670D\u52A1\u5668\u540D &#39;</span><span class="token punctuation">;</span> <span class="token string">&#39;\u7528\u6237\u540D &#39;</span><span class="token punctuation">;</span> <span class="token string">&#39;\u5BC6\u7801 &#39;</span><span class="token punctuation">,</span>\u6570\u636E\u5E93\u540D<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>\u8868\u540D<span class="token punctuation">)</span><span class="token keyword">as</span> a <span class="token keyword">inner</span> <span class="token keyword">join</span> \u672C\u5730\u8868 b

<span class="token keyword">on</span> a<span class="token punctuation">.</span>column1<span class="token operator">=</span>b<span class="token punctuation">.</span>column1

<span class="token comment">--openquery\u7528\u6CD5\u9700\u8981\u521B\u5EFA\u4E00\u4E2A\u8FDE\u63A5</span>

<span class="token comment">--\u9996\u5148\u521B\u5EFA\u4E00\u4E2A\u8FDE\u63A5\u521B\u5EFA\u94FE\u63A5\u670D\u52A1\u5668</span>

<span class="token keyword">exec</span> sp_addlinkedserver <span class="token string">&#39;ITSV &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;SQLOLEDB &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;\u8FDC\u7A0B\u670D\u52A1\u5668\u540D\u6216ip\u5730\u5740 &#39;</span>

<span class="token comment">--\u67E5\u8BE2</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">openquery</span><span class="token punctuation">(</span>ITSV<span class="token punctuation">,</span> <span class="token string">&#39;SELECT * FROM \u6570\u636E\u5E93.dbo.\u8868\u540D &#39;</span><span class="token punctuation">)</span>

<span class="token comment">--\u628A\u672C\u5730\u8868\u5BFC\u5165\u8FDC\u7A0B\u8868</span>

<span class="token keyword">insert</span> <span class="token keyword">openquery</span><span class="token punctuation">(</span>ITSV<span class="token punctuation">,</span> <span class="token string">&#39;SELECT * FROM \u6570\u636E\u5E93.dbo.\u8868\u540D &#39;</span><span class="token punctuation">)</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> \u672C\u5730\u8868

<span class="token comment">--\u66F4\u65B0\u672C\u5730\u8868</span>

<span class="token keyword">update</span> b <span class="token keyword">set</span> b<span class="token punctuation">.</span>\u5217B<span class="token operator">=</span>a<span class="token punctuation">.</span>\u5217B <span class="token keyword">FROM</span> <span class="token keyword">openquery</span><span class="token punctuation">(</span>ITSV<span class="token punctuation">,</span> <span class="token string">&#39;SELECT * FROM \u6570\u636E\u5E93.dbo.\u8868\u540D &#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> a <span class="token keyword">inner</span> <span class="token keyword">join</span> \u672C\u5730\u8868 b <span class="token keyword">on</span> a<span class="token punctuation">.</span>\u5217A<span class="token operator">=</span>b<span class="token punctuation">.</span>\u5217A

<span class="token comment">--3\u3001opendatasource/openrowset</span>

<span class="token keyword">SELECT</span>   <span class="token operator">*</span> <span class="token keyword">FROM</span>   <span class="token keyword">opendatasource</span><span class="token punctuation">(</span> <span class="token string">&#39;SQLOLEDB &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Data Source=ip/ServerName;User ID=\u767B\u9646\u540D;Password=\u5BC6\u7801 &#39;</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>test<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>roy_ta

<span class="token comment">--\u628A\u672C\u5730\u8868\u5BFC\u5165\u8FDC\u7A0B\u8868</span>

<span class="token keyword">insert</span> <span class="token keyword">opendatasource</span><span class="token punctuation">(</span> <span class="token string">&#39;SQLOLEDB &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Data Source=ip/ServerName;User ID=\u767B\u9646\u540D;Password=\u5BC6\u7801 &#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>\u6570\u636E\u5E93<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>\u8868\u540D

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> \u672C\u5730\u8868
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>SQL Server\u57FA\u672C\u51FD\u6570</strong></p><p>SQL Server\u57FA\u672C\u51FD\u6570</p><p><strong>1.\u5B57\u7B26\u4E32\u51FD\u6570</strong> \u957F\u5EA6\u4E0E\u5206\u6790\u7528</p><p><strong>1,datalength</strong>(Char_expr) \u8FD4\u56DE\u5B57\u7B26\u4E32\u5305\u542B\u5B57\u7B26\u6570,\u4F46\u4E0D\u5305\u542B\u540E\u9762\u7684\u7A7A\u683C</p><p><strong>2,substring</strong>(expression,start,length) \u53D6\u5B50\u4E32\uFF0C\u5B57\u7B26\u4E32\u7684\u4E0B\u6807\u662F\u4ECE\u201C1\u201D\uFF0Cstart\u4E3A\u8D77\u59CB\u4F4D\u7F6E\uFF0Clength\u4E3A\u5B57\u7B26\u4E32\u957F\u5EA6\uFF0C\u5B9E\u9645\u5E94\u7528\u4E2D\u4EE5len(expression)\u53D6\u5F97\u5176\u957F\u5EA6</p><p><strong>3,right</strong>(char_expr,int_expr) \u8FD4\u56DE\u5B57\u7B26\u4E32\u53F3\u8FB9\u7B2Cint_expr\u4E2A\u5B57\u7B26\uFF0C\u8FD8\u7528<strong>left</strong>\u4E8E\u4E4B\u76F8\u53CD** **</p><p><strong>4,isnull(</strong> <em>check</em>**_**<em>expression</em> <strong>,</strong> <em>replacement_value</em> **)**\u5982\u679Ccheck_expression\u70BA\u7A7A\uFF0C\u5247\u8FD4\u56DEreplacement_value\u7684\u503C\uFF0C\u4E0D\u70BA\u7A7A\uFF0C\u5C31\u8FD4\u56DEcheck_expression\u5B57\u7B26\u64CD\u4F5C\u7C7B</p><p><strong>5,Sp_addtype</strong>\u81EA\u5B9A\u7FA9\u6578\u64DA\u985E\u578B \u4F8B\u5982\uFF1A<code>EXEC sp_addtype birthday, datetime, &#39;NULL&#39;</code></p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token number">6</span><span class="token punctuation">,</span><span class="token keyword">set</span> nocount {<span class="token keyword">on</span><span class="token operator">|</span><span class="token keyword">off</span>}
\u4F7F\u8FD4\u56DE\u7684\u7ED3\u679C\u4E2D\u4E0D\u5305\u542B\u6709\u5173\u53D7 Transact<span class="token operator">-</span><span class="token keyword">SQL</span> \u8BED\u53E5\u5F71\u54CD\u7684\u884C\u6570\u7684\u4FE1\u606F\u3002\u5982\u679C\u5B58\u50A8\u8FC7\u7A0B\u4E2D\u5305\u542B\u7684\u4E00\u4E9B\u8BED\u53E5\u5E76\u4E0D\u8FD4\u56DE\u8BB8\u591A\u5B9E\u9645\u7684\u6570\u636E\uFF0C\u5219\u8BE5\u8BBE\u7F6E\u7531\u4E8E\u5927\u91CF\u51CF\u5C11\u4E86\u7F51\u7EDC\u6D41\u91CF\uFF0C\u56E0\u6B64\u53EF\u663E\u8457\u63D0\u9AD8\u6027\u80FD\u3002<span class="token keyword">SET</span> NOCOUNT \u8BBE\u7F6E\u662F\u5728\u6267\u884C\u6216\u8FD0\u884C\u65F6\u8BBE\u7F6E\uFF0C\u800C\u4E0D\u662F\u5728\u5206\u6790\u65F6\u8BBE\u7F6E\u3002
<span class="token keyword">SET</span> NOCOUNT \u4E3A <span class="token keyword">ON</span> \u65F6\uFF0C\u4E0D\u8FD4\u56DE\u8BA1\u6570\uFF08\u8868\u793A\u53D7 Transact<span class="token operator">-</span><span class="token keyword">SQL</span> \u8BED\u53E5\u5F71\u54CD\u7684\u884C\u6570\uFF09\u3002
<span class="token keyword">SET</span> NOCOUNT \u4E3A <span class="token keyword">OFF</span> \u65F6\uFF0C\u8FD4\u56DE\u8BA1\u6570
\u5E38\u8BC6
 
\u5728<span class="token keyword">SQL</span>\u67E5\u8BE2\u4E2D\uFF1A<span class="token keyword">from</span>\u540E\u6700\u591A\u53EF\u4EE5\u8DDF\u591A\u5C11\u5F20\u8868\u6216\u89C6\u56FE\uFF1A<span class="token number">256</span>
\u5728<span class="token keyword">SQL</span>\u8BED\u53E5\u4E2D\u51FA\u73B0 <span class="token keyword">Order</span> <span class="token keyword">by</span><span class="token punctuation">,</span>\u67E5\u8BE2\u65F6\uFF0C\u5148\u6392\u5E8F\uFF0C\u540E\u53D6
\u5728<span class="token keyword">SQL</span>\u4E2D\uFF0C\u4E00\u4E2A\u5B57\u6BB5\u7684\u6700\u5927\u5BB9\u91CF\u662F<span class="token number">8000</span>\uFF0C\u800C\u5BF9\u4E8Envarchar<span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\u7531\u4E8Envarchar\u662FUnicode\u7801\u3002 
       
SQLServer2000\u540C\u6B65\u590D\u5236\u6280\u672F\u5B9E\u73B0\u6B65\u9AA4
\u4E00\u3001 \u9884\u5907\u5DE5\u4F5C
<span class="token number">1.</span>\u53D1\u5E03\u670D\u52A1\u5668<span class="token punctuation">,</span>\u8BA2\u9605\u670D\u52A1\u5668\u90FD\u521B\u5EFA\u4E00\u4E2A\u540C\u540D\u7684windows\u7528\u6237<span class="token punctuation">,</span>\u5E76\u8BBE\u7F6E\u76F8\u540C\u7684\u5BC6\u7801<span class="token punctuation">,</span>\u505A\u4E3A\u53D1\u5E03\u5FEB\u7167\u6587\u4EF6\u5939\u7684\u6709\u6548\u8BBF\u95EE\u7528\u6237
<span class="token comment">--\u7BA1\u7406\u5DE5\u5177</span>
<span class="token comment">--\u8BA1\u7B97\u673A\u7BA1\u7406</span>
<span class="token comment">--\u7528\u6237\u548C\u7EC4</span>
<span class="token comment">--\u53F3\u952E\u7528\u6237</span>
<span class="token comment">--\u65B0\u5EFA\u7528\u6237</span>
<span class="token comment">--\u5EFA\u7ACB\u4E00\u4E2A\u96B6\u5C5E\u4E8Eadministrator\u7EC4\u7684\u767B\u9646windows\u7684\u7528\u6237\uFF08SynUser\uFF09</span>
<span class="token number">2.</span>\u5728\u53D1\u5E03\u670D\u52A1\u5668\u4E0A<span class="token punctuation">,</span>\u65B0\u5EFA\u4E00\u4E2A\u5171\u4EAB\u76EE\u5F55<span class="token punctuation">,</span>\u505A\u4E3A\u53D1\u5E03\u7684\u5FEB\u7167\u6587\u4EF6\u7684\u5B58\u653E\u76EE\u5F55<span class="token punctuation">,</span>\u64CD\u4F5C:
\u6211\u7684\u7535\u8111<span class="token comment">--D:\\ \u65B0\u5EFA\u4E00\u4E2A\u76EE\u5F55,\u540D\u4E3A: PUB</span>
<span class="token comment">--\u53F3\u952E\u8FD9\u4E2A\u65B0\u5EFA\u7684\u76EE\u5F55</span>
<span class="token comment">--\u5C5E\u6027--\u5171\u4EAB</span>
<span class="token comment">--\u9009\u62E9&quot;\u5171\u4EAB\u8BE5\u6587\u4EF6\u5939&quot;</span>
<span class="token comment">--\u901A\u8FC7&quot;\u6743\u9650&quot;\u6309\u7EBD\u6765\u8BBE\u7F6E\u5177\u4F53\u7684\u7528\u6237\u6743\u9650,\u4FDD\u8BC1\u7B2C\u4E00\u6B65\u4E2D\u521B\u5EFA\u7684\u7528\u6237(SynUser) \u5177\u6709\u5BF9\u8BE5\u6587\u4EF6\u5939\u7684\u6240\u6709\u6743\u9650</span>
<span class="token comment">--\u786E\u5B9A</span>
<span class="token number">3.</span>\u8BBE\u7F6E<span class="token keyword">SQL</span>\u4EE3\u7406<span class="token punctuation">(</span>SQLSERVERAGENT<span class="token punctuation">)</span>\u670D\u52A1\u7684\u542F\u52A8\u7528\u6237<span class="token punctuation">(</span>\u53D1\u5E03<span class="token operator">/</span>\u8BA2\u9605\u670D\u52A1\u5668\u5747\u505A\u6B64\u8BBE\u7F6E<span class="token punctuation">)</span>
\u5F00\u59CB<span class="token comment">--\u7A0B\u5E8F--\u7BA1\u7406\u5DE5\u5177--\u670D\u52A1</span>
<span class="token comment">--\u53F3\u952ESQLSERVERAGENT</span>
<span class="token comment">--\u5C5E\u6027--\u767B\u9646--\u9009\u62E9&quot;\u6B64\u8D26\u6237&quot;</span>
<span class="token comment">--\u8F93\u5165\u6216\u8005\u9009\u62E9\u7B2C\u4E00\u6B65\u4E2D\u521B\u5EFA\u7684windows\u767B\u5F55\u7528\u6237\u540D\uFF08SynUser\uFF09</span>
<span class="token comment">--&quot;\u5BC6\u7801&quot;\u4E2D\u8F93\u5165\u8BE5\u7528\u6237\u7684\u5BC6\u7801</span>
<span class="token number">4.</span>\u8BBE\u7F6E<span class="token keyword">SQL</span> Server\u8EAB\u4EFD\u9A8C\u8BC1\u6A21\u5F0F<span class="token punctuation">,</span>\u89E3\u51B3\u8FDE\u63A5\u65F6\u7684\u6743\u9650\u95EE\u9898<span class="token punctuation">(</span>\u53D1\u5E03<span class="token operator">/</span>\u8BA2\u9605\u670D\u52A1\u5668\u5747\u505A\u6B64\u8BBE\u7F6E<span class="token punctuation">)</span>
\u4F01\u4E1A\u7BA1\u7406\u5668
<span class="token comment">--\u53F3\u952ESQL\u5B9E\u4F8B--\u5C5E\u6027</span>
<span class="token comment">--\u5B89\u5168\u6027--\u8EAB\u4EFD\u9A8C\u8BC1</span>
<span class="token comment">--\u9009\u62E9&quot;SQL Server \u548C Windows&quot;</span>
<span class="token comment">--\u786E\u5B9A</span>
<span class="token number">5.</span>\u5728\u53D1\u5E03\u670D\u52A1\u5668\u548C\u8BA2\u9605\u670D\u52A1\u5668\u4E0A\u4E92\u76F8\u6CE8\u518C
\u4F01\u4E1A\u7BA1\u7406\u5668
<span class="token comment">--\u53F3\u952ESQL Server\u7EC4</span>
<span class="token comment">--\u65B0\u5EFASQL Server\u6CE8\u518C...</span>
<span class="token comment">--\u4E0B\u4E00\u6B65--\u53EF\u7528\u7684\u670D\u52A1\u5668\u4E2D,\u8F93\u5165\u4F60\u8981\u6CE8\u518C\u7684\u8FDC\u7A0B\u670D\u52A1\u5668\u540D --\u6DFB\u52A0</span>
<span class="token comment">--\u4E0B\u4E00\u6B65--\u8FDE\u63A5\u4F7F\u7528,\u9009\u62E9\u7B2C\u4E8C\u4E2A&quot;SQL Server\u8EAB\u4EFD\u9A8C\u8BC1&quot;</span>
<span class="token comment">--\u4E0B\u4E00\u6B65--\u8F93\u5165\u7528\u6237\u540D\u548C\u5BC6\u7801\uFF08SynUser\uFF09</span>
<span class="token comment">--\u4E0B\u4E00\u6B65--\u9009\u62E9SQL Server\u7EC4,\u4E5F\u53EF\u4EE5\u521B\u5EFA\u4E00\u4E2A\u65B0\u7EC4</span>
<span class="token comment">--\u4E0B\u4E00\u6B65--\u5B8C\u6210</span>
<span class="token number">6.</span>\u5BF9\u4E8E\u53EA\u80FD\u7528IP<span class="token punctuation">,</span>\u4E0D\u80FD\u7528\u8BA1\u7B97\u673A\u540D\u7684<span class="token punctuation">,</span>\u4E3A\u5176\u6CE8\u518C\u670D\u52A1\u5668\u522B\u540D\uFF08\u6B64\u6B65\u5728\u5B9E\u65BD\u4E2D\u6CA1\u7528\u5230\uFF09
 <span class="token punctuation">(</span>\u5728\u8FDE\u63A5\u7AEF\u914D\u7F6E<span class="token punctuation">,</span>\u6BD4\u5982<span class="token punctuation">,</span>\u5728\u8BA2\u9605\u670D\u52A1\u5668\u4E0A\u914D\u7F6E\u7684\u8BDD<span class="token punctuation">,</span>\u670D\u52A1\u5668\u540D\u79F0\u4E2D\u8F93\u5165\u7684\u662F\u53D1\u5E03\u670D\u52A1\u5668\u7684IP<span class="token punctuation">)</span>
\u5F00\u59CB<span class="token comment">--\u7A0B\u5E8F--Microsoft SQL Server--\u5BA2\u6237\u7AEF\u7F51\u7EDC\u5B9E\u7528\u5DE5\u5177</span>
<span class="token comment">--\u522B\u540D--\u6DFB\u52A0</span>
<span class="token comment">--\u7F51\u7EDC\u5E93\u9009\u62E9&quot;tcp/ip&quot;--\u670D\u52A1\u5668\u522B\u540D\u8F93\u5165SQL\u670D\u52A1\u5668\u540D</span>
<span class="token comment">--\u8FDE\u63A5\u53C2\u6570--\u670D\u52A1\u5668\u540D\u79F0\u4E2D\u8F93\u5165SQL\u670D\u52A1\u5668ip\u5730\u5740</span>
<span class="token comment">--\u5982\u679C\u4F60\u4FEE\u6539\u4E86SQL\u7684\u7AEF\u53E3,\u53D6\u6D88\u9009\u62E9&quot;\u52A8\u6001\u51B3\u5B9A\u7AEF\u53E3&quot;,\u5E76\u8F93\u5165\u5BF9\u5E94\u7684\u7AEF\u53E3\u53F7</span>
\u4E8C\u3001 \u6B63\u5F0F\u914D\u7F6E
<span class="token number">1</span>\u3001\u914D\u7F6E\u53D1\u5E03\u670D\u52A1\u5668
\u6253\u5F00\u4F01\u4E1A\u7BA1\u7406\u5668\uFF0C\u5728\u53D1\u5E03\u670D\u52A1\u5668\uFF08B\u3001C\u3001D\uFF09\u4E0A\u6267\u884C\u4EE5\u4E0B\u6B65\u9AA4:
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> \u4ECE<span class="token punctuation">[</span>\u5DE5\u5177<span class="token punctuation">]</span>\u4E0B\u62C9\u83DC\u5355\u7684<span class="token punctuation">[</span>\u590D\u5236<span class="token punctuation">]</span>\u5B50\u83DC\u5355\u4E2D\u9009\u62E9<span class="token punctuation">[</span>\u914D\u7F6E\u53D1\u5E03\u3001\u8BA2\u9605\u670D\u52A1\u5668\u548C\u5206\u53D1<span class="token punctuation">]</span>\u51FA\u73B0\u914D\u7F6E\u53D1\u5E03\u548C\u5206\u53D1\u5411\u5BFC
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span> \u9009\u62E9\u5206\u53D1\u670D\u52A1\u5668 \u53EF\u4EE5\u9009\u62E9\u628A\u53D1\u5E03\u670D\u52A1\u5668\u81EA\u5DF1\u4F5C\u4E3A\u5206\u53D1\u670D\u52A1\u5668\u6216\u8005\u5176\u4ED6<span class="token keyword">sql</span>\u7684\u670D\u52A1\u5668\uFF08\u9009\u62E9\u81EA\u5DF1\uFF09
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span> \u8BBE\u7F6E\u5FEB\u7167\u6587\u4EF6\u5939
\u91C7\u7528\u9ED8\u8BA4\\\\servername\\Pub
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span> \u81EA\u5B9A\u4E49\u914D\u7F6E
\u53EF\u4EE5\u9009\u62E9:\u662F<span class="token punctuation">,</span>\u8BA9\u6211\u8BBE\u7F6E\u5206\u53D1\u6570\u636E\u5E93\u5C5E\u6027\u542F\u7528\u53D1\u5E03\u670D\u52A1\u5668\u6216\u8BBE\u7F6E\u53D1\u5E03\u8BBE\u7F6E
\u5426<span class="token punctuation">,</span>\u4F7F\u7528\u4E0B\u5217\u9ED8\u8BA4\u8BBE\u7F6E\uFF08\u63A8\u8350\uFF09
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span> \u8BBE\u7F6E\u5206\u53D1\u6570\u636E\u5E93\u540D\u79F0\u548C\u4F4D\u7F6E \u91C7\u7528\u9ED8\u8BA4\u503C
<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span> \u542F\u7528\u53D1\u5E03\u670D\u52A1\u5668 \u9009\u62E9\u4F5C\u4E3A\u53D1\u5E03\u7684\u670D\u52A1\u5668
<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span> \u9009\u62E9\u9700\u8981\u53D1\u5E03\u7684\u6570\u636E\u5E93\u548C\u53D1\u5E03\u7C7B\u578B
<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span> \u9009\u62E9\u6CE8\u518C\u8BA2\u9605\u670D\u52A1\u5668
<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span> \u5B8C\u6210\u914D\u7F6E
<span class="token number">2</span>\u3001\u521B\u5EFA\u51FA\u7248\u7269
\u53D1\u5E03\u670D\u52A1\u5668B\u3001C\u3001D\u4E0A
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>\u4ECE<span class="token punctuation">[</span>\u5DE5\u5177<span class="token punctuation">]</span>\u83DC\u5355\u7684<span class="token punctuation">[</span>\u590D\u5236<span class="token punctuation">]</span>\u5B50\u83DC\u5355\u4E2D\u9009\u62E9<span class="token punctuation">[</span>\u521B\u5EFA\u548C\u7BA1\u7406\u53D1\u5E03<span class="token punctuation">]</span>\u547D\u4EE4
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>\u9009\u62E9\u8981\u521B\u5EFA\u51FA\u7248\u7269\u7684\u6570\u636E\u5E93\uFF0C\u7136\u540E\u5355\u51FB<span class="token punctuation">[</span>\u521B\u5EFA\u53D1\u5E03<span class="token punctuation">]</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>\u5728<span class="token punctuation">[</span>\u521B\u5EFA\u53D1\u5E03\u5411\u5BFC<span class="token punctuation">]</span>\u7684\u63D0\u793A\u5BF9\u8BDD\u6846\u4E2D\u5355\u51FB<span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span>\u7CFB\u7EDF\u5C31\u4F1A\u5F39\u51FA\u4E00\u4E2A\u5BF9\u8BDD\u6846\u3002\u5BF9\u8BDD\u6846\u4E0A\u7684\u5185\u5BB9\u662F\u590D\u5236\u7684\u4E09\u4E2A\u7C7B\u578B\u3002\u6211\u4EEC\u73B0\u5728\u9009\u7B2C\u4E00\u4E2A\u4E5F\u5C31\u662F\u9ED8\u8BA4\u7684\u5FEB\u7167\u53D1\u5E03<span class="token punctuation">(</span>\u5176\u4ED6\u4E24\u4E2A\u5927\u5BB6\u53EF\u4EE5\u53BB\u770B\u770B\u5E2E\u52A9<span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>\u5355\u51FB<span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span>\u7CFB\u7EDF\u8981\u6C42\u6307\u5B9A\u53EF\u4EE5\u8BA2\u9605\u8BE5\u53D1\u5E03\u7684\u6570\u636E\u5E93\u670D\u52A1\u5668\u7C7B\u578B<span class="token punctuation">,</span>
SQLSERVER\u5141\u8BB8\u5728\u4E0D\u540C\u7684\u6570\u636E\u5E93\u5982 orACLE\u6216ACCESS\u4E4B\u95F4\u8FDB\u884C\u6570\u636E\u590D\u5236\u3002
\u4F46\u662F\u5728\u8FD9\u91CC\u6211\u4EEC\u9009\u62E9\u8FD0\u884C<span class="token string">&quot;SQL SERVER 2000&quot;</span>\u7684\u6570\u636E\u5E93\u670D\u52A1\u5668
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>\u5355\u51FB<span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span>\u7CFB\u7EDF\u5C31\u5F39\u51FA\u4E00\u4E2A\u5B9A\u4E49\u6587\u7AE0\u7684\u5BF9\u8BDD\u6846\u4E5F\u5C31\u662F\u9009\u62E9\u8981\u51FA\u7248\u7684\u8868
\u6CE8\u610F: \u5982\u679C\u524D\u9762\u9009\u62E9\u4E86\u4E8B\u52A1\u53D1\u5E03 \u5219\u518D\u8FD9\u4E00\u6B65\u4E2D\u53EA\u80FD\u9009\u62E9\u5E26\u6709\u4E3B\u952E\u7684\u8868
<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>\u9009\u62E9\u53D1\u5E03\u540D\u79F0\u548C\u63CF\u8FF0
<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>\u81EA\u5B9A\u4E49\u53D1\u5E03\u5C5E\u6027 \u5411\u5BFC\u63D0\u4F9B\u7684\u9009\u62E9:
\u662F \u6211\u5C06\u81EA\u5B9A\u4E49\u6570\u636E\u7B5B\u9009<span class="token punctuation">,</span>\u542F\u7528\u533F\u540D\u8BA2\u9605\u548C\u6216\u5176\u4ED6\u81EA\u5B9A\u4E49\u5C5E\u6027
\u5426 \u6839\u636E\u6307\u5B9A\u65B9\u5F0F\u521B\u5EFA\u53D1\u5E03 \uFF08\u5EFA\u8BAE\u91C7\u7528\u81EA\u5B9A\u4E49\u7684\u65B9\u5F0F\uFF09
<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span> \u9009\u62E9\u7B5B\u9009\u53D1\u5E03\u7684\u65B9\u5F0F
<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span> \u53EF\u4EE5\u9009\u62E9\u662F\u5426\u5141\u8BB8\u533F\u540D\u8BA2\u9605
<span class="token number">1</span><span class="token punctuation">)</span>\u5982\u679C\u9009\u62E9\u7F72\u540D\u8BA2\u9605<span class="token punctuation">,</span>\u5219\u9700\u8981\u5728\u53D1\u5E03\u670D\u52A1\u5668\u4E0A\u6DFB\u52A0\u8BA2\u9605\u670D\u52A1\u5668
\u65B9\u6CD5: <span class="token punctuation">[</span>\u5DE5\u5177<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token punctuation">[</span>\u590D\u5236<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token punctuation">[</span>\u914D\u7F6E\u53D1\u5E03\u3001\u8BA2\u9605\u670D\u52A1\u5668\u548C\u5206\u53D1\u7684\u5C5E\u6027<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token punctuation">[</span>\u8BA2\u9605\u670D\u52A1\u5668<span class="token punctuation">]</span> \u4E2D\u6DFB\u52A0
\u5426\u5219\u5728\u8BA2\u9605\u670D\u52A1\u5668\u4E0A\u8BF7\u6C42\u8BA2\u9605\u65F6\u4F1A\u51FA\u73B0\u7684\u63D0\u793A:\u6539\u53D1\u5E03\u4E0D\u5141\u8BB8\u533F\u540D\u8BA2\u9605
\u5982\u679C\u4ECD\u7136\u9700\u8981\u533F\u540D\u8BA2\u9605\u5219\u7528\u4EE5\u4E0B\u89E3\u51B3\u529E\u6CD5
<span class="token punctuation">[</span>\u4F01\u4E1A\u7BA1\u7406\u5668<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token punctuation">[</span>\u590D\u5236<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token punctuation">[</span>\u53D1\u5E03\u5185\u5BB9<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token punctuation">[</span>\u5C5E\u6027<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token punctuation">[</span>\u8BA2\u9605\u9009\u9879<span class="token punctuation">]</span> \u9009\u62E9\u5141\u8BB8\u533F\u540D\u8BF7\u6C42\u8BA2\u9605
<span class="token number">2</span><span class="token punctuation">)</span>\u5982\u679C\u9009\u62E9\u533F\u540D\u8BA2\u9605<span class="token punctuation">,</span>\u5219\u914D\u7F6E\u8BA2\u9605\u670D\u52A1\u5668\u65F6\u4E0D\u4F1A\u51FA\u73B0\u4EE5\u4E0A\u63D0\u793A
<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span> \u8BBE\u7F6E\u5FEB\u7167 \u4EE3\u7406\u7A0B\u5E8F\u8C03\u5EA6
<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">[</span>\u4E0B\u4E00\u6B65<span class="token punctuation">]</span> \u5B8C\u6210\u914D\u7F6E
\u5F53\u5B8C\u6210\u51FA\u7248\u7269\u7684\u521B\u5EFA\u540E\u521B\u5EFA\u51FA\u7248\u7269\u7684\u6570\u636E\u5E93\u4E5F\u5C31\u53D8\u6210\u4E86\u4E00\u4E2A\u5171\u4EAB\u6570\u636E\u5E93
\u6709\u6570\u636E
srv1<span class="token punctuation">.</span>\u5E93\u540D<span class="token punctuation">.</span><span class="token punctuation">.</span>author\u6709\u5B57\u6BB5:id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>phone<span class="token punctuation">,</span>
srv2<span class="token punctuation">.</span>\u5E93\u540D<span class="token punctuation">.</span><span class="token punctuation">.</span>author\u6709\u5B57\u6BB5:id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>telphone<span class="token punctuation">,</span>adress
 
\u8981\u6C42\uFF1A
srv1<span class="token punctuation">.</span>\u5E93\u540D<span class="token punctuation">.</span><span class="token punctuation">.</span>author\u589E\u52A0\u8BB0\u5F55\u5219srv1<span class="token punctuation">.</span>\u5E93\u540D<span class="token punctuation">.</span><span class="token punctuation">.</span>author\u8BB0\u5F55\u589E\u52A0
srv1<span class="token punctuation">.</span>\u5E93\u540D<span class="token punctuation">.</span><span class="token punctuation">.</span>author\u7684phone\u5B57\u6BB5\u66F4\u65B0\uFF0C\u5219srv1<span class="token punctuation">.</span>\u5E93\u540D<span class="token punctuation">.</span><span class="token punctuation">.</span>author\u5BF9\u5E94\u5B57\u6BB5telphone\u66F4\u65B0
<span class="token comment">--*/</span>
 
<span class="token comment">--\u5927\u81F4\u7684\u5904\u7406\u6B65\u9AA4</span>
<span class="token comment">--1.\u5728 srv1 \u4E0A\u521B\u5EFA\u8FDE\u63A5\u670D\u52A1\u5668,\u4EE5\u4FBF\u5728 srv1 \u4E2D\u64CD\u4F5C srv2,\u5B9E\u73B0\u540C\u6B65</span>
<span class="token keyword">exec</span> sp_addlinkedserver <span class="token string">&#39;srv2&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;SQLOLEDB&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;srv2\u7684sql\u5B9E\u4F8B\u540D\u6216ip&#39;</span>
<span class="token keyword">exec</span> sp_addlinkedsrvlogin <span class="token string">&#39;srv2&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;false&#39;</span><span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">&#39;\u7528\u6237\u540D&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;\u5BC6\u7801&#39;</span>
go
<span class="token comment">--2.\u5728 srv1 \u548C srv2 \u8FD9\u4E24\u53F0\u7535\u8111\u4E2D,\u542F\u52A8 msdtc(\u5206\u5E03\u5F0F\u4E8B\u52A1\u5904\u7406\u670D\u52A1),\u5E76\u4E14\u8BBE\u7F6E\u4E3A\u81EA\u52A8\u542F\u52A8</span>
\u3002\u6211\u7684\u7535\u8111<span class="token comment">--\u63A7\u5236\u9762\u677F--\u7BA1\u7406\u5DE5\u5177--\u670D\u52A1--\u53F3\u952E Distributed Transaction Coordinator--\u5C5E\u6027--\u542F\u52A8--\u5E76\u5C06\u542F\u52A8\u7C7B\u578B\u8BBE\u7F6E\u4E3A\u81EA\u52A8\u542F\u52A8</span>
go
  
<span class="token comment">--\u7136\u540E\u521B\u5EFA\u4E00\u4E2A\u4F5C\u4E1A\u5B9A\u65F6\u8C03\u7528\u4E0A\u9762\u7684\u540C\u6B65\u5904\u7406\u5B58\u50A8\u8FC7\u7A0B\u5C31\u884C\u4E86</span>
 
\u4F01\u4E1A\u7BA1\u7406\u5668
<span class="token comment">--\u7BA1\u7406</span>
<span class="token comment">--SQL Server\u4EE3\u7406</span>
<span class="token comment">--\u53F3\u952E\u4F5C\u4E1A</span>
<span class="token comment">--\u65B0\u5EFA\u4F5C\u4E1A</span>
<span class="token comment">--&quot;\u5E38\u89C4&quot;\u9879\u4E2D\u8F93\u5165\u4F5C\u4E1A\u540D\u79F0</span>
<span class="token comment">--&quot;\u6B65\u9AA4&quot;\u9879</span>
<span class="token comment">--\u65B0\u5EFA</span>
<span class="token comment">--&quot;\u6B65\u9AA4\u540D&quot;\u4E2D\u8F93\u5165\u6B65\u9AA4\u540D</span>
<span class="token comment">--&quot;\u7C7B\u578B&quot;\u4E2D\u9009\u62E9&quot;Transact-SQL \u811A\u672C(TSQL)&quot;</span>
<span class="token comment">--&quot;\u6570\u636E\u5E93&quot;\u9009\u62E9\u6267\u884C\u547D\u4EE4\u7684\u6570\u636E\u5E93</span>
<span class="token comment">--&quot;\u547D\u4EE4&quot;\u4E2D\u8F93\u5165\u8981\u6267\u884C\u7684\u8BED\u53E5: exec p_process</span>
<span class="token comment">--\u786E\u5B9A</span>
<span class="token comment">--&quot;\u8C03\u5EA6&quot;\u9879</span>
<span class="token comment">--\u65B0\u5EFA\u8C03\u5EA6</span>
<span class="token comment">--&quot;\u540D\u79F0&quot;\u4E2D\u8F93\u5165\u8C03\u5EA6\u540D\u79F0</span>
<span class="token comment">--&quot;\u8C03\u5EA6\u7C7B\u578B&quot;\u4E2D\u9009\u62E9\u4F60\u7684\u4F5C\u4E1A\u6267\u884C\u5B89\u6392</span>
<span class="token comment">--\u5982\u679C\u9009\u62E9&quot;\u53CD\u590D\u51FA\u73B0&quot;</span>
<span class="token comment">--\u70B9&quot;\u66F4\u6539&quot;\u6765\u8BBE\u7F6E\u4F60\u7684\u65F6\u95F4\u5B89\u6392</span>
 
\u7136\u540E\u5C06<span class="token keyword">SQL</span> Agent\u670D\u52A1\u542F\u52A8<span class="token punctuation">,</span>\u5E76\u8BBE\u7F6E\u4E3A\u81EA\u52A8\u542F\u52A8<span class="token punctuation">,</span>\u5426\u5219\u4F60\u7684\u4F5C\u4E1A\u4E0D\u4F1A\u88AB\u6267\u884C
 
\u8BBE\u7F6E\u65B9\u6CD5:
\u6211\u7684\u7535\u8111<span class="token comment">--\u63A7\u5236\u9762\u677F--\u7BA1\u7406\u5DE5\u5177--\u670D\u52A1--\u53F3\u952E SQLSERVERAGENT--\u5C5E\u6027--\u542F\u52A8\u7C7B\u578B--\u9009\u62E9&quot;\u81EA\u52A8\u542F\u52A8&quot;--\u786E\u5B9A. </span>
<span class="token comment">--3.\u5B9E\u73B0\u540C\u6B65\u5904\u7406\u7684\u65B9\u6CD52,\u5B9A\u65F6\u540C\u6B65</span>
<span class="token comment">--\u5728srv1\u4E2D\u521B\u5EFA\u5982\u4E0B\u7684\u540C\u6B65\u5904\u7406\u5B58\u50A8\u8FC7\u7A0B</span>
<span class="token keyword">create</span> <span class="token keyword">proc</span> p_process <span class="token keyword">as</span>

<span class="token comment">--\u66F4\u65B0\u4FEE\u6539\u8FC7\u7684\u6570\u636E</span>

<span class="token keyword">update</span> b <span class="token keyword">set</span> name<span class="token operator">=</span>i<span class="token punctuation">.</span>name<span class="token punctuation">,</span>telphone<span class="token operator">=</span>i<span class="token punctuation">.</span>telphone

<span class="token keyword">from</span> srv2<span class="token punctuation">.</span>\u5E93\u540D<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>author b<span class="token punctuation">,</span>author i

<span class="token keyword">where</span> b<span class="token punctuation">.</span>id<span class="token operator">=</span>i<span class="token punctuation">.</span>id <span class="token operator">and</span>

<span class="token punctuation">(</span>b<span class="token punctuation">.</span>name <span class="token operator">&lt;&gt;</span> i<span class="token punctuation">.</span>name <span class="token operator">or</span> b<span class="token punctuation">.</span>telphone <span class="token operator">&lt;&gt;</span> i<span class="token punctuation">.</span>telphone<span class="token punctuation">)</span>

<span class="token comment">--\u63D2\u5165\u65B0\u589E\u7684\u6570\u636E</span>

<span class="token keyword">insert</span> srv2<span class="token punctuation">.</span>\u5E93\u540D<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>author<span class="token punctuation">(</span>id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>telphone<span class="token punctuation">)</span>

<span class="token keyword">select</span> id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>telphone <span class="token keyword">from</span> author i

<span class="token keyword">where</span> <span class="token operator">not</span> <span class="token keyword">exists</span><span class="token punctuation">(</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> srv2<span class="token punctuation">.</span>\u5E93\u540D<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>author <span class="token keyword">where</span> id<span class="token operator">=</span>i<span class="token punctuation">.</span>id<span class="token punctuation">)</span>


<span class="token comment">--\u5220\u9664\u5DF2\u7ECF\u5220\u9664\u7684\u6570\u636E(\u5982\u679C\u9700\u8981\u7684\u8BDD)</span>

<span class="token keyword">delete</span> b

<span class="token keyword">from</span> srv2<span class="token punctuation">.</span>\u5E93\u540D<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>author b

<span class="token keyword">where</span> <span class="token operator">not</span> <span class="token keyword">exists</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> author <span class="token keyword">where</span> id<span class="token operator">=</span>b<span class="token punctuation">.</span>id<span class="token punctuation">)</span>

go
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,18);function q(N,A){const a=o("ExternalLinkIcon");return l(),c("div",null,[r,s("p",null,[u,s("a",d,[k,e(a)]),m,s("a",v,[b,e(a)]),g]),w,s("p",null,[y,s("a",h,[E,e(a)]),S,s("a",f,[L,e(a)]),T]),_])}var R=t(i,[["render",q],["__file","15000\u5B57\u7684SQL\u8BED\u53E5\u5927\u5168.html.vue"]]);export{R as default};
