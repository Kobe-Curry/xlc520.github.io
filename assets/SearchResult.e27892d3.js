import{u as J,h as H,m as K,i as R,n as X,g as Z,p as ee,q as te,t as I,S as ae,v as le,j as oe,x as ne,y as re,k as r,R as se,z as T,A as ie,B as ue,C as ce}from"./app.e0e09d4c.js";function de(a){if(Array.isArray(a)){for(var e=0,t=Array(a.length);e<a.length;e++)t[e]=a[e];return t}else return Array.from(a)}var x=!1;if(typeof window<"u"){var D={get passive(){x=!0}};window.addEventListener("testPassive",null,D),window.removeEventListener("testPassive",null,D)}var P=typeof window<"u"&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1),g=[],C=!1,z=-1,S=void 0,b=void 0,_=function(e){return g.some(function(t){return!!(t.options.allowTouchMove&&t.options.allowTouchMove(e))})},M=function(e){var t=e||window.event;return _(t.target)||t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)},ve=function(e){if(b===void 0){var t=!!e&&e.reserveScrollBarGap===!0,l=window.innerWidth-document.documentElement.clientWidth;t&&l>0&&(b=document.body.style.paddingRight,document.body.style.paddingRight=l+"px")}S===void 0&&(S=document.body.style.overflow,document.body.style.overflow="hidden")},he=function(){b!==void 0&&(document.body.style.paddingRight=b,b=void 0),S!==void 0&&(document.body.style.overflow=S,S=void 0)},fe=function(e){return e?e.scrollHeight-e.scrollTop<=e.clientHeight:!1},pe=function(e,t){var l=e.targetTouches[0].clientY-z;return _(e.target)?!1:t&&t.scrollTop===0&&l>0||fe(t)&&l<0?M(e):(e.stopPropagation(),!0)},ye=function(e,t){if(!e){console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");return}if(!g.some(function(o){return o.targetElement===e})){var l={targetElement:e,options:t||{}};g=[].concat(de(g),[l]),P?(e.ontouchstart=function(o){o.targetTouches.length===1&&(z=o.targetTouches[0].clientY)},e.ontouchmove=function(o){o.targetTouches.length===1&&pe(o,e)},C||(document.addEventListener("touchmove",M,x?{passive:!1}:void 0),C=!0)):ve(t)}},me=function(){P?(g.forEach(function(e){e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null}),C&&(document.removeEventListener("touchmove",M,x?{passive:!1}:void 0),C=!1),z=-1):he(),g=[]};const $=()=>r(T,{name:"heading"},()=>r("path",{d:"M250.4 704.6H64V595.4h202.4l26.2-166.6H94V319.6h214.4L352 64h127.8l-43.6 255.4h211.2L691 64h126.2l-43.6 255.4H960v109.2H756.2l-24.6 166.6H930v109.2H717L672 960H545.8l43.6-255.4H376.6L333 960H206.8l43.6-255.4zm168.4-276L394 595.4h211.2l24.6-166.6h-211z"}));$.displayName="HeadingIcon";const N=()=>r(T,{name:"heart"},()=>r("path",{d:"M1024 358.156C1024 195.698 892.3 64 729.844 64c-86.362 0-164.03 37.218-217.844 96.49C458.186 101.218 380.518 64 294.156 64 131.698 64 0 195.698 0 358.156 0 444.518 37.218 522.186 96.49 576H96l320 320c32 32 64 64 96 64s64-32 96-64l320-320h-.49c59.272-53.814 96.49-131.482 96.49-217.844zM841.468 481.232 517.49 805.49a2981.962 2981.962 0 0 1-5.49 5.48c-1.96-1.95-3.814-3.802-5.49-5.48L182.532 481.234C147.366 449.306 128 405.596 128 358.156 128 266.538 202.538 192 294.156 192c47.44 0 91.15 19.366 123.076 54.532L512 350.912l94.768-104.378C638.696 211.366 682.404 192 729.844 192 821.462 192 896 266.538 896 358.156c0 47.44-19.368 91.15-54.532 123.076z"}));N.displayName="HeartIcon";const j=()=>r(T,{name:"history"},()=>r("path",{d:"M512 1024a512 512 0 1 1 512-512 512 512 0 0 1-512 512zm0-896a384 384 0 1 0 384 384 384 384 0 0 0-384-384zm192 448H512a64 64 0 0 1-64-64V320a64 64 0 0 1 128 0v128h128a64 64 0 0 1 0 128z"}));j.displayName="HistoryIcon";const q=()=>r(T,{name:"title"},()=>r("path",{d:"M512 256c70.656 0 134.656 28.672 180.992 75.008A254.933 254.933 0 0 1 768 512c0 83.968-41.024 157.888-103.488 204.48C688.96 748.736 704 788.48 704 832c0 105.984-86.016 192-192 192-106.048 0-192-86.016-192-192h128a64 64 0 1 0 128 0 64 64 0 0 0-64-64 255.19 255.19 0 0 1-181.056-75.008A255.403 255.403 0 0 1 256 512c0-83.968 41.024-157.824 103.488-204.544C335.04 275.264 320 235.584 320 192A192 192 0 0 1 512 0c105.984 0 192 85.952 192 192H576a64.021 64.021 0 0 0-128 0c0 35.328 28.672 64 64 64zM384 512c0 70.656 57.344 128 128 128s128-57.344 128-128-57.344-128-128-128-128 57.344-128 128z"}));q.displayName="TitleIcon";const ge="search-pro-history",m=J(ge,[]),we=(a=5)=>{const e=t=>{m.value.length<a?m.value=Array.from(new Set([t,...m.value])):m.value=Array.from(new Set([...m.value.slice(0,a-1),t]))};return{history:ie(m),addHistory:e}},Q=H(K),He=R(()=>JSON.parse(X(Q.value)));import.meta.webpackHot&&(__VUE_HMR_RUNTIME__.updateSearchProDatabase=a=>{Q.value=a});const Se={},be=300,Le={"/":{cancel:"取消",placeholder:"搜索",search:"搜索",select:"选择",navigate:"切换",exit:"关闭",history:"搜索历史",emptyHistory:"无搜索历史",emptyResult:"没有找到结果",loading:"正在加载搜索索引..."}},A=(a,e)=>{const t=[];let l=0,o=0;const i=a.toLowerCase(),p=e.toLowerCase();let u=i.indexOf(p,l);const h=(s,c)=>{let n=s,f=!1;if(!c&&n.length>100&&o===0&&(n=`… ${n.slice(-10)}`),o+n.length>100){if(t.some(w=>w[0]==="strong"))return;n=n.slice(0,Math.max(100-o,1)),f=!0}n.length&&(t.push(c?["strong",n]:n),o+=n.length),f&&(t.push("…"),o+=2)};if(u<0)return null;for(;u>=0;){const s=u+p.length;if(h(a.slice(l,u),!1),h(a.slice(u,s),!0),l=s,u=i.indexOf(p,l),o>100)break}return h(a.slice(l),!1),t},E=a=>a.reduce((e,{type:t})=>e+(t==="title"?50:t==="heading"?20:t==="custom"?10:1),0),Ae=(a,e)=>{var t;const l={};for(const[o,i]of Object.entries(e)){const p=((t=e[o.replace(/\/[^\\]*$/,"")])==null?void 0:t.title)||"",u=`${p?`${p} > `:""}${i.title}`,h=A(i.title,a);h&&(l[u]=[...l[u]||[],{type:"title",path:o,display:h}]),i.customFields&&Object.entries(i.customFields).forEach(([s,c])=>{c.forEach(n=>{const f=A(n,a);f&&(l[u]=[...l[u]||[],{type:"custom",path:o,index:s,display:f}])})});for(const s of i.contents){const c=A(s.header,a);c&&(l[u]=[...l[u]||[],{type:"heading",path:o+(s.slug?`#${s.slug}`:""),display:c}]);for(const n of s.contents){const f=A(n,a);f&&(l[u]=[...l[u]||[],{type:"content",header:s.header||i.title||"Documentation",path:o+(s.slug?`#${s.slug}`:""),display:f}])}}}return Object.keys(l).sort((o,i)=>E(l[o])-E(l[i])).map(o=>({title:o,contents:l[o]}))},Re=a=>{const e=I(),t=H([]),l=R(()=>He.value[e.value]),o=ce(i=>{t.value=i?Ae(i,l.value):[]},be);return ue([a,e],()=>{o(a.value)}),t};var Me=Z({name:"SearchResult",props:{query:{type:String,required:!0}},emits:["close","updateQuery"],setup(a,{emit:e}){const t=ee(),l=te(),o=I(),i=ae(Le),{history:p,addHistory:u}=we(),h=le(a,"query"),s=Re(h),c=H(0),n=H(0),f=H(),w=R(()=>s.value.length>0),k=R(()=>s.value[c.value]||null),U=()=>{c.value=c.value>0?c.value-1:s.value.length-1,n.value=k.value.contents.length-1},V=()=>{c.value=c.value<s.value.length-1?c.value+1:0,n.value=0},Y=()=>{n.value<k.value.contents.length-1?n.value=n.value+1:V()},F=()=>{n.value>0?n.value=n.value-1:U()},B=d=>d.map(v=>typeof v=="string"?v:r(v[0],v[1])),W=d=>{if(d.type==="custom"){const v=Se[d.index]||"$content",[O,L=""]=typeof v=="object"?v[o.value].split("$content"):v.split("$content");return B([O,...d.display,L])}return B(d.display)};return oe(()=>{ne("keydown",d=>{if(w.value){if(d.key==="ArrowUp")F();else if(d.key==="ArrowDown")Y();else if(d.key==="Enter"){const v=k.value.contents[n.value].path;l.path!==v&&(t.push(v),u(h.value),e("updateQuery",""),e("close"))}}}),ye(f.value,{reserveScrollBarGap:!0})}),re(()=>{me()}),()=>r("div",{class:["search-pro-result",{empty:h.value===""?p.value.length===0:!w.value}],ref:f},h.value===""?p.value.length?r("ul",{class:"search-pro-result-list"},p.value.map(d=>r("li",{class:"search-pro-result-list-item"},[r("div",{class:"search-pro-result-title"},i.value.history),r("div",{class:"search-pro-result-item",onClick:()=>{e("updateQuery",d)}},[r(j,{class:"search-pro-result-type"}),r("div",{class:"search-pro-result-content"},d)])]))):i.value.emptyHistory:w.value?r("ul",{class:"search-pro-result-list"},s.value.map(({title:d,contents:v},O)=>{const L=c.value===O;return r("li",{class:["search-pro-result-list-item",{active:L}]},[r("div",{class:"search-pro-result-title"},d||"Documentation"),v.map((y,G)=>r(se,{to:y.path,class:["search-pro-result-item",{active:L&&n.value===G}],onClick:()=>{u(h.value),e("updateQuery",""),e("close")}},()=>[y.type==="content"?null:r(y.type==="title"?q:y.type==="heading"?$:N,{class:"search-pro-result-type"}),r("div",{class:"search-pro-result-content"},[y.type==="content"?r("div",{class:"content-header"},y.header):null,r("div",W(y))])]))])})):i.value.emptyResult)}});export{Me as default};
