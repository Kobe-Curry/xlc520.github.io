<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh-CN">
  <id>https://blog.ciberviler.top/</id>
  <title>StudyNote</title>
  <subtitle>个人学习的笔记，记录学习过程遇到的问题，学到的知识，收集各种学习工具，各种技巧，各种使用教程。</subtitle>
  <updated>2022-06-20T02:23:06.022Z</updated>
  <generator>vuepress-plugin-feed2</generator>
  <link rel="self" href="https://blog.ciberviler.top/atom.xml"/>
  <link rel="alternate" href="https://blog.ciberviler.top/"/>
  <category term="Java"/>
  <category term="Linux"/>
  <category term="other"/>
  <category term="essay"/>
  <category term="daily"/>
  <category term="algorithm"/>
  <category term="Script"/>
  <category term="pc"/>
  <category term="Python"/>
  <category term="Tools"/>
  <category term="java"/>
  <category term="IDEA"/>
  <contributor>
    <name>xlc520</name>
  </contributor>
  <entry>
    <title type="html">Logback 配置文件优化</title>
    <id>https://blog.ciberviler.top/dev/Logback%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BC%98%E5%8C%96.html</id>
    <link href="https://blog.ciberviler.top/dev/Logback%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BC%98%E5%8C%96.html"/>
    <updated>2022-06-20T02:20:38.000Z</updated>
    <content type="html"><![CDATA[<h1 id="logback-配置文件优化" tabindex="-1"> Logback 配置文件优化</h1>
<p><strong>01、通过阅读本篇文章将了解到</strong></p>
<ul>
<li>1.日志输出到文件并根据<code>LEVEL</code>级别将日志分类保存到不同文件</li>
<li>2.通过异步输出日志减少磁盘<code>IO</code>提高性能</li>
<li>3.异步输出日志的原理</li>
</ul>
<h3 id="_02、配置文件logback-spring-xml" tabindex="-1"> 02、配置文件logback-spring.xml</h3>
<p><code>SpringBoot</code>工程自带<code>logback</code>和<code>slf4j</code>的依赖，所以重点放在编写配置文件上，需要引入什么依赖，日志依赖冲突统统都不需要我们管了。<code>logback</code>框架会默认加载<code>classpath</code>下命名为<code>logback-spring</code>或<code>logback</code>的配置文件。将所有日志都存储在一个文件中文件大小也随着应用的运行越来越大并且不好排查问题，正确的做法应该是将<code>error</code>日志和其他日志分开，并且不同级别的日志根据时间段进行记录存储。</p>
<div><pre><code><span>&lt;?xml version="1.0" encoding="utf-8"?></span>
<span><span><span>&lt;</span>configuration</span><span>></span></span>
    <span><span><span>&lt;</span>property</span> <span>resource</span><span><span>=</span><span>"</span>logback.properties<span>"</span></span><span>/></span></span>
    <span><span><span>&lt;</span>appender</span> <span>name</span><span><span>=</span><span>"</span>CONSOLE-LOG<span>"</span></span> <span>class</span><span><span>=</span><span>"</span>ch.qos.logback.core.ConsoleAppender<span>"</span></span><span>></span></span>
        <span><span><span>&lt;</span>layout</span> <span>class</span><span><span>=</span><span>"</span>ch.qos.logback.classic.PatternLayout<span>"</span></span><span>></span></span>
            <span><span><span>&lt;</span>pattern</span><span>></span></span>[%d{yyyy-MM-dd' 'HH:mm:ss.sss}] [%C] [%t] [%L] [%-5p] %m%n<span><span><span>&lt;/</span>pattern</span><span>></span></span>
        <span><span><span>&lt;/</span>layout</span><span>></span></span>
    <span><span><span>&lt;/</span>appender</span><span>></span></span>
    <span>&lt;!--获取比info级别高(包括info级别)但除error级别的日志--></span>
    <span><span><span>&lt;</span>appender</span> <span>name</span><span><span>=</span><span>"</span>INFO-LOG<span>"</span></span> <span>class</span><span><span>=</span><span>"</span>ch.qos.logback.core.rolling.RollingFileAppender<span>"</span></span><span>></span></span>
        <span><span><span>&lt;</span>filter</span> <span>class</span><span><span>=</span><span>"</span>ch.qos.logback.classic.filter.LevelFilter<span>"</span></span><span>></span></span>
            <span><span><span>&lt;</span>level</span><span>></span></span>ERROR<span><span><span>&lt;/</span>level</span><span>></span></span>
            <span><span><span>&lt;</span>onMatch</span><span>></span></span>DENY<span><span><span>&lt;/</span>onMatch</span><span>></span></span>
            <span><span><span>&lt;</span>onMismatch</span><span>></span></span>ACCEPT<span><span><span>&lt;/</span>onMismatch</span><span>></span></span>
        <span><span><span>&lt;/</span>filter</span><span>></span></span>
        <span><span><span>&lt;</span>encoder</span><span>></span></span>
            <span><span><span>&lt;</span>pattern</span><span>></span></span>[%d{yyyy-MM-dd' 'HH:mm:ss.sss}] [%C] [%t] [%L] [%-5p] %m%n<span><span><span>&lt;/</span>pattern</span><span>></span></span>
        <span><span><span>&lt;/</span>encoder</span><span>></span></span>

        <span>&lt;!--滚动策略--></span>
        <span><span><span>&lt;</span>rollingPolicy</span> <span>class</span><span><span>=</span><span>"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span>"</span></span><span>></span></span>
            <span>&lt;!--路径--></span>
            <span><span><span>&lt;</span>fileNamePattern</span><span>></span></span>${LOG_INFO_HOME}//%d.log<span><span><span>&lt;/</span>fileNamePattern</span><span>></span></span>
            <span><span><span>&lt;</span>maxHistory</span><span>></span></span>30<span><span><span>&lt;/</span>maxHistory</span><span>></span></span>
        <span><span><span>&lt;/</span>rollingPolicy</span><span>></span></span>
    <span><span><span>&lt;/</span>appender</span><span>></span></span>
    <span><span><span>&lt;</span>appender</span> <span>name</span><span><span>=</span><span>"</span>ERROR-LOG<span>"</span></span> <span>class</span><span><span>=</span><span>"</span>ch.qos.logback.core.rolling.RollingFileAppender<span>"</span></span><span>></span></span>
        <span><span><span>&lt;</span>filter</span> <span>class</span><span><span>=</span><span>"</span>ch.qos.logback.classic.filter.ThresholdFilter<span>"</span></span><span>></span></span>
            <span><span><span>&lt;</span>level</span><span>></span></span>ERROR<span><span><span>&lt;/</span>level</span><span>></span></span>
        <span><span><span>&lt;/</span>filter</span><span>></span></span>
        <span><span><span>&lt;</span>encoder</span><span>></span></span>
            <span><span><span>&lt;</span>pattern</span><span>></span></span>[%d{yyyy-MM-dd' 'HH:mm:ss.sss}] [%C] [%t] [%L] [%-5p] %m%n<span><span><span>&lt;/</span>pattern</span><span>></span></span>
        <span><span><span>&lt;/</span>encoder</span><span>></span></span>
        <span>&lt;!--滚动策略--></span>
        <span><span><span>&lt;</span>rollingPolicy</span> <span>class</span><span><span>=</span><span>"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span>"</span></span><span>></span></span>
            <span>&lt;!--路径--></span>
            <span><span><span>&lt;</span>fileNamePattern</span><span>></span></span>${LOG_ERROR_HOME}//%d.log<span><span><span>&lt;/</span>fileNamePattern</span><span>></span></span>
            <span><span><span>&lt;</span>maxHistory</span><span>></span></span>30<span><span><span>&lt;/</span>maxHistory</span><span>></span></span>
        <span><span><span>&lt;/</span>rollingPolicy</span><span>></span></span>
    <span><span><span>&lt;/</span>appender</span><span>></span></span>

    <span><span><span>&lt;</span>root</span> <span>level</span><span><span>=</span><span>"</span>info<span>"</span></span><span>></span></span>
        <span><span><span>&lt;</span>appender-ref</span> <span>ref</span><span><span>=</span><span>"</span>CONSOLE-LOG<span>"</span></span> <span>/></span></span>
        <span><span><span>&lt;</span>appender-ref</span> <span>ref</span><span><span>=</span><span>"</span>INFO-LOG<span>"</span></span> <span>/></span></span>
        <span><span><span>&lt;</span>appender-ref</span> <span>ref</span><span><span>=</span><span>"</span>ERROR-LOG<span>"</span></span> <span>/></span></span>
    <span><span><span>&lt;/</span>root</span><span>></span></span>
<span><span><span>&lt;/</span>configuration</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>部分标签说明</p>
<p><code>&lt;root&gt;</code>标签，必填标签，用来指定最基础的日志输出级别</p>
<ul>
<li><code>&lt;appender-ref&gt;</code>标签，添加<code>append</code></li>
</ul>
<p><code>&lt;append&gt;</code>标签，通过使用该标签指定日志的收集策略</p>
<ul>
<li><code>name</code>属性指定<code>appender</code>命名</li>
<li><code>class</code>属性指定输出策略，通常有两种，控制台输出和文件输出，文件输出就是将日志进行一个持久化。<code>ConsoleAppender</code>将日志输出到控制台</li>
</ul>
<p><code>&lt;filter&gt;</code>标签，通过使用该标签指定过滤策略</p>
<ul>
<li><code>&lt;level&gt;</code>标签指定过滤的类型</li>
</ul>
<p><code>&lt;encoder&gt;</code>标签，使用该标签下的<code>&lt;pattern&gt;</code>标签指定日志输出格式。</p>
<p><code>&lt;rollingPolicy&gt;</code>标签指定收集策略，比如基于时间进行收集</p>
<ul>
<li><code>&lt;fileNamePattern&gt;</code>标签指定生成日志保存地址 通过这样配置已经实现了分类分天手机日志的目标了</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16556915204025.jpeg" alt="图片" loading="lazy"></p>
<h3 id="_03、logback-高级特性异步输出日志" tabindex="-1"> 03、logback 高级特性异步输出日志</h3>
<p>之前的日志配置方式是基于同步的，每次日志输出到文件都会进行一次磁盘IO。采用异步写日志的方式而不让此次写日志发生磁盘IO，阻塞线程从而造成不必要的性能损耗。异步输出日志的方式很简单，添加一个基于异步写日志的<code>appender</code>，并指向原先配置的<code>appender</code>即可</p>
<div><pre><code> <span>&lt;!-- 异步输出 --></span>
    <span><span><span>&lt;</span>appender</span> <span>name</span><span><span>=</span><span>"</span>ASYNC-INFO<span>"</span></span> <span>class</span><span><span>=</span><span>"</span>ch.qos.logback.classic.AsyncAppender<span>"</span></span><span>></span></span>
        <span>&lt;!-- 不丢失日志.默认的,如果队列的80%已满,则会丢弃TRACT、DEBUG、INFO级别的日志 --></span>
        <span><span><span>&lt;</span>discardingThreshold</span><span>></span></span>0<span><span><span>&lt;/</span>discardingThreshold</span><span>></span></span>
        <span>&lt;!-- 更改默认的队列的深度,该值会影响性能.默认值为256 --></span>
        <span><span><span>&lt;</span>queueSize</span><span>></span></span>256<span><span><span>&lt;/</span>queueSize</span><span>></span></span>
        <span>&lt;!-- 添加附加的appender,最多只能添加一个 --></span>
        <span><span><span>&lt;</span>appender-ref</span> <span>ref</span><span><span>=</span><span>"</span>INFO-LOG<span>"</span></span><span>/></span></span>
    <span><span><span>&lt;/</span>appender</span><span>></span></span>

    <span><span><span>&lt;</span>appender</span> <span>name</span><span><span>=</span><span>"</span>ASYNC-ERROR<span>"</span></span> <span>class</span><span><span>=</span><span>"</span>ch.qos.logback.classic.AsyncAppender<span>"</span></span><span>></span></span>
        <span>&lt;!-- 不丢失日志.默认的,如果队列的80%已满,则会丢弃TRACT、DEBUG、INFO级别的日志 --></span>
        <span><span><span>&lt;</span>discardingThreshold</span><span>></span></span>0<span><span><span>&lt;/</span>discardingThreshold</span><span>></span></span>
        <span>&lt;!-- 更改默认的队列的深度,该值会影响性能.默认值为256 --></span>
        <span><span><span>&lt;</span>queueSize</span><span>></span></span>256<span><span><span>&lt;/</span>queueSize</span><span>></span></span>
        <span>&lt;!-- 添加附加的appender,最多只能添加一个 --></span>
        <span><span><span>&lt;</span>appender-ref</span> <span>ref</span><span><span>=</span><span>"</span>ERROR-LOG<span>"</span></span><span>/></span></span>
    <span><span><span>&lt;/</span>appender</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_04、异步输出日志性能测试" tabindex="-1"> 04、异步输出日志性能测试</h3>
<p>既然能提高性能的话，必须进行一次测试比对，同步和异步输出日志性能到底能提升多少倍？</p>
<h3 id="_05、服务器硬件" tabindex="-1"> 05、服务器硬件</h3>
<ul>
<li><code>CPU</code> 六核</li>
<li>内存 8G</li>
</ul>
<h3 id="_06、测试工具" tabindex="-1"> 06、测试工具</h3>
<ul>
<li>Apache Jmeter</li>
</ul>
<h3 id="_07、同步输出日志" tabindex="-1"> 07、同步输出日志</h3>
<ul>
<li>线程数：100</li>
<li><code>Ramp-Up Loop</code>(可以理解为启动线程所用时间) ：0 可以理解为100个线程同时启用</li>
<li>测试结果</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16556915204021.png" alt="图片" loading="lazy"></p>
<p>重点关注指标 Throughput【TPS】 吞吐量：系统在单位时间内处理请求的数量，在同步输出日志中 TPS 为 44.2/sec</p>
<h3 id="_08、异步输出日志" tabindex="-1"> 08、异步输出日志</h3>
<ul>
<li>线程数 100</li>
<li><code>Ramp-Up Loop</code>：0</li>
<li>测试结果</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16556915204022.png" alt="图片" loading="lazy"></p>
<p>TPS 为 497.5/sec ， 性能提升了10多倍！！！</p>
<h3 id="_09、异步日志输出原理" tabindex="-1"> 09、异步日志输出原理</h3>
<p>从<code>logback</code>框架下的<code>Logger.info</code>方法开始追踪。一路的方法调用路径如下图所示：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16556915204023.png" alt="图片" loading="lazy"></p>
<p>异步输出日志中最关键的就是配置文件中<code>ch.qos.logback.classic``AsyncAppenderBase``append</code></p>
<div><pre><code>//来自阿里大佬的《LeetCode刷题答案》pdf新鲜出炉
//年末面试必备！大家可以关注公众号TJ君，回复LeetCode领取。

protected void append(E eventObject) {
        if(!this.isQueueBelowDiscardingThreshold() || !this.isDiscardable(eventObject)) {
            this.preprocess(eventObject);
            this.put(eventObject);
        }
    }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>通过队列情况判断是否需要丢弃日志，不丢弃的话将它放到阻塞队列中，通过查看代码，这个阻塞队列为<code>ArrayBlockingQueueu</code>，默认大小为256，可以通过配置文件进行修改。<code>Logger.info(...)</code>到<code>append(...)</code>就结束了，只做了将日志塞入到阻塞队列的事，然后继续执行<code>Logger.info(...)</code>下面的语句了。在<code>AsyncAppenderBase</code>类中定义了一个<code>Worker</code>线程，<code>run</code>方法中的关键部分代码如下:</p>
<div><pre><code>E e = parent.blockingQueue.take();
aai.appendLoopOnAppenders(e);
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>从阻塞队列中取出一个日志，并调用<code>AppenderAttachableImpl</code>类中的<code>appendLoopOnAppenders</code>方法维护一个<code>Append</code>列表。<code>Worker</code>线程中调用方法过程主要如下图：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16556915204024.png" alt="图片" loading="lazy"></p>
<p>最主要的两个方法就是<code>encode``write``encode</code></p>
<p>来源：<a href="https://juejin.cn/post/6844903909920604174" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/6844903909920604174</a></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-30T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Oracle的数据 导入与导出-数据库</title>
    <id>https://blog.ciberviler.top/linux/Oracle%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5%E4%B8%8E%E5%AF%BC%E5%87%BA-%E6%95%B0%E6%8D%AE%E5%BA%93.html</id>
    <link href="https://blog.ciberviler.top/linux/Oracle%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5%E4%B8%8E%E5%AF%BC%E5%87%BA-%E6%95%B0%E6%8D%AE%E5%BA%93.html"/>
    <updated>2022-06-20T02:16:47.000Z</updated>
    <content type="html"><![CDATA[<h1 id="oracle的数据-导入与导出-数据库" tabindex="-1"> Oracle的数据 导入与导出-数据库</h1>
<h2 id="_1-数据库导入导出需要注意" tabindex="-1"> 1 数据库导入导出需要注意</h2>
<p>1.目标数据库要与源数据库有着名称相同的表空间。</p>
<p>2.目标数据在进行导入时，用户名尽量相同(这样保证用户的权限级别相同)。</p>
<p>3.目标数据库每次在进行数据导入前，应做好数据备份，以防数据丢失。</p>
<p>4.弄清是导入导出到相同版本还是不同版本(oracle10g 版本与 oracle11g 版本)。</p>
<p>5.目标数据导入前,弄清楚是数据覆盖(替换),还是仅插入新数据或替换部分数据表。</p>
<p>6.确定目标数据库磁盘空间是否足够容纳新数据，是否需要扩充表空间。</p>
<p>7.导入导出时注意字符集是否相同，一般 Oracle 数据库的字符集只有一个，并且固定，</p>
<p>一般不改变。</p>
<p>8.确定操作者的账号权限。</p>
<p><a href="https://article.itxueyuan.com/2d0kg5" target="_blank" rel="noopener noreferrer">https://article.itxueyuan.com/2d0kg5</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/73851450" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/73851450</a></p>
<p><a href="https://www.jb51.net/article/156826.htm" target="_blank" rel="noopener noreferrer">https://www.jb51.net/article/156826.htm</a></p>
<p><a href="https://www.gxlcms.com/sql_question-400828.html" target="_blank" rel="noopener noreferrer">https://www.gxlcms.com/sql_question-400828.html</a></p>
<h2 id="_2-导出-数据-格式介绍" tabindex="-1"> 2 导出 数据 格式介绍</h2>
<p>Dmp 格式：.dmp 是二进制文件，可跨平台，还能包含权限，效率好。</p>
<p>Sql 格式：.sql 格式的文件，可用文本编辑器查看，通用性比较好，效率不如第一种，</p>
<p>适合小数据量导入导出。尤其注意的是表中不能有大字段 （blob,clob,long），如果有，会</p>
<p>报错。</p>
<p>Pde 格式：.pde 格式的文件，.pde 为 PL/SQL Developer 自有的文件格式，只能用 PL/SQL</p>
<p>Developer 工具导入导出，不能用文本编辑器查看。</p>
<h3 id="_3-方式" tabindex="-1"> 3 方式</h3>
<h4 id="_1、传统方法" tabindex="-1"> <em><strong>1、传统方法：</strong></em></h4>
<p><em><strong>dmp文件的导出</strong></em></p>
<p>首先,我们先了解dmp文件的导出</p>
<p>dmp文件导出一般用的比较多的是三种,分别是: 导出整个数据库实例的所有数据,导出指定用户的所有的表,导出指定表.</p>
<p>我们以自己的数据库为例,假设我们的数据库的实例为&quot;Oracle&quot;</p>
<p>可以通过&quot;任务管理器----&gt;服务&quot;中查看自己的数据库实例</p>
<p>一般信息是 已启用 自动 本地系统</p>
<p>打开cmd命令行 :</p>
<p>1: 将数据库Oracle完全导出,用户名system密码manager导出到 c:daochu.dmp中</p>
<div><pre><code>exp system<span>/</span>manager<span>@Oracle</span> <span>file</span><span>=</span>c:daochu<span>.</span>dmp <span>full</span><span>=</span>y
</code></pre><div aria-hidden="true"><div></div></div></div><p>2: 将数据库中RFD用户与,JYZGCX用户的表导出</p>
<div><pre><code>exp system<span>/</span>manager<span>@ORACLE</span> <span>file</span><span>=</span>d:daochu<span>.</span>dmp owner<span>=</span><span>(</span>RFD<span>,</span>JYZGCX<span>)</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>3: 将数据库中的表T_USER,T_ROLE导出</p>
<p>ystem为用户名，manager为密码，ORACLE为数据库实例名，其实不一定非的用system用户，只要是拥有管理员权限的用户都可以</p>
<div><pre><code>exp JYZGCX<span>/</span>JYZGCX<span>@Oracle</span> <span>file</span> <span>=</span> d:datanewsmgnt<span>.</span>dmp <span>tables</span> <span>=</span> <span>(</span>T_USER<span>,</span>T_ROLE<span>)</span>
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code><span>--备份某几张表  ！！！！</span>
exp smsc<span>/</span>smsc <span>file</span><span>=</span><span>/</span><span>data</span><span>/</span>oracle_bak<span>/</span>dmp<span>/</span>bakup0209_2<span>.</span>dmp <span>tables</span><span>=</span>\<span>(</span>send_msg_his<span>,</span>send_msg<span>,</span>recv_msg_his<span>,</span>recv_msg\<span>)</span>
<span>--备份整个数据库 ！！！！</span>
<span>--方式1</span>
exp smsc<span>/</span>smsc <span>file</span><span>=</span><span>/</span><span>data</span><span>/</span>oracle_bak<span>/</span>dmp<span>/</span>bakupsmmc0209_2<span>.</span>dmp <span>full</span><span>=</span>y
<span>--方式2</span>
exp cop<span>/</span>cop<span>@133.96.84.39</span>:<span>1521</span><span>/</span>coprule <span>file</span><span>=</span><span>/</span>home<span>/</span>oracle<span>/</span>cop_20160902<span>.</span>dmp owner<span>=</span>cop log<span>=</span><span>/</span>home<span>/</span>oracle<span>/</span>cop<span>.</span>log
<span>--本机上</span>
exp zop<span>/</span>zop<span>@orcl</span> <span>file</span><span>=</span> D:\zop_bak<span>.</span>dmp owner<span>=</span>zop log<span>=</span>D:\zop_ba<span>.</span>log
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><em><strong>dmp文件的导入</strong></em></p>
<p>步骤如下:</p>
<p>机器环境是windows7,其实也无所谓,命令行不都是样的么</p>
<p>\1. 打开&quot;开始&quot; ---&gt;输入cmd,打开cmd命令窗口,输入: sqlplus/as sysdba; 然后使用conn / as sysdba;这样就可以以超级管理员的最高权限登录,当然这决定于init.ora文件中的数据库初始化参数.</p>
<p>\2. 上面sysdba登录后,就可以创建表空间和用户了.</p>
<p>(打开&quot;开始&quot;--&gt;输入cmd--&gt;sqlplus/nolog; 输入conn/as sysdba 管理员账户登录;)</p>
<p>由于我们已经有dmp文件了,可以用notepad++ 打开dmp文件,进去按ctrl+f 去查找tablespace,可以找到这个dmp文件对应的表空间,然后根据表空间的信息去创建表空间,这样才能导入dmp文件.</p>
<p>然后就是创建表空间,命令如下:</p>
<div><pre><code><span>create</span> <span>tablespace</span> USERS

logging

datefile <span>'D:oracleproduct10.2.0oradataorclUSERS.dnf'</span>

size <span>32</span>m

autoxtend onnext <span>32</span>m maxsize <span>2048</span>m

extend management <span>local</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>创建test用户,密码也是test222,使用上面创建的表空间</p>
<div><pre><code><span>create</span> <span>user</span> test identifiles <span>by</span> test222

 <span>default</span> <span>tablespace</span> USERS
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>给创建的test用户分配权限,为了方便可以直接分配dba权限</p>
<p><code>grant dba to test;</code></p>
<p>这样一来,我们前期的准备工作就完成了,然后就可以关掉刚刚的命令窗口了.</p>
<p>打开&quot;开始&quot; ---&gt;输入cmd(是cmd窗口不是sqlplus窗口)</p>
<p>由于上面的步骤中,创建了test用户,所以我们往test用户去导入数据</p>
<p>直接输入如下的语句:</p>
<div><pre><code>imp test<span>/</span>test222<span>@localhost</span><span>/</span>orcl <span>file</span><span>=</span><span>"C:UsersxiejiachenDesktoptest20190630.DMP"</span> <span>full</span> <span>=</span>y<span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>下面解释一下上面的语句:</p>
<p>test是上面创建的登录数据库的用户名</p>
<p>test222是上面的登录数据库的密码</p>
<p>localhost: 代表你的数据库是本机还是远程导入,需要的可以随时替换ip地址</p>
<p>orcl: 是实例的名称</p>
<p>file: 后面是你的dmp的文件路径</p>
<p>full=y : 全部导入</p>
<p>以上就是oracle数据库导出和导入dmp文件的两种方法.</p>
<div><pre><code><span>--数据的导入</span>
<span>--1 将D:\daochu.dmp 中的数据导入 TEST数据库中。</span>
 imp system<span>/</span>manager<span>@TEST</span> <span>file</span><span>=</span>d:\daochu<span>.</span>dmp
 imp aichannel<span>/</span>aichannel<span>@TEST</span> <span>full</span><span>=</span>y <span>file</span><span>=</span>d:\datanewsmgnt<span>.</span>dmp <span>ignore</span><span>=</span>y
<span>--上面可能有点问题，因为有的表已经存在，然后它就报错，对该表就不进行导入。</span>
<span>-- 在后面加上 ignore=y 就可以了。</span>
<span>--2 将d:daochu.dmp中的表table1 导入</span>
imp system<span>/</span>manager<span>@TEST</span> <span>file</span><span>=</span>d:\daochu<span>.</span>dmp <span>tables</span><span>=</span><span>(</span>table1<span>)</span>
<span>--基本上上面的导入导出够用了。不少情况要先是将表彻底删除，然后导入。</span>
注意：
操作者要有足够的权限，权限不够它会提示。
数据库时可以连上的。可以用tnsping TEST 来获得数据库TEST能否连上。
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_2、数据泵方法" tabindex="-1"> <em><strong>2、数据泵方法：</strong></em></h4>
<p>创建directory:</p>
<div><pre><code>expdp<span>(</span>impdp<span>)</span> username<span>/</span>password<span>@SERVICENAME</span>:<span>1521</span> 
schemas<span>=</span>username <span>dumpfile</span><span>=</span>file1<span>.</span>dmp logfile<span>=</span>file1<span>.</span>log 
directory<span>=</span>testdata1 remap_schema<span>=</span>test:test<span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>数据库导出举例:</p>
<div><pre><code>expdp xinxiaoyong<span>/</span><span>123456</span><span>@127.0.0.1</span>:<span>1521</span> schemas<span>=</span>xinxiaoyong <span>dumpfile</span><span>=</span>test<span>.</span>dmp 

logfile<span>=</span>test<span>.</span>log directory<span>=</span>testdata1<span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><div><pre><code>exp:导出命令，导出时必写。
imp:导入命令，导入时必写<span>,</span>每次操作，二者只能选择一个执行。
username:导出数据的用户名，必写<span>;</span>
password:导出数据的密码，必写<span>;</span>
@:地址符号，必写<span>;</span>
SERVICENAME:Oracle的服务名，必写<span>;</span>
<span>1521</span>:端口号，<span>1521</span>是默认的可以不写<span>,</span>非默认要写<span>;</span>
schemas：导出操作的用户名<span>;</span>
<span>dumpfile</span>：导出的文件<span>;</span>
logfile:导出的日志文件<span>,</span>可以不写；
directory:创建的文件夹名称<span>;</span>
remap_schema<span>=</span>源数据库用户名:目标数据库用户名<span>,</span>二者不同时必写，相同可以省略<span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>1.查看表空间：</p>
<p><code>select ＊　from dba_tablespaces;</code></p>
<p>2.查看管理理员目录(同时查看操作系统是否存在，因为Oracle并不关心该目录是否存在，如果不存在，则出错)。</p>
<p><code>select ＊　from dba_directories;</code></p>
<p>3.创建逻辑目录，该命令不会在操作系统创建真正的目录，最好以system等管理员创建。</p>
<p><code>create directory testdata1 as 'd:testdump';</code></p>
<p>4.给xinxiaoyong用户赋予在指定目录的操作权限，最好以system等管理员赋予。
//xinxiaoyong 是用户名(123456是用户密码)</p>
<p><code>grant read,write on directory testdata1 to xinxiaoyong;</code></p>
<p>5.导出数据</p>
<p>1)按用户导</p>
<div><pre><code>expdp xinxiaoyong<span>/</span><span>*</span><span>*</span><span>*</span><span>123456</span><span>*</span><span>*</span><span>*</span><span>@orcl</span> schemas<span>=</span>xinxiaoyong <span>dumpfile</span><span>=</span>expdp<span>.</span>dmp directory<span>=</span>testdata1<span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>2)并行进程</p>
<div><pre><code>parallel expdp xinxiaoyong<span>/</span><span>*</span><span>*</span><span>*</span><span>123456</span><span>*</span><span>*</span><span>*</span><span>@orcl</span> 
directory<span>=</span>testdata1 <span>dumpfile</span><span>=</span>xinxiaoyong3<span>.</span>dmp parallel<span>=</span><span>*</span><span>*</span><span>*</span><span>40</span><span>*</span><span>*</span><span>*</span> job_name<span>=</span>xinxiaoyong3
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>3)按表名导</p>
<div><pre><code>expdp xinxiaoyong<span>/</span><span>*</span><span>*</span><span>*</span><span>123456</span><span>*</span><span>*</span><span>*</span><span>@orcl</span> <span>tables</span><span>=</span>emp<span>,</span>dept <span>dumpfile</span><span>=</span>expdp<span>.</span>dmp directory<span>=</span>testdata1<span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>4)按查询条件导</p>
<div><pre><code>expdp xinxiaoyong<span>/</span><span>*</span><span>*</span><span>*</span><span>123456</span><span>*</span><span>*</span><span>*</span><span>@orcl</span> 
directory<span>=</span>testdata1 <span>dumpfile</span><span>=</span>expdp<span>.</span>dmp <span>tables</span><span>=</span>emp query<span>=</span><span>'WHERE deptno=20'</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>5)按表空间导</p>
<div><pre><code>expdp system<span>/</span>manager directory<span>=</span>testdata1 <span>dumpfile</span><span>=</span><span>tablespace</span><span>.</span>dmp tablespaces<span>=</span><span>temp</span><span>,</span>example<span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>6)导整个数据库</p>
<div><pre><code>expdp system<span>/</span>manager directory<span>=</span>testdata1 <span>dumpfile</span><span>=</span><span>full</span><span>.</span>dmp <span>FULL</span><span>=</span>y<span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>6.还原数据
1)导到指定用户下</p>
<div><pre><code> impdp xinxiaoyong<span>/</span><span>*</span><span>*</span><span>*</span><span>123456</span><span>*</span><span>*</span><span>*</span> directory<span>=</span>testdata1 <span>dumpfile</span><span>=</span>expdp<span>.</span>dmp schemas<span>=</span>xinxiaoyong<span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>2)改变表的</p>
<div><pre><code>owner impdp system<span>/</span>manager 
directory<span>=</span>testdata1 <span>dumpfile</span><span>=</span>expdp<span>.</span>dmp <span>tables</span><span>=</span>xinxiaoyong<span>.</span>dept remap_schema <span>=</span>xinxiaoyong:system<span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>3)导入表空间</p>
<div><pre><code>impdp system/manager directory=testdata1 dumpfile=tablespace.dmp tablespaces=example;
</code></pre><div aria-hidden="true"><div></div></div></div><p>4)导入数据库</p>
<div><pre><code>impdb system<span>/</span>manager directory<span>=</span>dump_dir <span>dumpfile</span><span>=</span><span>full</span><span>.</span>dmp <span>FULL</span><span>=</span>y<span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>5)追加数据</p>
<div><pre><code>impdp system<span>/</span>manager 
directory<span>=</span>testdata1 <span>dumpfile</span><span>=</span>expdp<span>.</span>dmp schemas<span>=</span>system table_exists_action<span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h4 id="_3、plsql方法" tabindex="-1"> <em><strong>3、PLSQL方法：</strong></em></h4>
<p>登录plsql工具，所使用用户为源数据库有导出权限（exp_full_database,dba等）的用户。</p>
<p>1.导出建表语句（包括存储结构）</p>
<p>导出步骤tools -&gt;export user object，选择要导出的对象，导出.sql格式文件并等待导出完成，如 下图：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220620092932901.png" alt="image-20220620092932901" loading="lazy"></p>
<p>导出数据文件 ;
   2.导出步骤tools -&gt;export tables，选择要导出的表及导出的格式进行导出。</p>
<p>导出为dmp格式，如下图：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220620092943308.png" alt="image-20220620092943308" loading="lazy"></p>
<p>导出为sql格式，如下图：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220620092949353.png" alt="image-20220620092949353" loading="lazy"></p>
<p>导出为pde格式，如下图：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220620092954469.png" alt="image-20220620092954469" loading="lazy"></p>
<p>提示说明：采用第三方工具导出导入整个数据库的话，耗时较长，一定要有足够</p>
<p>的时间来操作(数据量大的话需要好几个小时)。</p>
<p>3.导入建表语句
   导入步骤tools-&gt;import tables-&gt;SQL Inserts 导入.sql文件
4.导入数据；
   tools-&gt;import talbes，然后再根据导出的数据格式选择导入dmp文件，或者sql文件，
或者pde文件。
   提示说明：导入之前最好把以前的表删除，当然导入另外数据库除外。
      另外导入时当发现进度条一直卡在一个点，而且导出的文件不再增大时，甚至是提示程序
未响应，千万不要以为程序卡死了，这个导入导出就是比较缓慢，只要没有提示报错，</p>
<p>或者导入完成就不要停止程序。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Linux" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-29T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Oracle数据库基础</title>
    <id>https://blog.ciberviler.top/linux/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80.html</id>
    <link href="https://blog.ciberviler.top/linux/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80.html"/>
    <updated>2022-06-20T01:36:59.000Z</updated>
    <content type="html"><![CDATA[<h1 id="oracle数据库基础" tabindex="-1"> Oracle数据库基础</h1>
<p><strong>数据字典</strong>，数据库元数据信息的数据字典表和用户可以读取的数据字典视图组成。存放oracle数据库所用的有关信息。通过数据字典可以查看数据表和用户的一些信息。</p>
<p><strong>数据文件</strong>，一个oracle数据可以拥有一个或多个物理的数据文件，一个数据文件只对于一个数据库</p>
<p><strong>表空间</strong>，存储的逻辑结构，是组织数据和进行空间分配的逻辑结构。简单点，表空间就是一个或者多个数据文件的集合，所有的数据文件都被逻辑的存放在指定的表空间中。通常有system 、sysaux、 temp三个默认表空间。</p>
<p><strong>系统用户</strong>：sys，system，sysman，scott默认密码tigger，</p>
<p><strong>系统用户登入SQLplus</strong>：[system/123456][@server/ip][as sysdba/sysoper]管理员权限，@server/ip，数据库不在本机，需要输入IP。</p>
<p><strong>登入用户命令</strong>：connect sys/123456 as sysdba；connect system/123456</p>
<p><strong>查看当前登入用户</strong>：show user</p>
<p><strong>使用数据字典来查看信息</strong>：含有的字典有dba_users、user_users、dba_tablespaces，user_tablespaces(普通用户表空间)</p>
<p>可以使用desc来查看数据字典都有些什么字段， desc dba_users，之后可以使用select语句查看具体的记录。可以查看某个用户默认的表空间。</p>
<p><strong>启用用户的语句</strong>：alter user username account unlock。比如启动scoot用户alter user scott account unlock；这样就可以使用scott用户登入系统。</p>
<h2 id="表空间" tabindex="-1"> <strong>表空间</strong></h2>
<p>这是数据库的逻辑存储空间，在数据库中开辟的一个空间来存储数据，oracle的很多优化都是通过表空间来实现的。表都是放在表空间的数据文件里面。</p>
<p>一个形象的比喻：在一个房间里面这个房间可以存储很多箱子，箱子里面可以存储物品！ 表空间可以看成房间，箱子可以看成数据文件物品可以看成表。 用户指定表空间也就是你希望把属于这个用户的表放在那个房间（表空间）里面。
表空间是一个虚拟的概念可以无限大，但是需要由数据文件作为载体。</p>
<p><strong>为什么要创建表空间？</strong></p>
<p>答：在建立用户的时候，我们建议数据库管理员要指定用户的默认表空间。因为我们在利用CREATE语句创建数据库对象，如数据库表的时候，其默认是存储在数据库的当前默认空间。若不指定用户默认表空间的话，则用户每次创建数据库对象的时候，都要指定表空间，显然，这并不是很合理。不同的表空间有不同的权限控制。用户对于表空间A具有完全控制权限，可能对于表空间B就只有查询权限，甚至连连接的权限的都没有。所以，合理为用户配置表空间的访问权限，也是提高数据库安全性的一个方法。</p>
<p><strong>修改用户默认的表空间（管理员权限）</strong>：alter user username default | temporary tablespace tablename.</p>
<p><strong>创建表空间</strong>：create [temporary] tablespace tablename tempfile | datafile 'xxx.dbf' size xx； (默认目录下)</p>
<p><strong>如何查看默认路径</strong>：通过数据字典dba_data_files；临时表空间dba_temp_files</p>
<p>select file_name from dba_data_files where tablesopace_name='XXX.dbf'</p>
<p>设置表空间联机或脱机状态(无法使用表空间)，创建好表空间后默认是联机状态：alter tablespace tablename online | offline；</p>
<p><strong>设置表空间的只读或者只写</strong>：alter tablespace tablename read only | write only | read write;</p>
<p><strong>如何查看表空间所处的状态</strong>：通过status字段（dba_tablespaces）select statue from dba_tablespaces where tablespace_name='XXX.dbf';</p>
<p><strong>为表空间添加数据文件</strong>：alter tablespace tablename add datafile 'xxx.dbf' size xx；可以从字典dba_data_files中file_name字段查看当前表空间的数据文件。</p>
<p><strong>删除表空间的数据文件</strong>：alter tablespace tablename drop datafile 'xxx.dbf' ；不能删除第一条</p>
<p><strong>删除表空间</strong>：drop tablespace tablename [ including contents ] 如果只是删除表空间就直接使用drop。如果需要将表空间里面的文件也删除，就使用including。</p>
<p><strong>创建用户</strong>：create user 用户名 identified by 密码 default tablespace 表空间表；</p>
<p><strong>接着授权给新建的用户：</strong>
grant connect,resource to news; --表示把 connect,resource权限授予news用户
​grant dba to news; --表示把 dba权限授予给news用户</p>
<h2 id="表" tabindex="-1"> <strong>表</strong></h2>
<p>存储数据的基本单位，表是一个二维结构，行列。数据类型：字符型、日期型、数值型、其他类型。</p>
<p><strong>字符型</strong>：char(n)、nchar(n)，固定的数据类型，如果没有达到N那么就自动补空格。</p>
<p>varchar2(n)、nvarchar2(n)，可变的数据类型，可以节省空间</p>
<p><strong>数值型</strong>：number（p,s）p有效数字，s小数点后的位数。float（）二进制。number（6，0）表示6位整数</p>
<p><strong>日期型</strong>：date</p>
<p><strong>其他类型</strong>：blob、clob，存储4GB的数据</p>
<p>**创建表：**create tabel table_name ( colum1_name datatype，colum2_name datatype <strong>default 默认值</strong> )；</p>
<p><strong>查看表结构</strong>：desc table_name</p>
<p><strong>修改表</strong>：alert table tablename add column_name datatype； 增加字段</p>
<p>alert table tablename modify column_name datatype；修改数据类型</p>
<p>alert table tablename drop column column_name ；删除字段</p>
<p>alert table tablename rename column column_oldname to column_newname；修改字段的名字</p>
<p>rename table_oldname to table_newname ；修改表名</p>
<p><strong>删除表</strong>：truncate table table_name；截断表中的数据，执行后，表字段在，但内容不在。</p>
<p>drop table table_name ；彻底删除表</p>
<p>操作表中的数据</p>
<p><strong>添加数据</strong>：insert into table_name [(column1, column2,....)] values(value1,value2,...)</p>
<p>alert table tablename modify column_name default 默认值</p>
<p><strong>复制表的数据</strong>：create table table_name <strong>as</strong> select column1,... from other_tablename ； 复制表中的内容</p>
<p>insert into table_name [(column1, column2,....)] select column1,* from table_old</p>
<p><strong>更新数据</strong>： update table_name set column1=value1,...[where conditions]</p>
<p><strong>删除数据</strong>：delete from table_name ; 删除全部数据和truncate一样，但是truncate效率高。</p>
<p>有条件删除，上面加上where子句。</p>
<h2 id="约束" tabindex="-1"> <strong>约束</strong></h2>
<p>作用定义规则，那些字段是一定需要输入的，那些字段是需要唯一的等等，这样可以确保数据的完整性。</p>
<p><strong>非空约束</strong>：not null 在数据类型之后添加即可。id number(6,0) not null</p>
<p>alert table tablename <strong>modify</strong> column_name datatype null ; 将非空的改为可以为空</p>
<p><strong>主键约束</strong>：可以为一个字段，也可以是多个字段称为复合主键 primary key</p>
<p>create table name(column1,..., constraint keyname primary key(column1,column2))；复合约束</p>
<p>如果忘记了约束的名字，可以在<strong>数据字典user_constraints</strong>里面查看</p>
<p>alert table tablename add constraint keyname primary key(column1,column2))；表创建好后添加主键</p>
<p>alert table tablename rename constraint oldname to new_name；更改约束名字</p>
<p><strong>删除约束</strong>：alert table tablename disable | enable constaint name；禁用主键约束</p>
<p>alert table tablename drop constraint name</p>
<p>alert table tablename drop primary key [cascade]</p>
<p><strong>外键约束</strong>：alert table table1name (column_name datatype references table2name(column_name),..);</p>
<p>table2是主表，table1为从表，table2的column因为主键，对应字段的类型要一样。从表中的值来源于主表或者为空。</p>
<p>(add)constraint constraint_name foreign key(column) references table_name(column_name) [on delete cascade]</p>
<p>例子：create table userinfo (</p>
<p>id varchar(10),</p>
<p>name varchar(10),</p>
<p>typeid_new varchar(20) references typeid(typeid) on delete cascade</p>
<p>);</p>
<p><strong>唯一约束</strong>：unique，在字段名后加就可以，跟default使用一样的。</p>
<p>constraint constraint_name unique（column_name）</p>
<p><strong>检查约束</strong>：create table userinfo (</p>
<p>salary number(5,0) check( salary&gt;0 )</p>
<p>);</p>
<p>在SQLplus中可以使用以下语句更改显示的字段名、格式等：</p>
<p>col column_name heading new_name； 显示的名字</p>
<p>col column_name format a10； 更改字符型字段的长度，更改为10个字符长；</p>
<p>col column_name format 99; 更改数值型的显示位数，两位，保留一位小数99.9，也可以加上$</p>
<p>col column_name clear ；清楚之前设置的格式</p>
<h2 id="查询" tabindex="-1"> <strong>查询</strong></h2>
<p>对原表不会有影响，只是对查询结果有影响</p>
<p>select [distinct] column_name as newname</p>
<p>from table</p>
<p>[where ]</p>
<p>order by column1 desc/asc, column2</p>
<p>order by对查询结果进行排序</p>
<p>group by 对查询结果进行分组，以汇总数据或者整个分组显示单行的汇总信息，在结果中每组数据都有一个与之对应的统计值（count、min、max、sum、avg）。计算每个username的平均分数，group by username。</p>
<p>select job_id, avg(salary), sum(salary),count(*) from employees group by job_id；最后结果上会显示出4列</p>
<p><strong>rollup</strong>：在结果上增加一行，汇总各列信息，group by rollup(job_id)</p>
<p>having子句是对分组后的结果进行进一步的筛选，having是作用在组上面的。对having子句作用的理解就是记住select语句中子句的处理顺序，在select语句中，首先由from子句找到数据表，where子句接受from子句输出的数据，而having子句则接受来自group by 、where和from子句的输出。</p>
<p>逻辑运算符的优先级：not、and、or</p>
<p>模糊查询：like、_（任意一个字符）、%（任意多个值）、</p>
<p>以a开头的：where like 'a%'</p>
<p>含有a的用户名：where like '%a%'</p>
<p>case..when.：select username ,case when username ='aaa' then 计算机部门',</p>
<p>when 'bbb' then '市场部门' else '其他部门' end as 部门</p>
<p>from users;</p>
<p>判断某列的值是否为null：column is NULL/is NOT NULL</p>
<h2 id="多表查询" tabindex="-1"> <strong>多表查询</strong></h2>
<p>from table1 join_type table2 [on(join_condition)]</p>
<p>join_type有内连接（inner join），自然连接（natural join）、外连接。</p>
<p><strong>内连接</strong>：需要指定连接的条件，只返回符合条件和连接条件的行，消除不匹配的行。</p>
<p><strong>自然连接</strong>：第一个表中的那些列与第二表中具有相同名称的列进行连接，bU需要明确指出进行连接的列。</p>
<p><strong>外连接</strong>：扩展内连接的结果集，出返回匹配的结果集，还会返回不匹配的结果集。外连接有以下几种</p>
<p><strong>左外连接</strong>（left [outer] join）：显示左表中不匹配的行，满足where条件但不与右表匹配的行</p>
<p><strong>右外连接</strong>（right [outer] join）：显示右表中不匹配的行，满足where条件但不与左表匹配的行</p>
<p><strong>全外连接</strong>（full [outer] join）：显示所有符合搜索条件的行</p>
<p><code>grant &lt;权限&gt;，&lt;权限&gt; [on&lt;对象类型&gt;&lt;对象名&gt;] to &lt;用户&gt; [with admin option](可以授予给他人)</code></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Linux" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-28T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">ES6语法详解</title>
    <id>https://blog.ciberviler.top/dev/ES6%E8%AF%AD%E6%B3%95%E8%AF%A6%E8%A7%A3.html</id>
    <link href="https://blog.ciberviler.top/dev/ES6%E8%AF%AD%E6%B3%95%E8%AF%A6%E8%A7%A3.html"/>
    <updated>2022-06-15T06:57:48.000Z</updated>
    <content type="html"><![CDATA[<h1 id="es6语法详解" tabindex="-1"> ES6语法详解</h1>
<h2 id="let变量" tabindex="-1"> let变量</h2>
<p><code>let</code>声明的变量在<code>let</code>命令所在的代码块中有效。不存在变量提升，只能先声明后使用。</p>
<h3 id="暂存死区" tabindex="-1"> 暂存死区</h3>
<p>如果区块中存在<code>let</code>和<code>const</code>命令，这个区块对这些命令声明的变量，从一开始就形成了封闭作用域。凡是在声明之前就使用这些变量。</p>
<div><pre><code><span>var</span> a <span>=</span> <span>1</span><span>;</span>
<span>{</span>
    a <span>=</span> <span>2</span><span>;</span>           <span>//ReferenceError</span>
    <span>let</span> a <span>=</span> <span>'a'</span><span>;</span>
    console<span>.</span><span>log</span><span>(</span>a<span>)</span><span>;</span>  <span>//'a';</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>在相同块级作用域中，不能用<code>let</code>重复声明同一变量。即使已存在的变量是通过<code>var</code>声明的。</p>
<div><pre><code><span>let</span> a <span>=</span> <span>1</span><span>;</span>  <span>let</span> a <span>=</span> <span>2</span><span>;</span>   <span>//报错</span>
<span>let</span> a <span>=</span> <span>1</span><span>;</span>  <span>var</span> a <span>=</span> <span>2</span><span>;</span>   <span>//报错，var声明有变量提升作用</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h3 id="块级作用域和函数声明" tabindex="-1"> 块级作用域和函数声明</h3>
<p>在块级作用域中，用<code>let</code>声明的变量只在当前作用域中有效，且不会受到外部的影响，所以块级作用域可以替代自执行函数表达式。</p>
<p>理论上，函数在块级作用域中声明行为和<code>let</code>类似，但在es6浏览器环境中，为了兼容老版本，函数声明与<code>var</code>声明变量类似，会提升到全局作用域头部，和当前块级作用域的头部，为了避免差异，可以将函数声明写成函数表达式。</p>
<div><pre><code><span>let</span> <span>fn</span> <span>=</span> <span>function</span> <span>(</span><span>)</span> <span>{</span><span>}</span><span>;</span>    <span>//函数表达式</span>
</code></pre><div aria-hidden="true"><div></div></div></div><h2 id="const常量" tabindex="-1"> const常量</h2>
<p>声明常量必须马上赋值且不能再改变。<code>const</code>和<code>let</code>有类似的特点：在块级作用域内有效，声明不提升，存在暂存死区，不可重复声明。</p>
<p>复合型数据如<code>object</code>，声明后不可在重新赋值，但可以修改这个值本身，比如修改属性和新增属性。冻结对象可以使用<code>Object.freeze</code>方法。</p>
<div><pre><code><span>const</span> json <span>=</span> Object<span>.</span><span>freeze</span><span>(</span><span>{</span><span>}</span><span>)</span><span>;</span>
<span>//常规模式下修改json无效，严格模式下报错</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h3 id="顶层变量" tabindex="-1"> 顶层变量</h3>
<p><code>javascript</code>的顶层对象是<code>window</code>，<code>node</code>的顶层对象是<code>global</code>，<code>ES6</code>规定用<code>let</code> <code>const</code> <code>class</code>声明的变量不在是顶层对象的属性。</p>
<div><pre><code><span>let</span> a <span>=</span> <span>1</span><span>;</span>
window<span>.</span>a   <span>//undefined</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h2 id="解构赋值" tabindex="-1"> 解构赋值</h2>
<p>从数组和对象中提取值，对变量进行赋值，称为解构（destructuring）</p>
<p><strong>数组</strong>的解构赋值，按照对应的顺序赋值，如果值数量超出则多余的值被抛弃，如果值不够则为<code>undefined</code>。</p>
<div><pre><code><span>let</span> arr <span>=</span> <span>[</span><span>1</span><span>,</span> <span>[</span><span>2</span><span>,</span> <span>3</span><span>]</span><span>]</span><span>;</span>
<span>let</span> <span>[</span>a<span>,</span> <span>[</span>b<span>,</span> c<span>]</span><span>]</span> <span>=</span> arr<span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p><strong>对象</strong>的解构赋值必须要属性名相同，顺序毫无影响。如果属性名不同，需要写成如下形式。</p>
<div><pre><code><span>let</span> <span>{</span><span>a</span><span>:</span> b<span>}</span> <span>=</span> <span>{</span><span>c</span><span>:</span> <span>1</span><span>}</span><span>;</span>
b <span>//1</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>实际上对象解构赋值的是后者。</p>
<div><pre><code><span>let</span> <span>{</span>a<span>}</span> <span>=</span> <span>{</span><span>a</span><span>:</span> <span>1</span><span>}</span>     <span>//简写 </span>
<span>let</span> <span>{</span><span>a</span><span>:</span> a<span>}</span> <span>=</span> <span>{</span><span>a</span><span>:</span> <span>1</span><span>}</span>  <span>//全写</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p><strong>字符串</strong>解构赋值和数组类似。</p>
<div><pre><code><span>let</span> <span>[</span>a<span>,</span> b<span>,</span> c<span>]</span> <span>=</span> <span>'hello'</span><span>;</span>
console<span>.</span><span>log</span><span>(</span>a<span>,</span>b<span>,</span>c<span>)</span>  <span>//h,e,l</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>数组解构赋值<strong>默认值</strong>，当等号右边的值 <code>=== undefined</code>时，默认值生效。</p>
<div><pre><code><span>let</span> <span>[</span>a <span>=</span> <span>1</span><span>,</span> b <span>=</span> <span>2</span><span>]</span> <span>=</span> <span>[</span><span>undefined</span><span>,</span> <span>null</span><span>]</span><span>;</span>
console<span>.</span><span>log</span><span>(</span>a<span>,</span> b<span>)</span><span>;</span>  <span>//1 null</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>以上代码逻辑是：</p>
<div><pre><code><span>if</span> <span>(</span><span>[</span>undifined<span>,</span> <span>null</span><span>]</span><span>[</span><span>0</span><span>]</span> <span>===</span> <span>undefined</span><span>)</span> <span>{</span>
    a <span>=</span> <span>1</span><span>;</span>
<span>}</span> <span>else</span> <span>{</span>
    a <span>=</span> <span>[</span>undifined<span>,</span> <span>null</span><span>]</span><span>[</span><span>0</span><span>]</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>对象解构赋值默认值，当对象属性值严格等于<code>undefined</code>时。</p>
<div><pre><code><span>let</span> <span>{</span>a<span>,</span> b<span>=</span><span>2</span><span>}</span> <span>=</span> <span>{</span><span>1</span><span>,</span> <span>undefined</span><span>}</span>
a<span>,</span>b <span>//1,2</span>

<span>let</span> <span>{</span><span>a</span><span>:</span> b<span>=</span><span>1</span><span>}</span> <span>=</span> <span>{</span><span>a</span><span>:</span> <span>undefined</span><span>}</span>
b <span>//1</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>事实上，只要某种数据结构具有 <code>Iterator</code> 接口，都可以采用数组形式的解构赋值。</p>
<p>函数参数的解构赋值，传入的参数不是数组或对象，而是变量。</p>
<div><pre><code><span>let</span> <span>fn</span> <span>=</span> <span>(</span> <span><span>[</span>a<span>,</span> b<span>]</span></span> <span>)</span> <span>=></span> <span>{</span>
    <span>return</span> a <span>+</span> b<span>;</span>
<span>}</span><span>;</span>
<span>fn</span> <span>(</span><span>[</span><span>1</span><span>,</span> <span>2</span><span>]</span><span>)</span><span>;</span> <span>//3</span>
<span>[</span><span>[</span><span>1</span><span>,</span><span>2</span><span>]</span><span>,</span><span>[</span><span>3</span><span>,</span><span>4</span><span>]</span><span>]</span><span>.</span><span>map</span><span>(</span><span>[</span>a<span>,</span>b<span>]</span><span>=></span> a<span>+</span>b<span>)</span><span>;</span>
<span>//[3,7]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>函数参数也可使用默认值</p>
<div><pre><code><span>let</span> <span>fn</span><span>(</span><span><span>{</span>a<span>=</span><span>1</span><span>,</span> b<span>=</span><span>2</span><span>}</span> <span>=</span> <span>{</span><span>}</span></span><span>)</span> <span>{</span> <span>return</span> <span>[</span>a<span>,</span>b<span>]</span><span>}</span>
<span>fn</span><span>(</span><span>{</span><span>a</span><span>:</span><span>10</span><span>}</span><span>)</span>  <span>// [10,2]</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>等号右边如果不是对象，会先转成对象，转换失败则报错。</p>
<div><pre><code><span>let</span> <span>{</span><span>toString</span><span>:</span> s<span>}</span> <span>=</span> <span>123</span><span>;</span>
s <span>===</span> <span>Number</span><span>.</span>prototype<span>.</span>toString

<span>let</span> <span>{</span><span>toString</span><span>:</span> s<span>}</span> <span>=</span> <span>true</span><span>;</span>
s <span>===</span> <span>Blooean</span><span>.</span>prototype<span>.</span>toString
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p><code>undefined</code> <code>null</code>不能转成对象，结构赋值报错。</p>
<div><pre><code><span>let</span> <span>{</span>a<span>}</span> <span>=</span> <span>undefined</span><span>;</span>   <span>//TypeError</span>
<span>let</span> <span>{</span>b<span>}</span> <span>=</span> <span>null</span><span>;</span>        <span>//TypeError</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>解构赋值应用:</p>
<div><pre><code><span>//交换变量的值</span>
<span>let</span> a <span>=</span> <span>1</span><span>,</span> b <span>=</span> <span>2</span><span>;</span>
<span>[</span>a<span>,</span>b<span>]</span> <span>=</span> <span>[</span>b<span>,</span> a<span>]</span><span>;</span>

<span>//函数返回多个值</span>
<span>let</span> <span>fn</span> <span>=</span> <span>(</span><span>)</span> <span>=></span> <span>{</span><span>x</span><span>:</span> <span>1</span><span>,</span> <span>y</span><span>:</span> <span>2</span><span>}</span>

<span>//提取json数据</span>
<span>let</span> <span>{</span>a<span>,</span> b<span>}</span> <span>=</span> obj<span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="字符串扩展" tabindex="-1"> 字符串扩展</h2>
<p><code>ES6</code>提供<code>for...of</code>方法遍历字符串。</p>
<p>新增的其他方法：<code>startsWidth()</code> <code>endsWidth()</code> <code>includes()</code>。</p>
<div><pre><code><span>let</span> s <span>=</span> <span>'hello word!'</span><span>;</span>
s<span>.</span><span>startsWith</span><span>(</span><span>'hello'</span><span>)</span><span>;</span>     <span>//true</span>
s<span>.</span><span>endsWidth</span><span>(</span><span>'word'</span><span>)</span><span>;</span>       <span>//true</span>
s<span>.</span><span>includes</span><span>(</span><span>'o'</span><span>)</span><span>;</span>           <span>//true </span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p><code>charAt()</code> 用于返回给定位置的字符，对于编码大于0xFFFF的字符用<code>at()</code>方法。</p>
<div><pre><code><span>'ab'</span><span>.</span><span>charAt</span><span>(</span><span>0</span><span>)</span>  <span>//'a'</span>
<span>'𠮷a'</span><span>.</span><span>charAt</span><span>(</span><span>0</span><span>)</span> <span>//'\uD842'</span>
<span>'𠮷a'</span><span>.</span><span>at</span><span>(</span><span>0</span><span>)</span>     <span>//'𠮷'</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><h3 id="模版字符串" tabindex="-1"> 模版字符串</h3>
<p>用于字符串拼接，<code>{}</code>中可以进行运算、引用对象、调用函数，非字符串类型会被转成字符串。可以嵌套使用，<code>{}</code>中可以再使用模版字符串。如果字符串中有反引号要用反斜杠转义。</p>
<div><pre><code><span>let</span> name <span>=</span> <span>'zq'</span><span>;</span>
<span><span>`</span><span>your name is </span><span><span>${</span>name<span>}</span></span><span>`</span></span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>模版字符串中空格和和缩紧都会被保留，可以用<code>trim()</code>方法消除。</p>
<div><pre><code><span><span>`</span><span>&lt;ul>
    &lt;li>&lt;li>
&lt;/ul></span><span>`</span></span><span>.</span><span>trim</span><span>(</span><span>)</span><span>;</span>  
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><h2 id="正则表达式" tabindex="-1"> 正则表达式</h2>
<p><code>RegExp</code>构造函数参数有两种情况。</p>
<div><pre><code><span>//参数一：字符串，参数二：修饰符</span>
<span>let</span> reg <span>=</span> <span>new</span> <span>RegExp</span><span>(</span><span>'abc'</span><span>,</span><span>'i'</span><span>)</span><span>;</span>

<span>//参数一：正则表达式</span>
<span>let</span> reg <span>=</span> <span>new</span> <span>RegExp</span><span>(</span><span><span>/</span><span>abc</span><span>/</span></span><span>)</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>以上代码中，第二种只能传一个参数，返回原有正则的拷贝，不允许传第二个参数添加修饰符。</p>
<div><pre><code><span>let</span> reg <span>=</span> <span>RegExp</span><span>(</span><span><span>/</span><span>abc</span><span>/</span></span><span>,</span> <span>'i'</span><span>)</span><span>;</span>  <span>//报错</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p><code>ES6</code>允许给<code>RegExp</code>构造函数传入第二个参数添加修饰符，即使第一个参数是正则，但会覆盖原有正则表达式的修饰符。</p>
<div><pre><code><span>let</span> reg <span>=</span> <span>new</span> <span>RegExp</span><span>(</span><span><span>/</span><span>abc</span><span>/</span><span>g</span></span><span>,</span> i<span>)</span><span>.</span>flags  <span>//'i'</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>新增<code>flags</code>属性，返回正则表达式的修饰符。</p>
<div><pre><code><span>//ES5的source属性</span>
<span>/</span>abc<span>/</span>i<span>.</span>source  <span>//'abc'</span>

<span>//ES6的flags属性</span>
<span>/</span>abc<span>/</span>i<span>.</span>flags   <span>//'i'</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="数值相关" tabindex="-1"> 数值相关</h2>
<h3 id="number对象扩展" tabindex="-1"> Number对象扩展</h3>
<p><code>ES6</code>在<code>Number</code>对象上提供了新的方法。</p>
<p><code>Number.isFinite()</code>判断是否为有限数值。</p>
<div><pre><code>Number<span>.</span><span>isFinite</span><span>(</span><span>'1'</span><span>)</span>   <span>//false</span>
Number<span>.</span><span>isFinite</span><span>(</span><span>NaN</span><span>)</span>   <span>//false</span>
Number<span>.</span><span>isFinite</span><span>(</span><span>1.01</span><span>)</span>  <span>//true</span>
Number<span>.</span><span>isFinite</span><span>(</span><span>Infinity</span><span>)</span>  <span>//false</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p><code>Number.isNaN()</code>检测一个值是否为<code>NaN</code>，只有<code>NaN</code>才会返回<code>true</code>，其他值一律返回<code>false</code>。</p>
<blockquote>
<p>全局方法<code>isFinite()</code>和<code>isNaN()</code>会将传入的值转成数字类型再判断，<code>Number.isFinite()</code>和<code>Number.isNaN()</code>方法参数必须是数值类型，否则直接返回<code>false</code>。</p>
</blockquote>
<div><pre><code><span>isNaN</span><span>(</span><span>'NaN'</span><span>)</span>          <span>//true</span>
Number<span>.</span><span>isNaN</span><span>(</span><span>'NaN'</span><span>)</span>   <span>//false</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p><code>ES6</code>将全局方法<code>parseInt()</code>和<code>parseFloat()</code>放到<code>Number</code>对象上，行为不变。</p>
<p><code>Number.isInteger()</code>用来判断一个数是否为整数。</p>
<blockquote>
<p>小数和整数采用相同的存储方式，小数点后全为零也为整数。</p>
</blockquote>
<div><pre><code>Number<span>.</span><span>isInteger</span><span>(</span><span>2</span><span>)</span>    <span>//true</span>
Number<span>.</span><span>isInteger</span><span>(</span><span>2.0</span><span>)</span>  <span>//true</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h3 id="math对象扩展" tabindex="-1"> Math对象扩展</h3>
<p><code>Math.trunc()</code>方法返回数值的整数部分。</p>
<div><pre><code>Math<span>.</span><span>trunc</span><span>(</span><span>1.1</span><span>)</span>     <span>//1</span>
Math<span>.</span><span>trunc</span><span>(</span><span>-</span><span>1.1</span><span>)</span>    <span>//-1</span>
Math<span>.</span><span>trunc</span><span>(</span><span>'1.1'</span><span>)</span>   <span>//1</span>
Math<span>.</span><span>trunc</span><span>(</span><span>'a'</span><span>)</span>     <span>//NaN</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p>可以使用<code>Math.floor()</code>和<code>Math.ceil()</code>方法模拟<code>Math.trunc()</code>。</p>
<div><pre><code>Math<span>.</span>trunc <span>=</span> Math<span>.</span>trunc <span>||</span> <span>function</span><span>(</span><span>x</span><span>)</span> <span>{</span>
  <span>return</span> x <span>&lt;</span> <span>0</span> <span>?</span> Math<span>.</span><span>ceil</span><span>(</span>x<span>)</span> <span>:</span> Math<span>.</span><span>floor</span><span>(</span>x<span>)</span><span>;</span>
<span>}</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p><code>ES6</code>新增了<strong>三角函数</strong>：</p>
<ul>
<li><code>Math.sinh(x)</code> 返回x的双曲正弦</li>
<li><code>Math.cosh(x)</code> 返回x的双曲余弦</li>
<li><code>Math.tanh(x)</code> 返回x的双曲正切</li>
<li><code>Math.asinh(x)</code> 返回x的反双曲正弦</li>
<li><code>Math.acosh(x)</code> 返回x的反双曲余弦</li>
<li><code>Math.atanh(x)</code> 返回x的反双曲正切</li>
</ul>
<h3 id="指数运算符" tabindex="-1"> 指数运算符</h3>
<p><code>ES6</code>新增了指数运算符<code>**</code>。</p>
<div><pre><code><span>let</span> a <span>=</span> <span>2</span><span>;</span>
a <span>=</span> a<span>**</span><span>3</span><span>;</span>    <span>//8</span>
<span>//可以简写成 a **= 3</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><h2 id="函数的扩展" tabindex="-1"> 函数的扩展</h2>
<h3 id="基本用法" tabindex="-1"> 基本用法</h3>
<p><code>ES6</code> 允许为函数的参数设置<strong>默认值</strong>，即直接写在参数定义的后面。使用默认值时，不能有同名参数。</p>
<div><pre><code><span>function</span> <span>(</span><span>x <span>=</span> <span>1</span></span><span>)</span> <span>{</span><span>}</span>
<span>function</span> <span>(</span><span>x<span>,</span> x<span>=</span><span>1</span></span><span>)</span> <span>{</span><span>}</span>   <span>//报错</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>默认参数不是传值，而是每次都重新计算。</p>
<div><pre><code><span>let</span> y <span>=</span> <span>10</span><span>;</span>
<span>function</span> <span>fn</span> <span>(</span><span>x <span>=</span> y<span>+</span><span>1</span></span><span>)</span> <span>{</span>
    console<span>.</span><span>log</span><span>(</span>x<span>)</span><span>;</span>
<span>}</span>
<span>fn</span><span>(</span><span>)</span><span>;</span>  <span>//11;</span>
y<span>++</span><span>;</span>
<span>fn</span><span>(</span><span>)</span><span>;</span>  <span>//12;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>函数参数是默认声明的，不能用<code>let</code>或<code>const</code>再次声明，可以用<code>var</code>再次声明。</p>
<div><pre><code><span>function</span> <span>(</span><span>x</span><span>)</span> <span>{</span>
    <span>let</span> x <span>=</span> <span>1</span><span>;</span>    <span>//报错</span>
    <span>var</span> x <span>=</span> <span>1</span><span>;</span>    <span>//正常</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p>函数默认值与解构赋值默认值结合使用。</p>
<div><pre><code><span>//只使用解构赋值默认值</span>
<span>function</span> <span>fn</span> <span>(</span><span><span>{</span>a<span>,</span> b <span>=</span> <span>2</span><span>}</span></span><span>)</span> <span>{</span>
    console<span>.</span><span>log</span> <span>(</span>a<span>,</span> b<span>)</span><span>;</span>
<span>}</span>
<span>fn</span> <span>(</span><span>{</span><span>a</span><span>:</span><span>1</span><span>}</span><span>)</span><span>;</span>   <span>//1, 2</span>
<span>fn</span> <span>(</span><span>{</span><span>a</span><span>:</span><span>1</span><span>,</span> <span>b</span><span>:</span><span>3</span><span>}</span><span>)</span><span>;</span>   <span>//1, 3</span>
<span>fn</span> <span>(</span><span>)</span><span>;</span>   <span>//报错</span>

<span>//使用解构赋值默认值和函数参数默认值</span>
<span>function</span> <span>fn</span> <span>(</span><span><span>{</span>a<span>,</span> b <span>=</span> <span>2</span><span>}</span> <span>=</span> <span>{</span><span>}</span></span><span>)</span> <span>{</span>
    console<span>.</span><span>log</span> <span>(</span>a<span>,</span> b<span>)</span><span>;</span>
<span>}</span>
<span>fn</span><span>(</span><span>)</span>   <span>//undefined, 2</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>函数默认值参数不是最后一个参数，则不能省略，可以用<code>undefined</code>代替，不能用<code>null</code>代替。</p>
<div><pre><code><span>function</span> <span>fn</span> <span>(</span><span>x<span>,</span> y<span>=</span><span>1</span><span>,</span> z</span><span>)</span> <span>{</span>
    console<span>.</span><span>log</span><span>(</span>x<span>,</span> y<span>,</span> z<span>)</span><span>;</span>
<span>}</span><span>;</span>
<span>fn</span><span>(</span><span>1</span><span>,</span><span>2</span><span>)</span>   <span>//1,2,undefined</span>
<span>fn</span><span>(</span><span>1</span><span>,</span><span>undefined</span><span>,</span><span>2</span><span>)</span><span>;</span>  <span>//1,1,2</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>将函数参数默认值设成<code>undefined</code>表示此参数可以省略。</p>
<div><pre><code><span>function</span> <span>fn</span> <span>(</span><span>x<span>=</span><span>undefined</span><span>,</span> y</span><span>)</span> <span>{</span><span>}</span>
<span>fn</span><span>(</span><span>,</span><span>2</span><span>)</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h3 id="length属性" tabindex="-1"> length属性</h3>
<p>指定了默认值以后，函数的<code>length</code>属性，将返回没有指定默认值的参数个数。如果设置了默认值的参数不是尾参数，那么<code>length</code>属性也不再计入后面的参数。</p>
<div><pre><code><span>function</span> <span>fn</span> <span>(</span><span>x<span>,</span> y<span>=</span><span>1</span><span>,</span> z</span><span>)</span> <span>{</span><span>}</span><span>;</span>
<span>fn</span><span>(</span><span>1</span><span>,</span><span>2</span><span>,</span><span>3</span><span>)</span><span>.</span>length<span>;</span>    <span>//1</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h3 id="函数参数作用域" tabindex="-1"> 函数参数作用域</h3>
<p>一旦设置了参数的默认值，函数进行声明初始化时，参数会形成一个单独的作用域（context）与函数内部不是同一个作用域。等到初始化结束，这个作用域就会消失。这种语法行为，在不设置参数默认值时，是不会出现的。</p>
<div><pre><code><span>var</span> x <span>=</span> <span>1</span><span>;</span>
<span>function</span> <span>f</span><span>(</span><span>x<span>,</span> y <span>=</span> x</span><span>)</span> <span>{</span>
  console<span>.</span><span>log</span><span>(</span>y<span>)</span><span>;</span>
<span>}</span>
<span>f</span><span>(</span><span>2</span><span>)</span> <span>// 2</span>

<span>//参数作用域如下：</span>
<span>{</span>
    <span>let</span> x <span>=</span> <span>2</span><span>;</span>
    <span>let</span> y <span>=</span> x<span>;</span>    
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="rest参数" tabindex="-1"> rest参数</h3>
<p><code>ES6</code> 引入 <code>rest</code> 参数（形式为<code>...变量名</code>），用于获取函数的多余参数，<code>rest</code> 参数搭配的变量是一个数组，该变量将多余的参数放入数组中。<code>...变量</code>后不能再有参数，否则报错。</p>
<p>函数的<code>length</code>属性不包括<code>rest</code>参数。</p>
<div><pre><code><span>function</span> <span>fn</span><span>(</span><span>x<span>,</span> <span>...</span>rest</span><span>)</span> <span>{</span>
    console<span>.</span><span>log</span><span>(</span>Array<span>.</span><span>isArray</span><span>(</span>rest<span>)</span><span>)</span><span>;</span>
    console<span>.</span><span>log</span><span>(</span>rest<span>)</span><span>;</span>
<span>}</span><span>;</span>
<span>fn</span><span>(</span><span>1</span><span>,</span><span>2</span><span>,</span><span>3</span><span>)</span><span>.</span>length<span>;</span>  <span>//1</span>
<span>//true</span>
<span>//[2,3]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>从 <code>ES5</code> 开始，函数内部可以设定为严格模式。<code>ES7</code>规定只要函数参数使用了默认值、解构赋值、或者扩展运算符，那么函数内部就不能显式设定为严格模式，否则会报错。</p>
<h3 id="name属性" tabindex="-1"> name属性</h3>
<p>函数的<code>name</code>属性，返回该函数的函数名。如果将一个匿名函数赋值给一个变量，<code>ES5</code> 的<code>name</code>属性，会返回空字符串，而 <code>ES6</code> 的<code>name</code>属性会返回实际的函数名。</p>
<div><pre><code><span>let</span> <span>fn</span> <span>=</span> <span>(</span><span>)</span> <span>=></span> <span>{</span><span>}</span>

<span>//es5</span>
fn<span>.</span>name  <span>//''</span>

<span>//es6</span>
fn<span>.</span>name  <span>//'fn'</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>如果将一个具名函数赋值给一个变量，则 <code>ES5</code> 和 <code>ES6</code> 的<code>name</code>属性都返回这个具名函数原本的名字。</p>
<div><pre><code><span>let</span> <span>fn</span> <span>=</span> <span>function</span> <span>a</span><span>(</span><span>)</span> <span>{</span><span>}</span><span>;</span>
<span>//es5 es6</span>
fn<span>.</span>name    <span>//'a'</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><h3 id="箭头函数" tabindex="-1"> 箭头函数</h3>
<ul>
<li>函数体内的<code>this</code>对象，就是定义时所在的对象，而不是使用时所在的对象。</li>
<li>不可以当作构造函数，也就是说，不可以使用<code>new</code>命令，否则会抛出一个错误。</li>
<li>不可以使用<code>arguments</code>对象，该对象在函数体内不存在。如果要用，可以用 <code>rest</code> 参数代替。</li>
<li>不可以使用<code>yield</code>命令，因此箭头函数不能用作 <code>Generator</code> 函数。</li>
</ul>
<p>箭头函数根本没有自己的<code>this</code>，导致内部的<code>this</code>就是外层代码块的<code>this</code>。</p>
<p>除了<code>this</code>，以下三个变量在箭头函数之中也是不存在的，指向外层函数的对应变量：<code>arguments</code>、<code>super</code>、<code>new.target</code>。</p>
<p>不能用<code>call()</code>、<code>apply()</code>、<code>bind()</code>这些方法去改变this的指向。</p>
<h2 id="数组的扩展" tabindex="-1"> 数组的扩展</h2>
<h3 id="扩展运算符" tabindex="-1"> 扩展运算符</h3>
<p>扩展运算符用三个点号表示，功能是把数组或类数组对象展开成一系列用逗号隔开的值（数组）,和...rest相反。</p>
<p>扩展运算符后面还可以放置表达式。</p>
<div><pre><code><span>let</span> x <span>=</span> <span>1</span><span>;</span>
<span>...</span><span>(</span>x <span>></span> <span>0</span> <span>?</span> <span>[</span><span>'a'</span><span>,</span><span>'b'</span><span>]</span> <span>:</span> <span>[</span><span>]</span><span>)</span>   <span>//'a','b'</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>如果扩展运算符后面是一个空数组，则不产生任何效果。</p>
<div><pre><code><span>[</span><span>...</span><span>[</span><span>]</span><span>,</span> <span>1</span><span>]</span>  <span>//[1]</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>扩展运算符可以展开数组，所以不再需要apply方法，将数组转为函数的参数。</p>
<div><pre><code>Math<span>.</span><span>max</span><span>.</span><span>apply</span><span>(</span><span>null</span><span>,</span> <span>[</span><span>14</span><span>,</span> <span>3</span><span>,</span> <span>77</span><span>]</span><span>)</span>

<span>// ES6 的写法</span>
Math<span>.</span><span>max</span><span>(</span><span>...</span><span>[</span><span>14</span><span>,</span> <span>3</span><span>,</span> <span>77</span><span>]</span><span>)</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p>扩展运算符可用于复制数组，合并数组。</p>
<div><pre><code><span>let</span> arr1 <span>=</span> <span>[</span><span>1</span><span>,</span><span>2</span><span>]</span><span>;</span>

<span>//ES5</span>
<span>let</span> arr2 <span>=</span> arr1<span>.</span><span>concat</span><span>(</span><span>)</span><span>;</span>

<span>//ES6</span>
<span>let</span> arr2 <span>=</span> <span>[</span><span>...</span>arr1<span>]</span><span>;</span>

<span>//ES6</span>
<span>let</span> <span>[</span><span>...</span>arr2<span>]</span> <span>=</span> arr1<span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>扩展运算符还可以将字符串转为真正的数组。</p>
<div><pre><code><span>[</span><span>...</span><span>'hello'</span><span>]</span>
<span>// [ "h", "e", "l", "l", "o" ]</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>任何 <code>Iterator</code> 接口的对象, 都可以用扩展运算符转为真正的数组。</p>
<p>通过 <code>push</code> 函数，将一个数组添加到另一个数组的尾部。</p>
<div><pre><code><span>let</span> arr1 <span>=</span> <span>[</span><span>1</span><span>,</span><span>2</span><span>,</span><span>3</span><span>]</span><span>;</span>
<span>let</span> arr2 <span>=</span> <span>[</span><span>4</span><span>,</span><span>5</span><span>]</span><span>;</span>
arr1<span>.</span><span>push</span><span>(</span><span>...</span>arr2<span>)</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>扩展运算符其他应用: <strong>复制数组</strong>，<strong>合并数组</strong>，<strong>展开字符串</strong>(有Iterato接口的对象)，****</p>
<div><pre><code><span>let</span> arr <span>=</span> <span>[</span><span>1</span><span>,</span><span>2</span><span>]</span><span>;</span>

<span>let</span> arr1 <span>=</span> <span>[</span><span>...</span>arr<span>]</span><span>;</span>  <span>//复制数组</span>
<span>let</span> arr2 <span>=</span> <span>[</span><span>...</span>arr<span>,</span> <span>...</span><span>[</span><span>3</span><span>,</span><span>4</span><span>]</span><span>]</span><span>;</span>   <span>//合并数组</span>
<span>let</span> arr3 <span>=</span> <span>[</span><span>...</span><span>'hello'</span><span>]</span><span>;</span>   <span>//展开字符串</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="array-from" tabindex="-1"> Array.from()</h3>
<p><code>Array.from</code>方法用于将两类对象转为真正的数组：类似数组的对象和可遍历（<code>iterable</code>）的对象（包括 <code>ES6</code> 新增的数据结构 <code>Set</code> 和 <code>Map</code>）。<a href="https://link.segmentfault.com/?enc=7TBM4qWk0KvtKHeEfNIU3w%3D%3D.%2BOpU5EeurIhyb8WliOadB0lXgsBJVbhY711Ce9SUdBJZQDSXXbEAM5bKZrs1jim5HdBHQ%2B9nEkasCiMSTYwRW42mOBSmnEngEhWrN%2FLmuge01wDlT86RrImxi%2F6teelWP9zk%2BTVV%2BIeXaqfI2oaxgz9Dx2zjUHDwv86hznUhYVj79HYNdyDCyJTOp1zBPYf5" target="_blank" rel="noopener noreferrer">将类数组转成数组</a></p>
<div><pre><code><span>let</span> arrayLike <span>=</span> <span>{</span>
    <span>'0'</span><span>:</span> <span>'a'</span><span>,</span>
    <span>'1'</span><span>:</span> <span>'b'</span><span>,</span>
    <span>'2'</span><span>:</span> <span>'c'</span><span>,</span>
    <span>length</span><span>:</span> <span>3</span>
<span>}</span><span>;</span>

<span>// ES5的写法</span>
<span>var</span> arr1 <span>=</span> <span>[</span><span>]</span><span>.</span><span>slice</span><span>.</span><span>call</span><span>(</span>arrayLike<span>)</span><span>;</span> <span>// ['a', 'b', 'c']</span>

<span>// ES6的写法</span>
<span>let</span> arr2 <span>=</span> Array<span>.</span><span>from</span><span>(</span>arrayLike<span>)</span><span>;</span> <span>// ['a', 'b', 'c']</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>只要有<code>length</code>属性的对象就叫做类似数组的对象，就可以被转化。</p>
<div><pre><code><span>let</span> obj <span>=</span> <span>{</span><span>length</span><span>:</span> <span>2</span><span>}</span>
Array<span>.</span><span>form</span><span>(</span>obj<span>)</span>    <span>/</span><span>/</span><span>[</span><span>undefined</span><span>,</span> <span>undefined</span><span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>对于还没有部署该方法的浏览器，可以用 <code>Array.prototype.slice</code> 方法替代。</p>
<div><pre><code><span>const</span> toArray <span>=</span> <span>(</span><span>(</span><span>)</span> <span>=></span>
  Array<span>.</span>from <span>?</span> Array<span>.</span><span>from</span> <span>:</span> <span>obj</span> <span>=></span> <span>[</span><span>]</span><span>.</span><span>slice</span><span>.</span><span>call</span><span>(</span>obj<span>)</span>
<span>)</span><span>(</span><span>)</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>实际应用中，常见的类似数组的对象是 DOM 操作返回的 <code>NodeList</code> 集合，以及函数内部的 <code>arguments</code> 对象。<code>Array.form()</code> 都可以转换。</p>
<p><code>Array.from</code> 还可以接受第二个参数，作用类似于数组的 <code>map</code> 方法，用来对每个元素进行处理，将处理后的值放入返回的数组。如果 <code>map</code> 函数里面用到了 <code>this</code> 关键字，还可以传入 <code>Array.from</code> 的第三个参数，用来绑定 <code>this</code>。</p>
<div><pre><code>Array<span>.</span><span>from</span><span>(</span><span>[</span><span>1</span><span>,</span> <span>2</span><span>,</span> <span>3</span><span>]</span><span>,</span> <span>(</span><span>x</span><span>)</span> <span>=></span> x <span>*</span> x<span>)</span><span>;</span>
<span>//等同于</span>
Array<span>.</span><span>from</span><span>(</span><span>[</span><span>1</span><span>,</span><span>2</span><span>,</span><span>3</span><span>]</span><span>)</span><span>.</span><span>map</span><span>(</span><span>x</span> <span>=></span> x <span>*</span> x<span>)</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>如果参数是一个真正的数组，<code>Array.from</code> 会返回一个一模一样的新数组。</p>
<div><pre><code>Array<span>.</span><span>from</span><span>(</span><span>[</span><span>1</span><span>,</span><span>2</span><span>,</span><span>3</span><span>]</span><span>)</span>   <span>//[1,2,3]</span>
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="array-of" tabindex="-1"> Array.of()</h3>
<p><code>Array.of</code>方法用于将一组值，转换为数组。</p>
<div><pre><code>Array<span>.</span><span>of</span><span>(</span><span>3</span><span>,</span><span>4</span><span>)</span> <span>// [3,4]</span>
Array<span>.</span><span>of</span><span>(</span><span>2</span><span>)</span>   <span>// [2]</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>和<code>Array()</code>方法不同，传入一个值时，表示数组的长度。</p>
<div><pre><code><span>Array</span><span>(</span><span>2</span><span>)</span>  <span>//[undefinde, undefined]</span>
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="find-和findindex" tabindex="-1"> find()和findIndex()</h3>
<p><code>find</code> 方法找出第一个符合条件的数组成员。它的参数是一个回调函数，所有数组成员依次执行该回调函数，直到找出第一个返回值为 <code>true</code> 的成员，然后返回该成员。如果没有符合条件的成员，则返回 <code>undefined</code>。</p>
<div><pre><code><span>[</span><span>1</span><span>,</span><span>2</span><span>,</span><span>3</span><span>]</span><span>.</span><span>find</span><span>(</span><span>v</span> <span>=></span> v<span>></span><span>2</span><span>)</span><span>;</span>   <span>//3</span>

<span>[</span><span>1</span><span>,</span><span>2</span><span>,</span><span>3</span><span>]</span><span>.</span><span>find</span><span>(</span><span>(</span><span>v<span>,</span> i<span>,</span> arr</span><span>)</span> <span>=></span> <span>{</span>
    <span>return</span> v<span>></span><span>2</span>
<span>}</span><span>)</span><span>;</span>   
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>数组实例的 <code>findIndex</code> 方法的用法与 <code>find</code> 方法非常类似，返回第一个符合条件的数组成员的位置，如果所有成员都不符合条件，则返回-1。</p>
<p>这两个方法都可以接受第二个参数，用来绑定回调函数的 <code>this</code> 对象。</p>
<h3 id="fill-方法" tabindex="-1"> fill() 方法</h3>
<p><code>fill</code> 方法使用给定值，填充一个数组。还可以接受第二个和第三个参数，用于指定填充的起始位置和结束位置。</p>
<div><pre><code><span>[</span><span>1</span><span>,</span><span>2</span><span>,</span><span>3</span><span>]</span><span>.</span><span>fill</span><span>(</span><span>'a'</span><span>)</span><span>;</span>  <span>//['a', 'a', 'a']</span>
<span>[</span><span>1</span><span>,</span><span>2</span><span>,</span><span>3</span><span>,</span><span>4</span><span>,</span><span>5</span><span>]</span><span>.</span><span>fill</span><span>(</span><span>'a'</span><span>,</span> <span>2</span><span>,</span> <span>4</span><span>)</span><span>;</span>   <span>//[1, 2, 'a', 'a', 5]</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><blockquote>
<p>如果填充的类型为对象，那么被赋值的是同一个内存地址的对象，而不是深拷贝对象。</p>
</blockquote>
<div><pre><code><span>let</span> arr <span>=</span> <span>new</span> <span>Array</span><span>(</span><span>2</span><span>)</span><span>.</span><span>fill</span><span>(</span><span>{</span><span>name</span><span>:</span> <span>'Jim'</span><span>}</span><span>)</span><span>;</span>
arr<span>[</span><span>0</span><span>]</span><span>.</span>name <span>=</span> <span>'Tim'</span><span>;</span>

<span>// [{name: 'Tim'}, {name: 'Tim'}]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><h3 id="keys-values-entries-方法" tabindex="-1"> keys(), values(), entries() 方法</h3>
<p><code>keys()</code> 是对键名的遍历，<code>values()</code> 是对键值的遍历，<code>entries()</code> 是对键值对的遍历。<code>keys(), values(), entries()</code> 返回一个遍历器对象。可以用 <code>for...of</code> 循环进行遍历。</p>
<h3 id="includes-方法" tabindex="-1"> includes() 方法</h3>
<p><code>includes()</code> 判断数组是否包含给定的值，返回布尔值，<code>NaN</code> 也能实现。它还有第二个参数，表示查找的起始位置，为负数则表示从后往前。
而 <code>indexOf()</code> 方法对 <code>NaN</code> 无效，会返回-1；</p>
<blockquote>
<p>includes 为 ES2016 引入的方法。</p>
</blockquote>
<p>相比于 indexOf，返回的是元素第一次出现的位置，再比较是否等于 -1，内部使用 === 判断，对 NaN 不适用。</p>
<h3 id="数组的空位" tabindex="-1"> 数组的空位</h3>
<p>数组的空位指，数组的某一个位置没有任何值。</p>
<div><pre><code><span>Array</span><span>(</span><span>3</span><span>)</span><span>;</span>  <span>//[,,]</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>ES5 对空位的处理不一致。大多数情况下会被忽略。</p>
<ul>
<li>forEach(), filter(), reduce(), every(), some() 会跳过空位。</li>
<li>map() 会跳过空位，但会保留这个值。</li>
<li>join() 和 toString() 会将空位视为 undefined ，而 undefine 和 null 会被处理成空字符串。</li>
</ul>
<div><pre><code><span>// forEach方法</span>
<span>[</span><span>,</span><span>'a'</span><span>]</span><span>.</span><span>forEach</span><span>(</span><span>(</span><span>x<span>,</span>i</span><span>)</span> <span>=></span> console<span>.</span><span>log</span><span>(</span>i<span>)</span><span>)</span><span>;</span> <span>// 1</span>

<span>// filter方法</span>
<span>[</span><span>'a'</span><span>,</span><span>,</span><span>'b'</span><span>]</span><span>.</span><span>filter</span><span>(</span><span>x</span> <span>=></span> <span>true</span><span>)</span> <span>// ['a','b']</span>

<span>// every方法</span>
<span>[</span><span>,</span><span>'a'</span><span>]</span><span>.</span><span>every</span><span>(</span><span>x</span> <span>=></span> x<span>===</span><span>'a'</span><span>)</span> <span>// true</span>

<span>// reduce方法</span>
<span>[</span><span>1</span><span>,</span><span>,</span><span>2</span><span>]</span><span>.</span><span>reduce</span><span>(</span><span>(</span><span>x<span>,</span>y</span><span>)</span> <span>=></span> <span>return</span> x<span>+</span>y<span>)</span> <span>// 3</span>

<span>// some方法</span>
<span>[</span><span>,</span><span>'a'</span><span>]</span><span>.</span><span>some</span><span>(</span><span>x</span> <span>=></span> x <span>!==</span> <span>'a'</span><span>)</span> <span>// false</span>

<span>// map方法</span>
<span>[</span><span>,</span><span>'a'</span><span>]</span><span>.</span><span>map</span><span>(</span><span>x</span> <span>=></span> <span>1</span><span>)</span> <span>// [,1]</span>

<span>// join方法</span>
<span>[</span><span>,</span><span>'a'</span><span>,</span><span>undefined</span><span>,</span><span>null</span><span>]</span><span>.</span><span>join</span><span>(</span><span>'#'</span><span>)</span> <span>// "#a##"</span>

<span>// toString方法</span>
<span>[</span><span>,</span><span>'a'</span><span>,</span><span>undefined</span><span>,</span><span>null</span><span>]</span><span>.</span><span>toString</span><span>(</span><span>)</span> <span>// ",a,,"</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>ES6 会将空位转为 undefined。</p>
<p>Array.from 方法、扩展运算符（...）、entries()、keys()、values()、find() 和 findIndex() 会将数组的空位，转为 undefined ；for···of 会遍历空位。</p>
<h2 id="对象的扩展" tabindex="-1"> 对象的扩展</h2>
<h3 id="属性简写" tabindex="-1"> 属性简写</h3>
<p>直接写入变量和函数，作为对象的属性和方法。</p>
<div><pre><code><span>let</span> a <span>=</span> <span>1</span><span>;</span>
<span>let</span> obj <span>=</span> <span>{</span>
  a<span>,</span>
  <span>method</span><span>(</span><span>)</span> <span>{</span>
    <span>return</span> <span>this</span><span>.</span>a
  <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>这种写法用于函数的返回值。</p>
<div><pre><code><span>function</span> <span>getPoint</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> x <span>=</span> <span>1</span><span>;</span>
  <span>const</span> y <span>=</span> <span>10</span><span>;</span>
  <span>return</span> <span>{</span>x<span>,</span> y<span>}</span><span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="属性名表达式" tabindex="-1"> 属性名表达式</h3>
<p>定义对象有两种方法。</p>
<div><pre><code>obj<span>.</span>a <span>=</span> <span>1</span><span>;</span>
obj<span>[</span><span>'c'</span> <span>+</span> <span>'d'</span><span>]</span> <span>=</span> <span>2</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>如果使用字面量方式定义对象（使用大括号），在 ES5 中只能使用方法一。ES6 允许字面量定义对象时，用方法二（表达式）作为对象的属性名，即把表达式放在方括号内。</p>
<div><pre><code><span>let</span> lastWord <span>=</span> <span>'last word'</span><span>;</span>

<span>const</span> a <span>=</span> <span>{</span>
  <span>'first word'</span><span>:</span> <span>'hello'</span><span>,</span>
   <span>[</span>lastWord<span>]</span> <span>:</span> <span>'world'</span>
<span>}</span><span>;</span>

a<span>[</span><span>'first word'</span><span>]</span> <span>// "hello"</span>
a<span>[</span>lastWord<span>]</span> <span>// "world"</span>
a<span>[</span><span>'last word'</span><span>]</span> <span>// "world"</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>属性名表达式如果是一个对象，默认情况下会自动将对象转为字符串[object Object]。</p>
<div><pre><code><span>let</span> obj1 <span>=</span> <span>{</span>
  <span>a</span><span>:</span> <span>1</span>
<span>}</span><span>;</span>
<span>let</span> obj2 <span>=</span> <span>{</span>
  <span>b</span><span>:</span> <span>2</span>
<span>}</span>
<span>let</span> json <span>=</span> <span>{</span>
  <span>[</span>obj1<span>]</span> <span>:</span> <span>'value1'</span><span>,</span>
  <span>[</span>obj2<span>]</span> <span>:</span> <span>'value2'</span>
<span>}</span>

json  <span>//Object {[object Object]: 'value2'}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>[obj1] 会把 [obj2] 覆盖掉，而 json 最后只有一个 [object Object] 属性。</p>
<h3 id="object-is" tabindex="-1"> <a href="http://Object.is" target="_blank" rel="noopener noreferrer">Object.is</a>()</h3>
<p>为了解决相等运算符（<mark>）和严格相等运算符（</mark>=）的缺点，<a href="http://Object.is" target="_blank" rel="noopener noreferrer">Object.is</a> 用来比较两个值是否全等。</p>
<div><pre><code><span>+</span><span>0</span> <span>===</span> <span>-</span><span>0</span> <span>//true</span>
<span>NaN</span> <span>===</span> <span>NaN</span> <span>// false</span>

Object<span>.</span><span>is</span><span>(</span><span>+</span><span>0</span><span>,</span> <span>-</span><span>0</span><span>)</span> <span>// false</span>
Object<span>.</span><span>is</span><span>(</span><span>NaN</span><span>,</span> <span>NaN</span><span>)</span> <span>// true</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="object-assign" tabindex="-1"> Object.assign()</h3>
<p>Object.assign 方法用于对象的合并，将源对象（source）的所有可枚举属性，复制到目标对象，属于浅拷贝。</p>
<p>此方法的第一个参数是目标对象，后面的参数都是源对象。</p>
<p>如果目标对象与源对象有同名属性，或多个源对象有同名属性，则后面的属性会覆盖前面的属性。</p>
<div><pre><code><span>const</span> target <span>=</span> <span>{</span> <span>a</span><span>:</span> <span>1</span><span>,</span> <span>b</span><span>:</span> <span>1</span> <span>}</span><span>;</span>

<span>const</span> source1 <span>=</span> <span>{</span> <span>b</span><span>:</span> <span>2</span><span>,</span> <span>c</span><span>:</span> <span>2</span> <span>}</span><span>;</span>
<span>const</span> source2 <span>=</span> <span>{</span> <span>c</span><span>:</span> <span>3</span> <span>}</span><span>;</span>

Object<span>.</span><span>assign</span><span>(</span>target<span>,</span> source1<span>,</span> source2<span>)</span><span>;</span>
target <span>// {a:1, b:2, c:3}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>如果只有一个参数，Object.assign 会直接返回该参数。</p>
<div><pre><code><span>const</span> obj <span>=</span> <span>{</span><span>a</span><span>:</span> <span>1</span><span>}</span><span>;</span>
Object<span>.</span><span>assign</span><span>(</span>obj<span>)</span> <span>===</span> obj <span>// true</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>如果首参不是对象，则会先转成对象，然后返回，undefined 和 null 无法转成对象，报错。如果不是首参，只有字符串会以数组形式拷贝入目标对象，其他都不会产生效果。</p>
<div><pre><code><span>typeof</span> Object<span>.</span><span>assign</span><span>(</span><span>2</span><span>)</span> <span>// "object"</span>
<span>let</span> obj <span>=</span> <span>{</span><span>a</span><span>:</span> <span>1</span><span>}</span><span>;</span>
Object<span>.</span><span>assign</span><span>(</span>obj<span>,</span> <span>undefined</span><span>)</span> <span>===</span> obj <span>// true</span>
Object<span>.</span><span>assign</span><span>(</span>obj<span>,</span> <span>null</span><span>)</span> <span>===</span> obj <span>// true</span>

<span>const</span> v1 <span>=</span> <span>'abc'</span><span>;</span>
<span>const</span> v2 <span>=</span> <span>true</span><span>;</span>
<span>const</span> v3 <span>=</span> <span>10</span><span>;</span>

<span>const</span> obj <span>=</span> Object<span>.</span><span>assign</span><span>(</span><span>{</span><span>}</span><span>,</span> v1<span>,</span> v2<span>,</span> v3<span>)</span><span>;</span>
console<span>.</span><span>log</span><span>(</span>obj<span>)</span><span>;</span> <span>// { "0": "a", "1": "b", "2": "c" }</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="属性的可枚举行" tabindex="-1"> 属性的可枚举行</h3>
<p>对象的每个属性都有一个描述对象（Descriptor），用来控制该属性的行为。Object.getOwnPropertyDescriptor 方法可以获取该属性的描述对象。</p>
<div><pre><code><span>let</span> obj <span>=</span> <span>{</span> <span>foo</span><span>:</span> <span>123</span> <span>}</span><span>;</span>
Object<span>.</span><span>getOwnPropertyDescriptor</span><span>(</span>obj<span>,</span> <span>'foo'</span><span>)</span>
<span>//  {</span>
<span>//    value: 123,</span>
<span>//    writable: true,</span>
<span>//    enumerable: true,</span>
<span>//    configurable: true</span>
<span>//  }</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>描述对象的 enumerable 属性，称为”可枚举性“，如果该属性为 false，就表示某些操作会忽略当前属性。</p>
<p>有四个操作会忽略 enumerable 为 false 的属性。</p>
<ul>
<li><code>for...in</code> 循环：只遍历对象自身的和继承的可枚举的属性。</li>
<li><code>Object.keys()</code>：返回对象自身的所有可枚举的属性的键名。</li>
<li><code>JSON.stringify()</code>：只串行化对象自身的可枚举的属性。</li>
<li><code>Object.assign()</code>： 忽略 enumerable 为 false 的属性，只拷贝对象自身的可枚举的属性。</li>
</ul>
<h3 id="属性的遍历" tabindex="-1"> 属性的遍历</h3>
<p><strong>for...in</strong> 循环遍历对象自身的和继承的可枚举属性（不含 Symbol 属性）。</p>
<p><strong>Object.keys</strong> 返回一个数组，包括对象自身的（不含继承的）所有可枚举属性（不含 Symbol 属性）的键名。</p>
<p><strong>Object.getOwnPropertyNames</strong> 返回一个数组，包含对象自身的所有属性（不含 Symbol 属性，但是包括不可枚举属性）的键名。</p>
<p><strong>Object.getOwnPropertySymbols</strong> 返回一个数组，包含对象自身的所有 Symbol 属性的键名。</p>
<p><strong>Reflect.ownKeys</strong> 返回一个数组，包含对象自身的所有键名，不管键名是 Symbol 或字符串，也不管是否可枚举。</p>
<h3 id="proto-属性" tabindex="-1"> __ proto __属性</h3>
<p>用来读取或设置当前对象的 <code>prototype</code> 对象。实现上，<code>__proto__</code>调用的是<code>Object.prototype.__proto__</code>。</p>
<h3 id="object-keys-object-values-object-entries" tabindex="-1"> Object.keys(), Object.values(), Object.entries()</h3>
<p>ES5 引入了 <code>Object.keys</code> 方法，返回一个数组，成员是参数对象自身的（不含继承的）所有可遍历（enumerable）属性的键名。</p>
<p>ES6 引入了跟 <code>Object.keys</code> 配套的 <code>Object.values</code> 和 <code>Object.entries</code>，作为遍历一个对象的补充手段，供 <code>for...of</code> 循环使用。</p>
<p><strong>Object.values()</strong> 方法返回一个数组，成员是参数对象自身的（不含继承的）所有可遍历（enumerable）属性的键值。</p>
<p><strong>Object.entries()</strong> 方法返回一个数组，成员是参数对象自身的（不含继承的）所有可遍历（enumerable）属性的键值对数组。</p>
<div><pre><code><span>const</span> obj <span>=</span> <span>{</span> <span>foo</span><span>:</span> <span>'bar'</span><span>,</span> <span>baz</span><span>:</span> <span>42</span> <span>}</span><span>;</span>
Object<span>.</span><span>entries</span><span>(</span>obj<span>)</span>
<span>// [ ["foo", "bar"], ["baz", 42] ]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><h3 id="对象的扩展运算符" tabindex="-1"> 对象的扩展运算符</h3>
<p>ES7 将扩展运算符引入了对象。</p>
<p>可用于<strong>解构赋值</strong>：</p>
<div><pre><code><span>let</span> <span>{</span> x<span>,</span> y<span>,</span> <span>...</span>z <span>}</span> <span>=</span> <span>{</span> <span>x</span><span>:</span> <span>1</span><span>,</span> <span>y</span><span>:</span> <span>2</span><span>,</span> <span>a</span><span>:</span> <span>3</span><span>,</span> <span>b</span><span>:</span> <span>4</span> <span>}</span><span>;</span>
x <span>// 1</span>
y <span>// 2</span>
z <span>// { a: 3, b: 4 }</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p>解构赋值不是最后一个参数，所以会报错。解构赋值要求等号右边是一个对象，否则报错。</p>
<p>解构赋值的拷贝是浅拷贝，且不能复制继承自原型对象的属性。</p>
<p>用于<strong>拷贝对象</strong> 和 <strong>合并对象</strong></p>
<div><pre><code><span>let</span> z <span>=</span> <span>{</span> <span>a</span><span>:</span> <span>3</span><span>,</span> <span>b</span><span>:</span> <span>4</span> <span>}</span><span>;</span>
<span>let</span> n <span>=</span> <span>{</span> <span>...</span>z <span>}</span><span>;</span>
n <span>// { a: 3, b: 4 }</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>这等同于使用 <code>Object.assign</code> 方法。</p>
<div><pre><code><span>let</span> ab <span>=</span> <span>{</span> <span>...</span>a<span>,</span> <span>...</span>b <span>}</span><span>;</span>
<span>// 等同于</span>
<span>let</span> ab <span>=</span> Object<span>.</span><span>assign</span><span>(</span><span>{</span><span>}</span><span>,</span> a<span>,</span> b<span>)</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>与数组的扩展运算符一样，对象的扩展运算符后面可以跟表达式。</p>
<div><pre><code><span>const</span> obj <span>=</span> <span>{</span>
  <span>...</span><span>(</span>x <span>></span> <span>1</span> <span>?</span> <span>{</span><span>a</span><span>:</span> <span>1</span><span>}</span> <span>:</span> <span>{</span><span>}</span><span>)</span><span>,</span>
  <span>b</span><span>:</span> <span>2</span><span>,</span>
<span>}</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><h2 id="symbel" tabindex="-1"> Symbel</h2>
<p>ES5 的对象属性名都是字符串，这容易造成属性名的冲突，为了保证每个属性的名字都是独一无二的，这样就从根本上防止属性名的冲突。这就是 ES6 引入Symbol的原因。</p>
<p>它是 JavaScript 语言的第七种数据类型，前六种是：undefined、null、布尔值（Boolean）、字符串（String）、数值（Number）、对象（Object）。</p>
<div><pre><code><span>let</span> s <span>=</span> <span>Symbel</span><span>(</span><span>)</span><span>;</span>
<span>typeof</span> s
<span>// 'Symbel'</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>s 是一个独一无二的值。</p>
<p>Symbol 函数前不能使用 <code>new</code> 命令，否则会报错。这是因为生成的 Symbol 是一个原始类型的值，不是对象。也就是说，由于 Symbol 值不是对象，所以不能添加属性。基本上，它是一种类似于字符串的数据类型。</p>
<p>Symbol 函数可以接受一个字符串作为参数，表示对 Symbol 实例的描述，主要是为了在控制台显示，或者转为字符串时，比较容易区分。</p>
<div><pre><code><span>let</span> s1 <span>=</span> <span>Symbol</span><span>(</span><span>'foo'</span><span>)</span><span>;</span>

s1 <span>// Symbol(foo)</span>

s1<span>.</span><span>toString</span><span>(</span><span>)</span> <span>// "Symbol(foo)"</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>如果 Symbol 的参数是一个对象，就会调用该对象的toString方法，将其转为字符串，然后才生成一个 Symbol 值。</p>
<p>Symbol 函数的参数只是表示对当前 Symbol 值的描述，因此相同参数的Symbol函数的返回值是不相等的。</p>
<p>Symbol 值不能与其他类型的值进行运算，会报错。但是，Symbol 值可以显式转为字符串。也可以转为布尔值，但是不能转为数值。</p>
<div><pre><code><span>let</span> sym <span>=</span> <span>Symbol</span><span>(</span><span>'My symbol'</span><span>)</span><span>;</span>

<span>String</span><span>(</span>sym<span>)</span> <span>// 'Symbol(My symbol)'</span>
sym<span>.</span><span>toString</span><span>(</span><span>)</span> <span>// 'Symbol(My symbol)'</span>

<span>Boolean</span><span>(</span>sym<span>)</span> <span>// true</span>
<span>!</span>sym  <span>// false</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="作为属性名" tabindex="-1"> 作为属性名</h3>
<div><pre><code><span>let</span> mySymbol <span>=</span> <span>Symbol</span><span>(</span><span>)</span><span>;</span>

<span>// 第一种写法</span>
<span>let</span> a <span>=</span> <span>{</span><span>}</span><span>;</span>
a<span>[</span>mySymbol<span>]</span> <span>=</span> <span>'Hello!'</span><span>;</span>

<span>// 第二种写法</span>
<span>let</span> a <span>=</span> <span>{</span>
  <span>[</span>mySymbol<span>]</span><span>:</span> <span>'Hello!'</span>
<span>}</span><span>;</span>

<span>// 第三种写法</span>
<span>let</span> a <span>=</span> <span>{</span><span>}</span><span>;</span>
Object<span>.</span><span>defineProperty</span><span>(</span>a<span>,</span> mySymbol<span>,</span> <span>{</span> <span>value</span><span>:</span> <span>'Hello!'</span> <span>}</span><span>)</span><span>;</span>

<span>// 以上写法都得到同样结果</span>
a<span>[</span>mySymbol<span>]</span> <span>// "Hello!"</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>Symbol 值作为对象属性名时，不能用点运算符。</p>
<p>在对象的内部，使用 Symbol 值定义属性时，Symbol 值必须放在方括号之中。</p>
<h2 id="module模块" tabindex="-1"> Module模块</h2>
<p><code>ES6</code> 模块通过<code>export</code>命令显式指定输出的代码，再通过<code>import</code>命令输入。使用模块自动采用严格模式。<a href="https://link.segmentfault.com/?enc=1gqS2d%2BHX2rNigzRaRiK9w%3D%3D.p%2F9KZRIufKJXjX29hQ8D27gL5UnNsPRc%2BdtMVanU71Ir975mR%2ByRyEs8MVq0EQyF%2Bk7QztHAKp%2Bm7S%2FJMlEEJmTYwf6XEvniadeVni7aMbk%3D" target="_blank" rel="noopener noreferrer">严格模式详解</a></p>
<h3 id="export" tabindex="-1"> export</h3>
<p><code>export</code> 用于规定模块的对外接口，输出变量，函数，类。</p>
<div><pre><code><span>//写法1</span>
<span>export</span> <span>let</span> a <span>=</span> <span>1</span><span>;</span>
<span>export</span> <span>function</span> <span>b</span> <span>(</span><span>)</span> <span>{</span><span>}</span><span>;</span>

<span>//写法2</span>
<span>let</span> a <span>=</span> <span>1</span><span>;</span>
<span>function</span> <span>b</span> <span>(</span><span>)</span> <span>{</span><span>}</span><span>;</span>
<span>export</span> <span>{</span>a<span>,</span> b<span>}</span><span>;</span>

<span>//报错</span>
<span>let</span> a <span>=</span> <span>1</span><span>;</span>
<span>export</span> a<span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>通常输出的变量就是本来的名字，可以用 <code>as</code> 修改。</p>
<div><pre><code><span>function</span> <span>a</span> <span>(</span><span>)</span> <span>{</span><span>}</span><span>;</span>
<span>let</span> b <span>=</span> <span>1</span><span>;</span>

<span>export</span> <span>{</span>
    a <span>as</span> fnA<span>,</span>
    b <span>as</span> vB
<span>}</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><code>export</code>输出的接口和模块内部的变量是<strong>动态绑定</strong>关系，变量值改变，通过接口获取的值也相应改变。</p>
<div><pre><code><span>//test.js</span>
<span>export</span> <span>let</span> a <span>=</span> <span>1</span><span>;</span>
<span>setTimeout</span><span>(</span><span>(</span><span>)</span> <span>=></span> a<span>=</span><span>2</span><span>,</span> <span>1000</span><span>)</span><span>;</span>

<span>import</span> <span>{</span>a<span>}</span> <span>from</span> <span>'./test'</span>
<span>//a = 1, 1s后变成2</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><code>export</code>必须处于<strong>模块顶层</strong>，如果处于块级作用域会报错。<code>import</code>也是如此。</p>
<div><pre><code><span>function</span> <span>(</span><span>)</span> <span>{</span>
    <span>export</span> <span>let</span> a <span>=</span> <span>1</span><span>;</span>  <span>//报错</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><h3 id="import" tabindex="-1"> import</h3>
<p>使用<code>import</code>加载模块。<a href="https://link.segmentfault.com/?enc=ARF3XMHuI%2B65E8pPDrk7tA%3D%3D.z7wzeodzC5kDDuFlv9x8LVD%2FI7kxCCFp8oA7SjOc62fEvwbbh9XR6qMyPeXKLTL5i2%2BOL0i9LkG9%2Bpjf85EwZjcyHtfwMs0CX9ju846bXXS1FajvjAB17YpsD952EJdn" target="_blank" rel="noopener noreferrer">import - MDN</a></p>
<div><pre><code><span>import</span> <span>{</span>a<span>,</span> b<span>}</span> <span>from</span> <span>'./test'</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p><code>import</code>后跟一个大括号，括号内指定需要导入的变量，变量名需对应。但可以通过<code>as</code>修改。</p>
<div><pre><code><span>import</span> <span>{</span>a <span>as</span> vA<span>,</span> b <span>as</span> vB<span>}</span> <span>from</span> <span>'./test'</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p><code>import</code>后的<code>from</code>用来指定模块的路径，绝对路径或相对路径，<code>.js</code>可以省略。如果模块有配置文件，则不带路径。</p>
<div><pre><code><span>import</span> react<span>,</span> <span>{</span>Component<span>}</span> <span>from</span> <span>'react'</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p><code>import</code>有<strong>提升效果</strong>，会提升到模块头部，先执行。</p>
<p>由于<code>import</code>是静态执行，不能使用表达式和变量。比如<code>from</code>后的路径不能用一个变量代替。</p>
<p><code>import</code>会执行所加载的模块，可以直接跟模块名。但多次加载相同模块只执行一次，<code>import</code>语句是单例模式。</p>
<div><pre><code><span>import</span> <span>'module_name'</span><span>;</span>

<span>import</span> <span>{</span>a<span>}</span> <span>from</span> <span>'./test'</span><span>;</span>
<span>import</span> <span>{</span>b<span>}</span> <span>from</span> <span>'./test'</span><span>;</span>
<span>//等同于</span>
<span>import</span> <span>{</span>a<span>,</span>b<span>}</span> <span>from</span> <span>'./test'</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>模块整体加载：</p>
<div><pre><code><span>import</span> <span>*</span> <span>as</span> myModule <span>from</span> <span>'./my_module.js'</span><span>;</span>
<span>//以myModule为命名空间，在myMoudle下可以找到所有接口，不允许修改。</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>导入<strong>默认值</strong> ：</p>
<div><pre><code><span>export</span> <span>default</span> <span>function</span> <span>(</span><span>)</span> <span>{</span><span>}</span><span>;</span>
<span>import</span> fn <span>from</span> <span>'./test'</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><blockquote>
<ul>
<li>导入默认值可以使用任意名字代替输出值。</li>
<li><code>import</code>后不用大括号。</li>
<li><code>export default</code>后跟的变量名或函数名称在模块外部无效。</li>
<li>一个模块只能有一个默认输出，<code>export default</code>只能使用一次。</li>
<li><code>export default</code>表示将后面的值赋给<code>default</code>，再输出一个叫<code>default</code>的变量或函数。</li>
<li><code>export default</code>后不能有变量声明语句。</li>
</ul>
</blockquote>
<div><pre><code><span>//test.js</span>
<span>function</span> <span>fn</span> <span>(</span><span>)</span> <span>{</span><span>}</span><span>;</span>
<span>export</span> <span>default</span> fn<span>;</span>
<span>//等同于</span>
<span>export</span> <span>{</span>fn <span>as</span> <span>default</span><span>}</span><span>;</span>
<span>import</span> <span>{</span><span>default</span> <span>as</span> foo<span>}</span> <span>from</span> <span>'./test'</span><span>;</span>
<span>//等同于</span>
<span>import</span> foo <span>from</span> <span>'./test'</span><span>;</span>
<span>export</span> <span>default</span> <span>let</span> a <span>=</span> <span>1</span><span>;</span>  <span>//报错</span>
<span>export</span> <span>default</span> <span>10</span><span>;</span>         <span>//正确</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><code>import</code>和<code>export</code>的<strong>复合写法</strong>:</p>
<div><pre><code><span>export</span> <span>{</span>foo<span>,</span> fn<span>}</span> <span>from</span> <span>'module'</span><span>;</span>
<span>//等同于</span>
<span>import</span> <span>{</span>foo<span>,</span> fn<span>}</span> <span>from</span> <span>'module'</span><span>;</span>
<span>export</span> <span>{</span>foo<span>,</span> fn<span>}</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><h3 id="模块在浏览器中加载" tabindex="-1"> 模块在浏览器中加载</h3>
<p>加载<code>javascript</code>脚本使用<code>&lt;script&gt;</code>标签，可使用<code>defer</code>或<code>async</code>实现异步加载，<code>defer</code>会等到页面渲染完，其他脚本执行完再执行，<code>async</code>只要资源加载完就终断页面渲染立即执行，不能保证多个<code>async</code>脚本按顺序执行。</p>
<p>在浏览器中可以使用<code>&lt;script&gt;</code>标签加载模块，但需要<code>type='module'</code>属性。</p>
<div><pre><code><span><span><span>&lt;</span>script</span> <span>src</span><span><span>=</span><span>'</span>path/test.js<span>'</span></span> <span>type</span><span><span>=</span><span>'</span>module<span>'</span></span><span>></span></span><span><span><span>&lt;/</span>script</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>带有<code>type='module'</code>的<code>&lt;script&gt;</code>都是异步加载，等同于自动打开了<code>defer</code>属性，也可以加<code>async</code>属性，让模块加载完立即执行。</p>
<p>也可以直接在<code>&lt;script&gt;</code>标签内加载模块。</p>
<div><pre><code><span><span><span>&lt;</span>script</span> <span>type</span><span><span>=</span><span>'</span>module<span>'</span></span><span>></span></span>
    import a from './test.js';
<span><span><span>&lt;/</span>script</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-26T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">改造BeanUtils优雅实现List数据拷贝</title>
    <id>https://blog.ciberviler.top/dev/%E6%94%B9%E9%80%A0BeanUtils%E4%BC%98%E9%9B%85%E5%AE%9E%E7%8E%B0List%E6%95%B0%E6%8D%AE%E6%8B%B7%E8%B4%9D.html</id>
    <link href="https://blog.ciberviler.top/dev/%E6%94%B9%E9%80%A0BeanUtils%E4%BC%98%E9%9B%85%E5%AE%9E%E7%8E%B0List%E6%95%B0%E6%8D%AE%E6%8B%B7%E8%B4%9D.html"/>
    <updated>2022-06-13T14:44:57.000Z</updated>
    <content type="html"><![CDATA[<h1 id="改造beanutils优雅实现list数据拷贝" tabindex="-1"> 改造BeanUtils优雅实现List数据拷贝</h1>
<p>BeanUtils.copyProperties();确实为我们做了很多事情，虽然不能完美完成深拷贝，但是对于 po、vo、dto 的拷贝已经足够用了。但是其还是有一些不够完美的地方。</p>
<p>不足几点如下：</p>
<p><strong>①</strong>不能拷贝 list，而拷贝 list 的情况又大量存在，因此会有许多重复代码。</p>
<div><pre><code><span>for</span> <span>(</span><span>S</span> source <span>:</span> sources<span>)</span> <span>{</span>
    <span>T</span> target <span>=</span> <span>new</span> <span>T</span><span>(</span><span>)</span><span>;</span>
    <span>copyProperties</span><span>(</span>source<span>,</span> target<span>)</span><span>;</span>
    list<span>.</span><span>add</span><span>(</span>target<span>)</span><span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>②</strong>有一些简单的查询，仅仅需要转换一下 vo 也需要 new Vo()。</p>
<div><pre><code><span>public</span> <span>Vo</span> <span>findById</span><span>(</span><span>Integer</span> id<span>)</span> <span>{</span>
 <span>Vo</span> vo <span>=</span> <span>new</span> <span>Vo</span><span>(</span><span>)</span><span>;</span>
 <span>Po</span> po <span>=</span> dao<span>.</span><span>findById</span><span>(</span>id<span>)</span><span>;</span>
 <span>copyProperties</span><span>(</span>po<span>,</span> vo<span>)</span><span>;</span>
 <span>return</span> vo<span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>③</strong>这种拷贝方式是没有返回值的，jdk8 支持 stream() 操作之后，支持不是很友好，不方便 lambda 表达式的使用，因此我们决定通过集成 BeanUtils 类，自己造一个方便用的轮子。</p>
<p><strong>使用</strong></p>
<p>我们将新创建一个轮子 BeanConvertUtils，使用如下，当我们要转换 po、vo 时，只需要：</p>
<div><pre><code><span>// 使用前</span>
<span>public</span> <span>Vo</span> <span>findById</span><span>(</span><span>Integer</span> id<span>)</span> <span>{</span>
 <span>Vo</span> vo <span>=</span> <span>new</span> <span>Vo</span><span>(</span><span>)</span><span>;</span>
 <span>Po</span> po <span>=</span> dao<span>.</span><span>findById</span><span>(</span>id<span>)</span><span>;</span>
 <span>copyProperties</span><span>(</span>po<span>,</span> vo<span>)</span><span>;</span>
 <span>return</span> vo<span>;</span>
<span>}</span>

<span>// 使用后</span>
<span>public</span> <span>Vo</span> <span>findById</span><span>(</span><span>Integer</span> id<span>)</span> <span>{</span>
 <span>return</span> <span>BeanConvertUtils</span><span>.</span><span>converTo</span><span>(</span>dao<span>.</span><span>findById</span><span>(</span>id<span>)</span><span>,</span> <span>Vo</span><span>::</span><span>new</span><span>)</span><span>;</span>
<span>}</span>

<span>// 使用后，通过lambda表达式特殊处理个别字段</span>
<span>public</span> <span>Vo</span> <span>findById</span><span>(</span><span>Integer</span> id<span>)</span> <span>{</span>
 <span>return</span> <span>BeanConvertUtils</span><span>.</span><span>converTo</span><span>(</span>dao<span>.</span><span>findById</span><span>(</span>id<span>)</span><span>,</span> <span>Vo</span><span>::</span><span>new</span><span>,</span> 
  <span>(</span>s<span>,</span> t<span>)</span> <span>-></span> t<span>.</span><span>setName</span><span>(</span>s<span>.</span>getName<span>)</span><span>)</span>
 <span>)</span><span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>当我们要拷贝 list 的时候也很简单：</p>
<div><pre><code><span>// 使用前</span>
<span>public</span> <span>List</span><span><span>&lt;</span><span>Vo</span><span>></span></span> <span>findAll</span><span>(</span><span>)</span> <span>{</span>
 <span>List</span><span><span>&lt;</span><span>Vo</span><span>></span></span> vos <span>=</span> <span>new</span> <span>ArrayList</span><span>(</span><span>)</span><span>;</span>
 <span>List</span><span><span>&lt;</span><span>Po</span><span>></span></span> pos <span>=</span> dao<span>.</span><span>findAll</span><span>(</span><span>)</span><span>;</span>
 <span>for</span> <span>(</span><span>Po</span> po <span>:</span> <span>Pos</span><span>)</span> <span>{</span>
     <span>Vo</span> vo <span>=</span> <span>new</span> <span>Vo</span><span>(</span><span>)</span><span>;</span>
     <span>BeanUtis</span><span>.</span><span>copyProperties</span><span>(</span>po<span>,</span> vo<span>)</span><span>;</span>
     vos<span>.</span><span>add</span><span>(</span>vo<span>)</span><span>;</span>
    <span>}</span>
 <span>return</span> vos<span>;</span>
<span>}</span>

<span>// 使用后</span>
<span>public</span> <span>List</span><span><span>&lt;</span><span>Vo</span><span>></span></span> <span>findAll</span><span>(</span><span>)</span> <span>{</span>
 <span>return</span> <span>BeanConvertUtils</span><span>.</span><span>converToList</span><span>(</span>dao<span>.</span><span>findAll</span><span>(</span><span>)</span><span>,</span> <span>Vo</span><span>::</span><span>new</span><span>)</span>
<span>}</span>

<span>// 同样支持自定义lambda</span>
<span>public</span> <span>List</span><span><span>&lt;</span><span>Vo</span><span>></span></span> <span>findAll</span><span>(</span><span>)</span> <span>{</span>
 <span>return</span> <span>BeanConvertUtils</span><span>.</span><span>converToList</span><span>(</span>dao<span>.</span><span>findAll</span><span>(</span><span>)</span><span>,</span> <span>Vo</span><span>::</span><span>new</span><span>,</span>
  <span>(</span>s<span>,</span> t<span>)</span> <span>-></span> t<span>.</span><span>setName</span><span>(</span>s<span>.</span>getName<span>)</span><span>)</span>
 <span>)</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="代码如下" tabindex="-1"> 代码如下：</h3>
<div><pre><code><span>/**
 * 转换对象工具
 *
 * <span>@author</span> bugpool
 */</span>
<span>public</span> <span>class</span> <span>BeanConvertUtils</span> <span>extends</span> <span>BeanUtils</span> <span>{</span>

    <span>public</span> <span>static</span> <span><span>&lt;</span><span>S</span><span>,</span> <span>T</span><span>></span></span> <span>T</span> <span>convertTo</span><span>(</span><span>S</span> source<span>,</span> <span>Supplier</span><span><span>&lt;</span><span>T</span><span>></span></span> targetSupplier<span>)</span> <span>{</span>
        <span>return</span> <span>convertTo</span><span>(</span>source<span>,</span> targetSupplier<span>,</span> <span>null</span><span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 转换对象
     *
     * <span>@param</span> <span>source</span>         源对象
     * <span>@param</span> <span>targetSupplier</span> 目标对象供应方
     * <span>@param</span> <span>callBack</span>       回调方法
     * <span>@param</span> <span><span>&lt;</span>S<span>></span></span>            源对象类型
     * <span>@param</span> <span><span>&lt;</span>T<span>></span></span>            目标对象类型
     * <span>@return</span> 目标对象
     */</span>
    <span>public</span> <span>static</span> <span><span>&lt;</span><span>S</span><span>,</span> <span>T</span><span>></span></span> <span>T</span> <span>convertTo</span><span>(</span><span>S</span> source<span>,</span> <span>Supplier</span><span><span>&lt;</span><span>T</span><span>></span></span> targetSupplier<span>,</span> <span>ConvertCallBack</span><span><span>&lt;</span><span>S</span><span>,</span> <span>T</span><span>></span></span> callBack<span>)</span> <span>{</span>
        <span>if</span> <span>(</span><span>null</span> <span>==</span> source <span>||</span> <span>null</span> <span>==</span> targetSupplier<span>)</span> <span>{</span>
            <span>return</span> <span>null</span><span>;</span>
        <span>}</span>

        <span>T</span> target <span>=</span> targetSupplier<span>.</span><span>get</span><span>(</span><span>)</span><span>;</span>
        <span>copyProperties</span><span>(</span>source<span>,</span> target<span>)</span><span>;</span>
        <span>if</span> <span>(</span>callBack <span>!=</span> <span>null</span><span>)</span> <span>{</span>
            callBack<span>.</span><span>callBack</span><span>(</span>source<span>,</span> target<span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> target<span>;</span>
    <span>}</span>

    <span>public</span> <span>static</span> <span><span>&lt;</span><span>S</span><span>,</span> <span>T</span><span>></span></span> <span>List</span><span><span>&lt;</span><span>T</span><span>></span></span> <span>convertListTo</span><span>(</span><span>List</span><span><span>&lt;</span><span>S</span><span>></span></span> sources<span>,</span> <span>Supplier</span><span><span>&lt;</span><span>T</span><span>></span></span> targetSupplier<span>)</span> <span>{</span>
        <span>return</span> <span>convertListTo</span><span>(</span>sources<span>,</span> targetSupplier<span>,</span> <span>null</span><span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 转换对象
     *
     * <span>@param</span> <span>sources</span>        源对象list
     * <span>@param</span> <span>targetSupplier</span> 目标对象供应方
     * <span>@param</span> <span>callBack</span>       回调方法
     * <span>@param</span> <span><span>&lt;</span>S<span>></span></span>            源对象类型
     * <span>@param</span> <span><span>&lt;</span>T<span>></span></span>            目标对象类型
     * <span>@return</span> 目标对象list
     */</span>
    <span>public</span> <span>static</span> <span><span>&lt;</span><span>S</span><span>,</span> <span>T</span><span>></span></span> <span>List</span><span><span>&lt;</span><span>T</span><span>></span></span> <span>convertListTo</span><span>(</span><span>List</span><span><span>&lt;</span><span>S</span><span>></span></span> sources<span>,</span> <span>Supplier</span><span><span>&lt;</span><span>T</span><span>></span></span> targetSupplier<span>,</span> <span>ConvertCallBack</span><span><span>&lt;</span><span>S</span><span>,</span> <span>T</span><span>></span></span> callBack<span>)</span> <span>{</span>
        <span>if</span> <span>(</span><span>null</span> <span>==</span> sources <span>||</span> <span>null</span> <span>==</span> targetSupplier<span>)</span> <span>{</span>
            <span>return</span> <span>null</span><span>;</span>
        <span>}</span>

        <span>List</span><span><span>&lt;</span><span>T</span><span>></span></span> list <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span>sources<span>.</span><span>size</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>for</span> <span>(</span><span>S</span> source <span>:</span> sources<span>)</span> <span>{</span>
            <span>T</span> target <span>=</span> targetSupplier<span>.</span><span>get</span><span>(</span><span>)</span><span>;</span>
            <span>copyProperties</span><span>(</span>source<span>,</span> target<span>)</span><span>;</span>
            <span>if</span> <span>(</span>callBack <span>!=</span> <span>null</span><span>)</span> <span>{</span>
                callBack<span>.</span><span>callBack</span><span>(</span>source<span>,</span> target<span>)</span><span>;</span>
            <span>}</span>
            list<span>.</span><span>add</span><span>(</span>target<span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> list<span>;</span>
    <span>}</span>

    <span>/**
     * 回调接口
     *
     * <span>@param</span> <span><span>&lt;</span>S<span>></span></span> 源对象类型
     * <span>@param</span> <span><span>&lt;</span>T<span>></span></span> 目标对象类型
     */</span>
    <span>@FunctionalInterface</span>
    <span>public</span> <span>interface</span> <span>ConvertCallBack</span><span><span>&lt;</span><span>S</span><span>,</span> <span>T</span><span>></span></span> <span>{</span>
        <span>void</span> <span>callBack</span><span>(</span><span>S</span> t<span>,</span> <span>T</span> s<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>性能</strong></p>
<p>由于只是 BeanUtils 的一个封装，跟原来的代码性能几乎差不多，如果要说差一点也没错，毕竟多了一层函数堆栈的调用，但是基本可以忽略不计。主要的性能还是由 BeanUtils 决定。</p>
<p><strong>提醒</strong></p>
<p>不知道大家对这个 BeanConvertUtils 工具类感觉怎么样，自己在项目中倒是大量使用，也很方便。</p>
<p>但是有两点要提醒：</p>
<p>此方法依旧不能解决深层次的深拷贝问题，详细的可以 google 一下 BeanUtils 的深拷贝问题。‘</p>
<p>如果 source 或者 targetSupplier 只要有一个为 null，本工具类不像 BeanUtils 一样抛出异常，而是返回 null，因为笔者认为调用方如果把 null 进行准换，那就是想转换为 null，为不为空应该由调用方自己负责。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-27T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">架构师图谱之微服务&amp;消息队列</title>
    <id>https://blog.ciberviler.top/dev/%E5%BE%AE%E6%9C%8D%E5%8A%A1&amp;%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97.html</id>
    <link href="https://blog.ciberviler.top/dev/%E5%BE%AE%E6%9C%8D%E5%8A%A1&amp;%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97.html"/>
    <updated>2022-06-12T13:36:29.000Z</updated>
    <content type="html"><![CDATA[<h1 id="架构师图谱之微服务-消息队列" tabindex="-1"> 架构师图谱之微服务&amp;消息队列</h1>
<h2 id="概述" tabindex="-1"> 概述</h2>
<p>“架构师图谱”是一个很宏大的命题，特别是优秀的架构师自身也是“由点到面再到图”，一点点成长积累起来，尝试写这篇文章的目的更多的是结合自身的一些架构、研发、管理经验对现阶段做一个复盘总结，所以这里更偏向于后端图谱，依赖于开源技术、云原生或者其他第三方服务。这里会重点介绍一些技术栈、设计理念以及适应场景，这些可以作为我们选型时的依据。所谓“架构即决策”，是在一个有约束的盒子中寻求最优解。这个有约束的盒子是团队经验、成本、资源、进度、业务所处阶段等编织、掺杂在一起的综合体。本质上无优劣，但是存在恰当的架构用在合适的软件系统中，而这些就是决策的结果。</p>
<h2 id="序章" tabindex="-1"> <strong>序章</strong></h2>
<p>一个技术图谱：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16550404961021.png" alt="图片" loading="lazy"></p>
<p>计划会分上、中、下三个篇章来介绍：</p>
<ul>
<li>上篇：重点聚焦在微服务和常用的消息队列，包括相关的选型以及一些理论基础</li>
<li>中篇：主要集中在数据库、分布式（一致性/锁/缓存/发号/任务调度等），以及流媒体</li>
<li>下篇：分享一些DevOps、项目管理、团队建设方向的一些经验</li>
</ul>
<p>完整的思维导图：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16550404961022.png" alt="图片" loading="lazy"></p>
<h2 id="微服务" tabindex="-1"> 微服务</h2>
<p>微服务（英语：Microservices）是一种软件架构风格，它是以专注于单一责任与功能的小型功能区块（Small Building Blocks）为基础，利用模块化的方式组合出复杂的大型应用程序，各功能区块使用与语言无关（Language-Independent/Language agnostic）的API集相互通信。</p>
<p>微服务架构有别于更为传统的单体服务，可将应用拆分成多个核心功能。每个功能都被称为一项服务，可以单独构建和部署。这也体现了可扩展的基本思想：将原本大一统的系统拆成多个小部分，扩展时只修改其中一部分，通过这种方式减少改动范围，降低改动风险。微服务架构涵盖了服务的多个方面，包括网关、通信协议、服务注册/发现、可观察性、如何合理的划分等等。</p>
<h3 id="理论基础" tabindex="-1"> <strong>理论基础</strong></h3>
<p>微服务的理论基础主要用来指导微服务架构设计、服务拆分，确定合适的服务粒度和边界。在做微服务之前我们首先要想明白我们现有系统面临什么样的问题，为什么需要微服务，随后才是怎么做。微服务很多核心理念其实在半个世纪前的一篇文章中就被阐述过了，而且这篇文章中的很多论点在软件开发飞速发展的这半个世纪中竟然一再被验证，这就是康威定律（Conway’s Law）。在康威的这篇文章中，最有名的一句话就是：</p>
<p>Organizations which design systems are constrained to produce designs which are copies of the communication structures of these organizations.</p>
<p>中文直译大概的意思就是：设计系统的组织，其产生的设计等同于组织之内、组织之间的沟通结构。最初这篇文章只是描述作者自己的发现和总结，后来“人月神话”中，引用这个观点，并将其“吹捧”成现在熟知的“高位定律”，其中的一些核心观点可以概括如下：</p>
<ul>
<li>组织沟通方式决定系统设计，对于复杂的系统，聊设计就离不开聊人与人的沟通，解决好人与人的沟通问题，才能有一个好的系统设计</li>
<li>时间再多一件事情也不可能做的完美，但总有时间做完一件事情，这与架构设计的“简单、合适、演化”思维不谋而合</li>
<li>线型系统和线型组织架构间有潜在的异质同态特征，更直白的说，你想要什么样的系统，就搭建什么样的团队，定义好系统的边界和接口，团队内应该是自治的，这样将沟通成本维持在系统内部，每个子系统就会更加内聚</li>
<li>大的系统组织总是比小系统更倾向于分解，面对复杂的系统及组织，往往可以采用分而治之。另外，搜索公众号编程技术圈后台回复“神器”，获取一份惊喜礼包。</li>
</ul>
<p>但是当我们的业务和组织架构复杂度比较高的时候，很多概念只从技术角度很难去抽象，这就需要我们自上而下，建立起通用语言，让业务人员和研发人员说一样的话，把思考层次从代码细节拉到业务层面。越高层的抽象越稳定，越细节的东西越容易变化。通过对不同领域的建模，逐步确定领域范围和业务边界，这也就是领域驱动设计（DDD）。DDD是一种在面向高度复杂的软件系统时，关于如何去建模的方法论，它的关键点是根据系统的复杂程度建立合适的模型，DDD中的界限上下文也完美匹配了微服务的高内聚、低耦合特性，这也为我们微服务的划分提供了强有力的基础。DDD实施的一般步骤是：</p>
<ul>
<li>根据需求划分出初步的领域和限界上下文，以及上下文之间的关系</li>
<li>进一步分析每个上下文内部，识别出哪些是实体，哪些是值对象</li>
<li>对实体、值对象进行关联和聚合，划分出聚合的范畴和聚合根</li>
<li>为聚合根设计仓储，并思考实体或值对象的创建方式</li>
<li>在工程中实践领域模型，并在实践中检验模型的合理性，倒推模型中不足的地方并重构</li>
</ul>
<p>但是DDD也不是银弹，特别是在一些新业务场景，本身就充满了很多的不确定性，一次性把边界划清楚并不是一件很容易的事。大家在一个进程里，调整起来会相对容易，然后让不同的界限上下文各自演化，等到了一定程度之后再考虑微服务也是一个不错的选择。</p>
<h3 id="网关" tabindex="-1"> 网关</h3>
<p>作为微服务的统一入口，也肩负着整个微服务的流量接入、管理、聚合、安全等，从服务分层的角度可以划分为接入网关和业务网关。接入网关接入网关提供最基础的流量接入和安全防护能力，侧重于全局，与业务无关。</p>
<ul>
<li>
<p>域名&amp;DNS，作为服务的流量入口，对外通过域名和DNS提供服务，国内域名厂商一般都依托于共有云或被共有云厂商收购，用来完善自由的云生态，像阿里的万网，腾讯的DNSPod等，也有国外的AWS，GoDaddy和Namecheap等，可以用作.me等国内无法托管或备案域名的管理，其次也可以借助DNS（HTTPDNS、EDNS）实现跨地域、运营商网络等负载均衡，实现异地多活、就近访问、容灾等。</p>
</li>
<li>
<p>负载均衡（LB），主要负责请求的转发代理，按机器负载来分配流量等，对外提供VIP，这里的负载可以宽泛的理解为系统的压力，可以用CPU负载来衡量，也可以用连接数、I/O使用率、网卡吞吐量等来衡量。负载均衡器按服务层级来划分，除了前边提到的DNS，还有集群级别的硬件负载均衡，以及机器级别的软件负载均衡。</p>
</li>
<li>
<ul>
<li>DNS/硬件负载均衡（F5/A10）主要用来应对海量用户的访问，中小量用户使用无疑会增加更多的维护和采购成本。</li>
<li>软件负载均衡可以选择自研或上云，LVS、Keepalived主要用于四层（IP+端口）的负载均衡，在四层的基础之上如果要实现应用层（域名/URL/用户会话）等的7层负载均衡，可以使用Nginx、Keepalived的组合。</li>
</ul>
</li>
<li>
<p>除此之外，网关也负责服务整体的安全防护，SSL，IPV6等。</p>
</li>
<li>
<ul>
<li>安全防护目的是保护服务数据以及可用性，例如防范常见的DDOS/CC网络攻击，反爬虫，自定义访问控制，自研成本往往比较高，可以借助云上一系列的高防、防火墙服务。</li>
<li>SSL（TLS）用来提供外部https访问，https可以防止数据在传输过程中不被窃取、改变，确保数据的完整性，在支付或者用户登录等敏感数据场景，可以起到一定的保护作用，同时https页面对搜索引擎也比较友好。</li>
<li>IPV6，全球43亿IPV4地址已经在2019年年底耗尽，网信办在2018年开始就已经推行各大运营商、CDN厂商、互联网核心产品支持IPV6，我们公司之前也是试点之一。IPV6的支持只需要增加一条“AAAA”DNS记录，将域名解析到自持IPV6的IP/VIP即可。IPV4到IPV6由于存在兼容性等问题，一定是长期共存的，过渡方案可以采用IPV6代理（IPV6代理转发到IPV4服务）或者双栈（同时支持IPV6和IPV4）。</li>
</ul>
</li>
</ul>
<h3 id="业务网关" tabindex="-1"> 业务网关：</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16550404961023.png" alt="图片" loading="lazy"></p>
<p>业务网关作为业务的最上层出口，一般承担起业务接入或者BFF的工作，例如基础的路由、鉴权、限流、熔断降级、服务聚合、插件化能力，并可以通过可视化界面管理网关配置。可选框架有基于OpenResty的Kong、APISIX以及其他语言相关的Spring Cloud Gateway、gRPC-Gateway等等，国内开源的Goku、Kratos、go-zero go框架，有很多比较有意思的组件实现，我们日常业务上也可以借鉴。</p>
<ul>
<li>鉴权，鉴权的目的是为了验证用户、请求等的有效性，例如用户身份鉴权（JWT/Oauth2/Cookie），请求鉴权（请求签名、请求加密），鉴权逻辑也花样繁多，大多需要基于业务定制化，通过网关插件能很好的集成进来。</li>
<li>限流，限流是为了做一定的流量控制，防止对系统产生过大压力从而影响整个服务。可以基于单台机器或整个集群限流，常见的方式有限制总量和限制速率，超过的则排队或丢弃，例如令牌桶（弹性）/漏桶（匀速）算法。</li>
<li>熔断降级，熔断作为服务断路器，当下游的服务因为某种原因突然变得不可用或响应过慢（这里既可以指单次请求也可以指一段时间），上游服务为了保证自己整体服务的可用性，不再继续调用目标服务，直接返回，这样也能对整体链路起到保护作用。如果目标服务情况好转则恢复调用，同时结合降级策略提升服务的鲁棒性。常见的有Hystrix/Resilience4J（Hystrix虽然已停止更新，但现有功能已经能满足大多业务场景）。</li>
<li>重试，大量网络IO，避免不了会出现因网络抖动，出现连接失败或者超时，重试可以提高请求的最终成功率，削平服务毛刺。但重试也有可能放大故障，所以可以结合退避策略（backoff）、限制单点重试、限制链路重试这些策略进行优雅的重试，同时也可以采用更加激进的“对冲请求”提前（tp99时间未响应时）发起重试请求，降低系统时延。</li>
<li>插件化，各个网关集成插件的方式尽不相同，但是目的都是为了集成技术人员编写的一些业务相关的通用能力，例如前边提到的身份鉴权、请求鉴权等等。另外作为业务网关插件，也可以编写一些基础业务（API鉴权、请求格式化）逻辑，直接透传请求到服务层，省去很多BFF和上下游对接的工作。</li>
<li>BFF，Backend For Frontend，可以按照业务逻辑，以串行、并行和分支等结构编排多个服务API，为服务提供聚合、适配、裁剪（只返回需要的字段）功能，核心是API的动态编排以满足日益增长的业务逻辑，降低前端与微服务之间的对接成本。BFF并不意味着只能由后端实现，也可以在前端通过GraphQL等API查询语言实现。</li>
</ul>
<h3 id="协议" tabindex="-1"> 协议</h3>
<p>服务间的通信方式是在采用微服务架构时需要做出一个最基本的决策，统一的协议标准也能大大降低服务的联调和维护成本。</p>
<ul>
<li>HTTP REST，REST更确切的讲是指的API设计风格，而不是协议标准。通常基于使用HTTP，URL，和JSON这些现有的广泛流行的协议和标准。符合REST设计风格的API称作RESTful API。在实际应用中大多实现的是伪REST API，例如用POST请求同时实现资源的增删改，或者为了请求的扩展性，资源的增删改查都使用POST JSON。</li>
<li>RPC，RPC协议描绘了客户端与服务端之间的点对点调用流程，包括stub、通信、RPC消息协议部分。可以基于TCP，也可以基于http。在实际应用中，还需要考虑服务的高可用、负载均衡等问题，所以产品级的RPC框架除了点对点的RPC协议的具体实现外，还应包括服务的发现与注册、提供服务的多台Server的负载均衡、服务的高可用等更多的功能。目前的RPC框架大致有两种不同的侧重方向，一种偏重于服务治理（Dubbo、Motan），另一种偏重于跨语言调用（Thrift/GRPC）。</li>
</ul>
<h3 id="rpc-vs-http-rest优点" tabindex="-1"> RPC vs HTTP REST优点：</h3>
<ul>
<li>更清晰的API定义，例如gRPC协议的定义文件proto，自身就可以作为很好的API文档，日常开发中也可以把proto文件独立版本库管理，精简目录结构，方便不同的服务引用。</li>
<li>更好的传输效率，通过序列化和反序列化进一步压缩网络传输数据，不过序列化、反序列化也会有一定的性能损耗，protobuf可以说很好的兼顾了这两点。</li>
<li>更合适的容错机制，可以基于实际的业务场景，实现更合适的超时控制与异常重试机制，以应对网络抖动等对服务造成的影响。</li>
</ul>
<p>在一些特定场景，例如：OpenAPI、BFF等，HTTP REST可以更大程度上降低外部团队的接入成本。并且RPC也有调试不便、多语言互通需要对应的SDK支持这些问题，各有利弊。综合考虑来看，除了一些特定场景，如果我们已经有相对完善的基础设施支撑（RPC框架、服务治理），RPC可以为一个更合适的选择。</p>
<h3 id="服务注册-发现" tabindex="-1"> <strong>服务注册/发现</strong></h3>
<p>服务注册主要是通过将微服务的后端机器IP、端口、地域等信息注册起来，并结合一定的发现机制使客户端的请求能够直连具体的后端机器。从实现方式上可以分为服务端模式与客户端模式：</p>
<ul>
<li>服务端模式，也可以说是传统模式，通过借助负载均衡器和DNS实现，负载均衡器负责健康检查、负载均衡策略，DNS负责实现访问域名到负载均衡器IP/VIP的映射。通过直接暴露域名和端口的方式提供客户端访问。</li>
<li>客户端模式，可以借助注册中心实现，注册中心负责服务的注册与健康检查，客户端通过监听配置变更的方式及时把配置中心维护的配置同步到本地，通过客户端负载均衡策略直接向后端机器发起请求。</li>
</ul>
<p>从两种模式的实现方式上可以看出：</p>
<ul>
<li>
<p>服务端模式注册与发现都由服务端完成，这样可以使客户端专注在自身的业务实现，但是由于依赖负载均衡器，也就是集中式的proxy，proxy需要维护双向连接，也很容易使自己成为系统瓶颈，可用性的高低直接决定了服务质量，并且DNS缓存机制也会导致故障发生时，迁移并不能及时完成。当然在服务量少，且负载均衡器有VIP的情况下，我们也可以不使用DNS。</p>
</li>
<li>
<p>客户端模式注册与发现由配置中心和客户端共同完成，通过分布式的方式，可以避免出现proxy节点性能瓶颈问题，但是可靠性与性能瓶颈很容器出现在配置中心上，并且客户端的也需要一定的接入成本。好在开源的已经有很成熟的架构方案与丰富的客户端SDK，例如etcd/ZooKeeper/Consul，Consul提供开箱即用的功能，etcd社区和接入易用性方面更优一些，他们之间的一些具体区别：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16550404961034.jpeg" alt="图片" loading="lazy"></p>
</li>
</ul>
<h3 id="配置中心" tabindex="-1"> <strong>配置中心</strong></h3>
<p>配置中心从使用场景来讲，一类是前边讲到的服务注册、发现和KV存储，例如etcd/ZooKeeper/Consul，在Kubernetes场景下也可以通过ConfigMap/Secret将配置写入本地文件、环境变量或者共享的Volume中，这样没有了中心服务的依赖和客户端的接入，可以实现一些老旧服务的无侵入式改造。但是作为配置中心，除了基础的配置数据，一些情况下还要开放给非开发人员（测试、运维、产品）使用，完善的控制台、权限管理、Dashbord的支持，也非常重要，这类可以参考Nacos（阿里开源）/Apollo（携程开源）。Nacos在读写性能上优于Apollo，但是功能特性（例如权限管理）稍逊于Apollo。</p>
<h3 id="可观察性" tabindex="-1"> <strong>可观察性</strong></h3>
<p>在控制论中，可观察性是用系统输出到外部的信息来推断系统内部运运行状态的一种度量方式</p>
<p>在云原生时代，容器和服务的生命周期是紧密联系在一起的，相较在传统的单体服务运行在物理主机或者虚拟机当中，排查问题的时候显得非常不便，这种复杂性导致了一个定义研发运营效率的MTTR（平均故障修复时间）指标急剧增加。所以这里更强调的是微服务的可观察性，需要提前想好我们要如何观察容器内的服务以及服务之间的拓扑信息、各式指标的搜集等，这些监测能力相当重要。可观察性三大支柱围绕Tracing（链路追踪）、Logging（日志）和Metrics（度量）展开，这三个维度几乎涵盖了应用程序的各种表征行为，开发人员通过收集并查看这三个维度的数据时刻掌握应用程序的运行情况。很长一段时间，这三者是独立存在的，随着时间的推移，这三者已经相互关联，相辅相成。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16550404961035.jpeg" alt="图片" loading="lazy"></p>
<h3 id="链路追踪" tabindex="-1"> <strong>链路追踪</strong></h3>
<p>链路追踪为分布式应用的开发者提供了完整的调用链路还原、调用请求量统计、链路拓扑、应用依赖分析等工具，可以帮助开发者快速分析和诊断分布式应用架构下的性能瓶颈，提高微服务时代下的开发诊断效率以及系统的可观察性。为了解决不同的分布式系统API不兼容的问题，诞生了OpenTracing规范，OpenTracing中的Trace可以被认为是由多个Spacn组成的DAG图。</p>
<div><pre><code>[Span A]  ←←←(the root span)
        |
 +------+------+
 |             |
[Span B]      [Span C] ←←←(Span C 是 Span A 的孩子节点, ChildOf)
 |             |
[Span D]      +---+-------+
           |           |
       [Span E]    [Span F] >>> [Span G] >>> [Span H]
                                   ↑
                                   ↑
                                   ↑
                     （Span G在Span F后被调用，FollowsFrom）
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>OpenTracing专注在tracing，除此之外还有包含了Metrics的OpenCensus标准，以及由CNCF推出，融合OpenTracing和OpenCensus的OpenTelemetry。OpenTelemetry旨在实现云原生时代可观察性指标（Tracing、Logging、Metrics）的统一收集和处理，同时提供推动这些标准实施的组件和工具。OpenTracing中的佼佼者当属Jaeger、Zipkin、Skywalking。他们之间的一些对比：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16550404961036.jpeg" alt="图片" loading="lazy"></p>
<p>Zipkin开源时间长，社区相对丰富，Jaeger更加轻量，也是Istio推荐方案，SkyWalking支持部分语言（Java、PHP、Python等）的无侵入式接入。另外APM（应用性能）监控的支持也会影响到我们的选型。除此之外，面对线上海量请求，如果采用抽样采样策略，那就需要支持一定的流量染色，把我们核心关注的请求（例如链路中发生了错误、部分请求耗时过高等）都进行采样，可以通过结合opentelemetry-collector以及开箱即用的tailsamplingprocessor[1]构建Pipeline插件实现。</p>
<h3 id="日志" tabindex="-1"> <strong>日志</strong></h3>
<p>服务间的链路日志能否帮助我们判断错误发生的具体位置，这类业务日志主要集中在访问日志/打点日志等等。随着大数据的兴起，我们对数据的分析解读能力越来越强，日志作为原始数据则体现出了更大的价值，例如用户的行为分析，反垃圾，舆情分析等等。</p>
<p>业务日志：这类日志重点在于通过不同级别的日志，及时发现分析系统存在的异常，RFC 5424定义的8中日志级别：</p>
<ul>
<li>Emergency：system is unusable</li>
<li>Alert：action must be taken immediately</li>
<li>Critical：critical conditions</li>
<li>Error：error conditions</li>
<li>Warning：warning conditions</li>
<li>Notice：normal but significant condition</li>
<li>Informational：informational messages</li>
<li>Debug：debug-level messages</li>
</ul>
<p>在实际使用过程中可能会对日志级别进行简化和调整，一般来讲Warning及以上的日志是需要重点关注的，需要做好及时的监控告警，Warning以下的日志也可以辅助问题的定位。日志写入可以选择写入消息队列，也可以选择落地磁盘，将关心的结构化或非结构化日志、业务模块信息（如果是细粒度的微服务，可以选择将日志放同一模块收集），以及级别、时间（who、when、where、how、what）等要素正确的写入正确写入后再收集到日志服务。写入消息队列需要考虑消息队列的选型以及做好可用性和积压监控，写入磁盘需要考虑写入性能以及日志的切割清理，例如Golang的zap+rotatelogs组合。日志收集的话，由于Logstash资源消耗相对比较大，虚拟机环境中可以使用Filebeat来替代，更严苛的线上或容器环境，可以使用Fluentd/Fluentd Bit。日志最终汇总到ES和Kibana做展示，通过Esalert定制告警策略。</p>
<p>大数据日志：大数据日志本质上也对应着我们一定的业务场景，但大多是海量日志、高吞吐量场景，所以对海量日志的收集和存储是较大的挑战。实现方案我们可以采用高吞吐量的流式中间件，例如Kafka/Plusar等，在结合流式处理（Flink）或者批处理（Spark）系统，将数据汇总到Hadoop进行分析，这里涉及到的中间件和数据库可参考后续章节。另外，搜索公众号Java架构师技术后台回复“Spring”，获取一份惊喜礼包。</p>
<h3 id="指标3" tabindex="-1"> <strong>指标3</strong></h3>
<p>指标是有关系统的离散的数据点，这些指标通常表示为计数或度量，并且通常在一段时间内进行汇总或计算，一般用来做基础的资源监控和业务监控：</p>
<ul>
<li>资源监控：CPU、内存、IO、fd、GC等</li>
<li>业务监控：QPS、模调、耗时分布等</li>
</ul>
<p>Zabbix作为老牌的监控系统，适合更复杂的物理机、虚拟机、数据库等更复杂的场景，同时也拥有更丰富的图形化界面，但是Prometheus作为云原生的代表作，与Kubernetes、容器等能更好的结合，协同Grafana实现可定制化的界面，另外存储基于TSDB，相比于关系型数据库也有更好的扩展性。以Prometheus为例，支持的数据类型有：</p>
<ul>
<li>Counter只增不减的计数器，例如请求数（http_requests_total）。基于此数据模型，使用Prometheus提供的强大PromQL表达式能够拓展出更加适合开发观察的指标数据。分钟增量请求：increase(http_requests_total[1m]) 分钟QPS：rate(http_requests_total[1m])</li>
<li>Gauge可增可减的时刻量，例如Go语言协程数（go_goroutines） 波动量：delta(go_goroutines[10m])</li>
<li>Histogram直方图，不同区间内样本的个数。例如，耗时50ms-100ms每分钟请求量，100ms-150ms每分钟请求量。</li>
<li>Summary 概要，反应百分位值。例如，某RPC接口，95%的请求耗时低于150ms，99%的请求耗时低于200ms。</li>
</ul>
<h3 id="service-mesh" tabindex="-1"> <strong>Service Mesh</strong></h3>
<p>Service Mesh这个服务网格专注于处理服务和服务之间的通信，包括我们前边讲的服务发现、熔断降级、安全、流量控制、可观察性等能力。这些通用能力在Service Mesh出现之前，由Lib/Framework完成，这样就可以在开发层面上很容易地集成到我们的应用服务中。但是并没有办法实现跨语言编程，有什么改动后，也需要重新编译重新发布服务。理论上应该有一个专门的层来干这事，于是出现了Sidecar，Sidecar集群就成了Service Mesh，加上对整个集群的管理控制面板，就成了现在的Service Mesh架构，可以说Service Mesh是云原生时代的必然产物。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16550404961037.jpeg" alt="图片" loading="lazy"></p>
<p>目前比较流行的Service Mesh开源软件是Istio和Linkerd，还有更加轻量级的Conduit，它们都可以在Kubernetes中集成。Istio基于Golang编写，使用Envoy作为Sidecar，在服务治理方面职责分明，国内落地案例相较Linkerd 、Conduit更加广泛。由于Service Mesh承担了服务核心的流量调度环节，再给我们带来便利的同时，也引入很多的不可控因素，例如：Sidecar组件不可用，将直接导致系统出现致命问题。所以在充分做好服务可观察性的前提下，也要保证Service Mesh的高可用，一种比较好的方式是，除了在本机有 Sidecar，我们还可以部署一下稍微集中一点的 Sidecar——比如为某个服务集群部署一个集中式的 Sidecar。一旦本机的有问题，可以走集中的。</p>
<h2 id="消息队列" tabindex="-1"> 消息队列</h2>
<p>在计算机科学中，消息队列（英语：Message queue）是一种进程间通信或同一进程的不同线程间的通信方式，软件的贮列用来处理一系列的输入，通常是来自用户。消息队列提供了异步的通信协议，每一个贮列中的纪录包含详细说明的数据，包含发生的时间，输入设备的种类，以及特定的输入参数，也就是说：消息的发送者和接收者不需要同时与消息队列交互。消息会保存在队列中，直到接收者取回它。</p>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzAwNjQwNzU2NQ==&amp;mid=2650360380&amp;idx=1&amp;sn=3a97f6d7ae39fea666416a92b1801ce2&amp;chksm=83003edeb477b7c8f34536fc00378008eefc2910d6c5853d9668a3017d70df5414f0bb693539&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16550404961038.png" alt="图片" loading="lazy"></a></p>
<p>实际应用场景中，消息队列也经常作为中间件，用于异步解耦、削峰填谷、数据广播、错峰与流控、最终一致性等，在一些核心的大数据分析、交易支付等场景也经常扮演重要角色，消息队列的选型主要侧重以下几点：</p>
<ul>
<li>HA：自身的高可用性保障，避免消息队列的引入而影响整体服务的可用性</li>
<li>高吞吐：在面对海量数据写入能否保持一个相对稳定、高效的数据处理能力</li>
<li>功能丰富性：是否支持延迟消息、事务消息、死信队列、优先级队列等</li>
<li>消息广播：是否支持将消息广播给消费者组或者一组消费者</li>
<li>消息堆积能力：在数据量过大时，是否允许一定消息堆积到broker</li>
<li>数据持久性：数据持久化策略的采用，也决定着数据在宕机恢复后是否会丢失数据</li>
<li>重复消费：是否支持ack机制，在消费者未正确处理消息时，支持重新消费</li>
<li>消息顺序性：针对顺序消费的场景保证数据按写入时间的顺序性</li>
</ul>
<p>这里着重对比一下Redis、RabbitMQ/RocketMQ、Kafka、Plusar。</p>
<h3 id="redis" tabindex="-1"> <strong>Redis</strong></h3>
<p>Redis实现消息队列可以通过List类型、Pub/Sub、Stream（Redis 5.0）类型来实现，HA使用多副本或者集群的方式。作为消息队列使用起来非常方便，但是也有很多的弊端：</p>
<ul>
<li>功能丰富性：只支持普通的消息类型</li>
<li>数据持久性：Pub/Sub只提供缓冲区广播能力，不进行持久化，List/Stream即使基于aof和rdb持久化策略，但是并没有事务性保障，在宕机恢复后还是存在丢失数据的可能性</li>
<li>消息堆积能力：List随长度增大，内存不断增长；Pub/Sub只在缓冲区内堆积，缓冲区满消费者强制下线；Stream创建时可以指定队列最大长度，写满后剔除旧消息</li>
</ul>
<p>除此之外，List类型无法支持消息广播，和Pub/Sub一样也不支持重复消费。结合整体来看Redis作为消息队列大多数只应用在数据量小，对丢失数据不敏感的业务场景，适用范围较小，复杂业务并且有一定运维支撑的情况下，可以直接考虑企业级消息中间件。</p>
<h3 id="rabbitmq-vs-kafka-vs-rocketmq" tabindex="-1"> <strong>RabbitMQ vs Kafka vs RocketMQ</strong></h3>
<p>这几个可以作为企业级消息中间件的代表，RabbitMQ和kafka的一些详细对比，可以参考之前写的这篇文章《消息队列RabbitMQ与Kafka对比分析[2]》。而RocketMQ在设计之初就借鉴了很多RabbitMQ、Kafka的设计理念，例如：Routing、多副本、顺序写（IO），也广泛应用在淘宝双十一等场景。</p>
<h3 id="ha" tabindex="-1"> <strong>HA</strong></h3>
<p>在HA方面他们都是通过副本的方式，区别是RabbitMQ是集群级别的副本，Kafka是多partiton和ISR、选举机制，而RocketMQ通过多（master/slave）副本同时保障NameServer和Broker。</p>
<h3 id="高吞吐" tabindex="-1"> <strong>高吞吐</strong></h3>
<p>Kafka和RocketMQ通过直接操作文件系统，相比于RabbitMQ，顺序写能大幅度提升数据的处理速度。Kafka为了进一步提升消息的吞吐量，可以采用客户端缓冲队列的方式批量发送，但也会存在宕机丢失数据的可能性，可以通过设置batch.size与linger.ms来动态调整，相比于RocketMQ更加灵活。Kafka的partition机制的确会带来性能的提升，但是在Topic不断增多的情况下，众多的partition及副本也将顺序写逐步退化为随机写，并且扩容时，由于hash值的变化，也会涉及到大量partiton数据的迁移。RocketMQ采用commitlog的方式实现全局写，所以能支持更多的Topic，扩容也不涉及大量数据的迁移。</p>
<h3 id="功能丰富性" tabindex="-1"> <strong>功能丰富性</strong></h3>
<p>Kafka只有基础的消息类型，RabbitMQ支持优先级队列，通过TTL和死信队列可以实现消息的延迟和重试，但是需要提前创建好对应重试频率的队列，例如：1s重试队列，10s重试队列，RocketMQ则内置了18个重试频率“1s 5s 10s 30s 1m 2m……”，另外也具有独有的2PL事务消息，很好的保障业务逻辑与消息发送的一致性。</p>
<h3 id="重复消费" tabindex="-1"> <strong>重复消费</strong></h3>
<p>他们三者都采用ACK机制保障了单条消息重复消费的能力，Kafka通过offset和partition特殊的ttl机制（segment过期，按文件名顺序清理），能支持通过重置offset来回溯历史数据。</p>
<h3 id="消息顺序性" tabindex="-1"> <strong>消息顺序性</strong></h3>
<p>RabbitMQ和RocketMQ可以保证写入同一topic的顺序性，但是在多个消费者同时消费的情况下还是会出现乱序的情况，在数据量较大的时候，我们也可以通过单个消费者消费，再按照一定的分发策略分配给多个消费者执行，只不过会提升整体复杂度，同时会带来更多的HA、维护成本考量。Kafka可以保障单个partition的顺序性，并且每个partiton只允许一个消费者来消费（N：1），这就从策略上避免了多消费者的情况，在数据量较大的情况下，可以通过划分更多的partition提升数据处理能力。综合来讲，RabbitMQ、RocketMQ使用Queue模型，丰富的消息队列功能，更多的应用在业务场景，Kafka基于Streaming模型，结合批处理、流式处理，更多的应用在大数据分析场景。</p>
<h3 id="pulsar" tabindex="-1"> <strong>Pulsar</strong></h3>
<p>Pulsar作为Apache开源、云原生的消息中间件，诞生之初就引发了很大的关注。设计上避免了Kafka遇到的功能丰富性、扩容等方面的问题，采用计算、存储分离的架构，broker层只作为“API接口层”，存储交给更专业的bookeeper，由于broker层的无状态性，结合Kubernetes等非常方便的进行扩容。并且Pulsar支持多个消费模型提升消费者处理能力，例如：exclusive、failover、shared、key-shared等，可以说综合了Kafka和其他消息中间件的众多优点。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16550404961039.jpeg" alt="图片" loading="lazy"></p>
<ul>
<li>HA、高吞吐：和Kafka类似，通过多partition和选举机制功，除此之外，还支持丰富的跨地域复制能力</li>
<li>功能丰富性：可以支持秒级的延迟消息，以及独特的重试队列和私信队列</li>
<li>消息顺序性：为了实现partition消息的顺序性，和Kafka一样，都需要将消息写入到同一broker，区别是Kafka会同时存储消息在该broker，broker和partiton绑定在一起，而Pulsar可以将消息分块（segment）后，更加均匀的分散到bookeeper节点上，broker只需要记录映射关系即可，这样在资源扩容时，可以更加快速便捷</li>
</ul>
<p>像能量守恒定律一样，系统的复杂度往往也是守恒的，实现即高性能又高可用的消息中间件需要的技术复杂性，不会凭空消失，只会从一个地方转移到另一个地方，消息队列本质上可以理解为feature+fs，只不过存储、计算分离架构，将各层间的职责分离，使每一层都能专注在自身领域，以应对海量数据和更加复杂多变的环境，这也是现在新技术发展的一个趋势。作为后起之秀，的确可以站在巨人的肩膀上，避免很多设计上的不足，同时引入一些新的架构理念，但是要成功的在其中分一杯羹，同样也要面临用户学习成本高、缺少杀手级应用、如何迁移等等这些现实性的问题，不过依靠良好的社区和技术先驱，随着时间的变迁，这些短板也会逐步补齐，真正适应当前时代的技术一定会脱颖而出。ps：腾讯云最近开源Rop[3]，支持RocketMQ相对平滑的迁移至Pulsar</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-25T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Github技巧</title>
    <id>https://blog.ciberviler.top/other/Github%E6%8A%80%E5%B7%A7.html</id>
    <link href="https://blog.ciberviler.top/other/Github%E6%8A%80%E5%B7%A7.html"/>
    <updated>2022-06-12T02:41:10.000Z</updated>
    <content type="html"><![CDATA[<h1 id="github技巧" tabindex="-1"> Github技巧</h1>
<h2 id="_1-搜索" tabindex="-1"> 1.搜索</h2>
<p>github高级搜索功能</p>
<p>直接打开这里<a href="https://github.com/search/advanced" target="_blank" rel="noopener noreferrer">GitHub · Where software is built</a></p>
<p>或搜索后在搜索页面 language 下方打开（没找到更好的方法）</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220504225139153-165500134904917.png" alt="image-20220504225139153" loading="lazy"></p>
<p>更多技巧可查看官方文档：</p>
<p><a href="https://docs.github.com/cn/search-github/getting-started-with-searching-on-github/about-searching-on-github" target="_blank" rel="noopener noreferrer">About searching on GitHub - GitHub Docs</a></p>
<p><a href="https://docs.github.com/cn/search-github/searching-on-github/searching-code" target="_blank" rel="noopener noreferrer">搜索代码 - GitHub Docs</a></p>
<h2 id="_2-查找文件" tabindex="-1"> 2.查找文件</h2>
<p>在主页按“t”：查找文件</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220504225403858-165500134905018.png" alt="image-20220504225403858" loading="lazy"></p>
<p>点进源代码后，按“l”：跳转到某一行</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220504225816271.png" alt="image-20220504225816271" loading="lazy"></p>
<p>点击行号：</p>
<ol>
<li>复制这行代码</li>
<li>生成永久链接</li>
</ol>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220504225652318.png" alt="image-20220504225652318" loading="lazy"></p>
<p>源代码中按“b”：查看文件的改动记录</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220504225932440-165500134905019.png" alt="image-20220504225932440" loading="lazy"></p>
<p>键盘快捷键：</p>
<ul>
<li>
<p>文档</p>
<p><a href="https://docs.github.com/cn/get-started/using-github/keyboard-shortcuts" target="_blank" rel="noopener noreferrer">键盘快捷键 - GitHub Docs</a></p>
<p><a href="https://coderwall.com/p/ln-ira/github-markdown-cheat-sheet" target="_blank" rel="noopener noreferrer">GitHub Markdown Cheat Sheet (Example)</a></p>
</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/gs-165500134905020.png" alt="Picture" loading="lazy"></p>
<h2 id="_3-阅读代码技巧" tabindex="-1"> 3.阅读代码技巧</h2>
<p>代码跳转：</p>
<ol>
<li>下载到本地</li>
<li>在线vscode：仓库详情界面按下“。”键，</li>
</ol>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220504230504057-165500134905021.png" alt="image-20220504230504057" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220504230630070-165500155568446.png" alt="image-20220504230630070" loading="lazy"></p>
<h2 id="_4-在线运行项目" tabindex="-1"> 4.在线运行项目</h2>
<p>在项目地址前加上<code>gitpod.io/#/</code>前缀</p>
<p><a href="https://github.com/nginx/nginx" target="_blank" rel="noopener noreferrer">https://github.com/nginx/nginx</a> =&gt; <a href="https://gitpod.io/#/github.com/nginx/nginx" target="_blank" rel="noopener noreferrer">https://gitpod.io/#/github.com/nginx/nginx</a></p>
<p>登陆：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220504230740420.png" alt="image-20220504230740420" loading="lazy"></p>
<p>加载：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220504230844063-165500134905023.png" alt="image-20220504230844063" loading="lazy"></p>
<p>运行：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220504230956747-165500134905024.png" alt="image-20220504230956747" loading="lazy"></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-24T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">MyEclipsev2021永久激活版</title>
    <id>https://blog.ciberviler.top/dev/MyEclipse.html</id>
    <link href="https://blog.ciberviler.top/dev/MyEclipse.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">MyEclipsev2021永久激活版</summary>
    <content type="html"><![CDATA[<h1 id="myeclipsev2021永久激活版" tabindex="-1"> MyEclipsev2021永久激活版</h1>
<h3 id="激活码" tabindex="-1"> 激活码</h3>
<p>1、zLR8ZC-855575-6154505816197416
2、3LR8ZC-855575-61567256274007429
3、zLR8ZC-855575-61567256215416341
4、3LR8ZC-855575-61567256646682235
5、zLR8ZC-855575-61567256903775584
6、oLR8ZC-855575-77665356722269248
7、fLR8ZC-855575-7766535033841152
8、gLR8ZC-855575-78507056841444089
9、GLR8ZC-855575-7850705925145157</p>
<h3 id="软件特色" tabindex="-1"> 软件特色</h3>
<p>【企业级开发】
软件为完成工作提供了智能的企业工具。Java EE库和功能是企业级项目的基础，支持部署到几十个企业友好的应用服务器进行快速检测。
【Java Web开发】
有了它，你就拥有了所有的Web开发技术。支持快速添加技术功能到Web项目中，使用可视化编辑器以便编码和配置，并且还可以在多种应用服务器上测试你的任务。
【云开发】
脱离缓存，使用内置功能连接到云，支持探索和连接服务，为他人提供自己的REST Web服务。无论是定位还是虚拟的微博，它都能轻松地创建云连接。
【移动开发】
移动应用开发再也无需使用特殊工具或学习新的编程语言。软件支持使用Java、HTML和JQuery进行编码，使用移动工具创建拥有良好编码的应用，并嵌入到原生iOS和Android应用中。</p>
<h3 id="myeclipse2021破解教程" tabindex="-1"> MyEclipse2021破解教程</h3>
<p>1、在软件学堂下载软件安装包，并对压缩包进行解压得到安装程序和破解文件。
2、然后双击运行软件安装程序，按照安装向导进行安装。
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/202106280930579127.jpg" alt="img" loading="lazy">
3、接受软件安装协议，点击Next进行下一步。
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/202106280931029971.jpg" alt="img" loading="lazy">
4、选择软件安装位置，一般默认安装在c盘，用户也可自定义选择其他位置，注意千万不要出现中文目录。
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/202106280931116442.jpg" alt="img" loading="lazy">
5、软件正在安装中，请用户耐心等待。
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/202106280931181934.jpg" alt="img" loading="lazy">
6、待到安装完成后，退出安装向导。
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/202106280931248968.jpg" alt="img" loading="lazy">
7、接下来进入软件主界面，在弹出注册界面，点击Enter License默认进入。
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/202106280931301641123212.jpg" alt="img" loading="lazy">
8、然后将软件包中的注册码输入到该界面中，再点击Enable Now。
9、接着载点击Activate Now即可完成激活啦。
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/202106280931445590.jpg" alt="img" loading="lazy"></p>
<h3 id="功能介绍" tabindex="-1"> 功能介绍</h3>
<p>1、优化JavaEE开发
确保企业开发使用的是MyEclipse中当前最新的JavaEE技术，并且它强大的功能随时可用。
2、保持厂商中立
如果IBMWebSphere是你企业开发的重要组成部分，那么厂商锁定肯定会阻碍你的选择。你可以让开发更加自由，为WebSphere开发提供了工具，并支持大量的其他关键性技术。
3、RESTfulWeb服务开发
支持使用RESTweb服务创建云应用。使用REST特殊工具生成和测试添加到应用中的服务。
4、项目工作流中保持Maven
通过标准的Maven项目架构和菜单内置的启动命令，你可以在当前IDE下使用Maven管理项目。</p>
<h3 id="myeclipse-eclipse使用教程" tabindex="-1"> MyEclipse/Eclipse使用教程</h3>
<p>设置工作空间编码格式
点击Windows → preference → WorkSpace
或者搜索workspace
选择编码格式，默认为GBK，不过选择UTF-8为好。
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/202107091052554606.jpg" alt="img" loading="lazy">
成功更改工作空间编码之后，如果对默认字体不适应，可以选择更改字体。
更改字体
点击Windows → preference → General →Appearence → Color and Fonts → Basic
或者搜索Colors and fonts
选择 Text font ，点击Edit编辑，就可以更改字体了，选择合适的就行。
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/202107091053019148.jpg" alt="img" loading="lazy">
字体设置完之后，最好顺便设置下注释模版，注释模版就是在使用/** <em>/这种注释的时候，会自动按照所设置的注释模版注释。注释是个好习惯。
设置注释模版
Class类的注释模板打开Eclipse/MyEclipse工具，点击 Window-&gt;<a href="http://www.xue51.com/zt/Premierebbdq/" target="_blank" rel="noopener noreferrer">Pr</a>eferences弹出首选项设置窗口，Java-&gt;Code Style-&gt;Code Template选项列表，点击Types。
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/20210709105305842.jpg" alt="img" loading="lazy">
可以输入/<strong>，然后回车或按shift+alt+j快捷键补齐注释内容。
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/202107091053091687.jpg" alt="img" loading="lazy">
注释模版代码:
1、/</strong>
2、</em> Title: ${type_name}
3、* Description:
4、* Version:1.0.0
5、* @author ${user}
6、* @date ${date}
7、*/</p>
<h3 id="常用快捷建" tabindex="-1"> 常用快捷建</h3>
<p>Ctrl+H 全局搜索
Ctrl+F 本类搜索以及替换
Ctrl+shift+R 搜索文件
shift+tab 整体代码向左移
ctrl+shift+↓ 复制当前代码并向下移一行ctrl+shift+R 搜索文件
ctrl+H 搜索所有文件包括代码
ctrl+f 搜索当前页面存盘
Ctrl+s(肯定知道)注释代码
Ctrl+/取消注释
Ctrl+1 快速修复
Ctrl+L 定位在某行
Ctrl+O 快速显示 OutLine
Ctrl+T 快速显示当前类的继承结构
Ctrl+W 关闭当前Editer
Ctrl+K 快速定位到下一个
Ctrl+E 快速显示当前Editer的下拉列表
Ctrl+J 正向增量查找
Ctrl+D: 删除当前行
Ctrl+Alt+↓ 复制当前行到下一行(复制增加)
Ctrl+Alt+↑ 复制当前行到上一行(复制增加)</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-01-22T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理</title>
    <id>https://blog.ciberviler.top/dev/SpringBoot.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringBoot.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理</summary>
    <content type="html"><![CDATA[<h1 id="springboot-拦截器-自定义异常-自定义注解-全局异常处理" tabindex="-1"> SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理</h1>
<ul>
<li>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">前言</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">资源权限</a></p>
</li>
<li>
<ul>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">1.静态资源准备</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">2.自定义一个异常，便于拦截抛出</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">3.全局异常处理</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">4.controller层</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">5.拦截器创建</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">6.将拦截器注入应用</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">7.验证查看结果</a></li>
</ul>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">操作权限</a></p>
</li>
<li>
<ul>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">1.和上面一样使用静态资源</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">2.自定义注解</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">3.controller层</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">4.修改一下之前的拦截器</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">5.验证结果</a></li>
</ul>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">角色权限</a></p>
</li>
<li>
<ul>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">1.静态对应关系</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">2.修改controller</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">3.修改一下拦截器</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">4.结果测试</a></li>
</ul>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&amp;scene=21&amp;token=899450012&amp;lang=zh_CN#wechat_redirect" target="_blank" rel="noopener noreferrer">总结</a></p>
</li>
</ul>
<hr>
<h2 id="前言" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">前言</a></h2>
<p>提到权限管理这块肯定很多人第一想到的就是Springboot Security或者是Shiro安全框架，但本文介绍的并不是这两种，不是因为他们不好用，实在是自己太懒了，我觉得一个拦截器加上其他的一些处理就能满足项目的需求，我又何必去多用一个框架呢，这篇文章也不是去对比谁好谁坏，各位自行抉择。</p>
<p>我将权限管理分为三块：</p>
<ol>
<li><strong>资源权限</strong> ：将url当做资源，可以给每个账号动态划分Url权限，访问不同的URl；</li>
<li><strong>操作权限</strong> ：将所有URL分为增、删、改、查4种操作权限，给用户分配对应的操作权限，如某个用户只有查操作权限那么他就无法做其他的操作；</li>
<li><strong>角色权限</strong> ：系统有多个角色，每个角色的权限都不同，如一个管理后台有着账号管理模块、商品模块等，为超级管理员的角色就可以看到所有模块并操作，而为售后的角色就只能看到商品模块，即使他知道账号管理模块下的URL也无权限操作。然后为用户设置角色就有对应的权限；</li>
</ol>
<blockquote>
<p>“</p>
<p>推荐下自己做的 Spring Boot 的实战项目：</p>
<p><a href="https://github.com/YunaiV/ruoyi-vue-pro" target="_blank" rel="noopener noreferrer">https://github.com/YunaiV/ruoyi-vue-pro</a></p>
</blockquote>
<h2 id="资源权限" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">资源权限</a></h2>
<h3 id="_1-静态资源准备" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">1.静态资源准备</a></h3>
<p>这里方便演示就不直接操作数据库了，对应的权限建表关系也很简单，这里直接建立静态的用户对应的URL关系。</p>
<div><pre><code>public class Constant {
    /**
     * 权限管理
     */
    public static Map&lt;Integer,String[]> permission=new HashMap&lt;>();
    static {
        String[] frist={"/url1","/url2","/url3","/url4","/url5","/url6","/url7"};//用户1所拥有的URL权限
        String[] second={"/url1","/url2","/url3","/url4","/url5"};//用户2所拥有的URL权限
        String[] third={"/url1","/url2","/url3"};//用户3所拥有的URL权限
        permission.put(1,frist);
        permission.put(2,second);
        permission.put(3,third);

    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_2-自定义一个异常-便于拦截抛出" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">2.自定义一个异常，便于拦截抛出</a></h3>
<div><pre><code>public class APIException extends RuntimeException {
    private static final long serialVersionUID = 1L;
    private String msg;
    public APIException(String msg) {
        super(msg);
        this.msg = msg;
    }

}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_3-全局异常处理" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">3.全局异常处理</a></h3>
<p>便于异常后返回统一规范的结果,正常应该是正常返回自定义Vo，但这里目标是为了演示结果，再加上各位应该都有自己的Vo类，所以这里就不用了</p>
<div><pre><code>@RestControllerAdvice
public class WebExceptionControl {
    
    @ExceptionHandler(APIException.class)
    public String APIExceptionHandler(APIException e) {
        return e.getMessage();
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_4-controller层" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">4.controller层</a></h3>
<p>很简单创建对应的URL就好</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241051.webp" alt="图片" loading="lazy"></p>
<h3 id="_5-拦截器创建" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">5.拦截器创建</a></h3>
<p>一般是要先验证token，后根据token取到用户对应信息，这里没有登录所以就直接在token里传对应用户的key值了</p>
<div><pre><code>/**
 * 权限管理URL拦截器
 */
public class URLInterceptor implements HandlerInterceptor {

    // 预处理回调方法，在接口调用之前使用  true代表放行  false代表不放行
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {
        HttpServletRequest httpServletRequest = (HttpServletRequest) request;
        String token = httpServletRequest.getHeader("token");
        String requestURL = httpServletRequest.getRequestURI();
        //1.根据token判断用户是否登录
        if (token==null){   //正常情况下这里还需判断与redis中的token是否匹配
            // 如果没有token或者token不匹配, 直接抛出异常  提示未登录
            throw  new APIException("当前用户未登录");
        }
        //2.登录成功后 根据用户token中的信息获取到用户对应的URL权限集合
        String[] strings = Constant.permission.get(Integer.valueOf(token));
        boolean hasPermission = false;
        //3.再根据用户对应的URL集合去与当前请求的URL对比  有匹配的则放行  反之则抛出异常
        for (int i =0;i&lt;strings.length;i++) {
            if (strings[i].equals(requestURL)){
                hasPermission = true;
                break;
            }
        }
        if (hasPermission){
            return true;
        }else {
            throw  new APIException("当前用户没有访问路径" + requestURL + "的权限");
        }
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_6-将拦截器注入应用" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">6.将拦截器注入应用</a></h3>
<div><pre><code>@Configuration
public class WebMvcConfg implements WebMvcConfigurer {

    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        //权限拦截器
        registry.addInterceptor(urlInterceptor()).addPathPatterns("/**");
    }
    @Bean
    public URLInterceptor urlInterceptor(){
        return new URLInterceptor();
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_7-验证查看结果" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">7.验证查看结果</a></h3>
<p>分别在token中传入用户1-3的key，访问不同url就可以看到效果，如下</p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241052.webp" alt="图片" loading="lazy"></a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241053.webp" alt="图片" loading="lazy"></a></p>
<blockquote>
<p>“</p>
<p>推荐下自己做的 Spring Cloud 的实战项目：</p>
<p><a href="https://github.com/YunaiV/onemall" target="_blank" rel="noopener noreferrer">https://github.com/YunaiV/onemall</a></p>
</blockquote>
<h2 id="操作权限" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">操作权限</a></h2>
<h3 id="_1-和上面一样使用静态资源" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">1.和上面一样使用静态资源</a></h3>
<div><pre><code>public class Constant {
    /**
     * 权限管理
     */
    public static Map&lt;Integer,String[]> permission=new HashMap&lt;>();
    static {
        String[] frist={"insert","delete","select","update"};//用户1所拥有的操作权限
        String[] second={"insert","select","update"};//用户2所拥有的URL权限
        String[] third={"select"};//用户3所拥有的URL权限
        permission.put(1,frist);
        permission.put(2,second);
        permission.put(3,third);

    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_2-自定义注解" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">2.自定义注解</a></h3>
<div><pre><code>@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface UrlAnnotation {
    /**
     * 操作类型(type):添加,删除,修改,插入
     * 
     */
    String type();
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_3-controller层" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">3.controller层</a></h3>
<p>打上自定义的注解，代表对应方法是什么操作</p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241054.webp" alt="图片" loading="lazy"></a></p>
<h3 id="_4-修改一下之前的拦截器" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">4.修改一下之前的拦截器</a></h3>
<p>添加对注解上面的操作类型的获取，并用type类型去对比判断</p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241055.webp" alt="图片" loading="lazy"></a></p>
<h3 id="_5-验证结果" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">5.验证结果</a></h3>
<p>其他都不变</p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241056.webp" alt="图片" loading="lazy"></a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241157.webp" alt="图片" loading="lazy"></a></p>
<h2 id="角色权限" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">角色权限</a></h2>
<p>这里其实和上面的操作大同小异，我这里简单演示一下，以两个模块为例</p>
<h3 id="_1-静态对应关系" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">1.静态对应关系</a></h3>
<div><pre><code>public class Constant {
    /**
     * 权限管理
     */
    public static Map&lt;Integer,String[]> permission=new HashMap&lt;>();
    static {
        String[] frist={"test","test1"};//用户1所拥有的模块权限  这里的test是模块URL入口  例如：test模块下所有URL都是/test/**
        String[] second={"test"};//用户2所拥有的模块权限
        permission.put(1,frist); //这里的1其实是用户对应ID为1的角色
        permission.put(2,second);//这个2同理

    }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_2-修改controller" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">2.修改controller</a></h3>
<p>模拟两个模块</p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241158.webp" alt="图片" loading="lazy"></a></p>
<h3 id="_3-修改一下拦截器" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">3.修改一下拦截器</a></h3>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241159.webp" alt="图片" loading="lazy"></a></p>
<h3 id="_4-结果测试" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">4.结果测试</a></h3>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241160.webp" alt="图片" loading="lazy"></a></p>
<h2 id="总结" tabindex="-1"> <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">总结</a></h2>
<p>其实用自定义的拦截器去做权限，不管是什么类型其实都大同小异，根据需求灵活的去处理才是最重要的，上面的静态权限变通一下，建立角色表、用户表、路径表以及对应关系，就很容易做出URL的动态权限配置了，灵活运用自定义注解搭配可以做到更细致。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-01-15T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Openssl一键自签证书</title>
    <id>https://blog.ciberviler.top/dev/openssl%E4%B8%80%E9%94%AE%E8%87%AA%E7%AD%BE%E8%AF%81%E4%B9%A6.html</id>
    <link href="https://blog.ciberviler.top/dev/openssl%E4%B8%80%E9%94%AE%E8%87%AA%E7%AD%BE%E8%AF%81%E4%B9%A6.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">Openssl一键自签证书</summary>
    <content type="html"><![CDATA[<h1 id="openssl一键自签证书" tabindex="-1"> Openssl一键自签证书</h1>
<p><code>vim openssl.sh</code></p>
<div><pre><code><span>#!/bin/bash</span>
<span>while</span> <span>[</span><span>[</span> -z <span>"<span>$domain</span>"</span> <span>]</span><span>]</span><span>;</span><span>do</span>
    <span>read</span> -p <span>"输入域名/IP(必填,如 *.haoduck.com): "</span> domain
<span>done</span>
<span>read</span> -p <span>"输入邮箱(选填,默认admin@haoduck.com): "</span> mail
<span>[</span><span>[</span> -z <span>"<span>$mail</span>"</span> <span>]</span><span>]</span> <span>&amp;&amp;</span> <span>mail</span><span>=</span>admin@haoduck.com
<span>read</span> -p <span>"输入日期(选填,默认3650): "</span> day
<span>[</span><span>[</span> -z <span>"<span>$day</span>"</span> <span>]</span><span>]</span> <span>&amp;&amp;</span> <span>day</span><span>=</span><span>3650</span>
<span>dir</span><span>=</span><span>$domain</span> <span>&amp;&amp;</span> <span>mkdir</span> -p <span>$dir</span>
<span>crt_file</span><span>=</span><span>"<span>$dir</span>/<span>${domain}</span>.crt"</span>
<span>key_file</span><span>=</span><span>"<span>$dir</span>/<span>${domain}</span>.key"</span>
<span>if</span> <span>[</span><span>[</span> <span>"<span><span>$(</span><span>command</span> -v openssl<span>)</span></span>"</span> <span>]</span><span>]</span><span>;</span><span>then</span>
    openssl req -x509 -nodes -newkey rsa:2048 -days <span>$day</span> -keyout <span>$key_file</span> -out <span>$crt_file</span> -subj <span>"/C=US/ST=California/L=Los Angeles/O=Haoduck/OU=Aoao/CN=<span>${domain}</span>/emailAddress=<span>${mail}</span>"</span>
    <span>echo</span> -e <span>"<span title="\t">\t</span>证书：<span><span>$(</span><span>pwd</span><span>)</span></span>/<span>$crt_file</span><span title="\n">\n</span><span title="\t">\t</span>私钥：<span><span>$(</span><span>pwd</span><span>)</span></span>/<span>$key_file</span>"</span>
<span>else</span>
    <span>echo</span> <span>"openssl 未安装"</span>
<span>fi</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><code>bash openssl.sh</code></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-01-18T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">SpringBoot打包不同环境配置与shell脚本部署</title>
    <id>https://blog.ciberviler.top/dev/springboot%E6%89%93%E5%8C%85%E4%B8%8D%E5%90%8C%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E4%B8%8Eshell%E8%84%9A%E6%9C%AC%E9%83%A8%E7%BD%B2.html</id>
    <link href="https://blog.ciberviler.top/dev/springboot%E6%89%93%E5%8C%85%E4%B8%8D%E5%90%8C%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E4%B8%8Eshell%E8%84%9A%E6%9C%AC%E9%83%A8%E7%BD%B2.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">SpringBoot打包不同环境配置与shell脚本部署</summary>
    <content type="html"><![CDATA[<h1 id="springboot打包不同环境配置与shell脚本部署" tabindex="-1"> SpringBoot打包不同环境配置与shell脚本部署</h1>
<p>本篇和大家分享的是springboot打包并结合shell脚本命令部署，重点在分享一个shell程序启动工具，希望能便利工作；</p>
<ul>
<li>profiles指定不同环境的配置</li>
<li>maven-assembly-plugin打发布压缩包</li>
<li>分享shenniu_publish.sh程序启动工具</li>
<li>linux上使用shenniu_publish.sh启动程序</li>
</ul>
<h1 id="profiles指定不同环境的配置" tabindex="-1"> profiles指定不同环境的配置</h1>
<p>通常一套程序分为了很多个部署环境：开发，测试，uat，线上 等，我们要想对这些环境区分配置文件，可以通过两种方式：</p>
<ul>
<li>通过application.yml中编码指定 profile.active=uat 方式指定</li>
<li>通过mvn中profiles来区分不同环境对应的配置文件夹，人工可以手动在idea勾选生成不同环境的包(推荐)</li>
</ul>
<p>这里我们要讲的是第二种，首先在mvn中配置如下内容：</p>
<div><pre><code> 1     &lt;profiles>
 2         &lt;profile>
 3             &lt;id>node&lt;/id>
 4             &lt;properties>
 5                 &lt;!--传递给脚本的参数值-->
 6                 &lt;activeProfile>node&lt;/activeProfile>
 7                 &lt;package-name>${scripts_packageName}&lt;/package-name>
 8                 &lt;boot-main>${scripts_bootMain}&lt;/boot-main>
 9             &lt;/properties>
10             &lt;activation>
11                 &lt;activeByDefault>true&lt;/activeByDefault>
12             &lt;/activation>
13         &lt;/profile>
14         &lt;profile>
15             &lt;id>node1&lt;/id>
16             &lt;properties>
17                 &lt;activeProfile>node1&lt;/activeProfile>
18                 &lt;package-name>${scripts_packageName}&lt;/package-name>
19                 &lt;boot-main>${scripts_bootMain}&lt;/boot-main>
20             &lt;/properties>
21         &lt;/profile>
22         &lt;profile>
23             &lt;id>node2&lt;/id>
24             &lt;properties>
25                 &lt;activeProfile>node2&lt;/activeProfile>
26                 &lt;package-name>${scripts_packageName}&lt;/package-name>
27                 &lt;boot-main>${scripts_bootMain}&lt;/boot-main>
28             &lt;/properties>
29         &lt;/profile>
30     &lt;/profiles>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>节点粗解：</p>
<ul>
<li>id：用来指定不同环境配置文件所在的目录，如下我这里：
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/fe69f622e6fd659b563e79a848403dcac97db44d.png" alt="image" loading="lazy"></li>
<li>properties：该节点中的节点是可作为参数传递给其他配置文件，如我这里的package-name节点值就可以在另外的assembly.xml或者shell脚本文件中通过${package-name}获取到，如下：
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/fd2638a541ecddb2844197770587337bfa4bcc29.png" alt="image" loading="lazy"></li>
<li>activeByDefault：指定默认环境配置文件夹</li>
</ul>
<h1 id="maven-assembly-plugin打发布压缩包" tabindex="-1"> maven-assembly-plugin打发布压缩包</h1>
<p>对于springboot程序打包，可以分为jar和war，这里是jar包；有场景是咋们配置文件或者第三方等依赖包不想放到工程jar中，并且把这些文件压缩成一个zip包，方便上传到linux；此时通过maven-assembly-plugin和maven-jar-plugin就可以做到，mvn的配置如：</p>
<div><pre><code> 1            &lt;plugin>
 2                 &lt;groupId>org.apache.maven.plugins&lt;/groupId>
 3                 &lt;artifactId>maven-jar-plugin&lt;/artifactId>
 4                 &lt;version>2.6&lt;/version>
 5                 &lt;configuration>
 6                     &lt;archive>
 7                         &lt;addMavenDescriptor>false&lt;/addMavenDescriptor>
 8                         &lt;manifest>
 9                             &lt;addClasspath>true&lt;/addClasspath>
10                             &lt;classpathPrefix>lib/&lt;/classpathPrefix>
11                             &lt;mainClass>${scripts_bootMain}&lt;/mainClass>
12                         &lt;/manifest>
13                     &lt;/archive>
14                     &lt;!--打包排除项-->
15                     &lt;excludes>
16                         &lt;exclude>**/*.yml&lt;/exclude>
17                         &lt;exclude>**/*.properties&lt;/exclude>
18                         &lt;exclude>**/*.xml&lt;/exclude>
19                         &lt;exclude>**/*.sh&lt;/exclude>
20                     &lt;/excludes>
21                 &lt;/configuration>
22                 &lt;executions>
23                     &lt;execution>
24                         &lt;id>make-a-jar&lt;/id>
25                         &lt;phase>compile&lt;/phase>
26                         &lt;goals>
27                             &lt;goal>jar&lt;/goal>
28                         &lt;/goals>
29                     &lt;/execution>
30                 &lt;/executions>
31             &lt;/plugin>
32 
33             &lt;plugin>
34                 &lt;groupId>org.apache.maven.plugins&lt;/groupId>
35                 &lt;artifactId>maven-assembly-plugin&lt;/artifactId>
36                 &lt;version>2.4&lt;/version>
37                 &lt;!-- The configuration of the plugin -->
38                 &lt;configuration>
39                     &lt;!-- Specifies the configuration file of the assembly plugin -->
40                     &lt;descriptors>
41                         &lt;descriptor>${project.basedir}/src/main/assembly/assembly.xml&lt;/descriptor>
42                     &lt;/descriptors>
43                 &lt;/configuration>
44                 &lt;executions>
45                     &lt;execution>
46                         &lt;id>make-assembly&lt;/id>
47                         &lt;phase>package&lt;/phase>
48                         &lt;goals>
49                             &lt;goal>single&lt;/goal>
50                         &lt;/goals>
51                     &lt;/execution>
52                 &lt;/executions>
53             &lt;/plugin>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>值得注意的地方如下几点：</p>
<ul>
<li>mainClass节点：用来指定启动main函数入口类路径，如这里的：com.sm.EurekaServerApplication</li>
<li>excludes节点：排除主jar包中配置等一些列后缀文件，因为我们要包这些配置文件放到主包外面</li>
<li>descriptor节点：用来指定assembly插件对应的assembly.xml配置文件</li>
</ul>
<p>有了上面mvn配置，我们还需要assembly.xml的配置，这里提取了结合shell脚本发布程序的配置：</p>
<div><pre><code> 1 &lt;assembly xmlns="http://maven.apache.org/ASSEMBLY/2.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 2           xsi:schemaLocation="http://maven.apache.org/ASSEMBLY/2.0.0 http://maven.apache.org/xsd/assembly-2.0.0.xsd
 3 http://maven.apache.org/ASSEMBLY/2.0.0 ">
 4     &lt;id>${activeProfile}&lt;/id>
 5     &lt;!--打包成一个用于发布的zip文件-->
 6     &lt;formats>
 7         &lt;format>zip&lt;/format>
 8     &lt;/formats>
 9     &lt;!--true：zip中生成一级目录(此处屏蔽，配合脚本需要profiles后缀)-->
10     &lt;includeBaseDirectory>false&lt;/includeBaseDirectory>
11     &lt;dependencySets>
12         &lt;dependencySet>
13             &lt;!--打包进zip文件的lib目录-->
14             &lt;useProjectArtifact>false&lt;/useProjectArtifact>
15             &lt;outputDirectory>${package-name}-${activeProfile}/lib&lt;/outputDirectory>
16             &lt;unpack>false&lt;/unpack>
17         &lt;/dependencySet>
18     &lt;/dependencySets>
19 
20     &lt;fileSets>
21         &lt;!-- 配置文件打包进zip文件的conf目录 -->
22         &lt;fileSet>
23             &lt;directory>${project.basedir}/src/main/profiles/${activeProfile}&lt;/directory>
24             &lt;outputDirectory>${package-name}-${activeProfile}/conf&lt;/outputDirectory>
25             &lt;includes>
26                 &lt;include>**/*&lt;/include>
27                 &lt;!--&lt;include>*.xml&lt;/include>-->
28                 &lt;!--&lt;include>*.properties&lt;/include>-->
29                 &lt;!--&lt;include>*.yml&lt;/include>-->
30             &lt;/includes>
31         &lt;/fileSet>
32 
33         &lt;!--启动脚本打包进zip文件-->
34         &lt;fileSet>
35             &lt;directory>${project.basedir}/src/main/scripts&lt;/directory>
36             &lt;outputDirectory>&lt;/outputDirectory>
37             &lt;includes>
38                 &lt;include>**/*&lt;/include>
39             &lt;/includes>
40             &lt;!-- 文件文件权限为777 -->
41             &lt;fileMode>777&lt;/fileMode>
42             &lt;!-- 目录权限为777  -->
43             &lt;directoryMode>777&lt;/directoryMode>
44             &lt;!--脚本中参数变量为pom中的值 关键-->
45             &lt;filtered>true&lt;/filtered>
46         &lt;/fileSet>
47 
48         &lt;!-- 项目编译出来的jar打包进zip文件 -->
49         &lt;fileSet>
50             &lt;directory>${project.build.directory}&lt;/directory>
51             &lt;outputDirectory>${package-name}-${activeProfile}/&lt;/outputDirectory>
52             &lt;includes>
53                 &lt;include>*.jar&lt;/include>
54             &lt;/includes>
55         &lt;/fileSet>
56     &lt;/fileSets>
57 &lt;/assembly>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>重点节点介绍：</p>
<ul>
<li>formats节点：把配置文件和jar包等压缩成什么文件格式，这里可以有：zip，tar等</li>
<li>fileMode节点：指定scripts目录下脚本文件(这里是：shenniu_publish.sh)在linux上文件权限为777</li>
<li>filtered节点：脚本中参数变量为pom的profiles中properties的值(该配置，是把mvn中属性值映射生成到sh文件中，如：${package-name})</li>
</ul>
<p>完成上面配置后，此时我们可以通过idea上勾选切换不同环境来打zip包，如图：</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/348819-20190309170559272-1005982868.png" alt="img" loading="lazy"></p>
<h1 id="分享shenniu-publish-sh程序启动工具" tabindex="-1"> 分享shenniu_publish.sh程序启动工具</h1>
<p>上面步骤完成了zip格式的发布包，我们再分享下启动程序的shell脚本，该脚本具有的功能如：</p>
<ul>
<li>解压zip+启动jar包</li>
<li>启动jar包</li>
<li>停止对应jar运行</li>
<li>重启jar程序</li>
</ul>
<p>目前该shell中封装了两种启动jar命令的方式：</p>
<ul>
<li>java -cp</li>
<li>java -jar</li>
</ul>
<p>如图命令格式：</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/348819-20190309170514140-1638598831.png" alt="img" loading="lazy"></p>
<p>来看全部的shell代码：</p>
<div><pre><code>  1 #!/usr/bin/env bash
  2 #可变参数变量
  3 languageType="javac" #支持 java,javac,netcore 发布
  4 #参数值由pom文件传递
  5 baseZipName="${package-name}-${activeProfile}" #压缩包名称  publish-test.zip的publish
  6 packageName="${package-name}" #命令启动包名 xx.jar的xx
  7 mainclass="${boot-main}" #java -cp启动时，指定main入口类;命令：java -cp conf;lib\*.jar;${packageName}.jar ${mainclass}
  8 
  9 #例子
 10 # baseZipName="publish-test" #压缩包名称  publish-test.zip的publish
 11 # packageName="publish" #命令启动包名 publish.jar的xx
 12 
 13 #固定变量
 14 basePath=$(cd `dirname $0`/; pwd)
 15 baseZipPath="${basePath}/${baseZipName}.zip"  #压缩包路径
 16 baseDirPath="${basePath}" #解压部署磁盘路径
 17 pid= #进程pid
 18 
 19 #解压
 20 function shenniu_unzip()
 21 {
 22     echo "解压---------------------------------------------"
 23     echo "压缩包路径：${baseZipPath}"
 24     if [ ! `find ${baseZipPath}` ]
 25     then
 26         echo "不存在压缩包：${baseZipPath}"
 27     else
 28         echo "解压磁盘路径：${baseDirPath}/${baseZipName}"
 29         echo "开始解压..."
 30 
 31         #解压命令
 32         unzip -od ${baseDirPath}/${baseZipName} ${baseZipPath}
 33 
 34         #设置执行权限
 35         chmod +x ${baseDirPath}/${baseZipName}/${packageName}
 36 
 37         echo "解压完成。"  
 38     fi
 39 }
 40 
 41 #检测pid
 42 function getPid()
 43 {
 44     echo "检测状态---------------------------------------------"
 45     pid=`ps -ef | grep -n ${packageName} | grep -v grep | awk '{print $2}'`
 46     if [ ${pid} ] 
 47     then
 48         echo "运行pid：${pid}"
 49     else
 50         echo "未运行"
 51     fi
 52 }
 53 
 54 #启动程序
 55 function start()
 56 {
 57     #启动前，先停止之前的
 58     stop
 59     if [ ${pid} ]
 60     then
 61         echo "停止程序失败，无法启动"
 62     else
 63         echo "启动程序---------------------------------------------"
 64         
 65         #选择语言类型
 66         read -p "输入程序类型(java,javac,netcore)，下一步按回车键(默认：${languageType})：" read_languageType
 67         if [ ${read_languageType} ]
 68         then
 69             languageType=${read_languageType}
 70         fi
 71         echo "选择程序类型：${languageType}"
 72 
 73         #进入运行包目录
 74         cd ${baseDirPath}/${baseZipName}
 75 
 76         #分类启动
 77         if [ "${languageType}" == "javac" ] 
 78         then
 79             if [ ${mainclass} ] 
 80             then
 81                 nohup java -cp conf:lib\*.jar:${packageName}.jar ${mainclass} >${baseDirPath}/${packageName}.out 2>&amp;1 &amp;
 82                #nohup java -cp conf:lib\*.jar:${packageName}.jar ${mainclass} >/dev/null 2>&amp;1 &amp;
 83             fi
 84         elif [ "${languageType}" == "java" ] 
 85         then
 86             nohup java -jar ${baseDirPath}/${baseZipName}/${packageName}.jar >/dev/null 2>&amp;1 &amp;
 87             # java -jar ${baseDirPath}/${baseZipName}/${packageName}.jar
 88         elif [ "${languageType}" == "netcore" ] 
 89         then
 90             #nohup dotnet run ${baseDirPath}/${baseZipName}/${packageName} >/dev/null 2>&amp;1 &amp;
 91             nohup ${baseDirPath}/${baseZipName}/${packageName} >/dev/null 2>&amp;1 &amp;
 92         fi
 93 
 94         #查询是否有启动进程
 95         getPid
 96         if [ ${pid} ]
 97         then
 98             echo "已启动"
 99             #nohup日志
100             tail -n 50 -f ${baseDirPath}/${packageName}.out
101         else
102             echo "启动失败"
103         fi
104     fi
105 }
106 
107 #停止程序
108 function stop()
109 {
110     getPid
111     if [ ${pid} ] 
112     then
113         echo "停止程序---------------------------------------------"
114         kill -9 ${pid}
115         
116         getPid
117         if [ ${pid} ] 
118         then
119             #stop
120             echo "停止失败"
121         else
122             echo "停止成功"
123         fi
124     fi
125 }
126 
127 #启动时带参数，根据参数执行
128 if [ ${#} -ge 1 ] 
129 then
130     case ${1} in
131         "start") 
132             start
133         ;;
134         "restart") 
135             start
136         ;;
137         "stop") 
138             stop
139         ;;
140         "unzip") 
141             #执行解压
142             shenniu_unzip
143             #执行启动
144             start
145         ;;
146         *) 
147             echo "${1}无任何操作"
148         ;;
149     esac
150 else
151     echo "
152     command如下命令：
153     unzip：解压并启动
154     start：启动
155     stop：停止进程
156     restart：重启
157 
158     示例命令如：./shenniu_publish start
159     "
160 fi
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>正如上面小节说的，shell中的参数 package-name，activeProfile，boot-main 都是由mvn中profiles的properties中提供，是可变的参数，脚本代码本身不需要人工去修改，只需要变的是mvn的参数即可；其实在我们生成zip包的时候，shell中的参数就被替换了，可以看zip中shell文件内容如：</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/348819-20190309170701655-1208411312.png" alt="img" loading="lazy"></p>
<h1 id="linux上使用shenniu-publish-sh启动程序" tabindex="-1"> linux上使用shenniu_publish.sh启动程序</h1>
<p>把生成的zip上传到linux上，通过命令解压：</p>
<div><pre><code>1 unzip -od eureka-server-0.0.1-node eureka-server-0.0.1-node.zip
</code></pre><div aria-hidden="true"><div></div></div></div><p>其实shell脚本中包含有解压命令，但是我在打包时放在了zip中，所以只能通过手动解压了，当然可以调整；此时进入加压目录如此：</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/348819-20190309170918126-491643739.png" alt="img" loading="lazy"></p>
<p>注：这里第一次执行./shenniu_publish.sh脚本时候，提示了错误信息；是由于我是在windows上编辑的这个脚本，其空格等和linux上不一样，所以运行会有问题，要解决可以使用vim命令在linux把该文件转成linux格式，如下命令：</p>
<div><pre><code>1 vim shenniu_publish.sh
2 set ff=unix
3 :wq
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>执行完后，再来运行脚本./shenniu_publish.sh，此时有如下提示:</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/348819-20190309171107977-1319405631.png" alt="img" loading="lazy"></p>
<p>此刻我们文件是解压状态，因此只需要start命令启动程序即可：</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/348819-20190309171127604-1971799892.png" alt="img" loading="lazy"></p>
<p>到这里shenniu_publish.sh脚本使用就完成了，只要脚本没有提示错误，基本都能启动jar服务；其他restart和stop命令也如此执行就行：</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/348819-20190309171150215-294116419.png" alt="img" loading="lazy"></p>
<p>可以去研究下shell代码，希望该脚本能给你带来效率和好的学习思路，下面是测试用例git地址，脚本在eureka-server项目中：<a href="https://github.com/shenniubuxing3/springcloud-Finchley.SR2" target="_blank" rel="noopener noreferrer">https://github.com/shenniubuxing3/springcloud-Finchley.SR2</a></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-01-15T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Linux脚本工具</title>
    <id>https://blog.ciberviler.top/linux/Linux%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7.html</id>
    <link href="https://blog.ciberviler.top/linux/Linux%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">Linux脚本工具</summary>
    <content type="html"><![CDATA[<h1 id="linux脚本工具" tabindex="-1"> Linux脚本工具</h1>
<h2 id="ednovas-的-toolbox-工具箱" tabindex="-1"> EdNovas 的 Toolbox 工具箱</h2>
<p><strong>脚本地址</strong></p>
<p><a href="https://github.com/wdm1732418365/vpstoolbox" target="_blank" rel="noopener noreferrer">https://github.com/wdm1732418365/vpstoolbox</a></p>
<p>最新版：</p>
<div><pre><code>CODE
<span>wget</span> -N https://raw.githubusercontent.com/wdm1732418365/vpstoolbox/main/ednovastool.sh <span>&amp;&amp;</span> <span>chmod</span> +x ednovastool.sh <span>&amp;&amp;</span> ./ednovastool.sh
</code></pre><div aria-hidden="true"><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-01-21T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">MySQL 8</title>
    <id>https://blog.ciberviler.top/linux/MySQL.html</id>
    <link href="https://blog.ciberviler.top/linux/MySQL.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">MySQL 8</summary>
    <content type="html"><![CDATA[<h1 id="mysql-8" tabindex="-1"> MySQL 8</h1>
<p>mysql从5.7一下子跳跃到了8.0，其中的改变还是很大，有点这里就不说了，小伙伴们自己去百度了解一下，这里重点说一下，安装的事</p>
<p>1.解压后，文件下下面是没有my.ini 和 data目录的，需要自己新建一个my.ini和data目录</p>
<p>my.ini的基本代码就这几行配置，足矣，更详细的自己官网上看（F:\mysql-8.0.11-winx64 是我的解压路径）</p>
<div><pre><code>
[mysqld]
# 设置3306端口
port=3306
# 设置mysql的安装目录
basedir=E:\Software\mysql-8.0.19-winx64
# 设置mysql数据库的数据的存放目录，在安装mysql-5.7.30-winx64.zip版本的时候，此配置不可添加，否则mysql将无法启动。
# datadir=E:\Software\mysql-8.0.19-winx64\data
# 允许最大连接数
max_connections=200
# 允许连接失败的次数。这是为了防止有人从该主机试图攻击数据库系统
max_connect_errors=10
# 服务端使用的字符集默认为UTF8
character-set-server=utf8
# 创建新表时将使用的默认存储引擎
default-storage-engine=INNODB
# 默认使用“mysql_native_password”插件认证
default_authentication_plugin=mysql_native_password
# 关闭ssl
skip_ssl
# 配置时区
default-time_zone='+8:00'
[mysql]
# 设置mysql客户端默认字符集
default-character-set=utf8
[client]
# 设置mysql客户端连接服务端时默认使用的端口
port=3306
default-character-set=utf8
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>2.配置环境变量，将解压目录下的bin文件夹的路径配置到系统变量中的path下（F:\mysql-8.0.11-winx64\bin）</p>
<p>3.以管理员身份运行命令提示符</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/856176-20180428143824709-218907811.png" alt="img" loading="lazy"></p>
<p>如果顺利会产生下面的信息：</p>
<p>第4行的信息尤其重要，这是初始化密码，请拿笔或者截图记下，这个随机密码会很随机，随机到可能有一些符号；</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/856176-20180428143923105-1817069252.png" alt="img" loading="lazy"></p>
<p>提示：如果你关了这个窗口，或者没记住，那也没事，删掉初始化的 datadir 目录（就是解压文件夹下的data文件夹）里面的东西，不要删除data文件夹，再执行一遍初始化命令，又会重新生成的。</p>
<p>4.安装服务 mysqld --install 服务名（可以不写，默认是MySql,如果你的电脑上要安装付哦个mysql,这里的服务名写一下做区分），安装成功后控制它会提示：success ** (忘记了)</p>
<div><pre><code>mysqld --install [服务名]
</code></pre><div aria-hidden="true"><div></div></div></div><p>5.启动服务（这时候不要去登录mysql,登录不进去的，必须要先启动）</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/856176-20180428144751212-1355452928.png" alt="img" loading="lazy"></p>
<p>6.登录mysql，当然是为了修改密码啊，那个随机密码鬼才能记得住，这时候也不要尝试用图形化管理工具（navicat for mysql）去登录，会报错的，继续往下看</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/856176-20180428145014478-776409826.png" alt="img" loading="lazy"></p>
<p>这里踩坑的小朋友一般是密码输错了，或者服务没启动，一直登录不进去。</p>
<p>7.修改密码</p>
<p>ALTER USER &quot;root&quot;@&quot;localhost&quot; IDENTIFIED BY &quot;你的新密码&quot;;</p>
<p><strong>注意：重点啊，如果你没有设置认证方式，默认的密码加密方式是：caching_sha2_password，而现在很多客户端工具还不支持这种加密认证方式，连接测试的时候就会报错：client does not support authentication protocol requested by server; consider upgrading MySQL client，这里的错误信息就是不支持身份认证方式，没关系，去my.ini里面在[mysqld]下面加上这句话即可：</strong></p>
<div><pre><code>default_authentication_plugin=mysql_native_password
</code></pre><div aria-hidden="true"><div></div></div></div><p>8.打开远程访问</p>
<p>对于允许远程访问，有两种角色，一种是我们的root用户，还有一种是非root用户，从安全的角度（我也不知道什么角度，听别人说的，暂且相信着吧），远程访问最后不要用root用户</p>
<div><pre><code>用root用户访问：
GRANT ALL PRIVILEGES ON *.* TO 'root'@'%'IDENTIFIED BY '密码' WITH GRANT OPTION;
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>这里允许root用户远程的时候，如果出现如下的错误，就先去把root用的host改成%，再运行上面那句话，对于mysql用户管理这一块不熟悉的朋友们，请看我另一篇博客--mysql 用户及权限管理</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/856176-20180428150157767-1407082633.png" alt="img" loading="lazy"></p>
<p>非root用户，这里就要先去创建一个用户</p>
<div><pre><code>切换数据库
mysql>use mysql;

创建用户(user1:用户名;%:任意ip,也可以指定，root默认就是localhost;123456：登录密码)
mysql>CREATE USER 'user1'@'%' IDENTIFIED BY '123456';

授权，默认创建的用户权限是usage,就是无权限，只能登录而已，（all：所有权限，这里有select,update等等权限，可以去搜一下；后面的*.*：指定数据库.指定表，这里是所有；to后面就是你刚才创建的用户）mysql>grant all on *.* to 'user1'@'%'；
注意:用以上命令授权的用户不能给其它用户授权,如果想让该用户可以授权,用以下命令: 
GRANT all ON databasename.tablename TO 'username'@'host' WITH GRANT OPTION; 
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>其他：</p>
<div><pre><code><span># 修改密码</span>
<span>ALTER</span> <span>USER</span> <span>'test'</span><span>@'localhost'</span> IDENTIFIED <span>WITH</span> MYSQL_NATIVE_PASSWORD <span>BY</span> <span>'新密码'</span><span>;</span>

<span>ALTER</span> <span>USER</span> <span>'ynau'</span><span>@'localhost'</span> IDENTIFIED <span>WITH</span> MYSQL_NATIVE_PASSWORD <span>BY</span> <span>'123456'</span><span>;</span>

<span># 创建用户</span>
<span>CREATE</span> <span>USER</span> <span>'ynau'</span><span>@'%'</span> IDENTIFIED <span>BY</span> <span>'123456'</span><span>;</span>

<span>#授权</span>
<span>grant</span> <span>all</span> <span>on</span> <span>*</span><span>.</span><span>*</span> <span>to</span> <span>'ynau'</span><span>@'%'</span><span>;</span>

<span>#刷新：</span>
flush <span>privileges</span><span>;</span>

<span>#重启mysql服务</span>
service mysqld restart

<span>#验证是否修改成功</span>
mysql <span>-</span>u test <span>-</span>p
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-01-23T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">MySQL压缩版安装配置</title>
    <id>https://blog.ciberviler.top/linux/MySQL%E5%8E%8B%E7%BC%A9%E7%89%88%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE.html</id>
    <link href="https://blog.ciberviler.top/linux/MySQL%E5%8E%8B%E7%BC%A9%E7%89%88%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">MySQL压缩版安装配置</summary>
    <content type="html"><![CDATA[<h1 id="mysql压缩版安装配置" tabindex="-1"> MySQL压缩版安装配置</h1>
<h2 id="_1-下载" tabindex="-1"> 1 下载</h2>
<p>官网：<a href="https://www.mysql.com/" target="_blank" rel="noopener noreferrer">https://www.mysql.com/</a>
最新版下载地址：<a href="https://dev.mysql.com/downloads/mysql/" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/downloads/mysql/</a>
多版本下载地址：<a href="https://downloads.mysql.com/archives/community/" target="_blank" rel="noopener noreferrer">https://downloads.mysql.com/archives/community/</a>
在这里，我使用的是MySQL8.0.19解压缩版，附上下载链接：<a href="https://cdn.mysql.com/archives/mysql-8.0/mysql-8.0.19-winx64.zip" target="_blank" rel="noopener noreferrer">https://cdn.mysql.com/archives/mysql-8.0/mysql-8.0.19-winx64.zip</a></p>
<p>此时的MySQL版本已经更新到8.0.23，所以我需要进入多版本链接进行下载。</p>
<p><strong>注意：</strong></p>
<ul>
<li>旧版本中存在漏洞</li>
<li><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/image-20220115155838758.png" alt="image-20220115155838758" loading="lazy"></li>
</ul>
<h2 id="_2-安装" tabindex="-1"> 2 安装</h2>
<p>1.我们提前创建好解压目录：</p>
<p>找到刚才下载的压缩包，复制到我们上一步创建的解压目录下：</p>
<p>右键进行解压，解压后的目录如下图所示：</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDU3NzU0Mw.png" alt="img" loading="lazy"></p>
<p>接下来创建我们的数据库文件存放位置，这里我在mysql解压目录的同级目录下创建了<code>databases</code>文件夹，作为数据库存放目录</p>
<p>接下来进行初始化安装：
用管理员身份打开cmd命令，并进入到mysql解压目录下的bin目录，如：<code>D:\ProgramFiles\MySQL8\bin</code></p>
<p><strong>2、创建一个名为my.ini的文件：</strong></p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/ZmFuZ3poZW5naGVpdGk.png" alt="img" loading="lazy"></p>
<p><strong>3、修改my.ini文件：</strong></p>
<div><pre><code><span>[</span>mysql<span>]</span>
<span># 设置mysql客户端默认字符集</span>
<span>default</span><span>-</span><span>character</span><span>-</span><span>set</span><span>=</span>utf8
<span>[</span>mysqld<span>]</span>
<span># 设置3306端口</span>
port <span>=</span> <span>3306</span>
<span># 设置mysql的安装目录</span>
basedir <span>=</span> D:\\Program Files\\mysql\\
<span># 设置mysql数据库的数据的存放目录</span>
datadir <span>=</span> D:\\Program Files\\mysql\\<span>data</span>
<span># 允许最大连接数</span>
max_connections<span>=</span><span>20</span>
<span># 服务端使用的字符集默认为8比特编码的latin1字符集</span>
<span>character</span><span>-</span><span>set</span><span>-</span>server<span>=</span>utf8
<span># 创建新表时将使用的默认存储引擎</span>
<span>default</span><span>-</span>storage<span>-</span><span>engine</span><span>=</span><span>INNODB</span>
<span># 创建模式</span>
sql_mode <span>=</span> NO_ENGINE_SUBSTITUTION<span>,</span>STRICT_TRANS_TABLES



<span>[</span>mysqld<span>]</span>
<span># 设置服务端使⽤用的字符集为utf-8</span>
<span>character</span><span>-</span><span>set</span><span>-</span>server<span>=</span>utf8
<span># 绑定IPv4地址</span>
bind<span>-</span>address <span>=</span> <span>127.0</span><span>.0</span><span>.1</span>
<span># 设置mysql的端⼝口号</span>
port <span>=</span> <span>3306</span>
<span># 设置mysql的安装⽬目录</span>
basedir<span>=</span>D:<span>/</span>ProgramFiles<span>/</span>MySQL8
<span># 设置mysql数据库的数据的存放⽬目录</span>
datadir<span>=</span>D:<span>/</span>ProgramFiles<span>/</span>MySQL8<span>/</span><span>data</span>
<span># 允许最⼤大连接数</span>
max_connections<span>=</span><span>20</span>
<span># 创建新表时将使⽤用的默认存储引擎</span>
<span>default</span><span>-</span>storage<span>-</span><span>engine</span><span>=</span><span>INNODB</span>
<span>default</span><span>-</span>time_zone<span>=</span><span>'+8:00'</span>
<span># 设置mysql以及数据库的默认编码</span>
<span>[</span>mysql<span>]</span>
<span>default</span><span>-</span><span>character</span><span>-</span><span>set</span><span>=</span>utf8
<span>[</span>mysql<span>.</span>server<span>]</span>
<span>default</span><span>-</span><span>character</span><span>-</span><span>set</span><span>=</span>utf8
<span># 设置客户端默认字符集</span>
<span>[</span>client<span>]</span>
<span>default</span><span>-</span><span>character</span><span>-</span><span>set</span><span>=</span>utf8
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>特别要注意：</strong></p>
<p>（1）D:\Program Files\mysql\data 这个目录一定要是“\”，千万别弄成“\”不然会报错，或者可以用“/”；
（2）Mysq安装目录和数据存放目录一定要修改为你自己设定的目录，除非你设置的目录与上述一致。</p>
<h2 id="_3-配置" tabindex="-1"> 3.配置</h2>
<p>3.用管理员身份打开cmd窗口：win -&gt; windows系统 -&gt; 右击命令提示符 -&gt; 更多 -&gt; 以管理员身份运行</p>
<p>4.进入到bin目录下</p>
<p>5.执行 <code>mysqld --install</code> 命令安装（执行 <code>mysqld --remove</code> 卸载安装）</p>
<p>6.继续执行 <code>mysqld --initialize --user=root --console</code> 命令</p>
<p>注意：初始化完成后MySQL会给root用户创建一个默认随机密码，下图白色部分就是密码，同时在data目录下也添加了相关的配置文件，如果密码有字符辨识不了，则把date目录下的文件都删了，重新执行这一步。</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/1780812-20190829212537656-1187829463.png" alt="img" loading="lazy"></p>
<p>7.执行<code>net start mysql</code>启动服务（执行<code>net stop mysql</code>关闭服务）</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/1780812-20190829212232857-537058421.png" alt="img" loading="lazy"></p>
<p>8.执行<code>mysql -uroot -pqLBiVku7k%f</code>登录MySQL（-u后面是用户名，-p后面是密码，即上面的默认随机密码）</p>
<p>9.修改密码</p>
<p>mysql版本是7:</p>
<p><code>set password = password('root');</code></p>
<p>注意：如果mysql版本是8或以上，则使用 alter user 'root'@'localhost' identified by '新的密码'; 修改密码</p>
<p><code>ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '123456';</code>
这样我们就可以将<code>roo</code>t账户的密码修改为<code>123456</code>了，将<code>123456</code>处替换为你们要修改的密码，回车执行就可以了。</p>
<p>12.登录MySQL后可以添加一个用户</p>
<p>添加格式：</p>
<p>grant 权限 on 数据库.表 to 用户名@'IP地址' identified by '密码'</p>
<p>实例：</p>
<p><code>grant all on *.* to test@'%' identified by'test'</code></p>
<h2 id="_4-安装错误提示" tabindex="-1"> 4 安装错误提示</h2>
<h3 id="提示" tabindex="-1"> 提示</h3>
<p>安装过程中如果出现以下错误，是我们的电脑缺少运行时环境。
**注：**在这里我们有出现这种情况，但为了以防万一，还是给大家说一下，这里的图片用的网图，如有侵权，请评论删图！</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/20200131203311761.png" alt="img" loading="lazy"></p>
<p>解决办法：
下载vcruntime140_1.dll，链接：<a href="https://cn.dll-files.com/vcruntime140_1.dll.html" target="_blank" rel="noopener noreferrer">https://cn.dll-files.com/vcruntime140_1.dll.html</a></p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/16422331874666.png" alt="在这里插入图片描述" loading="lazy">
下载完成后，解压提取文件，将提取出来的<code>vcruntime140_1.dll</code>文件复制到我们的<code>C:\Windows\System32</code>
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/16422331874677.png" alt="在这里插入图片描述" loading="lazy">
<strong>注意, 32位版本的<code>vcruntime140_1.dll</code>需要复制到<code>C:\Windows\SysWOW64</code>下</strong></p>
<h3 id="tips2" tabindex="-1"> tips2：</h3>
<p>mysqld –initialize-insecure自动生成无密码的root用户；
mysqld –initialize自动生成带随机密码的root用户；
mysqld -remove移除自己的mysqld服务；
net stop mysql命令，停止mysql服务
如果报错，清空data文件夹，最好还是删掉data文件，重新执行remove--initialize--install--start（这些不是命令）流程即可；</p>
<h2 id="_5-配置mysql的环境变量" tabindex="-1"> 5 配置mysql的环境变量</h2>
<div><pre><code>MYSQL_HOME

D<span>:</span>\<span>Program</span> <span>Files</span>\mysql
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/20200303112518670.png" alt="img" loading="lazy"></p>
<p>点击Path，增加：</p>
<div><pre><code><span>%</span>MYSQL_HOME<span>%</span>\<span>bin</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/20190831112741174.png" alt="img" loading="lazy"></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-01-24T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Nginx从安装到高可用</title>
    <id>https://blog.ciberviler.top/linux/Nginx%E4%BB%8E%E5%AE%89%E8%A3%85%E5%88%B0%E9%AB%98%E5%8F%AF%E7%94%A8.html</id>
    <link href="https://blog.ciberviler.top/linux/Nginx%E4%BB%8E%E5%AE%89%E8%A3%85%E5%88%B0%E9%AB%98%E5%8F%AF%E7%94%A8.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">Nginx从安装到高可用</summary>
    <content type="html"><![CDATA[<h1 id="nginx从安装到高可用" tabindex="-1"> Nginx从安装到高可用</h1>
<div><pre><code>原文：blog.csdn.net/qq_34886352/article/details/103581973
第1-100期：100期Java项目整理
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h3 id="一、nginx安装" tabindex="-1"> 一、Nginx安装</h3>
<h5 id="_1、去官网http-nginx-org-下载对应的nginx包-推荐使用稳定版本" tabindex="-1"> 1、去官网<a href="http://nginx.org/%E4%B8%8B%E8%BD%BD%E5%AF%B9%E5%BA%94%E7%9A%84nginx%E5%8C%85%EF%BC%8C%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8%E7%A8%B3%E5%AE%9A%E7%89%88%E6%9C%AC" target="_blank" rel="noopener noreferrer">http://nginx.org/下载对应的nginx包，推荐使用稳定版本</a></h5>
<h5 id="_2、上传nginx到linux系统" tabindex="-1"> 2、上传nginx到linux系统</h5>
<h5 id="_3、安装依赖环境" tabindex="-1"> 3、安装依赖环境</h5>
<p>(1)安装gcc环境</p>
<div><pre><code>yum install gcc-c++
</code></pre><div aria-hidden="true"><div></div></div></div><p>(2)安装PCRE库，用于解析正则表达式</p>
<div><pre><code>yum install -y pcre pcre-devel
</code></pre><div aria-hidden="true"><div></div></div></div><p>(3)zlib压缩和解压缩依赖</p>
<div><pre><code>yum install -y zlib zlib-devel
</code></pre><div aria-hidden="true"><div></div></div></div><p>(4)SSL 安全的加密的套接字协议层，用于HTTP安全传输，也就是https</p>
<div><pre><code>yum install -y openssl openssl-devel
</code></pre><div aria-hidden="true"><div></div></div></div><h5 id="_4、解压-需要注意-解压后得到的是源码-源码需要编译后才能安装" tabindex="-1"> 4、解压，需要注意，解压后得到的是源码，源码需要编译后才能安装</h5>
<div><pre><code>tar -zxvf nginx-1.16.1.tar.gz
</code></pre><div aria-hidden="true"><div></div></div></div><h5 id="_5、编译之前-先创建nginx临时目录-如果不创建-在启动nginx的过程中会报错" tabindex="-1"> 5、编译之前，先创建nginx临时目录，如果不创建，在启动nginx的过程中会报错</h5>
<div><pre><code>mkdir /var/temp/nginx -p
</code></pre><div aria-hidden="true"><div></div></div></div><h5 id="_6、在nginx目录-输入如下命令进行配置-目的是为了创建makefile文件" tabindex="-1"> 6、在nginx目录，输入如下命令进行配置，目的是为了创建makefile文件</h5>
<div><pre><code>./configure \   
--prefix=/usr/local/nginx \    
--pid-path=/var/run/nginx/nginx.pid \    
--lock-path=/var/lock/nginx.lock \    
--error-log-path=/var/log/nginx/error.log \    
--http-log-path=/var/log/nginx/access.log \    
--with-http_gzip_static_module \    
--http-client-body-temp-path=/var/temp/nginx/client \    
--http-proxy-temp-path=/var/temp/nginx/proxy \    
--http-fastcgi-temp-path=/var/temp/nginx/fastcgi \    
--http-uwsgi-temp-path=/var/temp/nginx/uwsgi \    
--http-scgi-temp-path=/var/temp/nginx/scgi
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>注：代表在命令行中换行，用于提高可读性配置命令：</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346363259473.jpg" alt="图片" loading="lazy"></p>
<h5 id="_7、make编译-安装" tabindex="-1"> 7、make编译&amp;安装</h5>
<div><pre><code>make
make install
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h5 id="_8、进入sbin目录启动nginx" tabindex="-1"> 8、进入sbin目录启动nginx</h5>
<div><pre><code>启动：nginx
停止：./nginx -s stop
重新加载：./nginx -s reload
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><h3 id="二、配置反向代理" tabindex="-1"> 二、配置反向代理</h3>
<p>1、配置upstream</p>
<div><pre><code>upstream [proxyName] {
    server 192.168.1.173:8080;
    server 192.168.1.174:8080;
    server 192.168.1.175:8080;
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>2、配置server</p>
<div><pre><code>server {
    listem  80;
    server_name www.tomcats.com;

    location / {
        proxy_pass http://tomcats;
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="三、配置负载均衡" tabindex="-1"> 三、配置负载均衡</h3>
<p>nginx默认采用轮训的方式进行负载均衡</p>
<p>1、使用加权轮询</p>
<div><pre><code>upstream [proxyName] {
    server 192.168.1.173:8080 weight=1;
    server 192.168.1.174:8080 weight=5;
    server 192.168.1.175:8080 weight=2;
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>2、hash负载均衡</p>
<div><pre><code>upstream [proxyName] {
    ip_hash

    server 192.168.1.173:8080;
    server 192.168.1.174:8080;
    server 192.168.1.175:8080;
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>hash算法实际上只会计算 192.168.1这段做哈希</p>
<p>使用ip_hash的注意点：</p>
<ul>
<li>不能把后台服务器直接移除，只能标记down.</li>
</ul>
<p>3、url hash负载均衡</p>
<div><pre><code>upstream [proxyName] {
    hash $request_url;

    server 192.168.1.173:8080;
    server 192.168.1.174:8080;
    server 192.168.1.175:8080;
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>4、最小连接负载均衡</p>
<div><pre><code>upstream [proxyName] {
    least_conn;

    server 192.168.1.173:8080;
    server 192.168.1.174:8080;
    server 192.168.1.175:8080;
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="四、upstream指令参数" tabindex="-1"> 四、upstream指令参数</h3>
<ul>
<li><code>max_conns</code>：限制最大同时连接数 1.11.5之前只能用于商业版</li>
<li><code>slow_start</code>：单位秒，权重在指定时间内从1上升到指定值，不适用与hash负载均衡、随机负载均衡 如果在 upstream 中只有一台 server，则该参数失效（商业版才有）</li>
<li><code>down</code>：禁止访问</li>
<li><code>backup</code>：备用机 只有在其他服务器无法访问的时候才能访问到 不适用与hash负载均衡、随机负载均衡</li>
<li><code>max_fails</code>：表示失败几次，则标记server已宕机，剔出上游服务 默认值1</li>
<li><code>fail_timeout</code>：表示失败的重试时间 默认值10</li>
</ul>
<p>1、keepalived</p>
<div><pre><code>upstream [proxyName] {
    server 192.168.1.173:8080 weight=1;
    server 192.168.1.174:8080 weight=5;
    server 192.168.1.175:8080 weight=2;

    keepalive 32; #保持的连接数
}

server {
    listem  80;
    server_name www.tomcats.com;

    location / {
        proxy_pass http://tomcats;
        proxy_http_version 1.1; #连接的协议版本
        proxy_set_header Connection ""; 清空连接请求头
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>2、控制浏览器缓存</p>
<div><pre><code>server {
    listem  80;
    server_name www.tomcats.com;

    location / {
        proxy_pass http://tomcats;
               expires 10s;  #浏览器缓存10秒钟
               #expires @22h30m  #在晚上10点30的时候过期
               #expires -1h  #缓存在一小时前时效
               #expires epoch  #不设置缓存
               #expires off  #缓存关闭，浏览器自己控制缓存
               #expires max  #最大过期时间
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>3、反向代理缓存</p>
<div><pre><code>upstream [proxyName] {
    server 192.168.1.173:8080 weight=1;
    server 192.168.1.174:8080 weight=5;
    server 192.168.1.175:8080 weight=2;
}

#proxy_cache_path 设置缓存保存的目录的位置
#keys_zone设置共享内以及占用的空间大小
#mas_size 设置缓存最大空间
#inactive 缓存过期时间，错过此时间自动清理
#use_temp_path 关闭零时目录
proxy_cache_path /usr/local/nginx/upsteam_cache keys_zone=mycache:5m max_size=1g inactive=8h use_temp_path=off;

server {
    listem  80;
    server_name www.tomcats.com;
    #开启并使用缓存
    proxy_cache mycache;
    #针对200和304响应码的缓存过期时间
    proxy_cache_valid 200 304 8h;   

    location / {
        proxy_pass http://tomcats;
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="五、配置ssl证书提供https访问" tabindex="-1"> 五、配置ssl证书提供https访问</h3>
<h5 id="_1-安装ssl模块" tabindex="-1"> 1. 安装SSL模块</h5>
<p>要在nginx中配置https，就必须安装ssl模块，也就是: <code>http_ssl_module</code>。</p>
<p>进入到nginx的解压目录：<code>/home/software/nginx-1.16.1</code></p>
<p>新增ssl模块(原来的那些模块需要保留)</p>
<div><pre><code>./configure \
--prefix=/usr/local/nginx \
--pid-path=/var/run/nginx/nginx.pid \
--lock-path=/var/lock/nginx.lock \
--error-log-path=/var/log/nginx/error.log \
--http-log-path=/var/log/nginx/access.log \
--with-http_gzip_static_module \
--http-client-body-temp-path=/var/temp/nginx/client \
--http-proxy-temp-path=/var/temp/nginx/proxy \
--http-fastcgi-temp-path=/var/temp/nginx/fastcgi \
--http-uwsgi-temp-path=/var/temp/nginx/uwsgi \
--http-scgi-temp-path=/var/temp/nginx/scgi  \
--with-http_ssl_module
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>编译和安装</p>
<div><pre><code>make
make install
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h5 id="_2、配置https" tabindex="-1"> 2、配置HTTPS</h5>
<p>把ssl证书 <code>*.crt</code> 和 私钥 <code>*.key</code> 拷贝到<code>/usr/local/nginx/conf</code>目录中。</p>
<p>新增 server 监听 443 端口：</p>
<div><pre><code>server {
    listen       443;
    server_name  www.imoocdsp.com;
    # 开启ssl
    ssl     on;
    # 配置ssl证书
    ssl_certificate      1_www.imoocdsp.com_bundle.crt;
    # 配置证书秘钥
    ssl_certificate_key  2_www.imoocdsp.com.key;
    # ssl会话cache
    ssl_session_cache    shared:SSL:1m;
    # ssl会话超时时间
    ssl_session_timeout  5m;
    # 配置加密套件，写法遵循 openssl 标准
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;
    ssl_prefer_server_ciphers on;
    
    location / {
        proxy_pass http://tomcats/;
        index  index.html index.htm;
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="六、配置ha-nginx" tabindex="-1"> 六、配置ha nginx</h3>
<h5 id="_1、安装keepalived" tabindex="-1"> 1、安装keepalived</h5>
<p>(1)下载</p>
<div><pre><code>https://www.keepalived.org/download.html
</code></pre><div aria-hidden="true"><div></div></div></div><p>(2)解压</p>
<div><pre><code>tar -zxvf keepalived-2.0.18.tar.gz
</code></pre><div aria-hidden="true"><div></div></div></div><p>(3)使用configure命令配置安装目录与核心配置文件所在位置：</p>
<div><pre><code>./configure --prefix=/usr/local/keepalived --sysconf=/etc
</code></pre><div aria-hidden="true"><div></div></div></div><ul>
<li><strong>prefix</strong>：keepalived安装的位置sysconf：keepalived核心配置文件所在位置，固定位置，改成其他位置则keepalived启动不了，<code>/var/log/messages</code>中会报错</li>
<li><strong>sysconf</strong>：keepalived核心配置文件所在位置，固定位置，改成其他位置则keepalived启动不了，<code>/var/log/messages</code>中会报错</li>
</ul>
<p>配置过程中可能会出现警告信息，如下所示：</p>
<div><pre><code>*** WARNING - this build will not support IPVS with IPv6. Please install libnl/libnl-3 dev libraries to support IPv6 with IPVS.

# 安装libnl/libnl-3依赖
yum -y install libnl libnl-devel  
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p>(4)安装keepalived</p>
<div><pre><code>make &amp;&amp; make install
</code></pre><div aria-hidden="true"><div></div></div></div><p>(5)配置文件 在<code>/etc/keepalived/keepalived.conf</code></p>
<p>(6)忘记安装配置的目录，则通过如下命令找到：</p>
<div><pre><code>whereis keepalived
</code></pre><div aria-hidden="true"><div></div></div></div><p>(7)启动keepalived</p>
<p>进入sbin目录</p>
<div><pre><code>./keepalived
</code></pre><div aria-hidden="true"><div></div></div></div><h5 id="_2、配置keepalived-主机" tabindex="-1"> 2、配置keepalived 主机</h5>
<p>(1)通过命令 <code>vim keepalived.conf</code> 打开配置文件</p>
<div><pre><code>global_defs { 
    # 路由id：当前安装keepalived的节点主机标识符，保证全局唯一 
    router_id keep_171 
} 

vrrp_instance VI_1 { 
    # 表示状态是MASTER主机还是备用机BACKUP 
    state MASTER 
    # 该实例绑定的网卡 
    interface ens33 
    # 保证主备节点一致即可 
    virtual_router_id 51 
    # 权重，master权重一般高于backup，如果有多个，那就是选举，谁的权重高，谁就当选 
    priority 100 
    # 主备之间同步检查时间间隔，单位秒 
    advert_int 2 
    # 认证权限密码，防止非法节点进入 
    authentication { 
        auth_type PASS 
        auth_pass 1111 
    } 
    # 虚拟出来的ip，可以有多个（vip） 
    virtual_ipaddress { 
        192.168.1.161 
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>附：查看网卡信息命令</p>
<div><pre><code>ip addr
</code></pre><div aria-hidden="true"><div></div></div></div><p>(2)启动keepalived</p>
<p>(3)查看进程</p>
<div><pre><code>ps -ef|grep keepalived
</code></pre><div aria-hidden="true"><div></div></div></div><p>(4)查看vip(虚拟ip)</p>
<p>在网卡ens33下，多了一个<code>192.168.1.161</code>，这个就是虚拟ip</p>
<h5 id="_3、把keepalived注册为系统服务" tabindex="-1"> 3、把keepalived注册为系统服务</h5>
<p>(1)拷贝配置文件</p>
<ul>
<li>将keepalived目录下<code>etc/init.d/keepalived</code>拷贝到<code>/etc/init.d/</code>下</li>
<li>将keepalived目录下<code>etc/sysconfig/keepalived</code>拷贝到<code>/etc/sysconfig/</code>下</li>
</ul>
<p>(2)刷新systemctl</p>
<div><pre><code>systemctl daemon-reload
</code></pre><div aria-hidden="true"><div></div></div></div><p>(3)启动、停止、重启keepalived</p>
<div><pre><code>#启动
systemctl start keepalived.service
#停止
systemctl stop keepalived.service
#重启
systemctl restart keepalived.service
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h5 id="_4、实现双机主备高可用" tabindex="-1"> 4、实现双机主备高可用</h5>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346363259474.webp" alt="图片" loading="lazy"></p>
<p>(1)修改备机配置</p>
<div><pre><code>global_defs { 
    router_id keep_172 
} 
vrrp_instance VI_1 { 
    # 备用机设置为BACKUP 
    state BACKUP 
    interface ens33 
    virtual_router_id 51 
    # 权重低于MASTER 
    priority 80 
    advert_int 2 
    authentication { 
        auth_type PASS auth_pass 1111 
    }
    virtual_ipaddress {
        # 注意：主备两台的vip都是一样的，绑定到同一个vip 
        192.168.1.161 
    } 
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>(2) 启动 Keepalived</p>
<p>(3) 访问vip即可访问主机，当主机失效时访问vip就会访问到备机</p>
<h5 id="_5、keepalived配置nginx自动重启" tabindex="-1"> 5、keepalived配置nginx自动重启</h5>
<p>(1)编写脚本</p>
<p>在<code>/etc/keepalived/</code>下创建脚本<code>check_nginx_alive_or_not</code></p>
<div><pre><code>#!/bin/bash 

A=`ps -C nginx --no-header |wc -l` 
# 判断nginx是否宕机，如果宕机了，尝试重启 
if [ $A -eq 0 ];then 
    /usr/local/nginx/sbin/nginx 
    # 等待一小会再次检查nginx，如果没有启动成功，则停止keepalived，使其启动备用机 
    sleep 3 
        if [ `ps -C nginx --no-header |wc -l` -eq 0 ];then 
            killall keepalived 
        fi 
fi
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>(2)添加运行权限</p>
<div><pre><code>chmod +x /etc/keepalived/check_nginx_alive_or_not.sh
</code></pre><div aria-hidden="true"><div></div></div></div><p>(3)配置keepalived监听nginx脚本</p>
<div><pre><code>vrrp_script check_nginx_alive { 
    script "/etc/keepalived/check_nginx_alive_or_not.sh" 
    interval 2 # 每隔两秒运行上一行脚本 
    weight 10 # 如果脚本运行失败，则升级权重+10 
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>(4)在vrrp_instance中新增监控的脚本</p>
<div><pre><code>track_script { 
    check_nginx_alive # 追踪 nginx 脚本
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>(5)重启Keepalived使得配置文件生效</p>
<div><pre><code>systemctl restart keepalived
</code></pre><div aria-hidden="true"><div></div></div></div><h5 id="_6、keepalived双主热备" tabindex="-1"> 6、keepalived双主热备</h5>
<p>(1)配置DNS轮询</p>
<p>在同一个域名下配置两个ip，自行百度</p>
<p>(2)配置第一台主机</p>
<div><pre><code>global_defs {
    router_id keep_171 
} 
vrrp_instance VI_1 { 
    state MASTER i
    nterface ens33 
    virtual_router_id 51 
    priority 100 
    advert_int 1 
    authentication { 
        auth_type PASS 
        auth_pass 1111 
    } 
    virtual_ipaddress { 
        192.168.1.161 
    } 
} 

vrrp_instance VI_2  {
    state BACKUP 
    interface ens33 
    virtual_router_id 52 
    priority 80 
    advert_int 1 
    authentication { 
        auth_type PASS 
        auth_pass 1111 
    } 
    virtual_ipaddress { 
        192.168.1.162 
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>(3)配置第二台主机</p>
<div><pre><code>global_defs {
    router_id keep_172 
} 
vrrp_instance VI_1 { 
    state BACKUP 
    interface ens33 
    virtual_router_id 51 
    priority 80 
    advert_int 1 
    authentication { 
        auth_type PASS 
        auth_pass 1111 
    } 
    virtual_ipaddress { 
        192.168.1.161
    }
} 

vrrp_instance VI_2 {
    state MASTER 
    interface ens33 
    virtual_router_id 52 
    priority 100 
    advert_int 1 
    authentication { 
        auth_type PASS 
        auth_pass 1111 
    } 
    virtual_ipaddress { 
        192.168.1.162 
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>(4)重启两台Keepalived</p>
<div><pre><code>systemctl restart keepalived
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="七、lvs-linux-virtual-server-实现高可用负载均衡" tabindex="-1"> 七、LVS（Linux Virtual Server）实现高可用负载均衡</h3>
<h5 id="_1、为什么要使用lvs-nginx" tabindex="-1"> 1、为什么要使用LVS+Nginx</h5>
<ul>
<li>lvs基于四层负载均衡，工作效率较Nginx的七层负载更高，使用LVS搭建Nginx集群，可以提高性能</li>
<li>四层负载均衡无法对信息处理，只能通过ip+端口的形式转发，所以需要七成负载进行数据的处理</li>
<li>Nginx接收请求来回，LVS可以只接受不响应</li>
</ul>
<h5 id="_2、lvs的三种模式" tabindex="-1"> 2、LVS的三种模式</h5>
<p>(1)NAT模式</p>
<ul>
<li>客户端将请求发往LVS，LVS会选择一台服务器响应请求，服务器将结果返回给LVS，LVS再返回给客户端。</li>
<li>在NAT模式中，服务器的网关必须指向LVS，否则报文无法送达客户端</li>
<li>NAT 技术将请求的报文和响应的报文都需要通过LVS进行地址改写，因此网站访问量比较大的时候负载均衡调度器有比较大的瓶颈，一般要求最多之能 10-20 台节点</li>
<li>NAT 模式支持对 IP 地址和端口进行转换。即用户请求的端口和真实服务器的端口可以不一致</li>
</ul>
<p>(2)TUN模式</p>
<ul>
<li>客户端将请求发往LVS，LVS会选择一台服务器响应请求，在客户端与服务器之间建立隧道，返回结果的时候直接由服务器返回响应，不在经过LVS。</li>
<li>TUN模式必须所有的服务器上都绑定VIP的IP地址，所有的服务器都必须有网卡。</li>
<li>TUN模式走隧道运维难度大，并且会直接暴露服务器地址</li>
<li>服务器将应答包直接发给用户。所以，减少了负载均衡器的大量数据流动，负载均衡器不再是系统的瓶颈，就能处理很巨大的请求量，这种方式，一台负载均衡器能够为很多服务器进行分发。而且跑在公网上就能进行不同地域的分发</li>
</ul>
<p>(3)DR模式</p>
<ul>
<li>客户端将请求发往LVS，LVS会选择一台服务器响应请求，返回结果的时候通过统一的路由进行返回，不在经过LVS。</li>
<li>和TUN模式一样，LVS只是分发请求，应答包通过单独的路由返回给客户端，与TUN相比这种方式不需要隧道结构，可以兼容大多数的操作系统，同时统一路由可以隐藏真实的物理服务器。DR模式效率更高，但配置更复杂.</li>
<li>所有服务器节点和LVS只能在一个局域网里面。</li>
</ul>
<h5 id="_3、搭建lvs-dr模式" tabindex="-1"> 3、搭建LVS-DR模式</h5>
<p>先关闭掉服务器上网络配置管理器，避免网络接口冲突</p>
<div><pre><code>systemctl stop NetworkManager
systemctl disable NetworkManager
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>(1)创建子接口（创建LVS的虚拟ip）</p>
<p>进入网卡配置目录<code>/etc/sysconfig/network-scripts/</code>,找到网卡配置文件，这里以<code>ifcfg-ens33</code>为例，拷贝并创建子接口</p>
<div><pre><code>cp ifcfg-ens33 ifcfg-ens33:1
</code></pre><div aria-hidden="true"><div></div></div></div><p>修改子接口配置如下</p>
<ul>
<li>配置中的 192.168.1.150 就是vip，是提供给外网用户访问的ip地址</li>
</ul>
<div><pre><code>DEVICE="ens33:1"
ONBOOT="yes"
IPADDR=192.168.1.150
NETMASK=255.255.255.0
BOOTPROTO=static
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>重启网络服务</li>
</ul>
<div><pre><code>service network restart
</code></pre><div aria-hidden="true"><div></div></div></div><p>重启成功后，ip addr 查看一下，你会发现多了一个ip，也就是虚拟ip（vip）</p>
<blockquote>
<p>注意：阿里云不支持配置网卡，需要购买相应的负载均衡服务，腾讯云支持配置网卡，但需要购买网卡支持，一个网卡支持10个虚拟ip配置</p>
</blockquote>
<p>(2)安装ipvsadm</p>
<p>如今的centos都集成了LVS，所以ipvs是自带的，我们只需要安装ipvsadm即可（ipvsadm是管理集群的工具，通过ipvs可以管理集群，查看集群等操作）</p>
<div><pre><code>yum install ipvsadm
</code></pre><div aria-hidden="true"><div></div></div></div><p>(3)配置服务器（RS）的虚拟ip</p>
<p>进入网卡配置目录<code>/etc/sysconfig/network-scripts/</code>,找到<code>ifcfg-lo</code>，拷贝并创建子接口</p>
<div><pre><code>cp ifcfg-lo ifcfg-lo:1
</code></pre><div aria-hidden="true"><div></div></div></div><p>修改子接口配置如下</p>
<div><pre><code>DEVICE="lo:1"
IPADDR=192.168.1.150
NETMASK=255.255.255.255
NETWORK=127.0.0.0
BROADCAST=127.255.255.255
ONBOOT="yes"
NAME=loopback
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>重启网络服务成功后，<code>ip addr</code> 查看一下，你会发现多了一个ip，也就是虚拟ip（vip）</p>
<p>(4)为服务器（RS）配置arp</p>
<p>ARP响应级别与通告行为参数说明</p>
<div><pre><code>arp-ignore：ARP响应级别（处理请求）
    0：只要本机配置了ip，就能响应请求
    1：请求的目标地址到达对应的网络接口，才会响应请求
arp-announce：ARP通告行为（返回响应）
    0：本机上任何网络接口都向外通告，所有的网卡都能接受到通告
    1：尽可能避免本网卡与不匹配的目标进行通告2：只在本网卡通告
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>打开sysctl.conf:</p>
<div><pre><code>vim /etc/sysctl.conf
</code></pre><div aria-hidden="true"><div></div></div></div><p>配置所有网卡、默认网卡以及虚拟网卡的arp响应级别和通告行为，分别对应：all，default，lo</p>
<div><pre><code># configration for lvs 
net.ipv4.conf.all.arp_ignore = 1 
net.ipv4.conf.default.arp_ignore = 1 
net.ipv4.conf.lo.arp_ignore = 1 

net.ipv4.conf.all.arp_announce = 2 
net.ipv4.conf.default.arp_announce = 2 
net.ipv4.conf.lo.arp_announce = 2
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>刷新配置文件</p>
<div><pre><code>sysctl -p
</code></pre><div aria-hidden="true"><div></div></div></div><p>增加一个网关，用于接收数据报文，当有请求到本机后，会交给lo去处理</p>
<div><pre><code>route add -host 192.168.1.150 dev lo:1
</code></pre><div aria-hidden="true"><div></div></div></div><p>将网关添加至开机启动</p>
<div><pre><code>echo "route add -host 192.168.1.150 dev lo:1" >> /etc/rc.local
</code></pre><div aria-hidden="true"><div></div></div></div><p>(4)使用ipvsadm配置集群规则</p>
<p>创建LVS节点，用户访问的集群调度者</p>
<div><pre><code>ipvsadm -A -t 192.168.1.150:80 -s rr -p 5
</code></pre><div aria-hidden="true"><div></div></div></div><ul>
<li>-A：添加集群</li>
<li>-t：tcp协议ip地址：设定集群的访问</li>
<li>ip：也就是LVS的虚拟ip</li>
<li>-s：设置负载均衡的算法，</li>
<li>rr：表示轮询</li>
<li>-p：设置连接持久化的时间,在指定时间内同一个用户的请求会访问到同一个服务器中</li>
</ul>
<p>创建多台RS真实服务器</p>
<div><pre><code>ipvsadm -a -t 192.168.1.150:80 -r 192.168.1.171:80 -g 
ipvsadm -a -t 192.168.1.150:80 -r 192.168.1.172:80 -g
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><ul>
<li>-a：添加真实服务器</li>
<li>-t：tcp协议</li>
<li>-r：真实服务器的ip地址</li>
<li>-g：设定DR模式</li>
</ul>
<p>保存到规则库，否则重启失效</p>
<div><pre><code>ipvsadm -S
</code></pre><div aria-hidden="true"><div></div></div></div><p>检查集群</p>
<div><pre><code>#查看集群列表
ipvsadm -Ln
#查看集群状态
ipvsadm -Ln --stats
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p>一些其他命令</p>
<div><pre><code> # 重启ipvsadm，重启后需要重新配置 
 service ipvsadm restart 
 # 查看持久化连接 
 ipvsadm -Ln --persistent-conn 
 # 查看连接请求过期时间以及请求源ip和目标ip 
 ipvsadm -Lnc 
 # 设置tcp tcpfin udp 的过期时间（一般保持默认） 
 ipvsadm --set 1 1 1 
 # 查看过期时间 
 ipvsadm -Ln --timeout
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>(5)访问虚拟ip，完成LVS搭建</p>
<h3 id="附-lvs的负载均衡算法" tabindex="-1"> 附：LVS的负载均衡算法</h3>
<h5 id="_1-静态算法" tabindex="-1"> (1)静态算法</h5>
<p>静态：根据LVS本身自由的固定的算法分发用户请求。</p>
<ul>
<li>轮询（Round Robin 简写’rr’）：轮询算法假设所有的服务器处理请求的能力都一样的，调度器会把所有的请求平均分配给每个真实服务器。（同Nginx的轮询）</li>
<li>加权轮询（Weight Round Robin 简写’wrr’）：安装权重比例分配用户请求。权重越高，被分配到处理的请求越多。（同Nginx的权重）</li>
<li>源地址散列（Source Hash 简写’sh’）：同一个用户ip的请求，会由同一个RS来处理。（同Nginx的ip_hash）</li>
<li>目标地址散列（Destination Hash 简写’dh’）：根据url的不同，请求到不同的RS。（同Nginx的url_hash）</li>
</ul>
<h5 id="_2-动态算法" tabindex="-1"> (2)动态算法</h5>
<p>动态：会根据流量的不同，或者服务器的压力不同来分配用户请求，这是动态计算的。</p>
<ul>
<li>
<p>最小连接数（Least Connections 简写’lc’）：把新的连接请求分配到当前连接数最小的服务器。</p>
</li>
<li>
<p>加权最少连接数（Weight Least Connections 简写’wlc’）：服务器的处理性能用数值来代表，权重越大处理的请求越多。Real Server 有可能会存在性能上的差异，wlc动态获取不同服务器的负载状况，把请求分发到性能好并且比较空闲的服务器。</p>
</li>
<li>
<p>最短期望延迟（Shortest Expected Delay 简写’sed’）：特殊的wlc算法。举例阐述，假设有ABC三台服务器，权重分别为1、2、3 。如果使用wlc算法的话，当一个新请求进来，它可能会分给ABC中的任意一个。使用sed算法后会进行如下运算：</p>
</li>
<li>
<ul>
<li>A：（1+1）/1=2</li>
<li>B：（1+2）/2=3/2</li>
<li>C：（1+3）/3=4/3</li>
</ul>
</li>
</ul>
<p>最终结果，会把这个请求交给得出运算结果最小的服务器。最少队列调度（Never Queue 简写’nq’）：永不使用队列。如果有Real Server的连接数等于0，则直接把这个请求分配过去，不需要在排队等待运算了（sed运算）。</p>
<h3 id="八、搭建keepalived-lvs-nginx高可用集群负载均衡" tabindex="-1"> 八、搭建Keepalived+Lvs+Nginx高可用集群负载均衡</h3>
<p>如果原先服务器上配置了LVS+nginx需要清空ipvsadm中的配置</p>
<div><pre><code>ipvsadm -C
</code></pre><div aria-hidden="true"><div></div></div></div><p>如果配置了<code>Keepalived+Nginx</code>双主集群也需要去除掉Keepalived中原先的配置，按照的后文进行配置</p>
<h5 id="_1-使用keepalived配置master-lvs" tabindex="-1"> (1)使用keepalived配置Master LVS</h5>
<p>在LVS的机器上安装keepalived，安装过程参考上文</p>
<p>(1)修改keepalived的配置</p>
<div><pre><code>global_defs {
    router_id keep_151 
} 
vrrp_instance VI_1 { 
    state MASTER 
    interface ens33 
    virtual_router_id 41 
    priority 100 
    advert_int 1 
    authentication { 
        auth_type PASS 
        auth_pass 1111 
    } 
    virtual_ipaddress { 
        192.168.1.150
    }
} 

#配置集群访问的ip+端口，端口和nginx保持一致
virtual_server 192.168.1.150 80{
    #健康检查的时间，单位：秒
    delay_loop 6
    #配置负载均衡的算法，默认的轮询
    lb_algo rr
    #设置LVS的模式 NAT|TUN|DR
    lb-kind DR
    #设置会话持久化的时间
    persistence_timeout 5
    #协议
    protocol TCP
    
    #配置负载均衡的真实服务器，也就是nginx节点的具体的ip地址
    real_server 192.168.1.171 80{
        #轮询权重配比
        weight 1
        #设置健康检查
        TCP_CHECK {
            #检查80端口
            connect_port 80
            #超时时间
            connect_timeout 2
            #重试次数
            nb_get_retry 2
            #重试间隔时间
            delay_before_retry 3
        }
    }
    real_server 192.168.1.171 80{
        weight 1
        TCP_CHECK {
            connect_port 80
            connect_timeout 2
            nb_get_retry 2
            delay_before_retry 3
        }
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>(2)启动/重启keepalived</p>
<div><pre><code>systemctl restart keepalived
</code></pre><div aria-hidden="true"><div></div></div></div><h5 id="_2-使用keepalived配置backup-lvs" tabindex="-1"> (2)使用keepalived配置Backup LVS</h5>
<p>配置在备用机上</p>
<div><pre><code>global_defs {
    router_id keep_152 
} 
vrrp_instance VI_1 { 
    state  BACKUP
    interface ens33 
    virtual_router_id 41 
    priority 50 
    advert_int 1 
    authentication { 
        auth_type PASS 
        auth_pass 1111 
    } 
    virtual_ipaddress { 
        192.168.1.150
    }
} 

#配置集群访问的ip+端口，端口和nginx保持一致
virtual_server 192.168.1.150 80{
    #健康检查的时间，单位：秒
    delay_loop 6
    #配置负载均衡的算法，默认的轮询
    lb_algo rr
    #设置LVS的模式 NAT|TUN|DR
    lb-kind DR
    #设置会话持久化的时间
    persistence_timeout 5
    #协议
    protocol TCP
    
    #配置负载均衡的真实服务器，也就是nginx节点的具体的ip地址
    real_server 192.168.1.171 80{
        #轮询权重配比
        weight 1
        #设置健康检查
        TCP_CHECK {
            #检查80端口
            connect_port 80
            #超时时间
            connect_timeout 2
            #重试次数
            nb_get_retry 2
            #重试间隔时间
            delay_before_retry 3
        }
    }
    real_server 192.168.1.171 80{
        weight 1
        TCP_CHECK {
            connect_port 80
            connect_timeout 2
            nb_get_retry 2
            delay_before_retry 3
        }
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-01-16T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">SSH客户端软件</title>
    <id>https://blog.ciberviler.top/linux/SSH%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BD%AF%E4%BB%B6.html</id>
    <link href="https://blog.ciberviler.top/linux/SSH%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BD%AF%E4%BB%B6.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">SSH客户端软件</summary>
    <content type="html"><![CDATA[<h1 id="ssh客户端软件" tabindex="-1"> SSH客户端软件</h1>
<p>SSH客户端是在管理和配置Linux服务器用到很多的软件了，一款好的SSH管理软件不但可以让你更好地执行<a href="https://www.v1tx.com/post/linux-commands/" target="_blank" rel="noopener noreferrer">Linux命令</a>，对于工作效率的提升也是非常明显，在本文中我们就来介绍几款非常好用的SSH客户端软件</p>
<h2 id="xshell" tabindex="-1"> Xshell</h2>
<p>Xshell Plus Linux连接SSH工具 v7.0.0092 特别版</p>
<p><a href="https://lanzoui.com/b010yn1di" target="_blank" rel="noopener noreferrer">https://lanzoui.com/b010yn1di</a></p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/2019103708637-800x493.jpg" alt="Xshell" loading="lazy"></p>
<p><a href="https://www.netsarang.com/zh/xshell/" target="_blank" rel="noopener noreferrer">Xshell</a> 是国内比较流行的SSH软件，和其他的SSH客户端相比，Xshell更加注重用户体验的一些东西，比如其现代化的界面，多种语言包括简体中文支持，代码高亮等，对于新手非常友好。</p>
<p>Xshell中还提供了一些高级功能，比如标签管理、批量命令等，不过有一些为高级功能，需要升级付费版才能使用，当然，因为现在很多操作都可以在<a href="https://www.v1tx.com/post/best-hosting-control-panels/" target="_blank" rel="noopener noreferrer">网站面板</a>完成，对于新手来说，其实Xshell免费版本已经足够了，而专业人员使用频率足够高的话付费购买也是非常值得的</p>
<h2 id="finalshell" tabindex="-1"> Finalshell</h2>
<p>FinalShell v3.9.2 破解版SSH工具</p>
<p><a href="https://lanzoui.com/iAZxSx022ah" target="_blank" rel="noopener noreferrer">https://lanzoui.com/iAZxSx022ah</a></p>
<ul>
<li>点击菜单-&gt;激活/升级-&gt;登陆/激活，即破解离线激活高级版！</li>
</ul>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/20190911171724.jpg" alt="img" loading="lazy"></p>
<p><a href="http://www.hostbuf.com/" target="_blank" rel="noopener noreferrer">Finalshell</a> 是一款国人开发的远程连接工具，支持 Windows、Linux 和 macOS，通过界面我们可以看出这款软件非常强大，你不仅可以在远程窗口上执行命令，还可以实时监测到系统的消耗，比如CPU、内存、网络等资源的使用量</p>
<p>Finalshell 还有比较方便的一点就是文件的传输，在软件的右下角有一个文件夹管理界面，让你可以像在<a href="https://www.v1tx.com/post/best-ftp-client/" target="_blank" rel="noopener noreferrer">FTP软件</a>中那样传输文件，支持右键上传下载，支持鼠标拖拽文件上传到服务器，省去了很多命令行的繁琐步骤</p>
<p>除了基础功能，Finalshell 还可以升级到专业版，包括打包传输、高级网络监控、高级进程管理、多地点ping监控等</p>
<h2 id="windterm-v2-2-0" tabindex="-1"> WindTerm v2.2.0</h2>
<p>连接SSH/Telnet/Serial/Shell/Sftp开源工具</p>
<p>项目地址:<a href="https://github.com/kingToolbox/WindTerm/" target="_blank" rel="noopener noreferrer">https://github.com/kingToolbox/WindTerm/</a>
<a href="https://lanzoui.com/iafhqwr0fba" target="_blank" rel="noopener noreferrer">https://lanzoui.com/iafhqwr0fba</a></p>
<h2 id="nxshell-v1-4-6" tabindex="-1"> NxShell v1.4.6</h2>
<p>绿色版/安装版 : <a href="https://lanzoui.com/b010z3paf" target="_blank" rel="noopener noreferrer">https://lanzoui.com/b010z3paf</a></p>
<h2 id="mobaxterm" tabindex="-1"> MobaXterm</h2>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/2019101843976-800x496.jpg" alt="MobaXterm" loading="lazy"></p>
<p><a href="https://mobaxterm.mobatek.net/" target="_blank" rel="noopener noreferrer">MobaXterm</a> 是一个功能强大的SSH工具，除了支持基本的SSH终端管理外，还有非常多的增强和扩展功能</p>
<ul>
<li>有绿色版本软件，使用方便</li>
<li>多标签管理，随时切换</li>
<li>支持SSH、Telent、FTP、SFTP等多种协议</li>
<li>支持RDP远程连接Windows</li>
<li>图形化SFTP管理，可上传下载文件</li>
<li>内置MobaTextEditor，可以直接在服务端编辑和保存文件</li>
<li>应用内分屏，最多支持4个屏幕</li>
<li>支持安装插件</li>
</ul>
<p>MobaXterm 是一个非常好的一站式服务器管理工具，对于多种协议的支持，让其不管是Linux、Windows还是VNC等，都可以在一个软件中进行操作管理，配合内置的SFTP文件管理和MobaTextEditor，可以让远程终端文件管理更加便捷</p>
<p><a href="https://www.v1tx.com/post/mobaxterm/" target="_blank" rel="noopener noreferrer">MobaXterm 多功能的Windows终端工具</a></p>
<h2 id="termius" tabindex="-1"> Termius</h2>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/20200101100956-1024x670.jpg" alt="img" loading="lazy"></p>
<p><a href="https://termius.com/" target="_blank" rel="noopener noreferrer">Termius</a> 是一款全平台的SSH客户端，该软件最大的特点就是支持全部平台，包括Windows、Mac、Linux、iOS、Android等，有了移动设备支持，只要有网络，你可以在任何时间地点管理服务器</p>
<p>如果你的工作经常用到SSH连接，还可以升级高级版实现全平台同步，全平台的好处就是只要你在一个平台添加或修改了服务器，其他平台会自动同步，随时随地管理主机，而且也不用在手机上输入复杂的密码了</p>
<p>在功能上，Termius 也有很多实用的东西，比如SFTP、代码片段、选项卡等，可以省下很多事情</p>
<h2 id="putty" tabindex="-1"> PuTTY</h2>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/2019163024711-800x505.jpg" alt="PuTTY" loading="lazy"></p>
<p><a href="https://www.putty.org/" target="_blank" rel="noopener noreferrer">PuTTY</a> 是一款开源免费的SSH客户端，支持SCP，SSH，Telnet，rlogin等多种网络协议，该软件的特点非常小巧，大小只有1M左右， 而且有绿色版本下载下来就能使用，再加上其开源的特性，很多人都一直在使用PuTTY管理Linux服务器，不过由于软件是全英文的界面，而且有些东西需要学习设置，对新手来说可能并不是那么友好</p>
<h2 id="simpleremote" tabindex="-1"> SimpleRemote</h2>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/20190911170438-1024x568.jpg" alt="img" loading="lazy"></p>
<p><a href="http://www.91fk.net/" target="_blank" rel="noopener noreferrer">SimpleRemote</a> 是一款免费开源的远程连接管理工具，软件非常的小巧，解压后只有不到3MB的大小</p>
<p>虽然是一款很小的软件，但是基本远程连接功能都有，比如常用的多标签、配色方案、密钥连接、RDP、Telnet等，对于大多数人来说，功能完全够用，而且对于重要的信息，还可以为SimpleRemote设置打开密码，只有输入正确的密码才能使用</p>
<h2 id="zoc-terminal" tabindex="-1"> ZOC Terminal</h2>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/2019171854023-800x570.jpg" alt="ZOC Terminal" loading="lazy"></p>
<p><a href="https://www.emtec.com/zoc/" target="_blank" rel="noopener noreferrer">ZOC Terminal</a> 是一款强大的终端模拟器，其支持Windows和Mac平台，软件使用很方便，可以快速连接、也可以保存主机，支持多标签、多窗口，如果你对基础的界面不满意，还可以定制样式，包括背景、字体、颜色等，组成自己喜欢的界面，不过这款软件并没有提供免费版本，需要付费购买</p>
<h2 id="juicessh" tabindex="-1"> JuiceSSH</h2>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/20201202073329-1024x499.jpg" alt="Android SSH客户端 JuiceSSH" loading="lazy"></p>
<p><a href="https://juicessh.com/" target="_blank" rel="noopener noreferrer">JuiceSSH</a> 是一款Android上的免费SSH客户端，你可以用它快速连接到Linux服务器，也可以添加账号密码或密钥保存多台机器，Juice 让你在手机上就能非常方便地执行这些操作</p>
<p>它的主要功能有</p>
<ul>
<li>全彩色终端显示，多个主题可选</li>
<li>轻松输入，弹出键盘可以方便地输入常用的特殊字符</li>
<li>Telnet 和 本地 Shell 命令执行</li>
<li>第三方插件支持，比如性能监控、OpenSSH导入等</li>
<li>其他高级功能</li>
</ul>
<p>对于想要在安卓手机上管理服务器的人来说，JuiceSSH 是一个非常好的选择，免费版本以及足够使用，付费版还有更多强大功能，包括端口转发、自动执行代码段、快捷方式等，能够极大提升运维效率</p>
<h2 id="servercat" tabindex="-1"> ServerCat</h2>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/20201202073517-1024x515.jpg" alt="iOS SSH客户端 ServerCat" loading="lazy"></p>
<p><a href="https://apps.apple.com/cn/app/servercat-linux-%E7%9B%91%E6%8E%A7-ssh-%E7%BB%88%E7%AB%AF/id1501532023" target="_blank" rel="noopener noreferrer">ServerCat</a> 是一款iOS平台上的Linux管理软件，它可以让你在iPhone上连接远程服务器，用来监视系统性能、管理Docker和执行SSH命令，软件内提供了很多监控参数，比如CPU、内存、系统负载、网速、硬盘等，并且以可视化的形式展示，你可以随时查看自己服务器的系统状态，避免因负载过高则影响产品服务</p>
<h2 id="shellfish" tabindex="-1"> ShellFish</h2>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/20210719141114-1024x517.jpg" alt="iPhone和iPad上的SSH客户端 ShellFish" loading="lazy"></p>
<p><a href="https://apps.apple.com/cn/app/secure-shellfish/id1336634154" target="_blank" rel="noopener noreferrer">ShellFish</a> 是一款SFTP和SSH结合的软件，支持iPhone和iPad，你可以用它来连接远程服务并管理上面的文件，它专为移动设备做了很多优化，比如你可以使用SFTP管理服务器上的文件，使用专用键盘执行命令，创建代码片段快速使用等，而且还有一个很不错的地方在于它是支持<a href="https://www.v1tx.com/post/shortcuts/" target="_blank" rel="noopener noreferrer">快捷指令</a>的，你可以和其他APP配合使用，使用语音执行命令等</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-01-17T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">python安装源</title>
    <id>https://blog.ciberviler.top/linux/python%E5%AE%89%E8%A3%85%E6%BA%90.html</id>
    <link href="https://blog.ciberviler.top/linux/python%E5%AE%89%E8%A3%85%E6%BA%90.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">python安装源</summary>
    <content type="html"><![CDATA[<h1 id="python安装源" tabindex="-1"> python安装源</h1>
<p>在<code>C:\Users\Administrator\pip</code>下，新建<code>pip.ini</code>，输入以下内容：</p>
<div><pre><code><span>[</span><span>global</span><span>]</span>
timeout <span>=</span> <span>6000</span>
index<span>-</span>url <span>=</span> https<span>:</span><span>//</span>mirrors<span>.</span>aliyun<span>.</span>com<span>/</span>pypi<span>/</span>simple<span>/</span>
<span>[</span>install<span>]</span>
use<span>-</span>mirrors <span>=</span> true
mirrors <span>=</span> https<span>:</span><span>//</span>mirrors<span>.</span>aliyun<span>.</span>com<span>/</span>pypi<span>/</span>simple<span>/</span>
trusted<span>-</span>host <span>=</span> mirrors<span>.</span>aliyun<span>.</span>com
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>其他：</p>
<div><pre><code><span>[</span><span>global</span><span>]</span>
<span># 阿里云</span>
index<span>-</span>url <span>=</span> https<span>:</span><span>//</span>mirrors<span>.</span>aliyun<span>.</span>com<span>/</span>pypi<span>/</span>simple<span>/</span> 
<span># 清华大学</span>
<span># index-url = https://pypi.tuna.tsinghua.edu.cn/simple/</span>
<span># 中国科技大学</span>
<span># index-url = https://pypi.mirrors.ustc.edu.cn/simple/ </span>
<span># 豆瓣</span>
<span># index-url = http://pypi.douban.com/simple </span>
<span># Python官方</span>
<span># index-url = https://pypi.python.org/simple/ </span>
<span># v2ex</span>
<span># index-url = http://pypi.v2ex.com/simple/ </span>
<span># 中国科学院</span>
<span># index-url = http://pypi.mirrors.opencas.cn/simple/ </span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-01-19T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">StartAllBack</title>
    <id>https://blog.ciberviler.top/pc/StartAllBack(StartIsBack)v3.2.1Stable.html</id>
    <link href="https://blog.ciberviler.top/pc/StartAllBack(StartIsBack)v3.2.1Stable.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">StartAllBack</summary>
    <content type="html"><![CDATA[<h1 id="startallback" tabindex="-1"> StartAllBack</h1>
<p>StartAllBack(StartIsBack) v3.2.1 Stable</p>
<p>Windows11开始菜单增强工具StartAllBack正式版发布了！在任务栏上为Windows 11恢复经典样式的Windows 7主题风格开始菜单，主要功能包括：恢复和改进开始菜单样式、个性化任务栏、资源管理器等功能。</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/2021101417221273.png" alt="img" loading="lazy"></p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/2021101417221337.png" alt="StartAllBack(StartIsBack++) v3.2.1 Stable" loading="lazy">
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/2021101417221672.png" alt="StartAllBack(StartIsBack++) v3.2.1 Stable" loading="lazy">
<img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/2021101417221711.png" alt="StartAllBack(StartIsBack++) v3.2.1 Stable" loading="lazy"></p>
<h2 id="新版变化" tabindex="-1"> 新版变化</h2>
<p>StartIsBack for Windows 11
<a href="https://www.startallback.com/" target="_blank" rel="noopener noreferrer">https://www.startallback.com/</a></p>
<p>2021.12.18 v3.2.1
- 修复 Xbox 应用大小未调整的问题
- 修复更新或重启后选项丢失的问题</p>
<p>最近主要更新：
- 支持DEV渠道开发者预览版~22500
- 支持带有经典任务栏中心的开始菜单</p>
<p><strong>特点描述</strong></p>
<p>√ 破解免激活，无30天试用期，无哭脸表情水印！
√ 全面更新中文语言翻译，优化对齐简体中文字串
√ 剥离升级程序，无升级提示弹窗，去选项检查更新项
√ 采用原版7zSFX自解压形式重新打包，支持静默安装</p>
<p>静默安装参数：/ai /gm2
无人值守安装示例：
<code>StartAllBack_Repack.exe /ai /gm2</code>
或右键解压后执行：
<code>StartAllBackCfg.exe /install /elevated /silent</code></p>
<h2 id="下载地址" tabindex="-1"> 下载地址</h2>
<hr>
<p>Win11经典开始菜单 StartAllBack v3.2.1.4211 中文破解版</p>
<p><a href="https://www.123pan.com/s/A6cA-ODHJh" target="_blank" rel="noopener noreferrer">https://www.123pan.com/s/A6cA-ODHJh</a></p>
<p><a href="https://423down.lanzouo.com/b0f1rgl8j" target="_blank" rel="noopener noreferrer">https://423down.lanzouo.com/b0f1rgl8j</a></p>
<p><a href="https://pan.baidu.com/s/1nBlz81CCOQDPcKgkKEF-jg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1nBlz81CCOQDPcKgkKEF-jg</a></p>
<hr>
<p>StartAllBack 3.2.1.4211 Final (2021/12/18)
<a href="https://s3.amazonaws.com/startisback/StartAllBack_3.2.1_setup.exe" target="_blank" rel="noopener noreferrer">https://s3.amazonaws.com/startisback/StartAllBack_3.2.1_setup.exe</a></p>
<p>StartAllBack v2.x-3.x+ Patch (2021/10/13)
<a href="https://423down.lanzouo.com/i1YBsva4eqf" target="_blank" rel="noopener noreferrer">https://423down.lanzouo.com/i1YBsva4eqf</a></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-01-16T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">win10快捷键</title>
    <id>https://blog.ciberviler.top/pc/win10%E5%BF%AB%E6%8D%B7%E9%94%AE.html</id>
    <link href="https://blog.ciberviler.top/pc/win10%E5%BF%AB%E6%8D%B7%E9%94%AE.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">win10快捷键</summary>
    <content type="html"><![CDATA[<h1 id="win10快捷键" tabindex="-1"> win10快捷键</h1>
<h3 id="_1-win10-自定义" tabindex="-1"> 1.win10 自定义</h3>
<p>Win 10 下快捷方式设置了快捷键一直无法呼出。</p>
<p>在目录：</p>
<p>C:\Users\xxxxxx\AppData\Roaming\Microsoft\Windows\Start Menu\Programs</p>
<p>将要运行的程序的快捷方式放在这里，在快捷方式上--&gt;右键--&gt;属性增加快捷键即可呼出应用。</p>
<h3 id="_2-winhotkey" tabindex="-1"> 2.WinhotKey</h3>
<p><em>WinhotKey</em>是一款专业的全局快捷键设置软件,可以通过设置热键来实现相应的动作,包括打开文件或文件夹、调用Windows各种功能、执行相应动作等</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-02-07T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">卸载windows服务，删除 windows 服务</title>
    <id>https://blog.ciberviler.top/pc/%E5%88%A0%E9%99%A4%20windows%20%E6%9C%8D%E5%8A%A1.html</id>
    <link href="https://blog.ciberviler.top/pc/%E5%88%A0%E9%99%A4%20windows%20%E6%9C%8D%E5%8A%A1.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">卸载windows服务，删除 windows 服务</summary>
    <content type="html"><![CDATA[<h1 id="卸载windows服务-删除-windows-服务" tabindex="-1"> 卸载windows服务，删除 windows 服务</h1>
<h2 id="方法-步骤" tabindex="-1"> 方法/步骤</h2>
<ol>
<li>
<p>1</p>
<p>windows提供了基于命令窗口删除服务的功能，就是在命令窗口输入</p>
<p><strong>sc delete 服务名称</strong></p>
<p>在窗口输入上面的命令就能删除了。下面详细说明。</p>
</li>
<li>
<p>2</p>
<p><strong>确定&quot;服务名称&quot;</strong>，&quot;服务名称&quot;并不是我们在服务列表里直接看到的名称，我们看到的是服务的&quot;显示名称&quot;,查看服务名称的方法，就是在要删除的服务上右击，选择&quot;属性&quot;，这时就能看到真正的&quot;服务名称&quot;。比如下面的例子我们要删除“SQL Server Browser”服务，其真实的服务名称为“SQLBrowser”</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/d9a8d2d2bb665159594c639f8fe23ea23b42c7a1.jpg" alt="怎么卸载windows服务，删除 windows 服务" loading="lazy"></p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/116b1ae23ea23a424176d3a53733ec3835bbc0a1.jpg" alt="怎么卸载windows服务，删除 windows 服务" loading="lazy"></p>
</li>
<li>
<p>3</p>
<p><strong>执行”sc delete 服务名称“</strong>，打开命令窗口，输入  ”sc delete &quot;+刚才查看到的服务名称，回车就会提示删除成功。这里我们输入  <code>sc delete SQLBrowser</code> ，提示删除成功后，在服务窗口列表里也删除掉了。</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/a151a233ec3834bbffe3d1ea8714c27bd3823da6.jpg" alt="怎么卸载windows服务，删除 windows 服务" loading="lazy"></p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/0d55dc7bd28286894d4ac40465f97fbd4d7c37a6.jpg" alt="怎么卸载windows服务，删除 windows 服务" loading="lazy"></p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/7efc527c34b33c41c0b6a0f4887de137c8762ea6.jpg" alt="怎么卸载windows服务，删除 windows 服务" loading="lazy"></p>
</li>
</ol>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-01-27T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">安装WSA-激活GPU-双击安装APK</title>
    <id>https://blog.ciberviler.top/pc/%E5%AE%89%E8%A3%85WSA-%E6%BF%80%E6%B4%BBGPU-%E5%8F%8C%E5%87%BB%E5%AE%89%E8%A3%85APK.html</id>
    <link href="https://blog.ciberviler.top/pc/%E5%AE%89%E8%A3%85WSA-%E6%BF%80%E6%B4%BBGPU-%E5%8F%8C%E5%87%BB%E5%AE%89%E8%A3%85APK.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">安装WSA-激活GPU-双击安装APK</summary>
    <content type="html"><![CDATA[<h1 id="安装wsa-激活gpu-双击安装apk" tabindex="-1"> 安装WSA-激活GPU-双击安装APK</h1>
<p>仅支持Windows11（包含正式版、RP、Beta、Dev）
》》》 目 录 《《《
1.安装WSA本体（必装）
2.激活GPU（普通用户请跳过！！！）
3.安装“安装程序”（选装）
4.安装ADB（选装）
5.安装Android应用
6.卸载Android应用
7.注意事项
8.参考链接</p>
<p>【1 安装WSA本体】
-
① 微软商店程序抓包网址： <a href="https://store.rg-adguard.net/" target="_blank" rel="noopener noreferrer">查看链接</a>
② WSA微软商店链接： <a href="https://www.microsoft.com/store/productId/9P3395VX91NR" target="_blank" rel="noopener noreferrer">查看链接</a>
-
1.打开①链接，在输入框中输入②，选择Slow通道，确认，下载最底下的&quot;MicrosoftCorporationII.WindowsSubsystemForAndroid_1.7.32815.0_neutral_~_8wekyb3d8bbwe.msixbundle&quot;
(注：四个选项与Windows渠道相对应，Fast-Dev渠道，Slow-Beta渠道，RP-RP渠道和Retail-正式版，目前只有Beta版本有发布)</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_b9fb4b26_4742_3909@854x219.png.m.jpg" alt="img" loading="lazy"></p>
<p>输入下载地址，选择正确通道</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_6e58f04a_4742_3911@1234x333.png.m.jpg" alt="img" loading="lazy"></p>
<p>选择最新安装包</p>
<p>2.右键Windodws徽标，选择&quot;Windows终端（管理员）&quot;输入命令 add-appxpackage &quot;文件路径/文件名&quot;，回车，安装完成</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_d413f6bb_4742_3913@834x644.png.m.jpg" alt="img" loading="lazy"></p>
<p>打开终端</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_6907ae9d_4742_3915@1129x631.png.m.jpg" alt="img" loading="lazy"></p>
<p>输入指令</p>
<p>3.开启主板虚拟化支持，具体按照各BIOS进行设置（新购买电脑一般已开启主板虚拟化支持）
4.系统中开启Hyper-V和虚拟机平台，打开资源管理器，在路径中输入中文&quot;控制面板&quot;，回车，即可进入控制面板，选择程序-程序和功能-启用或关闭Windows功能，开启&quot;Hyper-V&quot;和&quot;虚拟机平台&quot;，确定，重启</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_fac9b857_1334_2244@1499x962.png.m.jpg" alt="img" loading="lazy"></p>
<p>资源管理器可以直接进入控制面板</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_c335fb7e_1334_2246@1499x962.png.m.jpg" alt="img" loading="lazy"></p>
<p>按图开启Windows功能</p>
<p>5.完成，Enjoy it.</p>
<p>【2 激活GPU】（普通用户无需进行该项设置！！！）
-
INTEL英特尔：
<a href="https://www.intel.com/content/www/us/en/download/19344/intel-graphics-windows-10-windows-11-dch-drivers.html" target="_blank" rel="noopener noreferrer">查看链接</a>
NVIDIA英伟达（经验证无效，请使用官网最新驱动）：
<a href="https://developer.nvidia.com/cuda/wsl/download" target="_blank" rel="noopener noreferrer">查看链接</a>
AMD超微半导体：
<a href="https://www.amd.com/en/support/kb/release-notes/rn-rad-win-wsl-support" target="_blank" rel="noopener noreferrer">查看链接</a>
opengl3支持：
<a href="https://www.microsoft.com/store/productId/9NQPSL29BFFF" target="_blank" rel="noopener noreferrer">查看链接</a>
-
1.下载安装对应显卡驱动和opengl3支持，安装后重启
（注：具体是否成功受概率等玄学因素影响，Intel驱动如果安装失败可尝试再次安装；未测试是否影响调用，建议普通用户跳过该步骤）
2.设置中开启高性能模式，设置-系统-显示-图形，应用的自定义选项-浏览，添加WSA，选择WSA，图形首选项选择高性能，保存</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_7b0d9d68_3027_155@1775x1115.png.m.jpg" alt="img" loading="lazy"></p>
<p>打开设置</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_d40bb361_3027_1552@1775x1115.png.m.jpg" alt="img" loading="lazy"></p>
<p>添加WSA</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_6185d916_3027_1554@1775x1115.png.m.jpg" alt="img" loading="lazy"></p>
<p>选项中选择高性能模式</p>
<p>3.显卡设置中开启高性能模式（以N卡为例，集显和A卡请自测），NVIDIA控制面板-管理3D设置-添加-选择WSA，确定，并调整WSA首选图形处理器为高性能NVIDIA处理器</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_1a2bee58_3028_9618@974x1199.png.m.jpg" alt="img" loading="lazy"></p>
<p>打开NVIDIA控制面板并添加WSA</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_c9c477e5_3028_9619@974x718.png.m.jpg" alt="img" loading="lazy"></p>
<p>选择高性能NVIDIA处理器</p>
<p>4.重启，完成</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_451e5133_3028_9621@503x909.png.m.jpg" alt="img" loading="lazy"></p>
<p>安兔兔GPU显示分数，但很低</p>
<p>【3 安装“安装程序”】
-
APKInstaller： <a href="https://github.com/Paving-Base/APK-Installer/releases" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_b0236f41_4742_3917@835x388.png.m.jpg" alt="img" loading="lazy"></p>
<p>安装程序可以直接桌面显示apk且可以双击安装</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_76800999_4742_3919@636x405.png.m.jpg" alt="img" loading="lazy"></p>
<p>以WinUi的界面进行安卓程序的安装</p>
<p>-
1.下载最新压缩包，如&quot;APKInstaller.Package._0.0.1.0_Test.rar&quot;
2.解压缩
3.开启旁加载模式，设置-隐私和安全性-开发者选项-开启&quot;从任意源（包括松散文件）安装应用&quot;</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_3f879f05_4742_392@1775x1115.png.m.jpg" alt="img" loading="lazy"></p>
<p>打开开发人员模式</p>
<p>4.右键msixbundle文件，如&quot;APKInstaller (Package)_0.0.1.0_x86_x64_arm64.msixbundle&quot;，属性-数字签名-双击签名列表中的签名-查看证书-安装证书-本地计算机-将所有的证书都放入下列储存-受信任人-完成</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_e89acd6b_6561_4202@1352x952.png.m.jpg" alt="img" loading="lazy"></p>
<p>打开属性</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_ef4554ea_4742_3922@2091x745.png.m.jpg" alt="img" loading="lazy"></p>
<p>安装程序证书 1</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_bef29485_4742_3924@1072x746.png.m.jpg" alt="img" loading="lazy"></p>
<p>安装程序证书 2</p>
<p>5.双击msixbundle文件，如&quot;APKInstaller (Package)_0.0.1.0_x86_x64_arm64.msixbundle&quot;，自动安装框架，然后提示安装失败
6.右键&quot;Install.ps1&quot;选择&quot;使用PowerShell运行&quot;</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_ee8ded6d_4746_3735@1352x952.png.m.jpg" alt="img" loading="lazy"></p>
<p>安装程序本体</p>
<p>7.安装完成</p>
<p>【4 安装ADB】
-
最新ADB： <a href="https://dl.google.com/android/repository/platform-tools-latest-windows.zip" target="_blank" rel="noopener noreferrer">查看链接</a>
-
1.下载解压缩，将文件夹内的所有文件复制到&quot;C:\Users\用户名&quot;下即可</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_772f1dd4_4746_3737@1365x957.png.m.jpg" alt="img" loading="lazy"></p>
<p>安装adb在正确的位置，无需配置环境变量</p>
<p>【5 安装Android应用】
-
方法一（ADB安装）：
1.打开&quot;Windows Subsystem for Android™&quot;，打开&quot;开发人员模式&quot;</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_43576668_4746_3739@1003x813.png.m.jpg" alt="img" loading="lazy"></p>
<p>打开WSA</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_2a149b56_4746_374@1200x932.png.m.jpg" alt="img" loading="lazy"></p>
<p>开启开发人员模式，注意未启动WSA不能安装程序</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_9f6776e4_4746_3742@636x388.png.m.jpg" alt="img" loading="lazy"></p>
<p>启动WSA</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/538951_ffb679db_4746_3744@1200x932.png.m.jpg" alt="img" loading="lazy"></p>
<p>启动成功，可以安装应用</p>
<p>2.确保已正确安装ADB，Win+R，输入&quot;CMD&quot;，回车，输入指令&quot;adb connect 127.0.0.1:58526&quot;
3.&quot;adb install （将安装文件拖入此处）&quot;，回车，安装完成
-
方法二（安装器安装）：
1.确保已正确安装APKInstaller，双击.apk的安卓程序进行安装，根据指引打开&quot;开发人员模式&quot;
（注：Android子系统必须处于开机状态才能进行安装，可以点击WSA中&quot;开发人员模式&quot;下&quot;管理开发人员设置&quot;唤醒）</p>
<p>【6 卸载Android应用】
-
1.列表中直接右键卸载即可</p>
<p>【7 注意事项】
1.该教程基于Windows11专业版制作，如家庭版没有某些选项，可以百度其他打开的方式
2.如果遇到鼠标无法点击的情况，如登录酷安，可以使用tab键切换组件
3.提示WiFi连接问题：<a href="https://www.uso.cn/post/view/47990" target="_blank" rel="noopener noreferrer">查看链接</a>
4.PowerShell运行ps1文件的问题：<a href="https://m.jb51.net/os/win10/728455.html" target="_blank" rel="noopener noreferrer">查看链接</a>
5.Windows家庭版没有PowerShell的问题：<a href="https://blog.csdn.net/houmenghu/article/details/103876847" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p>【8 参考链接】
-
WSA安装： <a href="https://www.coolapk.com/feed/30833815?shareKey=NGRjZTFhMjYxNTQ2NjE3MmNmMmU~&amp;shareUid=538951&amp;shareFrom=com.coolapk.market_11.4.3" target="_blank" rel="noopener noreferrer">查看链接</a>
GPU驱动： <a href="https://www.coolapk.com/feed/30854918?shareKey=Y2ZiMjNmN2E4NWM2NjE3MmNmMmU~&amp;shareUid=538951&amp;shareFrom=com.coolapk.market_11.4.3" target="_blank" rel="noopener noreferrer">查看链接</a>
APKInstaller： <a href="https://www.coolapk.com/feed/30857122?shareKey=OTAzN2JmMDBmZTg3NjE3MmNmMDM~&amp;shareUid=538951&amp;shareFrom=com.coolapk.market_11.4.3" target="_blank" rel="noopener noreferrer">查看链接</a></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-02-11T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">开源后台管理系统</title>
    <id>https://blog.ciberviler.top/source_code/%E5%BC%80%E6%BA%90%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html</id>
    <link href="https://blog.ciberviler.top/source_code/%E5%BC%80%E6%BA%90%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">开源后台管理系统</summary>
    <content type="html"><![CDATA[<h1 id="开源后台管理系统" tabindex="-1"> 开源后台管理系统</h1>
<p><strong>1. D2admin</strong></p>
<p>开源地址：<a href="https://github.com/d2-projects/d2-admin" target="_blank" rel="noopener noreferrer">https://github.com/d2-projects/d2-admin</a></p>
<p>文档地址：<a href="https://d2.pub/zh/doc/d2-admin/" target="_blank" rel="noopener noreferrer">https://d2.pub/zh/doc/d2-admin/</a></p>
<p>效果预览：<a href="https://d2.pub/d2-admin/preview/#/index" target="_blank" rel="noopener noreferrer">https://d2.pub/d2-admin/preview/#/index</a></p>
<p>开源协议：MIT</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346319611813.webp" alt="图片" loading="lazy">图片</p>
<p><strong>2. vue-element-admin</strong></p>
<p>开源地址：<a href="https://github.com/PanJiaChen/vue-element-admin" target="_blank" rel="noopener noreferrer">https://github.com/PanJiaChen/vue-element-admin</a></p>
<p>文档地址：<a href="https://panjiachen.github.io/vue-element-admin-site/zh/" target="_blank" rel="noopener noreferrer">https://panjiachen.github.io/vue-element-admin-site/zh/</a></p>
<p>效果预览：<a href="https://d2.pub/d2-admin/preview/#/index" target="_blank" rel="noopener noreferrer">https://d2.pub/d2-admin/preview/#/index</a></p>
<p>开源协议：MIT</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346319611814.webp" alt="图片" loading="lazy">图片</p>
<p><strong>3. JEECG-BOOT</strong></p>
<p>开源地址：<a href="https://github.com/zhangdaiscott/jeecg-boot" target="_blank" rel="noopener noreferrer">https://github.com/zhangdaiscott/jeecg-boot</a></p>
<p>文档地址：<a href="https://panjiachen.github.io/vue-element-admin-site/zh/" target="_blank" rel="noopener noreferrer">https://panjiachen.github.io/vue-element-admin-site/zh/</a></p>
<p>效果预览：<a href="http://boot.jeecg.com/" target="_blank" rel="noopener noreferrer">http://boot.jeecg.com/</a></p>
<p>开源协议：Apache-2.0 License</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346319611815.webp" alt="图片" loading="lazy">图片</p>
<h1 id="_4-gin-vue-admin" tabindex="-1"> <strong>4. GIN-VUE-ADMIN</strong></h1>
<p>开源地址：<a href="https://github.com/flipped-aurora/gin-vue-admin" target="_blank" rel="noopener noreferrer">https://github.com/flipped-aurora/gin-vue-admin</a></p>
<p>文档地址：<a href="https://www.gin-vue-admin.com/" target="_blank" rel="noopener noreferrer">https://www.gin-vue-admin.com/</a></p>
<p>效果预览：<a href="http://demo.gin-vue-admin.com/#/layout/dashboard" target="_blank" rel="noopener noreferrer">http://demo.gin-vue-admin.com/#/layout/dashboard</a></p>
<p>开源协议：Apache-2.0 License</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346319611816.webp" alt="图片" loading="lazy">图片</p>
<h1 id="_5-vue-admin-beautiful" tabindex="-1"> <strong>5. vue-admin-beautiful</strong></h1>
<p>开源地址：<a href="https://github.com/chuzhixin/vue-admin-beautiful" target="_blank" rel="noopener noreferrer">https://github.com/chuzhixin/vue-admin-beautiful</a></p>
<p>文档地址：<a href="https://www.gin-vue-admin.com/" target="_blank" rel="noopener noreferrer">https://www.gin-vue-admin.com/</a></p>
<p>效果预览：<a href="http://beautiful.panm.cn/" target="_blank" rel="noopener noreferrer">http://beautiful.panm.cn/</a></p>
<p>开源协议：MPL-2.0 License</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346319611817.webp" alt="图片" loading="lazy">图片</p>
<p><strong>6. Dcat-admin</strong></p>
<p>开源地址：<a href="https://github.com/jqhph/dcat-admin" target="_blank" rel="noopener noreferrer">https://github.com/jqhph/dcat-admin</a></p>
<p>文档地址：<a href="http://www.dcatadmin.com/" target="_blank" rel="noopener noreferrer">http://www.dcatadmin.com/</a></p>
<p>效果预览：<a href="http://103.39.211.179:8080/admin" target="_blank" rel="noopener noreferrer">http://103.39.211.179:8080/admin</a></p>
<p>开源协议：MIT License</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346319611918.webp" alt="图片" loading="lazy">图片</p>
<p><strong>7. RuoYi</strong></p>
<p>开源地址：<a href="https://gitee.com/y_project/RuoYi" target="_blank" rel="noopener noreferrer">https://gitee.com/y_project/RuoYi</a></p>
<p>文档地址：<a href="https://doc.ruoyi.vip/" target="_blank" rel="noopener noreferrer">https://doc.ruoyi.vip/</a></p>
<p>效果预览：<a href="https://vue.ruoyi.vip/index" target="_blank" rel="noopener noreferrer">https://vue.ruoyi.vip/index</a></p>
<p>开源协议：MIT License</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346319611919.webp" alt="图片" loading="lazy">图片</p>
<p><strong>8. renren-fast-vue</strong></p>
<p>开源地址：<a href="https://gitee.com/renrenio/renren-fast-vue" target="_blank" rel="noopener noreferrer">https://gitee.com/renrenio/renren-fast-vue</a></p>
<p>文档地址：<a href="https://www.renren.io/guide" target="_blank" rel="noopener noreferrer">https://www.renren.io/guide</a></p>
<p>效果预览：<a href="http://demo.open.renren.io/renren-fast/#/home" target="_blank" rel="noopener noreferrer">http://demo.open.renren.io/renren-fast/#/home</a></p>
<p>开源协议：MIT License</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346319611920.webp" alt="图片" loading="lazy">图片</p>
<p><strong>9. ant-design-pro</strong></p>
<p>开源地址：<a href="https://github.com/ant-design/ant-design-pro" target="_blank" rel="noopener noreferrer">https://github.com/ant-design/ant-design-pro</a></p>
<p>文档地址：<a href="https://pro.ant.design/index-cn/" target="_blank" rel="noopener noreferrer">https://pro.ant.design/index-cn/</a></p>
<p>效果预览：<a href="https://pro.ant.design/" target="_blank" rel="noopener noreferrer">https://pro.ant.design/</a></p>
<p>开源协议：MIT License</p>
<p><strong>10. iview-admin</strong></p>
<p>开源地址：<a href="https://github.com/iview/iview-admin" target="_blank" rel="noopener noreferrer">https://github.com/iview/iview-admin</a></p>
<p>文档地址：<a href="https://lison16.github.io/iview-admin-doc/" target="_blank" rel="noopener noreferrer">https://lison16.github.io/iview-admin-doc/</a></p>
<p>效果预览：<a href="https://admin.iviewui.com/home" target="_blank" rel="noopener noreferrer">https://admin.iviewui.com/home</a></p>
<p>开源协议：MIT License</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346319611921.webp" alt="图片" loading="lazy">图片</p>
<p><strong>11. material-dashboard</strong></p>
<p>开源地址：<a href="https://github.com/creativetimofficial/material-dashboard#demo" target="_blank" rel="noopener noreferrer">https://github.com/creativetimofficial/material-dashboard#demo</a></p>
<p>文档地址：<a href="https://demos.creative-tim.com/material-dashboard/docs/2.1/getting-started/introduction.html" target="_blank" rel="noopener noreferrer">https://demos.creative-tim.com/material-dashboard/docs/2.1/getting-started/introduction.html</a></p>
<p>效果预览：<a href="https://demos.creative-tim.com/material-dashboard/examples/dashboard.html" target="_blank" rel="noopener noreferrer">https://demos.creative-tim.com/material-dashboard/examples/dashboard.html</a></p>
<p>开源协议：MIT License</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346319611922.webp" alt="图片" loading="lazy">图片</p>
<p><strong>12.EAdmin</strong></p>
<p>开源地址：<a href="https://github.com/suruibuas/eadmin" target="_blank" rel="noopener noreferrer">https://github.com/suruibuas/eadmin</a></p>
<p>文档地址：<a href="http://doc.eadmin.com.cn/" target="_blank" rel="noopener noreferrer">http://doc.eadmin.com.cn/</a></p>
<p>效果预览：<a href="http://www.eadmin.com.cn/" target="_blank" rel="noopener noreferrer">http://www.eadmin.com.cn/</a></p>
<p>开源协议：无</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346319611923.jpg" alt="图片" loading="lazy"></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-02-06T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">截图工具大全</title>
    <id>https://blog.ciberviler.top/tools/%E6%88%AA%E5%9B%BE%E5%B7%A5%E5%85%B7.html</id>
    <link href="https://blog.ciberviler.top/tools/%E6%88%AA%E5%9B%BE%E5%B7%A5%E5%85%B7.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">截图工具大全</summary>
    <content type="html"><![CDATA[<h1 id="截图工具大全" tabindex="-1"> 截图工具大全</h1>
<p>第一款. win10自带</p>
<p>快捷键：Windows键+Shift+S</p>
<p>第二款.微信自带</p>
<p>快捷键：Alt+A</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-16442232269891.webp" alt="图片" loading="lazy"></p>
<p>第三款.QQ自带</p>
<p>快捷键：Ctrl+Alt+A</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-16442232269892.webp" alt="图片" loading="lazy"></p>
<p>第四款.钉钉自带</p>
<p>快捷键：Ctrl+Shift+A</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-16442232269893.webp" alt="图片" loading="lazy"></p>
<p>第五款.浏览器自带</p>
<p>个人使用的星愿浏览器</p>
<p>第六款.Snipaste</p>
<p><a href="https://zh.snipaste.com/" target="_blank" rel="noopener noreferrer">https://zh.snipaste.com/</a></p>
<p>快捷键：F1</p>
<p>它还有一个超好用的贴图功能！把一些资料贴在桌面上，然后再去编辑文章，省得来回切换了</p>
<p>第七款.Sniptool</p>
<p><a href="https://tc5.us/file/15690961-442919658" target="_blank" rel="noopener noreferrer">https://tc5.us/file/15690961-442919658</a></p>
<p>它可以将多个截取的图片组合到一个画布中,并且，它拥有强大的标注编辑功能，对于截图内容可以进行编辑标注。比如添加文本、画框、表情，对截图进行透明化处理，更换背景等。</p>
<p>更赞的时，它还有一个模糊图像功能，可以对截图内容进行局部</p>
<p>第八款. FsCapture</p>
<p><a href="http://xz.w10a.com/Small/FastStoneCapturev2020.zip" target="_blank" rel="noopener noreferrer">http://xz.w10a.com/Small/FastStoneCapturev2020.zip</a></p>
<p>可以长截图，屏幕放大与聚焦，这在视频演示中很常用。除此之外，它还有一个强大的编辑器，可以做一些图片的处理，比如模糊（私密部分打码）、调整色彩等，基本是个简版的PS。</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-16442232269894.webp" alt="图片" loading="lazy"></p>
<p>第九款.FireShot <a href="https://www.chrome666.com/chrome-extension/fireshot.html" target="_blank" rel="noopener noreferrer">https://www.chrome666.com/chrome-extension/fireshot.html</a></p>
<p>能搞定网页长图，基本功能都具备</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-16442232269895.jpg" alt="图片" loading="lazy"></p>
<p>第十款.ShareX</p>
<p><a href="https://getsharex.com/" target="_blank" rel="noopener noreferrer">https://getsharex.com/</a></p>
<p>开源免费，steam有收录</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-16442232269896.jpg" alt="图片" loading="lazy"></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-02-12T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">阿里十大最受开发者欢迎的工具</title>
    <id>https://blog.ciberviler.top/tools/%E9%98%BF%E9%87%8C%E5%8D%81%E5%A4%A7%E6%9C%80%E5%8F%97%E5%BC%80%E5%8F%91%E8%80%85%E6%AC%A2%E8%BF%8E%E7%9A%84%E5%B7%A5%E5%85%B7.html</id>
    <link href="https://blog.ciberviler.top/tools/%E9%98%BF%E9%87%8C%E5%8D%81%E5%A4%A7%E6%9C%80%E5%8F%97%E5%BC%80%E5%8F%91%E8%80%85%E6%AC%A2%E8%BF%8E%E7%9A%84%E5%B7%A5%E5%85%B7.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">阿里十大最受开发者欢迎的工具</summary>
    <content type="html"><![CDATA[<h1 id="阿里十大最受开发者欢迎的工具" tabindex="-1"> 阿里十大最受开发者欢迎的工具</h1>
<p>精选了一些阿里经济体内部最受开发者欢迎的开发者工具，筛选出一些带有普适性同样适合外部开发者的，希望能助力开发者们提高开发效率。</p>
<h3 id="_1-java-工程脚手架-java-initializr" tabindex="-1"> 1. Java 工程脚手架 Java Initializr</h3>
<p><strong>官网</strong>：
<a href="https://start.aliyun.com/bootstrap.html" target="_blank" rel="noopener noreferrer">https://start.aliyun.com/bootstrap.html</a></p>
<p><strong>简介</strong>：
2020 年由阿里巴巴中间件团队发布的定制版 Java工程脚手架，快速搭建工程应用。</p>
<p>Java工程脚手架是一个项目框架生成工具，旨在减少开发者的工程搭建成本，为开发者提供简便、快捷的项目配置体验。</p>
<p>支持 Spring 官方脚手架的全部功能，且增加了丰富的典型配置和使用案例。多种标准应用架构供选择，让你生成完工程就可以直接写代码。基于浏览器的运行环境，进一步降低功能体验和试用的复杂度。</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640.webp" alt="图片" loading="lazy"></p>
<h3 id="_2-java-线上诊断工具-arthas" tabindex="-1"> 2. Java 线上诊断工具 Arthas</h3>
<p><strong>官网</strong>：
<a href="https://arthas.aliyun.com/en-us/index.html" target="_blank" rel="noopener noreferrer">https://arthas.aliyun.com/en-us/index.html</a></p>
<p><strong>简介</strong>：Arthas 是阿里巴巴 2018 年 9 月开源的一款 Java 线上诊断工具。</p>
<p>工具的使用场景：</p>
<ul>
<li>这个类从哪个 jar 包加载的？为什么会报各种类相关的 Exception？</li>
<li>我改的代码为什么没有执行到？难道是我没 commit？分支搞错了？</li>
<li>遇到问题无法在线上 debug，难道只能通过加日志再重新发布吗？</li>
<li>线上遇到某个用户的数据处理有问题，但线上同样无法 debug，线下无法重现！</li>
<li>是否有一个全局视角来查看系统的运行状况？</li>
<li>有什么办法可以监控到 JVM 的实时运行状态？</li>
</ul>
<p>Arthas 支持 JDK 6+，支持 Linux/Mac/Windows，采用命令行交互模式，同时提供丰富的 Tab 自动补全功能，进一步方便进行问题的定位和诊断。</p>
<h3 id="_3-java-工具集-dragonwell" tabindex="-1"> 3. Java 工具集 Dragonwell</h3>
<p><strong>官网</strong>：
<a href="https://www.aliyun.com/product/dragonwell" target="_blank" rel="noopener noreferrer">https://www.aliyun.com/product/dragonwell</a></p>
<p><strong>简介</strong>：
Alibaba Dragonwell 是一款免费的, 生产就绪型 Open JDK 发行版，提供长期支持，包括性能增强和安全修复。阿里巴巴拥有最丰富的 Java 应用场景，覆盖电商，金融，物流等众多领域，世界上最大的 Java 用户之一。Alibaba Dragonwell 作为 Java 应用的基石，支撑了阿里经济体内所有的 Java 业务。Alibaba Dragonwell 完全兼容 Java SE 标准，您可以在任何常用操作系统（包括 Linux、Windows 和 macOS）上开发 Java 应用程序， 运行时生产环境选择 Alibaba Dragonwell。</p>
<p><strong>特性</strong></p>
<ul>
<li>
<p>安全与稳定
紧密与 OpenJDK 社区保持合作，保持对社区工作的跟踪，及时同步上游更新；同时，Dragonwell 选择性的移植高版本 Java 的重要功能，这些移植功能已经在阿里内部被大规模部署，用户都可以免费使用，而不用等下一个 LTS 版本</p>
</li>
<li>
<p>标准兼容
OpenJDK 的下游, 完全遵循 Java SE 标准，通过 JCK 兼容性测试</p>
</li>
<li>
<p>性能卓越
Dragonwell 作为阿里巴巴 Java 应用的基石，支撑了阿里经济体内所有的 Java 业务，积累了大量业务场景下的实践和创新</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-16434631208084.webp" alt="图片" loading="lazy"></p>
</li>
</ul>
<h3 id="_4-java-代码规约扫描插件" tabindex="-1"> 4. Java 代码规约扫描插件</h3>
<p><strong>官网</strong>：
<a href="https://github.com/alibaba/p3c" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/p3c</a></p>
<p><strong>简介</strong>：
《阿里巴巴Java开发手册》自从第一个版本起，倍受业界关注，相信很多人对其中的规则也有了一定的了解，很多人甚至希望能尽快在自己的团队推行起来，这样大家有了一套共同的开发准则。但是，如何更好的去遵守规则并且按照手册去开发我们的系统确变得不那么容易，为了让开发者更加方便、快速的将规范推动并实行起来，阿里巴巴基于手册内容，研发了一套自动化的IDE检测插件（IDEA、Eclipse）， 该插件在扫描代码后，将不符合《手册》的代码按Blocker/Critical/Major三个等级显示在下方，甚至在IDEA上，还基于Inspection机制提供了实时检测功能，编写代码的同时也能快速发现问题所在。对于历史代码，部分规则实现了批量一键修复的功能，提升代码质量，提高团队研发效能。</p>
<h3 id="_5-应用实时监控工具-arms" tabindex="-1"> 5. 应用实时监控工具 ARMS</h3>
<p><strong>官网</strong>：
<a href="https://www.aliyun.com/product/arms" target="_blank" rel="noopener noreferrer">https://www.aliyun.com/product/arms</a></p>
<p><strong>简介</strong>：
应用实时监控服务 (Application Real-Time Monitoring Service, 简称ARMS) 是一款应用性能管理产品，包含前端监控，应用监控和Prometheus监控三大子产品，涵盖了浏览器，小程序，APP，分布式应用和容器环境等性能管理，能帮助你实现全栈式的性能监控和端到端的全链路追踪诊断， 让应用运维从未如此轻松高效。</p>
<p>工具的使用场景：</p>
<ul>
<li>
<p>晚上 10 点收到 37 条报警信息，你却无从下手？</p>
</li>
<li>
<p>当我们发现问题的时候，客户/业务方已经发起投诉？</p>
</li>
<li>
<p>每个月花几十万买服务器，却无法保障用户体验？</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-16434631208085.webp" alt="图片" loading="lazy"></p>
</li>
</ul>
<h3 id="_6-性能测试工具-pts" tabindex="-1"> 6. 性能测试工具 PTS</h3>
<p><strong>官网</strong>：
<a href="https://www.aliyun.com/product/pts" target="_blank" rel="noopener noreferrer">https://www.aliyun.com/product/pts</a> ；</p>
<p><strong>简介</strong>：
PTS（Performance Testing Service）是面向所有技术背景人员的云化测试工具。有别于传统工具的繁复，PTS以互联网化的交互，提供性能测试、API调试和监测等多种能力。自研和适配开源的功能都可以轻松模拟任意体量的用户访问业务的场景，任务随时发起，免去繁琐的搭建和维护成本。更是紧密结合监控、流控等兄弟产品提供一站式高可用能力，高效检验和管理业务性能。</p>
<p>使用场景：</p>
<ul>
<li>
<p>大促活动准备前，想模拟真实多用户高并发访问场景？</p>
</li>
<li>
<p>产品版本迭代，想观察流量洪峰时产品表现？</p>
</li>
<li>
<p>产品交付</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-16434631208086.webp" alt="图片" loading="lazy"></p>
</li>
</ul>
<h3 id="_7-架构可视化工具-ahas" tabindex="-1"> 7. 架构可视化工具 AHAS</h3>
<p><strong>官网</strong>：
<a href="https://www.aliyun.com/product/ahas" target="_blank" rel="noopener noreferrer">https://www.aliyun.com/product/ahas</a></p>
<p><strong>简介</strong>：
应用高可用服务（Application High Availability Service）是专注于提高应用及业务高可用的工具平台，目前主要提供 应用架构探测感知，故障注入式高可用能力评测 和 流控降级高可用防护 三大核心能力，通过各自的工具模块可以快速低成本的在营销活动场景、业务核心场景全面提升业务稳定性和韧性。</p>
<p>使用场景：</p>
<ul>
<li>服务化改造过程中，想精确的了解资源实例的构成和交互情况，实现架构的可视化？</li>
<li>想引入真实的故障场景和演练模型？</li>
<li>低门槛获得流控、降级功能？</li>
</ul>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-16434631208097.jpg" alt="图片" loading="lazy"></p>
<h3 id="_8-数据处理工具-easyexcel" tabindex="-1"> 8. 数据处理工具 EasyExcel</h3>
<p><strong>官网</strong>：
<a href="https://github.com/alibaba/easyexcel" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/easyexcel</a></p>
<p><strong>简介</strong>：
Java解析、生成Excel比较有名的框架有Apache poi、jxl。但他们都存在一个严重的问题就是非常的耗内存，poi有一套SAX模式的API可以一定程度的解决一些内存溢出的问题，但POI还是有一些缺陷，比如07版Excel解压缩以及解压后存储都是在内存中完成的，内存消耗依然很大。easyexcel重写了poi对07版Excel的解析，能够原本一个3M的excel用POI sax依然需要100M左右内存降低到几M，并且再大的excel不会出现内存溢出，03版依赖POI的sax模式。在上层做了模型转换的封装，让使用者更加简单方便.</p>
<h3 id="_9-ios-类工具-handyjson" tabindex="-1"> 9. iOS 类工具 HandyJSON</h3>
<p><strong>官网</strong>：
<a href="https://github.com/alibaba/HandyJSON" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/HandyJSON</a></p>
<p><strong>简介</strong>：
HandyJSON是一个用于Swift语言中的JSON序列化/反序列化库。</p>
<p>与其他流行的Swift JSON库相比，HandyJSON的特点是，它支持纯swift类，使用也简单。它反序列化时(把JSON转换为Model)不要求Model从NSObject继承(因为它不是基于KVC机制)，也不要求你为Model定义一个Mapping函数。只要你定义好Model类，声明它服从HandyJSON协议，HandyJSON就能自行以各个属性的属性名为Key，从JSON串中解析值。</p>
<h4 id="特性" tabindex="-1"> 特性</h4>
<ul>
<li>序列化Model到JSON、从JSON反序列化到Model</li>
<li>自然地以Model的属性名称作为解析JSON的Key，不需要额外指定</li>
<li>支持Swift中大部分类型</li>
<li>支持class、struct定义的Model</li>
<li>支持自定义解析规则</li>
<li>类型自适应，如JSON中是一个Int，但对应Model是String字段，会自动完成转化</li>
</ul>
<h3 id="_10-数据库落地-druid" tabindex="-1"> 10. 数据库落地 Druid</h3>
<p><strong>官网</strong>：
<a href="https://github.com/alibaba/druid" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/druid</a></p>
<p><strong>简介</strong>：
Druid 是一个 JDBC 组件库，包含数据库连接池、SQL Parser 等组件, 被大量业务和技术产品使用或集成，经历过最严苛线上业务场景考验，是你值得信赖的技术产品。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-02-19T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">提问的智慧</title>
    <id>https://blog.ciberviler.top/essay/How-To-Ask-Questions.html</id>
    <link href="https://blog.ciberviler.top/essay/How-To-Ask-Questions.html"/>
    <updated>2022-06-09T09:00:12.000Z</updated>
    <summary type="html">提问的智慧，How To Ask Questions The Smart Way</summary>
    <content type="html"><![CDATA[<h1 id="提问的智慧" tabindex="-1"> 提问的智慧</h1>
<p><strong>How To Ask Questions The Smart Way</strong></p>
<p>Copyright © 2001,2006,2014 Eric S. Raymond, Rick Moen</p>
<h2 id="前言" tabindex="-1"> 前言</h2>
<p><img src="https://fastly.jsdelivr.net/gh/xlc520/MyImage@main/MdImg/提问的艺术.jpg" alt="提问的艺术" loading="lazy"></p>
<p><img src="https://fastly.jsdelivr.net/gh/xlc520/MyImage@main/MdImg/提问的艺术.png" alt="提问的艺术" loading="lazy"></p>
<p><img src="https://fastly.jsdelivr.net/gh/xlc520/MyImage@main/MdImg/提问.jpg" alt="提问" loading="lazy"></p>
<h2 id="目录" tabindex="-1"> 目录</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
</li>
<li>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
</li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="声明" tabindex="-1"> 声明</h2>
<p>许多项目在他们的使用协助/说明网页中链接了本指南，这么做很好，我们也鼓励大家都这么做。但如果你是负责管理这个项目网页的人，请在超链接附近的显着位置上注明：</p>
<p><strong>本指南不提供此项目的实际支持服务！</strong></p>
<p>我们已经深刻领教到少了上述声明所带来的痛苦。因为少了这点声明，我们不停地被一些白痴纠缠。这些白痴认为既然我们发布了这本指南，那么我们就有责任解决世上所有的技术问题。</p>
<p>如果你是因为需要某些协助而正在阅读这本指南，并且最后离开是因为发现从本指南作者们身上得不到直接的协助，那么你就是我们所说的那些白痴之一。别问我们问题，我们只会忽略你。我们在这本指南中是教你如何从那些真正懂得你所遇到软件或硬件问题的人取得协助，而99%的情况下那不会是我们。除非你确定本指南的作者之一刚好是你所遇到的问题领域的专家，否则请不要打扰我们，这样大家都会开心一点。</p>
<h2 id="简介" tabindex="-1"> 简介</h2>
<p>在<a href="http://www.catb.org/~esr/faqs/hacker-howto.html" target="_blank" rel="noopener noreferrer">黑客</a>的世界里，当你拋出一个技术问题时，最终是否能得到有用的回答，往往取决于你所提问和追问的方式。本指南将教你如何正确的提问以获得你满意的答案。</p>
<p>不只是黑客，现在开放源代码（Open Source）软件已经相当盛行，你常常也可以由其他有经验的使用者身上得到好答案，这是件**<em>好事</em>**；使用者比起黑客来，往往对那些新手常遇到的问题更宽容一些。然而，将有经验的使用者视为黑客，并采用本指南所提的方法与他们沟通，同样也是能从他们身上得到满意回答的最有效方式。</p>
<p>首先你应该明白，黑客们喜爱有挑战性的问题，或者能激发我们思维的好问题。如果我们并非如此，那我们也不会成为你想询问的对象。如果你给了我们一个值得反复咀嚼玩味的好问题，我们自会对你感激不尽。好问题是激励，是厚礼。好问题可以提高我们的理解力，而且通常会暴露我们以前从没意识到或者思考过的问题。对黑客而言，&quot;好问题！&quot;是诚挚的大力称赞。</p>
<p>尽管如此，黑客们有着蔑视或傲慢面对简单问题的坏名声，这有时让我们看起来对新手、无知者似乎较有敌意，但其实不是那样的。</p>
<p>我们不讳言我们对那些不愿思考、或者在发问前不做他们该做的事的人的蔑视。那些人是时间杀手 -– 他们只想索取，从不付出，消耗我们可用在更有趣的问题或更值得回答的人身上的时间。我们称这样的人为 <code>失败者（撸瑟）</code> （由于历史原因，我们有时把它拼作 <code>lusers</code>）。</p>
<p>我们意识到许多人只是想使用我们写的软件，他们对学习技术细节没有兴趣。对大多数人而言，电脑只是种工具，是种达到目的的手段而已。他们有自己的生活并且有更要紧的事要做。我们了解这点，也从不指望每个人都对这些让我们着迷的技术问题感兴趣。尽管如此，我们回答问题的风格是指向那些真正对此有兴趣并愿意主动参与解决问题的人，这一点不会变，也不该变。如果连这都变了，我们就是在降低做自己最擅长的事情上的效率。</p>
<p>我们（在很大程度上）是自愿的，从繁忙的生活中抽出时间来解答疑惑，而且时常被提问淹没。所以我们无情的滤掉一些话题，特别是拋弃那些看起来像失败者的家伙，以便更高效的利用时间来回答<code>赢家（winner）</code>的问题。</p>
<p>如果你厌恶我们的态度，高高在上，或过于傲慢，不妨也设身处地想想。我们并没有要求你向我们屈服 -- 事实上，我们大多数人非常乐意与你平等地交流，只要你付出小小努力来满足基本要求，我们就会欢迎你加入我们的文化。但让我们帮助那些不愿意帮助自己的人是没有效率的。无知没有关系，但装白痴就是不行。</p>
<p>所以，你不必在技术上很在行才能吸引我们的注意，但你必须表现出能引导你变得在行的特质 -- 机敏、有想法、善于观察、乐于主动参与解决问题。如果你做不到这些使你与众不同的事情，我们建议你花点钱找家商业公司签个技术支持服务合同，而不是要求黑客个人无偿地帮助你。</p>
<p>如果你决定向我们求助，当然你也不希望被视为失败者，更不愿成为失败者中的一员。能立刻得到快速并有效答案的最好方法，就是像赢家那样提问 -- 聪明、自信、有解决问题的思路，只是偶尔在特定的问题上需要获得一点帮助。</p>
<p>（欢迎对本指南提出改进意见。你可以 email 你的建议至 <a href="esr@thyrsus.com">esr@thyrsus.com</a> 或 <a href="respond-auto@linuxmafia.com">respond-auto@linuxmafia.com</a>。然而请注意，本文并非<a href="http://www.ietf.org/rfc/rfc1855.txt" target="_blank" rel="noopener noreferrer">网络礼节</a>的通用指南，而我们通常会拒绝无助于在技术论坛得到有用答案的建议。）</p>
<h2 id="在提问之前" tabindex="-1"> 在提问之前</h2>
<p>在你准备要通过电子邮件、新闻群组或者聊天室提出技术问题前，请先做到以下事情：</p>
<ol>
<li>尝试在你准备提问的论坛的旧文章中搜索答案。</li>
<li>尝试上网搜索以找到答案。</li>
<li>尝试阅读手册以找到答案。</li>
<li>尝试阅读常见问题文件（FAQ）以找到答案。</li>
<li>尝试自己检查或试验以找到答案</li>
<li>向你身边的强者朋友打听以找到答案。</li>
<li>如果你是程序开发者，请尝试阅读源代码以找到答案</li>
</ol>
<p>当你提出问题的时候，请先表明你已经做了上述的努力；这将有助于树立你并不是一个不劳而获且浪费别人的时间的提问者。如果你能一并表达在做了上述努力的过程中所**<em>学到</em>**的东西会更好，因为我们更乐于回答那些表现出能从答案中学习的人的问题。</p>
<p>运用某些策略，比如先用Google搜索你所遇到的各种错误信息（既搜索<a href="http://groups.google.com/" target="_blank" rel="noopener noreferrer">Google论坛</a>，也搜索网页），这样很可能直接就找到了能解决问题的文件或邮件列表线索。即使没有结果，在邮件列表或新闻组寻求帮助时加上一句 <code>我在Google中搜过下列句子但没有找到什么有用的东西</code> 也是件好事，即使它只是表明了搜索引擎不能提供哪些帮助。这么做（加上搜索过的字串）也让遇到相似问题的其他人能被搜索引擎引导到你的提问来。</p>
<p>别着急，不要指望几秒钟的Google搜索就能解决一个复杂的问题。在向专家求助之前，再阅读一下常见问题文件（FAQ）、放轻松、坐舒服一些，再花点时间思考一下这个问题。相信我们，他们能从你的提问看出你做了多少阅读与思考，如果你是有备而来，将更有可能得到解答。不要将所有问题一股脑拋出，只因你的第一次搜索没有找到答案（或者找到太多答案）。</p>
<p>准备好你的问题，再将问题仔细的思考过一遍，因为草率的发问只能得到草率的回答，或者根本得不到任何答案。越是能表现出在寻求帮助前你为解决问题所付出的努力，你越有可能得到实质性的帮助。</p>
<p>小心别问错了问题。如果你的问题基于错误的假设，某个普通黑客（J. Random Hacker）多半会一边在心里想着<code>蠢问题…</code>， 一边用无意义的字面解释来答复你，希望着你会从问题的回答（而非你想得到的答案）中汲取教训。</p>
<p>绝不要自以为**<em>够格</em><strong>得到答案，你没有；你并没有。毕竟你没有为这种服务支付任何报酬。你将会是自己去</strong><em>挣到</em>**一个答案，靠提出有内涵的、有趣的、有思维激励作用的问题 --一个有潜力能贡献社区经验的问题，而不仅仅是被动的从他人处索取知识。</p>
<p>另一方面，表明你愿意在找答案的过程中做点什么是一个非常好的开端。<code>谁能给点提示？</code>、<code>我的这个例子里缺了什么？</code>以及<code>我应该检查什么地方</code>比<code>请把我需要的确切的过程贴出来</code>更容易得到答复。因为你表现出只要有人能指个正确方向，你就有完成它的能力和决心。</p>
<h2 id="当你提问时" tabindex="-1"> 当你提问时</h2>
<h3 id="慎选提问的论坛" tabindex="-1"> 慎选提问的论坛</h3>
<p>小心选择你要提问的场合。如果你做了下述的事情，你很可能被忽略掉或者被看作失败者：</p>
<ul>
<li>在与主题不合的论坛上贴出你的问题</li>
<li>在探讨进阶技术问题的论坛张贴非常初级的问题；反之亦然</li>
<li>在太多的不同新闻群组上重复转贴同样的问题（cross-post）</li>
<li>向既非熟人也没有义务解决你问题的人发送私人电邮</li>
</ul>
<p>黑客会剔除掉那些搞错场合的问题，以保护他们沟通的渠道不被无关的东西淹没。你不会想让这种事发生在自己身上的。</p>
<p>因此，第一步是找到对的论坛。再说一次，Google和其它搜索引擎还是你的朋友，用它们来找到与你遭遇到困难的软硬件问题最相关的网站。通常那儿都有常见问题（FAQ）、邮件列表及相关说明文件的链接。如果你的努力（包括**<em>阅读</em>**FAQ）都没有结果，网站上也许还有报告Bug（Bug-reporting）的流程或链接，如果是这样，连过去看看。</p>
<p>向陌生的人或论坛发送邮件最可能是风险最大的事情。举例来说，别假设一个提供丰富内容的网页的作者会想充当你的免费顾问。不要对你的问题是否会受到欢迎做太乐观的估计 -- 如果你不确定，那就向别处发送，或者压根别发。</p>
<p>在选择论坛、新闻群组或邮件列表时，别太相信名字，先看看FAQ或者许可书以弄清楚你的问题是否切题。发文前先翻翻已有的话题，这样可以让你感受一下那里的文化。事实上，事先在新闻组或邮件列表的历史记录中搜索与你问题相关的关键词是个极好的主意，也许这样就找到答案了。即使没有，也能帮助你归纳出更好的问题。</p>
<p>别像机关枪似的一次&quot;扫射&quot;所有的帮助渠道，这就像大喊大叫一样会使人不快。要一个一个地来。</p>
<p>搞清楚你的主题！最典型的错误之一是在某种致力于跨平台可移植的语言、套件或工具的论坛中提关于Unix或Windows操作系统程序界面的问题。如果你不明白为什么这是大错，最好在搞清楚这之间差异之前什么也别问。</p>
<p>一般来说，在仔细挑选的公共论坛中提问，会比在私有论坛中提同样的问题更容易得到有用的回答。有几个理由可以支持这点，一是看潜在的回复者有多少，二是看观众有多少。黑客较愿意回答那些能帮助到许多人的问题。</p>
<p>可以理解的是，老练的黑客和一些热门软件的作者正在接受过多的错发信息。就像那根最后压垮骆驼背的稻草一样，你的加入也有可能使情况走向极端 -- 已经好几次了，一些热门软件的作者从自己软件的支持中抽身出来，因为伴随而来涌入其私人邮箱的无用邮件变得无法忍受。</p>
<h3 id="stack-overflow" tabindex="-1"> Stack Overflow</h3>
<p>搜索，<strong><em>然后</em></strong> 在 Stack Exchange 问。</p>
<p>近年来，Stack Exchange community 社区已经成为回答技术及其他问题的主要渠道，尤其是那些开放源码的项目。</p>
<p>因为 Google 索引是即时的，在看 Stack Exchange 之前先在 Google 搜索。有很高的机率某人已经问了一个类似的问题，而且 Stack Exchange 网站们往往会是搜索结果中最前面几个。如果你在 Google 上没有找到任何答案，你再到特定相关主题的网站去找。用标签（Tag）搜索能让你更缩小你的搜索结果。</p>
<p>Stack Exchange 已经成长到<a href="http://stackexchange.com/sites" target="_blank" rel="noopener noreferrer">超过一百个网站</a>，以下是最常用的几个站：</p>
<ul>
<li>Super User 是问一些通用的电脑问题，如果你的问题跟代码或是写程序无关，只是一些网络连线之类的，请到这里。</li>
<li>Stack Overflow 是问写程序有关的问题。</li>
<li>Server Fault 是问服务器和网管相关的问题。</li>
</ul>
<h3 id="网站和irc论坛" tabindex="-1"> 网站和IRC论坛</h3>
<p>本地的使用者群组（user group），或者你所用的 Linux 发行版本也许正在宣传他们的网页论坛或 IRC 频道，并提供新手帮助（在一些非英语国家，新手论坛很可能还是邮件列表）， 这些地方是开始提问的好首选，特别是当你觉得遇到的也许只是相对简单或者很普通的问题时。经过宣传的 IRC 频道是公开欢迎提问的地方，通常可以即时得到回应。</p>
<p>事实上，如果程序出的问题只发生在特定 Linux 发行版提供的版本（这很常见），最好先去该发行版的论坛或邮件列表中提问，再到程序本身的论坛或邮件列表提问。（否则）该项目的黑客可能仅仅回复 &quot;用**<em>我们的</em>**版本&quot;。</p>
<p>在任何论坛发文以前，先确认一下有没有搜索功能。如果有，就试着搜索一下问题的几个关键词，也许这会有帮助。如果在此之前你已做过通用的网页搜索（你也该这样做），还是再搜索一下论坛，搜索引擎有可能没来得及索引此论坛的全部内容。</p>
<p>通过论坛或 IRC 频道来提供使用者支持服务有增长的趋势，电子邮件则大多为项目开发者间的交流而保留。所以最好先在论坛或 IRC 中寻求与该项目相关的协助。</p>
<h3 id="第二步-使用项目邮件列表" tabindex="-1"> 第二步，使用项目邮件列表</h3>
<p>当某个项目提供开发者邮件列表时，要向列表而不是其中的个别成员提问，即使你确信他能最好地回答你的问题。查一查项目的文件和首页，找到项目的邮件列表并使用它。有几个很好的理由支持我们采用这种办法：</p>
<ul>
<li>任何好到需要向个别开发者提出的问题，也将对整个项目群组有益。反之，如果你认为自己的问题对整个项目群组来说太愚蠢，也不能成为骚扰个别开发者的理由。</li>
<li>向列表提问可以分散开发者的负担，个别开发者（尤其是项目领导人）也许太忙以至于没法回答你的问题。</li>
<li>大多数邮件列表都会被存档，那些被存档的内容将被搜索引擎索引。如果你向列表提问并得到解答，将来其它人可以通过网页搜索找到你的问题和答案，也就不用再次发问了。</li>
<li>如果某些问题经常被问到，开发者可以利用此信息来改进说明文件或软件本身，以使其更清楚。如果只是私下提问，就没有人能看到最常见问题的完整场景。</li>
</ul>
<p>如果一个项目既有&quot;使用者&quot; 也有&quot;开发者&quot;（或&quot;黑客&quot;）邮件列表或论坛，而你又不会动到那些源代码，那么就向&quot;使用者&quot;列表或论坛提问。不要假设自己会在开发者列表中受到欢迎，那些人多半会将你的提问视为干扰他们开发的噪音。</p>
<p>然而，如果你**<em>确信</em>**你的问题很特别，而且在&quot;使用者&quot; 列表或论坛中几天都没有回复，可以试试前往&quot;开发者&quot;列表或论坛发问。建议你在张贴前最好先暗地里观察几天以了解那里的行事方式（事实上这是参与任何私有或半私有列表的好主意）</p>
<p>如果你找不到一个项目的邮件列表，而只能查到项目维护者的电子邮件地址，尽管向他发信。即使是在这种情况下，也别假设（项目）邮件列表不存在。在你的电子邮件中，请陈述你已经试过但没有找到合适的邮件列表，也提及你不反对将自己的邮件转发给他人（许多人认为，即使没什么秘密，私人电子邮件也不应该被公开。通过允许将你的电子邮件转发他人，你给了相应人员处置你邮件的选择）。</p>
<h3 id="使用有意义且描述明确的标题" tabindex="-1"> 使用有意义且描述明确的标题</h3>
<p>在邮件列表、新闻群组或论坛中，大约50字以内的标题是抓住资深专家注意力的好机会。别用喋喋不休的<code>帮帮忙</code>、<code>跪求</code>、<code>急</code>（更别说<code>救命啊！！！！</code>这样让人反感的话，用这种标题会被条件反射式地忽略）来浪费这个机会。不要妄想用你的痛苦程度来打动我们，而是在这点空间中使用极简单扼要的描述方式来提出问题。</p>
<p>一个好标题范例是<code>目标 -- 差异</code>式的描述，许多技术支持组织就是这样做的。在<code>目标</code>部分指出是哪一个或哪一组东西有问题，在<code>差异</code>部分则描述与期望的行为不一致的地方。</p>
<blockquote>
<p>蠢问题：救命啊！我的笔电不能正常显示了！</p>
</blockquote>
<blockquote>
<p>聪明问题：<a href="http://X.org" target="_blank" rel="noopener noreferrer">X.org</a> 6.8.1的鼠标游标会变形，某牌显卡 MV1005 芯片组。</p>
</blockquote>
<blockquote>
<p>更聪明问题：<a href="http://X.org" target="_blank" rel="noopener noreferrer">X.org</a> 6.8.1的鼠标游标，在某牌显卡 MV1005 芯片组环境下 - 会变形。</p>
</blockquote>
<p>编写<code>目标 -- 差异</code> 式描述的过程有助于你组织对问题的细緻思考。是什么被影响了？ 仅仅是鼠标游标或者还有其它图形？只在 <a href="http://X.org" target="_blank" rel="noopener noreferrer">X.org</a> 的 X 版中出现？或只是出现在6.8.1版中？ 是针对某牌显卡芯片组？或者只是其中的 MV1005 型号？ 一个黑客只需瞄一眼就能够立即明白你的环境**<em>和</em>**你遇到的问题。</p>
<p>总而言之，请想像一下你正在一个只显示标题的存档讨论串（Thread）索引中查寻。让你的标题更好地反映问题，可使下一个搜索类似问题的人能够关注这个讨论串，而不用再次提问相同的问题。</p>
<p>如果你想在回复中提出问题，记得要修改内容标题，以表明你是在问一个问题， 一个看起来像 <code>Re: 测试</code> 或者 <code>Re: 新bug</code> 的标题很难引起足够重视。另外，在不影响连贯性之下，适当引用并删减前文的内容，能给新来的读者留下线索。</p>
<p>对于讨论串，不要直接点击回复来开始一个全新的讨论串，这将限制你的观众。因为有些邮件阅读程序，比如 mutt ，允许使用者按讨论串排序并通过折叠讨论串来隐藏消息，这样做的人永远看不到你发的消息。</p>
<p>仅仅改变标题还不够。mutt 和其它一些邮件阅读程序还会检查邮件标题以外的其它信息，以便为其指定讨论串。所以宁可发一个全新的邮件。</p>
<p>在网页论坛上，好的提问方式稍有不同，因为讨论串与特定的信息紧密结合，并且通常在讨论串外就看不到里面的内容，故通过回复提问，而非改变标题是可接受的。不是所有论坛都允许在回复中出现分离的标题，而且这样做了基本上没有人会去看。不过，通过回复提问，这本身就是暧昧的做法，因为它们只会被正在查看该标题的人读到。所以，除非你**<em>只想</em>**在该讨论串当前活跃的人群中提问，不然还是另起炉灶比较好。</p>
<h3 id="使问题容易回复" tabindex="-1"> 使问题容易回复</h3>
<p>以<code>请将你的回复寄到……</code>来结束你的问题多半会使你得不到回答。如果你觉得花几秒钟在邮件客户端设置一下回复地址都麻烦，我们也觉得花几秒钟思考你的问题更麻烦。如果你的邮件程序不支持这样做，<a href="http://linuxmafia.com/faq/Mail/muas.html" target="_blank" rel="noopener noreferrer">换个好点的</a>；如果是操作系统不支持这种邮件程序，也换个好点的。</p>
<p>在论坛，要求通过电子邮件回复是非常无礼的，除非你相信回复的信息可能比较敏感（而且有人会为了某些未知的原因，只让你而不是整个论坛知道答案）。如果你只是想在有人回复讨论串时得到电子邮件提醒，可以要求网页论坛发送给你。几乎所有论坛都支持诸如<code>追踪此讨论串</code>、<code>有回复时发送邮件提醒</code>等功能。</p>
<h3 id="用清晰、正确、精准并语法正确的语句" tabindex="-1"> 用清晰、正确、精准并语法正确的语句</h3>
<p>我们从经验中发现，粗心的提问者通常也会粗心的写程序与思考（我敢打包票）。回答粗心大意者的问题很不值得，我们宁愿把时间耗在别处。</p>
<p>正确的拼字、标点符号和大小写是很重要的。一般来说，如果你觉得这样做很麻烦，不想在乎这些，那我们也觉得麻烦，不想在乎你的提问。花点额外的精力斟酌一下字句，用不着太僵硬与正式 -- 事实上，黑客文化很看重能准确地使用非正式、俚语和幽默的语句。但它**<em>必须很</em>**准确，而且有迹象表明你是在思考和关注问题。</p>
<p>正确地拼写、使用标点和大小写，不要将<code>its</code>混淆为<code>it's</code>，<code>loose</code>搞成<code>lose</code>或者将<code>discrete</code>弄成<code>discreet</code>。不要<strong>全部用大写</strong>，这会被视为无礼的大声嚷嚷（全部小写也好不到哪去，因为不易阅读。<a href="http://en.wikipedia.org/wiki/Alan_Cox" target="_blank" rel="noopener noreferrer">Alan Cox</a>也许可以这样做，但你不行。）</p>
<p>更白话的说，如果你写得像是个半文盲[译注：<a href="http://zh.wikipedia.org/zh-tw/%E5%B0%8F%E7%99%BD" target="_blank" rel="noopener noreferrer">小白</a>]），那多半得不到理睬。也不要使用即时通讯中的简写或<a href="http://zh.wikipedia.org/zh-tw/%E7%81%AB%E6%98%9F%E6%96%87" target="_blank" rel="noopener noreferrer">火星文</a>，如将<code>的</code>简化为<code>ㄉ</code>会使你看起来像一个为了少打几个键而省字的小白。更糟的是，如果像个小孩似地鬼画符那绝对是在找死，可以肯定没人会理你（或者最多是给你一大堆指责与挖苦）。</p>
<p>如果在使用非母语的论坛提问，你可以犯点拼写和语法上的小错，但决不能在思考上马虎（没错，我们通常能弄清两者的分别）。同时，除非你知道回复者使用的语言，否则请使用英语书写。繁忙的黑客一般会直接删除用他们看不懂语言写的消息。在网络上英语是通用语言，用英语书写可以将你的问题在尚未被阅读就被直接删除的可能性降到最低。</p>
<p>如果英文是你的外语（Second language），提示潜在回复者你有潜在的语言困难是很好的：
[译注：以下附上原文以供使用]</p>
<blockquote>
<p>English is not my native language; please excuse typing errors.</p>
</blockquote>
<ul>
<li>英文不是我的母语，请原谅我的错字或语法</li>
</ul>
<blockquote>
<p>If you speak $LANGUAGE, please email/PM me;
I may need assistance translating my question.</p>
</blockquote>
<ul>
<li>如果你说<strong>某语言</strong>，请寄信/私讯给我；我需要有人协助我翻译我的问题</li>
</ul>
<blockquote>
<p>I am familiar with the technical terms,
but some slang expressions and idioms are difficult for me.</p>
</blockquote>
<ul>
<li>我对技术名词很熟悉，但对于俗语或是特别用法比较不甚了解。</li>
</ul>
<blockquote>
<p>I've posted my question in $LANGUAGE and English.
I'll be glad to translate responses, if you only use one or the other.</p>
</blockquote>
<ul>
<li>我把我的问题用<strong>某语言</strong>和英文写出来，如果你只用一种语言回答，我会乐意将其翻译成另一种。</li>
</ul>
<h3 id="使用易于读取且标准的文件格式发送问题" tabindex="-1"> 使用易于读取且标准的文件格式发送问题</h3>
<p>如果你人为地将问题搞得难以阅读，它多半会被忽略，人们更愿读易懂的问题，所以：</p>
<ul>
<li>使用纯文字而不是HTML (<a href="http://archive.birdhouse.org/etc/evilmail.html" target="_blank" rel="noopener noreferrer">关闭HTML</a>并不难）</li>
<li>使用MIME附件通常是可以的，前提是真正有内容（譬如附带的源代码或patch），而不仅仅是邮件程序生成的模板（譬如只是信件内容的拷贝）。</li>
<li>不要发送一段文字只是单行句子但多次断行的邮件（这使得回复部分内容非常困难）。设想你的读者是在80个字符宽的终端机上阅读邮件，最好设置你的断行点小于80字。</li>
<li>但是，也**<em>不要</em>**用任何固定断行资料（譬如日志档案拷贝或会话记录）。档案应该原样包含，让回复者有信心他们看到的是和你看到的一样的东西。</li>
<li>在英语论坛中，不要使用<code>Quoted-Printable</code> MIME编码发送消息。这种编码对于张贴非ASCII语言可能是必须的，但很多邮件程序并不支持这种编码。当它们分断时，那些文本中四处散布的<code>=20</code>符号既难看也分散注意力，甚至有可能破坏内容的语意。</li>
<li>绝对，**<em>永远</em>**不要指望黑客们阅读使用封闭格式编写的文档，像是微软公司的Word或Excel文件等。大多数黑客对此的反应就像有人将还在冒热气的猪粪倒在你门口阶梯上时你的反应一样。即便他们能够处理，他们也很厌恶这么做。</li>
<li>如果你从使用Windows的电脑发送电子邮件，关闭微软愚蠢的<code>智能引号</code>功能 （从[选项] &gt; [校订] &gt; [自动校正选项], 按掉<code>智能引号</code>单选框），以免在你的邮件中到处散布垃圾字符。</li>
<li>在论坛，勿滥用<code>表情符号</code>和<code>HTML</code>功能（当它们提供时）。一两个表情符号通常没有问题，但花哨的彩色文本倾向于使人认为你是个无能之辈。过滥地使用表情符号、色彩和字体会使你看来像个傻笑的小姑娘。这通常不是个好主意，除非你只是对sex而不是有用的回复更有兴趣。</li>
</ul>
<p>如果你使用图形用户界面的邮件程序（如微软公司的Outlook或者其它类似的），注意它们的默认设置不一定满足这些要求。大多数这类程序有基于选单的<code>查看源代码</code>命令，用它来检查发送文件夹中的消息，以确保发送的是没有多餘杂质的纯文本文件。</p>
<h3 id="精确的描述问题并言之有物" tabindex="-1"> 精确的描述问题并言之有物</h3>
<ul>
<li>仔细、清楚地描述你的问题或Bug的症状。</li>
<li>描述问题发生的环境（机器配置、操作系统、应用程序、以及相关的信息），提供经销商的发行版和版本号（如：<code>Fedora Core 4</code>、<code>Slackware 9.1</code>等）。</li>
<li>描述在提问前你是怎样去研究和理解这个问题的。</li>
<li>描述在提问前为确定问题而采取的诊断步骤。</li>
<li>描述最近做过什么可能相关的硬件或软件变更。</li>
<li>尽可能的提供一个可以<code>重现这个问题的既定环境</code>的方法</li>
</ul>
<p>尽量去揣测一个黑客会怎样反问你，在他提问的时候预先给他答案。</p>
<p>以上几点中，当你报告的是你认为可能在代码中的问题时，给黑客一个可以重现你的问题的环境尤其重要。当你这么做时，你得到有效的回答的机会和速度都会大大的提升。</p>
<p><a href="http://www.chiark.greenend.org.uk/~sgtatham/" target="_blank" rel="noopener noreferrer">Simon Tatham</a>写过一篇名为《<a href="http://www.chiark.greenend.org.uk/~sgtatham/bugs-tw.html" target="_blank" rel="noopener noreferrer">如何有效的报告Bug</a>》的出色文章。强力推荐你也读一读。</p>
<h3 id="话不在多而在精" tabindex="-1"> 话不在多而在精</h3>
<p>你需要提供精确有内容的信息。这并不是要求你简单的把成堆的出错代码或者资料完全转录到你的提问中。如果你有庞大而复杂的测试样例能重现程序挂掉的情境，尽量将它剪裁得越小越好。</p>
<p>这样做的用处至少有三点。
第一，表现出你为简化问题付出了努力，这可以使你得到回答的机会增加；
第二，简化问题使你更有可能得到**<em>有用</em>**的答案；
第三，在精炼你的bug报告的过程中，你很可能就自己找到了解决方法或权宜之计。</p>
<h3 id="别动辄声称找到bug" tabindex="-1"> 别动辄声称找到Bug</h3>
<p>当你在使用软件中遇到问题，除非你非常、**<em>非常</em>**的有根据，不要动辄声称找到了Bug。提示：除非你能提供解决问题的源代码补丁，或者对前一版本的回归测试表现出不正确的行为，否则你都多半不够完全确信。这同样适用在网页和文件，如果你（声称）发现了文件的<code>Bug</code>，你应该能提供相应位置的修正或替代文件。</p>
<p>请记得，还有许多其它使用者没遇到你发现的问题，否则你在阅读文件或搜索网页时就应该发现了（你在抱怨前？）。这也意味着很有可能是你弄错了而不是软件本身有问题。</p>
<p>编写软件的人总是非常辛苦地使它尽可能完美。如果你声称找到了Bug，也就是在质疑他们的能力，即使你是对的，也有可能会冒犯到其中某部分人。这尤其严重当你在标题中嚷嚷着有<code>Bug</code>。</p>
<p>提问时，即使你私下非常确信已经发现一个真正的Bug，最好写得像是**<em>你</em>**做错了什么。如果真的有Bug，你会在回复中看到这点。这样做的话，如果真有Bug，维护者就会向你道歉，这总比你惹恼别人然后欠别人一个道歉要好一点。</p>
<h3 id="可以低声下气-但还是要先做功课" tabindex="-1"> 可以低声下气，但还是要先做功课</h3>
<p>有些人明白他们不该粗鲁或傲慢的提问并要求得到答复，但他们选择另一个极端 -- 低声下气：<code>我知道我只是个可悲的新手，一个撸瑟，但...</code>。这既使人困扰，也没有用，尤其是伴随着与实际问题含糊不清的描述时更令人反感。</p>
<p>别用原始灵长类动物的把戏来浪费你我的时间。取而代之的是，尽可能清楚地描述背景条件和你的问题情况。这比低声下气更好地定位了你的位置。</p>
<p>有时网页论坛会设有专为新手提问的版面，如果你真的认为遇到了初学者的问题，到那去就是了，但一样别那么低声下气。</p>
<h3 id="描述问题症状而非猜测" tabindex="-1"> 描述问题症状而非猜测</h3>
<p>告诉黑客们你认为问题是怎样造成的并没什么帮助。（如果你的推断如此有效，还用向别人求助吗？），因此要确信你原原本本告诉了他们问题的症状，而不是你的解释和理论；让黑客们来推测和诊断。如果你认为陈述自己的猜测很重要，清楚地说明这只是你的猜测，并描述为什么它们不起作用。</p>
<p><em><strong>蠢问题</strong></em></p>
<blockquote>
<p>我在编译内核时接连遇到 SIG11 错误，
我怀疑某条飞线搭在主板的走线上了，这种情况应该怎样检查最好？</p>
</blockquote>
<p><em><strong>聪明问题</strong></em></p>
<blockquote>
<p>我的组装电脑是 FIC-PA2007 主机板搭载 AMD K6/233 CPU（威盛 Apollo VP2芯片组），
256MB Corsair PC133 SDRAM内存，在编译内核时，从开机20分钟以后就频频产生 SIG11 错误，
但是在头20分钟内从没发生过相同的问题。重新启动也没有用，但是关机一晚上就又能工作20分钟。
所有内存都换过了，没有效果。相关部分的标准编译记录如下…。</p>
</blockquote>
<p>由于以上这点似乎让许多人觉得难以配合，这里有句话可以提醒你：<code>所有的诊断专家都来自密苏里州。</code> 美国国务院的官方座右铭则是：<code>让我看看</code>（出自国会议员 Willard D. Vandiver 在1899年时的讲话：<code>我来自一个出产玉米，棉花，牛蒡和民主党人的国家，滔滔雄辩既不能说服我，也不会让我满意。我来自密苏里州，你必须让我看看。</code>） 针对诊断者而言，这并不是一种怀疑，而只是一种真实而有用的需求，以便让他们看到的是与你看到的原始证据尽可能一致的东西，而不是你的猜测与归纳的结论。所以，大方的展示给我们看吧！</p>
<h3 id="按发生时间先后列出问题症状" tabindex="-1"> 按发生时间先后列出问题症状</h3>
<p>问题发生前的一系列操作，往往就是对找出问题最有帮助的线索。因此，你的说明里应该包含你的操作步骤，以及机器和软件的反应，直到问题发生。在命令行处理的情况下，提供一段操作记录（例如运行脚本工具所生成的），并引用相关的若干行（如20行）记录会非常有帮助。</p>
<p>如果挂掉的程序有诊断选项（如 -v 的详述开关），试着选择这些能在记录中增加调试信息的选项。记住，<code>多</code>不等于<code>好</code>。试着选取适当的调试级别以便提供有用的信息而不是让读者淹没在垃圾中。</p>
<p>如果你的说明很长（如超过四个段落），在开头简述问题，接下来再按时间顺序详述会有所帮助。这样黑客们在读你的记录时就知道该注意哪些内容了。</p>
<h3 id="描述目标而不是过程" tabindex="-1"> 描述目标而不是过程</h3>
<p>如果你想弄清楚如何做某事（而不是报告一个Bug），在开头就描述你的目标，然后才陈述重现你所卡住的特定步骤。</p>
<p>经常寻求技术帮助的人在心中有个更高层次的目标，而他们在自以为能达到目标的特定道路上被卡住了，然后跑来问该怎么走，但没有意识到这条路本身就有问题。结果要费很大的劲才能搞定。</p>
<p><strong>蠢问题</strong></p>
<blockquote>
<p>我怎样才能从某绘图程序的颜色选择器中取得十六进制的的RGB值？</p>
</blockquote>
<p><strong>聪明问题</strong></p>
<blockquote>
<p>我正试着用替换一幅图片的色码成自己选定的色码，我现在知道的唯一方法是编辑每个色码区块，
但却无法从某绘图程序的颜色选择器取得十六进制的的RGB值。</p>
</blockquote>
<p>第二种提问法比较聪明，你可能得到像是<code>建议采用另一个更合适的工具</code>的回复。</p>
<h3 id="别要求使用私人电邮回复" tabindex="-1"> 别要求使用私人电邮回复</h3>
<p>黑客们认为问题的解决过程应该公开、透明，此过程中如果更有经验的人注意到不完整或者不当之处，最初的回复才能够、也应该被纠正。同时，作为提供帮助者也能因为能力和学识被其它同行看到而得到某种奖励。</p>
<p>当你要求私下回复时，这个过程和奖励都被中止。别这样做，让**<em>回复者</em>**来决定是否私下回答 -- 如果他真这么做了，通常是因为他认为问题编写太差或者太肤浅，以至于对其它人没有兴趣。</p>
<p>这条规则存在一条有限的例外，如果你确信提问可能会引来大量雷同的回复时，那么这个神奇的提问句会是<code>向我发电邮，我将为论坛归纳这些回复</code>。试着将邮件列表或新闻群组从洪水般的雷同回复中解救出来是非常有礼貌的 -- 但你必须信守诺言。</p>
<h3 id="清楚明确的表达你的问题以及需求" tabindex="-1"> 清楚明确的表达你的问题以及需求</h3>
<p>漫无边际的提问近乎无休无止的时间黑洞。最有可能给你有用答案的人通常也正是最忙的人（他们忙是因为要亲自完成大部分工作）。这样的人对无节制的时间黑洞相当厌恶，所以他们也倾向于厌恶那些漫无边际的提问。</p>
<p>如果你明确表述需要回答者做什么（如提供指点、发送一段代码、检查你的补丁、或是其他等等），就最有可能得到有用的答案。因为这会定出一个时间和精力的上限，便于回答者能集中精力来帮你。这么做很棒。</p>
<p>要理解专家们所处的世界，请把专业技能想像为充裕的资源，而回复的时间则是稀缺的资源。你要求他们奉献的时间越少，你越有可能从真正专业而且很忙的专家那里得到解答。</p>
<p>所以，界定一下你的问题，使专家花在辨识你的问题和回答所需要付出的时间减到最少，这技巧对你有用答案相当有帮助 -- 但这技巧通常和简化问题有所区别。因此，问<code>我想更好的理解X，可否指点一下哪有好一点说明？</code>通常比问<code>你能解释一下X吗？</code>更好。如果你的代码不能运作，通常请别人看看哪里有问题，比要求别人替你改正要明智得多。</p>
<h3 id="询问有关代码的问题时" tabindex="-1"> 询问有关代码的问题时</h3>
<p>别要求他人帮你有问题的代码调试而不提示一下应该从何入手。张贴几百行的代码，然后说一声：<code>它不会动</code>会让你完全被忽略。只贴几十行代码，然后说一句：<code>在第七行以后，我期待它显示 &lt;x&gt;，但实际出现的是 &lt;y&gt;</code>比较有可能让你得到回应。</p>
<p>最有效描述程序问题的方法是提供最精简的Bug展示测试示例（bug-demonstrating test case）。什么是最精简的测试示例? 那是问题的缩影；一小个程序片段能<strong>刚好</strong>展示出程序的异常行为，而不包含其他令人分散注意力的内容。怎么制作最精简的测试示例？如果你知道哪一行或哪一段代码会造成异常的行为，复制下来并加入足够重现这个状况的代码（例如，足以让这段代码能被编译/直译/被应用程序处理）。如果你无法将问题缩减到一个特定区块，就复制一份代码并移除不影响产生问题行为的部分。总之，测试示例越小越好（查看一节）。</p>
<p>一般而言，要得到一段相当精简的测试示例并不太容易，但永远先尝试这样做的是种好习惯。这种方式可以帮助你了解如何自行解决这个问题 —- 而且即使你的尝试不成功，黑客们也会看到你在尝试取得答案的过程中付出了努力，这可以让他们更愿意与你合作。</p>
<p>如果你只是想让别人帮忙审查（Review）一下代码，在信的开头就要说出来，并且一定要提到你认为哪一部分特别需要关注以及为什么。</p>
<h3 id="别把自己家庭作业的问题贴上来" tabindex="-1"> 别把自己家庭作业的问题贴上来</h3>
<p>黑客们很擅长分辨哪些问题是家庭作业式的问题；因为我们中的大多数都曾自己解决这类问题。同样，这些问题得由**<em>你</em>**来搞定，你会从中学到东西。你可以要求给点提示，但别要求得到完整的解决方案。</p>
<p>如果你怀疑自己碰到了一个家庭作业式的问题，但仍然无法解决，试试在使用者群组，论坛或（最后一招）在项目的<strong>使用者</strong>邮件列表或论坛中提问。尽管黑客们**<em>会</em>**看出来，但一些有经验的使用者也许仍会给你一些提示。</p>
<h3 id="去掉无意义的提问句" tabindex="-1"> 去掉无意义的提问句</h3>
<p>避免用无意义的话结束提问，例如<code>有人能帮我吗？</code>或者<code>这有答案吗？</code>。</p>
<p>首先：如果你对问题的描述不是很好，这样问更是画蛇添足。</p>
<p>其次：由于这样问是画蛇添足，黑客们会很厌烦你 -- 而且通常会用逻辑上正确，但毫无意义的回答来表示他们的蔑视， 例如：<code>没错，有人能帮你</code>或者<code>不，没答案</code>。</p>
<p>一般来说，避免用 <code>是或否</code>、<code>对或错</code>、<code>有或没有</code>类型的问句，除非你想得到<a href="http://homepage.ntlworld.com./jonathan.deboynepollard/FGA/questions-with-yes-or-no-answers.html" target="_blank" rel="noopener noreferrer">是或否类型的回答</a>。</p>
<h3 id="即使你很急也不要在标题写紧急" tabindex="-1"> 即使你很急也不要在标题写<code>紧急</code></h3>
<p>这是你的问题，不是我们的。宣称<code>紧急</code>极有可能事与愿违：大多数黑客会直接删除无礼和自私地企图即时引起关注的问题。更严重的是，<code>紧急</code>这个字（或是其他企图引起关注的标题）通常会被垃圾信过滤器过滤掉 -- 你希望能看到你问题的人可能永远也看不到。</p>
<p>有半个例外的情况是，如果你是在一些很高调，会使黑客们兴奋的地方，也许值得这样去做。在这种情况下，如果你有时间压力，也很有礼貌地提到这点，人们也许会有兴趣回答快一点。</p>
<p>当然，这风险很大，因为黑客们兴奋的点多半与你的不同。譬如从 NASA 国际空间站（International Space Station）发这样的标题没有问题，但用自我感觉良好的慈善行为或政治原因发肯定不行。事实上，张贴诸如<code>紧急：帮我救救这个毛绒绒的小海豹！</code>肯定让你被黑客忽略或惹恼他们，即使他们认为毛绒绒的小海豹很重要。</p>
<p>如果你觉得这点很不可思议，最好再把这份指南剩下的内容多读几遍，直到你弄懂了再发文。</p>
<h3 id="礼多人不怪-而且有时还很有帮助" tabindex="-1"> 礼多人不怪，而且有时还很有帮助</h3>
<p>彬彬有礼，多用<code>请</code>和<code>谢谢您的关注</code>，或<code>谢谢你的关照</code>。让大家都知道你对他们花时间免费提供帮助心存感激。</p>
<p>坦白说，这一点并没有比清晰、正确、精准并合法语法和避免使用专用格式重要（也不能取而代之）。黑客们一般宁可读有点唐突但技术上鲜明的Bug报告，而不是那种有礼但含糊的报告。（如果这点让你不解，记住我们是按问题能教我们什么来评价问题的价值的）</p>
<p>然而，如果你有一串的问题待解决，客气一点肯定会增加你得到有用回应的机会。</p>
<p>（我们注意到，自从本指南发布后，从资深黑客那里得到的唯一严重缺陷反馈，就是对预先道谢这一条。一些黑客觉得<code>先谢了</code>意味着事后就不用再感谢任何人的暗示。我们的建议是要么先说<code>先谢了</code>，**<em>然后</em>**事后再对回复者表示感谢，或者换种方式表达感激，譬如用<code>谢谢你的关注</code>或<code>谢谢你的关照</code>。）</p>
<h3 id="问题解决后-加个简短的补充说明" tabindex="-1"> 问题解决后，加个简短的补充说明</h3>
<p>问题解决后，向所有帮助过你的人发个说明，让他们知道问题是怎样解决的，并再一次向他们表示感谢。如果问题在新闻组或者邮件列表中引起了广泛关注，应该在那里贴一个说明比较恰当。</p>
<p>最理想的方式是向最初提问的话题回复此消息，并在标题中包含<code>已修正</code>，<code>已解决</code>或其它同等含义的明显标记。在人来人往的邮件列表里，一个看见讨论串<code>问题 X</code>和<code>问题的X - 已解决</code>的潜在回复者就明白不用再浪费时间了（除非他个人觉得<code>问题 X</code>的有趣），因此可以利用此时间去解决其它问题。</p>
<p>补充说明不必很长或是很深入；简单的一句<code>你好，原来是网线出了问题！谢谢大家 – Bill</code>比什么也不说要来的好。事实上，除非结论真的很有技术含量，否则简短可爱的小结比长篇大论更好。说明问题是怎样解决的，但大可不必将解决问题的过程复述一遍。</p>
<p>对于有深度的问题，张贴调试记录的摘要是有帮助的。描述问题的最终状态，说明是什么解决了问题，在此**<em>之后</em>**才指明可以避免的盲点。避免盲点的部分应放在正确的解决方案和其它总结材料之后，而不要将此信息搞成侦探推理小说。列出那些帮助过你的名字，会让你交到更多朋友。</p>
<p>除了有礼貌和有内涵以外，这种类型的补充也有助于他人在邮件列表/新闻群组/论坛中搜索到真正解决你问题的方案，让他们也从中受益。</p>
<p>至少，这种补充有助于让每位参与协助的人因问题的解决而从中得到满足感。如果你自己不是技术专家或者黑客，那就相信我们，这种感觉对于那些你向他们求助的大师或者专家而言，是非常重要的。问题悬而未决会让人灰心；黑客们渴望看到问题被解决。好人有好报，满足他们的渴望，你会在下次提问时尝到甜头。</p>
<p>思考一下怎样才能避免他人将来也遇到类似的问题，自问写一份文件或加个常见问题（FAQ）会不会有帮助。如果是的话就将它们发给维护者。</p>
<p>在黑客中，这种良好的后继行动实际上比传统的礼节更为重要，也是你如何透过善待他人而赢得声誉的方式，这是非常有价值的资产。</p>
<h2 id="如何解读答案" tabindex="-1"> 如何解读答案</h2>
<p><a id="RTFM"></a></p>
<h3 id="rtfm和stfw-如何知道你已完全搞砸了" tabindex="-1"> RTFM和STFW：如何知道你已完全搞砸了</h3>
<p>有一个古老而神圣的传统：如果你收到<code>RTFM （Read The Fucking Manual）</code>的回应，回答者认为你<strong>应该去读他妈的手册</strong>。当然，基本上他是对的，你应该去读一读。</p>
<p>RTFM 有一个年轻的亲戚。如果你收到<code>STFW（Search The Fucking Web）</code>的回应，回答者认为你<strong>应该到他妈的网上搜索</strong>过了。那人多半也是对的，去搜索一下吧。（更温和一点的说法是 <strong><a href="http://lmgtfy.com/" target="_blank" rel="noopener noreferrer">Google是你的朋友</a></strong>！）</p>
<p>在论坛，你也可能被要求去爬爬论坛的旧文。事实上，有人甚至可能热心地为你提供以前解决此问题的讨论串。但不要依赖这种关照，提问前应该先搜索一下旧文。</p>
<p>通常，用这两句之一回答你的人会给你一份包含你需要内容的手册或者一个网址，而且他们打这些字的时候也正在读着。这些答复意味着回答者认为</p>
<ul>
<li><strong>你需要的信息非常容易获得</strong>；</li>
<li><strong>你自己去搜索这些信息比灌给你能让你学到更多</strong>。</li>
</ul>
<p>你不应该因此不爽；<strong>依照黑客的标准，他已经表示了对你一定程度的关注，而没有对你的要求视而不见</strong>。你应该对他祖母般的慈祥表示感谢。</p>
<h3 id="如果还是搞不懂" tabindex="-1"> 如果还是搞不懂</h3>
<p>如果你看不懂回应，别立刻要求对方解释。像你以前试着自己解决问题时那样（利用手册，FAQ，网络，身边的高手），先试着去搞懂他的回应。如果你真的需要对方解释，记得表现出你已经从中学到了点什么。</p>
<p>比方说，如果我回答你：<code>看来似乎是 zentry 卡住了；你应该先清除它。</code>，然后，这是一个**<em>很糟的</em>**后续问题回应：<code>zentry是什么？</code> **<em>好</em>**的问法应该是这样：<code>哦~~~我看过说明了但是只有 -z 和 -p 两个参数中提到了 zentries，而且还都没有清楚的解释如何清除它。你是指这两个中的哪一个吗？还是我看漏了什么？</code></p>
<h3 id="处理无礼的回应" tabindex="-1"> 处理无礼的回应</h3>
<p>很多黑客圈子中看似无礼的行为并不是存心冒犯。相反，它是直接了当，一针见血式的交流风格，这种风格更注重解决问题，而不是使人感觉舒服而却模模糊糊。</p>
<p>如果你觉得被冒犯了，试着平静地反应。如果有人真的做了出格的事，邮件列表、新闻群组或论坛中的前辈多半会招呼他。如果这**<em>没有</em><strong>发生而你却发火了，那么你发火对象的言语可能在黑客社区中看起来是正常的，而</strong><em>你</em>**将被视为有错的一方，这将伤害到你获取信息或帮助的机会。</p>
<p>另一方面，你偶而真的会碰到无礼和无聊的言行。与上述相反，对真正的冒犯者狠狠地打击，用犀利的语言将其驳得体无完肤都是可以接受的。然而，在行事之前一定要非常非常的有根据。纠正无礼的言论与开始一场毫无意义的口水战仅一线之隔，黑客们自己莽撞地越线的情况并不鲜见。如果你是新手或外人，避开这种莽撞的机会并不高。如果你想得到的是信息而不是消磨时光，这时最好不要把手放在键盘上以免冒险。</p>
<p>（有些人断言很多黑客都有轻度的自闭症或亚斯伯格综合症，缺少用于润滑人类社会<strong>正常</strong>交往所需的神经。这既可能是真也可能是假的。如果你自己不是黑客，兴许你认为我们脑袋有问题还能帮助你应付我们的古怪行为。只管这么干好了，我们不在乎。我们**<em>喜欢</em>**我们现在这个样子，并且通常对病患标记都有站得住脚的怀疑。）</p>
<p>在下一节，我们会谈到另一个问题，当**<em>你</em>**行为不当时所会受到的<code>冒犯</code>。</p>
<h2 id="如何避免扮演失败者" tabindex="-1"> 如何避免扮演失败者</h2>
<p>在黑客社区的论坛中有那么几次你可能会搞砸 -- 以本指南所描述到的或类似的方式。而你会在公开场合中被告知你是如何搞砸的，也许攻击的言语中还会带点夹七夹八的颜色。</p>
<p>这种事发生以后，你能做的最糟糕的事莫过于哀嚎你的遭遇、宣称被口头攻击、要求道歉、高声尖叫、憋闷气、威胁诉诸法律、向其雇主报怨、忘了关马桶盖等等。相反地，你该这么做：</p>
<p>熬过去，这很正常。事实上，它是有益健康且合理的。</p>
<p>社区的标准不会自行维持，它们是通过参与者积极而**<em>公开地</em>**执行来维持的。不要哭嚎所有的批评都应该通过私下的邮件传送，它不是这样运作的。当有人评论你的一个说法有误或者提出不同看法时，坚持声称受到个人攻击也毫无益处，这些都是失败者的态度。</p>
<p>也有其它的黑客论坛，受过高礼节要求的误导，禁止参与者张贴任何对别人帖子挑毛病的消息，并声称<code>如果你不想帮助用户就闭嘴。</code> 结果造成有想法的参与者纷纷离开，这么做只会使它们沦为毫无意义的嘮叨与无用的技术论坛。</p>
<p>夸张的讲法是：你要的是<strong>友善</strong>（以上述方式）还是有用？两个里面挑一个。</p>
<p>记着：当黑客说你搞砸了，并且（无论多么刺耳）告诉你别再这样做时，他正在为关心<strong>你</strong>和<strong>他的社区</strong>而行动。对他而言，不理你并将你从他的生活中滤掉更简单。如果你无法做到感谢，至少要表现地有点尊严，别大声哀嚎，也别因为自己是个有戏剧性超级敏感的灵魂和自以为有资格的新来者，就指望别人像对待脆弱的洋娃娃那样对你。</p>
<p>有时候，即使你没有搞砸（或者只是在他的想像中你搞砸了），有些人也会无缘无故地攻击你本人。在这种情况下，抱怨倒是**<em>真的</em>**会把问题搞砸。</p>
<p>这些来找麻烦的人要么是毫无办法但自以为是专家的不中用家伙，要么就是测试你是否真会搞砸的心理专家。其它读者要么不理睬，要么用自己的方式对付他们。这些来找麻烦的人在给他们自己找麻烦，这点你不用操心。</p>
<p>也别让自己卷入口水战，最好不要理睬大多数的口水战 -- 当然，是在你检验它们只是口水战，而并未指出你有搞砸的地方，且也没有巧妙地将问题真正的答案藏于其后（这也是有可能的）。</p>
<h2 id="不该问的问题" tabindex="-1"> 不该问的问题</h2>
<p>以下是几个经典蠢问题，以及黑客没回答时心中所想的：</p>
<p>问题：</p>
<p>问题：</p>
<p>问题：</p>
<p>问题：</p>
<p>问题：</p>
<p>问题：</p>
<p>问题：</p>
<p>问题：</p>
<p>问题：</p>
<hr>
<p><a id="q1"></a></p>
<blockquote>
<p>问题：我能在哪找到 X 程序或 X 资源？</p>
</blockquote>
<p>回答：就在我找到它的地方啊，白痴 -- 搜索引擎的那一头。天哪！难道还有人不会用 <a href="http://www.google.com" target="_blank" rel="noopener noreferrer">Google</a> 吗？</p>
<p><a id="q2"></a></p>
<blockquote>
<p>问题：我怎样用 X 做 Y？</p>
</blockquote>
<p>回答：如果你想解决的是 Y ，提问时别给出可能并不恰当的方法。这种问题说明提问者不但对 X 完全无知，也对 Y 要解决的问题糊涂，还被特定形势禁锢了思维。最好忽略这种人，等他们把问题搞清楚了再说。</p>
<p><a id="q3"></a></p>
<blockquote>
<p>问题：如何设定我的 shell 提示？？</p>
</blockquote>
<p>回答：如果你有足够的智慧提这个问题，你也该有足够的智慧去 ，然后自己去找出来。</p>
<p><a id="q4"></a></p>
<blockquote>
<p>问题：我可以用 Bass-o-matic 文件转换工具将 AcmeCorp 档案转换为 TeX 格式吗？</p>
</blockquote>
<p>回答：试试看就知道了。如果你试过，你既知道了答案，就不用浪费我的时间了。</p>
<p><a id="q5"></a></p>
<blockquote>
<p>问题：我的程序/设定/SQL语句没有用</p>
</blockquote>
<p>回答：这不算是问题吧，我对要我问你二十个问题才找得出你真正问题的问题没兴趣 -- 我有更有意思的事要做呢。在看到这类问题的时候，我的反应通常不外如下三种</p>
<ul>
<li>你还有什么要补充的吗？</li>
<li>真糟糕，希望你能搞定。</li>
<li>这关我有什么屁事？</li>
</ul>
<p><a id="q6"></a></p>
<blockquote>
<p>问题：我的 Windows 电脑有问题，你能帮我吗？</p>
</blockquote>
<p>回答：能啊，扔掉萎软的垃圾，换个像 Linux 或 BSD 的开放源代码操作系统吧。</p>
<p>注意：如果程序有官方版 Windows 或者与 Windows 有互动（如Samba），你**<em>可以</em>**问与Windows相关的问题， 只是别对问题是由 Windows 操作系统而不是程序本身造成的回复感到惊讶， 因为 Windows 一般来说实在太烂，这种说法通常都是对的。</p>
<p><a id="q7"></a></p>
<blockquote>
<p>问题：我的程序不会动了，我认为系统工具 X 有问题</p>
</blockquote>
<p>回答：你完全有可能是第一个注意到被成千上万用户反复使用的系统调用与函数库档案有明显缺陷的人，更有可能的是你完全没有根据。不同凡响的说法需要不同凡响的证据，当你这样声称时，你必须有清楚而详尽的缺陷说明文件作后盾。</p>
<p><a id="q8"></a></p>
<blockquote>
<p>问题：我在安装 Linux（或者 X ）时有问题，你能帮我吗？</p>
</blockquote>
<p>回答：不能，我只有亲自在你的电脑上动手才能找到毛病。还是去找你当地的 Linux 使用群组者寻求实际的指导吧（你能在<a href="http://www.linux.org/groups/index.html" target="_blank" rel="noopener noreferrer">这儿</a>找到使用者群组的清单）。</p>
<p>注意：如果安装问题与某 Linux 的发行版有关，在它的邮件列表、论坛或本地使用者群组中提问也许是恰当的。此时，应描述问题的准确细节。在此之前，先用 <code>Linux</code> 和**<em>所有</em>**被怀疑的硬件作关键词仔细搜索。</p>
<p><a id="q9"></a></p>
<blockquote>
<p>问题：我怎么才能破解 root 帐号/窃取 OP 特权/读别人的邮件呢？</p>
</blockquote>
<p>回答：想要这样做，说明了你是个卑鄙小人；想找个黑客帮你，说明你是个白痴！</p>
<h2 id="好问题与蠢问题" tabindex="-1"> 好问题与蠢问题</h2>
<p>最后，我将透过举一些例子，来说明怎样聪明的提问；同一个问题的两种问法被放在一起，一种是愚蠢的，另一种才是明智的。</p>
<p><strong><em>蠢问题</em></strong>：</p>
<blockquote>
<p>我可以在哪儿找到关于 Foonly Flurbamatic 的资料？</p>
</blockquote>
<p>这种问法无非想得到  这样的回答。</p>
<p><strong><em>聪明问题</em></strong>：</p>
<blockquote>
<p>我用Google搜索过 &quot;Foonly Flurbamatic 2600&quot;，但是没找到有用的结果。谁知道上哪儿去找对这种设备编程的资料？</p>
</blockquote>
<p>这个问题已经 STFW 过了，看起来他真的遇到了麻烦。</p>
<p><strong><em>蠢问题</em></strong></p>
<blockquote>
<p>我从 foo 项目找来的源码没法编译。它怎么这么烂？</p>
</blockquote>
<p>他觉得都是别人的错，这个傲慢自大的提问者</p>
<p><strong><em>聪明问题</em></strong></p>
<blockquote>
<p>foo 项目代码在 Nulix 6.2 版下无法编译通过。我读过了 FAQ，但里面没有提到跟 Nulix 有关的问题。这是我编译过程的记录，我有什么做的不对的地方吗？</p>
</blockquote>
<p>提问者已经指明了环境，也读过了FAQ，还列出了错误，并且他没有把问题的责任推到别人头上，他的问题值得被关注。</p>
<p><strong><em>蠢问题</em></strong></p>
<blockquote>
<p>我的主机板有问题了，谁来帮我？</p>
</blockquote>
<p>某黑客对这类问题的回答通常是：<code>好的，还要帮你拍拍背和换尿布吗？</code>，然后按下删除键。</p>
<p><strong><em>聪明问题</em></strong></p>
<blockquote>
<p>我在 S2464 主机板上试过了 X 、 Y 和 Z ，但没什么作用，我又试了 A 、 B 和 C 。请注意当我尝试 C 时的奇怪现象。显然 florbish 正在 grommicking，但结果出人意料。通常在 Athlon MP 主机板上引起 grommicking 的原因是什么？有谁知道接下来我该做些什么测试才能找出问题？</p>
</blockquote>
<p>这个家伙，从另一个角度来看，值得去回答他。他表现出了解决问题的能力，而不是坐等天上掉答案。</p>
<p>在最后一个问题中，注意<code>告诉我答案</code>和<code>给我启示，指出我还应该做什么诊断工作</code>之间微妙而又重要的区别。</p>
<p>事实上，后一个问题源自于 2001 年 8 月在 Linux 内核邮件列表（lkml）上的一个真实的提问。我（Eric）就是那个提出问题的人。我在 Tyan S2464 主板上观察到了这种无法解释的锁定现象，列表成员们提供了解决这一问题的重要信息。</p>
<p>通过我的提问方法，我给了别人可以咀嚼玩味的东西；我设法让人们很容易参与并且被吸引进来。我显示了自己具备和他们同等的能力，并邀请他们与我共同探讨。通过告诉他们我所走过的弯路，以避免他们再浪费时间，我也表明了对他们宝贵时间的尊重。</p>
<p>事后，当我向每个人表示感谢，并且讚赏这次良好的讨论经歷的时候， 一个 Linux 内核邮件列表的成员表示，他觉得我的问题得到解决并非由于我是这个列表中的**<em>名人</em>**，而是因为我用了正确的方式来提问。</p>
<p>黑客从某种角度来说是拥有丰富知识但缺乏人情味的家伙；我相信他是对的，如果我**<em>像</em>**个乞讨者那样提问，不论我是谁，一定会惹恼某些人或者被他们忽视。他建议我记下这件事，这直接导致了本指南的出现。</p>
<h2 id="如果得不到回答" tabindex="-1"> 如果得不到回答</h2>
<p>如果仍得不到回答，请不要以为我们觉得无法帮助你。有时只是看到你问题的人不知道答案罢了。没有回应不代表你被忽视，虽然不可否认这种差别很难区分。</p>
<p>总的来说，简单的重复张贴问题是个很糟的点子。这将被视为无意义的喧闹。有点耐心，知道你问题答案的人可能生活在不同的时区，可能正在睡觉，也有可能你的问题一开始就没有组织好。</p>
<p>你可以通过其他渠道获得帮助，这些渠道通常更适合初学者的需要。</p>
<p>有许多网上的以及本地的使用者群组，由热情的软件爱好者（即使他们可能从没亲自写过任何软件）组成。通常人们组建这样的团体来互相帮助并帮助新手。</p>
<p>另外，你可以向很多商业公司寻求帮助，不论公司大还是小。别为要付费才能获得帮助而感到沮丧！毕竟，假使你的汽车发动机汽缸密封圈爆掉了-- 完全可能如此 --你还得把它送到修车铺，并且为维修付费。就算软件没花费你一分钱，你也不能强求技术支持总是免费的。</p>
<p>对像是 Linux 这种大众化的软件，每个开发者至少会对应到上万名使用者。根本不可能由一个人来处理来自上万名使用者的求助电话。要知道，即使你要为这些协助付费，和你所购买的同类软件相比，你所付出的也是微不足道的（通常封闭源代码软件的技术支持费用比开放源代码软件的要高得多，且内容也没那么丰富）。</p>
<h2 id="如何更好地回答问题" tabindex="-1"> 如何更好地回答问题</h2>
<p><strong><em>态度和善一点</em></strong>。问题带来的压力常使人显得无礼或愚蠢，其实并不是这样。</p>
<p><strong><em>对初犯者私下回复</em></strong>。对那些坦诚犯错之人没有必要当众羞辱，一个真正的新手也许连怎么搜索或在哪找常见问题都不知道。</p>
<p><strong><em>如果你不确定，一定要说出来</em></strong>！一个听起来权威的错误回复比没有还要糟，别因为听起来像个专家很好玩，就给别人乱指路。要谦虚和诚实，给提问者与同行都树个好榜样。</p>
<p><strong><em>如果帮不了忙，也别妨碍他</em></strong>。不要在实际步骤上开玩笑，那样也许会毁了使用者的设置 --有些可怜的呆瓜会把它当成真的指令。</p>
<p><strong><em>试探性的反问以引出更多的细节</em></strong>。如果你做得好，提问者可以学到点东西 --你也可以。试试将蠢问题转变成好问题，别忘了我们都曾是新手。</p>
<p>尽管对那些懒虫抱怨一声 RTFM 是正当的，能指出文件的位置（即使只是建议个 Google 搜索关键词）会更好。</p>
<p><strong><em>如果你决定回答，就请给出好的答案</em></strong>。当别人正在用错误的工具或方法时别建议笨拙的权宜之计（wordaround），应推荐更好的工具，重新界定问题。</p>
<p><strong><em>正面的回答问题</em></strong>！如果这个提问者已经很深入的研究而且也表明已经试过 X 、 Y 、 Z 、 A 、 B 、 C 但没得到结果，回答 <code>试试看 A 或是 B</code> 或者 <code>试试X 、 Y 、 Z 、 A 、 B 、 C</code> 并附上一个链接一点用都没有。</p>
<p><strong><em>帮助你的社区从问题中学习</em></strong>。当回复一个好问题时，问问自己<code>如何修改相关文件或常见问题文件以免再次解答同样的问题？</code>，接着再向文件维护者发一份补丁。</p>
<p>如果你是在研究一番后才做出的回答，<strong><em>展现你的技巧而不是直接端出结果</em></strong>。毕竟<code>授人以鱼不如授人以渔</code>。</p>
<h2 id="鸣谢" tabindex="-1"> 鸣谢</h2>
<ul>
<li>Evelyn Mitchel贡献了一些愚蠢问题例子并启发了编写<code>如何更好地回答问题</code>这一节</li>
<li>Mikhail Ramendik贡献了一些特别有价值的建议和改进</li>
<li>xlc520重新编辑了部分，并加入插图</li>
</ul>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="essay" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-03-29T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Nice Article</title>
    <id>https://blog.ciberviler.top/essay/</id>
    <link href="https://blog.ciberviler.top/essay/"/>
    <updated>2022-06-09T09:00:12.000Z</updated>
    <summary type="html">article分类</summary>
    <content type="html"><![CDATA[<p align="center"> 
  <img src="https://metrics.lecoq.io/xlc520?template=classic&isocalendar=1&languages=1&people=1&activity=1&achievements=1&lines=1&repositories=1&notable=1&introduction=1&pagespeed=1&repositories=100&repositories.batch=100&repositories.forks=false&repositories.affiliations=owner&isocalendar.duration=full-year&languages.limit=8&languages.threshold=0%&languages.colors=github&languages.sections=most-used&languages.indepth=false&languages.analysis.timeout=15&languages.categories=markup%2C programming&languages.recent.categories=markup%2C programming&languages.recent.load=300&languages.recent.days=14&people.limit=24&people.identicons=false&people.identicons.hide=false&people.size=28&people.types=followers%2C following&people.shuffle=false&activity.limit=5&activity.load=300&activity.days=14&activity.visibility=all&activity.timestamps=false&activity.filter=all&achievements.threshold=C&achievements.secrets=true&achievements.display=detailed&achievements.limit=0&notable.from=organization&notable.repositories=false&notable.indepth=false&notable.types=commit&repositories.featured= xlc520%2Fxlc520.github.io&introduction.title=true&pagespeed.url=xlc520.github.io&pagespeed.detailed=false&pagespeed.screenshot=false&config.timezone=Asia%2FShanghai" /> 
</p>
<p align="center"> 
  您是第  <img src="https://profile-counter.glitch.me/xlc520/count.svg" />  位访问者
</p>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="essay" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-03-20T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">人生三境界</title>
    <id>https://blog.ciberviler.top/essay/%E4%BA%BA%E7%94%9F%E4%B8%89%E5%A2%83%E7%95%8C.html</id>
    <link href="https://blog.ciberviler.top/essay/%E4%BA%BA%E7%94%9F%E4%B8%89%E5%A2%83%E7%95%8C.html"/>
    <updated>2022-06-09T09:00:12.000Z</updated>
    <summary type="html">人生三境界，格局决定结局，境界决定人生</summary>
    <content type="html"><![CDATA[<h1 id="人生三境界-格局决定结局-境界决定人生" tabindex="-1"> 人生三境界，格局决定结局，境界决定人生</h1>
<p>人生能够成就什么与自身的境界密切相关，人生格局决定人生结局，人生有什么样的境界就有什么样的格局。从古到今，成就大事业，大学问的人，都是经过这三种境界的人。</p>
<p>人生的第一境界是：<strong>昨夜西风凋碧树，独上高楼，望尽天涯路</strong>。这一境界就是人生要立志、要下决心、做人要自强、自立、自信、自奋，人生有了目标，才能有前进的方向，成功者总是从立志开始的，做人没有志向，哪来的成功呢？</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/c8ea15ce36d3d539ad9b54e1d0bf0e58352ab02b.jpeg" alt="img" loading="lazy"></p>
<p>人生的第二境界是：**衣带渐宽终不悔，为伊消得人憔悴。**人生有了理想、有了目标，就需要靠脚踏实地的奋斗来实现，奋斗需要勤奋和刻苦，奋斗需要顽强拼搏，在奋斗的路上不管是苦、是累都无怨无悔，即使是人瘦了，也在所不辞，一个人有了如此执着的精神，便会痴迷于人生的事业和兴趣，成为一个不懈努力的追梦者。</p>
<p>人生的第三境界是：**众时寻他千百度，蓦然回首，那人却在灯火阑珊处。**一个人的成功总不会是一帆风顺的，要成功就需要努力付出，有汗水才会有收获，有付出才会有回报，梅花香自苦寒来，功到自然成，人生只有经过奋斗和拼搏，经过磨砺才能绽放人生美丽的异彩！</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/58ee3d6d55fbb2fb4bc601d49472c7ac4423dccc.jpeg" alt="img" loading="lazy"></p>
<p>做人是需要境界的，人有了境界才能站得高，看得远，如此，才能有美好的人生。人生的三个境界分为四个层次，也就是欲求境界、求知境界、道德境界、审美境界，做人有了境界之分，便有了有德之人，无德之人；有了低级趣味的人，也有高级趣味的人。</p>
<p>做人不能做无德之人，做低级趣味的人，人大多都是凡人和普通的人，即使是凡人和普通的人也要有自己的境界和追求，这就是做一个平凡而不平庸的人。做人要做有德之人，做有健康趣味的人，只有如此 ，人生之路才走得远，像吴亦凡混得如此有名、如此有钱，但他却是无德的人，是一个低级趣味的人，最终他摔得很惨。这就是见证，做人一定要有格局，要有品味，要有追求，要有精神境界，不然，人生就走不远，也飞不高。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/9d82d158ccbf6c8113a64f776606563d32fa4059.jpeg" alt="img" loading="lazy"></p>
<p>人是高级动物，有思想、有灵魂、有智慧，人的高级决定了人必须有精神追求，不能沉迷于物质享受之中。商品经济时代，做人更要经得住各种物欲的诱惑和考验，要受得住寂寞，耐得住宁静，如此才能坚定自己的人生理想，不忘初心，永远前行，做最好的自己。</p>
<p>人的境界靠的自律精神，一个人不自律便会猪狗不如，有境界的人是靠自律约束出来的，自律就是人生的最高境界，人不自律便会放纵，人一旦放纵了便会自毁人生。做人一定要能够克制自己的言行，约束自己的行为。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/279759ee3d6d55fba7ea1c63b71aa84220a4dd0c.jpeg" alt="img" loading="lazy"></p>
<p>孔子曰：<strong>君子有三戒：少之时，血气未定，戒之在色；及其壮也，血气方刚，戒之在斗；及其老也，血气既衰，戒之在得</strong>。孔子是智慧的人，更是自律的人，做人自律就是戒，也就是做人生的减法，约束自己的行为，管住自己的嘴，管住自己的手，如此，做人的境界才能高，格局才能大，路才行得远。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="essay" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-03-20T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">人生最好的三种状态</title>
    <id>https://blog.ciberviler.top/essay/%E4%BA%BA%E7%94%9F%E6%9C%80%E5%A5%BD%E7%9A%84%E4%B8%89%E7%A7%8D%E7%8A%B6%E6%80%81.html</id>
    <link href="https://blog.ciberviler.top/essay/%E4%BA%BA%E7%94%9F%E6%9C%80%E5%A5%BD%E7%9A%84%E4%B8%89%E7%A7%8D%E7%8A%B6%E6%80%81.html"/>
    <updated>2022-06-09T09:00:12.000Z</updated>
    <summary type="html">人生最好的三种状态</summary>
    <content type="html"><![CDATA[<h1 id="人生最好的三种状态-不期而遇-不言而喻-不药而愈" tabindex="-1"> 人生最好的三种状态：不期而遇，不言而喻，不药而愈</h1>
<p>人这一辈子，不过短短数十载，来去匆匆。</p>
<p>很多人终其一生，都在追寻一种最好的状态。</p>
<p>可究竟怎样的状态，才算得上最好的状态呢？</p>
<p><strong>其实，人生最好的状态，就藏在这三句话里。</strong></p>
<p><img src="https://nimg.ws.126.net/?url=http://dingyue.ws.126.net/2020/1227/adc9a8f1p00qlygon000td200u0007gg00hz004g.png&amp;thumbnail=660x2147483647&amp;quality=80&amp;type=jpg" alt="img" loading="lazy"></p>
<p>释家说缘起缘灭，很多人深以为然。我们一生大约会与200万人擦肩而过，与认识大概20万人。佛说每一次的擦肩而过都是前世的一次回眸，那与你命中注定的那人，衣服都会擦烂了吧。爱情不是用来找的，而是等的。很多人去寻找爱情，会找到，但是过程很艰辛。而那种不期而遇的爱情，遇见了就是一辈子。也许就在某天清晨，你推开窗子，楼下正走着的一位女子刚好抬头向上望来，你们四目相对，缘分就自然来了。</p>
<p><strong>命中注定的人，即使隔着万水千山，也总会有一天，在某个地点再次重逢。</strong></p>
<p>曾看过一段话：“人生，总会有不期而遇的温暖，和生生不息的希望。”</p>
<p>所以，哪怕四季更迭，春去春回，我们也总会在某一个轮回中，遇见那个命中注定的人。</p>
<p>然后，怀抱希望，温暖一生。</p>
<p><img src="https://nimg.ws.126.net/?url=http%3A%2F%2Fdingyue.ws.126.net%2F2020%2F1227%2F84d63d90p00qlygon000vd200u0007gg00hz004g.png&amp;thumbnail=660x2147483647&amp;quality=80&amp;type=jpg" alt="img" loading="lazy"></p>
<p>真正好的爱情，就是“不费力”。不需要可以讨好、努力经营，两个人已是顺其自然的舒服。如果一段情、一个人，得让你耗费巨大精力来取悦，这已注定不是陪你到最后的缘分了。最爱你的人，不会舍得你如此辛苦。两个人即使是不说话，也不会觉得尴尬，很多事情都是不言而喻的，仅仅一个眼神、一个表情就能明白对方心中所想，这才是爱情真正的模样。</p>
<p>人这一生，大多数人只是你生命中的过客，匆匆而过，不留下任何痕迹，只有少数人能真正走进你的世界。</p>
<p>在茫茫人海中，若能遇到一个懂你心意，知你悲欢的知心人，便是万两黄金也不换。</p>
<p><strong>在这个人面前，只要你一个眼神，对方就能读懂你的心意；一个动作，对方就能明白你的所需。</strong></p>
<p>不用解释什么，也不用刻意伪装什么。</p>
<p>只有真正懂你的人，才能达到这种心灵上的契合，精神上的同频。</p>
<p>很多事情，在你们之间早就不言而喻。</p>
<p><strong>心若近了，一切便不会远。懂，比什么都重要。</strong></p>
<p><img src="https://nimg.ws.126.net/?url=http%3A%2F%2Fdingyue.ws.126.net%2F2020%2F1227%2F5dadd129p00qlygoo0010d200u0007gg00hz004g.png&amp;thumbnail=660x2147483647&amp;quality=80&amp;type=jpg" alt="img" loading="lazy"></p>
<p>成年人的字典里没有“容易”两个人，我们会经历种种困难，恋人离去，工作不顺，家人生病。任何一件事都让我们想要逃离，不想长大。可是慢慢地，我们再次面对这些困难时，我们能从容面对。一切磨难，你不需要药来治愈，就是人生的最好状态。</p>
<p><strong>成长的路上，我们都会遇到各种各样的难关，都是一路奔跑，一路跌倒；一路得到，又一路失去。</strong></p>
<p>或许很多人，都曾在人群中，假装开心，笑容满面。却在四下无人时，撕下自己看似坚强的外表，露出最真实的脆弱，掩面哭泣。</p>
<p>在这悲喜交错的人生中，没有人是你的万能解药。</p>
<p>哪怕是时间，也不可能成为你最好的解药。</p>
<p>就像季羡林在书中传达给我们的信念：所有的悲欢离合，他人难悟，悲喜自渡。</p>
<p>所以，你要学会独自去面对那些人生难题，找到属于自己的答案。</p>
<p><strong>你要做到，即使没有解药，也能够自我治愈。</strong></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="essay" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-21T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">以你之名，书我一生</title>
    <id>https://blog.ciberviler.top/essay/%E4%BB%A5%E4%BD%A0%E4%B9%8B%E5%90%8D%EF%BC%8C%E4%B9%A6%E6%88%91%E4%B8%80%E7%94%9F.html</id>
    <link href="https://blog.ciberviler.top/essay/%E4%BB%A5%E4%BD%A0%E4%B9%8B%E5%90%8D%EF%BC%8C%E4%B9%A6%E6%88%91%E4%B8%80%E7%94%9F.html"/>
    <updated>2022-06-09T09:00:12.000Z</updated>
    <content type="html"><![CDATA[<h1 id="以你之名-书我一生" tabindex="-1"> 以你之名，书我一生</h1>
<p><strong>“未曾相逢先一笑，初会便已许平生。”</strong></p>
<p><strong>我本是一颗暗淡无光的星，坐落于银色海洋之上，直到听见了另外一个星系的回声，于是便努力的将我这颗星球为你亮起。</strong></p>
<p><strong>我们没必要去花心思设想未来如何应对，而应该武装自己，只为了当有一天遇见的时候，能够理直气壮地说:我知道你很好，但是我也不差。</strong></p>
<p><strong>多希望彼此是一直喜欢，一直热爱，这样我就能恒久地执着地望向你。</strong></p>
<p><strong>后来我才知道，她并不是为我盛开的花，我只是恰好途径了她的盛放。</strong></p>
<p><strong>浮世三千吾爱有三，日、月与卿，日为朝月为暮，卿为朝朝暮暮。</strong></p>
<p><strong>以你之名，书我一生。酸甜苦辣，与你共享;三餐四季，与你共度。</strong></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="essay" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-16T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">早安心语220519</title>
    <id>https://blog.ciberviler.top/essay/%E6%97%A9%E5%AE%89%E5%BF%83%E8%AF%AD220519.html</id>
    <link href="https://blog.ciberviler.top/essay/%E6%97%A9%E5%AE%89%E5%BF%83%E8%AF%AD220519.html"/>
    <updated>2022-06-09T09:00:12.000Z</updated>
    <summary type="html">早安心语220519</summary>
    <content type="html"><![CDATA[<h1 id="早安心语220519" tabindex="-1"> 早安心语220519</h1>
<blockquote>
<p>2022年5月19日</p>
<p>如果有一天公司给你调岗降薪，逼你辞职。说明他已经不是曾经的的那个他了。——By 我自己</p>
</blockquote>
<p>1.马云说过：“傻傻的信，傻傻的干，傻傻的挣了数百万!精明的算，精明的看，最后成了穷光蛋!”水不动就是死水，人不动就是废人。人要有六动：关系靠走动，团队靠活动，客户靠感动，资金靠流动，生命靠运动，成功靠行动!好励志的一段话，送给所有正在奋斗的人!早安!!</p>
<p><img src="http://img.mp.sohu.com/upload/20170531/ffd141fb79a44a75a2bc4e8dbdb7cd98_th.png" alt="img" loading="lazy"></p>
<p>2.前行的路，不怕万人阻挡，只怕自己投降;人生的帆，不怕狂风巨浪，只怕自己没胆量!有路，就大胆去走;有梦，就大胆飞翔。大胆，才应该是我们的信仰，梦想，永远只会是梦里空想，要知道，逆风的方向，更适合飞翔;才是人生奋斗的方向!早安[太阳][太阳][太阳]</p>
<p><img src="http://img.mp.sohu.com/upload/20170531/b4ad3110984c4562895e36a1bfbf9bf4_th.png" alt="img" loading="lazy"></p>
<p>3.每个人的际遇不同，成功总有早晚，但肯定离不开两样东西，一是努力，二就是格局。不要总羡慕别人走运，嫉妒别人成功。平时不努力，就算运气来了，你没迎接它的到来也是擦肩而过。</p>
<p><img src="http://img.mp.sohu.com/upload/20170531/e98a21bc3483488991655a9b89fba3cd_th.png" alt="img" loading="lazy"></p>
<p>4.内心强大比什么都重要 你要照顾好自己;承认自己的平凡，但是努力向好的方向发展;可以平静面对生活，安然的听从自己内心的感受，不受其他影响，你可以迷茫，请不要虚度。早安![拥抱][拥抱]</p>
<p><img src="http://img.mp.sohu.com/upload/20170531/2237eda2c3454edb9fa660ac0cd177a5_th.png" alt="img" loading="lazy"></p>
<p>5.给自己一点掌声。在漫漫人生旅途中,总会有寂寞、失落、沮丧的时候,这时给自己一点掌声,让自己战胜怯懦,使无畏的心更加的坚强,更是温暖自己独自前行的路。当自己累了、倦了、快撑不下去了,给自己一点掌声,不只是对自己寂寞灵魂的一种填充,更是对风雨人生的一种从容。相信自己,肯定自己,做自己。早安![太阳][太阳]</p>
<p><img src="http://img.mp.sohu.com/upload/20170531/414d97812cd848dba9f60102f0a6ec64_th.png" alt="img" loading="lazy"></p>
<p>6.命，是失败者的借口;运，是成功者的谦词。失败者说命不好，心里后悔当初没尽力;成功者说，是命好，心里却清楚付出的代价。命运，不是什么神秘的力量，而是自我的花开出的果。你如何选择，命运就如何发生。想要知道费了多少心，只需看树上挂了多少果实。人生，越努力，越幸运。早安![太阳][太阳]</p>
<p><img src="http://img.mp.sohu.com/upload/20170531/2981e2a7303f43d5b089d914c618b2eb_th.png" alt="img" loading="lazy"></p>
<p>7.当你又瘦又好看，钱包里都是自己努力赚来的钱的时候，你就会恍然大悟，哪有时间患得患失，哪有时间猜东猜西，哪有时间揣摩别人。早安![玫瑰][玫瑰]</p>
<p><img src="http://img.mp.sohu.com/upload/20170531/f9328d620b894c64aca03c6593458ac5_th.png" alt="img" loading="lazy"></p>
<p>8.人生最可悲的事情，莫过于胸怀大志，却又虚度光阴。觉得自己不够聪明，但干事总爱拖延;觉得自己学历不漂亮，可又没利用业余继续充电;对自己不满意，但自我安慰今天好好玩明天再努力。既然知道路远，那就要早点上路。迎着太阳，出发!早安![太阳][太阳]</p>
<p><img src="http://img.mp.sohu.com/upload/20170531/49e9577183644a82a04b2421ef4047a1_th.png" alt="img" loading="lazy"></p>
<p>9.人间没有不弯的路，世上没有不谢的花。通往成功的路不会平坦宽阔，实现自已的梦想不会一帆风顺，人生不如意十有八九，但这些都是暂时的。花开花落，潮起潮落，一切都会有终结的。生命是一场耐心的角逐赛，只要你能坚持下去，即便道路再崎岖难行，前途也是一片光明;生命是一朵花，纵然会在寒冬凋谢，但只要你坚持下来，下一个春天必定会绽放得更加灿烂!早安!</p>
<p><img src="http://img.mp.sohu.com/upload/20170531/e5e12be4674843768bbda9a96582b809_th.png" alt="img" loading="lazy"></p>
<p>10.不要让未来的你，讨厌现在的自己。我正在努力变成自己喜欢的那个自己。早安!</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="essay" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-16T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">鲁迅名言</title>
    <id>https://blog.ciberviler.top/essay/%E9%B2%81%E8%BF%85%E5%90%8D%E8%A8%80.html</id>
    <link href="https://blog.ciberviler.top/essay/%E9%B2%81%E8%BF%85%E5%90%8D%E8%A8%80.html"/>
    <updated>2022-06-09T09:00:12.000Z</updated>
    <content type="html"><![CDATA[<h1 id="鲁迅名言" tabindex="-1"> 鲁迅名言</h1>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16545675217234.jpeg" alt="图片" loading="lazy"></p>
<p><strong>鲁迅</strong>（1881年9月25日－1936年10月19日），浙江绍兴人。著名文学家、思想家、民主战士，五四新文化运动的重要参与者，中国现代文学的奠基人。主要作品有：《呐喊》《彷徨》《朝花夕拾》《且介亭杂文》等。</p>
<p><strong>1、冷漠</strong></p>
<p>在中国，尤其是在都市里，倘使路上有暴病倒地，或翻车捽摔伤的人，路人围观或甚至高兴的人尽有，有肯伸手来扶助一下的人却是极少的。</p>
<p>——《经验》一九三三年</p>
<p><strong>2、自私自利</strong></p>
<p>我的经验，是人来要我帮忙的，他用“互助论”；一到不用，或要攻击我了，就用“进化论的生存竞争论”；取去我的衣服，倘向他索还，他就说我是“个人主义”，自私自利，吝啬得很。</p>
<p>——1935年致萧军、萧红的信</p>
<p><strong>3、不尊重女性</strong></p>
<p>我一向不相信昭君出塞会安汉，木兰从军就可以保隋；也不信妲己亡殷，西施沼吴，杨妃乱唐的那些古老话。我以为在男权社会里，女人是决不会有这种大力量的，兴亡的责任，都应该男的负。但向来的男性的作者，大抵将败亡的大罪，推在女性身上，这真是一钱不值的没有出息的男人。</p>
<p>——《阿金》</p>
<p><strong>4、民族主义</strong></p>
<p>中国现在的假吉诃德们……他们何尝不知道“国货运动”振兴不了什么民族工业。</p>
<p>他们何尝不知道什么“中国固有文化”咒不死帝国主义，无论念几千万遍“不仁不义”或者金光明咒，也不会引发日本地震，使它陆沉大海。然而他们故意高喊恢复“民族精神”，仿佛得了什么祖传秘诀。</p>
<p>——《真假堂吉诃德》</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220607100616554.png" alt="image-20220607100616554" loading="lazy"></p>
<p><strong>5、欺软怕硬</strong></p>
<p>可惜中国人但对于羊显凶兽相，而对于凶兽则显羊相，所以即使显凶兽相，也还是卑怯的国民。这样下去，一定要完结的。</p>
<p>我想，要中国得救，也不必添甚么东西进去，只要青年们将这两种性质的古传用法，反过来一用就够了：对手如凶兽时就如凶兽，对手如羊时就如羊！</p>
<p>——《忽然想到·七》</p>
<p><strong>6、不知耻</strong></p>
<p>战士死了的时候，苍蝇所首先发见的是他的缺点和伤痕，嘬，营营地叫，以为得意，以为比死了的战士更英雄。但是战士已经死了，不再来挥去他们。于是乎苍蝇们即更其营营地叫，自以为倒是不朽的声音，因为他们的完全，远在战士之上。的确的，谁也没有发见过苍蝇们的缺点和创伤。然而，有缺点的战士终竟是战士，完美的苍蝇也终竟不过是苍蝇。</p>
<p>——《战士和苍蝇》</p>
<p><strong>7、国粹主义</strong></p>
<p>即使无名肿毒，倘若生在中国人身上，也便“红肿之处，艳若桃花；溃烂之时，美如奶酪。”国粹所在，妙不可言。</p>
<p>——《随感录三十九》</p>
<p><strong>8、世故</strong></p>
<p>耳闻目睹的不算，单是看看报章，也就可以知道社会上有多少不平，人们有多少冤抑。</p>
<p>但对于这些事，除了有时或有同业、同乡、同族的人们来说几句呼吁的话之外，利害无关的人的义愤的声音，我们是很少听到的。这很分明，是大家不开口；或者以为和自己不相干；或者连“以为和自己不相干”的意思也全没有。</p>
<p>“世故”深到不自觉其“深于世故”，这才真是“深于世故”的了。这是中国处世法的精义中的精义。</p>
<p>——《世故三昧》</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16545675217231.jpeg" alt="图片" loading="lazy"></p>
<p><strong>9、迂腐折中</strong></p>
<p>中国人的性情是总喜欢调和折中的，譬如你说，这屋子太暗，须在这里开一个窗，大家一定不允许的。但如果你主张拆掉屋顶他们就来调和，愿意开窗了。</p>
<p>——《无声的中国》</p>
<p><strong>10、没出息</strong></p>
<p>中国大约太老了，社会上事无大小，都恶劣不堪，像一只黑色的染缸，无论加进甚么新东西去，都变成漆黑。</p>
<p>可是除了再想法子来改革之外，也再没有别的路。</p>
<p>我看一切理想家，不是怀念“过去”，就是“希望将来”，而对于“现在”这一个题目，都缴了白卷，因为谁也开不出药方。</p>
<p>所有最好的药方即所谓“希望将来”的就是。</p>
<p>——《两地书》</p>
<p><strong>11、漠然</strong></p>
<p>凡有一人的主张，得了赞和，是促其前进的；得了反对，是促其奋斗的；独有叫喊于生人中，而生人并无反应，既非赞同，也无反对，如置身毫无边际的荒原，无可措手的了，这是怎样的悲哀呵……</p>
<p>——《&lt;呐喊&gt;自序》</p>
<p><strong>12、冷血</strong></p>
<p>中国人自己诚然不善于战争，却并没有诅咒战争；自己诚然不愿出战，却并未同情于不愿出战的他人；虽然想到自己，却没有想到他人的自己。</p>
<p>——《一个青年的梦译者序二》</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16545675217232.jpeg" alt="图片" loading="lazy"></p>
<p><strong>13、怯弱、懒惰、巧滑</strong></p>
<p>中国人的不敢正视各方面，用瞒和骗，造出奇妙的逃路来，而自以为正路。在这路上，就证明着国民性的怯弱、懒惰而又巧滑。一天一天的满足，即一天一天的堕落，但却又觉得日见其光荣。</p>
<p>在事实上，亡国一次，即添加几个殉难的忠臣，后来每不想光复旧物，而只去赞美那几个忠臣；遭劫一次，即造成一群不辱的烈女，事过之后，也每每不思惩凶、自卫，却只顾歌咏那一群烈女。</p>
<p>——《论睁了眼看》</p>
<p><strong>14、麻木者是胜利者</strong></p>
<p>中国各处是壁，像“鬼打墙”一般，使你随时能“碰”。能打这墙的，能碰而不感到痛苦的，是胜利者。</p>
<p>——《碰壁之后》</p>
<p><strong>15、拒绝改变</strong></p>
<p>我独不解中国人何以于旧状况那么心平气和，于较新的机运就这么疾首蹙额；于已成之局那么委曲求全，于初兴之事就这么求全责备？</p>
<p>——《这个与那个》</p>
<p><strong>16、多疑</strong></p>
<p>中国人不疑自己的多疑。</p>
<p>——《我要骗人》</p>
<p><strong>17、看热闹</strong></p>
<p>群众，尤其是中国的──永远是戏剧的看客。牺牲上场，如果显得慷慨，他们就看了悲壮剧；如果显得觳觫（即恐惧颤抖），他们就看了滑稽剧。北京的羊肉铺常有几个人张嘴看剥羊，仿佛颇为愉快，人的牺牲能给他们的益处，也不过如此。而况事后走不几步，他们并这一点也就忘了。</p>
<p>——《娜拉走后怎样》</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16545675217233.jpeg" alt="图片" loading="lazy"></p>
<p><strong>18、懦弱</strong></p>
<p>中国一向就少有失败的英雄，少有韧性的反抗，少有敢单身鏖战的武人，少有敢抚哭叛徒的吊客；见胜兆则纷纷聚集，见败兆则纷纷逃亡。</p>
<p>——《这个和那个》</p>
<p><strong>19、阴暗</strong></p>
<p>我们中国人对于不是自己的东西，或者将不为自己所有的东西，总要破坏了才快活的。</p>
<p>——《记谈话》</p>
<p><strong>20、个人主义</strong></p>
<p>从生活窘迫过来的人，一到了有钱，容易变成两种情形：一种是理想世界，替处同一境遇的人着想，便成为人道主义；一种是甚么都是自己挣起来，从前的遭遇，使他觉得甚么都是冷酷，便流为个人主义。我们中国大概是变成个人主义者多。</p>
<p>——《文艺与政治的歧途》</p>
<hr>
<p><strong>01</strong></p>
<p>愿中国青年都摆脱冷气，只是向上走，不必听自暴自弃者流的话。能做事的做事，能发声的发声。有一分热，发一分光。就令萤火一般，也可以在黑暗里发一点光，不必等候炬火。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16545677612981.jpeg" alt="图片" loading="lazy"></p>
<p><strong>02</strong></p>
<p>沉着、勇猛，有辨别，不自私。</p>
<p><strong>03</strong></p>
<p>我们目下的当务之急是：一要生存，二要温饱，三要发展。</p>
<p><strong>04</strong></p>
<p>必须敢于正视，这才可望敢想、敢说、敢做、敢当。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16545677612982.jpeg" alt="图片" loading="lazy"></p>
<p><strong>05</strong></p>
<p>事实是毫无情面的东西，它能将空言打得粉碎。</p>
<p><strong>06</strong></p>
<p>贪安稳就没有自由，要自由就要历些危险。只有这两条路。</p>
<p><strong>07</strong></p>
<p>假使做事要面面顾到，那就什么事都不能做了。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16545677612983.jpeg" alt="图片" loading="lazy"></p>
<p><strong>08</strong></p>
<p>明言着轻蔑什么人，并不是十足的轻蔑。惟沉默是最高的轻蔑——最高的轻蔑是无言，而且连眼珠也不转过去。</p>
<p><strong>9</strong></p>
<p>宁可与敌人明打，不欲受同人暗算。</p>
<p><strong>10</strong></p>
<p>青年们先可以将中国变成一个有声的中国。大胆地说话，勇敢地进行，忘掉一切利害，推开了古人，将自己的真心的话发表出来。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16545677612984.jpeg" alt="图片" loading="lazy"></p>
<p><strong>11</strong></p>
<p>时间，每天得到的都是二十四小时，可是一天的时间给勤勉的人带来智慧与力量，给懒散的人只能留下一片悔恨。</p>
<p><strong>12</strong></p>
<p>怀疑并不是缺点。总是疑，而并不下断语，这才是缺点。</p>
<p><strong>13</strong></p>
<p>做一件事，无论大小，倘无恒心，是很不好的。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16545677612985.jpeg" alt="图片" loading="lazy"></p>
<p><strong>14</strong></p>
<p>我们和朋友在一起，可以脱掉衣服，但上阵要穿甲。</p>
<p><strong>15</strong></p>
<p>改造自己，总比禁止别人来的难。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="essay" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-20T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">JSP和JSTL获取服务器参数</title>
    <id>https://blog.ciberviler.top/dev/JSP%E5%92%8CJSTL%E8%8E%B7%E5%8F%96%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%82%E6%95%B0.html</id>
    <link href="https://blog.ciberviler.top/dev/JSP%E5%92%8CJSTL%E8%8E%B7%E5%8F%96%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%82%E6%95%B0.html"/>
    <updated>2022-06-09T03:50:24.000Z</updated>
    <summary type="html">JSP和JSTL获取服务器参数</summary>
    <content type="html"><![CDATA[<h1 id="jsp和jstl获取服务器参数" tabindex="-1"> JSP和JSTL获取服务器参数</h1>
<div><pre><code>&lt;%@ page language=&quot;java&quot; import=&quot;java.util.*&quot; pageEncoding=&quot;UTF-8&quot;%&gt;

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;JSP和JSTL获取服务器参数&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
JSP方式&lt;br/&gt;
&lt;%

String SERVER_NAME = request.getServerName();

String SERVER_SOFTWARE = getServletContext().getServerInfo();

String SERVER_PROTOCOL = request.getProtocol();

Integer SERVER_PORT = request.getServerPort();

String REQUEST_METHOD = request.getMethod();

String PATH_INFO = request.getPathInfo();

String PATH_TRANSLATED = request.getPathTranslated();

String SCRIPT_NAME = request.getServletPath();

String DOCUMENT_ROOT = request.getRealPath(&quot;/&quot;);

String QUERY_STRING = request.getQueryString();

String REMOTE_HOST = request.getRemoteHost();

String REMOTE_ADDR = request.getRemoteAddr();

String AUTH_TYPE = request.getAuthType();

String REMOTE_USER = request.getRemoteUser();

String CONTENT_TYPE = request.getContentType();

Integer CONTENT_LENGTH = request.getContentLength();

String HTTP_ACCEPT = request.getHeader(&quot;Accept&quot;);

String HTTP_USER_AGENT = request.getHeader(&quot;User-Agent&quot;);

String HTTP_REFERER = request.getHeader(&quot;Referer&quot;);

HashMap infoMap = new HashMap();

infoMap.put(&quot;SERVER_NAME&quot;, SERVER_NAME);

infoMap.put(&quot;SERVER_SOFTWARE&quot;, SERVER_SOFTWARE);

infoMap.put(&quot;SERVER_PROTOCOL&quot;, SERVER_PROTOCOL);

infoMap.put(&quot;SERVER_PORT&quot;, SERVER_PORT);
infoMap.put(&quot;REQUEST_METHOD&quot;, REQUEST_METHOD);

infoMap.put(&quot;PATH_INFO&quot;, PATH_INFO);

infoMap.put(&quot;PATH_TRANSLATED&quot;, PATH_TRANSLATED);

infoMap.put(&quot;SCRIPT_NAME&quot;, SCRIPT_NAME);

infoMap.put(&quot;DOCUMENT_ROOT&quot;, DOCUMENT_ROOT);

infoMap.put(&quot;QUERY_STRING&quot;, QUERY_STRING);

infoMap.put(&quot;REMOTE_HOST&quot;, REMOTE_HOST);

infoMap.put(&quot;REMOTE_ADDR&quot;, REMOTE_ADDR);

infoMap.put(&quot;AUTH_TYPE&quot;, AUTH_TYPE);

infoMap.put(&quot;REMOTE_USER&quot;, REMOTE_USER);

infoMap.put(&quot;CONTENT_TYPE&quot;, CONTENT_TYPE);

infoMap.put(&quot;CONTENT_LENGTH&quot;, CONTENT_LENGTH);

infoMap.put(&quot;HTTP_ACCEPT&quot;, HTTP_ACCEPT);

infoMap.put(&quot;HTTP_USER_AGENT&quot;, HTTP_USER_AGENT);

infoMap.put(&quot;HTTP_REFERER&quot;, HTTP_REFERER);

Iterator it = infoMap.keySet().iterator();

%&gt;

&lt;%
while (it.hasNext()) {
Object o = it.next();
%&gt;
　　&lt;%=o%&gt;
　　&lt;%=infoMap.get(o)%&gt;
　　&lt;% out.println(&quot;&lt;br&gt;&quot;); }%&gt;
&lt;br/&gt;

JSTL方式&lt;br/&gt;
${pageContext.request} |取得请求对象&lt;br&gt;
${pageContext.session} |取得session对象&lt;br&gt;
${pageContext.request.queryString} |取得请求的参数字符串&lt;br&gt;
${pageContext.request.requestURL} |取得请求的URL，但不包括请求之参数字符串&lt;br&gt;
${pageContext.request.contextPath} |服务的web application的名称&lt;br&gt;
${pageContext.request.method} |取得HTTP的方法(GET、POST)&lt;br&gt;
${pageContext.request.protocol} |取得使用的协议(HTTP/1.1、HTTP/1.0)&lt;br&gt;
${pageContext.request.remoteUser} |取得用户名称&lt;br&gt;
${pageContext.session.new} |判断session是否为新的，所谓新的session，表示刚由server产生而client尚未使用&lt;br&gt;
${pageContext.session.id} |取得session的ID&lt;br&gt;

${header[&quot;User-Agent&quot;]}|用户浏览器的版本&lt;br/&gt;
${header[&quot;Host&quot;]}|IP&lt;br/&gt;
${pageContext.request.remoteAddr } |取得用户的IP地址&lt;br&gt;
${pageContext.servletContext.serverInfo}|取得主机端的服务信息&lt;br&gt;
${pageContext.request.serverPort}|端口信息&lt;br&gt;
${pageContext.request.serverName}|服务器名称&lt;br&gt;
${pageContext.request.remoteHost}|客户机名称&lt;br&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-22T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">检测网络联通性&amp;generate_204服务汇总</title>
    <id>https://blog.ciberviler.top/other/generate_204%E6%9C%8D%E5%8A%A1%E6%B1%87%E6%80%BB.html</id>
    <link href="https://blog.ciberviler.top/other/generate_204%E6%9C%8D%E5%8A%A1%E6%B1%87%E6%80%BB.html"/>
    <updated>2022-06-09T03:49:58.000Z</updated>
    <summary type="html">检测网络联通性&amp;generate_204服务汇总</summary>
    <content type="html"><![CDATA[<h1 id="检测网络联通性-generate-204服务汇总" tabindex="-1"> 检测网络联通性&amp;generate_204服务汇总</h1>
<p><a href="http://www.gstatic.com/generate_204" target="_blank" rel="noopener noreferrer">http://www.gstatic.com/generate_204</a></p>
<p><a href="http://connect.rom.miui.com/generate_204" target="_blank" rel="noopener noreferrer">http://connect.rom.miui.com/generate_204</a></p>
<p><a href="http://www.google.com/generate_204" target="_blank" rel="noopener noreferrer">http://www.google.com/generate_204</a></p>
<p><a href="http://cp.cloudflare.com/generate_204" target="_blank" rel="noopener noreferrer">http://cp.cloudflare.com/generate_204</a></p>
<p><a href="http://www.qualcomm.cn/generate_204" target="_blank" rel="noopener noreferrer">http://www.qualcomm.cn/generate_204</a></p>
<p>Google： <a href="http://www.gstatic.com/generate_204" target="_blank" rel="noopener noreferrer">http://www.gstatic.com/generate_204</a></p>
<p><a href="http://maps.google.com/generate_204" target="_blank" rel="noopener noreferrer">http://maps.google.com/generate_204</a></p>
<p><a href="http://mt0.google.com/generate_204" target="_blank" rel="noopener noreferrer">http://mt0.google.com/generate_204</a></p>
<p><a href="http://mt1.google.com/generate_204" target="_blank" rel="noopener noreferrer">http://mt1.google.com/generate_204</a></p>
<p><a href="http://mt2.google.com/generate_204" target="_blank" rel="noopener noreferrer">http://mt2.google.com/generate_204</a></p>
<p><a href="http://mt3.google.com/generate_204" target="_blank" rel="noopener noreferrer">http://mt3.google.com/generate_204</a></p>
<p><a href="http://clients3.google.com/generate_204" target="_blank" rel="noopener noreferrer">http://clients3.google.com/generate_204</a></p>
<p>V2ex： <a href="https://www.v2ex.com/generate_204" target="_blank" rel="noopener noreferrer">https://www.v2ex.com/generate_204</a></p>
<p>（不建议使用，因为只支持 https，不支持 http，连接相对耗费资源，对于 wifi 需要跳转认证的情况支持页不好）</p>
<p>小米： <a href="http://connect.rom.miui.com/generate_204" target="_blank" rel="noopener noreferrer">http://connect.rom.miui.com/generate_204</a></p>
<p>华为： <a href="http://connectivitycheck.platform.hicloud.com/generate_204" target="_blank" rel="noopener noreferrer">http://connectivitycheck.platform.hicloud.com/generate_204</a></p>
<p>Vivo： <a href="http://wifi.vivo.com.cn/generate_204" target="_blank" rel="noopener noreferrer">http://wifi.vivo.com.cn/generate_204</a></p>
<table>
<thead>
<tr>
<th>服务提供者</th>
<th>链接</th>
<th>大陆体验</th>
<th>境外体验</th>
<th>http/https</th>
<th>IP Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>Google</td>
<td><a href="http://www.gstatic.com/generate_204" target="_blank" rel="noopener noreferrer">http://www.gstatic.com/generate_204</a></td>
<td>5</td>
<td>10</td>
<td>204⁄204</td>
<td>4+6</td>
</tr>
<tr>
<td>Google</td>
<td><a href="http://www.google-analytics.com/generate_204" target="_blank" rel="noopener noreferrer">http://www.google-analytics.com/generate_204</a></td>
<td>6</td>
<td>10</td>
<td>204⁄204</td>
<td>4+6</td>
</tr>
<tr>
<td>Google</td>
<td><a href="http://www.google.com/generate_204" target="_blank" rel="noopener noreferrer">http://www.google.com/generate_204</a></td>
<td>0</td>
<td>10</td>
<td>204⁄204</td>
<td>4+6</td>
</tr>
<tr>
<td>Google</td>
<td><a href="http://connectivitycheck.gstatic.com/generate_204" target="_blank" rel="noopener noreferrer">http://connectivitycheck.gstatic.com/generate_204</a></td>
<td>4</td>
<td>10</td>
<td>204⁄204</td>
<td>4+6</td>
</tr>
<tr>
<td>Apple</td>
<td><a href="http://captive.apple.com/" target="_blank" rel="noopener noreferrer">http://captive.apple.com</a></td>
<td>3</td>
<td>10</td>
<td>200⁄200</td>
<td>4+6</td>
</tr>
<tr>
<td>Apple</td>
<td><a href="http://www.apple.com/library/test/success.html" target="_blank" rel="noopener noreferrer">http://www.apple.com/library/test/success.html</a></td>
<td>7</td>
<td>10</td>
<td>200⁄200</td>
<td>4+6</td>
</tr>
<tr>
<td>MicroSoft</td>
<td><a href="http://www.msftconnecttest.com/connecttest.txt" target="_blank" rel="noopener noreferrer">http://www.msftconnecttest.com/connecttest.txt</a></td>
<td>5</td>
<td>10</td>
<td>200/error</td>
<td>4</td>
</tr>
<tr>
<td>Cloudflare</td>
<td><a href="http://cp.cloudflare.com/" target="_blank" rel="noopener noreferrer">http://cp.cloudflare.com/</a></td>
<td>4</td>
<td>10</td>
<td>204⁄204</td>
<td>4+6</td>
</tr>
<tr>
<td>Firefox</td>
<td><a href="http://detectportal.firefox.com/success.txt" target="_blank" rel="noopener noreferrer">http://detectportal.firefox.com/success.txt</a></td>
<td>5</td>
<td>10</td>
<td>200⁄200</td>
<td>4+6</td>
</tr>
<tr>
<td>V2ex</td>
<td><a href="http://www.v2ex.com/generate_204" target="_blank" rel="noopener noreferrer">http://www.v2ex.com/generate_204</a></td>
<td>0</td>
<td>10</td>
<td>204⁄301</td>
<td>4+6</td>
</tr>
<tr>
<td>小米</td>
<td><a href="http://connect.rom.miui.com/generate_204" target="_blank" rel="noopener noreferrer">http://connect.rom.miui.com/generate_204</a></td>
<td>10</td>
<td>4</td>
<td>204⁄204</td>
<td>4</td>
</tr>
<tr>
<td>华为</td>
<td><a href="http://connectivitycheck.platform.hicloud.com/generate_204" target="_blank" rel="noopener noreferrer">http://connectivitycheck.platform.hicloud.com/generate_204</a></td>
<td>10</td>
<td>5</td>
<td>204⁄204</td>
<td>4</td>
</tr>
<tr>
<td>Vivo</td>
<td><a href="http://wifi.vivo.com.cn/generate_204" target="_blank" rel="noopener noreferrer">http://wifi.vivo.com.cn/generate_204</a></td>
<td>10</td>
<td>5</td>
<td>204⁄204</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>以上<strong>大陆</strong>指中国大陆，<strong>境外</strong>指非中国大陆。</p>
<p><strong>体验</strong>目前仅进行粗略测试延迟，大概率实际不符，仅作参考。</p>
<p><strong>http/https</strong>一列表示使用指定协议进行请求，返回的状态码。部分场合对状态码要求较严格。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-02T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Thanox 碑情景模式</title>
    <id>https://blog.ciberviler.top/daily/Thanox%E5%A2%93%E7%A2%91%E6%83%85%E6%99%AF%E6%A8%A1%E5%BC%8F.html</id>
    <link href="https://blog.ciberviler.top/daily/Thanox%E5%A2%93%E7%A2%91%E6%83%85%E6%99%AF%E6%A8%A1%E5%BC%8F.html"/>
    <updated>2022-06-12T02:30:32.000Z</updated>
    <summary type="html">Thanox 墓碑情景模式</summary>
    <content type="html"><![CDATA[<h1 id="thanox墓碑情景模式" tabindex="-1"> Thanox墓碑情景模式</h1>
<h2 id="最终合并2022-06-06" tabindex="-1"> 最终合并2022.06.06</h2>
<p>分为两个版本，普通版和音频焦点版，根据自己需求选一个</p>
<p>搭配<a href="https://github.com/myflavor/NoANR/releases/" target="_blank" rel="noopener noreferrer">NoANR(点击下载)</a></p>
<p><a href="https://coolstars.lanzoum.com/in97305v6ewj" target="_blank" rel="noopener noreferrer">Thanox3.9.9(点击下载)</a>
<a href="https://github.com/Tornaco/Thanox/releases" target="_blank" rel="noopener noreferrer">github</a></p>
<p><a href="https://xlc.lanzouh.com/ixU2G062x56d" target="_blank" rel="noopener noreferrer">Thanox3.9.9row</a></p>
<h3 id="普通版" tabindex="-1"> 普通版</h3>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"NoActive"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"普通版-应用进入后台冻结进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>-1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"frontPkgChanged"</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"if(thanos.getActivityManager().isPkgSmartStandByEnabled(to)){su.exe(\"kill -CONT `pgrep -f \"+ to + \"`\");su.exe(\"appops set \" +to + \" WAKE_LOCK default\")}"</span><span>,</span>
            <span>"if(!thanos.getActivityManager().isPkgSmartStandByEnabled(from)){break}"</span><span>,</span>
            <span>"foreach (rule : thanos.getActivityManager().getAllStandbyRules()){if(rule.startsWith(\"KEEP\") &amp;&amp; rule.contains(from + \"/\")){break}}"</span><span>,</span>
            <span>"su.exe(\"appops set \" + from + \" WAKE_LOCK ignore\");"</span><span>,</span>
            <span>"Thread.sleep(2000);"</span><span>,</span>
            <span>"if(activity.getFrontAppPackage()!=from &amp;&amp; !thanos.windowManager.hasVisibleWindows(from)){su.exe(\"kill -STOP `pgrep -f \"+ from +\"`\")};"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="音频焦点版" tabindex="-1"> 音频焦点版</h3>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"NoActive"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>" 音频焦点版-应用进入后台冻结进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>-1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"frontPkgChanged"</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"if(thanos.getActivityManager().isPkgSmartStandByEnabled(to)){su.exe(\"kill -CONT `pgrep -f \"+ to + \"`\");su.exe(\"appops set \" +to + \" WAKE_LOCK default\")}"</span><span>,</span>
            <span>"if(!thanos.getActivityManager().isPkgSmartStandByEnabled(from)){break}"</span><span>,</span>
            <span>"foreach (rule : thanos.getActivityManager().getAllStandbyRules()){if(rule.startsWith(\"KEEP\") &amp;&amp; rule.contains(from + \"/\")){break}}"</span><span>,</span>
            <span>"if(su.exe(\"dumpsys audio|grep client:|grep -v died|cut -d ' ' -f 6\").out.contains(from)){break}"</span><span>,</span>
            <span>"su.exe(\"appops set \" + from + \" WAKE_LOCK ignore\");"</span><span>,</span>
            <span>"Thread.sleep(2000);"</span><span>,</span>
            <span>"if(activity.getFrontAppPackage()!=from &amp;&amp; !thanos.windowManager.hasVisibleWindows(from)){su.exe(\"kill -STOP `pgrep -f \"+ from +\"`\")};"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"NoActive(Plus)"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>" 音频焦点版-应用通知移除冻结进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"notificationRemoved &amp;&amp; thanos.getActivityManager().isPkgSmartStandByEnabled(pkgName)"</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"foreach (rule : thanos.getActivityManager().getAllStandbyRules()){if(rule.startsWith(\"KEEP\") &amp;&amp; rule.contains(pkgName + \"/\")){break}}"</span><span>,</span>
            <span>"su.exe(\"appops set \" + pkgName + \" WAKE_LOCK ignore\");"</span><span>,</span>
            <span>"if(activity.getFrontAppPackage()!=from &amp;&amp; !thanos.windowManager.hasVisibleWindows(pkgName)){su.exe(\"kill -STOP `pgrep -f \"+ pkgName +\"`\")};"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="_2022-06-05更新" tabindex="-1"> 2022.06.05更新</h2>
<p>不再使用whiteApps全局变量，使用乖巧规则，即乖巧KEEP规则就是白名单</p>
<h3 id="解冻-通用" tabindex="-1"> 解冻(通用)</h3>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"解冻进程(通用)"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"当应用进入前台时解冻进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"frontPkgChanged &amp;&amp; thanos.getActivityManager().isPkgSmartStandByEnabled(to)"</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"su.exe(\"kill -CONT `pgrep -f \"+ to + \"`\");"</span><span>,</span>
            <span>"su.exe(\"appops set \" +to + \" WAKE_LOCK default\");"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>冻结有两个版本，一个普通版，一个跳过音频焦点版（获得音频焦点的应用不会被冻结，大部分音乐播放器在播放的时候都会获取音频焦点，暂停时取消焦点，部分流氓APP暂停不会取消音频焦点，由于是从shell取的值，可能部分机子会有问题？）
全局变量whiteApps可添加白名单APP跳过墓碑仅乖巧</p>
<h3 id="普通版-1" tabindex="-1"> 普通版</h3>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"冻结进程(AppOps)"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"普通版-当应用进入后台时设置AppOps"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"frontPkgChanged &amp;&amp; thanos.getActivityManager().isPkgSmartStandByEnabled(from)"</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"foreach (rule : thanos.getActivityManager().getAllStandbyRules()){if(rule.startsWith(\"KEEP\") &amp;&amp; rule.contains(from + \"/\")){break}}"</span><span>,</span>
            <span>"su.exe(\"appops set \" + from + \" WAKE_LOCK ignore\");"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"冻结进程"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"普通版-当应用进入后台时冻结进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>2</span><span>,</span>
        <span>"delay"</span><span>:</span> <span>2000</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"frontPkgChanged &amp;&amp; thanos.getActivityManager().isPkgSmartStandByEnabled(from)"</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"foreach (rule : thanos.getActivityManager().getAllStandbyRules()){if(rule.startsWith(\"KEEP\") &amp;&amp; rule.contains(from + \"/\")){break}}"</span><span>,</span>
            <span>"if(activity.getFrontAppPackage()!=from &amp;&amp; !thanos.windowManager.hasVisibleWindows(from)){su.exe(\"kill -STOP `pgrep -f \"+ from +\"`\")};"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="跳过音频焦点版" tabindex="-1"> 跳过音频焦点版</h3>
<p>（推荐开启乖巧模式跳过通知的应用或者设置乖巧规则）</p>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"冻结进程(AppOps)"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"跳过音频焦点版-当应用进入后台时设置AppOps"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"frontPkgChanged &amp;&amp; thanos.getActivityManager().isPkgSmartStandByEnabled(from)"</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"foreach (rule : thanos.getActivityManager().getAllStandbyRules()){if(rule.startsWith(\"KEEP\") &amp;&amp; rule.contains(from + \"/\")){break}}"</span><span>,</span>
            <span>"if(su.exe(\"dumpsys audio|grep client:|grep -v died|cut -d ' ' -f 6\").out.contains(from)){break}"</span><span>,</span>
            <span>"su.exe(\"appops set \" + from + \" WAKE_LOCK ignore\");"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"冻结进程"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"跳过音频焦点版-当应用进入后台时冻结进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>2</span><span>,</span>
        <span>"delay"</span><span>:</span> <span>2000</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"frontPkgChanged &amp;&amp; thanos.getActivityManager().isPkgSmartStandByEnabled(from)"</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"foreach (rule : thanos.getActivityManager().getAllStandbyRules()){if(rule.startsWith(\"KEEP\") &amp;&amp; rule.contains(from + \"/\")){break}}"</span><span>,</span>
            <span>"if(su.exe(\"dumpsys audio|grep client:|grep -v died|cut -d ' ' -f 6\").out.contains(from)){break}"</span><span>,</span>
            <span>"if(activity.getFrontAppPackage()!=from &amp;&amp; !thanos.windowManager.hasVisibleWindows(from)){su.exe(\"kill -STOP `pgrep -f \"+ from +\"`\")};"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"冻结进程(增强)"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"跳过音频焦点版-当应用通知移除时冻结进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"notificationRemoved &amp;&amp; thanos.getActivityManager().isPkgSmartStandByEnabled(pkgName)"</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"foreach (rule : thanos.getActivityManager().getAllStandbyRules()){if(rule.startsWith(\"KEEP\") &amp;&amp; rule.contains(pkgName + \"/\")){break}}"</span><span>,</span>
            <span>"su.exe(\"appops set \" + pkgName + \" WAKE_LOCK ignore\");"</span><span>,</span>
            <span>"if(activity.getFrontAppPackage()!=from &amp;&amp; !thanos.windowManager.hasVisibleWindows(pkgName)){su.exe(\"kill -STOP `pgrep -f \"+ pkgName +\"`\")};"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="合并" tabindex="-1"> 合并</h2>
<h3 id="合并冻结" tabindex="-1"> 合并冻结</h3>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"冻结进程(合并)"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"当应用进入后台时冻结进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>-1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"frontPkgChanged &amp;&amp; thanos.getActivityManager().isPkgSmartStandByEnabled(from)"</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"foreach (rule : thanos.getActivityManager().getAllStandbyRules()){if(rule.startsWith(\"KEEP\") &amp;&amp; rule.contains(from + \"/\")){break}}"</span><span>,</span>
            <span>"su.exe(\"appops set \" + from + \" WAKE_LOCK ignore\");"</span><span>,</span>
            <span>"Thread.sleep(2000);"</span><span>,</span>
            <span>"if(activity.getFrontAppPackage()!=from &amp;&amp; !thanos.windowManager.hasVisibleWindows(from)){su.exe(\"kill -STOP `pgrep -f \"+ from +\"`\")};"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="合并解冻" tabindex="-1"> 合并解冻</h3>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"解冻进程(合并)"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"当应用进入前台时解冻进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"frontPkgChanged &amp;&amp; thanos.getActivityManager().isPkgSmartStandByEnabled(to)"</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"su.exe(\"kill -CONT `pgrep -f \"+ to + \"`\");"</span><span>,</span>
            <span>"su.exe(\"appops set \" +to + \" WAKE_LOCK default\");"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="微信" tabindex="-1"> 微信</h2>
<h3 id="微信保活" tabindex="-1"> 微信保活</h3>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"微信保活(包)"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"微信被杀死时，启动微信进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"pkgKilled == true &amp;&amp; pkgName==\"com.tencent.mm\""</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"Thread.sleep(4000);"</span><span>,</span>
            <span>"activity.launchProcessForPackage(\"com.tencent.mm\")"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="微信保活-自改" tabindex="-1"> 微信保活(自改)</h3>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"微信保活双服务(自改)"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"微信被杀死时，启动微信进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"pkgKilled == true &amp;&amp; pkgName==\"com.tencent.mm\""</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"Thread.sleep(4000);"</span><span>,</span>
            <span>"su.exe('am start-foreground-service com.tencent.mm/com.tencent.mm.booter.CoreService');"</span><span>,</span>
            <span>"su.exe('am start-foreground-service com.tencent.mm/com.tencent.mm.service.ProcessService$MMProcessService');"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="微信保活3-自改" tabindex="-1"> 微信保活3(自改)</h3>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"微信保活多服务(自改)"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"微信被杀死时，启动微信进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"pkgKilled == true &amp;&amp; pkgName==\"com.tencent.mm\""</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"Thread.sleep(4000);"</span><span>,</span>
            <span>"su.exe('am start-foreground-service com.tencent.mm/com.tencent.mm.booter.CoreService');"</span><span>,</span>
            <span>"Thread.sleep(200);"</span><span>,</span>
            <span>"su.exe('am start-foreground-service com.tencent.mm/com.tencent.mm.service.ProcessService$MMProcessService');"</span><span>,</span>
            <span>"Thread.sleep(200);"</span><span>,</span>
            <span>"su.exe('am start-foreground-service com.tencent.mm/com.tencent.mm.ipcinvoker.wx_extension.service.MainProcessIPCService');"</span><span>,</span>
            <span>"Thread.sleep(200);"</span><span>,</span>
            <span>"su.exe('am start-foreground-service com.tencent.mm/com.tencent.mm.ipcinvoker.wx_extension.service.PushProcessIPCService');"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="微信进程优化" tabindex="-1"> 微信进程优化</h3>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"微信进程优化"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"优化保留双进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>2</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"frontPkgChanged == true &amp;&amp; from == \"com.tencent.mm\""</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"Thread.sleep(8000);"</span><span>,</span>
            <span>"su.exe(\"ps -ef|grep com.tencent.mm:|grep -v :push|grep -v grep|awk '{print $2}'|xargs kill -9\")"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>

</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="qq" tabindex="-1"> QQ</h2>
<h3 id="qq保活" tabindex="-1"> QQ保活</h3>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"QQ保活"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"QQ被杀死时，启动QQ进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"pkgKilled == true &amp;&amp; (pkgName == \"com.tencent.mobileqq\")"</span><span>,</span>
        <span>"actions"</span><span>:</span>
        <span>[</span>
            <span>"Thread.sleep(4000);"</span><span>,</span>
            <span>"su.exe('am start-foreground-service com.tencent.mobileqq/com.tencent.mobileqq.msf.service.MsfService');"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="qq保活2" tabindex="-1"> QQ保活2</h3>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"QQ保活(包)"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"QQ被杀死时，启动QQ进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"pkgKilled == true &amp;&amp; pkgName==\"com.tencent.mobileqq\""</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
            <span>"Thread.sleep(4000);"</span><span>,</span>
            <span>"activity.launchProcessForPackage(\"com.tencent.mobileqq\")"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="qq保活3" tabindex="-1"> QQ保活3</h3>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"QQ保活多服务(自改)"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"QQ被杀死时，启动QQ进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>1</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"pkgKilled == true &amp;&amp; (pkgName == \"com.tencent.mobileqq\")"</span><span>,</span>
        <span>"actions"</span><span>:</span>
        <span>[</span>
            <span>"Thread.sleep(4000);"</span><span>,</span>
            <span>"activity.launchProcessForPackage(\"com.tencent.mobileqq\")"</span><span>,</span>
            <span>"Thread.sleep(400);"</span><span>,</span>
            <span>"su.exe('am start-foreground-service com.tencent.mobileqq/com.tencent.mobileqq.msf.service.MsfService');"</span><span>,</span>
            <span>"Thread.sleep(400);"</span><span>,</span>
            <span>"su.exe('am start-foreground-service com.tencent.mobileqq/com.tencent.mobileqq.msf.service.MSFAliveJobService');"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="qq进程优化" tabindex="-1"> QQ进程优化</h3>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"name"</span><span>:</span> <span>"QQ进程优化"</span><span>,</span>
        <span>"description"</span><span>:</span> <span>"优化保留双进程"</span><span>,</span>
        <span>"priority"</span><span>:</span> <span>2</span><span>,</span>
        <span>"condition"</span><span>:</span> <span>"frontPkgChanged == true &amp;&amp; from == \"com.tencent.mobileqq\""</span><span>,</span>
        <span>"actions"</span><span>:</span> <span>[</span>
        <span>"Thread.sleep(5000);"</span><span>,</span>
        <span>"su.exe(\"ps -ef|grep com.tencent.mobileqq:|grep -v :MSF|grep -v grep|awk '{print $2}'|xargs kill -9\")"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="daily" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-21T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">通过Nginx来实现禁止国外IP访问网站</title>
    <id>https://blog.ciberviler.top/dev/%E9%80%9A%E8%BF%87Nginx%E6%9D%A5%E5%AE%9E%E7%8E%B0%E7%A6%81%E6%AD%A2%E5%9B%BD%E5%A4%96IP%E8%AE%BF%E9%97%AE%E7%BD%91%E7%AB%99.html</id>
    <link href="https://blog.ciberviler.top/dev/%E9%80%9A%E8%BF%87Nginx%E6%9D%A5%E5%AE%9E%E7%8E%B0%E7%A6%81%E6%AD%A2%E5%9B%BD%E5%A4%96IP%E8%AE%BF%E9%97%AE%E7%BD%91%E7%AB%99.html"/>
    <updated>2022-06-03T02:53:13.000Z</updated>
    <content type="html"><![CDATA[<h1 id="通过nginx来实现禁止国外ip访问网站" tabindex="-1"> 通过Nginx来实现禁止国外IP访问网站</h1>
<p>前言： 先来说说为啥要写这篇文章，之前小编看了下nginx 的访问日志，发现每天有好多国外的IP地址来访问我的网站，并且访问的内容基本上都是恶意的。因此 我决定 禁止国外IP 来访问我的网站</p>
<p>想要实现这个功能有很多方法，下面我就来介绍基于 NGINX的ngx_http_geoip2模块 来禁止国外IP 访问网站</p>
<p><strong>一、安装geoip2扩展依赖</strong></p>
<div><pre><code><span>[</span>root@fxkj ~<span>]</span><span># yum install libmaxminddb-devel -y</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p><strong>二、下载ngx_http_geoip2_module模块</strong></p>
<div><pre><code><span>[</span>root@fxkj tmp<span>]</span><span>#  git clone https://github.com/leev/ngx_http_geoip2_module.git</span>
<span>[</span>ro tmp<span>]</span><span># </span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p><strong>三、解压模块到指定路径</strong></p>
<p>我这里解压到/usr/local 目录下</p>
<div><pre><code><span>[</span>root@fxkj tmp<span>]</span><span># mv ngx_http_geoip2_module/ /usr/local/</span>
<span>[</span>root@fxkj local<span>]</span><span># ll ngx_http_geoip2_module/</span>
total <span>60</span>
-rw-r--r-- <span>1</span> root root  <span>1199</span> Aug <span>13</span> <span>17</span>:20 config
-rw-r--r-- <span>1</span> root root  <span>1311</span> Aug <span>13</span> <span>17</span>:20 LICENSE
-rw-r--r-- <span>1</span> root root <span>23525</span> Aug <span>13</span> <span>17</span>:20 ngx_http_geoip2_module.c
-rw-r--r-- <span>1</span> root root <span>21029</span> Aug <span>13</span> <span>17</span>:20 ngx_stream_geoip2_module.c
-rw-r--r-- <span>1</span> root root  <span>3640</span> Aug <span>13</span> <span>17</span>:20 README.md
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>四、安装nginx 模块</strong></p>
<p>首先说明下环境，我的nginx 版本是 1.16 , 在网上查了下 安装 ngx_http_geoip2 模块至少需要 1.18 版本及以上，因此此次安装我是 升级nginx1.18，添加 ngx_http_geoip2 模块。</p>
<ul>
<li>下载nginx 1.18 版本</li>
</ul>
<div><pre><code>[root@fxkj tmp]# wget http://nginx.org/download/nginx-1.18.0.tar.gz
</code></pre><div aria-hidden="true"><div></div></div></div><ul>
<li>解压nginx1.18 软件包并 升级为 nginx1.18 ，添加 ngx_http_geoip2 模块</li>
</ul>
<p>需要注意：</p>
<p><strong>1、升级nginx, 添加nginx 模块 只需要 编译 然后 make
不需要 make instll 不然线上的nginx 会被新版本nginx 完完整整的替换掉</strong></p>
<p><strong>2、编译前 需要看下 nginx 当前安装了哪些模块</strong></p>
<div><pre><code>**<span>[</span>root@fxkj tmp<span>]</span><span># /usr/local/nginx/sbin/nginx -V**</span>

**nginx version: nginx/1.16.0**

**built by gcc <span>4.8</span>.5 <span>20150623</span> <span>(</span>Red Hat <span>4.8</span>.5-39<span>)</span> <span>(</span>GCC<span>)</span>**

**built with OpenSSL <span>1.0</span>.2k-fips <span>26</span> Jan <span>2017</span>**

**TLS SNI support enabled**

**configure arguments: --with-http_stub_status_module --prefix<span>=</span>/usr/local/nginx --user<span>=</span>nginx --group<span>=</span>nginx --with-http_ssl_module --with-stream**
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>编译安装</p>
<div><pre><code><span>[</span>root@fxkj tmp<span>]</span><span># tar -xf nginx-1.18.0.tar.gz </span>
<span>[</span>root@fxkj tmp<span>]</span><span># cd nginx-1.18.0/</span>
<span>[</span>root@fxkj nginx-1.18.0<span>]</span><span># ./configure --with-http_stub_status_module \</span>
 --prefix<span>=</span>/usr/local/nginx <span>\</span>
 --user<span>=</span>nginx --group<span>=</span>nginx --with-http_ssl_module --with-stream <span>\</span>
 --add-module<span>=</span>/usr/local/ngx_http_geoip2_module
<span>[</span>root@fxkj nginx-1.18.0<span>]</span><span># make</span>
<span>[</span>root@fxkj nginx-1.18.0<span>]</span><span># cp /usr/loca/nginx/sbin/nginx /usr/loca/nginx/sbin/nginx1.16    #备份</span>
<span>[</span>root@fxkj nginx-1.18.0<span>]</span><span># cp objs/nginx /usr/local/nginx/sbin/    #用新的去覆盖旧的</span>
<span>[</span>root@fxkj nginx-1.18.0<span>]</span><span># pkill nginx     #杀死nginx</span>
<span>[</span>root@fxkj nginx-1.18.0<span>]</span><span># /usr/local/nginx/sbin/nginx    #再次启动Nginx</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>查看nginx 版本 以及安装的模块</p>
<div><pre><code><span>[</span>root@fxkj nginx-1.18.0<span>]</span><span># /usr/local/nginx/sbin/nginx -V</span>

nginx version: nginx/1.18.0

built by gcc <span>4.8</span>.5 <span>20150623</span> <span>(</span>Red Hat <span>4.8</span>.5-39<span>)</span> <span>(</span>GCC<span>)</span>

built with OpenSSL <span>1.0</span>.2k-fips <span>26</span> Jan <span>2017</span>

TLS SNI support enabled

configure arguments: --with-http_stub_status_module --prefix<span>=</span>/usr/local/nginx --user<span>=</span>nginx --group<span>=</span>nginx --with-http_ssl_module --with-stream **--add-module<span>=</span>/usr/local/ngx_http_geoip2_module**
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>五、下载最新的IP地址数据库文件</strong></p>
<p>模块安装成功后，还要在 Nginx 里指定数据库，在安装运行库时默认安装了两个，位于 /usr/share/GeoIP/ 目录下，一个只有 IPv4，一个包含 IPv4 和 IPv6：</p>
<p>登录 <a href="http://www.maxmind.com" target="_blank" rel="noopener noreferrer">www.maxmind.com</a> 网址，创建账户 下载最新的库文件（账户创建就不演示了）</p>
<p>点击左侧 ，Download Files</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/a965a80a0e354dde96ba5fa1091cf86f.png" alt="通过Nginx来实现禁止国外IP访问网站" loading="lazy"></p>
<p>选择 GeoLite2 Country ，点击 Download GZIP 下载即可</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/c3e087baa970419593541115de1ad8be.png" alt="通过Nginx来实现禁止国外IP访问网站" loading="lazy"></p>
<p>上传到 /usr/share/GeoIP/ 下并解压</p>
<div><pre><code><span>[</span>root@fxkj local<span>]</span><span># cd /usr/share/GeoIP/</span>
<span>[</span>root@fxkj GeoIP<span>]</span><span># ll</span>
total <span>69612</span>
lrwxrwxrwx. <span>1</span> root root       <span>17</span> Mar  <span>7</span>  <span>2019</span> GeoIP.dat -<span>></span> GeoIP-initial.dat
-rw-r--r--. <span>1</span> root root  <span>1242574</span> Oct <span>30</span>  <span>2018</span> GeoIP-initial.dat
lrwxrwxrwx. <span>1</span> root root       <span>19</span> Mar  <span>7</span>  <span>2019</span> GeoIPv6.dat -<span>></span> GeoIPv6-initial.dat
-rw-r--r--. <span>1</span> root root  <span>2322773</span> Oct <span>30</span>  <span>2018</span> GeoIPv6-initial.dat
-rw-r--r--  <span>1</span> root root  <span>3981623</span> Aug <span>12</span> 02:37 GeoLite2-Country.mmdb
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>六、配置nginx 配置文件</strong></p>
<p><strong>修改前 先备份配置文件</strong></p>
<p>[root@fxkj ~]# cp /usr/local/nginx/conf/nginx.conf /usr/local/nginx/conf/nginx.conf-bak</p>
<p>[root@fxkj ~]# vim /usr/local/nginx/conf/nginx.conf</p>
<p>在http 中添加 几行，定义数据库文件位置</p>
<div><pre><code>geoip2 /usr/share/GeoIP/GeoLite2-City.mmdb <span>{</span>
auto_reload 5m<span>;</span>
<span>$geoip2_data_country_code</span> country iso_code<span>;</span>
<span>}</span>
  map <span>$geoip2_data_country_code</span> <span>$allowed_country</span> <span>{</span>
                default <span>yes</span><span>;</span>
                CN no<span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/bfc6d7c990cf41b08b13280b8ee9f0e8.png" alt="通过Nginx来实现禁止国外IP访问网站" loading="lazy"></p>
<p>在 server 中的 location 下 添加 条件</p>
<p>如果满足IP 是国外IP 就 执行下面的return 动作，我这里定义了3种, 注释了其中两个。</p>
<p>当访问IP 是国外IP ，直接返回404</p>
<div><pre><code><span>if</span> <span>(</span><span>$allowed_country</span> <span>=</span> <span>yes</span><span>)</span> <span>{</span>
       <span># return https://www.baidu.com;</span>
       <span># return /home/japan;</span>
        <span>return</span> <span>404</span><span>;</span>
          <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/58effbcb1b4d4422b637a238d8371051.png" alt="通过Nginx来实现禁止国外IP访问网站" loading="lazy"></p>
<p>修改完毕后， 检测下配置文件，重新加载下 nginx</p>
<div><pre><code><span>[</span>root@fxkj ~<span>]</span><span># /usr/local/nginx/sbin/nginx -t</span>
nginx: the configuration <span>file</span> /usr/local/nginx/conf/nginx.conf syntax is ok
nginx: configuration <span>file</span> /usr/local/nginx/conf/nginx.conf <span>test</span> is successful
<span>[</span>roo@fxkj ~<span>]</span><span># /usr/local/nginx/sbin/nginx -s reload</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p><strong>7、模拟测试验证</strong></p>
<p><strong>使用海外节点的服务器去访问网站</strong></p>
<p>这里我的IP 是 来自于韩国</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/fca231769f3c40458a321bdca7c356f1.png" alt="通过Nginx来实现禁止国外IP访问网站" loading="lazy"></p>
<p>可以看到访问网站报错 404 Not Found</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/ac732b838fd84cf9a1ba52a27c13d76d.png" alt="通过Nginx来实现禁止国外IP访问网站" loading="lazy"></p>
<p>我们再来看下nginx 的访问日志</p>
<div><pre><code><span>"13.125.1.194 - - [14/Aug/2020:16:15:51 +0800] "</span>GET /favicon.ico HTTP/1.1<span>" **404** 548 "</span>https://www.fxkjnj.com/<span>" "</span>Mozilla/5.0 <span>(</span>Windows NT <span>10.0</span><span>;</span> Win64<span>;</span> x64<span>)</span> AppleWebKit/537.36 <span>(</span>KHTML, like Gecko<span>)</span> Chrome/84.0.4147.125 Safari/537.36"
</code></pre><div aria-hidden="true"><div></div></div></div><p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/e74537e1a7b4476098d4e68a38203704.png" alt="通过Nginx来实现禁止国外IP访问网站" loading="lazy"></p>
<p>到此 我们通过Nginx来实现禁止国外IP访问网站 就结束了</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-19T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">一个减少MIUI动画掉帧的方法</title>
    <id>https://blog.ciberviler.top/daily/%E4%B8%80%E4%B8%AA%E5%87%8F%E5%B0%91MIUI%E5%8A%A8%E7%94%BB%E6%8E%89%E5%B8%A7%E7%9A%84%E6%96%B9%E6%B3%95.html</id>
    <link href="https://blog.ciberviler.top/daily/%E4%B8%80%E4%B8%AA%E5%87%8F%E5%B0%91MIUI%E5%8A%A8%E7%94%BB%E6%8E%89%E5%B8%A7%E7%9A%84%E6%96%B9%E6%B3%95.html"/>
    <updated>2022-06-03T02:53:04.000Z</updated>
    <content type="html"><![CDATA[<h1 id="一个减少miui动画掉帧的方法" tabindex="-1"> 一个减少MIUI动画掉帧的方法</h1>
<p>分享一个减少MIUI12动画掉帧的方法。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16542238760163.jpeg" alt="图片" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16542238760162.jpeg" alt="图片" loading="lazy"></p>
<p>应用管理找到系统跟踪清除数据
然后进入开发者选项中的系统跟踪选择关闭跟踪可调试应用
（没有停用hw叠加层，动画也更流畅了）</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="daily" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-18T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">SpringCloud Gateway API接口安全设计（加密 、签名）</title>
    <id>https://blog.ciberviler.top/dev/SpringCloudGatewayAPI%E6%8E%A5%E5%8F%A3%E5%AE%89%E5%85%A8%E8%AE%BE%E8%AE%A1.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringCloudGatewayAPI%E6%8E%A5%E5%8F%A3%E5%AE%89%E5%85%A8%E8%AE%BE%E8%AE%A1.html"/>
    <updated>2022-06-03T02:45:44.000Z</updated>
    <content type="html"><![CDATA[<h1 id="springcloud-gateway-api接口安全设计-加密-、签名" tabindex="-1"> SpringCloud Gateway API接口安全设计（加密 、签名）</h1>
<h1 id="_1-防止数据抓包窃取" tabindex="-1"> 1 防止数据抓包窃取</h1>
<h2 id="_1-1-风险简述" tabindex="-1"> 1.1 风险简述</h2>
<p>简述：当用户登录时，恶意攻击者可以用[抓包工具]可以拿到用户提交的表单信息，可以获取用户的账号密码，进而可以恶意访问网站。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1a25b48aa07f4da7adeed28003850f74.png" alt="图片" loading="lazy"></p>
<h2 id="_1-2-rsa-非对称加密" tabindex="-1"> 1.2 [RSA] 非对称加密</h2>
<h3 id="_1-2-1-rsa简介" tabindex="-1"> 1.2.1 RSA简介</h3>
<p>RSA[加密算法]是一种非对称加密算法。在公开密钥加密和电子商业中RSA被广泛使用。RSA是1977年由罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman）一起提出的。当时他们三人都在麻省理工学院工作。RSA就是他们三人姓氏开头字母拼在一起组成的。</p>
<p>1973年，在英国政府通讯总部工作的数学家克利福德·柯克斯（Clifford Cocks）在一个内部文件中提出了一个相同的算法，但他的发现被列入机密，一直到1997年才被发表。对极大整数做因数分解的难度决定了RSA算法的可靠性。换言之，对一极大整数做因数分解愈困难，RSA算法愈可靠。假如有人找到一种快速因数分解的算法的话，那么用RSA[加密]的信息的可靠性就肯定会极度下降。但找到这样的算法的可能性是非常小的。今天只有短的RSA钥匙才可能被强力方式解破。到目前为止，世界上还没有任何可靠的攻击RSA算法的方式。只要其钥匙的长度足够长，用RSA加密的信息实际上是不能被解破的。</p>
<p>1983年麻省理工学院在美国为RSA算法申请了专利。这个专利2000年9月21日失效。由于该算法在申请专利前就已经被发表了，在世界上大多数其它地区这个专利权不被承认。</p>
<h3 id="_1-2-2-rsa应用过程" tabindex="-1"> 1.2.2 RSA应用过程</h3>
<p>非对称算法的在应用的过程如下:
(1) 接收方生成公钥和私钥，公钥公开，私钥保留；
(2) 发送方将要发送的消息采用公钥加密，得到密文，然后将密文发送给接收方；
(3) 接收方收到密文后，用自己的私钥进行解密，获得明文。</p>
<h3 id="_1-2-3-rsa工具类" tabindex="-1"> 1.2.3 RSA工具类</h3>
<div><pre><code><span>package</span> <span>com<span>.</span>demo<span>.</span>utils</span><span>;</span>

<span>import</span> <span><span>com<span>.</span>demo<span>.</span>excepiton<span>.</span></span><span>RsaException</span></span><span>;</span>
<span>import</span> <span><span>lombok<span>.</span>extern<span>.</span>slf4j<span>.</span></span><span>Slf4j</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>apache<span>.</span>commons<span>.</span>codec<span>.</span>binary<span>.</span></span><span>Base64</span></span><span>;</span>

<span>import</span> <span><span>javax<span>.</span>crypto<span>.</span></span><span>Cipher</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>nio<span>.</span>charset<span>.</span></span><span>StandardCharsets</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>security<span>.</span></span><span>KeyFactory</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>security<span>.</span></span><span>KeyPair</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>security<span>.</span></span><span>KeyPairGenerator</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>security<span>.</span></span><span>SecureRandom</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>security<span>.</span>interfaces<span>.</span></span><span>RSAPrivateKey</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>security<span>.</span>interfaces<span>.</span></span><span>RSAPublicKey</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>security<span>.</span>spec<span>.</span></span><span>PKCS8EncodedKeySpec</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>security<span>.</span>spec<span>.</span></span><span>X509EncodedKeySpec</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>HashMap</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Map</span></span><span>;</span>

<span>@Slf4j</span>
<span>public</span> <span>class</span> <span>RSAUtils</span> <span>{</span>

    <span>public</span> <span>static</span> <span>final</span> <span>String</span> PUBLIC_KEY <span>=</span> <span>"public_key"</span><span>;</span>

    <span>public</span> <span>static</span> <span>final</span> <span>String</span> PRIVATE_KEY <span>=</span> <span>"private_key"</span><span>;</span>


    <span>public</span> <span>static</span> <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>String</span><span>></span></span> <span>generateRasKey</span><span>(</span><span>)</span> <span>{</span>
        <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>String</span><span>></span></span> rs <span>=</span> <span>new</span> <span>HashMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
        <span>try</span> <span>{</span>
            <span>// KeyPairGenerator类用于生成公钥和私钥对，基于RSA算法生成对象</span>
            <span>KeyPairGenerator</span> keyPairGen <span>=</span> <span>null</span><span>;</span>
            keyPairGen <span>=</span> <span>KeyPairGenerator</span><span>.</span><span>getInstance</span><span>(</span><span>"RSA"</span><span>)</span><span>;</span>
            keyPairGen<span>.</span><span>initialize</span><span>(</span><span>1024</span><span>,</span> <span>new</span> <span>SecureRandom</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>// 生成一个密钥对，保存在keyPair中</span>
            <span>KeyPair</span> keyPair <span>=</span> keyPairGen<span>.</span><span>generateKeyPair</span><span>(</span><span>)</span><span>;</span>
            <span>// 得到私钥 公钥</span>
            <span>RSAPrivateKey</span> privateKey <span>=</span> <span>(</span><span>RSAPrivateKey</span><span>)</span> keyPair<span>.</span><span>getPrivate</span><span>(</span><span>)</span><span>;</span>
            <span>RSAPublicKey</span> publicKey <span>=</span> <span>(</span><span>RSAPublicKey</span><span>)</span> keyPair<span>.</span><span>getPublic</span><span>(</span><span>)</span><span>;</span>
            <span>String</span> publicKeyString <span>=</span> <span>new</span> <span>String</span><span>(</span><span>Base64</span><span>.</span><span>encodeBase64</span><span>(</span>publicKey<span>.</span><span>getEncoded</span><span>(</span><span>)</span><span>)</span><span>)</span><span>;</span>
            <span>// 得到私钥字符串</span>
            <span>String</span> privateKeyString <span>=</span> <span>new</span> <span>String</span><span>(</span><span>Base64</span><span>.</span><span>encodeBase64</span><span>(</span><span>(</span>privateKey<span>.</span><span>getEncoded</span><span>(</span><span>)</span><span>)</span><span>)</span><span>)</span><span>;</span>
            <span>// 将公钥和私钥保存到Map</span>
            rs<span>.</span><span>put</span><span>(</span>PUBLIC_KEY<span>,</span> publicKeyString<span>)</span><span>;</span>
            rs<span>.</span><span>put</span><span>(</span>PRIVATE_KEY<span>,</span> privateKeyString<span>)</span><span>;</span>
        <span>}</span> <span>catch</span> <span>(</span><span>Exception</span> e<span>)</span> <span>{</span>
            log<span>.</span><span>error</span><span>(</span><span>"RsaUtils invoke genKeyPair failed."</span><span>,</span> e<span>)</span><span>;</span>
            <span>throw</span> <span>new</span> <span>RsaException</span><span>(</span><span>"RsaUtils invoke genKeyPair failed."</span><span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> rs<span>;</span>
    <span>}</span>


    <span>public</span> <span>static</span> <span>String</span> <span>encrypt</span><span>(</span><span>String</span> str<span>,</span> <span>String</span> publicKey<span>)</span> <span>{</span>
        <span>try</span> <span>{</span>
            <span>//base64编码的公钥</span>
            <span>byte</span><span>[</span><span>]</span> decoded <span>=</span> <span>Base64</span><span>.</span><span>decodeBase64</span><span>(</span>publicKey<span>)</span><span>;</span>
            <span>RSAPublicKey</span> pubKey <span>=</span> <span>(</span><span>RSAPublicKey</span><span>)</span> <span>KeyFactory</span><span>.</span><span>getInstance</span><span>(</span><span>"RSA"</span><span>)</span><span>.</span><span>generatePublic</span><span>(</span><span>new</span> <span>X509EncodedKeySpec</span><span>(</span>decoded<span>)</span><span>)</span><span>;</span>
            <span>//RSA加密</span>
            <span>Cipher</span> cipher <span>=</span> <span>Cipher</span><span>.</span><span>getInstance</span><span>(</span><span>"RSA"</span><span>)</span><span>;</span>
            cipher<span>.</span><span>init</span><span>(</span><span>Cipher</span><span>.</span>ENCRYPT_MODE<span>,</span> pubKey<span>)</span><span>;</span>
            <span>return</span> <span>Base64</span><span>.</span><span>encodeBase64String</span><span>(</span>cipher<span>.</span><span>doFinal</span><span>(</span>str<span>.</span><span>getBytes</span><span>(</span><span>StandardCharsets</span><span>.</span>UTF_8<span>)</span><span>)</span><span>)</span><span>;</span>
        <span>}</span> <span>catch</span> <span>(</span><span>Exception</span> e<span>)</span> <span>{</span>
            log<span>.</span><span>error</span><span>(</span><span>"RsaUtils invoke encrypt failed."</span><span>,</span> e<span>)</span><span>;</span>
            <span>throw</span> <span>new</span> <span>RsaException</span><span>(</span><span>"RsaUtils invoke encrypt failed."</span><span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>


    <span>public</span> <span>static</span> <span>String</span> <span>decrypt</span><span>(</span><span>String</span> str<span>,</span> <span>String</span> privateKey<span>)</span> <span>{</span>

        <span>try</span> <span>{</span>
            <span>//64位解码加密后的字符串</span>
            <span>byte</span><span>[</span><span>]</span> inputByte <span>=</span> <span>Base64</span><span>.</span><span>decodeBase64</span><span>(</span>str<span>.</span><span>getBytes</span><span>(</span><span>StandardCharsets</span><span>.</span>UTF_8<span>)</span><span>)</span><span>;</span>
            <span>//base64编码的私钥</span>
            <span>byte</span><span>[</span><span>]</span> decoded <span>=</span> <span>Base64</span><span>.</span><span>decodeBase64</span><span>(</span>privateKey<span>)</span><span>;</span>
            <span>RSAPrivateKey</span> priKey <span>=</span> <span>(</span><span>RSAPrivateKey</span><span>)</span> <span>KeyFactory</span><span>.</span><span>getInstance</span><span>(</span><span>"RSA"</span><span>)</span><span>.</span><span>generatePrivate</span><span>(</span><span>new</span> <span>PKCS8EncodedKeySpec</span><span>(</span>decoded<span>)</span><span>)</span><span>;</span>
            <span>//RSA解密</span>
            <span>Cipher</span> cipher <span>=</span> <span>Cipher</span><span>.</span><span>getInstance</span><span>(</span><span>"RSA"</span><span>)</span><span>;</span>
            cipher<span>.</span><span>init</span><span>(</span><span>Cipher</span><span>.</span>DECRYPT_MODE<span>,</span> priKey<span>)</span><span>;</span>
            <span>return</span> <span>new</span> <span>String</span><span>(</span>cipher<span>.</span><span>doFinal</span><span>(</span>inputByte<span>)</span><span>)</span><span>;</span>
        <span>}</span> <span>catch</span> <span>(</span><span>Exception</span> e<span>)</span> <span>{</span>
            log<span>.</span><span>error</span><span>(</span><span>"RsaUtils invoke decrypt failed."</span><span>,</span> e<span>)</span><span>;</span>
            <span>throw</span> <span>new</span> <span>RsaException</span><span>(</span><span>"RsaUtils invoke decrypt failed."</span><span>)</span><span>;</span>
        <span>}</span>

    <span>}</span>

<span>}</span>


</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>RsaException:</strong> 是自定义异常</p>
<div><pre><code><span>@Getter</span>
<span>public</span> <span>class</span> <span>RsaException</span> <span>extends</span> <span>RuntimeException</span> <span>{</span>

    <span>private</span> <span>final</span> <span>String</span> message<span>;</span>

    <span>public</span> <span>RsaException</span><span>(</span><span>String</span> message<span>)</span> <span>{</span>
        <span>this</span><span>.</span>message <span>=</span> message<span>;</span>
    <span>}</span>

<span>}</span>

</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-2-4-ut" tabindex="-1"> 1.2.4 UT</h3>
<div><pre><code><span>package</span> <span>com<span>.</span>rosh</span><span>;</span>


<span>import</span> <span><span>com<span>.</span>alibaba<span>.</span>fastjson<span>.</span></span><span>JSONObject</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>utils<span>.</span></span><span>RSAUtils</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>junit<span>.</span></span><span>Test</span></span><span>;</span>

<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Map</span></span><span>;</span>


<span>/**
 * @Description:
 * @Author: rosh
 * @Date: 2021/10/25 22:30
 */</span>
<span>public</span> <span>class</span> <span>RsaTest</span> <span>{</span>

    <span>/**
     *  用测试生成的公钥，私钥赋值
     */</span>
    <span>private</span> <span>static</span> <span>final</span> <span>String</span> PUBLIC_KEY <span>=</span> <span>"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCFtTlL61IqIGd+fRLUhJ0MjsqFXFJswCohJ45m51WvbxDPRP3gllW0WChk74D5JEOpMDSWo4C7RfoGlBRNW7kQ6qYGukYZ5jgYpzoT0+gp3on96fQXEyQJysv9xiTPIdmSXXVVj1HAOJw29RbzxIVKUSzzPXvEtXRTtCC1+wkAJQIDAQAB"</span><span>;</span>

    <span>private</span> <span>static</span> <span>final</span> <span>String</span> PRIVATE_KEY <span>=</span> <span>"MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBAIW1OUvrUiogZ359EtSEnQyOyoVcUmzAKiEnjmbnVa9vEM9E/eCWVbRYKGTvgPkkQ6kwNJajgLtF+gaUFE1buRDqpga6RhnmOBinOhPT6Cneif3p9BcTJAnKy/3GJM8h2ZJddVWPUcA4nDb1FvPEhUpRLPM9e8S1dFO0ILX7CQAlAgMBAAECgYBC4amtbiKFa/wY61tV7pfYRjzLhKi+OUlZmD3E/4Z+4KGZ7DrJ8qkgMtDR3HO5LAikQrare1HTW2d7juqw32ascu+uDObf4yrYNKin+ZDLUYvIDfLhThPxnZJwQ/trdtfxO3VM//XbwZacmwYbAsYW/3QPUXwwOPAgbC2oth8kqQJBANKLyXcdjZx4cwJVl7xNeC847su8y6bPpcBASsaQloCIPiNBIg1h76dpfEGIQBYWJWbBsxtHe/MhOmz7fNFDS2sCQQCiktYZR0dZNH4eNX329LoRuBiltpr9tf36rVOlKr1GSHkLYEHF2qtyXV2mdrY8ZWpvuo3qm1oSLaqmop2rN9avAkBHk85B+IIUF77BpGeZVJzvMOO9z8lMRHuNCE5jgvQnbinxwkrZUdovh+T+QlvHJnBApslFFOBGn51FP5oHamFRAkEAmwZmPsinkrrpoKjlqz6GyCrC5hKRDWoj/IyXfKKaxpCJTH3HeoIghvfdO8Vr1X/n1Q8SESt+4mLFngznSMQAZQJBAJx07bCFYbA2IocfFV5LTEYTIiUeKdue2NP2yWqZ/+tB5H7jNwQTJmX1mn0W/sZm4+nJM7SjfETpNZhH49+rV6U="</span><span>;</span>


    <span>/**
     *  生成公钥私钥
     */</span>
    <span>@Test</span>
    <span>public</span> <span>void</span> <span>generateRsaKey</span><span>(</span><span>)</span> <span>{</span>
        <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>String</span><span>></span></span> map <span>=</span> <span>RSAUtils</span><span>.</span><span>generateRasKey</span><span>(</span><span>)</span><span>;</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"随机生成的公钥为:"</span> <span>+</span> map<span>.</span><span>get</span><span>(</span><span>RSAUtils</span><span>.</span>PUBLIC_KEY<span>)</span><span>)</span><span>;</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"随机生成的私钥为:"</span> <span>+</span> map<span>.</span><span>get</span><span>(</span><span>RSAUtils</span><span>.</span>PRIVATE_KEY<span>)</span><span>)</span><span>;</span>

    <span>}</span>

    <span>/**
     * 加密: Yeidauky/iN1/whevov2+ntzXJKAp2AHfESu5ixnDqH5iB7ww+TcfqJpDfkPHfb12Y0sVXw0gBHNJ4inkh7l2/SJBze3pKQU/mg3oyDokTia3JZIs+e80/iJcSfN+yA1JaqY+eJPYiBiOGAF2S6x0ynvJg/Wj0fwp2Tq3PDzRMo=
     */</span>
    <span>@Test</span>
    <span>public</span> <span>void</span> <span>testEncrypt</span><span>(</span><span>)</span> <span>{</span>
        <span>JSONObject</span> jsonObject <span>=</span> <span>new</span> <span>JSONObject</span><span>(</span><span>)</span><span>;</span>
        jsonObject<span>.</span><span>put</span><span>(</span><span>"username"</span><span>,</span> <span>"rosh"</span><span>)</span><span>;</span>
        jsonObject<span>.</span><span>put</span><span>(</span><span>"password"</span><span>,</span> <span>"123456"</span><span>)</span><span>;</span>
        <span>String</span> str <span>=</span> jsonObject<span>.</span><span>toJSONString</span><span>(</span><span>)</span><span>;</span>
        <span>String</span> encrypt <span>=</span> <span>RSAUtils</span><span>.</span><span>encrypt</span><span>(</span>str<span>,</span> PUBLIC_KEY<span>)</span><span>;</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>encrypt<span>)</span><span>;</span>
    <span>}</span>

    <span>@Test</span>
    <span>public</span> <span>void</span> <span>testDecrypt</span><span>(</span><span>)</span> <span>{</span>

        <span>String</span> decrypt <span>=</span> <span>RSAUtils</span><span>.</span><span>decrypt</span><span>(</span><span>"Yeidauky/iN1/whevov2+ntzXJKAp2AHfESu5ixnDqH5iB7ww+TcfqJpDfkPHfb12Y0sVXw0gBHNJ4inkh7l2/SJBze3pKQU/mg3oyDokTia3JZIs+e80/iJcSfN+yA1JaqY+eJPYiBiOGAF2S6x0ynvJg/Wj0fwp2Tq3PDzRMo="</span><span>,</span>
                PRIVATE_KEY<span>)</span><span>;</span>

        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>decrypt<span>)</span><span>;</span>
    <span>}</span>


<span>}</span>


</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/d7432b5d395347cc8f3b204a099006d0.png" alt="图片" loading="lazy"></p>
<h2 id="_1-3-案例" tabindex="-1"> 1.3 案例</h2>
<p>SpringCloud Gateway + SpringBoot + Nacos+redis
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/954f481924b640e885c315ac9f33b60e.png" alt="图片" loading="lazy">
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1f7df432d04e4ecebf95161316c4eb8c.png" alt="图片" loading="lazy"></p>
<h3 id="_1-3-1-前端登录代码" tabindex="-1"> 1.3.1 前端登录代码</h3>
<p><strong>后端把公钥跟前端约定好：</strong></p>
<div><pre><code><span><span>&lt;!</span><span>DOCTYPE</span> <span>html</span><span>></span></span>
<span><span><span>&lt;</span>html</span> <span>lang</span><span><span>=</span><span>"</span>en<span>"</span></span><span>></span></span>
<span><span><span>&lt;</span>head</span><span>></span></span>
    <span><span><span>&lt;</span>meta</span> <span>charset</span><span><span>=</span><span>"</span>UTF-8<span>"</span></span><span>></span></span>
    <span><span><span>&lt;</span>title</span><span>></span></span>登录页面<span><span><span>&lt;/</span>title</span><span>></span></span>

<span><span><span>&lt;/</span>head</span><span>></span></span>
<span><span><span>&lt;</span>body</span><span>></span></span>

<span><span><span>&lt;</span>h1</span><span>></span></span>登录<span><span><span>&lt;/</span>h1</span><span>></span></span>


<span><span><span>&lt;</span>from</span> <span>id</span><span><span>=</span><span>"</span>from<span>"</span></span><span>></span></span>
    账号：<span><span><span>&lt;</span>input</span> <span>id</span><span><span>=</span><span>"</span>username<span>"</span></span> <span>type</span><span><span>=</span><span>"</span>text<span>"</span></span><span>/></span></span>
    <span><span><span>&lt;</span>br</span><span>/></span></span>
    密码：<span><span><span>&lt;</span>input</span> <span>id</span><span><span>=</span><span>"</span>password<span>"</span></span> <span>type</span><span><span>=</span><span>"</span>password<span>"</span></span><span>/></span></span>
    <span><span><span>&lt;</span>br</span><span>/></span></span>
    <span><span><span>&lt;</span>input</span> <span>id</span><span><span>=</span><span>"</span>btn_login<span>"</span></span> <span>type</span><span><span>=</span><span>"</span>button<span>"</span></span> <span>value</span><span><span>=</span><span>"</span>登录<span>"</span></span><span>/></span></span>
<span><span><span>&lt;/</span>from</span><span>></span></span>



<span><span><span>&lt;</span>script</span> <span>src</span><span><span>=</span><span>"</span>js/jquery.min.js<span>"</span></span><span>></span></span><span></span><span><span><span>&lt;/</span>script</span><span>></span></span>
<span><span><span>&lt;</span>script</span> <span>src</span><span><span>=</span><span>"</span>js/jsencrypt.js<span>"</span></span><span>></span></span><span></span><span><span><span>&lt;/</span>script</span><span>></span></span>


<span><span><span>&lt;</span>script</span> <span>type</span><span><span>=</span><span>"</span>text/javascript<span>"</span></span><span>></span></span><span><span>
    <span>var</span> encrypt <span>=</span> <span>new</span> <span>JSEncrypt</span><span>(</span><span>)</span><span>;</span>
    encrypt<span>.</span><span>setPublicKey</span><span>(</span><span>"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCFtTlL61IqIGd+fRLUhJ0MjsqFXFJswCohJ45m51WvbxDPRP3gllW0WChk74D5JEOpMDSWo4C7RfoGlBRNW7kQ6qYGukYZ5jgYpzoT0+gp3on96fQXEyQJysv9xiTPIdmSXXVVj1HAOJw29RbzxIVKUSzzPXvEtXRTtCC1+wkAJQIDAQAB"</span><span>)</span><span>;</span>
    <span>$</span><span>(</span><span>"#btn_login"</span><span>)</span><span>.</span><span>click</span><span>(</span><span>function</span> <span>(</span><span>)</span> <span>{</span>
        <span>const</span> username <span>=</span> <span>$</span><span>(</span><span>"#username"</span><span>)</span><span>.</span><span>val</span><span>(</span><span>)</span><span>;</span>
        <span>const</span> password <span>=</span> <span>$</span><span>(</span><span>"#password"</span><span>)</span><span>.</span><span>val</span><span>(</span><span>)</span><span>;</span>
        <span>const</span> form <span>=</span> <span>{</span><span>}</span><span>;</span>
        form<span>.</span>username <span>=</span> username<span>;</span>
        form<span>.</span>password <span>=</span> password<span>;</span>
        $<span>.</span><span>ajax</span><span>(</span><span>{</span>
            <span>url</span><span>:</span> <span>"http://localhost:9000/api/user/login"</span><span>,</span>
            <span>data</span><span>:</span> encrypt<span>.</span><span>encrypt</span><span>(</span><span>JSON</span><span>.</span><span>stringify</span><span>(</span>form<span>)</span><span>)</span><span>,</span>
            <span>type</span><span>:</span> <span>"POST"</span><span>,</span>
            <span>dataType</span><span>:</span> <span>"json"</span><span>,</span>
            <span>contentType</span><span>:</span> <span>"application/json;charset=utf-8"</span><span>,</span>
            <span>success</span><span>:</span> <span>function</span> <span>(</span><span>data</span><span>)</span> <span>{</span>
                console<span>.</span><span>log</span><span>(</span>data<span>)</span><span>;</span>
            <span>}</span>
        <span>}</span><span>)</span><span>;</span>
    <span>}</span><span>)</span>
</span></span><span><span><span>&lt;/</span>script</span><span>></span></span>


<span><span><span>&lt;/</span>body</span><span>></span></span>
<span><span><span>&lt;/</span>html</span><span>></span></span>

</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-3-2-前端查询代码" tabindex="-1"> 1.3.2 前端查询代码</h3>
<p><strong>设定公钥、token，token是登录成功后返回的值</strong></p>
<div><pre><code><span><span>&lt;!</span><span>DOCTYPE</span> <span>html</span><span>></span></span>
<span><span><span>&lt;</span>html</span> <span>lang</span><span><span>=</span><span>"</span>en<span>"</span></span><span>></span></span>
<span><span><span>&lt;</span>head</span><span>></span></span>
    <span><span><span>&lt;</span>meta</span> <span>charset</span><span><span>=</span><span>"</span>UTF-8<span>"</span></span><span>></span></span>
    <span><span><span>&lt;</span>title</span><span>></span></span>查询测试<span><span><span>&lt;/</span>title</span><span>></span></span>
<span><span><span>&lt;/</span>head</span><span>></span></span>
<span><span><span>&lt;</span>body</span><span>></span></span>


id：<span><span><span>&lt;</span>input</span> <span>id</span><span><span>=</span><span>"</span>id_txt<span>"</span></span> <span>type</span><span><span>=</span><span>"</span>text<span>"</span></span><span>/></span></span>
<span><span><span>&lt;</span>input</span> <span>id</span><span><span>=</span><span>"</span>btn_search<span>"</span></span> <span>type</span><span><span>=</span><span>"</span>button<span>"</span></span> <span>value</span><span><span>=</span><span>"</span>查询<span>"</span></span><span>/></span></span>


<span><span><span>&lt;</span>script</span> <span>src</span><span><span>=</span><span>"</span>js/jquery.min.js<span>"</span></span><span>></span></span><span></span><span><span><span>&lt;/</span>script</span><span>></span></span>
<span><span><span>&lt;</span>script</span> <span>src</span><span><span>=</span><span>"</span>js/jsencrypt.js<span>"</span></span><span>></span></span><span></span><span><span><span>&lt;/</span>script</span><span>></span></span>
<span><span><span>&lt;</span>script</span> <span>type</span><span><span>=</span><span>"</span>text/javascript<span>"</span></span><span>></span></span><span><span>
    <span>var</span> encrypt <span>=</span> <span>new</span> <span>JSEncrypt</span><span>(</span><span>)</span><span>;</span>
    encrypt<span>.</span><span>setPublicKey</span><span>(</span><span>"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCFtTlL61IqIGd+fRLUhJ0MjsqFXFJswCohJ45m51WvbxDPRP3gllW0WChk74D5JEOpMDSWo4C7RfoGlBRNW7kQ6qYGukYZ5jgYpzoT0+gp3on96fQXEyQJysv9xiTPIdmSXXVVj1HAOJw29RbzxIVKUSzzPXvEtXRTtCC1+wkAJQIDAQAB"</span><span>)</span><span>;</span>

    <span>$</span><span>(</span><span>"#btn_search"</span><span>)</span><span>.</span><span>click</span><span>(</span><span>function</span> <span>(</span><span>)</span> <span>{</span>
        <span>const</span> id <span>=</span> <span>$</span><span>(</span><span>"#id_txt"</span><span>)</span><span>.</span><span>val</span><span>(</span><span>)</span><span>;</span>
        <span>const</span> param <span>=</span> <span>"id="</span> <span>+</span> id <span>+</span> <span>"&amp;requestId="</span> <span>+</span> <span>getUuid</span><span>(</span><span>)</span><span>;</span>
        encrypt<span>.</span><span>encrypt</span><span>(</span>param<span>)</span><span>;</span>
        <span>const</span> url <span>=</span> <span>"http://localhost:9000/api/user/detail?param="</span> <span>+</span> encrypt<span>.</span><span>encrypt</span><span>(</span>param<span>)</span><span>;</span>
        $<span>.</span><span>ajax</span><span>(</span><span>{</span>
            <span>url</span><span>:</span> url<span>,</span>
            <span>beforeSend</span><span>:</span> <span>function</span> <span>(</span><span>XMLHttpRequest</span><span>)</span> <span>{</span>
                XMLHttpRequest<span>.</span><span>setRequestHeader</span><span>(</span><span>"token"</span><span>,</span> <span>"eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiIzYzE1ODczYS1iMGUxLTQyNzctYTRjOS1kYTMwNjdiYmE0NWIiLCJpYXQiOjE2MzUzMDYwMDAsInN1YiI6IntcInBhc3N3b3JkXCI6XCIxMjM0NTZcIixcInVzZXJJZFwiOjEsXCJ1c2VybmFtZVwiOlwiYWRtaW5cIn0iLCJleHAiOjE2MzU1NjUyMDB9.fIQi_cV2ZMszBVFV4GoIpGhCSENQKrDi8DsbArk7mGk"</span><span>)</span><span>;</span>
            <span>}</span><span>,</span>
            <span>type</span><span>:</span> <span>"GET"</span><span>,</span>
            <span>success</span><span>:</span> <span>function</span> <span>(</span><span>data</span><span>)</span> <span>{</span>
                console<span>.</span><span>log</span><span>(</span>data<span>)</span><span>;</span>
            <span>}</span>
        <span>}</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>


    <span>function</span> <span>getUuid</span><span>(</span><span>)</span> <span>{</span>
        <span>var</span> s <span>=</span> <span>[</span><span>]</span><span>;</span>
        <span>var</span> hexDigits <span>=</span> <span>"0123456789abcdef"</span><span>;</span>
        <span>for</span> <span>(</span><span>var</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> <span>32</span><span>;</span> i<span>++</span><span>)</span> <span>{</span>
            s<span>[</span>i<span>]</span> <span>=</span> hexDigits<span>.</span><span>substr</span><span>(</span>Math<span>.</span><span>floor</span><span>(</span>Math<span>.</span><span>random</span><span>(</span><span>)</span> <span>*</span> <span>0x10</span><span>)</span><span>,</span> <span>1</span><span>)</span><span>;</span>
        <span>}</span>
        s<span>[</span><span>14</span><span>]</span> <span>=</span> <span>"4"</span><span>;</span> <span>// bits 12-15 of the time_hi_and_version field to 0010</span>
        s<span>[</span><span>19</span><span>]</span> <span>=</span> hexDigits<span>.</span><span>substr</span><span>(</span><span>(</span>s<span>[</span><span>19</span><span>]</span> <span>&amp;</span> <span>0x3</span><span>)</span> <span>|</span> <span>0x8</span><span>,</span> <span>1</span><span>)</span><span>;</span> <span>// bits 6-7 of the clock_seq_hi_and_reserved to 01</span>
        s<span>[</span><span>8</span><span>]</span> <span>=</span> s<span>[</span><span>13</span><span>]</span> <span>=</span> s<span>[</span><span>18</span><span>]</span> <span>=</span> s<span>[</span><span>23</span><span>]</span><span>;</span>
        <span>var</span> uuid <span>=</span> s<span>.</span><span>join</span><span>(</span><span>""</span><span>)</span><span>;</span>
        <span>return</span> uuid<span>;</span>
    <span>}</span>

</span></span><span><span><span>&lt;/</span>script</span><span>></span></span>


<span><span><span>&lt;/</span>body</span><span>></span></span>
<span><span><span>&lt;/</span>html</span><span>></span></span>

</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-3-3-gatewayfilterconfig" tabindex="-1"> 1.3.3 GatewayFilterConfig</h3>
<p><strong>解密前端传来的参数并修改传参</strong></p>
<div><pre><code><span>package</span> <span>com<span>.</span>demo<span>.</span>gateway<span>.</span>config</span><span>;</span>

<span>import</span> <span><span>com<span>.</span>demo<span>.</span>constant<span>.</span></span><span>UserConstant</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>excepiton<span>.</span></span><span>RSAException</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>utils<span>.</span></span><span>RSAUtils</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>utils<span>.</span></span><span>TokenUtils</span></span><span>;</span>
<span>import</span> <span><span>io<span>.</span>jsonwebtoken<span>.</span></span><span>Claims</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>apache<span>.</span>commons<span>.</span>lang3<span>.</span></span><span>StringUtils</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>cloud<span>.</span>gateway<span>.</span>filter<span>.</span></span><span>GatewayFilterChain</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>cloud<span>.</span>gateway<span>.</span>filter<span>.</span></span><span>GlobalFilter</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>cloud<span>.</span>gateway<span>.</span>filter<span>.</span>factory<span>.</span>rewrite<span>.</span></span><span>CachedBodyOutputMessage</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>cloud<span>.</span>gateway<span>.</span>support<span>.</span></span><span>BodyInserterContext</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>context<span>.</span>annotation<span>.</span></span><span>Configuration</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>core<span>.</span></span><span>Ordered</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>core<span>.</span>io<span>.</span>buffer<span>.</span></span><span>DataBuffer</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>http<span>.</span></span><span>HttpHeaders</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>http<span>.</span></span><span>ReactiveHttpOutputMessage</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>http<span>.</span>server<span>.</span>reactive<span>.</span></span><span>ServerHttpRequest</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>http<span>.</span>server<span>.</span>reactive<span>.</span></span><span>ServerHttpRequestDecorator</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>stereotype<span>.</span></span><span>Component</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>util<span>.</span></span><span>AntPathMatcher</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>reactive<span>.</span>function<span>.</span></span><span>BodyInserter</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>reactive<span>.</span>function<span>.</span></span><span>BodyInserters</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>reactive<span>.</span>function<span>.</span>server<span>.</span></span><span>HandlerStrategies</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>reactive<span>.</span>function<span>.</span>server<span>.</span></span><span>ServerRequest</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>server<span>.</span></span><span>ServerWebExchange</span></span><span>;</span>
<span>import</span> <span><span>reactor<span>.</span>core<span>.</span>publisher<span>.</span></span><span>Flux</span></span><span>;</span>
<span>import</span> <span><span>reactor<span>.</span>core<span>.</span>publisher<span>.</span></span><span>Mono</span></span><span>;</span>

<span>import</span> <span><span>java<span>.</span>lang<span>.</span>reflect<span>.</span></span><span>Field</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>net<span>.</span></span><span>URI</span></span><span>;</span>


<span>/**
 * @Description:
 * @Author: rosh
 * @Date: 2021/10/26 22:24
 */</span>
<span>@Configuration</span>
<span>@Component</span>
<span>public</span> <span>class</span> <span>GatewayFilterConfig</span> <span>implements</span> <span>GlobalFilter</span><span>,</span> <span>Ordered</span> <span>{</span>


    <span>@Override</span>
    <span>public</span> <span>Mono</span><span><span>&lt;</span><span>Void</span><span>></span></span> <span>filter</span><span>(</span><span>ServerWebExchange</span> exchange<span>,</span> <span>GatewayFilterChain</span> chain<span>)</span> <span>{</span>
        <span>//1 如果是登录不校验Token</span>
        <span>String</span> requestUrl <span>=</span> exchange<span>.</span><span>getRequest</span><span>(</span><span>)</span><span>.</span><span>getPath</span><span>(</span><span>)</span><span>.</span><span>value</span><span>(</span><span>)</span><span>;</span>
        <span>AntPathMatcher</span> pathMatcher <span>=</span> <span>new</span> <span>AntPathMatcher</span><span>(</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span><span>!</span>pathMatcher<span>.</span><span>match</span><span>(</span><span>"/user/login"</span><span>,</span> requestUrl<span>)</span><span>)</span> <span>{</span>
            <span>String</span> token <span>=</span> exchange<span>.</span><span>getRequest</span><span>(</span><span>)</span><span>.</span><span>getHeaders</span><span>(</span><span>)</span><span>.</span><span>getFirst</span><span>(</span><span>UserConstant</span><span>.</span>TOKEN<span>)</span><span>;</span>
            <span>Claims</span> claim <span>=</span> <span>TokenUtils</span><span>.</span><span>getClaim</span><span>(</span>token<span>)</span><span>;</span>
            <span>if</span> <span>(</span><span>StringUtils</span><span>.</span><span>isBlank</span><span>(</span>token<span>)</span> <span>||</span> claim <span>==</span> <span>null</span><span>)</span> <span>{</span>
                <span>return</span> <span>FilterUtils</span><span>.</span><span>invalidToken</span><span>(</span>exchange<span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
        <span>//2 修改请求参数,并获取请求参数</span>
        <span>try</span> <span>{</span>
            <span>updateRequestParam</span><span>(</span>exchange<span>)</span><span>;</span>
        <span>}</span> <span>catch</span> <span>(</span><span>Exception</span> e<span>)</span> <span>{</span>
            <span>return</span> <span>FilterUtils</span><span>.</span><span>invalidUrl</span><span>(</span>exchange<span>)</span><span>;</span>
        <span>}</span>
        <span>//3 获取请求体,修改请求体</span>
        <span>ServerRequest</span> serverRequest <span>=</span> <span>ServerRequest</span><span>.</span><span>create</span><span>(</span>exchange<span>,</span> <span>HandlerStrategies</span><span>.</span><span>withDefaults</span><span>(</span><span>)</span><span>.</span><span>messageReaders</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>Mono</span><span><span>&lt;</span><span>String</span><span>></span></span> modifiedBody <span>=</span> serverRequest<span>.</span><span>bodyToMono</span><span>(</span><span>String</span><span>.</span><span>class</span><span>)</span><span>.</span><span>flatMap</span><span>(</span>body <span>-></span> <span>{</span>
            <span>String</span> encrypt <span>=</span> <span>RSAUtils</span><span>.</span><span>decrypt</span><span>(</span>body<span>,</span> <span>RSAConstant</span><span>.</span>PRIVATE_KEY<span>)</span><span>;</span>
            <span>return</span> <span>Mono</span><span>.</span><span>just</span><span>(</span>encrypt<span>)</span><span>;</span>
        <span>}</span><span>)</span><span>;</span>

        <span>//创建BodyInserter修改请求体</span>
        <span>BodyInserter</span><span><span>&lt;</span><span>Mono</span><span>&lt;</span><span>String</span><span>></span><span>,</span> <span>ReactiveHttpOutputMessage</span><span>></span></span> bodyInserter <span>=</span> <span>BodyInserters</span><span>.</span><span>fromPublisher</span><span>(</span>modifiedBody<span>,</span> <span>String</span><span>.</span><span>class</span><span>)</span><span>;</span>
        <span>HttpHeaders</span> headers <span>=</span> <span>new</span> <span>HttpHeaders</span><span>(</span><span>)</span><span>;</span>
        headers<span>.</span><span>putAll</span><span>(</span>exchange<span>.</span><span>getRequest</span><span>(</span><span>)</span><span>.</span><span>getHeaders</span><span>(</span><span>)</span><span>)</span><span>;</span>
        headers<span>.</span><span>remove</span><span>(</span><span>HttpHeaders</span><span>.</span>CONTENT_LENGTH<span>)</span><span>;</span>
        <span>//创建CachedBodyOutputMessage并且把请求param加入</span>
        <span>CachedBodyOutputMessage</span> outputMessage <span>=</span> <span>new</span> <span>CachedBodyOutputMessage</span><span>(</span>exchange<span>,</span> headers<span>)</span><span>;</span>
        <span>return</span> bodyInserter<span>.</span><span>insert</span><span>(</span>outputMessage<span>,</span> <span>new</span> <span>BodyInserterContext</span><span>(</span><span>)</span><span>)</span><span>.</span><span>then</span><span>(</span><span>Mono</span><span>.</span><span>defer</span><span>(</span><span>(</span><span>)</span> <span>-></span> <span>{</span>
            <span>ServerHttpRequestDecorator</span> decorator <span>=</span> <span>new</span> <span>ServerHttpRequestDecorator</span><span>(</span>exchange<span>.</span><span>getRequest</span><span>(</span><span>)</span><span>)</span> <span>{</span>
                <span>@Override</span>
                <span>public</span> <span>Flux</span><span><span>&lt;</span><span>DataBuffer</span><span>></span></span> <span>getBody</span><span>(</span><span>)</span> <span>{</span>
                    <span>return</span> outputMessage<span>.</span><span>getBody</span><span>(</span><span>)</span><span>;</span>
                <span>}</span>
            <span>}</span><span>;</span>
            <span>return</span> chain<span>.</span><span>filter</span><span>(</span>exchange<span>.</span><span>mutate</span><span>(</span><span>)</span><span>.</span><span>request</span><span>(</span>decorator<span>)</span><span>.</span><span>build</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>}</span><span>)</span><span>)</span><span>;</span>

    <span>}</span>

    <span>/**
     * 修改前端传的参数
     */</span>
    <span>private</span> <span>void</span> <span>updateRequestParam</span><span>(</span><span>ServerWebExchange</span> exchange<span>)</span> <span>throws</span> <span>NoSuchFieldException</span><span>,</span> <span>IllegalAccessException</span> <span>{</span>
        <span>ServerHttpRequest</span> request <span>=</span> exchange<span>.</span><span>getRequest</span><span>(</span><span>)</span><span>;</span>
        <span>URI</span> uri <span>=</span> request<span>.</span><span>getURI</span><span>(</span><span>)</span><span>;</span>
        <span>String</span> query <span>=</span> uri<span>.</span><span>getQuery</span><span>(</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span><span>StringUtils</span><span>.</span><span>isNotBlank</span><span>(</span>query<span>)</span> <span>&amp;&amp;</span> query<span>.</span><span>contains</span><span>(</span><span>"param"</span><span>)</span><span>)</span> <span>{</span>
            <span>String</span><span>[</span><span>]</span> split <span>=</span> query<span>.</span><span>split</span><span>(</span><span>"="</span><span>)</span><span>;</span>
            <span>String</span> param <span>=</span> <span>RSAUtils</span><span>.</span><span>decrypt</span><span>(</span>split<span>[</span><span>1</span><span>]</span><span>,</span> <span>RSAConstant</span><span>.</span>PRIVATE_KEY<span>)</span><span>;</span>
            <span>Field</span> targetQuery <span>=</span> uri<span>.</span><span>getClass</span><span>(</span><span>)</span><span>.</span><span>getDeclaredField</span><span>(</span><span>"query"</span><span>)</span><span>;</span>
            targetQuery<span>.</span><span>setAccessible</span><span>(</span><span>true</span><span>)</span><span>;</span>
            targetQuery<span>.</span><span>set</span><span>(</span>uri<span>,</span> param<span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>


    <span>@Override</span>
    <span>public</span> <span>int</span> <span>getOrder</span><span>(</span><span>)</span> <span>{</span>
        <span>return</span> <span>80</span><span>;</span>
    <span>}</span>
<span>}</span>



</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-3-4-gateway-统一异常" tabindex="-1"> 1.3.4 GateWay 统一异常</h3>
<div><pre><code><span>public</span> <span>abstract</span> <span>class</span> <span>AbstractExceptionHandler</span> <span>{</span>
    <span>protected</span> <span>JSONObject</span> <span>buildErrorMap</span><span>(</span><span>Throwable</span> ex<span>)</span> <span>{</span>
        <span>JSONObject</span> json <span>=</span> <span>new</span> <span>JSONObject</span><span>(</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span>ex <span>instanceof</span> <span>RSAException</span> <span>||</span> ex <span>instanceof</span> <span>IllegalArgumentException</span><span>)</span> <span>{</span>
            json<span>.</span><span>put</span><span>(</span><span>"code"</span><span>,</span> <span>HttpStatus</span><span>.</span>BAD_REQUEST<span>.</span><span>value</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>if</span> <span>(</span><span>StringUtils</span><span>.</span><span>isNotBlank</span><span>(</span>ex<span>.</span><span>getMessage</span><span>(</span><span>)</span><span>)</span><span>)</span><span>{</span>
                json<span>.</span><span>put</span><span>(</span><span>"msg"</span><span>,</span> ex<span>.</span><span>getMessage</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>}</span><span>else</span> <span>{</span>
                json<span>.</span><span>put</span><span>(</span><span>"msg"</span><span>,</span> <span>"无效的请求"</span><span>)</span><span>;</span>
            <span>}</span>

        <span>}</span> <span>else</span> <span>{</span>
            json<span>.</span><span>put</span><span>(</span><span>"code"</span><span>,</span> <span>HttpStatus</span><span>.</span>BAD_REQUEST<span>.</span><span>value</span><span>(</span><span>)</span><span>)</span><span>;</span>
            json<span>.</span><span>put</span><span>(</span><span>"msg"</span><span>,</span> <span>"未知错误联系管理员"</span><span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> json<span>;</span>
    <span>}</span>

<span>}</span>

<span>@Configuration</span>
<span>public</span> <span>class</span> <span>GatewayExceptionConfig</span> <span>{</span>

    <span>@Primary</span>
    <span>@Bean</span>
    <span>@Order</span><span>(</span><span>Ordered</span><span>.</span>HIGHEST_PRECEDENCE<span>)</span>
    <span>public</span> <span>ErrorWebExceptionHandler</span> <span>errorWebExceptionHandler</span><span>(</span><span>ObjectProvider</span><span><span>&lt;</span><span>List</span><span>&lt;</span><span>ViewResolver</span><span>></span><span>></span></span> viewResolversProvider<span>,</span>
                                                             <span>ServerCodecConfigurer</span> serverCodecConfigurer<span>)</span> <span>{</span>
        <span>GatewayExceptionHandler</span> gatewayExceptionHandler <span>=</span> <span>new</span> <span>GatewayExceptionHandler</span><span>(</span><span>)</span><span>;</span>
        gatewayExceptionHandler<span>.</span><span>setViewResolvers</span><span>(</span>viewResolversProvider<span>.</span><span>getIfAvailable</span><span>(</span><span>Collections</span><span>::</span><span>emptyList</span><span>)</span><span>)</span><span>;</span>
        gatewayExceptionHandler<span>.</span><span>setMessageWriters</span><span>(</span>serverCodecConfigurer<span>.</span><span>getWriters</span><span>(</span><span>)</span><span>)</span><span>;</span>
        gatewayExceptionHandler<span>.</span><span>setMessageReaders</span><span>(</span>serverCodecConfigurer<span>.</span><span>getReaders</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>return</span> gatewayExceptionHandler<span>;</span>
    <span>}</span>
<span>}</span>

<span>package</span> <span>com<span>.</span>demo<span>.</span>gateway<span>.</span>exception</span><span>;</span>

<span>import</span> <span><span>com<span>.</span>alibaba<span>.</span>fastjson<span>.</span></span><span>JSONObject</span></span><span>;</span>
<span>import</span> <span><span>lombok<span>.</span>extern<span>.</span>slf4j<span>.</span></span><span>Slf4j</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>boot<span>.</span>web<span>.</span>reactive<span>.</span>error<span>.</span></span><span>ErrorWebExceptionHandler</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>http<span>.</span></span><span>HttpStatus</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>http<span>.</span></span><span>MediaType</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>http<span>.</span>codec<span>.</span></span><span>HttpMessageReader</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>http<span>.</span>codec<span>.</span></span><span>HttpMessageWriter</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>util<span>.</span></span><span>Assert</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>reactive<span>.</span>function<span>.</span></span><span>BodyInserters</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>reactive<span>.</span>function<span>.</span>server<span>.</span></span><span>RequestPredicates</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>reactive<span>.</span>function<span>.</span>server<span>.</span></span><span>RouterFunctions</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>reactive<span>.</span>function<span>.</span>server<span>.</span></span><span>ServerRequest</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>reactive<span>.</span>function<span>.</span>server<span>.</span></span><span>ServerResponse</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>reactive<span>.</span>result<span>.</span>view<span>.</span></span><span>ViewResolver</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>server<span>.</span></span><span>ServerWebExchange</span></span><span>;</span>
<span>import</span> <span><span>reactor<span>.</span>core<span>.</span>publisher<span>.</span></span><span>Mono</span></span><span>;</span>

<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Collections</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>List</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Map</span></span><span>;</span>


<span>@Slf4j</span>
<span>public</span> <span>class</span> <span>GatewayExceptionHandler</span> <span>extends</span> <span>AbstractExceptionHandler</span> <span>implements</span> <span>ErrorWebExceptionHandler</span> <span>{</span>


    <span>private</span> <span>List</span><span><span>&lt;</span><span>HttpMessageReader</span><span>&lt;</span><span>?</span><span>></span><span>></span></span> messageReaders <span>=</span> <span>Collections</span><span>.</span><span>emptyList</span><span>(</span><span>)</span><span>;</span>


    <span>private</span> <span>List</span><span><span>&lt;</span><span>HttpMessageWriter</span><span>&lt;</span><span>?</span><span>></span><span>></span></span> messageWriters <span>=</span> <span>Collections</span><span>.</span><span>emptyList</span><span>(</span><span>)</span><span>;</span>


    <span>private</span> <span>List</span><span><span>&lt;</span><span>ViewResolver</span><span>></span></span> viewResolvers <span>=</span> <span>Collections</span><span>.</span><span>emptyList</span><span>(</span><span>)</span><span>;</span>


    <span>private</span> <span>ThreadLocal</span><span><span>&lt;</span><span>JSONObject</span><span>></span></span> exceptionHandlerResult <span>=</span> <span>new</span> <span>ThreadLocal</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>


    <span>public</span> <span>void</span> <span>setMessageReaders</span><span>(</span><span>List</span><span><span>&lt;</span><span>HttpMessageReader</span><span>&lt;</span><span>?</span><span>></span><span>></span></span> messageReaders<span>)</span> <span>{</span>
        <span>Assert</span><span>.</span><span>notNull</span><span>(</span>messageReaders<span>,</span> <span>"'messageReaders' must not be null"</span><span>)</span><span>;</span>
        <span>this</span><span>.</span>messageReaders <span>=</span> messageReaders<span>;</span>
    <span>}</span>


    <span>public</span> <span>void</span> <span>setViewResolvers</span><span>(</span><span>List</span><span><span>&lt;</span><span>ViewResolver</span><span>></span></span> viewResolvers<span>)</span> <span>{</span>
        <span>this</span><span>.</span>viewResolvers <span>=</span> viewResolvers<span>;</span>
    <span>}</span>


    <span>public</span> <span>void</span> <span>setMessageWriters</span><span>(</span><span>List</span><span><span>&lt;</span><span>HttpMessageWriter</span><span>&lt;</span><span>?</span><span>></span><span>></span></span> messageWriters<span>)</span> <span>{</span>
        <span>Assert</span><span>.</span><span>notNull</span><span>(</span>messageWriters<span>,</span> <span>"'messageWriters' must not be null"</span><span>)</span><span>;</span>
        <span>this</span><span>.</span>messageWriters <span>=</span> messageWriters<span>;</span>
    <span>}</span>

    <span>@Override</span>
    <span>public</span> <span>Mono</span><span><span>&lt;</span><span>Void</span><span>></span></span> <span>handle</span><span>(</span><span>ServerWebExchange</span> exchange<span>,</span> <span>Throwable</span> ex<span>)</span> <span>{</span>
        <span>JSONObject</span> errorInfo <span>=</span> <span>super</span><span>.</span><span>buildErrorMap</span><span>(</span>ex<span>)</span><span>;</span>
        <span>if</span> <span>(</span>exchange<span>.</span><span>getResponse</span><span>(</span><span>)</span><span>.</span><span>isCommitted</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>return</span> <span>Mono</span><span>.</span><span>error</span><span>(</span>ex<span>)</span><span>;</span>
        <span>}</span>
        exceptionHandlerResult<span>.</span><span>set</span><span>(</span>errorInfo<span>)</span><span>;</span>
        <span>ServerRequest</span> newRequest <span>=</span> <span>ServerRequest</span><span>.</span><span>create</span><span>(</span>exchange<span>,</span> <span>this</span><span>.</span>messageReaders<span>)</span><span>;</span>
        <span>return</span> <span>RouterFunctions</span><span>.</span><span>route</span><span>(</span><span>RequestPredicates</span><span>.</span><span>all</span><span>(</span><span>)</span><span>,</span> <span>this</span><span>::</span><span>renderErrorResponse</span><span>)</span><span>.</span><span>route</span><span>(</span>newRequest<span>)</span>
                <span>.</span><span>switchIfEmpty</span><span>(</span><span>Mono</span><span>.</span><span>error</span><span>(</span>ex<span>)</span><span>)</span>
                <span>.</span><span>flatMap</span><span>(</span>handler <span>-></span> handler<span>.</span><span>handle</span><span>(</span>newRequest<span>)</span><span>)</span>
                <span>.</span><span>flatMap</span><span>(</span>response <span>-></span> <span>write</span><span>(</span>exchange<span>,</span> response<span>)</span><span>)</span><span>;</span>

    <span>}</span>


    <span>protected</span> <span>Mono</span><span><span>&lt;</span><span>ServerResponse</span><span>></span></span> <span>renderErrorResponse</span><span>(</span><span>ServerRequest</span> request<span>)</span> <span>{</span>
        <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span></span> result <span>=</span> exceptionHandlerResult<span>.</span><span>get</span><span>(</span><span>)</span><span>;</span>
        <span>return</span> <span>ServerResponse</span><span>.</span><span>status</span><span>(</span><span>HttpStatus</span><span>.</span>OK<span>)</span>
                <span>.</span><span>contentType</span><span>(</span><span>MediaType</span><span>.</span>APPLICATION_JSON<span>)</span>
                <span>.</span><span>body</span><span>(</span><span>BodyInserters</span><span>.</span><span>fromValue</span><span>(</span>result<span>)</span><span>)</span><span>;</span>
    <span>}</span>


    <span>private</span> <span>Mono</span><span><span>&lt;</span><span>?</span> <span>extends</span> <span>Void</span><span>></span></span> <span>write</span><span>(</span><span>ServerWebExchange</span> exchange<span>,</span>
                                       <span>ServerResponse</span> response<span>)</span> <span>{</span>
        exchange<span>.</span><span>getResponse</span><span>(</span><span>)</span><span>.</span><span>getHeaders</span><span>(</span><span>)</span><span>.</span><span>setContentType</span><span>(</span>response<span>.</span><span>headers</span><span>(</span><span>)</span><span>.</span><span>getContentType</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>return</span> response<span>.</span><span>writeTo</span><span>(</span>exchange<span>,</span> <span>new</span> <span>ResponseContext</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>}</span>

    <span>private</span> <span>class</span> <span>ResponseContext</span> <span>implements</span> <span>ServerResponse<span>.</span>Context</span> <span>{</span>

        <span>@Override</span>
        <span>public</span> <span>List</span><span><span>&lt;</span><span>HttpMessageWriter</span><span>&lt;</span><span>?</span><span>></span><span>></span></span> <span>messageWriters</span><span>(</span><span>)</span> <span>{</span>
            <span>return</span> <span>GatewayExceptionHandler</span><span>.</span><span>this</span><span>.</span>messageWriters<span>;</span>
        <span>}</span>

        <span>@Override</span>
        <span>public</span> <span>List</span><span><span>&lt;</span><span>ViewResolver</span><span>></span></span> <span>viewResolvers</span><span>(</span><span>)</span> <span>{</span>
            <span>return</span> <span>GatewayExceptionHandler</span><span>.</span><span>this</span><span>.</span>viewResolvers<span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>

</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-3-5-java业务代码" tabindex="-1"> 1.3.5 JAVA业务代码</h3>
<div><pre><code><span>@RestController</span>
<span>@RequestMapping</span><span>(</span><span>"/user"</span><span>)</span>
<span>public</span> <span>class</span> <span>UserController</span> <span>{</span>


    <span>@Autowired</span>
    <span>private</span> <span>UserService</span> userService<span>;</span>

    <span>@PostMapping</span><span>(</span><span>"/login"</span><span>)</span>
    <span>public</span> <span>String</span> <span>login</span><span>(</span><span>@RequestBody</span> <span>UserForm</span> userForm<span>)</span> <span>{</span>

        <span>return</span> userService<span>.</span><span>login</span><span>(</span>userForm<span>)</span><span>;</span>
    <span>}</span>

    <span>@GetMapping</span><span>(</span><span>"/detail"</span><span>)</span>
    <span>public</span> <span>JSONObject</span> <span>detail</span><span>(</span><span>@RequestParam</span><span>(</span><span>"id"</span><span>)</span> <span>Long</span> id<span>)</span> <span>{</span>

        <span>return</span> userService<span>.</span><span>detail</span><span>(</span>id<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>

<span>@Service</span>
<span>public</span> <span>class</span> <span>UserService</span> <span>{</span>


    <span>private</span> <span>static</span> <span>final</span> <span>String</span> USERNAME <span>=</span> <span>"admin"</span><span>;</span>

    <span>private</span> <span>static</span> <span>final</span> <span>String</span> PASSWORD <span>=</span> <span>"123456"</span><span>;</span>

    <span>private</span> <span>static</span> <span>final</span> <span>Long</span> USER_ID <span>=</span> <span>1L</span><span>;</span>


    <span>/**
     * 模拟 登录 username = admin, password =123456,user_id 1L 登录成功 返回token
     */</span>
    <span>public</span> <span>String</span> <span>login</span><span>(</span><span>UserForm</span> userForm<span>)</span> <span>{</span>

        <span>String</span> username <span>=</span> userForm<span>.</span><span>getUsername</span><span>(</span><span>)</span><span>;</span>
        <span>String</span> password <span>=</span> userForm<span>.</span><span>getPassword</span><span>(</span><span>)</span><span>;</span>

        <span>if</span> <span>(</span>USERNAME<span>.</span><span>equals</span><span>(</span>username<span>)</span> <span>&amp;&amp;</span> PASSWORD<span>.</span><span>equals</span><span>(</span>password<span>)</span><span>)</span> <span>{</span>
            <span>JSONObject</span> userInfo <span>=</span> <span>new</span> <span>JSONObject</span><span>(</span><span>)</span><span>;</span>
            userInfo<span>.</span><span>put</span><span>(</span><span>"username"</span><span>,</span> USERNAME<span>)</span><span>;</span>
            userInfo<span>.</span><span>put</span><span>(</span><span>"password"</span><span>,</span> PASSWORD<span>)</span><span>;</span>
            userInfo<span>.</span><span>put</span><span>(</span><span>"userId"</span><span>,</span> USER_ID<span>)</span><span>;</span>
            <span>return</span> <span>TokenUtils</span><span>.</span><span>createToken</span><span>(</span>userInfo<span>.</span><span>toJSONString</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>}</span>

        <span>return</span> <span>"账号密码不正确"</span><span>;</span>
    <span>}</span>


    <span>public</span> <span>JSONObject</span> <span>detail</span><span>(</span><span>Long</span> id<span>)</span> <span>{</span>
        <span>JSONObject</span> jsonObject <span>=</span> <span>new</span> <span>JSONObject</span><span>(</span><span>)</span><span>;</span>
        jsonObject<span>.</span><span>put</span><span>(</span><span>"id"</span><span>,</span> id<span>)</span><span>;</span>
        jsonObject<span>.</span><span>put</span><span>(</span><span>"name"</span><span>,</span> <span>"admin"</span><span>)</span><span>;</span>
        <span>return</span> jsonObject<span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-3-6-测试" tabindex="-1"> 1.3.6 测试</h3>
<p><strong>登录：返回token</strong></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/4b616048f06847b281fa138fee22fce2.png" alt="图片" loading="lazy">
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/9f37befbcec5431f936c0f95a0435e35.png" alt="图片" loading="lazy">
<strong>查询：</strong></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/cacc9233186d40829f143319b6638f0c.png" alt="图片" loading="lazy"></p>
<h1 id="_2-设置url有效时长" tabindex="-1"> 2 设置URL有效时长</h1>
<p><strong>为了增强URL安全性，前端在header中添加时间戳。</strong></p>
<h2 id="_2-1-前端代码" tabindex="-1"> 2.1 前端代码</h2>
<p><strong>在header中添加时间戳</strong>
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/c608c6d808fa4d30a5318638e56eb520.png" alt="图片" loading="lazy"></p>
<h2 id="_2-2-后端验证时间戳" tabindex="-1"> 2.2 后端验证时间戳</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/0cd2632ba1ba4effa0158648c07ce14d.png" alt="图片" loading="lazy"></p>
<div><pre><code> <span>private</span> <span>Long</span> <span>getDateTimestamp</span><span>(</span><span>HttpHeaders</span> httpHeaders<span>)</span> <span>{</span>
        <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> list <span>=</span> httpHeaders<span>.</span><span>get</span><span>(</span><span>"timestamp"</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span><span>CollectionUtils</span><span>.</span><span>isEmpty</span><span>(</span>list<span>)</span><span>)</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>IllegalArgumentException</span><span>(</span><span>"拒绝服务"</span><span>)</span><span>;</span>
        <span>}</span>
        <span>long</span> timestamp <span>=</span> <span>Long</span><span>.</span><span>parseLong</span><span>(</span>list<span>.</span><span>get</span><span>(</span><span>0</span><span>)</span><span>)</span><span>;</span>
        <span>long</span> currentTimeMillis <span>=</span> <span>System</span><span>.</span><span>currentTimeMillis</span><span>(</span><span>)</span><span>;</span>
        <span>//有效时长为5分钟</span>
        <span>if</span> <span>(</span>currentTimeMillis <span>-</span> timestamp <span>></span> <span>1000</span> <span>*</span> <span>60</span> <span>*</span> <span>5</span><span>)</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>IllegalArgumentException</span><span>(</span><span>"拒绝服务"</span><span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> timestamp<span>;</span>
    <span>}</span>

</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="_2-3-测试不传时间戳" tabindex="-1"> 2.3 测试不传时间戳</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/34c5e25305384149b8cb25236dcdfe9a.png" alt="图片" loading="lazy"></p>
<h1 id="_3-确保url唯一性" tabindex="-1"> 3 确保URL唯一性</h1>
<p><strong>确保URL唯一性，前端请求中增加UUID，后端存入redis，有效时长为5分钟，5分钟重复提交拒绝服务</strong></p>
<h2 id="_3-1-修改前端请求参数" tabindex="-1"> 3.1 修改前端请求参数</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/a7a2c3ad23d74f6a93a98738776f1568.png" alt="图片" loading="lazy"></p>
<h2 id="_3-2-后端增加验证requestid" tabindex="-1"> 3.2 后端增加验证RequestId</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/14ff62fc309947d19b859c4311502c0a.png" alt="图片" loading="lazy"></p>
<div><pre><code><span>private</span> <span>String</span> <span>getRequestId</span><span>(</span><span>HttpHeaders</span> headers<span>)</span> <span>{</span>
        <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> list <span>=</span> headers<span>.</span><span>get</span><span>(</span><span>"requestId"</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span><span>CollectionUtils</span><span>.</span><span>isEmpty</span><span>(</span>list<span>)</span><span>)</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>IllegalArgumentException</span><span>(</span>ERROR_MESSAGE<span>)</span><span>;</span>
        <span>}</span>
        <span>String</span> requestId <span>=</span> list<span>.</span><span>get</span><span>(</span><span>0</span><span>)</span><span>;</span>
        <span>//如果requestId存在redis中直接返回</span>
        <span>String</span> temp <span>=</span> redisTemplate<span>.</span><span>opsForValue</span><span>(</span><span>)</span><span>.</span><span>get</span><span>(</span>requestId<span>)</span><span>;</span>
        <span>if</span> <span>(</span><span>StringUtils</span><span>.</span><span>isNotBlank</span><span>(</span>temp<span>)</span><span>)</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>IllegalArgumentException</span><span>(</span>ERROR_MESSAGE<span>)</span><span>;</span>
        <span>}</span>
        redisTemplate<span>.</span><span>opsForValue</span><span>(</span><span>)</span><span>.</span><span>set</span><span>(</span>requestId<span>,</span> requestId<span>,</span> <span>5</span><span>,</span> <span>TimeUnit</span><span>.</span>MINUTES<span>)</span><span>;</span>
        <span>return</span> requestId<span>;</span>
    <span>}</span>

</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h1 id="_4-增加签名" tabindex="-1"> 4 增加签名</h1>
<p><strong>最后一步，添加签名</strong></p>
<h2 id="_4-1-前端增加签名" tabindex="-1"> 4.1 前端增加签名</h2>
<p>跟前端约定好，json数据按照ASCII升序排序。</p>
<p>登录页面：</p>
<div><pre><code><span><span>&lt;!</span><span>DOCTYPE</span> <span>html</span><span>></span></span>
<span><span><span>&lt;</span>html</span> <span>lang</span><span><span>=</span><span>"</span>en<span>"</span></span><span>></span></span>
<span><span><span>&lt;</span>head</span><span>></span></span>
    <span><span><span>&lt;</span>meta</span> <span>charset</span><span><span>=</span><span>"</span>UTF-8<span>"</span></span><span>></span></span>
    <span><span><span>&lt;</span>title</span><span>></span></span>登录页面<span><span><span>&lt;/</span>title</span><span>></span></span>

<span><span><span>&lt;/</span>head</span><span>></span></span>
<span><span><span>&lt;</span>body</span><span>></span></span>

<span><span><span>&lt;</span>h1</span><span>></span></span>登录<span><span><span>&lt;/</span>h1</span><span>></span></span>


<span><span><span>&lt;</span>from</span> <span>id</span><span><span>=</span><span>"</span>from<span>"</span></span><span>></span></span>
    账号：<span><span><span>&lt;</span>input</span> <span>id</span><span><span>=</span><span>"</span>username<span>"</span></span> <span>type</span><span><span>=</span><span>"</span>text<span>"</span></span><span>/></span></span>
    <span><span><span>&lt;</span>br</span><span>/></span></span>
    密码：<span><span><span>&lt;</span>input</span> <span>id</span><span><span>=</span><span>"</span>password<span>"</span></span> <span>type</span><span><span>=</span><span>"</span>password<span>"</span></span><span>/></span></span>
    <span><span><span>&lt;</span>br</span><span>/></span></span>
    <span><span><span>&lt;</span>input</span> <span>id</span><span><span>=</span><span>"</span>btn_login<span>"</span></span> <span>type</span><span><span>=</span><span>"</span>button<span>"</span></span> <span>value</span><span><span>=</span><span>"</span>登录<span>"</span></span><span>/></span></span>
<span><span><span>&lt;/</span>from</span><span>></span></span>




<span><span><span>&lt;</span>script</span> <span>src</span><span><span>=</span><span>"</span>js/jquery.min.js<span>"</span></span><span>></span></span><span></span><span><span><span>&lt;/</span>script</span><span>></span></span>
<span><span><span>&lt;</span>script</span> <span>src</span><span><span>=</span><span>"</span>js/jsencrypt.js<span>"</span></span><span>></span></span><span></span><span><span><span>&lt;/</span>script</span><span>></span></span>
<span><span><span>&lt;</span>script</span> <span>src</span><span><span>=</span><span>"</span>js/md5.min.js<span>"</span></span><span>></span></span><span></span><span><span><span>&lt;/</span>script</span><span>></span></span>

<span><span><span>&lt;</span>script</span> <span>type</span><span><span>=</span><span>"</span>text/javascript<span>"</span></span><span>></span></span><span><span>
    <span>var</span> encrypt <span>=</span> <span>new</span> <span>JSEncrypt</span><span>(</span><span>)</span><span>;</span>
    encrypt<span>.</span><span>setPublicKey</span><span>(</span><span>"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCFtTlL61IqIGd+fRLUhJ0MjsqFXFJswCohJ45m51WvbxDPRP3gllW0WChk74D5JEOpMDSWo4C7RfoGlBRNW7kQ6qYGukYZ5jgYpzoT0+gp3on96fQXEyQJysv9xiTPIdmSXXVVj1HAOJw29RbzxIVKUSzzPXvEtXRTtCC1+wkAJQIDAQAB"</span><span>)</span><span>;</span>
    <span>$</span><span>(</span><span>"#btn_login"</span><span>)</span><span>.</span><span>click</span><span>(</span><span>function</span> <span>(</span><span>)</span> <span>{</span>
        <span>//表单</span>
        <span>const</span> username <span>=</span> <span>$</span><span>(</span><span>"#username"</span><span>)</span><span>.</span><span>val</span><span>(</span><span>)</span><span>;</span>
        <span>const</span> password <span>=</span> <span>$</span><span>(</span><span>"#password"</span><span>)</span><span>.</span><span>val</span><span>(</span><span>)</span><span>;</span>
        <span>const</span> form <span>=</span> <span>{</span><span>}</span><span>;</span>
        form<span>.</span>username <span>=</span> username<span>;</span>
        form<span>.</span>password <span>=</span> password<span>;</span>
        <span>//生成签名，也可以加盐</span>
        <span>const</span> timestamp <span>=</span> Date<span>.</span><span>parse</span><span>(</span><span>new</span> <span>Date</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>const</span> data <span>=</span> <span>JSON</span><span>.</span><span>stringify</span><span>(</span><span>sort_ASCII</span><span>(</span>form<span>)</span><span>)</span><span>;</span>
        <span>const</span> requestId <span>=</span> <span>getUuid</span><span>(</span><span>)</span><span>;</span>
        <span>const</span> sign <span>=</span> <span>MD5</span><span>(</span>data <span>+</span> requestId <span>+</span> timestamp<span>)</span><span>;</span>


        $<span>.</span><span>ajax</span><span>(</span><span>{</span>
            <span>url</span><span>:</span> <span>"http://localhost:9000/api/user/login"</span><span>,</span>
            <span>beforeSend</span><span>:</span> <span>function</span> <span>(</span><span>XMLHttpRequest</span><span>)</span> <span>{</span>
                XMLHttpRequest<span>.</span><span>setRequestHeader</span><span>(</span><span>"timestamp"</span><span>,</span> timestamp<span>)</span><span>;</span>
                XMLHttpRequest<span>.</span><span>setRequestHeader</span><span>(</span><span>"requestId"</span><span>,</span> requestId<span>)</span><span>;</span>
                XMLHttpRequest<span>.</span><span>setRequestHeader</span><span>(</span><span>"sign"</span><span>,</span> sign<span>)</span><span>;</span>
            <span>}</span><span>,</span>
            <span>data</span><span>:</span> encrypt<span>.</span><span>encrypt</span><span>(</span>data<span>)</span><span>,</span>
            <span>type</span><span>:</span> <span>"POST"</span><span>,</span>
            <span>dataType</span><span>:</span> <span>"json"</span><span>,</span>
            <span>contentType</span><span>:</span> <span>"application/json;charset=utf-8"</span><span>,</span>
            <span>success</span><span>:</span> <span>function</span> <span>(</span><span>data</span><span>)</span> <span>{</span>
                console<span>.</span><span>log</span><span>(</span>data<span>)</span><span>;</span>
            <span>}</span>
        <span>}</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>


    <span>function</span> <span>getUuid</span><span>(</span><span>)</span> <span>{</span>
        <span>var</span> s <span>=</span> <span>[</span><span>]</span><span>;</span>
        <span>var</span> hexDigits <span>=</span> <span>"0123456789abcdef"</span><span>;</span>
        <span>for</span> <span>(</span><span>var</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> <span>32</span><span>;</span> i<span>++</span><span>)</span> <span>{</span>
            s<span>[</span>i<span>]</span> <span>=</span> hexDigits<span>.</span><span>substr</span><span>(</span>Math<span>.</span><span>floor</span><span>(</span>Math<span>.</span><span>random</span><span>(</span><span>)</span> <span>*</span> <span>0x10</span><span>)</span><span>,</span> <span>1</span><span>)</span><span>;</span>
        <span>}</span>
        s<span>[</span><span>14</span><span>]</span> <span>=</span> <span>"4"</span><span>;</span> <span>// bits 12-15 of the time_hi_and_version field to 0010</span>
        s<span>[</span><span>19</span><span>]</span> <span>=</span> hexDigits<span>.</span><span>substr</span><span>(</span><span>(</span>s<span>[</span><span>19</span><span>]</span> <span>&amp;</span> <span>0x3</span><span>)</span> <span>|</span> <span>0x8</span><span>,</span> <span>1</span><span>)</span><span>;</span> <span>// bits 6-7 of the clock_seq_hi_and_reserved to 01</span>
        s<span>[</span><span>8</span><span>]</span> <span>=</span> s<span>[</span><span>13</span><span>]</span> <span>=</span> s<span>[</span><span>18</span><span>]</span> <span>=</span> s<span>[</span><span>23</span><span>]</span><span>;</span>
        <span>var</span> uuid <span>=</span> s<span>.</span><span>join</span><span>(</span><span>""</span><span>)</span><span>;</span>
        <span>return</span> uuid<span>;</span>
    <span>}</span>

    <span>function</span> <span>sort_ASCII</span><span>(</span><span>obj</span><span>)</span> <span>{</span>
        <span>var</span> arr <span>=</span> <span>new</span> <span>Array</span><span>(</span><span>)</span><span>;</span>
        <span>var</span> num <span>=</span> <span>0</span><span>;</span>
        <span>for</span> <span>(</span><span>var</span> i <span>in</span> obj<span>)</span> <span>{</span>
            arr<span>[</span>num<span>]</span> <span>=</span> i<span>;</span>
            num<span>++</span><span>;</span>
        <span>}</span>
        <span>var</span> sortArr <span>=</span> arr<span>.</span><span>sort</span><span>(</span><span>)</span><span>;</span>
        <span>var</span> sortObj <span>=</span> <span>{</span><span>}</span><span>;</span>
        <span>for</span> <span>(</span><span>var</span> i <span>in</span> sortArr<span>)</span> <span>{</span>
            sortObj<span>[</span>sortArr<span>[</span>i<span>]</span><span>]</span> <span>=</span> obj<span>[</span>sortArr<span>[</span>i<span>]</span><span>]</span><span>;</span>
        <span>}</span>
        <span>return</span> sortObj<span>;</span>
    <span>}</span>

</span></span><span><span><span>&lt;/</span>script</span><span>></span></span>


<span><span><span>&lt;/</span>body</span><span>></span></span>
<span><span><span>&lt;/</span>html</span><span>></span></span>

</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="_4-2-增强读取body类" tabindex="-1"> 4.2 增强读取Body类</h2>
<div><pre><code><span>/**
 * @Description:
 * @Author: Rosh
 * @Date: 2021/10/27 11:03
 */</span>
<span>public</span> <span>class</span> <span>MyCachedBodyOutputMessage</span> <span>extends</span> <span>CachedBodyOutputMessage</span> <span>{</span>

    <span>private</span> <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span></span> paramMap<span>;</span>

    <span>private</span> <span>Long</span> dateTimestamp<span>;</span>

    <span>private</span> <span>String</span> requestId<span>;</span>

    <span>private</span> <span>String</span> sign<span>;</span>

    <span>public</span> <span>MyCachedBodyOutputMessage</span><span>(</span><span>ServerWebExchange</span> exchange<span>,</span> <span>HttpHeaders</span> httpHeaders<span>)</span> <span>{</span>
        <span>super</span><span>(</span>exchange<span>,</span> httpHeaders<span>)</span><span>;</span>
    <span>}</span>

    <span>public</span> <span>void</span> <span>initial</span><span>(</span><span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span></span> paramMap<span>,</span> <span>String</span> requestId<span>,</span> <span>String</span> sign<span>,</span> <span>Long</span> dateTimestamp<span>)</span> <span>{</span>
        <span>this</span><span>.</span>paramMap <span>=</span> paramMap<span>;</span>
        <span>this</span><span>.</span>requestId <span>=</span> requestId<span>;</span>
        <span>this</span><span>.</span>sign <span>=</span> sign<span>;</span>
        <span>this</span><span>.</span>dateTimestamp <span>=</span> dateTimestamp<span>;</span>
    <span>}</span>


    <span>public</span> <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span></span> <span>getParamMap</span><span>(</span><span>)</span> <span>{</span>
        <span>return</span> paramMap<span>;</span>
    <span>}</span>

    <span>public</span> <span>Long</span> <span>getDateTimestamp</span><span>(</span><span>)</span> <span>{</span>
        <span>return</span> dateTimestamp<span>;</span>
    <span>}</span>

    <span>public</span> <span>String</span> <span>getRequestId</span><span>(</span><span>)</span> <span>{</span>
        <span>return</span> requestId<span>;</span>
    <span>}</span>

    <span>public</span> <span>String</span> <span>getSign</span><span>(</span><span>)</span> <span>{</span>
        <span>return</span> sign<span>;</span>
    <span>}</span>
<span>}</span>


</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="_4-3-修改gatewayfilterconfig" tabindex="-1"> 4.3 修改GatewayFilterConfig</h2>
<div><pre><code><span>package</span> <span>com<span>.</span>demo<span>.</span>gateway<span>.</span>config</span><span>;</span>

<span>import</span> <span><span>com<span>.</span>alibaba<span>.</span>fastjson<span>.</span></span><span>JSON</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>alibaba<span>.</span>fastjson<span>.</span></span><span>JSONObject</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>alibaba<span>.</span>nacos<span>.</span>common<span>.</span>utils<span>.</span></span><span>Md5Utils</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>constant<span>.</span></span><span>UserConstant</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>gateway<span>.</span>pojo<span>.</span></span><span>MyCachedBodyOutputMessage</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>utils<span>.</span></span><span>RSAUtils</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>utils<span>.</span></span><span>TokenUtils</span></span><span>;</span>
<span>import</span> <span><span>io<span>.</span>jsonwebtoken<span>.</span></span><span>Claims</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>apache<span>.</span>commons<span>.</span>lang3<span>.</span></span><span>StringUtils</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>beans<span>.</span>factory<span>.</span>annotation<span>.</span></span><span>Autowired</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>cloud<span>.</span>gateway<span>.</span>filter<span>.</span></span><span>GatewayFilterChain</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>cloud<span>.</span>gateway<span>.</span>filter<span>.</span></span><span>GlobalFilter</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>cloud<span>.</span>gateway<span>.</span>support<span>.</span></span><span>BodyInserterContext</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>context<span>.</span>annotation<span>.</span></span><span>Configuration</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>core<span>.</span></span><span>Ordered</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>core<span>.</span>io<span>.</span>buffer<span>.</span></span><span>DataBuffer</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>data<span>.</span>redis<span>.</span>core<span>.</span></span><span>RedisTemplate</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>http<span>.</span></span><span>HttpHeaders</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>http<span>.</span></span><span>ReactiveHttpOutputMessage</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>http<span>.</span>server<span>.</span>reactive<span>.</span></span><span>ServerHttpRequest</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>http<span>.</span>server<span>.</span>reactive<span>.</span></span><span>ServerHttpRequestDecorator</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>stereotype<span>.</span></span><span>Component</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>util<span>.</span></span><span>AntPathMatcher</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>util<span>.</span></span><span>CollectionUtils</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>reactive<span>.</span>function<span>.</span></span><span>BodyInserter</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>reactive<span>.</span>function<span>.</span></span><span>BodyInserters</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>reactive<span>.</span>function<span>.</span>server<span>.</span></span><span>HandlerStrategies</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>reactive<span>.</span>function<span>.</span>server<span>.</span></span><span>ServerRequest</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>server<span>.</span></span><span>ServerWebExchange</span></span><span>;</span>
<span>import</span> <span><span>reactor<span>.</span>core<span>.</span>publisher<span>.</span></span><span>Flux</span></span><span>;</span>
<span>import</span> <span><span>reactor<span>.</span>core<span>.</span>publisher<span>.</span></span><span>Mono</span></span><span>;</span>

<span>import</span> <span><span>java<span>.</span>lang<span>.</span>reflect<span>.</span></span><span>Field</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>net<span>.</span></span><span>URI</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>List</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Map</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>TreeMap</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span>concurrent<span>.</span></span><span>TimeUnit</span></span><span>;</span>


<span>/**
 * @Description:
 * @Author: rosh
 * @Date: 2021/10/26 22:24
 */</span>
<span>@Configuration</span>
<span>@Component</span>
<span>public</span> <span>class</span> <span>GatewayFilterConfig</span> <span>implements</span> <span>GlobalFilter</span><span>,</span> <span>Ordered</span> <span>{</span>


    <span>@Autowired</span>
    <span>private</span> <span>RedisTemplate</span><span><span>&lt;</span><span>String</span><span>,</span> <span>String</span><span>></span></span> redisTemplate<span>;</span>


    <span>private</span> <span>static</span> <span>final</span> <span>String</span> ERROR_MESSAGE <span>=</span> <span>"拒绝服务"</span><span>;</span>


    <span>@Override</span>
    <span>public</span> <span>Mono</span><span><span>&lt;</span><span>Void</span><span>></span></span> <span>filter</span><span>(</span><span>ServerWebExchange</span> exchange<span>,</span> <span>GatewayFilterChain</span> chain<span>)</span> <span>{</span>
        <span>//1 获取时间戳</span>
        <span>Long</span> dateTimestamp <span>=</span> <span>getDateTimestamp</span><span>(</span>exchange<span>.</span><span>getRequest</span><span>(</span><span>)</span><span>.</span><span>getHeaders</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>//2 获取RequestId</span>
        <span>String</span> requestId <span>=</span> <span>getRequestId</span><span>(</span>exchange<span>.</span><span>getRequest</span><span>(</span><span>)</span><span>.</span><span>getHeaders</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>//3 获取签名</span>
        <span>String</span> sign <span>=</span> <span>getSign</span><span>(</span>exchange<span>.</span><span>getRequest</span><span>(</span><span>)</span><span>.</span><span>getHeaders</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>//4 如果是登录不校验Token</span>
        <span>String</span> requestUrl <span>=</span> exchange<span>.</span><span>getRequest</span><span>(</span><span>)</span><span>.</span><span>getPath</span><span>(</span><span>)</span><span>.</span><span>value</span><span>(</span><span>)</span><span>;</span>
        <span>AntPathMatcher</span> pathMatcher <span>=</span> <span>new</span> <span>AntPathMatcher</span><span>(</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span><span>!</span>pathMatcher<span>.</span><span>match</span><span>(</span><span>"/user/login"</span><span>,</span> requestUrl<span>)</span><span>)</span> <span>{</span>
            <span>String</span> token <span>=</span> exchange<span>.</span><span>getRequest</span><span>(</span><span>)</span><span>.</span><span>getHeaders</span><span>(</span><span>)</span><span>.</span><span>getFirst</span><span>(</span><span>UserConstant</span><span>.</span>TOKEN<span>)</span><span>;</span>
            <span>Claims</span> claim <span>=</span> <span>TokenUtils</span><span>.</span><span>getClaim</span><span>(</span>token<span>)</span><span>;</span>
            <span>if</span> <span>(</span><span>StringUtils</span><span>.</span><span>isBlank</span><span>(</span>token<span>)</span> <span>||</span> claim <span>==</span> <span>null</span><span>)</span> <span>{</span>
                <span>return</span> <span>FilterUtils</span><span>.</span><span>invalidToken</span><span>(</span>exchange<span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
        <span>//5 修改请求参数,并获取请求参数</span>
        <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span></span> paramMap<span>;</span>
        <span>try</span> <span>{</span>
            paramMap <span>=</span> <span>updateRequestParam</span><span>(</span>exchange<span>)</span><span>;</span>
        <span>}</span> <span>catch</span> <span>(</span><span>Exception</span> e<span>)</span> <span>{</span>
            <span>return</span> <span>FilterUtils</span><span>.</span><span>invalidUrl</span><span>(</span>exchange<span>)</span><span>;</span>
        <span>}</span>
        <span>//6 获取请求体,修改请求体</span>
        <span>ServerRequest</span> serverRequest <span>=</span> <span>ServerRequest</span><span>.</span><span>create</span><span>(</span>exchange<span>,</span> <span>HandlerStrategies</span><span>.</span><span>withDefaults</span><span>(</span><span>)</span><span>.</span><span>messageReaders</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>Mono</span><span><span>&lt;</span><span>String</span><span>></span></span> modifiedBody <span>=</span> serverRequest<span>.</span><span>bodyToMono</span><span>(</span><span>String</span><span>.</span><span>class</span><span>)</span><span>.</span><span>flatMap</span><span>(</span>body <span>-></span> <span>{</span>
            <span>String</span> encrypt <span>=</span> <span>RSAUtils</span><span>.</span><span>decrypt</span><span>(</span>body<span>,</span> <span>RSAConstant</span><span>.</span>PRIVATE_KEY<span>)</span><span>;</span>
            <span>JSONObject</span> jsonObject <span>=</span> JSON<span>.</span><span>parseObject</span><span>(</span>encrypt<span>)</span><span>;</span>
            <span>for</span> <span>(</span><span>Map<span>.</span>Entry</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span></span> entry <span>:</span> jsonObject<span>.</span><span>entrySet</span><span>(</span><span>)</span><span>)</span> <span>{</span>
                paramMap<span>.</span><span>put</span><span>(</span>entry<span>.</span><span>getKey</span><span>(</span><span>)</span><span>,</span> entry<span>.</span><span>getValue</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>}</span>
            <span>checkSign</span><span>(</span>sign<span>,</span> dateTimestamp<span>,</span> requestId<span>,</span> paramMap<span>)</span><span>;</span>
            <span>return</span> <span>Mono</span><span>.</span><span>just</span><span>(</span>encrypt<span>)</span><span>;</span>
        <span>}</span><span>)</span><span>;</span>

        <span>//创建BodyInserter修改请求体</span>

        <span>BodyInserter</span><span><span>&lt;</span><span>Mono</span><span>&lt;</span><span>String</span><span>></span><span>,</span> <span>ReactiveHttpOutputMessage</span><span>></span></span> bodyInserter <span>=</span> <span>BodyInserters</span><span>.</span><span>fromPublisher</span><span>(</span>modifiedBody<span>,</span> <span>String</span><span>.</span><span>class</span><span>)</span><span>;</span>
        <span>HttpHeaders</span> headers <span>=</span> <span>new</span> <span>HttpHeaders</span><span>(</span><span>)</span><span>;</span>
        headers<span>.</span><span>putAll</span><span>(</span>exchange<span>.</span><span>getRequest</span><span>(</span><span>)</span><span>.</span><span>getHeaders</span><span>(</span><span>)</span><span>)</span><span>;</span>
        headers<span>.</span><span>remove</span><span>(</span><span>HttpHeaders</span><span>.</span>CONTENT_LENGTH<span>)</span><span>;</span>
        <span>//创建CachedBodyOutputMessage并且把请求param加入,初始化校验信息</span>
        <span>MyCachedBodyOutputMessage</span> outputMessage <span>=</span> <span>new</span> <span>MyCachedBodyOutputMessage</span><span>(</span>exchange<span>,</span> headers<span>)</span><span>;</span>
        outputMessage<span>.</span><span>initial</span><span>(</span>paramMap<span>,</span> requestId<span>,</span> sign<span>,</span> dateTimestamp<span>)</span><span>;</span>
        <span>return</span> bodyInserter<span>.</span><span>insert</span><span>(</span>outputMessage<span>,</span> <span>new</span> <span>BodyInserterContext</span><span>(</span><span>)</span><span>)</span><span>.</span><span>then</span><span>(</span><span>Mono</span><span>.</span><span>defer</span><span>(</span><span>(</span><span>)</span> <span>-></span> <span>{</span>
            <span>ServerHttpRequestDecorator</span> decorator <span>=</span> <span>new</span> <span>ServerHttpRequestDecorator</span><span>(</span>exchange<span>.</span><span>getRequest</span><span>(</span><span>)</span><span>)</span> <span>{</span>
                <span>@Override</span>
                <span>public</span> <span>Flux</span><span><span>&lt;</span><span>DataBuffer</span><span>></span></span> <span>getBody</span><span>(</span><span>)</span> <span>{</span>
                    <span>Flux</span><span><span>&lt;</span><span>DataBuffer</span><span>></span></span> body <span>=</span> outputMessage<span>.</span><span>getBody</span><span>(</span><span>)</span><span>;</span>
                    <span>if</span> <span>(</span>body<span>.</span><span>equals</span><span>(</span><span>Flux</span><span>.</span><span>empty</span><span>(</span><span>)</span><span>)</span><span>)</span> <span>{</span>
                        <span>//验证签名</span>
                        <span>checkSign</span><span>(</span>outputMessage<span>.</span><span>getSign</span><span>(</span><span>)</span><span>,</span> outputMessage<span>.</span><span>getDateTimestamp</span><span>(</span><span>)</span><span>,</span> outputMessage<span>.</span><span>getRequestId</span><span>(</span><span>)</span><span>,</span> outputMessage<span>.</span><span>getParamMap</span><span>(</span><span>)</span><span>)</span><span>;</span>
                    <span>}</span>
                    <span>return</span> outputMessage<span>.</span><span>getBody</span><span>(</span><span>)</span><span>;</span>
                <span>}</span>
            <span>}</span><span>;</span>
            <span>return</span> chain<span>.</span><span>filter</span><span>(</span>exchange<span>.</span><span>mutate</span><span>(</span><span>)</span><span>.</span><span>request</span><span>(</span>decorator<span>)</span><span>.</span><span>build</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>}</span><span>)</span><span>)</span><span>;</span>

    <span>}</span>

    <span>public</span> <span>void</span> <span>checkSign</span><span>(</span><span>String</span> sign<span>,</span> <span>Long</span> dateTimestamp<span>,</span> <span>String</span> requestId<span>,</span> <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span></span> paramMap<span>)</span> <span>{</span>
        <span>String</span> str <span>=</span> JSON<span>.</span><span>toJSONString</span><span>(</span>paramMap<span>)</span> <span>+</span> requestId <span>+</span> dateTimestamp<span>;</span>
        <span>String</span> tempSign <span>=</span> <span>Md5Utils</span><span>.</span><span>getMD5</span><span>(</span>str<span>.</span><span>getBytes</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span><span>!</span>tempSign<span>.</span><span>equals</span><span>(</span>sign<span>)</span><span>)</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>IllegalArgumentException</span><span>(</span>ERROR_MESSAGE<span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>

    <span>/**
     * 修改前端传的参数
     */</span>
    <span>private</span> <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span></span> <span>updateRequestParam</span><span>(</span><span>ServerWebExchange</span> exchange<span>)</span> <span>throws</span> <span>NoSuchFieldException</span><span>,</span> <span>IllegalAccessException</span> <span>{</span>
        <span>ServerHttpRequest</span> request <span>=</span> exchange<span>.</span><span>getRequest</span><span>(</span><span>)</span><span>;</span>
        <span>URI</span> uri <span>=</span> request<span>.</span><span>getURI</span><span>(</span><span>)</span><span>;</span>
        <span>String</span> query <span>=</span> uri<span>.</span><span>getQuery</span><span>(</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span><span>StringUtils</span><span>.</span><span>isNotBlank</span><span>(</span>query<span>)</span> <span>&amp;&amp;</span> query<span>.</span><span>contains</span><span>(</span><span>"param"</span><span>)</span><span>)</span> <span>{</span>
            <span>String</span><span>[</span><span>]</span> split <span>=</span> query<span>.</span><span>split</span><span>(</span><span>"="</span><span>)</span><span>;</span>
            <span>String</span> param <span>=</span> <span>RSAUtils</span><span>.</span><span>decrypt</span><span>(</span>split<span>[</span><span>1</span><span>]</span><span>,</span> <span>RSAConstant</span><span>.</span>PRIVATE_KEY<span>)</span><span>;</span>
            <span>Field</span> targetQuery <span>=</span> uri<span>.</span><span>getClass</span><span>(</span><span>)</span><span>.</span><span>getDeclaredField</span><span>(</span><span>"query"</span><span>)</span><span>;</span>
            targetQuery<span>.</span><span>setAccessible</span><span>(</span><span>true</span><span>)</span><span>;</span>
            targetQuery<span>.</span><span>set</span><span>(</span>uri<span>,</span> param<span>)</span><span>;</span>
            <span>return</span> <span>getParamMap</span><span>(</span>param<span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> <span>new</span> <span>TreeMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
    <span>}</span>


    <span>private</span> <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span></span> <span>getParamMap</span><span>(</span><span>String</span> param<span>)</span> <span>{</span>
        <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span></span> map <span>=</span> <span>new</span> <span>TreeMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
        <span>String</span><span>[</span><span>]</span> split <span>=</span> param<span>.</span><span>split</span><span>(</span><span>"&amp;"</span><span>)</span><span>;</span>
        <span>for</span> <span>(</span><span>String</span> str <span>:</span> split<span>)</span> <span>{</span>
            <span>String</span><span>[</span><span>]</span> params <span>=</span> str<span>.</span><span>split</span><span>(</span><span>"="</span><span>)</span><span>;</span>
            map<span>.</span><span>put</span><span>(</span>params<span>[</span><span>0</span><span>]</span><span>,</span> params<span>[</span><span>1</span><span>]</span><span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> map<span>;</span>
    <span>}</span>


    <span>private</span> <span>String</span> <span>getSign</span><span>(</span><span>HttpHeaders</span> headers<span>)</span> <span>{</span>
        <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> list <span>=</span> headers<span>.</span><span>get</span><span>(</span><span>"sign"</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span><span>CollectionUtils</span><span>.</span><span>isEmpty</span><span>(</span>list<span>)</span><span>)</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>IllegalArgumentException</span><span>(</span>ERROR_MESSAGE<span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> list<span>.</span><span>get</span><span>(</span><span>0</span><span>)</span><span>;</span>
    <span>}</span>

    <span>private</span> <span>Long</span> <span>getDateTimestamp</span><span>(</span><span>HttpHeaders</span> httpHeaders<span>)</span> <span>{</span>
        <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> list <span>=</span> httpHeaders<span>.</span><span>get</span><span>(</span><span>"timestamp"</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span><span>CollectionUtils</span><span>.</span><span>isEmpty</span><span>(</span>list<span>)</span><span>)</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>IllegalArgumentException</span><span>(</span>ERROR_MESSAGE<span>)</span><span>;</span>
        <span>}</span>
        <span>long</span> timestamp <span>=</span> <span>Long</span><span>.</span><span>parseLong</span><span>(</span>list<span>.</span><span>get</span><span>(</span><span>0</span><span>)</span><span>)</span><span>;</span>
        <span>long</span> currentTimeMillis <span>=</span> <span>System</span><span>.</span><span>currentTimeMillis</span><span>(</span><span>)</span><span>;</span>
        <span>//有效时长为5分钟</span>
        <span>if</span> <span>(</span>currentTimeMillis <span>-</span> timestamp <span>></span> <span>1000</span> <span>*</span> <span>60</span> <span>*</span> <span>5</span><span>)</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>IllegalArgumentException</span><span>(</span>ERROR_MESSAGE<span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> timestamp<span>;</span>
    <span>}</span>

    <span>private</span> <span>String</span> <span>getRequestId</span><span>(</span><span>HttpHeaders</span> headers<span>)</span> <span>{</span>
        <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> list <span>=</span> headers<span>.</span><span>get</span><span>(</span><span>"requestId"</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span><span>CollectionUtils</span><span>.</span><span>isEmpty</span><span>(</span>list<span>)</span><span>)</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>IllegalArgumentException</span><span>(</span>ERROR_MESSAGE<span>)</span><span>;</span>
        <span>}</span>
        <span>String</span> requestId <span>=</span> list<span>.</span><span>get</span><span>(</span><span>0</span><span>)</span><span>;</span>
        <span>//如果requestId存在redis中直接返回</span>
        <span>String</span> temp <span>=</span> redisTemplate<span>.</span><span>opsForValue</span><span>(</span><span>)</span><span>.</span><span>get</span><span>(</span>requestId<span>)</span><span>;</span>
        <span>if</span> <span>(</span><span>StringUtils</span><span>.</span><span>isNotBlank</span><span>(</span>temp<span>)</span><span>)</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>IllegalArgumentException</span><span>(</span>ERROR_MESSAGE<span>)</span><span>;</span>
        <span>}</span>
        redisTemplate<span>.</span><span>opsForValue</span><span>(</span><span>)</span><span>.</span><span>set</span><span>(</span>requestId<span>,</span> requestId<span>,</span> <span>5</span><span>,</span> <span>TimeUnit</span><span>.</span>MINUTES<span>)</span><span>;</span>
        <span>return</span> requestId<span>;</span>
    <span>}</span>

    <span>@Override</span>
    <span>public</span> <span>int</span> <span>getOrder</span><span>(</span><span>)</span> <span>{</span>
        <span>return</span> <span>80</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="_4-4-测试登录" tabindex="-1"> 4.4 测试登录</h2>
<p><strong>发现验签成功</strong>
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/8e17d38de0eb4144980a740cd16b1d99-16540481454245.png" alt="图片" loading="lazy"></p>
<h2 id="_4-5-测试查询" tabindex="-1"> 4.5 测试查询</h2>
<p>验签成功</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/4080582e2887418c8cf53cf3e40ce517.png" alt="图片" loading="lazy"></p>
<h1 id="_5-码云地址" tabindex="-1"> 5 码云地址</h1>
<div><pre><code>https<span>:</span><span>/</span><span>/</span>gitee<span>.</span>com<span>/</span>zhurongsheng<span>/</span>springcloud<span>-</span>gateway<span>-</span>rsa
</code></pre><div aria-hidden="true"><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-17T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">七大排序（代码+动图演示）</title>
    <id>https://blog.ciberviler.top/algorithm/%E4%B8%83%E5%A4%A7%E6%8E%92%E5%BA%8F.html</id>
    <link href="https://blog.ciberviler.top/algorithm/%E4%B8%83%E5%A4%A7%E6%8E%92%E5%BA%8F.html"/>
    <updated>2022-05-30T04:24:37.000Z</updated>
    <content type="html"><![CDATA[<h1 id="七大排序-代码-动图演示" tabindex="-1"> 七大排序（代码+动图演示）</h1>
<h2 id="_1-排序的概念及其运用" tabindex="-1"> 1.排序的概念及其运用</h2>
<h3 id="_1-1排序的概念" tabindex="-1"> 1.1排序的概念</h3>
<blockquote>
<p><strong>排序</strong>：所谓排序，就是使一串记录，按照其中的某个或某些关键字的大小，递增或递减的排列起来的操作。</p>
<p><strong>稳定性</strong>：假定在待排序的记录序列中，存在多个具有相同的关键字的记录，若经过排序，这些记录的相对次 序保持不变，即在原序列中，r[i]=r[j]，且r[i]在r[j]之前，而在排序后的序列中，r[i]仍在r[j]之前，则称这种排 序算法是稳定的；否则称为不稳定的。</p>
<p><strong>稳定性的意义</strong>：在根据多种属性进行排序时会有巨大的意义。比如我们先对学生按照学号进行了排序，再对学生进行了按照成绩进行排序，此时学号和成绩成为了两种决定因素，如果我们在按照成绩进行排序时，所使用的算法是不具有稳定性的，那么在对成绩排序后，之前根据学号进行的排序就没有意义了，此时就会出现相同成绩，但是学号靠后的在前面，反之，如果我们选择的排序具有稳定性，那么成绩相同，学号靠前的应该在前面。</p>
<p><strong>内部排序</strong>：数据元素全部放在内存中的排序。</p>
<p><strong>外部排序</strong>：数据元素太多不能同时放在内存中，根据排序过程的要求不能在内外存之间移动数据的排序。<strong>一般数据是存储在磁盘中的。</strong></p>
</blockquote>
<p>区分内外排序：</p>
<table>
<thead>
<tr>
<th>排序类型</th>
<th>数据存储</th>
<th>访问速度</th>
<th>支持的访问形式</th>
</tr>
</thead>
<tbody>
<tr>
<td>内排序</td>
<td>数据在内存中（数组）</td>
<td>快</td>
<td>下标随机访问</td>
</tr>
<tr>
<td>外排序</td>
<td>数据在磁盘中，数据量很大</td>
<td>慢</td>
<td>串行访问</td>
</tr>
</tbody>
</table>
<h3 id="_1-2-排序的运用" tabindex="-1"> 1.2 排序的运用</h3>
<p>下面就是按价格对手机进行排序：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/6341d7a797684a31ae2e6f567c9057fd.png" alt="image-20220424103625642" loading="lazy"></p>
<p>下面是根据综合得分对大学进行排名：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/d2d1f6a92aca95da78de2198ce021a3d.png" alt="image-20220424103843298" loading="lazy"></p>
<h3 id="_1-3-常见的排序算法" tabindex="-1"> 1.3 常见的排序算法</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/800519b135762278631075369f949b9c.png" alt="image-20220424104112902" loading="lazy"></p>
<h2 id="_2-常见排序算法的实现" tabindex="-1"> 2. 常见排序算法的实现</h2>
<h3 id="_2-1-插入排序" tabindex="-1"> 2.1 插入排序</h3>
<h4 id="_2-1-1-基本思想" tabindex="-1"> 2.1.1 基本思想</h4>
<p>直接插入排序是一种简单的插入排序法，其基本思想是：</p>
<p><strong>把待排序的记录按其关键码值的大小逐个插入到一个已经排好序的有序序列中，直到所有的记录插入完为止，得到一个新的有序序列 。</strong></p>
<p>简单来说就是：有一个有序区间，插入一个数据，依旧保持它有序。</p>
<h4 id="_2-1-2直接插入排序" tabindex="-1"> 2.1.2直接插入排序</h4>
<p><strong>当插入第i(i&gt;=1)个元素时，前面的array[0],array[1],…,array[i-1]已经排好序，此时用array[i]的排序码与 array[i-1],array[i-2],…的排序码顺序进行比较，找到插入位置即将array[i]插入，原来位置上的元素顺序后移。</strong></p>
<p>动图展示：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/627d7b9813a49e036cd717b3d60b50d0.gif" alt="20210223174254141" loading="lazy"></p>
<p>代码实现：（此处排的是升序）</p>
<div><pre><code>void InsertSort(int *a,int n)
{
	for (int i = 0; i &lt; n-1;i++)//end:[0:n-2]  end+1:[1:n-1]
	{
		int end = i;
		//[0,end]有序 把[end+1]插入进去，保持它依旧有序
		int tmp = a[end + 1];
		while (end &gt;= 0)
		{
			if (tmp &lt; a[end])//降序就是把 &lt; 变为 &gt; 
			{
				a[end + 1] = a[end];
				--end;
			}
			else
			{
				break;
			}
		}
		a[end + 1] = tmp;
		//此处有两种情况，第一种就是数据到了应该插入的位置（非a[0]），另一种就是数据要插入到a[0]的位置
	}
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><blockquote>
<p>直接插入排序的特性总结：</p>
<ol>
<li>元素集合越接近有序，直接插入排序算法的时间效率越高</li>
<li>时间复杂度：O(N^2) 最坏的情况（逆序）：1 + 2 + ······ + N 时间复杂度：O(N2) 最好：（有序）O(N)</li>
<li>空间复杂度：O(1)，它是一种稳定的排序算法</li>
<li>稳定性：稳定</li>
</ol>
</blockquote>
<h4 id="_2-1-3-希尔排序" tabindex="-1"> 2.1.3 希尔排序</h4>
<blockquote>
<p>希尔排序（ShellSort）又称为“缩小增量排序”。是1959年由D.L.Shell提出来的。该方法的基本思想是：<strong>先将整个待排元素序列分割成若干个子序列（由相隔某个“增量”的元素组成的）分别进行直接插入排序，然后依次缩减增量再进行排序，待整个序列中的元素基本有序（增量足够小）时，再对全体元素进行一次直接插入排序</strong>。因为直接插入排序在元素基本有序的情况下（接近最好情况），效率是很高的，因此希尔排序在时间效率上比前两种方法有较大提高。</p>
</blockquote>
<p>具体做法：首先确定一组增量d0，d1，d2，d3，…,dt-1()其中n&gt;d0&gt;d1&gt;…&gt;dt-1=1),对于i=0,1,2,…,t-1,依次进行下面的各趟处理:根据当前增量di将n个元素分成di个组,每组中元素的下标相隔为di;再对各组中元素进行直接插入排序.</p>
<p>动图展示：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/76f44ea58c9e4af381670fe28e1ce217.gif" alt="v2-f9616f6892819e579a2d4ab10256a732_b" loading="lazy"></p>
<p>1、<strong>预排序：大的数更快的到后面去，小的数更快的到前面去，尽可能地接近有序。</strong></p>
<p>举例：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/78da1877163e9f0987a1f73d42667a0f.png" alt="image-20220417091054918" loading="lazy"></p>
<p>gap为几，就将数字划分为几组数据，然后分别对这几组数据进行插入排序，例如在上面地例子中，首先对9、5、8、5进行插入排序，然后对1、7、4进行插入排序，然后再对2、6、3进行插入排序。这就是预排序。</p>
<blockquote>
<p>问：gap的大小和预排序后的数据有什么关系？</p>
<p>答：如果gap越小，数据跳跃越慢，但是预排序后的数据就越接近有序；如果gap越大，大的数据可以更快的到达最后，小的数据可以更快的到达前面，但它越不接近有序，只能说是相对有序。</p>
</blockquote>
<blockquote>
<p>问：希尔排序就一定比直接插入排序快吗？</p>
<p>答：不一定，当所给数组本来就是升序或者接近升序的时候，进行的预排序就相当于是无用功，相当于是白做的，此时的效率就不如直接插入排序了。当然，这种情况是很少的，一般所给的数据都是乱序或者接近逆序的，所以这种情况一般不去考虑。</p>
</blockquote>
<p>2、<strong>直接插入排序</strong></p>
<p><strong>直接插入排序就是gap为1时候的排序，就是直接插入排序，由于此时地数据已经接近有序，所以插入排序起来更为容易。</strong></p>
<blockquote>
<p>问：插入排序的效率在哪体现呢？</p>
<p>答：在间隔gap个数据进行插入排序时，相当于一次跨越gap个数据进行移动，这样从本质上来看相对于直接插入排序节省了很多次循环所花费的时间，下面举个例子来看：</p>
</blockquote>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/3660714e7c614d97bbee9b2d7f7c2352.png" alt="image-20220417092754508" loading="lazy"></p>
<blockquote>
<p>在经过一次gap为3的插入排序后，较小的三个数字3、2、1已经排到了最前面，中间的三个数字6、5、4已经到了中间，较大的三个数字9、8、7已经到了最后，这样我们在进行直接插入排序的时候，1只需要移动两次就能到达最前面，而如果没有进行gap为3的那次预排序的话，1需要移动8次进行8次循环才能到达它需要到达的位置，这就是希尔排序提高的效率所在。</p>
</blockquote>
<p>代码：</p>
<div><pre><code>//希尔排序:传统写法
void ShellSort(int* a, int n)
{
	int gap = n;
	while (gap &gt; 1)//这个地方不能是&gt;=1，因为经过后面的控制后，gap始终大于1，如果是&gt;=1，就会陷入死循环
	{
		gap = gap / 3 + 1;//保证最后一次一定是1，即最后有一次直接插入排序
		for (int k = 0; k &lt; gap; k++)
		{
			for (int i = k; i &lt; n - gap; i += gap)//为什么是n - gap?因为最后一个end是n-1-gap,end+gap一定小于n
			{
				int end = i;
				int tmp = a[end + gap];
				while (end &gt;= 0)
				{
					if (tmp &lt; a[end])
					{
						a[end + gap] = a[end];
						end -= gap;
					}
					else
						break;
				}
				a[end + gap] = tmp;
			}
		}
	}
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>下面是希尔排序的优化写法：</p>
<p><strong>将四层循环变为3层循环，当然，效率并没有提升，只是将代码的循环层数减少了一层，两者时间复杂度其实并没有太大的区别</strong></p>
<div><pre><code>//希尔排序：优化写法
void ShellSort(int* a, int n)
{
	int gap = n;
	while (gap &gt; 1)//这个地方不能是&gt;=1，因为经过后面的控制后，gap始终大于1，如果是&gt;=1，就会陷入死循环
	{
		gap =gap/3 + 1;//保证最后一次一定是1，即最后有一次直接插入排序
		for (int i = 0; i &lt; n - gap; ++i)//为什么是n - gap?因为最后一个end是n-1-gap,end+gap一定小于n
		{
			int end = i;
			int tmp = a[end + gap];
			while (end &gt;= 0)
			{
				if (tmp &lt; a[end])
				{
					a[end + gap] = a[end];
					end -= gap;
				}
				else
					break;
			}
			a[end + gap] = tmp;
		}
	}
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>希尔排序的特性总结：</p>
<blockquote>
<ol>
<li>
<p>希尔排序是对直接插入排序的优化。</p>
</li>
<li>
<p>当gap &gt; 1时都是预排序，目的是让数组更接近于有序。当gap == 1时，数组已经接近有序的了，这样就 会很快。这样整体而言，可以达到优化的效果。我们实现后可以进行性能测试的对比。</p>
</li>
<li>
<p>希尔排序的时间复杂度不好计算，因为gap的取值方法很多，导致很难去计算，因此在好些书中给出的 希尔排序的时间复杂度都不固定：</p>
<p>《数据结构(C语言版)》— 严蔚敏</p>
</li>
</ol>
</blockquote>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/5b8e5ee2709631acece6763009ed51c5.png" alt="image-20220417104317401" loading="lazy"></p>
<blockquote>
<p>《数据结构-用面相对象方法与C++描述》— 殷人昆</p>
</blockquote>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/11267f038cd6ddce4e0cfcd02e5a9a0b.png" alt="image-20220417104337855" loading="lazy"></p>
<blockquote>
<p>因为我们的gap是按照Knuth提出的方式取值的，而且Knuth进行了大量的实验统计，我们就暂时按照：==O(n1.25)到O(1.6*n1.25)==来算</p>
<ol start="4">
<li>稳定性：不稳定</li>
</ol>
</blockquote>
<blockquote>
<p>如果我们自己算希尔排序的时间复杂度的话：</p>
<p><strong>预排序</strong>：</p>
<p>gap很大时，数据跳的很快，差不多是O(N)，内层循环几乎忽略不计，跳跃的很快（每次跳跃gap次）。</p>
<p>gap很小时，数据很接近有序，几乎不需要挪动，此时差不多也是O(N)。</p>
<p><strong>最外层循环：</strong></p>
<p>总共循环log3N次</p>
<p>所以我们粗略进行计算的时候时间复杂度：O(N*log3N)</p>
</blockquote>
<h3 id="_2-2-选择排序" tabindex="-1"> 2.2 选择排序</h3>
<h4 id="_2-2-1-基本思想" tabindex="-1"> 2.2.1 基本思想</h4>
<p>每一次从待排序的数据元素中选出最小（或最大）的一个元素，存放在序列的起始位置，直到全部待排序的数据元素排完 。</p>
<h4 id="_2-2-2-直接选择排序" tabindex="-1"> 2.2.2 直接选择排序</h4>
<ul>
<li>在元素集合array[i]–array[n-1]中选择关键码最大(小)的数据元素</li>
<li>若它不是这组元素中的最后一个(第一个)元素，则将它与这组元素中的最后一个（第一个）元素交换</li>
<li>在剩余的array[i]–array[n-2]（array[i+1]–array[n-1]）集合中，重复上述步骤，直到集合剩余1个元素</li>
</ul>
<p>动态图：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/a2c7cbf6ea0c17a87a4b0831d7c60cec.gif" alt="SEL" loading="lazy"></p>
<blockquote>
<p>直接选择排序的特性总结：</p>
<ol>
<li>直接选择排序思考非常好理解，但是效率不是很好。实际中很少使用</li>
<li>时间复杂度：O(N^2)</li>
<li>空间复杂度：O(1)</li>
<li>稳定性：不稳定</li>
</ol>
</blockquote>
<p>选择排序代码实现：</p>
<div><pre><code>void SelectSort(int* a, int n)
{
	
	int left = 0;
	int right = n - 1;
	while (left &lt; right)
	{
		int maxi = left;
		int mini = left;
        //下面为什么是左开右闭区间？因为maxi和mini已经假设left是最小或者最大的数了，所以不必再包含left了，但是rightb
		for (int i = left + 1; i &lt;= right; i++)
		{
			if (a[i] &lt; a[mini])
			{
				mini = i;
			}
			if (a[i] &gt; a[maxi])
			{
				maxi = i;
			}
		}
		Swap(&amp;a[left], &amp;a[mini]);
		//如果left和maxi重叠，在将mini和left交换之后，mini此时就等于maxi
		if (left == maxi)
		{
			maxi = mini;
		}
		Swap(&amp;a[right], &amp;a[maxi]);
		left++;
		right--;
	}
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_2-2-3-堆排序" tabindex="-1"> 2.2.3 堆排序</h4>
<p>堆排序(Heapsort)是指利用堆积树（堆）这种数据结构所设计的一种排序算法，它是选择排序的一种。它是 通过堆来进行选择数据。需要注意的是排升序要建大堆，排降序建小堆。</p>
<h3 id="_2-3-交换排序" tabindex="-1"> 2.3 交换排序</h3>
<blockquote>
<p>基本思想：所谓交换，就是根据序列中两个记录键值的比较结果来对换这两个记录在序列中的位置，交换排序的特点是：将键值较大的记录向序列的尾部移动，键值较小的记录向序列的前部移动。</p>
</blockquote>
<h4 id="_2-3-1冒泡排序" tabindex="-1"> 2.3.1冒泡排序</h4>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/8b8b46206ecca895870276ca5149d2c1.gif" alt="1145616330" loading="lazy"></p>
<p>代码：</p>
<div><pre><code>void BubbleSort(int* a, int n)
{
	for (int i = 0; i &lt; n; i++)
	{
        int exange = 0;
		for (int j = 0; j &lt; n - i - 1; j++)
		{
			if (a[j] &gt; a[j + 1])
			{
				Swap(&amp;a[j], &amp;a[j + 1]);
                exange = 1;
			}
		}
        if(exange == 0)//当有序的时候直接退出
            break;
	}
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>冒泡排序的特性总结：</p>
<p>1.冒泡排序是一种非常容易理解的排序</p>
<p>2.时间复杂度：O(N^2) 最好情况：顺序有序：O(N)（最少得执行一次内层循环）</p>
<p>3.空间复杂度：O(1)</p>
<p>4.稳定性：稳定</p>
<h4 id="冒泡排序与插入排序的比较" tabindex="-1"> 冒泡排序与插入排序的比较</h4>
<p>相比之下，插入排序会更好一些，例如下面的这种情况：</p>
<div><pre><code>1 2 3 4 5 6 8 7
</code></pre><div aria-hidden="true"><div></div></div></div><p>这种情况下插入排序要比较8此，但是冒泡排序要比较7 + 6 = 13次。当然。此时的时间复杂度都是O(N)。</p>
<p>但是在局部有序的情况下：</p>
<div><pre><code>3 4 2 8 7 9 5 9
</code></pre><div aria-hidden="true"><div></div></div></div><p>冒泡排序的优化基本不会体现出什么价值，但是插入排序却能充分利用局部有序的情况，使比较次数减少。</p>
<p><strong>总结：如果是顺序有序的情况，那么插入和冒泡是一样的；但是如果是局部有序，或者接近有序，那么插入的适应性更好，比较次数更少。</strong></p>
<h3 id="_2-3-2-快速排序" tabindex="-1"> 2.3.2 快速排序</h3>
<h4 id="_2-3-2-1-快速排序的代码实现-三种思路" tabindex="-1"> 2.3.2.1 快速排序的代码实现（三种思路）</h4>
<p>快速排序是Hoare于1962年提出的一种二叉树结构的交换排序方法，其基本思想为：<strong>任取待排序元素序列中的某元素作为基准值，按照该排序码将待排序集合分割成两子序列，左子序列中所有元素均小于基准值，右子序列中所有元素均大于基准值，然后最左右子序列重复该过程，直到所有元素都排列在相应位置上为止</strong>。</p>
<div><pre><code>// 假设按照升序对array数组中[left, right)区间中的元素进行排序
void QuickSort(int array[], int left, int right)
{
	if (right - left &lt;= 1)
		return;

	// 按照基准值对array数组的 [left, right)区间中的元素进行划分
	int div = partion(array, left, right);

	// 划分成功后以div为边界形成了左右两部分 [left, div) 和 [div+1, right)
	// 递归排[left, div)
	QuickSort(array, left, div);

	// 递归排[div+1, right)
	QuickSort(array, div + 1, right);
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>上述为快速排序递归实现的主框架，发现与二叉树前序遍历规则非常像，我们在写递归框架时可想想二叉树前序遍历规则即可快速写出来，后续只需分析如何按照基准值来对区间中数据进行划分的方式即可。</p>
<p>将区间按照基准值划分为左右两半部分的常见方式有：</p>
<ol>
<li>
<p><strong>hoare版本</strong></p>
<p>单趟排序：选出一个key，一般是第一个数或者最后一个数</p>
<p>要求：左边的值都比key要小，右边的值都比key要大。</p>
<p>动图展示：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/e2ef543195516b5ef4c44adc5eabce70.gif" alt="hoare" loading="lazy"></p>
<p>图像展示：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20fadbe0e8794591ce048476c67ef15a.png" alt="image-20220417161341875" loading="lazy"></p>
<p>总结：R找比key小的值，L找比key大的值，找到后交换，再重复上述过程，相遇之后，把相遇位置的值跟key交换。</p>
<p>问：当数字数目为偶数的时候，是否会出现不相遇的情况或者如何保证相遇位置的值一定比key小呢？</p>
<p>答：不会，因为R总是先于L移动，总会找到一个比key小的位置，即使L的后面不是一个小于key的数字，此时的R也会到达L所处的位置，因为之前经过交换，此时一定是一个比key小的数字。简单来收就是只有两种情况：R去碰L，或者L去碰R，无论哪一种，两者相遇的地方都是一个比key小的位置。</p>
<p>问：如果右边作key，那么第一轮排序后会变成什么样子的？</p>
<p>答：第一轮排序后如图所示：
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/b5d1140514dca8c0ff1931e554984ee9.png" alt="image-20220417170238685" loading="lazy"></p>
<p>此时要注意必须让左边先走，为了保证相遇点一定是一个比key大的数据。</p>
<p>快速排序单趟排序写法思路：</p>
<p>初始代码：</p>
<div><pre><code>int PartSort(int *a,int left,int right)//快速排序单趟排序
{
	int keyi = left;
	while (left &lt; right)
	{
		//右边找小
		while (a[right] &gt; a[keyi])
		{
			right--;
		}
		//左边找大
		while (a[left] &lt; a[keyi])
		{
			left++;
		}
        Swap(&amp;a[left], &amp;a[right]);
	}
    Swap(&amp;a[keyi], &amp;a[left]);
    return left;//返回相遇的位置
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
</ol>
<p>很明显，上面的代码并不完善，无法处理两种情况，即下面的两种情况：</p>
<p><code>1 2 3 4 5</code></p>
<p><code>5 5 2 3 5</code>在这种情况下就会陷入死循环，因为5不大于5，right始终无法进行–操作，left也同样无法进行++操作，此时就会陷入死循环。</p>
<p>此时进行优化，在相等的时候也要进行–操作：</p>
<div><pre><code>   int PartSort(int *a,int left,int right)//快速排序单趟排序
   {
   	int keyi = left;
   	while (left &lt; right)
   	{
   		//右边找小
   		while (a[right] &gt;= a[keyi])
   		{
   			right--;
   		}
   		//左边找大
   		while (a[left] &lt;= a[keyi])
   		{
   			left++;
   		}
           Swap(&amp;a[left], &amp;a[right]);
   	}
       Swap(&amp;a[keyi], &amp;a[left]);
       return left;//返回相遇的位置
   }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>此时又出现了新的问题：如果right找不到比key小的，就会出现越界的风险，所以在进行<code>a[right]&gt;=a[keyi]</code>条件判断的前面还要加上一个条件，下面是代码的进一步优化：（最终版）</p>
<div><pre><code>int PartSort(int *a,int left,int right)//快速排序单趟排序
{
	int keyi = left;
	while (left &lt; right)
	{
		//右边找小
		while (left&lt;right &amp;&amp; a[right] &gt;= a[keyi])
		{
			right--;
		}
		//左边找大
		while (left &lt; right &amp;&amp; a[left] &lt;= a[keyi])
		{
			left++;
		}
        Swap(&amp;a[left], &amp;a[right]);
	}
    Swap(&amp;a[keyi], &amp;a[left]);
    return left;//返回相遇的位置
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>此时进行接下来的分析及操作：</p>
<p><strong>此时keyi所在的数据就不需要再进行移动了，已经放在了正确的位置。如果keyi的左边有序，右边再有序，那么整体就是有序的</strong>。此时就需要运用分治的思想，此时分别对右边进行单趟排序的递归，直到所有数据都有序，然后重复上面的数据，直到只有一个数据时为止，此时退出递归，整体就是有序的。</p>
<p><strong>快速排序主函数代码：</strong></p>
<div><pre><code>   void QuickSort(int* a,int begin,int end)
{
   	//当出现错位或者二者相等的时候就停止
   	if (begin &gt;= end)
   		return;
   
   	int keyi = PartSort(a, begin, end);
   	//分割出了两个子区间：[begin,keyi-1]keyi[keyi+1,end]
   	QuickSort(a, begin, keyi - 1);
   	QuickSort(a, keyi+1, end);
   }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><blockquote>
<p><strong>问：return的条件判断为什么是<code>begin &gt;= end</code>？而不能只是一个==呢？</strong></p>
<p><strong>答：比如当进入这个函数时，begin = 0，end = 2，keyi = 1，此时就会出现两个区间，就是[0,0]和[2,1]，如果只是相等的话，判断前面的条件自然没有什么问题，但是判断后面的不存在的区间时就不行了。</strong></p>
</blockquote>
<ol start="2">
<li>
<p>挖坑法</p>
<p>动图展示：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2ffc140a0e4bf8d13f559eb0fbe6345a.gif" alt="挖坑法" loading="lazy"></p>
<p>代码：</p>
<div><pre><code>int PartSort2(int* a, int left, int right)
{
	int key = a[left];
	int hole = left;//记录坑的下标
	while (left &lt; right)
	{
		while (left&lt;right&amp;&amp; a[right] &gt;= key)//从右边找小于key的
		{
			right--;
		}
		a[hole] = a[right];//把找到的值放到坑位上去
		hole = right;//形成新的坑
		while (left&lt;right&amp;&amp;a[left] &lt;= key)//从左边找大于key的
		{
			left++;
		}
		a[hole] = a[left];//把找到的值放到坑位上去
		hole = left;//形成新的坑
	}
	a[left] = key;//将key放到相遇的位置上去（相遇的位置一定是坑）
	return left;//返回相遇位置的下标
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><blockquote>
<p><strong>问：挖坑法和hoare有什么区别吗？两个的效率是否一样？挖坑法是否就一定比hoare方法好呢？</strong></p>
<p><strong>答：挖坑法和hoare方法没有本质的区别，两个的时间复杂度也都是一样的，不存在谁优谁劣的问题，两者的好坏并没有严格的限定，挖坑法相对hoare方法来说，更容易理解，hoare方法过于抽象，有些不太好理解。需要注意的是：在使用两种方法经过第一轮排序后形成的结果并不一定是相同的，或者说二者大多数情况下都是不相同的，只有少数情况下才是相同的。</strong></p>
</blockquote>
</li>
<li>
<p>前后指针法</p>
<p>动图展示：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/6a192f147c7020e2f75021611f0eadfc.gif" alt="前后指针" loading="lazy"></p>
<p>代码：</p>
<div><pre><code>//left作keyi
int PartSort3(int* a, int left, int right)
{
	int keyi = left;
	int prev = left;
	int cur = left + 1;
	while (cur &lt;= right)
	{
		//下面这一行代码的作用：当cur遇到比a[keyi]小的值后++prev，并且防止自己跟自己进行交换
		if (a[cur] &lt; a[keyi] &amp;&amp; a[++prev]!= a[cur])
			Swap(&amp;a[cur], &amp;a[prev]);

		cur++;
	}
	Swap(&amp;a[prev], &amp;a[keyi]);//将a[prev]和a[keyi]进行交换
	return prev;
}
//right作keyi
int PartSort3(int* a, int left, int right)
{
	int keyi = right;
	int cur = left;
	int prev = left - 1;
	while (cur&lt;right)
	{
		if (a[cur] &lt; a[keyi] &amp;&amp; a[++prev] != a[cur])
		{
			Swap(&amp;a[cur], &amp;a[prev]);
		}
		cur++;
	}
	Swap(&amp;a[++prev], &amp;a[keyi]);
	return prev;
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><blockquote>
<p><strong>prev和cur的关系：</strong></p>
<p><strong>1、cur还没遇到比key大的值时，prev紧跟着cur，一前一后。</strong></p>
<p><strong>2、cur遇到比key大的值时，prev和cur之间间隔着一段比key大的值的区间。</strong></p>
</blockquote>
</li>
</ol>
<h4 id="_2-3-2-2-时间复杂度" tabindex="-1"> 2.3.2.2 时间复杂度</h4>
<p>快速排序的时间复杂度：</p>
<p>最好情况：每次选的都是中位数O(N*log2N)</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/822e6a187d4fc340de2346382edcff5e.png" alt="image-20220419170635866" loading="lazy"></p>
<p>最坏情况：每次选的key是最小的或最大的O(N2)</p>
<h4 id="_2-3-2-3-快速排序的优化" tabindex="-1"> 2.3.2.3 快速排序的优化</h4>
<p><strong>1.随机选key</strong></p>
<p><strong>2.三数选中</strong></p>
<div><pre><code>int GetMidIndex(int*a,int  left,int  right)
{
	int mid = left + (right- left) / 2;
	if (a[left] &lt; a[mid])// left mid
	{
		if (a[mid] &lt; a[right])//left mid right
		{
			return mid;
		}
		else if (a[left] &gt; a[right])//right left mid
		{
			return left;
		}
		else//left right mid
		{
			return right;
		}
	}
	else//mid   left
	{
		if (a[right] &gt; a[left])//mid left right
		{
			return left;
		}
		else if (a[mid] &lt; a[right])//mid right left
		{
			return right;
		}
		else//right mid left
		{
			return mid;
		}
	}
}

//left作keyi
int PartSort3(int* a, int left, int right)
{
	int midi = GetMidIndex(a, left, right);
    Swap(&amp;a[midi], &amp;a[left]);
	int keyi = left;
	int prev = left;
	int cur = left + 1;
	while (cur &lt;= right)
	{
		//下面这一行代码的作用：当cur遇到比a[keyi]小的值后++prev，并且防止自己跟自己进行交换
		if (a[cur] &lt; a[keyi] &amp;&amp; a[++prev]!= a[cur])
			Swap(&amp;a[cur], &amp;a[prev]);

		cur++;
	}
	Swap(&amp;a[prev], &amp;a[keyi]);//将a[prev]和a[keyi]进行交换
	return prev;
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>注意：三数取中法依然无法完全解决针对某种特殊情况序列复杂度变为O(n2)的情况。</p>
<p>3.小区间优化</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1a67e55fa6d320383e8a72b03a386d1f.png" alt="image-20220419192053842" loading="lazy"></p>
<p><strong>快排递归调用就是展开简化图就是一个二叉树，我们从上图中可以看到，快速排序的主要花销在数据比较少的时候，就是begin和end之间的数比较少或者begin和end相等的时候，这个时候的递归次数相当多，我们可以在数字比较少的时候去调用其它的排序函数，以此来达到优化开快排的目的。</strong></p>
<p>简而言之：区间很小时，不再使用递归划分的思路让它有序，而是直接使用插入排序对小区间排序，减少递归调用。</p>
<p>代码：</p>
<div><pre><code>void QuickSort(int* a,int begin,int end)
{
	//当出现错位或者二者相等的时候就停止
	if (begin &gt;= end)
		return;
	
	//小区间直接使用插入排序控制有序
	if (end - begin &lt;= 10)
	{
		InsertSort(a + begin, end - begin + 1);
	}
	int keyi = PartSort3(a, begin, end);
	//分割出了两个子区间：[begin,keyi-1]keyi[keyi+1,end]
	QuickSort(a, begin, keyi - 1);
	QuickSort(a, keyi+1, end);
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_2-3-2-3-快速排序非递归" tabindex="-1"> 2.3.2.3 快速排序非递归</h4>
<p>两种思路进行实现：</p>
<h5 id="_2-3-2-3-1-栈模拟递归实现" tabindex="-1"> 2.3.2.3.1 栈模拟递归实现</h5>
<p>思路：</p>
<p><strong>将需要使用到的下标放到栈上临时存储（为什么只存下标？因为PartSort()函数只需要用到函数名和下标），然后使用栈的性质，每当拿出一对下标时，将得到的新下标依次压入栈中，这样，始终都是先对右边的下标进行排序，模拟了递归的性质。</strong></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/079858f522d812594312eab72b433dcb.png" alt="image-20220422195516422" loading="lazy"></p>
<p>代码实现：</p>
<div><pre><code>//快速排序的非递归形式1：通过栈来实现
void QuickSort3(int* a, int begin, int end)
{
	ST st;
	StackInit(&amp;st);
	StackPush(&amp;st, begin);
	StackPush(&amp;st, end);
	while (!StackEmpty(&amp;st))
	{
		int end = StackTop(&amp;st);
		StackPop(&amp;st);
		int begin = StackTop(&amp;st);
		StackPop(&amp;st);
		int keyi = PartSort(a, begin, end);
		//[begin , keyi - 1] [keyi+1,end]
		if (begin &lt; keyi - 1)
		{
			StackPush(&amp;st, begin);
			StackPush(&amp;st, keyi - 1);
		}
		if (keyi + 1 &lt; end)
		{
			StackPush(&amp;st, keyi + 1);
			StackPush(&amp;st, end);
		}
	}
	StackDestory(&amp;st);
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h5 id="_2-2-2-3-2-队列模拟二叉树遍历实现" tabindex="-1"> 2.2.2.3.2 队列模拟二叉树遍历实现</h5>
<p>思路：</p>
<p>将需要使用到的下标放到队列中来进行临时存储，每次从队列中拿出一对下标时，又将新形成的下标放入到队列中去，直到队列为空时停止。</p>
<p>图示：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/f0c813bb9c8eccf06e81e5e78dddb445.png" alt="image-20220422204533821" loading="lazy"></p>
<p>代码：</p>
<div><pre><code>//快速排序的非递归形式1：通过队列来实现
void QuickSort3(int* a, int begin, int end)
{
	Queue q;
	QueueInit(&amp;q);
	QueuePush(&amp;q, begin);
	QueuePush(&amp;q, end);
	while (!QueueEmpty(&amp;q))
	{
		int left = QueueFront(&amp;q);
		QueuePop(&amp;q);
		int right = QueueFront(&amp;q);
		QueuePop(&amp;q);
		int keyi = PartSort(a, left, end);//[left,keyi-1][keyi+1,right]
		if (left &lt; keyi - 1)
		{
			QueuePush(&amp;q, left);
			QueuePush(&amp;q, keyi - 1);
		}
		if (keyi + 1 &lt; right)
		{
			QueuePush(&amp;q, keyi + 1);
			QueuePush(&amp;q, right);
		}
	}
	QueueDestory(&amp;q);
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_2-4-归并排序" tabindex="-1"> 2.4 归并排序</h3>
<h4 id="_2-4-1-基本思想" tabindex="-1"> 2.4.1 基本思想</h4>
<p><strong>归并排序（MERGE-SORT）是建立在归并操作上的一种有效的排序算法,该算法是采用分治法（Divide and Conquer）的一个非常典型的应用。将已有序的子序列合并，得到完全有序的序列；即先使每个子序列有 序，再使子序列段间有序。若将两个有序表合并成一个有序表，称为二路归并。 归并排序</strong></p>
<p>核心步骤：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/409b11fc280352b94999019532a04a6b.png" alt="image-20220422210059119" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/982cc6fad502de29d4af238100569cdf.gif" alt="查看源图像" loading="lazy"></p>
<h4 id="_2-4-2-归并排序的实现" tabindex="-1"> 2.4.2 归并排序的实现</h4>
<h5 id="_2-4-2-1-方法一-递归版" tabindex="-1"> 2.4.2.1 方法一：递归版</h5>
<p>分解思路：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/c82035cdcc62be64dedd60a1668eddec.png" alt="image-20220423161317000" loading="lazy"></p>
<p>归并思路：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/4ac55bc76b4845fd6ccfeeca35191d92.png" alt="image-20220423162141519" loading="lazy"></p>
<p>代码：</p>
<div><pre><code>//归并排序
void _MergeSort(int* a, int begin, int end,int*tmp)//辅助函数
{
	if (begin &gt;= end)
	{
		return;
	}
	int mid = (begin + end) / 2;
	//[begin,mid][mid+1,end]
	_MergeSort(a, begin, mid, tmp);
	_MergeSort(a, mid + 1, end, tmp);
	//此处必须这样划分区间，如果划分为[begin,mid-1][mid,end]时就会出现死循环的现象,比如[1,2]
	//归并
	int begin1 = begin, end1 = mid;//begin1和end1用来控制第一个区间
	int begin2 = mid + 1, end2 = end;//begin2和end2用来控制第二个区间
	int index = begin;//下标每次都从begin位置开始
	while (begin1 &lt;= end1 &amp;&amp; begin2 &lt;= end2)//当两个区间有一个区间到达最后时就停止
	{
		if (a[begin1] &lt; a[begin2])
		{
			tmp[index++] = a[begin1++];
		}
		else
		{
			tmp[index++] = a[begin2++];
		}
	}
	while (begin1 &lt;= end1)//如果第一个区间没有结束就从第一个区间继续挪动数据
	{
		tmp[index++] = a[begin1++];
	}
	while (begin2 &lt;= end2)//如果第二个区间没有结束就从第二个区间继续把挪动数据
	{
		tmp[index++] = a[begin2++];
	}
	memcpy(a+begin, tmp+begin, (end - begin + 1) * sizeof(int));//运用内存拷贝函数
}
void MergeSort(int* a,int n)
{
	int* tmp = (int*)malloc(sizeof(int) * n);//开辟临时数组空间
	assert(tmp);//防止开辟失败
	_MergeSort(a, 0, n - 1,tmp);
	free(tmp);
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h5 id="_2-4-2-2-方法二-非递归版" tabindex="-1"> 2.4.2.2 方法二：非递归版</h5>
<p>第一个版本：</p>
<div><pre><code>void MergeSort(int* a, int n)
{
	int* tmp = (int*)malloc(sizeof(int) * n);
	assert(tmp);
	int gap = 1;
	while (gap&lt;n)
	{
		for (int i = 0;i&lt;n;i+=2*gap)//为什么在gap前面有一个2，因为是两组数据进行归并
		{
			int begin1 = i, end1 = i + gap - 1;
			int begin2 = i+gap, end2 = i + 2 * gap - 1;
			int index = i;
            //printf(&quot;[%d,%d] [%d,%d]\n&quot;, begin1 , end1 , begin2 , end2);
			while (begin1 &lt;= end1 &amp;&amp; begin2 &lt;= end2)
			{
				if (a[begin1] &lt; a[begin2])
				{
					tmp[index++] = a[begin1++];
				}
				else
				{
					tmp[index++] = a[begin2++];
				}
			}
			while (begin1 &lt;= end1)
			{
				tmp[index++] = a[begin1++];
			}
			while (begin2 &lt;= end2)
			{
				tmp[index++] = a[begin2++];
			}
		}
		memcpy(a, tmp, n*sizeof(int));
		gap *= 2;
	}
	free(tmp);
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>上面的代码经过打印，在测试非2的幂次方个数目的数组时程序就会出现问题，例如当我们测试10个数时看一下打印的下标：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2f5e6483ad4313ba5adaedf519b4a551.png" alt="image-20220423185520974" loading="lazy"></p>
<p>发生了越界（总共有10个数字，下标最大为9，所以程序出现了问题）</p>
<p>下面将进行一次修正，将越界的下标数字强制修改为n-1，修正部分的代码如下所示：</p>
<div><pre><code>if (end1 &gt;= n)
{
	end1 = n - 1;
}
if (begin2 &gt;= n)
{
	begin2 = n - 1;
}
if (end2 &gt;= n)
{
	end2 = n - 1;
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>修正后打印结果为：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/0c096d16fb242c92fbe5abb24b518524.png" alt="image-20220423190011161" loading="lazy"></p>
<p><strong>此时程序依旧不对，为什么？因为index会发生越界，当下标为[8,9]和[9,9]的时候，程序会在<code>while(begin1 &lt;= end1 &amp;&amp; begin2 &lt;= end2)</code>这个位置进入循环两次，然后此时index会变成10（最开始的index为8），然后后面因为<code>begin2==end2</code>会再次进入循环，此时的index就会出现越界访问的现象。</strong></p>
<p>此处进行分析：如果end1越界，我们是可以修正的，如果end2越界，begin2没有越界，我们也是可以修正end2的，如果begin2越界了，那么第二个区间就会直接不存在，此时需要再对上面的代码进行修改。</p>
<div><pre><code>if (end1 &gt;= n)
{
	end1 = n - 1;
}
if (begin2 &gt;= n)
{
	begin2 = n;
    end2 = n - 1;
}
if (end2 &gt;= n)
{
	end2 = n - 1;
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>修改的部分就是：如果begin2越界，直接让[begin2,end2]这个区间不存在即可。</p>
<p>完整代码如下所示：</p>
<div><pre><code>void MergeSort(int* a, int n)
{
	int* tmp = (int*)malloc(sizeof(int) * n);
	assert(tmp);
	int gap = 1;
	while (gap&lt;n)
	{
		for (int i = 0;i&lt;n;i+=2*gap)//为什么在gap前面有一个2，因为是两组数据进行归并
		{
			int begin1 = i, end1 = i + gap - 1;
			int begin2 = i+gap, end2 = i + 2 * gap - 1;
			//end1越界
			if (end1 &gt;= n)
			{
				end1 = n - 1;
			}
			//begin2越界
			if (begin2 &gt;= n)
			{
				begin2 = n;
				end2 = n - 1;
			}
			//只有end2越界
			if (end2 &gt;= n)
			{
				end2 = n - 1;
			}
			
			int index = i;
			
			while (begin1 &lt;= end1 &amp;&amp; begin2 &lt;= end2)
			{
				if (a[begin1] &lt; a[begin2])
				{
					tmp[index++] = a[begin1++];
				}
				else
				{
					tmp[index++] = a[begin2++];
				}
			}
			while (begin1 &lt;= end1)
			{
				tmp[index++] = a[begin1++];
			}
			
			while (begin2 &lt;= end2)
			{
				tmp[index++] = a[begin2++];
			}
		}
		memcpy(a, tmp, n*sizeof(int));
		gap *= 2;
	}
	free(tmp);
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_2-4-3-归并排序的外排序" tabindex="-1"> 2.4.3 归并排序的外排序</h4>
<h5 id="_2-4-3-1-归并外排序的思想" tabindex="-1"> 2.4.3.1 归并外排序的思想</h5>
<p><strong>思想：当所要排序的的数据量太多或者文件太大，无法直接在内存里排序，而需要依赖外部设备时，就会使用到外部排序。</strong></p>
<blockquote>
<p>算法描述：</p>
<ol>
<li>将所要排序的文件平均分割成若干个可以加载到内存中的小文件</li>
<li>将每个小文件中的数据加载到内存中，使用快速排序法或者其它排序方法将每个小文件中的数据排成有序</li>
<li>将内存中有序的数据重新写回到文件中，此时达到了文件中归并的先决条件</li>
</ol>
</blockquote>
<ol>
<li>
<p>归并思路如下图所示：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/fd64f57d8edc5f293c35abcfd1fff68f.png" alt="image-20220425150548589" loading="lazy"></p>
<p>上图中的(1)和(2)和(3)和(4)分别是第一次归并、第二次归并、第三次归并和第四次归并，后面的没有再列举出来。</p>
<p>注意：实际中的归并思路有很多种，并不是只有这一种，此处把这个思路列举出来只是为了后面的应用举例。</p>
</li>
</ol>
<h4 id="_2-4-3-2-归并外排序的实现" tabindex="-1"> 2.4.3.2 归并外排序的实现</h4>
<p>归并排序外排序函数代码：</p>
<div><pre><code>//归并排序的文件排序
//file1和file2是要被归并的文件，mfile是存放归并后的数据的文件
void _MergeFile(const char*file1, const char*file2,const char* mfile)
{
    //将三个文件打开
	FILE* fout1 = fopen(file1, &quot;r&quot;);
	if (fout1 == NULL)
	{
		printf(&quot;打开文件失败！\n&quot;);
		exit(-1);
	}

	FILE* fout2 = fopen(file2, &quot;r&quot;);
	if (fout2 == NULL)
	{
		printf(&quot;打开文件失败！\n&quot;);
		exit(-1);
	}

	FILE* fin = fopen(mfile, &quot;w&quot;);
	if (fin == NULL)
	{
		printf(&quot;打开文件失败！\n&quot;);
		exit(-1);
	}
	//开始归并
	int num1, num2;//存储file1和file2中读取的数据
    //先从文件中读取出一个数据，ret1是为了判断是否读取结束，如果等于EOF就说明已经读取结束
	int ret1 = fscanf(fout1, &quot;%d\n&quot;, &amp;num1);
	int ret2 = fscanf(fout2, &quot;%d\n&quot;, &amp;num2);
    //存放新的数据
	while (ret1!= EOF &amp;&amp; ret2 != EOF)//当有一个文件读取结束时读取就结束
	{
        //此处是因为要排升序，所以将小的数据读入新的文件中
		if (num1 &lt; num2)
		{
			fprintf(fin, &quot;%d\n&quot;, num1);//将小的数据num1读入新的文件中
			ret1 = fscanf(fout1, &quot;%d\n&quot;, &amp;num1);//重新读入新的数据
		}
		else
		{
			fprintf(fin, &quot;%d\n&quot;, num2);//同上
			ret2 = fscanf(fout2, &quot;%d\n&quot;, &amp;num2);
		}
	}
    //如果存在未读取完的文件，将剩余的数据读取到新的文件mfile中
	while (ret1!=EOF)
	{
		fprintf(fin, &quot;%d\n&quot;, num1);
		ret1 = fscanf(fout1, &quot;%d\n&quot;, &amp;num1);
	}
	while (ret2!=EOF)
	{
		fprintf(fin, &quot;%d\n&quot;, num2);
		ret2 = fscanf(fout1, &quot;%d\n&quot;, &amp;num2);
	}
	fclose(fout1);
	fclose(fout2);
	fclose(fin);
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_2-4-3-3-归并外排序使用举例" tabindex="-1"> 2.4.3.3 归并外排序使用举例</h4>
<p>这个例子中有文件file，此文件中总共是有100个数据，我们是要将它分成10组，每组数据有10个数据，每个数据放在一个文件中，文件名从<code>1到10</code>，然后存放新文件的名字最开始是<code>12</code>，表示这个文件要存放文件1和2归并后的数据，同理，后面的123就是存放文件12和3归并后的数据。</p>
<p>代码实现：</p>
<div><pre><code>void MergeSortFile(const char* file)//此处的file是要被排序的文件
{
	FILE* fout = fopen(file, &quot;r&quot;);
	if (fout == NULL)
	{
		printf(&quot;打开文件失败！\n&quot;);
		exit(-1);
	}
	//分割成一段一段数据，内存排序后写到小文件
	int n = 10;
	int a[10];
	int i = 0;
	int num = 0;
	char subfile[20] = { 0 };
	int filei = 1;
	while (fscanf(fout, &quot;%d\n&quot;, &amp;num) != EOF)
	{
		if (i &lt; n-1)//前9个数据进去
		{
			a[i++] = num;
		}
		else
		{
			a[i] = num;//这是第10个数据
			QuickSort(a, 0, n - 1);
			sprintf(subfile, &quot;%d&quot;, filei++);
			FILE* fin = fopen(subfile, &quot;w&quot;);
			if (fin == NULL)
			{
				printf(&quot;打开文件失败\n&quot;);
				exit(-1);
			}
			for (int i = 0; i &lt; n; i++)
			{
				fprintf(fin, &quot;%d\n&quot;, a[i]);
			}
			fclose(fin);
			i = 0;
			memset(a, 0, sizeof(int)*n);
		}
	}
	//利用互相归并到文件，实现整体有序
	//····
	char mfile[100] = &quot;12&quot;;
	char file1[100] = &quot;1&quot;;
	char file2[100] = &quot;2&quot;;
	for (int i = 2; i &lt;= n; i++)
	{
		//读取file1和file2，进行归并出mfile
		_MergeFile(file1, file2, mfile);//将file1和file2进行归并到mfile中	
		strcpy(file1, mfile);//此处将mfile的名字复制给file1
		sprintf(file2, &quot;%d&quot;, i+1);
		sprintf(mfile, &quot;%s%d&quot;, mfile,i + 1);
	}
	fclose(fout);
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_2-4-4-归并排序的特性总结" tabindex="-1"> 2.4.4 归并排序的特性总结</h4>
<ol>
<li>归并的缺点在于需要O(N)的空间复杂度，归并排序的思考更多的是解决在磁盘中的外排序问题。</li>
<li>时间复杂度：O(N*logN)
如何理解归并排序的时间复杂度？
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/57c171c5539166024671fba819d5533b.png" alt="image-20220423205120424" loading="lazy"></li>
<li>空间复杂度：O(N)
注意：实际上应该是O(N + log2N)（N是开辟的数组的空间，log2N是开辟栈帧的层数（递归版本，非递归就没有），log2N太小，可以看成是常数，几乎忽略不计，所以就是O(N)）</li>
<li>稳定性：稳定</li>
</ol>
<h3 id="_2-5-七大排序性能测试比较" tabindex="-1"> 2.5 七大排序性能测试比较</h3>
<h4 id="_2-5-1-测试比较代码" tabindex="-1"> 2.5.1 测试比较代码</h4>
<p>代码：</p>
<div><pre><code>// 测试排序的性能对比
void TestOP()
{
	srand((unsigned)time(0));
	const int N = 100000;
	int* a1 = (int*)malloc(sizeof(int) * N);
	int* a2 = (int*)malloc(sizeof(int) * N);
	int* a3 = (int*)malloc(sizeof(int) * N);
	int* a4 = (int*)malloc(sizeof(int) * N);
	int* a5 = (int*)malloc(sizeof(int) * N);
	int* a6 = (int*)malloc(sizeof(int) * N);
	int* a7 = (int*)malloc(sizeof(int) * N);
	assert(a1);
	assert(a2);
	assert(a3);
	assert(a4);
	assert(a5);
	assert(a6);
	assert(a7);

	for (int i = 0; i&lt;N; i++)
	{
		a1[i] = rand();
		a1[i] = N-i;
		a2[i] = a1[i];
		a3[i] = a1[i];
		a4[i] = a1[i];
		a5[i] = a1[i];
		a6[i] = a1[i];
		a7[i] = a1[i];
	}
	int begin1 = clock();
	InsertSort(a1, N);
	int end1 = clock();
	int begin2 = clock();
	ShellSort(a2, N);
	int end2 = clock();
	int begin3 = clock();
	SelectSort(a3, N);
	int end3 = clock();
	int begin4 = clock();
	HeapSort(a4, N);
	int end4 = clock();
	int begin5 = clock();
	QuickSort(a5, 0, N - 1);
	int end5 = clock();
	int begin6 = clock();
	MergeSort(a6, N);
	int end6 = clock();
	int begin7 = clock();
	BubbleSort(a7, N);
	int end7 = clock();
	printf(&quot;InsertSort:%d\n&quot;, end1 - begin1);
	printf(&quot;ShellSort:%d\n&quot;, end2 - begin2);
	printf(&quot;SelectSort:%d\n&quot;, end3 - begin3);
	printf(&quot;HeapSort:%d\n&quot;, end4 - begin4);
	printf(&quot;QuickSort:%d\n&quot;, end5 - begin5);
	printf(&quot;MergeSort:%d\n&quot;, end6 - begin6);
	printf(&quot;BubbleSort:%d\n&quot;, end7 - begin7);

	free(a1);
	free(a2);
	free(a3);
	free(a4);
	free(a5);
	free(a6);
	free(a7);
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_2-5-2-测试比较结果" tabindex="-1"> 2.5.2 测试比较结果</h4>
<p>注意：在VS2019release版本下进行测试，此时编译器进行了一系列优化。</p>
<p>当N为10000时：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/272d7fcd1c7f55637c2cdbcb574d25f2.png" alt="image-20220423221717247" loading="lazy"></p>
<p>当N为100000时：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/84905c3c406f63c1d0094334b37d5394.png" alt="image-20220423221808048" loading="lazy"></p>
<p>此时继续进行测试快速排序、堆排序、希尔排序、归并排序：</p>
<p>当N为1000000：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/e793df554c6fe4802b1d8760d8b8a427.png" alt="image-20220423221907517" loading="lazy"></p>
<p>当N为10000000：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/45545554598f0000996cfaba74b5f33e.png" alt="image-20220423221948756" loading="lazy"></p>
<p>当N为20000000：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/e466a1ec3265678865ceea33d613a66e.png" alt="image-20220423222352147" loading="lazy"></p>
<h3 id="_2-6-非比较排序" tabindex="-1"> 2.6 非比较排序</h3>
<h4 id="_2-6-1-计数排序" tabindex="-1"> 2.6.1 计数排序</h4>
<h5 id="_2-6-1-1-计数排序的思想" tabindex="-1"> 2.6.1.1 计数排序的思想</h5>
<p>思想：计数排序又称为鸽巢原理，是对哈希直接定址法的变形应用。 操作步骤：</p>
<ol>
<li>统计相同元素出现次数</li>
<li>根据统计的结果将序列回收到原来的序列中</li>
</ol>
<p>图示：
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/8ff0ea2f54b5a345787eb2ac52513ed3.png" alt="image-20220424121029857" loading="lazy"></p>
<p>代码：</p>
<div><pre><code>void CountSort(int* a,int n)
{
	//求出最大值和最小值
	int max = a[0];
	int min = a[0];
	for (int i = 1; i &lt; n; i++)
	{
		if (a[i] &gt; max)
		{
			max = a[i];
		}
		if (a[i] &lt; min)
		{
			min = a[i];
		}
	}
	int size = max - min + 1;//映射表数组的大小
	//建立映射数组
	int* countArray = (int*)calloc(size,sizeof(int));
	assert(countArray);
	//计数
	for (int i = 0; i &lt; n; i++)
	{
		countArray[a[i] - min]++;
	}
	//放回到原来的数组中：排序
	int j = 0;//j用来记录原来数组的下标
	for (int i = 0; i &lt; size; i++)//i用来记录映射表数组元素的小标
	{
		while(countArray[i]--)
		{
			a[j++] = i + min;
		}
	}
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h5 id="_2-6-1-2-计数排序的复杂度" tabindex="-1"> 2.6.1.2 计数排序的复杂度</h5>
<blockquote>
<p>时间复杂度：O(N + range)</p>
<p>空间复杂度：O(range)</p>
</blockquote>
<p><strong>注意：range = max - min +1</strong></p>
<p>说明：计数排序适用于范围集中的数据</p>
<p>注意：计数排序支持负数但是不支持浮点数、字符串等。</p>
<h2 id="_3-排序算法复杂度及稳定性分析" tabindex="-1"> 3.排序算法复杂度及稳定性分析</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/06054fbb0eb0066e3dc1bbb5aff69b55.png" alt="image-20220424150445356" loading="lazy"></p>
<p>稳定性分析：</p>
<p>直接插入排序：稳定。</p>
<p>希尔排序：不稳定。<strong>相同的数可能被分配到不同的gap组中。</strong></p>
<p>选择排序：不稳定。如下图所示：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/e715fdf6491b319305f1d9e11e4a008e.png" alt="image-20220424150957648" loading="lazy"></p>
<p>在上图中，选出最小的数字1，和前面的3交换之后两个3的相对位置就发生了交换，说明选择排序是不稳定的。</p>
<p>堆排序：不稳定。如下图所示：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/7382f7031da7b403a9057df9f74a81d3.png" alt="image-20220424151402859" loading="lazy"></p>
<p>此时是一个大堆，我们想要得到的是升序的数据，此时如果将8和4进行交换后，此时两个8的相对位置就发生了改变，所以堆排序不具有稳定性。</p>
<p>冒泡排序：稳定。</p>
<p>快速排序：不稳定。因为最终keyi要放到中间去。</p>
<p>归并排序：稳定。因为在归并的时候，左边的先下就始终是稳定的。</p>
<p>图表总结：</p>
<table>
<thead>
<tr>
<th>排序方法</th>
<th>平均情况</th>
<th>最好情况</th>
<th>最坏情况</th>
<th>辅助空间</th>
<th>稳定性</th>
</tr>
</thead>
<tbody>
<tr>
<td>冒泡排序</td>
<td>O(n2)</td>
<td>O(n2)</td>
<td>O(n2)</td>
<td>O(1)</td>
<td>稳定</td>
</tr>
<tr>
<td>简单选择排序</td>
<td>O(n2)</td>
<td>O(n2)</td>
<td>O(n2)</td>
<td>O(1)</td>
<td>不稳定</td>
</tr>
<tr>
<td>直接插入排序</td>
<td>O(n2)</td>
<td>O(n)</td>
<td>O(n2)</td>
<td>O(1)</td>
<td>稳定</td>
</tr>
<tr>
<td>希尔排序</td>
<td>O(nlog2n)~O(n2)</td>
<td>O(n1.3)</td>
<td>O(n2)</td>
<td>O(1)</td>
<td>不稳定</td>
</tr>
<tr>
<td>堆排序</td>
<td>O(nlog2n)</td>
<td>O(nlog2n)</td>
<td>O(nlog2n)</td>
<td>O(1)</td>
<td>不稳定</td>
</tr>
<tr>
<td>归并排序</td>
<td>O(nlog2n)</td>
<td>O(nlog2n)</td>
<td>O(nlog2n)</td>
<td>O(n)</td>
<td>稳定</td>
</tr>
<tr>
<td>快速排序</td>
<td>O(nlog2n)</td>
<td>O(nlog2n)</td>
<td>O(n2)</td>
<td>O(log2n)~O(n)</td>
<td>不稳定</td>
</tr>
</tbody>
</table>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="algorithm" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-15T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">图片防盗链的破解和反破解</title>
    <id>https://blog.ciberviler.top/other/%E5%9B%BE%E7%89%87%E9%98%B2%E7%9B%97%E9%93%BE%E7%9A%84%E7%A0%B4%E8%A7%A3%E5%92%8C%E5%8F%8D%E7%A0%B4%E8%A7%A3.html</id>
    <link href="https://blog.ciberviler.top/other/%E5%9B%BE%E7%89%87%E9%98%B2%E7%9B%97%E9%93%BE%E7%9A%84%E7%A0%B4%E8%A7%A3%E5%92%8C%E5%8F%8D%E7%A0%B4%E8%A7%A3.html"/>
    <updated>2022-05-30T04:24:29.000Z</updated>
    <content type="html"><![CDATA[<h1 id="图片防盗链的破解和反破解" tabindex="-1"> 图片防盗链的破解和反破解</h1>
<h2 id="原理" tabindex="-1"> 原理</h2>
<blockquote>
<p>注：这里有个很有趣的就是 Referrer 和 Referer 的故事了感兴趣的自行去了解下</p>
</blockquote>
<p>我们先来了解了解防盗链的原理，<strong>在 http 协议中，如果从一个页面跳到另一个页面，header字段里面会带个 Referer。图片服务器通过检测 Referer 是否来自规定域名，来进行防盗链。</strong></p>
<p>如果盗用网站是 <strong>https</strong> 的 协议，而图片链接是 http 的话，则从 https 向 http 发起的请求会因为安全性的规定，而不带 referer，从而实现防盗链的绕过。官方输出图片的时候，判断了来源(Referer)，就是从哪个网站访问这个图片，如果是你的网站去加载这个图片，那么 Referer 就是： <code>你的网站地址</code>；你的网址肯定没在官方的白名单内，( <code>当然作为可操作性极强的浏览器来说 referer 是完全可以伪造一个官方的 URL 这样也也就也可以饶过限制🚫</code>)所以就看不到图片了。</p>
<p>因此，若不发送 Referer，也就是没有来源。那么官方那边，就认为是从浏览器直接访问的，所以就能加载正常的图片了。</p>
<h2 id="目的" tabindex="-1"> 目的</h2>
<p><strong>盗链</strong>是指在自己的页面上展示一些并不在自己服务器上的内容。通常的做法是通过技术手段获得它人服务器上的资源地址，绕过别人的资源展示页面，直接在自己的页面上向最终用户提供此内容。比较常见的是一些小站盗用大站的资源（ <code>图片、音乐、视频</code>），对于这些小站来说，通过盗链的方法可以减轻自己服务器的负担，因为真实的空间和流量均是来自别人的服务器。对大站造成的影响确实徒徒增加了服务器压力，用户还不是自己的😅</p>
<p>于是乎防盗链就是防止这种行为的产生，实施防盗链系统后，因为屏蔽了那些盗链的间接资源请求，从而可以大大减轻服务器及带宽的压力，也正如此，越来越多的站点都开始实施防盗链技术。</p>
<h2 id="实现" tabindex="-1"> 实现</h2>
<blockquote>
<p>nginx</p>
</blockquote>
<div><pre><code>location ~* \.(gif|jpg|png|bmp)$ {        valid_referers none blocked *.ttlsa.com server_names ~\.google\. ~\.baidu\.;        if ($invalid_referer) {                return 403;        
    }}
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>以上所有来至 <code>xxx.com</code>和域名中包含 <code>google</code>和 <code>baidu</code>的站点都可以访问到当前站点的图片,如果来源域名（白名单列表）不在这个列表中。</p>
<p>那么 <code>$invalid_referer</code>等于 1，在if语句中返回一个 403 给用户，这样用户便会看到一个 403 的页面,如果使用下面的 <code>rewrite</code>，那么盗链的图片都会显示 403.jpg。</p>
<blockquote>
<p>apache</p>
</blockquote>
<p>在根目录下创建 <code>.htaccess</code> 文件</p>
<div><pre><code>RewriteEngine OnRewriteCond %{HTTP_REFERER} !^$ [NC]RewriteCond %{HTTP_REFERER} !phpddt.com [NC]RewriteCond %{HTTP_REFERER} !google.com [NC]RewriteCond %{HTTP_REFERER} !baidu.com.com [NC]RewriteCond %{HTTP_REFERER} !feedburner.com [NC]RewriteCond %{HTTP_REFERER} !feedsky.com [NC]RewriteRule .*\.(rar|zip)$ http://www.xxx.com/ [R,NC,L]
</code></pre><div aria-hidden="true"><div></div></div></div><p>这段话也可写在 <code>Apache</code>配置文件当中</p>
<p><code>.htaccess</code>文件将影响其所在的目录及其子目录。你可以将其放在根目录或项目的子目录</p>
<p>上面这段代码也是很容易理解的：</p>
<div><pre><code>RewriteCond %{HTTP_REFERER} !^$ [NC]
</code></pre><div aria-hidden="true"><div></div></div></div><p>允许空的来源，即用户浏览器手动属于则允许访问文件。</p>
<div><pre><code>RewriteCond %{HTTP_REFERER} !phpddt.com [NC]
</code></pre><div aria-hidden="true"><div></div></div></div><p>允许站点自身访问，同理，后面还要允许百度，谷歌，和一些订阅源访问。</p>
<div><pre><code>RewriteRule .*\.(rar|zip)$ http://www.xxx.com/ [R,NC,L]
</code></pre><div aria-hidden="true"><div></div></div></div><p>这里可以设置防止盗链的类型，如果盗链可以跳转到网站首页，本站没有做图片防盗链，如果你做图片防盗链可以设置被盗链的替代图片：</p>
<div><pre><code>RewriteRule .*\.(gif|jpg|png)$ http://xxx.com/logo.png [R,NC,L]
</code></pre><div aria-hidden="true"><div></div></div></div><h2 id="破解" tabindex="-1"> 破解</h2>
<p>😄道高一尺魔高一丈既然知道原理那么就来看看一些常用的破解方案如果你有更好的记得给我留言。</p>
<ol>
<li>
<p>如果盗用图片资源是 <code>http</code>协议那么盗用网址可以使用 https 去请求会因为安全性的规定，而不带 <code>referer</code>，从而实现防盗链的绕过。</p>
</li>
<li>
<p>在 HTML 代码的 head 中添加一句</p>
<div><pre><code>&lt;meta name="referrer" content="no-referrer" />
</code></pre><div aria-hidden="true"><div></div></div></div></li>
</ol>
<div><pre><code>&lt;img referrer="no-referrer|origin|unsafe-url" src="{item.src}"/>
</code></pre><div aria-hidden="true"><div></div></div></div><ol>
<li><code>https://images.weserv.nl/?url=</code>${你的图片地址}``</li>
</ol>
<p>因为网址是国外的速度有点慢效果还行，目的就是返回一个不受限制的图片，但是 GIF 格式会返回jpg也就是没有了动画效果。</p>
<ol start="5">
<li>利用 <code>iframe</code>伪造请求 <code>referer</code></li>
</ol>
<div><pre><code>function showImg( url ) {    var frameid = 'frameimg' + Math.random();    window.img = '&lt;img id="img" src=\''+url+'?'+Math.random()+'\' />    &lt;script>window.onload = function() { parent.document.getElementById    (\''+frameid+'\').height = document.getElementById(\'img\').height    +\'px\'; }&lt;'+'/script>';    document.write('&lt;iframe id="'+frameid+'" src="javascript:parent.img;    " frameBorder="0" scrolling="no" width="100%">&lt;/iframe>');}
</code></pre><div aria-hidden="true"><div></div></div></div><ol start="6">
<li>前面也提到来可以服务端伪造请求头具体不同的语言自行搜索对应方案，这里就不一一列举了。</li>
</ol>
<h2 id="反破解" tabindex="-1"> 反破解</h2>
<p>既然有破解就当然有常用的防御机制😄</p>
<ol>
<li>不允许 <code>referer</code>为空（不建议，因在某些开启隐私模式的浏览器中，或 https 页面引用下， <code>referer</code>是空的）</li>
<li>地址变更（ <code>lighttpd</code>的是根据有效时间， <code>nginx</code>的根据是 <code>md5</code>，IP地址变化）</li>
<li>登录校验（如必须登录网站帐号后才能访问）</li>
</ol>
<p>以下是防止网站被镜像，被 <code>iframe</code></p>
<p><strong>1. 防止网站被镜像（被恶意解析和转发等）</strong></p>
<p>现象：他人域名访问到的是我的网站解析的 ip 地址我的</p>
<p>解决方法：</p>
<p>http.ini里可以这样写</p>
<div><pre><code>"RewriteCond Host: !^www.web\.cn$  RewriteRule (.*) http\://www\.web\.cn$1 [I,RP]"
</code></pre><div aria-hidden="true"><div></div></div></div><p>.htaccess里可以这样写</p>
<div><pre><code>“RewriteCond %{HTTP_HOST} !^www.web.cn$ [NC] RewriteRule ^(.*)$ http://www.web.cn/$1 [L,R=301]”
</code></pre><div aria-hidden="true"><div></div></div></div><p>代码的意思非常简单：访问这个网站的域名如果不是 &quot;<a href="http://www.web.cn" target="_blank" rel="noopener noreferrer">www.web.cn</a>&quot; 就自动跳转到 &quot;<a href="http://www.web.cn" target="_blank" rel="noopener noreferrer">www.web.cn</a>&quot; 上。这样设置就不怕自己辛辛苦苦维护的网站被别人镜像了。</p>
<p><strong>2. 防止网址被 iframe</strong></p>
<p>代码：在页面底部或其它公用部位加入如下代码</p>
<div><pre><code>&lt;script type=”text/javascript>    if(window!=parent)   window.top.location.href = window.location.href; &lt; /script>
</code></pre><div aria-hidden="true"><div></div></div></div><p>代码的意思也很简单，用js方法检测地址栏域名是不是当前网站绑定的域名，如果不是，则跳转到绑定的域名上来，这样就不怕网站被别人 <code>iframe</code>了。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-14T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">E5 调用API续订服务：Microsoft 365 E5 Renew X</title>
    <id>https://blog.ciberviler.top/other/Microsoft-365-E5-RenewX.html</id>
    <link href="https://blog.ciberviler.top/other/Microsoft-365-E5-RenewX.html"/>
    <updated>2022-05-29T06:33:39.000Z</updated>
    <content type="html"><![CDATA[<h1 id="e5-调用api续订服务-microsoft-365-e5-renew-x" tabindex="-1"> E5 调用API续订服务：Microsoft 365 E5 Renew X</h1>
<p>Microsoft 365 E5 Renew X是一款网页版的E5续订服务，其依赖网页浏览器呈现支持用户多端操作，完全将E5账户API调用托管在了服务器端因此用户无需电脑也可使用。</p>
<h2 id="microsoft-365-e5-renew-x-由来" tabindex="-1"> Microsoft 365 E5 Renew X 由来</h2>
<p>Microsoft 365 E5 Renew X为Microsoft 365 E5 Web的升级版，相对于旧版其增强了管理功能且更容易部署，API调用内核继承于续订桌面版软件Microsoft 365 E5 Renew Plus。</p>
<h2 id="主要功能" tabindex="-1"> 主要功能</h2>
<h3 id="用户端" tabindex="-1"> 用户端</h3>
<ul>
<li><strong>两种可选的调用权限</strong>：用户未登录作为守护程序调用(需要客户端密码)、程序以登录用户身份直接调用(需要账户密码)</li>
<li><strong>API种类齐全</strong>：41/30个可选的Microsoft Graph REST API Beta中的API(未来可能会继续添加)</li>
<li><strong>完全随机的API调用模式</strong>：从已选定的API序列中随机抽取一个或几个进行调用（个数和API随机）</li>
<li><strong>完全随机的API调用时间间隔</strong>：随机区段1000s-2000s固定</li>
<li><strong>完全随机的API内容(仅部分API支持)</strong>：发送邮件的内容随机 Onedirve上传文件的内容随机</li>
<li><strong>邮件通知服务</strong>：支持设置通知邮箱，调用异常会通过邮件通知无需反复登录查看</li>
</ul>
<h3 id="部署端" tabindex="-1"> 部署端</h3>
<ul>
<li><strong>平台兼容性</strong>：<a href="http://xn--Asp-hb0er53o.Net" target="_blank" rel="noopener noreferrer">使用Asp.Net</a> Core 作为跨平台框架增适用于 <strong>Windows|Linux|MacOS x64|x86|ARM64|ARM</strong></li>
<li><strong>灵活部署</strong>：支持<strong>开放站点部署</strong>和<strong>私享部署</strong>，私享部署不再强制要求配置Https和OAuth</li>
<li><strong>无需数据库</strong>：不需要后台数据库支持，前后台一体化程序</li>
<li><strong>用户后台管理</strong>：可修改用户的E5账户数量，以及封删管理</li>
<li><strong>系统状态监视</strong>：系统占用率一目了然，可控的站点注册通道更容易控制系统用户数量</li>
<li><strong>自定义页面</strong>：支持自定义HTML静态页面，可设置支付宝、微信收款码</li>
<li><strong>显示ICP备案</strong>：支持ICP备案文字显示，可在国内备案建站</li>
<li><strong>无人值守 运行自动暂停</strong>：可自动暂停有错误率过高的账号API调用</li>
<li><strong>无人值守 自动恢复运行</strong>：可定期自动恢复全部账号的API调用，防止因微软网络原因触发大量账号停止API调用进而导致的账号续期失败</li>
</ul>
<h1 id="用户端使用教程-请勿开启账号的双重验证功能" tabindex="-1"> 用户端使用教程**(请勿开启账号的双重验证功能)**</h1>
<h2 id="可用站点" tabindex="-1"> 可用站点</h2>
<h3 id="主站" tabindex="-1"> 主站</h3>
<p><a href="https://e5.sundayrx.net/" target="_blank" rel="noopener noreferrer"><strong>主站：https://e5.sundayrx.net（由 SundayRX 运营）(可登录不可注册)</strong></a></p>
<p><a href="https://ms-e5-renew.leeskyler.top:11015/" target="_blank" rel="noopener noreferrer"><strong>分站：https://ms-e5-renew.leeskyler.top:11015（由 leeskyler 运营）(已关停)</strong></a></p>
<p><a href="https://ms-e5-renew-3.eastern.moe/" target="_blank" rel="noopener noreferrer"><strong>分站：https://ms-e5-renew-3.eastern.moe（由 leeskyler 运营）(已关停)</strong></a></p>
<h3 id="自建共享站点" tabindex="-1"> 自建共享站点</h3>
<p><a href="https://ew.chirmyram.com/" target="_blank" rel="noopener noreferrer"><strong>自建共享站：https://ew.chirmyram.com（由 七米蓝 运营）(可登录不可注册)</strong></a></p>
<p><a href="https://e5.hm0420.cc/" target="_blank" rel="noopener noreferrer"><strong>自建共享站：https://e5.hm0420.cc（由 小冰酱 运营）</strong></a></p>
<p><a href="https://ms-e5.hm0420.cc/" target="_blank" rel="noopener noreferrer"><strong>自建共享站：https://ms-e5.hm0420.cc（由 小冰酱 运营）</strong></a></p>
<p><a href="https://e5.xzh.gs/" target="_blank" rel="noopener noreferrer"><strong>自建共享站：https://e5.xzh.gs（由 XZH 运营）</strong></a></p>
<p><a href="https://e5.tianli0.top/" target="_blank" rel="noopener noreferrer"><strong>自建共享站：https://e5.tianli0.top（由 Tinali 运营）</strong></a></p>
<p><a href="https://renew.lrize.xyz/" target="_blank" rel="noopener noreferrer"><strong>自建共享站：https://renew.lrize.xyz（由 Lrize、 运营）</strong></a></p>
<p><a href="https://e5zh.xyz/" target="_blank" rel="noopener noreferrer"><strong>自建共享站：https://e5zh.xyz（由 z 运营）</strong></a></p>
<h2 id="_1-注册azure应用程序" tabindex="-1"> 1 注册Azure应用程序</h2>
<h3 id="_1-1-应用注册" tabindex="-1"> 1.1 应用注册</h3>
<ol>
<li><a href="https://portal.azure.com/#home" target="_blank" rel="noopener noreferrer">点击登录 Azure</a>或<a href="https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade" target="_blank" rel="noopener noreferrer">点击直接进入Azure应用注册</a>，登录账号使用申请到的Microsoft 365 E5的<strong>管理员账户</strong>（账户名类似XXXX@YYYY.onmicrosoft.com格式）。
2.登录完成后点击右上角的“门户”按钮进入Azure管理中心，在搜索栏内输入“应用注册”，点击进入<a href="https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade" target="_blank" rel="noopener noreferrer">（若应用注册搜索不到请点击此处直接进入）</a>。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618170032256-165380585664583.png" alt="图片" loading="lazy">
3.单击“新注册”按钮
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2020061817051341-165380585814786.png" alt="图片" loading="lazy">
4.配置应用 应用名称随意写、注意可访问性选项选择最后一项、重定向URL暂时不填 、完成后点击注册
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618170801323-165380585941389.png" alt="图片" loading="lazy"></li>
</ol>
<h3 id="_1-2-配置应用重定向url-身份验证" tabindex="-1"> 1.2 配置应用重定向URL（身份验证）</h3>
<p>1.先点击“概述”，然后点击“添加重定向URL”，进入重定向URL配置界面，<strong>下图中的应用程序(客户端)ID即为&quot;客户端ID&quot;</strong>。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2020061817121972-165380586091892.png" alt="图片" loading="lazy">
2.点击“添加平台”，再点击“移动和桌面应用程序”，
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618171501396-165380586226995.png" alt="图片" loading="lazy">
3.继续勾选中第一个URL，最后点击底部的“配置”，该URL为“<a href="https://login.microsoftonline.com/common/oauth2/nativeclient%E2%80%9D%E4%B9%9F%E5%8F%AF%E6%89%8B%E5%8A%A8%E6%B7%BB%E5%8A%A0%E3%80%82" target="_blank" rel="noopener noreferrer">https://login.microsoftonline.com/common/oauth2/nativeclient”也可手动添加。</a>
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618171651338-165380586350298.png" alt="图片" loading="lazy">
4.配置默认客户端类型将应用程序视为公共客户端 点击切换按钮为“是” ，最后点击“保存”按钮保存。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618171850779-1653805864822101.png" alt="图片" loading="lazy"></p>
<h2 id="_2-配置应用程序的api权限-重要" tabindex="-1"> 2 配置应用程序的API权限（重要）</h2>
<p><strong>小白提示：建议选择“委托的权限(用户登录)”该权限类型，调用API较多，操作步骤较少简单粗暴，调用成功几率高</strong></p>
<p>注册的应用程序API权限类型有两种，其主要区别如下表所示：</p>
<table>
<thead>
<tr>
<th>权限类型</th>
<th><strong>委托的权限(用户登录)</strong></th>
<th><strong>应用程序权限(非用户登录)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>官方释义</td>
<td>应用程序必须以登录用户身份访问API</td>
<td>应用程序在用户未登录的情况下作为后台服务或守护程序运行</td>
</tr>
<tr>
<td>需要的信息</td>
<td>账户名称+账户密码+应用程序(客户端)ID</td>
<td>账户名称+客户端机密+应用程序(客户端)ID</td>
</tr>
<tr>
<td>功能影响</td>
<td>程序中所有API均可调用</td>
<td>部分API权限受限无法调用(官方限制)</td>
</tr>
<tr>
<td>API权限配置</td>
<td>可由PC版程序自动配置添加API权限</td>
<td>必须手动配置API权限</td>
</tr>
<tr>
<td>显示颜色标识</td>
<td>蓝色</td>
<td>深青色</td>
</tr>
</tbody>
</table>
<p><strong>以下是登录或非登录所需要的权限列表</strong>：
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20201102171130141.png" alt="图片" loading="lazy"></p>
<p>最后根据所选的API权限类型在：<strong>2.1 选择“委托的权限(用户登录)”类型的API</strong>或者<strong>2.2 选择“应用程序权限(非用户登录)”类型的API</strong>中选择性阅读。</p>
<h3 id="_2-1-选择-委托的权限-用户登录-类型的api" tabindex="-1"> 2.1 选择“委托的权限(用户登录)”类型的API</h3>
<h4 id="手动配置api权限" tabindex="-1"> 手动配置API权限</h4>
<p>1.点击“API权限”-“添加权限”-“Microsoft Graph”
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2020061819283823-1653805868573106.png" alt="图片" loading="lazy">
2.选择“委托的权限”<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618172538991-1653805869901109.png" alt="图片" loading="lazy">
3.根据编辑页面中列出的API权限需求表（注意在程序中切换为&quot;<strong>登录</strong>“）来勾选所对应的API权限，全部选择完成后点击&quot;添加权限”。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20201102171303292.png" alt="图片" loading="lazy">
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618172627969-1653805874862114.png" alt="图片" loading="lazy">
添加完成的效果如图
<strong>如果没有“代表XXX授予管理员同意”按钮 说明该账号不是管理员账号 换登管理员账号创建应用</strong>
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20201112111140479.png" alt="图片" loading="lazy"></p>
<p>4.最后点击代表XXX授予管理员同意,对话框选择“是”（该图包含了当前程序“委托的权限(用户登录)”全部API所需要的权限）。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20201112110505347.png" alt="图片" loading="lazy"></p>
<h3 id="_2-2-选择-应用程序权限-非用户登录-类型的api" tabindex="-1"> 2.2 选择“应用程序权限(非用户登录)”类型的API</h3>
<h4 id="_2-2-1-手动配置api权限" tabindex="-1"> 2.2.1 手动配置API权限</h4>
<p>1.点击“API权限”-“添加权限”-“Microsoft Graph”
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2020061819283823-1653805879510121.png" alt="图片" loading="lazy">
2.选择“应用程序权限”
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200801120027971-1653805882870124.png" alt="图片" loading="lazy">
3.根据编辑页面中列出的API权限需求表（注意在程序中切换为&quot;<strong>非登录</strong>“）来勾选所对应的API权限，全部选择完成后点击&quot;添加权限”。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20201102171349129.png" alt="图片" loading="lazy">
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618172627969-1653805884862127.png" alt="图片" loading="lazy">
添加完成的效果如图
<strong>如果没有“代表XXX授予管理员同意”按钮 说明该账号不是管理员账号 换登管理员账号创建应用</strong>
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200801120623311-1653805887894132.png" alt="图片" loading="lazy">
4.最后点击代表XXX授予管理员同意,对话框选择“是”（该图包含了当前程序“应用程序权限(非用户登录)”全部API所需要的权限）。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200801120818260-1653805889622135.png" alt="图片" loading="lazy"></p>
<h4 id="_2-2-2-创建客户端密码" tabindex="-1"> 2.2.2 创建客户端密码</h4>
<p>1.点击“证书密码”-“新客户端密码”-“24个月”-“添加”
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20210609101116972-1653805890998138.png" alt="图片" loading="lazy">
2.点击“值”该列中的“复制”（不要复制&quot;ID&quot;列中的值），并立即将该密码保存至电脑，<strong>保存的值即为“客户端密码”</strong>， 注：该值必须立即保存，退出该页面后将永远无法查看。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2020120711360840.jpeg" alt="图片" loading="lazy"></p>
<h2 id="_3-将账号api调用托管至服务" tabindex="-1"> 3 将账号API调用托管至服务</h2>
<h5 id="创建一个新的e5子账户-可选步骤" tabindex="-1"> 创建一个新的E5子账户(可选步骤)</h5>
<p>登入E5管理员账户进入管理员界面，创建一个新的子账户，使用这个子账户登录程序调用API。
为什么建议这样做：Microsoft 365 E5 Renew中的部分API包含了写操作，例如邮件和Onedrive的API，这些API在随机模式下会生成大量垃圾邮件和文件（虽然单独为此设立了一个文件夹），部分人可能会对此行为非常介意，而且程序频繁的读写可能会对您正常使用账户造成影响，因此不建议使用管理员账户登录。</p>
<h3 id="_3-1-进入网站注册并登录账户" tabindex="-1"> 3.1 进入网站注册并登录账户</h3>
<p>从一开始的可用站点，选择站点进入（记住无论使用任何人运营网站显示内容都是基本相同的）</p>
<p>从两种登录中任选一个，这里不建议选择GitHub登录（GitHub的第三方登录很迷经常性崩溃）</p>
<p>第一次登录账户系统会显示注册成功，然后再登录一次即可登录进入系统
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAU3VuZGF5Ulg=,size_20,color_FFFFFF,t_70,g_se,x_16.png" alt="请添加图片描述" loading="lazy"></p>
<h3 id="_3-2-激活您的账户" tabindex="-1"> 3.2 激活您的账户</h3>
<p>阅读并同意用户协议，点击激活账户
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAU3VuZGF5Ulg=,size_20,color_FFFFFF,t_70,g_se,x_16-1653805902079145.png" alt="请添加图片描述" loading="lazy"></p>
<h3 id="_3-3-添加一个e5账户的运行配置信息" tabindex="-1"> 3.3 添加一个E5账户的运行配置信息</h3>
<p>在成功登录系统后，页面会自动跳转到“主页”页面，在“账户详情”页面点击“添加运行账号”按钮，前往“账户运行配置”页面
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2375b23f6de74f5e9d9ff37bca1e7dcc.png" alt="请添加图片描述" loading="lazy"></p>
<p>在账户运行配置页面中填写账户信息，且登录调用填写账户密码、非登录调用填写客户端密码，并选择自己选定的调用方式，注意调用方式不要选错了！！！ 最后点击“添加运行账号”按钮完成配置。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/eb5d982940a340719b4b5dbd1a46420c.png" alt="请添加图片描述" loading="lazy">
由于前后台数据同步需要时间，任何添加账户或者修改账户配置信息的操作都不会立即被后台执行。</p>
<p>返回用户页面查看账户信息中的“配置同步状态”，如果显示为“正在运行”表明配置已经上传至后台，修改账户配置成功。
<strong>警示：配置成功了也要定期来看看自己的账户是否在正常运行（虽然有邮件通知服务），但也建议每月查看一次账户状态！！！</strong><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/3b2651537fee45088202efd02cad6d74.png" alt="请添加图片描述" loading="lazy"></p>
<h3 id="_3-4-设置一个通知邮箱-可选" tabindex="-1"> 3.4 设置一个通知邮箱（可选）</h3>
<p>在任何页面下 点击右上角“用户名-账户设置”，进入个人信息设置
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/8229363a593549bbb884960e65875673.png" alt="请添加图片描述" loading="lazy">
记住你的UID，出现任何问题请使用这个UID与你所选站点的管理员沟通
编辑你的邮箱 并点击保存
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/fea87de6e5774a319c4b4a2e818d3341.png" alt="请添加图片描述" loading="lazy"></p>
<h1 id="部署端-请勿使用任何cookie缓存加速服务" tabindex="-1"> 部署端**(请勿使用任何Cookie缓存加速服务)**</h1>
<h2 id="服务下载-作为站长务必注意查看主站中-关于-页面中的程序发布时间-及时更新服务程序" tabindex="-1"> 服务下载(作为站长务必注意查看<strong>主站</strong>中“<strong>关于</strong>”页面中的<strong>程序发布时间</strong>，及时更新服务程序)</h2>
<h3 id="传统方式" tabindex="-1"> 传统方式</h3>
<p><a href="https://sundayrx.lanzoui.com/aW09Lsss75g" target="_blank" rel="noopener noreferrer"><strong>下载服务程序源文件（https://sundayrx.lanzoui.com/aW09Lsss75g）</strong></a></p>
<p><a href="https://docs-1.leeskyler.top/" target="_blank" rel="noopener noreferrer"><strong>参阅 Skyler的部署帮助文档（https://docs-1.leeskyler.top）</strong></a>
<a href="https://www.gladtbam.top/posts/37680/" target="_blank" rel="noopener noreferrer"><strong>参阅 Gladtbam的部署帮助文档 （https://www.gladtbam.top/posts/37680）</strong></a></p>
<h3 id="docker方式" tabindex="-1"> Docker方式</h3>
<p><a href="https://blog.csdn.net/qq_40605167/article/details/122888580" target="_blank" rel="noopener noreferrer"><strong>参阅 韩韩的Docker版部署帮助文档（https://blog.csdn.net/qq_40605167/article/details/122888580）</strong></a>
<a href="https://www.gladtbam.top/posts/22256/" target="_blank" rel="noopener noreferrer"><strong>参阅 Gladtbam的Docker版部署帮助文档（https://www.gladtbam.top/posts/22256/）</strong></a>
<a href="https://www.bilibili.com/read/cv16338214" target="_blank" rel="noopener noreferrer"><strong>参阅 Curious的部署帮助文档 （https://www.bilibili.com/read/cv16338214）</strong></a></p>
<h2 id="传统方式服务部署" tabindex="-1"> 传统方式服务部署</h2>
<h3 id="安装运行环境" tabindex="-1"> 安装运行环境</h3>
<p><em>以下示例可能不完全包含全部操作系统，但无论是哪种系统都要安装 <strong><a href="http://Asp.Net" target="_blank" rel="noopener noreferrer">Asp.Net</a> Core 3.1 SDK</strong>支持包，服务程序运行依赖于这个包也只依赖这一个包，只要成功安装了<strong><a href="http://Asp.Net" target="_blank" rel="noopener noreferrer">Asp.Net</a> Core 3.1 SDK</strong>支持包，服务程序就可以正常运行！</em>
详情请参阅<a href="https://docs.microsoft.com/zh-cn/dotnet/core/install/" target="_blank" rel="noopener noreferrer">在 Windows、Linux 和 macOS 上安装 .NET</a></p>
<h4 id="windows" tabindex="-1"> Windows</h4>
<p>前往<a href="https://dotnet.microsoft.com/download/dotnet/3.1%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85**%E6%9C%80%E6%96%B0%E7%9A%84Asp.Net" target="_blank" rel="noopener noreferrer">https://dotnet.microsoft.com/download/dotnet/3.1下载安装**最新的Asp.Net</a> Core 3.1 SDK** 安装包</p>
<h4 id="ubuntu" tabindex="-1"> Ubuntu</h4>
<p>详情请参阅<a href="https://docs.microsoft.com/zh-cn/dotnet/core/install/linux-ubuntu" target="_blank" rel="noopener noreferrer">在 Ubuntu 上安装 .NET SDK 或 .NET 运行时</a></p>
<p><strong>Ubuntu 21.04</strong></p>
<div><pre><code><span>wget</span> https://packages.microsoft.com/config/ubuntu/21.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
<span>sudo</span> dpkg -i packages-microsoft-prod.deb
<span>rm</span> packages-microsoft-prod.deb
<span>123</span>
<span>sudo</span> <span>apt-get</span> update<span>;</span> <span>\</span>
  <span>sudo</span> <span>apt-get</span> <span>install</span> -y apt-transport-https <span>&amp;&amp;</span> <span>\</span>
  <span>sudo</span> <span>apt-get</span> update <span>&amp;&amp;</span> <span>\</span>
  <span>sudo</span> <span>apt-get</span> <span>install</span> -y aspnetcore-runtime-3.1
<span>1234</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="centos" tabindex="-1"> CentOS</h4>
<p>详情请参阅<a href="https://docs.microsoft.com/zh-cn/dotnet/core/install/linux-centos" target="_blank" rel="noopener noreferrer">在 CentOS 上安装 .NET SDK 或 .NET 运行时</a></p>
<p><strong>CentOS 8</strong>
<code>sudo dnf install dotnet-sdk-3.1</code>
<strong>CentOS 7</strong>
<code>sudo rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm</code>
<code>sudo yum install dotnet-sdk-3.1</code></p>
<h4 id="macos" tabindex="-1"> MacOS</h4>
<p>前往<a href="https://dotnet.microsoft.com/download/dotnet/3.1%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85**%E6%9C%80%E6%96%B0%E7%9A%84Asp.Net" target="_blank" rel="noopener noreferrer">https://dotnet.microsoft.com/download/dotnet/3.1下载安装**最新的Asp.Net</a> Core 3.1 SDK** 安装包</p>
<h3 id="填写配置信息" tabindex="-1"> 填写配置信息</h3>
<p>*<strong>站点拥有开放和私用两种模式，请根据自己的部署目的来选择对应的教程来阅读！*
*配置文件是Deploy/Config.xml 务必打开并修改默认的管理员登录密码*</strong></p>
<h4 id="开放站点" tabindex="-1"> 开放站点</h4>
<p><em>开放站点必须使用全链路HTTPS，即便是使用了Nginx反向代理也必须设置HTTPS为启用状态</em></p>
<p><strong>Configuration.ShareSite.Enable</strong>设置为true</p>
<h5 id="https-ssl证书" tabindex="-1"> HTTPS SSL证书</h5>
<h6 id="方式1-服务程序kestrel—-https-—外部internet" tabindex="-1"> 方式1：服务程序Kestrel—(HTTPS)—外部Internet</h6>
<p><em>准备一个PFX格式的SSL证书文件，放置在Deploy文件夹中</em></p>
<p><strong>Configuration.HTTPS.Enable</strong>设置为true
<strong>Configuration.HTTPS.Certificate</strong>设置为PFX文件的名称带后缀名
<strong>Configuration.HTTPS.Password</strong>设置为PFX文件的密码</p>
<h6 id="方式2-服务程序kestrel—-https-localhost-—nginx-iis-apache—-https-外部访问域名-—外部internet" tabindex="-1"> 方式2：服务程序Kestrel—(HTTPS localhost)—Nginx/IIS/Apache—(HTTPS 外部访问域名)—外部Internet</h6>
<p><em>反向代理服务器部分请自行配置</em></p>
<p>执行下列两个命令 以创建localhsot HTTPS证书 该证书时效为1年
<code>dotnet dev-certs https --clean</code>
<code>dotnet dev-certs https --trust</code></p>
<p><strong>Configuration.HTTPS.Enable</strong>设置为true
<strong>Configuration.HTTPS.Certificate</strong>设置为空（什么都不要填）
<strong>Configuration.HTTPS.Password</strong>设置为空（什么都不要填）</p>
<h5 id="microsoft-oauth" tabindex="-1"> Microsoft OAuth</h5>
<h5 id="github-oauth" tabindex="-1"> Github OAuth</h5>
<h5 id="smtp邮件服务" tabindex="-1"> SMTP邮件服务</h5>
<p><em>准备一个可以使用SMTP服务发信的邮箱</em></p>
<p><strong>Configuration.ShareSite.SMTP.Email</strong>设置为 发件人邮箱地址
<strong>Configuration.ShareSite.SMTP.Password</strong>设置为 邮箱密钥
<strong>Configuration.ShareSite.SMTP.Host</strong>设置为 发件人邮箱的SMTP服务器地址 (<a href="http://xn--Outlooksmtp-n68qh3ew6ck78eimyb.office365.com" target="_blank" rel="noopener noreferrer">以Outlook为例子是smtp.office365.com</a>)</p>
<h4 id="私用" tabindex="-1"> 私用</h4>
<p><em>在私用模式下不用准备任何配置信息，填写好登录密码端口即可使用！</em></p>
<h5 id="启用https-选配" tabindex="-1"> 启用HTTPS（选配）</h5>
<p><em>若要启用HTTPS请在下面选择一种合适的方式来实现</em></p>
<h6 id="方式1-服务程序kestrel—-https-—外部internet-1" tabindex="-1"> 方式1：服务程序Kestrel—(HTTPS)—外部Internet</h6>
<p><em>准备一个PFX格式的SSL证书文件，放置在Deploy文件夹中</em></p>
<p><strong>Configuration.HTTPS.Enable</strong>设置为true
<strong>Configuration.HTTPS.Certificate</strong>设置为PFX文件的名称带后缀名
<strong>Configuration.HTTPS.Password</strong>设置为PFX文件的密码</p>
<h6 id="方式2-服务程序kestrel—-http-—nginx-iis-apache—-https-外部访问域名-—外部internet" tabindex="-1"> 方式2：服务程序Kestrel—(HTTP)—Nginx/IIS/Apache—(HTTPS 外部访问域名)—外部Internet</h6>
<p><em>反向代理服务器部分请自行配置</em></p>
<p><strong>Configuration.HTTPS.Enable</strong>设置为false</p>
<h3 id="启动服务程序" tabindex="-1"> 启动服务程序</h3>
<p>在任何系统下，打开命令行定位到程序目录 运行<code>dotnet Microsoft365_E5_Renew_X.dll</code>命令即可启动</p>
<h3 id="管理员登录" tabindex="-1"> 管理员登录</h3>
<h4 id="非oauth后台登录-开放或私享部署皆可用" tabindex="-1"> 非OAuth后台登录（开放或私享部署皆可用）</h4>
<p>管理员登录路由 <code>/Admin/Login</code> 默认密码在配置文件Deploy/Config.xml中更改</p>
<h4 id="oauth认证登录-仅开放部署可用" tabindex="-1"> OAuth认证登录（仅开放部署可用）</h4>
<h5 id="设置管理员oauth登录的oauthid" tabindex="-1"> 设置管理员OAuth登录的OAuthID</h5>
<p>使用想要关联的OAuth账号（Microsoft/Github）在任意站点登录/注册均可看到此账号的OAuthID,记录此ID</p>
<p>通过管理员密码登录自己的站点：管理员功能-用户列表 找到管理员账户 点击“编辑”按钮填写记录的OAuthID 保存</p>
<p>直接在主登录页面使用与管理员账户关联的OAuth账号登录即可</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-12T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">E5 调用API续订程序：Microsoft 365 E5 Renew Plus</title>
    <id>https://blog.ciberviler.top/other/Microsoft-365-E5-RenewPlus.html</id>
    <link href="https://blog.ciberviler.top/other/Microsoft-365-E5-RenewPlus.html"/>
    <updated>2022-05-29T06:33:31.000Z</updated>
    <content type="html"><![CDATA[<h1 id="e5-调用api续订程序-microsoft-365-e5-renew-plus" tabindex="-1"> E5 调用API续订程序：Microsoft 365 E5 Renew Plus</h1>
<h2 id="microsoft-365-e5-renew-plus的由来" tabindex="-1"> Microsoft 365 E5 Renew Plus的由来</h2>
<p>Microsoft 365 E5 Renew Plus为Microsoft 365 E5 Renew的升级版，其功能性，易用性，美观程度上都要强于旧版。</p>
<h2 id="主要功能" tabindex="-1"> 主要功能</h2>
<ul>
<li><strong>支持开机自启动后台调用</strong>：使用简单方便，无需购买服务器部署，本地应用程序即开即用</li>
<li><strong>两种可选的调用权限</strong>：用户未登录作为守护程序调用(需要客户端密码)、程序以登录用户身份直接调用(需要账户密码)</li>
<li><strong>自动配置API权限</strong>：登录调用的API权限支持由程序自动配置</li>
<li><strong>API种类齐全</strong>：43个可选的Microsoft Graph REST API Beta中的API(未来可能会继续添加)</li>
<li><strong>完全随机的API选用模式</strong>：从已选定的API序列中随机抽取一个或几个进行调用（个数和API随机）</li>
<li><strong>完全随机的API调用顺序</strong>：每轮API的调用先后顺序随机</li>
<li><strong>完全随机的API内容(仅部分API支持)</strong>：POST写类型的API的上传内容随机</li>
<li><strong>完全随机的API调用时间间隔</strong>：随机区段500s-86400s自定义</li>
<li><strong>每日工作时间自定义</strong>：在日常工作时间进行调用，适用于从不关机重启的服务器设备</li>
<li><strong>每周工作日自定义</strong>：在每周的工作日进行调用，适用于从不关机重启的服务器设备</li>
<li><strong>运行智能暂停</strong>：防止因持续在错误配置下运行而导致的账户封禁</li>
<li><strong>运行配置自动保存</strong>：可保存运行配置，无需反复设置</li>
<li><strong>无限制账号个数</strong>：理论上允许无限制个数账号后台自动调用</li>
<li><strong>支持自定义客户端密钥</strong>：允许非登录调用使用自定义密钥</li>
<li><strong>自定义美化界面</strong>：支持自定义背景图片（半透明度以及毛玻璃效果）、亚克力背景</li>
</ul>
<h2 id="主界面" tabindex="-1"> 主界面</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/b23cb7e4945747fca6e88b5c36e80e08.png" alt="图片" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/185cfc81a55746eb8d915e6f0923d1ca.png" alt="图片" loading="lazy"></p>
<h2 id="运行结果查看" tabindex="-1"> 运行结果查看</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20210323150719810.png" alt="图片" loading="lazy"></p>
<h1 id="入群须知" tabindex="-1"> <strong>入群须知</strong></h1>
<ul>
<li><strong>使用本系列产品只是增加E5续订概率，并不能保证100%续订成功</strong></li>
<li><strong>续订操作有些许技术门槛，且需要具备一定的自学能力</strong></li>
<li><strong>每个人的时间都是宝贵的，遇到问题先查阅<a href="https://sundayrx.coding.net/s/78f69c8a-8620-4d53-bad2-c4b365fed1a0" target="_blank" rel="noopener noreferrer">帮助文档</a>，实在无法解决时再发起提问(<a href="https://sundayrx.coding.net/s/78f69c8a-8620-4d53-bad2-c4b365fed1a0/4" target="_blank" rel="noopener noreferrer">提问的艺术</a>)</strong></li>
</ul>
<h4 id="qq交流群-254058945" tabindex="-1"> <strong>QQ交流群：254058945</strong></h4>
<h4 id="tg交流群-https-t-me-ms365e5renew" tabindex="-1"> <strong>TG交流群：<a href="https://t.me/MS365E5Renew" target="_blank" rel="noopener noreferrer">https://t.me/MS365E5Renew</a></strong></h4>
<h1 id="软件下载" tabindex="-1"> 软件下载</h1>
<h3 id="受支持的操作系统及运行环境安装" tabindex="-1"> 受支持的操作系统及运行环境安装</h3>
<table>
<thead>
<tr>
<th>操作系统</th>
<th>版本</th>
<th>CPU架构</th>
<th>.NET 6.0 （必选）</th>
<th>WebView 2（可选）</th>
<th>补丁（必选）</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Client</td>
<td>7 SP1(<a href="https://docs.microsoft.com/zh-cn/troubleshoot/windows-client/windows-7-eos-faq/windows-7-extended-security-updates-faq" target="_blank" rel="noopener noreferrer">ESU</a>) 、8.1</td>
<td>x64</td>
<td><a href="https://dotnet.microsoft.com/download/dotnet/6.0/runtime" target="_blank" rel="noopener noreferrer">下载.Net 6.0 Desktop</a></td>
<td><a href="https://go.microsoft.com/fwlink/p/?LinkId=2124703" target="_blank" rel="noopener noreferrer">下载WebView 2</a></td>
<td><a href="https://blog.simplix.info/update7/" target="_blank" rel="noopener noreferrer">下载ESU</a></td>
</tr>
<tr>
<td>Windows 10 Client</td>
<td>Version 1607+</td>
<td>Arm64、x64</td>
<td><a href="https://dotnet.microsoft.com/download/dotnet/6.0/runtime" target="_blank" rel="noopener noreferrer">下载.Net 6.0 Desktop</a></td>
<td><a href="https://go.microsoft.com/fwlink/p/?LinkId=2124703" target="_blank" rel="noopener noreferrer">下载WebView 2</a></td>
<td>不需要</td>
</tr>
<tr>
<td>Windows 11 Client</td>
<td>无限制</td>
<td>Arm64、x64</td>
<td><a href="https://dotnet.microsoft.com/download/dotnet/6.0/runtime" target="_blank" rel="noopener noreferrer">下载.Net 6.0 Desktop</a></td>
<td>不需要</td>
<td>不需要</td>
</tr>
<tr>
<td>Windows Server</td>
<td>Version 2012+</td>
<td>x64</td>
<td><a href="https://dotnet.microsoft.com/download/dotnet/6.0/runtime" target="_blank" rel="noopener noreferrer">下载.Net 6.0 Desktop</a></td>
<td><a href="https://go.microsoft.com/fwlink/p/?LinkId=2124703" target="_blank" rel="noopener noreferrer">下载WebView 2</a></td>
<td>不需要</td>
</tr>
</tbody>
</table>
<h3 id="各版本下载地址-建议添加白名单运行" tabindex="-1"> 各版本下载地址（建议添加白名单运行）</h3>
<table>
<thead>
<tr>
<th>软件版本</th>
<th>文件说明</th>
<th>LanZou</th>
<th>OneDrive</th>
<th>杀软报告</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>包含框架(推荐)</strong></td>
<td>无需额外安装运行环境，可直接运行</td>
<td><a href="https://sundayrx.lanzouq.com/2R2AByh83333" target="_blank" rel="noopener noreferrer"><strong>下载</strong></a></td>
<td><a href="https://sundayrx-my.sharepoint.com/:u:/g/personal/api1_sundayrx_onmicrosoft_com/EbjsV4mOxBlBoE39mBxFpqsBk51BF4y_T4Cs0OB4hV7OsQ?e=HGIlhE" target="_blank" rel="noopener noreferrer">下载</a></td>
<td><a href="https://www.virustotal.com/gui/file/80e435ef79dbd3869e00d5515c4240237d40c598cd50519fd97184a78889512f" target="_blank" rel="noopener noreferrer">VirusTotal</a></td>
</tr>
<tr>
<td>普通版本</td>
<td>需要安装 .NET 6 Desktop Runtime x64</td>
<td><a href="https://sundayrx.lanzoui.com/vqTrXlR5LrWjP3F" target="_blank" rel="noopener noreferrer">下载</a></td>
<td><a href="https://sundayrx-my.sharepoint.com/:u:/g/personal/api1_sundayrx_onmicrosoft_com/EbI_I-ohJ4BCuK821xnIoz0BTUBFHPZs3whXbVW06YLPfQ?e=vPozqH" target="_blank" rel="noopener noreferrer">下载</a></td>
<td><a href="https://www.virustotal.com/gui/file/80e435ef79dbd3869e00d5515c4240237d40c598cd50519fd97184a78889512f" target="_blank" rel="noopener noreferrer">VirusTotal</a></td>
</tr>
<tr>
<td>历史版本(弃用)</td>
<td>更兼容Windows 7，已停止更新</td>
<td><a href="https://sundayrx.lanzouq.com/2R2AByh8333" target="_blank" rel="noopener noreferrer">下载</a></td>
<td><a href="https://sundayrx-my.sharepoint.com/:u:/g/personal/api1_sundayrx_onmicrosoft_com/EayqKNMm9IFMgSVVcNtTWJABAnZrViM3cHrthqP6VG6c2w?e=v9Zetz" target="_blank" rel="noopener noreferrer">下载</a></td>
<td><a href="https://www.virustotal.com/gui/file/80e435ef79dbd3869e00d5515c4240237d40c598cd50519fd97184a78889512f" target="_blank" rel="noopener noreferrer">VirusTotal</a></td>
</tr>
</tbody>
</table>
<h1 id="使用教程-请勿开启账号的双重验证功能" tabindex="-1"> 使用教程**(请勿开启账号的双重验证功能)**</h1>
<h2 id="_0-如何导入旧版本程序中的账号信息-老用户升级用-新用户请无视" tabindex="-1"> 0 如何导入旧版本程序中的账号信息？（老用户升级用 新用户请无视）</h2>
<h3 id="_0-1-复制旧版本程序账户信息" tabindex="-1"> 0.1 复制旧版本程序账户信息</h3>
<p>打开旧版本程序根目录下的Account.txt文件，依照每行复制一个账号信息（不支持多行识别）。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20210323143621396.png" alt="图片" loading="lazy"></p>
<h3 id="_0-2-导入账户信息到新版本程序中" tabindex="-1"> 0.2 导入账户信息到新版本程序中</h3>
<p>打开新版本程序点击“开始运行”-“添加账号”，在弹出的“添加账号”窗口中找到右上角的剪切板图标，点击后程序会自动识别复制的账号信息，如果复制的内容没有错误程序会自动识别调用类型并填充所有空白项，检查无误后单击“确定”按钮完成一个账号信息的导入。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20210323143246326.png" alt="图片" loading="lazy"></p>
<h2 id="_1-注册azure应用程序" tabindex="-1"> 1 注册Azure应用程序</h2>
<h3 id="_1-1-应用注册" tabindex="-1"> 1.1 应用注册</h3>
<ol>
<li><a href="https://portal.azure.com/#home" target="_blank" rel="noopener noreferrer">点击登录 Azure</a>或<a href="https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade" target="_blank" rel="noopener noreferrer">点击直接进入Azure应用注册</a>，登录账号使用申请到的Microsoft 365 E5的<strong>管理员账户</strong>（账户名类似XXXX@YYYY.onmicrosoft.com格式）。
2.登录完成后点击右上角的“门户”按钮进入Azure管理中心，在搜索栏内输入“应用注册”，点击进入<a href="https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade" target="_blank" rel="noopener noreferrer">（若应用注册搜索不到请点击此处直接进入）</a>。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618170032256.png" alt="图片" loading="lazy">
3.单击“新注册”按钮
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2020061817051341.png" alt="图片" loading="lazy">
4.配置应用 应用名称随意写、注意可访问性选项选择最后一项、重定向URL暂时不填 、完成后点击注册
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618170801323.png" alt="图片" loading="lazy"></li>
</ol>
<h3 id="_1-2-配置应用重定向url-身份验证" tabindex="-1"> 1.2 配置应用重定向URL（身份验证）</h3>
<p>1.先点击“概述”，然后点击“添加重定向URL”，进入重定向URL配置界面，<strong>下图中的应用程序(客户端)ID即为&quot;客户端ID&quot;</strong>。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2020061817121972.png" alt="图片" loading="lazy">
2.点击“添加平台”，再点击“移动和桌面应用程序”，
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618171501396.png" alt="图片" loading="lazy">
3.继续勾选中第一个URL，最后点击底部的“配置”，该URL为“<a href="https://login.microsoftonline.com/common/oauth2/nativeclient%E2%80%9D%E4%B9%9F%E5%8F%AF%E6%89%8B%E5%8A%A8%E6%B7%BB%E5%8A%A0%E3%80%82" target="_blank" rel="noopener noreferrer">https://login.microsoftonline.com/common/oauth2/nativeclient”也可手动添加。</a>
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618171651338.png" alt="图片" loading="lazy">
4.配置默认客户端类型将应用程序视为公共客户端 点击切换按钮为“是” ，最后点击“保存”按钮保存。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618171850779.png" alt="图片" loading="lazy"></p>
<h2 id="_2-配置应用程序的api权限-重要" tabindex="-1"> 2 配置应用程序的API权限（重要）</h2>
<p><strong>小白提示：建议选择“委托的权限(用户登录)”该权限类型，调用API较多，操作步骤较少简单粗暴，调用成功几率高</strong></p>
<p>注册的应用程序API权限类型有两种，其主要区别如下表所示：</p>
<table>
<thead>
<tr>
<th>权限类型</th>
<th><strong>委托的权限(用户登录)</strong></th>
<th><strong>应用程序权限(非用户登录)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>官方释义</td>
<td>应用程序必须以登录用户身份访问API</td>
<td>应用程序在用户未登录的情况下作为后台服务或守护程序运行</td>
</tr>
<tr>
<td>需要的信息</td>
<td>账户名称+账户密码+应用程序(客户端)ID</td>
<td>账户名称+客户端机密+应用程序(客户端)ID</td>
</tr>
<tr>
<td>功能影响</td>
<td>程序中所有API均可调用</td>
<td>部分API权限受限无法调用(官方限制)</td>
</tr>
<tr>
<td>API权限配置</td>
<td>可由程序自动配置添加API权限</td>
<td>必须手动配置API权限</td>
</tr>
<tr>
<td>程序颜色标识</td>
<td>蓝色</td>
<td>深青色</td>
</tr>
</tbody>
</table>
<p>根据所选的API权限类型在：<strong>2.1 选择“委托的权限(用户登录)”类型的API</strong>或者<strong>2.2 选择“应用程序权限(非用户登录)”类型的API</strong>中选择性阅读。</p>
<h3 id="_2-1-选择-委托的权限-用户登录-类型的api" tabindex="-1"> 2.1 选择“委托的权限(用户登录)”类型的API</h3>
<h4 id="_2-1-1-使用程序自动请求配置api权限" tabindex="-1"> 2.1.1 使用程序自动请求配置API权限</h4>
<p>1.点击“添加账号”，API调用方式选择“登陆调用”，正确填写“MS365 E5账号”和“应用程序（客户端）ID”后点击“启动自动授权”。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20210308150608437.png" alt="图片" loading="lazy"></p>
<p>2.在弹出的登陆页面中输入你的管理员账户名和密码登录（<strong>该账户必须为全局管理员账户且拥有该客户端ID的控制权限</strong>），登录成功时弹出“请求征得许可界面”，滚动到页面最底部勾选“代表组织同意”，最后点击“接受”。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200628135742984.png" alt="图片" loading="lazy">
3.判断是否添加API权限成功：首先程序提示授权成功，其次用管理员账户登录Azure查看应用的API权限，发现所有需求的权限全部添加或可以成功调用均视为已添加成功。
ng)
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20210323142238814.png" alt="图片" loading="lazy"></p>
<h4 id="_2-1-2-手动配置api权限" tabindex="-1"> 2.1.2 手动配置API权限</h4>
<p>1.点击“API权限”-“添加权限”-“Microsoft Graph”
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2020061819283823.png" alt="图片" loading="lazy">
2.选择“委托的权限”<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618172538991.png" alt="图片" loading="lazy">
3.根据下方列出的API权限需求表来勾选所对应的API权限，全部选择完成后点击&quot;添加权限&quot;。</p>
<p><strong>BookingsAppointment.ReadWrite.All; Calendars.Read; Contacts.Read; Directory.Read.All;
Files.Read.All; Files.ReadWrite.All; Group.Read.All; Mail.Read; Mail.Send; MailboxSettings.Read;
Notes.Read.All; People.Read.All; Presence.Read.All; Sites.Read.All; Tasks.ReadWrite; User.Read.All;</strong></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618172627969.png" alt="图片" loading="lazy">
添加完成的效果如图
<strong>如果没有“代表XXX授予管理员同意”按钮 说明该账号不是管理员账号 换登管理员账号创建应用</strong>
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20201112111140479.png" alt="图片" loading="lazy">
4.最后点击代表XXX授予管理员同意,对话框选择“是”（该图包含了当前程序“委托的权限(用户登录)”全部API所需要的权限)。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20201112110505347.png" alt="图片" loading="lazy"></p>
<h3 id="_2-2-选择-应用程序权限-非用户登录-类型的api" tabindex="-1"> 2.2 选择“应用程序权限(非用户登录)”类型的API</h3>
<h4 id="_2-2-1-手动配置api权限" tabindex="-1"> 2.2.1 手动配置API权限</h4>
<p>1.点击“API权限”-“添加权限”-“Microsoft Graph”
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2020061819283823-165380581365141.png" alt="图片" loading="lazy">
2.选择“应用程序权限”
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200801120027971.png" alt="图片" loading="lazy">
3.根据程序中列出的API权限需求表来勾选所对应的API权限，全部选择完成后点击&quot;添加权限&quot;。
<strong>Calendars.Read; Contacts.Read; Directory.Read.All; Files.Read.All; Files.ReadWrite.All; Mail.Read;
Mail.Send; MailboxSettings.Read; Notes.Read.All; Sites.Read.All; User.Read.All;</strong>
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200618172627969-165380581693146.png" alt="图片" loading="lazy">
添加完成的效果如图
<strong>如果没有“代表XXX授予管理员同意”按钮 说明该账号不是管理员账号 换登管理员账号创建应用</strong>
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200801120623311.png" alt="图片" loading="lazy">
4.最后点击代表XXX授予管理员同意,对话框选择“是”（该图包含了当前程序“应用程序权限(非用户登录)”全部API所需要的权限）。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200801120818260.png" alt="图片" loading="lazy"></p>
<h4 id="_2-2-2-创建客户端密码" tabindex="-1"> 2.2.2 创建客户端密码</h4>
<p>1.点击“证书密码”-“新客户端密码”-“24个月”-“添加”
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20210609101116972.png" alt="图片" loading="lazy"></p>
<p>2.点击“值”该列中的“复制”（不要复制&quot;ID&quot;列中的值），并立即将该密码保存至电脑，<strong>保存的值即为“客户端密码”</strong>， 注：该值必须立即保存，退出该页面后将永远无法查看。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2020120711360840.jpeg" alt="图片" loading="lazy"></p>
<h2 id="_3-使用程序进行api调用" tabindex="-1"> 3 使用程序进行API调用</h2>
<h5 id="创建一个新的e5子账户-可选步骤" tabindex="-1"> 创建一个新的E5子账户(可选步骤)</h5>
<p>登入E5管理员账户进入管理员界面，创建一个新的子账户，使用这个子账户登录程序调用API。
为什么建议这样做：Microsoft 365 E5 Renew Plus中的部分API包含了写操作，例如Onedrive的API，这些API在随机模式下会生成大量垃圾邮件和文件（虽然单独为此设立了一个文件夹），部分人可能会对此行为非常介意，而且程序频繁的读写可能会对您正常使用账户造成影响，因此不建议使用管理员账户登录。</p>
<h3 id="_3-1-添加一个账户" tabindex="-1"> 3.1 添加一个账户</h3>
<p>点击“开始运行”-“添加账号”
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/a4451a28afdb4b01b18f566feaf07759.png" alt="图片" loading="lazy"></p>
<p>这里可以切换API调用方式但也需要更改对应的填写内容</p>
<p>登录调用方式填写
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20210307154000125.png" alt="图片" loading="lazy">
非登录调用方式填写
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20210307154255163.png" alt="图片" loading="lazy"></p>
<p>最后点击确定
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/202103071542145.png" alt="图片" loading="lazy"></p>
<h3 id="_3-2-开始运行" tabindex="-1"> 3.2 开始运行</h3>
<p>点击“开始运行”
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/60b549fee8464ba08722d38b4cb999c0.png" alt="图片" loading="lazy"></p>
<h1 id="写在最后面" tabindex="-1"> 写在最后面</h1>
<h2 id="关闭e5账户登录双重验证" tabindex="-1"> 关闭E5账户登录双重验证</h2>
<p><a href="https://account.activedirectory.windowsazure.com/UserManagement/MultifactorVerification.aspx" target="_blank" rel="noopener noreferrer">点击进入Office 365 E5账户多重身份验证管理</a>，按照下图配置即可关闭E5账户登录的双重验证。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20210519091511446.png" alt="图片" loading="lazy">
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20210519091736252.png" alt="图片" loading="lazy"></p>
<h2 id="关闭azure中api调用的双重验证" tabindex="-1"> 关闭Azure中API调用的双重验证</h2>
<p><a href="https://aad.portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview" target="_blank" rel="noopener noreferrer">点击进入Azure Active Directory管理中心</a>，按照下图配置即可关闭Azure中API调用的双重验证。
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20201010153543698.png" alt="图片" loading="lazy"></p>
<h2 id="查询续订剩余天数" tabindex="-1"> 查询续订剩余天数</h2>
<p><a href="https://developer.microsoft.com/zh-cn/microsoft-365/profile" target="_blank" rel="noopener noreferrer">点击查询续订剩余天数(使用申请E5账号的账户登录)</a></p>
<h2 id="关于续订" tabindex="-1"> 关于续订</h2>
<p>E5续订执行是微软统一的具有一定时间周期的续订，如果你的E5订阅剩余天数少于等于30天、并收到了未检测到开发活动的警告邮件且仪表盘显示标红文字“此订阅处于非活动状态且即将过期”，请不要慌张。根据微软客服官方说法是：“订阅只有在剩余最后1天才给续期”，然而根据众多E5账号的续订情况来统计，大部分账号是在少于30天续期的，极少欧洲人是在大于30天的时候续期。</p>
<p>本人E5账户收到过两次未活跃警告，微软客服解释说：这种警告邮件属于系统自动发送的(邮件会在剩余第30天的时候发送)，无需理会它，至于出现文字标红文字“此订阅处于非活动状态且即将过期”，也为系统自动提示，只要保证仪表盘上的文字标注为“<strong>可续订</strong> E5的订阅”就可以了，即便是真的过期了没有续上也是可以从仪表盘申诉的。</p>
<h3 id="仪表盘变化" tabindex="-1"> 仪表盘变化</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2020082317495235.png" alt="图片" loading="lazy">
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20210129090340925.png" alt="图片" loading="lazy"></p>
<h3 id="续订邮件" tabindex="-1"> 续订邮件</h3>
<p>第一次续订
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200820125542472.jpeg" alt="图片" loading="lazy">
第二次续订
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20201031134336350.png" alt="图片" loading="lazy"></p>
<h3 id="警告邮件" tabindex="-1"> 警告邮件</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20200820125531157.jpeg" alt="图片" loading="lazy"></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-12T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">快速排序</title>
    <id>https://blog.ciberviler.top/algorithm/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F.html</id>
    <link href="https://blog.ciberviler.top/algorithm/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F.html"/>
    <updated>2022-05-29T03:37:51.000Z</updated>
    <summary type="html">快速排序</summary>
    <content type="html"><![CDATA[<h1 id="快速排序" tabindex="-1"> 快速排序</h1>
<h2 id="一、简介" tabindex="-1"> 一、简介</h2>
<p>快速排序（Quick sort）是对冒泡排序的一种改进，是非常重要且应用比较广泛的一种高效率排序算法。</p>
<h2 id="二、算法思路" tabindex="-1"> 二、算法思路</h2>
<p>快速排序是通过多次比较和交换来实现排序，在一趟排序中把将要排序的数据分成两个独立的部分，对这两部分进行排序使得其中一部分所有数据比另一部分都要小，然后继续递归排序这两部分，最终实现所有数据有序。</p>
<p>大致步骤如下：</p>
<h3 id="第一种" tabindex="-1"> 第一种 ：</h3>
<ul>
<li>
<p>1.首先设置一个分界值也就是基准值又是也称为监视哨，通过该分界值将数据分割成两部分。</p>
</li>
<li>
<p>2.将大于或等于分界值的数据集中到右边，小于分界值的数据集中到左边。一趟排序过后，左边部分中各个数据元素都小于分界值，而右边部分中各数据元素都大于或等于分界值，且右边部分个数据元素皆大于左边所有数据元素。</p>
</li>
<li>
<p>3.然后，左边和右边的数据可以看成两组不同的部分，重复上述1和2步骤</p>
</li>
<li>
<p>当左右两部分都有序时，整个数据就完成了排序。</p>
</li>
</ul>
<h3 id="第二种" tabindex="-1"> 第二种 ：</h3>
<ul>
<li>
<p>1.从序列中选择一个轴点元素pivot从最后一个元素向前遍历我们的策略是：每次选择第0位置的元素为轴点元素</p>
</li>
<li>
<p>2.利用pivot将数组分割成2个子数组将小于pivot的元素放在pivot的左侧将大于pivot的元素放在pivot的右侧将等于pivot的元素放在pivot的哪侧都可以，本文选择左侧</p>
</li>
<li>
<p>3.对子序列进行步骤1和步骤2操作直到不能再分割(子序列中只剩下一个元素)</p>
</li>
</ul>
<p>先介绍了下快排的执行流程，脑海中先有个大致的思路。总结一下就是先把一个大数组通过第一个元素将之分割成2个小的数组，并且以该轴点为界，小于它的在左边，大于它的在右边，然后递归对2个小数组执行步骤1、2操作，直到不能再分割。也许理解了一部分，别担心，接下来我会通过一个例子来带你走一遍上述的流程。</p>
<h2 id="三、算法步骤图解" tabindex="-1"> 三、算法步骤图解</h2>
<p>首先设置三个参数，first指向区间左端，last指向区间右端，key为当前的分界值。</p>
<p>从待排序的数据元素中选取一个通常为第一个作为基准值元素（key）key=num[0]，设置双指针first指向区间左端，last指向区间右端。</p>
<h3 id="例子演示一" tabindex="-1"> <strong>例子演示一</strong></h3>
<p>首先设置三个参数，first指向区间左端，last指向区间右端，key为当前的分界值。</p>
<p>从待排序的数据元素中选取一个通常为第一个作为基准值元素（key）key=num[0]，设置双指针first指向区间左端，last指向区间右端。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/978b84a9b541a0db3b191993bc9fbd62.png" alt="图片" loading="lazy"></p>
<p><strong>一、</strong></p>
<p>key 首先与 num[last] 进行比较，如果 num[last]&lt;key，则num[first]=num[last]将这个比key小的数放到左边去，如果num[last]&gt;=key则- -last，再拿num[last]与key进行比较，直到num[last]&lt;key交换元素为止。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/47163d859bc7517570716e1853e67ebb.png" alt="图片" loading="lazy"></p>
<p><strong>二、</strong>
num[last]&lt;key交换元素后，转向左边部分，用num[first]与key进行比较，如果num[first]&lt;key,则++first，然后继续进行比较，直至num[first]&gt;key,则将num[last]=num[first]。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/41a9849c2ee0619ca10dca2f0c942251.png" alt="图片" loading="lazy">
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/c3098c79e69a9547ce8996b310ebf296.png" alt="图片" loading="lazy"></p>
<p><strong>三、</strong>
重复上述一二步骤</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1e415f1728b314dfc9cd1c90b1dcd9af.png" alt="图片" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/ea40064bf09b7cce290866b0b47061aa.png" alt="图片" loading="lazy">
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/50a1d73bad725027a2029378d10fbe8d.png" alt="图片" loading="lazy">
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/a958b26d073c9bb0028b7a789934edfc.png" alt="图片" loading="lazy">
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/9d32ef4a4b40b025e3d1c55793e6b168.png" alt="图片" loading="lazy">
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/f9094712d3320eba982b4afe01b9eaa5.png" alt="图片" loading="lazy">
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/4f16335e5225369f133a2c93a70efcf4.png" alt="图片" loading="lazy">
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/a0b398c6f9c2600cc551a4e21b35ccf4.png" alt="图片" loading="lazy">
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/4c1e553a89a57abe4ceaf726d7f52924.png" alt="图片" loading="lazy"></p>
<p><strong>四、</strong>
第一趟排序结束，得到[2,11,15,20,9,5] <em><strong>23</strong></em> [56,45,35] 然后对左右子数列进行同样的操作。</p>
<p><em><strong>2</strong></em> [11,15,20,9,5] <em><strong>23</strong></em> [35,45] <em><strong>56</strong></em></p>
<p><em><strong>2</strong></em> [5,9] <em><strong>11</strong></em> [20,15] <em><strong>23 35 45 56</strong></em></p>
<p><em><strong>2 5 9 11 15 20 23 35 45 56</strong></em></p>
<p>完成从小到大的排序</p>
<h3 id="例子演示二" tabindex="-1"> <strong>例子演示二</strong></h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/d53f8794a4c27d1ecff02604e5162266dfc43863.png" alt="img" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/8b82b9014a90f60307aca9253bd63c13b151ed84.png" alt="img" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/7aec54e736d12f2e95af5d264e065a6a8435681e.png" alt="img" loading="lazy"></p>
<p><strong>(注：图片中的单词start与begin同义)</strong></p>
<p><strong>解释下调头的事情：</strong></p>
<p>开始的时候是从end往前遍历大于pivot的值就end++；小于pivot的值时，end不变，并且将end指向的值替换begin指向的值，begin++从beigin往后遍历小于pivot的值就begin++；小于pivot的值时，begin不变，并且将begin指向的值替换end指向的值，end++这样交替进行</p>
<h3 id="动图演示" tabindex="-1"> 动图演示</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/quickSort.gif" alt="img" loading="lazy"></p>
<h2 id="四、算法性能分析" tabindex="-1"> 四、算法性能分析</h2>
<p><strong>最好情况</strong>
每次数据元素都能平均的分成两个部分。得到一个完全二叉树。如果有n个数据元素，那么数的深度为
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/cc536403e247bf6f9b83d29d2ab656ae.png" alt="图片" loading="lazy">
时间复杂度为O(nlogn)</p>
<p><strong>最坏情况</strong>
在最坏的情况下，这个数仅有右子树或左子树，比较次数为 （n-1）+（n-2) + (n-3) + … +1=n*(n-1)/2 ,因此时间复杂度为O(n^2),在待排序数据元素已经有序的情况下快速排序时间复杂度最高</p>
<p>空间复杂度为O(n）
快速排序是一种不稳定的排序算法，会改变数据元素的相对位置，也是内排序中平均效率最高的排序算法。</p>
<h2 id="五、代码实现" tabindex="-1"> 五、代码实现</h2>
<h3 id="c" tabindex="-1"> <strong>C</strong></h3>
<div><pre><code><span>void</span> <span>quick_sort</span><span>(</span><span>int</span> <span>*</span>num<span>,</span><span>int</span> l<span>,</span><span>int</span> r<span>)</span><span>{</span>
	<span>//如果小于等于1个数据元素·直接返回结束快排函数 r为数组元素总个数</span>
	<span>if</span><span>(</span>l<span>+</span><span>1</span><span>>=</span>r<span>)</span><span>{</span>
		<span>return</span> <span>;</span>
	<span>}</span>
	<span>int</span> first<span>=</span>l<span>,</span>last<span>=</span>r<span>-</span><span>1</span><span>,</span>key<span>=</span>num<span>[</span>first<span>]</span><span>;</span>
	<span>while</span><span>(</span>first<span>&lt;</span>last<span>)</span><span>{</span>
		<span>while</span><span>(</span>first<span>&lt;</span>last<span>&amp;&amp;</span>num<span>[</span>last<span>]</span><span>>=</span>key<span>)</span><span>{</span>
			<span>--</span>last<span>;</span>
		<span>}</span>
		<span>//如果值小于 key分界值 交换 </span>
		num<span>[</span>first<span>]</span><span>=</span>num<span>[</span>last<span>]</span><span>;</span>
		<span>while</span><span>(</span>first<span>&lt;</span>last<span>&amp;&amp;</span>num<span>[</span>first<span>]</span><span>&lt;</span>key<span>)</span><span>{</span>
			<span>++</span>first<span>;</span>
		<span>}</span>
		<span>//如果值大于key分界值 交换 </span>
		num<span>[</span>last<span>]</span><span>=</span>num<span>[</span>first<span>]</span><span>;</span>
	<span>}</span>
	num<span>[</span>first<span>]</span><span>=</span>key<span>;</span>
	<span>//递归左右部分进行快排 </span>
	<span>quick_sort</span><span>(</span>num<span>,</span>l<span>,</span>first<span>)</span><span>;</span>
	<span>quick_sort</span><span>(</span>num<span>,</span>first<span>+</span><span>1</span><span>,</span>r<span>)</span><span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="java" tabindex="-1"> <strong>Java</strong></h3>
<div><pre><code><span>public</span> <span>static</span> <span>int</span><span>[</span><span>]</span> <span>quick_sort</span><span>(</span><span>int</span><span>[</span><span>]</span> num<span>,</span> <span>int</span> l<span>,</span> <span>int</span> r<span>)</span><span>{</span>
<span>//r为数组元素总个数，last下标等于r-1</span>
        <span>int</span> first<span>=</span>l<span>,</span>last<span>=</span>r<span>-</span><span>1</span><span>,</span>key<span>=</span>num<span>[</span>first<span>]</span><span>;</span>
        <span>while</span><span>(</span>first<span>&lt;</span>last<span>)</span><span>{</span>
            <span>while</span><span>(</span>first<span>&lt;</span>last<span>&amp;&amp;</span>num<span>[</span>last<span>]</span><span>>=</span>key<span>)</span><span>{</span>
                <span>--</span>last<span>;</span>
            <span>}</span>
            <span>//如果值小于 key分界值 交换</span>
            num<span>[</span>first<span>]</span><span>=</span>num<span>[</span>last<span>]</span><span>;</span>
            <span>while</span><span>(</span>first<span>&lt;</span>last<span>&amp;&amp;</span>num<span>[</span>first<span>]</span><span>&lt;</span>key<span>)</span><span>{</span>
                <span>++</span>first<span>;</span>
            <span>}</span>
            <span>//如果值大于key分界值 交换</span>
            num<span>[</span>last<span>]</span><span>=</span>num<span>[</span>first<span>]</span><span>;</span>
        <span>}</span>
        num<span>[</span>first<span>]</span><span>=</span>key<span>;</span>
        <span>//递归左右部分进行快排</span>
         <span>if</span> <span>(</span>first<span>></span>l<span>)</span> <span>{</span>
             num<span>=</span><span>quick_sort</span><span>(</span>num<span>,</span> l<span>,</span> first<span>)</span><span>;</span>
         <span>}</span>
        <span>if</span> <span>(</span>first<span>+</span><span>1</span><span>&lt;</span>r<span>)</span><span>{</span>
            num<span>=</span><span>quick_sort</span><span>(</span>num<span>,</span>first<span>+</span><span>1</span><span>,</span>r<span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> num<span>;</span>
    <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="六、视频" tabindex="-1"> 六、视频</h2>
<video id="video" controls="" preload="none" width="720px">
      <source id="mp4" src="http://alist.ciberviler.top/d/ecloud180/videos/blogVideo/quickSort.mp4" type="video/mp4">
</video>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="algorithm" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-30T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">算法</title>
    <id>https://blog.ciberviler.top/algorithm/</id>
    <link href="https://blog.ciberviler.top/algorithm/"/>
    <updated>2022-05-28T14:45:05.000Z</updated>
    <summary type="html">各类算法，刷题</summary>
    <content type="html"><![CDATA[<p align="center"> 
  <img src="https://metrics.lecoq.io/xlc520?template=classic&isocalendar=1&languages=1&people=1&activity=1&achievements=1&lines=1&repositories=1&notable=1&introduction=1&pagespeed=1&repositories=100&repositories.batch=100&repositories.forks=false&repositories.affiliations=owner&isocalendar.duration=full-year&languages.limit=8&languages.threshold=0%&languages.colors=github&languages.sections=most-used&languages.indepth=false&languages.analysis.timeout=15&languages.categories=markup%2C programming&languages.recent.categories=markup%2C programming&languages.recent.load=300&languages.recent.days=14&people.limit=24&people.identicons=false&people.identicons.hide=false&people.size=28&people.types=followers%2C following&people.shuffle=false&activity.limit=5&activity.load=300&activity.days=14&activity.visibility=all&activity.timestamps=false&activity.filter=all&achievements.threshold=C&achievements.secrets=true&achievements.display=detailed&achievements.limit=0&notable.from=organization&notable.repositories=false&notable.indepth=false&notable.types=commit&repositories.featured= xlc520%2Fxlc520.github.io&introduction.title=true&pagespeed.url=xlc520.github.io&pagespeed.detailed=false&pagespeed.screenshot=false&config.timezone=Asia%2FShanghai" /> 
</p>
<p align="center"> 
  您是第  <img src="https://profile-counter.glitch.me/xlc520/count.svg" />  位访问者
</p>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="algorithm" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-28T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">牛客网-华为机试</title>
    <id>https://blog.ciberviler.top/algorithm/%E7%89%9B%E5%AE%A2%E7%BD%91-%E5%8D%8E%E4%B8%BA%E6%9C%BA%E8%AF%95.html</id>
    <link href="https://blog.ciberviler.top/algorithm/%E7%89%9B%E5%AE%A2%E7%BD%91-%E5%8D%8E%E4%B8%BA%E6%9C%BA%E8%AF%95.html"/>
    <updated>2022-05-31T13:51:34.000Z</updated>
    <summary type="html">华为笔试面试机考在线练习</summary>
    <content type="html"><![CDATA[<h1 id="牛客网-华为机试" tabindex="-1"> 牛客网-华为机试</h1>
<h2 id="hj1-字符串最后一个单词的长度" tabindex="-1"> <strong>HJ1</strong> <strong>字符串最后一个单词的长度</strong></h2>
<h3 id="描述" tabindex="-1"> 描述</h3>
<p>计算字符串最后一个单词的长度，单词以空格隔开，字符串长度小于5000。（注：字符串末尾不以空格为结尾）</p>
<h3 id="输入描述" tabindex="-1"> 输入描述：</h3>
<p>输入一行，代表要计算的字符串，非空，长度小于5000。</p>
<h3 id="输出描述" tabindex="-1"> 输出描述：</h3>
<p>输出一个整数，表示输入字符串最后一个单词的长度。</p>
<h3 id="示例1" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>hello nowcoder
</code></pre><div aria-hidden="true"><div></div></div></div><p>输出：</p>
<div><pre><code>8
</code></pre><div aria-hidden="true"><div></div></div></div><p>说明：</p>
<div><pre><code>最后一个单词为nowcoder，长度为8   
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="代码" tabindex="-1"> 代码：</h3>
<ul>
<li>方法一: 系统函数</li>
</ul>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Scanner</span></span><span>;</span>

<span>// 注意类名必须为 Main, 不要有任何 package xxx 信息</span>
<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>Scanner</span> sc <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>String</span> str <span>=</span> sc<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>;</span>
        <span>String</span><span>[</span><span>]</span> s <span>=</span> str<span>.</span><span>split</span><span>(</span><span>" "</span><span>)</span><span>;</span> <span>//正则表达式实用性更强( str.split("\\s+"))</span>
        <span>int</span> length <span>=</span> s<span>[</span>s<span>.</span>length <span>-</span> <span>1</span><span>]</span><span>.</span><span>length</span><span>(</span><span>)</span><span>;</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>length<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>方法二: 反过来打印</li>
</ul>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Scanner</span></span><span>;</span>

<span>// 注意类名必须为 Main, 不要有任何 package xxx 信息</span>
<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>Scanner</span> sc <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>String</span> str <span>=</span> sc<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>;</span>
        <span>int</span> length <span>=</span> str<span>.</span><span>length</span><span>(</span><span>)</span><span>;</span>
        <span>int</span> count <span>=</span> <span>0</span><span>;</span>
        <span>for</span> <span>(</span><span>int</span> i <span>=</span> length <span>-</span> <span>1</span><span>;</span> i <span>>=</span> <span>0</span><span>;</span> i<span>--</span><span>)</span> <span>{</span>
            <span>if</span> <span>(</span>str<span>.</span><span>charAt</span><span>(</span>i<span>)</span><span>==</span><span>' '</span><span>)</span> <span>{</span> <span>// 或者 if (str.substring(i, i + 1).equals(" ")) {</span>
                <span>break</span><span>;</span>
            <span>}</span>
            count<span>++</span><span>;</span>
        <span>}</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>count<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="hj2-计算某字符出现次数" tabindex="-1"> <strong>HJ2</strong> <strong>计算某字符出现次数</strong></h2>
<h3 id="描述-1" tabindex="-1"> 描述</h3>
<p>写出一个程序，接受一个由字母、数字和空格组成的字符串，和一个字符，然后输出输入字符串中该字符的出现次数。（不区分大小写字母）</p>
<p>数据范围： 1 \le n \le 1000 \1≤<em>n</em>≤1000</p>
<h3 id="输入描述-1" tabindex="-1"> 输入描述：</h3>
<p>第一行输入一个由字母和数字以及空格组成的字符串，第二行输入一个字符。</p>
<h3 id="输出描述-1" tabindex="-1"> 输出描述：</h3>
<p>输出输入字符串中含有该字符的个数。（不区分大小写字母）</p>
<h3 id="示例1-1" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>ABCabc
A
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>输出：</p>
<div><pre><code>2
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="代码-1" tabindex="-1"> 代码：</h3>
<ul>
<li>一、</li>
</ul>
<div><pre><code><span>/**
     * 二：计算某字符出现的次数
     * 1.接收输入的第一个字符串，并转换为小写。（完整字符串str1）
     * 2.接收输入的第二个字符串，并转换为小写。（单个字符str2）
     * 3.将str1中的str2字符串全部替换为 “”
     * 4.用str1.length-str2.length = 出现次数
     */</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Scanner</span></span><span>;</span>

<span>// 注意类名必须为 Main, 不要有任何 package xxx 信息</span>
<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span><span>{</span>
        <span>Scanner</span> input <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>// 完整字符串</span>
        <span>String</span> str1 <span>=</span> input<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>.</span><span>toLowerCase</span><span>(</span><span>)</span><span>;</span>
        <span>// 单个字符串</span>
        <span>String</span> str2 <span>=</span> input<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>.</span><span>toLowerCase</span><span>(</span><span>)</span><span>;</span>
        <span>// 完整字符的长度-单个字符长度 = 出现的次数</span>
        <span>int</span> num <span>=</span> str1<span>.</span><span>length</span><span>(</span><span>)</span> <span>-</span> str1<span>.</span><span>replaceAll</span><span>(</span>str2<span>,</span><span>""</span><span>)</span><span>.</span><span>length</span><span>(</span><span>)</span><span>;</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>num<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>二、</li>
</ul>
<div><pre><code>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Scanner</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span>regex<span>.</span></span><span>Matcher</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span>regex<span>.</span></span><span>Pattern</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>Scanner</span> scanner <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>String</span> string <span>=</span> scanner<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>;</span>
        <span>String</span> character <span>=</span> scanner<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>;</span>
        <span>Pattern</span> compile <span>=</span> <span>Pattern</span><span>.</span><span>compile</span><span>(</span>character<span>,</span> <span>Pattern</span><span>.</span>CASE_INSENSITIVE<span>)</span><span>;</span>
        <span>Matcher</span> matcher <span>=</span> compile<span>.</span><span>matcher</span><span>(</span>string<span>)</span><span>;</span>
        <span>int</span> count <span>=</span> <span>0</span><span>;</span>
        <span>while</span> <span>(</span>matcher<span>.</span><span>find</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            count<span>++</span><span>;</span>
        <span>}</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>count<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="hj3-明明的随机数" tabindex="-1"> <strong>HJ3</strong> <strong>明明的随机数</strong></h2>
<h3 id="描述-2" tabindex="-1"> 描述</h3>
<p>明明生成了N<em>N</em>个1到500之间的随机整数。请你删去其中重复的数字，即相同的数字只保留一个，把其余相同的数去掉，然后再把这些数从小到大排序，按照排好的顺序输出。</p>
<p>数据范围： 1 \le n \le 1000 \1≤<em>n</em>≤1000 ，输入的数字大小满足 1 \le val \le 500 \1≤<em>v<strong>a</strong>l</em>≤500</p>
<h3 id="输入描述-2" tabindex="-1"> 输入描述：</h3>
<p>第一行先输入随机整数的个数 N 。 接下来的 N 行每行输入一个整数，代表明明生成的随机数。 具体格式可以参考下面的&quot;示例&quot;。</p>
<h3 id="输出描述-2" tabindex="-1"> 输出描述：</h3>
<p>输出多行，表示输入数据处理后的结果</p>
<h3 id="示例1-2" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>3
2
2
1
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p>输出：</p>
<div><pre><code>1
2
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>说明：</p>
<div><pre><code>输入解释：
第一个数字是3，也即这个小样例的N=3，说明用计算机生成了3个1到500之间的随机整数，接下来每行一个随机数字，共3行，也即这3个随机数字为：
2
2
1
所以样例的输出为：
1
2     
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="代码-2" tabindex="-1"> 代码：</h3>
<p>一、</p>
<p>题目有两个要求：</p>
<ul>
<li>去重</li>
<li>排序</li>
</ul>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Test</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>Scanner</span> sc <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>//获取个数</span>
        <span>int</span> num <span>=</span> sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
        <span>//创建TreeSet进行去重排序</span>
        <span>TreeSet</span> set <span>=</span> <span>new</span> <span>TreeSet</span><span>(</span><span>)</span><span>;</span>
        <span>//输入</span>
        <span>for</span><span>(</span><span>int</span> i <span>=</span><span>0</span> <span>;</span> i <span>&lt;</span> num <span>;</span>i<span>++</span><span>)</span><span>{</span>
            set<span>.</span><span>add</span><span>(</span>sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>}</span>
        <span>//输出</span>
        <span>Iterator</span> iterator <span>=</span> set<span>.</span><span>iterator</span><span>(</span><span>)</span><span>;</span>
        <span>while</span> <span>(</span>iterator<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span><span>{</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>iterator<span>.</span><span>next</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>二、</p>
<p>主要的思路就是空间换时间，还有利用数组的下标。</p>
<ol>
<li>创建一个1001个数字的数组，在输入一个1-1000的数字时将改数组对应下标的值改为1。</li>
<li>然后再从小到大循环数组中值为1的下标输出，因为下标本身有序的因此就不用排序。</li>
</ol>
<div><pre><code>    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>Scanner</span> scanner <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span> <span>(</span>scanner<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>int</span> num <span>=</span> scanner<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
            <span>int</span><span>[</span><span>]</span> arr <span>=</span> <span>new</span> <span>int</span><span>[</span><span>1001</span><span>]</span><span>;</span>
            <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> num<span>;</span> i<span>++</span><span>)</span> <span>{</span>
                <span>int</span> n <span>=</span> scanner<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
                arr<span>[</span>n<span>]</span> <span>=</span> <span>1</span><span>;</span>
            <span>}</span>
            <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>1</span><span>;</span> i <span>&lt;</span> arr<span>.</span>length<span>;</span> i<span>++</span><span>)</span> <span>{</span>
                <span>if</span> <span>(</span>arr<span>[</span>i<span>]</span> <span>==</span> <span>1</span><span>)</span> <span>{</span>
                    <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>i<span>)</span><span>;</span>
                <span>}</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="hj4-字符串分隔" tabindex="-1"> <strong>HJ4</strong> <strong>字符串分隔</strong></h2>
<h3 id="描述-3" tabindex="-1"> 描述</h3>
<p>•输入一个字符串，请按长度为8拆分每个输入字符串并进行输出；</p>
<p>•长度不是8整数倍的字符串请在后面补数字0，空字符串不处理。</p>
<h3 id="输入描述-3" tabindex="-1"> 输入描述：</h3>
<p>连续输入字符串(每个字符串长度小于等于100)</p>
<h3 id="输出描述-3" tabindex="-1"> 输出描述：</h3>
<p>依次输出所有分割后的长度为8的新字符串</p>
<h3 id="示例1-3" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>abc
</code></pre><div aria-hidden="true"><div></div></div></div><p>输出：</p>
<div><pre><code>abc00000
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="代码-3" tabindex="-1"> 代码：</h3>
<h4 id="一、" tabindex="-1"> 一、</h4>
<p>思路</p>
<ol>
<li>需要输入字符串，用到Scanner和hasNext()。
（1）建立 Scanner sc = new Scanner(<a href="http://System.in" target="_blank" rel="noopener noreferrer">System.in</a>);
（2）判断有无输入用sc.hasNext().接收字符串使用sc.nextLine().</li>
<li>一次性接受全部的字符串，对8取余，获知需要补0的位数。使用StringBuilder中的append()函数进行字符串修改，别忘了toString()。
字符串缓冲区的建立：StringBuilder sb = new StringBuilder();</li>
<li>输出时，截取前8位进行输出，并更新字符串。用到str.substring()函数：
（1）str.substring(i)意为截取从字符索引第i位到末尾的字符串。
（2）str.substring(i,j)意为截取索引第i位到第（j-1）位字符串。包含i，不包含j。</li>
</ol>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>
<span>public</span> <span>class</span> <span>Main</span><span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span><span>{</span>
        <span>Scanner</span> sc <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span><span>(</span>sc<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span><span>{</span>
            <span>String</span> str <span>=</span> sc<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>;</span>
            <span>StringBuilder</span> sb <span>=</span> <span>new</span> <span>StringBuilder</span><span>(</span><span>)</span><span>;</span><span>//牢记字符串缓冲区的建立语法</span>
            sb<span>.</span><span>append</span><span>(</span>str<span>)</span><span>;</span><span>//字符串缓冲区的加入</span>
            <span>int</span> size <span>=</span> str<span>.</span><span>length</span><span>(</span><span>)</span><span>;</span>
            <span>int</span> addZero <span>=</span> <span>8</span> <span>-</span> size<span>%</span><span>8</span><span>;</span><span>//addzero的可能值包括8</span>
            <span>while</span><span>(</span><span>(</span>addZero <span>></span> <span>0</span><span>)</span><span>&amp;&amp;</span><span>(</span>addZero<span>&lt;</span><span>8</span><span>)</span><span>)</span><span>{</span><span>//注意边界调节，避免addzero=8</span>
                sb<span>.</span><span>append</span><span>(</span><span>"0"</span><span>)</span><span>;</span><span>//使用‘’或“”都可</span>
                addZero<span>--</span><span>;</span>
            <span>}</span>
            <span>String</span> str1 <span>=</span> sb<span>.</span><span>toString</span><span>(</span><span>)</span><span>;</span>
            <span>while</span><span>(</span>str1<span>.</span><span>length</span><span>(</span><span>)</span><span>></span><span>0</span><span>)</span><span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>str1<span>.</span><span>substring</span><span>(</span><span>0</span><span>,</span><span>8</span><span>)</span><span>)</span><span>;</span>
                str1 <span>=</span> str1<span>.</span><span>substring</span><span>(</span><span>8</span><span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="二、" tabindex="-1"> 二、</h4>
<div><pre><code><span>/**
*1.输入字符串大于8时，递归截取前8位输入，直至小于8位时进入循环补0
*2.字符串小于8时直接跳到循环补0操作，补满至8位时打印输出
*3.正好等于8位或为空字符串时，直接打印输出
*/</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Scanner</span></span><span>;</span>

<span>// 注意类名必须为 Main, 不要有任何 package xxx 信息</span>
<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>Scanner</span> in <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span> <span>(</span>in<span>.</span><span>hasNextLine</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>String</span> s<span>=</span>in<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>;</span>
            <span>while</span><span>(</span>s<span>.</span><span>length</span><span>(</span><span>)</span><span>></span><span>8</span><span>)</span><span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>s<span>.</span><span>substring</span><span>(</span><span>0</span><span>,</span><span>8</span><span>)</span><span>)</span><span>;</span>
                s<span>=</span>s<span>.</span><span>substring</span><span>(</span><span>8</span><span>)</span><span>;</span>
            <span>}</span>
            <span>while</span><span>(</span>s<span>.</span><span>length</span><span>(</span><span>)</span><span>&lt;</span><span>8</span><span>&amp;&amp;</span>s<span>.</span><span>length</span><span>(</span><span>)</span><span>></span><span>0</span><span>)</span><span>{</span>
                s<span>+=</span><span>"0"</span><span>;</span>
            <span>}</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>s<span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="三、" tabindex="-1"> 三、</h4>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Scanner</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>Scanner</span> sc <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>String</span> str<span>;</span>
        <span>while</span> <span>(</span>sc<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            str <span>=</span> sc<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>;</span>
            <span>while</span> <span>(</span>str<span>.</span><span>length</span><span>(</span><span>)</span> <span>></span> <span>8</span><span>)</span> <span>{</span>
                 <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>str<span>.</span><span>substring</span><span>(</span><span>0</span><span>,</span> <span>8</span><span>)</span><span>)</span><span>;</span>
                 str <span>=</span> str<span>.</span><span>substring</span><span>(</span><span>8</span><span>)</span><span>;</span>
            <span>}</span>
            str <span>=</span> str <span>+</span> <span>"00000000"</span><span>;</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>str<span>.</span><span>substring</span><span>(</span><span>0</span><span>,</span> <span>8</span><span>)</span><span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="hj5-进制转换" tabindex="-1"> <strong>HJ5</strong> <strong>进制转换</strong></h2>
<h3 id="描述-4" tabindex="-1"> 描述</h3>
<p>写出一个程序，接受一个十六进制的数，输出该数值的十进制表示。</p>
<p>数据范围：保证结果在 1 \le n \le 2^{31}-1 \1≤<em>n</em>≤231−1</p>
<h3 id="输入描述-4" tabindex="-1"> 输入描述：</h3>
<p>输入一个十六进制的数值字符串。</p>
<h3 id="输出描述-4" tabindex="-1"> 输出描述：</h3>
<p>输出该数值的十进制字符串。不同组的测试用例用\n隔开。</p>
<h3 id="示例1-4" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>0xAA
</code></pre><div aria-hidden="true"><div></div></div></div><p>输出：</p>
<div><pre><code>170
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="代码-4" tabindex="-1"> 代码：</h3>
<h4 id="一、python3解法" tabindex="-1"> 一、python3解法</h4>
<div><pre><code><span>while</span> <span>True</span><span>:</span>
    <span>try</span><span>:</span>
        <span>print</span><span>(</span><span>int</span><span>(</span><span>input</span><span>(</span><span>)</span><span>,</span><span>16</span><span>)</span><span>)</span>
    <span>except</span><span>:</span>
        <span>break</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><div><pre><code><span>while</span> <span>True</span><span>:</span>
    <span>try</span><span>:</span>
        number <span>=</span> <span>input</span><span>(</span><span>)</span>
        n <span>=</span> <span>len</span><span>(</span>number<span>)</span>
        dic <span>=</span> <span>{</span><span>'0'</span><span>:</span><span>0</span><span>,</span><span>'1'</span><span>:</span><span>1</span><span>,</span><span>'2'</span><span>:</span><span>2</span><span>,</span><span>'3'</span><span>:</span><span>3</span><span>,</span><span>'4'</span><span>:</span><span>4</span><span>,</span><span>'5'</span><span>:</span><span>5</span><span>,</span><span>'6'</span><span>:</span><span>6</span><span>,</span><span>'7'</span><span>:</span><span>7</span><span>,</span><span>'8'</span><span>:</span><span>8</span><span>,</span><span>'9'</span><span>:</span><span>9</span><span>,</span><span>'A'</span><span>:</span><span>10</span><span>,</span><span>'B'</span><span>:</span><span>11</span><span>,</span><span>'C'</span><span>:</span><span>12</span><span>,</span><span>'D'</span><span>:</span><span>13</span><span>,</span><span>'E'</span><span>:</span><span>14</span><span>,</span><span>'F'</span><span>:</span><span>15</span><span>}</span>
        final <span>=</span> <span>0</span>
        <span>for</span> i <span>in</span> <span>range</span><span>(</span><span>2</span><span>,</span>n<span>)</span><span>:</span>
            final <span>+=</span> dic<span>[</span>number<span>[</span>i<span>]</span><span>]</span><span>*</span><span>(</span><span>16</span><span>**</span><span>(</span>n<span>-</span>i<span>-</span><span>1</span><span>)</span><span>)</span>
        <span>print</span><span>(</span>final<span>)</span>
    <span>except</span><span>:</span>
        <span>break</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="二、java" tabindex="-1"> 二、Java</h4>
<ul>
<li>substring(int a,int b)方法可以截断字符串，当只有一个参数时，截取范围是[a,length-1],当有两个参数时，截取范围是[a,b-1]。</li>
<li>Integer.parseInt(String s,int a)方法可以转换进制，将字符串转换为“a”进制，只有一个参数s时，转换为10进制。</li>
</ul>
<div><pre><code><span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>*</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span><span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>throws</span> <span>Exception</span><span>{</span>
        <span>Scanner</span> sc <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span><span>(</span>sc<span>.</span><span>hasNextLine</span><span>(</span><span>)</span><span>)</span><span>{</span>
            <span>String</span> s <span>=</span> sc<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>;</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>Integer</span><span>.</span><span>parseInt</span><span>(</span>s<span>.</span><span>substring</span><span>(</span><span>2</span><span>,</span>s<span>.</span><span>length</span><span>(</span><span>)</span><span>)</span><span>,</span><span>16</span><span>)</span><span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Scanner</span></span><span>;</span>
<span>public</span> <span>class</span> <span>Main</span><span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span><span>{</span>
        <span>Scanner</span> in <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span><span>(</span>in<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span><span>{</span>
            <span>String</span> str <span>=</span> in<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>;</span>
            <span>String</span> s1 <span>=</span> str<span>.</span><span>substring</span><span>(</span><span>2</span><span>)</span><span>;</span>
            <span>int</span> a <span>=</span> <span>Integer</span><span>.</span><span>valueOf</span><span>(</span>s1<span>,</span><span>16</span><span>)</span><span>;</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>a<span>)</span><span>;</span>
        <span>}</span>   
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="hj8-合并表记录" tabindex="-1"> <strong>HJ8</strong> <strong>合并表记录</strong></h2>
<h3 id="描述-5" tabindex="-1"> 描述</h3>
<p>数据表记录包含表索引index和数值value（int范围的正整数），请对表索引相同的记录进行合并，即将相同索引的数值进行求和运算，输出按照index值升序进行输出。</p>
<p>提示:</p>
<p>0 &lt;= index &lt;= 11111111</p>
<p>1 &lt;= value &lt;= 100000</p>
<h3 id="输入描述-5" tabindex="-1"> 输入描述：</h3>
<p>先输入键值对的个数n（1 &lt;= n &lt;= 500）
接下来n行每行输入成对的index和value值，以空格隔开</p>
<h3 id="输出描述-5" tabindex="-1"> 输出描述：</h3>
<p>输出合并后的键值对（多行）</p>
<h3 id="示例1-5" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>4
0 1
0 2
1 2
3 4
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>输出：</p>
<div><pre><code>0 3
1 2
3 4
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><h3 id="示例2" tabindex="-1"> 示例2</h3>
<p>输入：</p>
<div><pre><code>3
0 1
0 2
8 9
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p>输出：</p>
<div><pre><code>0 3
8 9
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h3 id="代码-5" tabindex="-1"> 代码：</h3>
<div><pre><code><span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>*</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span><span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>throws</span> <span>Exception</span><span>{</span>
        <span>Scanner</span> sc <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>TreeMap</span><span><span>&lt;</span><span>Integer</span><span>,</span> <span>Integer</span><span>></span></span> map <span>=</span> <span>new</span> <span>TreeMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span> <span>// 输出结果要求有序！</span>
       <span>while</span><span>(</span>sc<span>.</span><span>hasNextInt</span><span>(</span><span>)</span><span>)</span><span>{</span>
            <span>int</span> n <span>=</span> sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
            <span>for</span><span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> n<span>;</span> <span>++</span>i<span>)</span><span>{</span>
                <span>int</span> a <span>=</span> sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
                <span>int</span> b <span>=</span> sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
                map<span>.</span><span>put</span><span>(</span>a<span>,</span>map<span>.</span><span>getOrDefault</span><span>(</span>a<span>,</span><span>0</span><span>)</span> <span>+</span> b<span>)</span><span>;</span>
            <span>}</span>
       <span>}</span>
       <span>for</span> <span>(</span><span>Integer</span> i <span>:</span> map<span>.</span><span>keySet</span><span>(</span><span>)</span><span>)</span> <span>{</span>
           <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>i <span>+</span> <span>" "</span> <span>+</span> map<span>.</span><span>get</span><span>(</span>i<span>)</span><span>)</span><span>;</span>
       <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>
<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
 <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span> agv<span>[</span><span>]</span><span>)</span> <span>{</span>
      <span>Scanner</span> scanner <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
      <span>int</span> tableSize <span>=</span> scanner<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
      <span>Map</span><span><span>&lt;</span><span>Integer</span><span>,</span> <span>Integer</span><span>></span></span> table <span>=</span> <span>new</span> <span>HashMap</span><span><span>&lt;</span><span>></span></span><span>(</span>tableSize<span>)</span><span>;</span>
      <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> tableSize<span>;</span> i<span>++</span><span>)</span> <span>{</span>
          <span>int</span> key <span>=</span> scanner<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
          <span>int</span> value <span>=</span> scanner<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
          <span>if</span> <span>(</span>table<span>.</span><span>containsKey</span><span>(</span>key<span>)</span><span>)</span> <span>{</span>
              table<span>.</span><span>put</span><span>(</span>key<span>,</span> table<span>.</span><span>get</span><span>(</span>key<span>)</span> <span>+</span> value<span>)</span><span>;</span>
          <span>}</span> <span>else</span> <span>{</span>
              table<span>.</span><span>put</span><span>(</span>key<span>,</span> value<span>)</span><span>;</span>
          <span>}</span>
      <span>}</span>
       <span>for</span> <span>(</span><span>Integer</span> key <span>:</span> table<span>.</span><span>keySet</span><span>(</span><span>)</span><span>)</span> <span>{</span>
          <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span> key <span>+</span> <span>" "</span> <span>+</span> table<span>.</span><span>get</span><span>(</span>key<span>)</span><span>)</span><span>;</span>
      <span>}</span>
  <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="hj14-字符串排序" tabindex="-1"> <strong>HJ14</strong> <strong>字符串排序</strong></h2>
<h3 id="描述-6" tabindex="-1"> 描述</h3>
<p>给定 n 个字符串，请对 n 个字符串按照字典序排列。</p>
<p>数据范围： 1 \le n \le 1000 \1≤<em>n</em>≤1000 ，字符串长度满足 1 \le len \le 100 \1≤<em>l<strong>e</strong>n</em>≤100</p>
<h3 id="输入描述-6" tabindex="-1"> 输入描述：</h3>
<p>输入第一行为一个正整数n(1≤n≤1000),下面n行为n个字符串(字符串长度≤100),字符串中只含有大小写字母。</p>
<h3 id="输出描述-6" tabindex="-1"> 输出描述：</h3>
<p>数据输出n行，输出结果为按照字典序排列的字符串。</p>
<h3 id="示例1-6" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>9
cap
to
cat
card
two
too
up
boat
boot
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>输出：</p>
<div><pre><code>boat
boot
cap
card
cat
to
too
two
up
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>只需要按字典排列字符串，可以调用Arrays.sort API，也可以使用PriorityQueue，还可以自己实现Comparator，三种方法测试了一下用时相差不大。</p>
<div><pre><code><span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>*</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>throws</span> <span>IOException</span> <span>{</span>
        <span>withPriorityQueue</span><span>(</span><span>)</span><span>;</span>
    <span>}</span>

    <span>// 方法一: 调用API Arrays.sort</span>
    <span>public</span> <span>static</span> <span>void</span> <span>withArraysAPI</span><span>(</span><span>)</span> <span>throws</span> <span>IOException</span> <span>{</span>
        <span>BufferedReader</span> br <span>=</span> <span>new</span> <span>BufferedReader</span><span>(</span><span>new</span> <span>InputStreamReader</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>)</span><span>;</span>
        <span>int</span> n <span>=</span> <span>Integer</span><span>.</span><span>parseInt</span><span>(</span>br<span>.</span><span>readLine</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>String</span><span>[</span><span>]</span> ss <span>=</span> <span>new</span> <span>String</span><span>[</span>n<span>]</span><span>;</span>
        <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> n<span>;</span> i<span>++</span><span>)</span> <span>{</span>
            ss<span>[</span>i<span>]</span> <span>=</span> br<span>.</span><span>readLine</span><span>(</span><span>)</span><span>;</span>
        <span>}</span>
        br<span>.</span><span>close</span><span>(</span><span>)</span><span>;</span>

        <span>Arrays</span><span>.</span><span>sort</span><span>(</span>ss<span>)</span><span>;</span>

        <span>for</span><span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> n<span>;</span> i<span>++</span><span>)</span> <span>{</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>ss<span>[</span>i<span>]</span><span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>

    <span>// 方法二: 使用PriorityQueue</span>
    <span>public</span> <span>static</span> <span>void</span> <span>withPriorityQueue</span><span>(</span><span>)</span> <span>throws</span> <span>IOException</span> <span>{</span>
        <span>BufferedReader</span> br <span>=</span> <span>new</span> <span>BufferedReader</span><span>(</span><span>new</span> <span>InputStreamReader</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>)</span><span>;</span>
        <span>int</span> n <span>=</span> <span>Integer</span><span>.</span><span>parseInt</span><span>(</span>br<span>.</span><span>readLine</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>PriorityQueue</span><span><span>&lt;</span><span>String</span><span>></span></span> pq <span>=</span> <span>new</span> <span>PriorityQueue</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
        <span>String</span> s <span>=</span> <span>""</span><span>;</span>
        <span>while</span> <span>(</span><span>(</span>s <span>=</span> br<span>.</span><span>readLine</span><span>(</span><span>)</span><span>)</span> <span>!=</span> <span>null</span><span>)</span> <span>{</span>
            pq<span>.</span><span>offer</span><span>(</span>s<span>)</span><span>;</span>
        <span>}</span>
        br<span>.</span><span>close</span><span>(</span><span>)</span><span>;</span>

        <span>while</span> <span>(</span><span>!</span>pq<span>.</span><span>isEmpty</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>pq<span>.</span><span>poll</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>}</span>        
    <span>}</span>

    <span>// 方法三: 使用list并自己实现Comparator, 比较能体现算法的思路</span>
    <span>public</span> <span>static</span> <span>void</span> <span>withComparator</span><span>(</span><span>)</span> <span>throws</span> <span>IOException</span> <span>{</span>
        <span>BufferedReader</span> br <span>=</span> <span>new</span> <span>BufferedReader</span><span>(</span><span>new</span> <span>InputStreamReader</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>)</span><span>;</span>
        <span>int</span> n <span>=</span> <span>Integer</span><span>.</span><span>parseInt</span><span>(</span>br<span>.</span><span>readLine</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> list <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
        <span>String</span> s <span>=</span> <span>""</span><span>;</span>
        <span>while</span> <span>(</span><span>(</span>s <span>=</span> br<span>.</span><span>readLine</span><span>(</span><span>)</span><span>)</span> <span>!=</span> <span>null</span><span>)</span> <span>{</span>
            list<span>.</span><span>add</span><span>(</span>s<span>)</span><span>;</span>
        <span>}</span>
        br<span>.</span><span>close</span><span>(</span><span>)</span><span>;</span>

        list<span>.</span><span>sort</span><span>(</span><span>new</span> <span>Comparator</span><span><span>&lt;</span><span>String</span><span>></span></span><span>(</span><span>)</span> <span>{</span>
            <span>@Override</span>
            <span>public</span> <span>int</span> <span>compare</span><span>(</span><span>String</span> s1<span>,</span> <span>String</span> s2<span>)</span> <span>{</span>
                <span>int</span> i <span>=</span> <span>0</span><span>;</span>
                <span>while</span> <span>(</span>i <span>&lt;</span> s1<span>.</span><span>length</span><span>(</span><span>)</span> <span>&amp;&amp;</span> i <span>&lt;</span> s2<span>.</span><span>length</span><span>(</span><span>)</span><span>)</span> <span>{</span>
                    <span>if</span> <span>(</span>s1<span>.</span><span>charAt</span><span>(</span>i<span>)</span> <span>!=</span> s2<span>.</span><span>charAt</span><span>(</span>i<span>)</span><span>)</span> <span>{</span>
                        <span>return</span> <span>(</span>s1<span>.</span><span>charAt</span><span>(</span>i<span>)</span> <span>></span> s2<span>.</span><span>charAt</span><span>(</span>i<span>)</span><span>)</span><span>?</span> <span>1</span><span>:</span> <span>-</span><span>1</span><span>;</span>
                    <span>}</span>
                    i<span>++</span><span>;</span>
                <span>}</span>
                <span>if</span> <span>(</span>s1<span>.</span><span>length</span><span>(</span><span>)</span> <span>==</span> s2<span>.</span><span>length</span><span>(</span><span>)</span><span>)</span> <span>{</span>
                    <span>return</span> <span>0</span><span>;</span>
                <span>}</span> <span>else</span> <span>{</span>
                    <span>return</span> <span>(</span>s1<span>.</span><span>length</span><span>(</span><span>)</span> <span>></span> s2<span>.</span><span>length</span><span>(</span><span>)</span><span>)</span><span>?</span> <span>1</span><span>:</span> <span>-</span><span>1</span><span>;</span>
                <span>}</span>
            <span>}</span>
        <span>}</span><span>)</span><span>;</span>

        <span>for</span><span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> list<span>.</span><span>size</span><span>(</span><span>)</span><span>;</span> i<span>++</span><span>)</span> <span>{</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>list<span>.</span><span>get</span><span>(</span>i<span>)</span><span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>  
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="hj20-密码验证合格程序" tabindex="-1"> <strong>HJ20</strong> <strong>密码验证合格程序</strong></h2>
<h3 id="描述-7" tabindex="-1"> 描述</h3>
<p>密码要求:</p>
<p>1.长度超过8位</p>
<p>2.包括大小写字母.数字.其它符号,以上四种至少三种</p>
<p>3.不能有长度大于2的包含公共元素的子串重复 （注：其他符号不含空格或换行）</p>
<p>数据范围：输入的字符串长度满足 1 \le n \le 100 \1≤<em>n</em>≤100</p>
<h4 id="输入描述-7" tabindex="-1"> 输入描述：</h4>
<p>一组字符串。</p>
<h4 id="输出描述-7" tabindex="-1"> 输出描述：</h4>
<p>如果符合要求输出：OK，否则输出NG</p>
<h3 id="示例1-7" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>021Abc9000
021Abc9Abc1
021ABC9000
021$bc9000
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p>复制</p>
<p>输出：</p>
<div><pre><code>OK
NG
NG
OK
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><h3 id="题目主要信息" tabindex="-1"> 题目主要信息</h3>
<p>1、检验输入的密码是否合格</p>
<p>2、密码要求如下</p>
<ul>
<li>
<p>长度超过8位</p>
</li>
<li>
<p>密码要求:</p>
<p>1.长度超过8位</p>
<p>2.包括大小写字母.数字.其它符号,以上四种至少三种</p>
<p>3.不能有长度大于2的不含公共元素的子串重复 （注：其他符号不含空格或换行）</p>
</li>
</ul>
<h3 id="方法一-暴力" tabindex="-1"> 方法一：暴力</h3>
<h4 id="具体方法" tabindex="-1"> 具体方法</h4>
<p>按照密码的要求，依次遍历验证即可。</p>
<p>1、首先验证长度是否大于8，不满足直接输出NG并继续 2、验证是否包含三种以上的字符 3、验证是否存在重复子串，并且长度大于等于3 这里主要给出第三步的详解，前两步的直接遍历求解即可。 第三步可以使用类似窗口的方法，因为要求最长重复子串不能大于2，所以就把窗口的大小设置为3。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/4C136CEEE2387171DC8F01C8018C819E.gif" alt="alt" loading="lazy"></p>
<h4 id="java代码" tabindex="-1"> Java代码</h4>
<div><pre><code><span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>BufferedReader</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>IOException</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>InputStreamReader</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>throws</span> <span>IOException</span> <span>{</span>
        <span>BufferedReader</span> bf <span>=</span> <span>new</span> <span>BufferedReader</span><span>(</span><span>new</span> <span>InputStreamReader</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>)</span><span>;</span>
        <span>String</span> s<span>;</span>
        <span>while</span><span>(</span><span>(</span>s <span>=</span> bf<span>.</span><span>readLine</span><span>(</span><span>)</span><span>)</span><span>!=</span><span>null</span><span>)</span><span>{</span>
            <span>//1.长度超过8位</span>
            <span>if</span><span>(</span>s<span>.</span><span>length</span><span>(</span><span>)</span> <span>&lt;=</span> <span>8</span><span>)</span><span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"NG"</span><span>)</span><span>;</span>
                <span>continue</span><span>;</span>
            <span>}</span>
            <span>//2.包括大小写字母.数字.其它符号,以上四种至少三种</span>
            <span>int</span> count<span>[</span><span>]</span> <span>=</span> <span>new</span> <span>int</span><span>[</span><span>4</span><span>]</span><span>;</span><span>//记录出现个数</span>
            <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span><span>;</span>i<span>&lt;</span>s<span>.</span><span>length</span><span>(</span><span>)</span><span>;</span>i<span>++</span><span>)</span><span>{</span>
                <span>if</span><span>(</span>s<span>.</span><span>charAt</span><span>(</span>i<span>)</span> <span>>=</span> <span>'A'</span><span>&amp;&amp;</span> s<span>.</span><span>charAt</span><span>(</span>i<span>)</span><span>&lt;=</span><span>'Z'</span> <span>)</span><span>{</span>
                    count<span>[</span><span>0</span><span>]</span> <span>=</span> <span>1</span><span>;</span>
                <span>}</span><span>else</span> <span>if</span><span>(</span>s<span>.</span><span>charAt</span><span>(</span>i<span>)</span> <span>>=</span> <span>'a'</span><span>&amp;&amp;</span> s<span>.</span><span>charAt</span><span>(</span>i<span>)</span><span>&lt;=</span><span>'z'</span> <span>)</span><span>{</span>
                    count<span>[</span><span>1</span><span>]</span> <span>=</span> <span>1</span><span>;</span>
                <span>}</span><span>else</span> <span>if</span><span>(</span>s<span>.</span><span>charAt</span><span>(</span>i<span>)</span> <span>>=</span> <span>'0'</span><span>&amp;&amp;</span> s<span>.</span><span>charAt</span><span>(</span>i<span>)</span><span>&lt;=</span><span>'9'</span> <span>)</span><span>{</span>
                    count<span>[</span><span>2</span><span>]</span> <span>=</span> <span>1</span><span>;</span>
                <span>}</span><span>else</span> <span>{</span>
                    count<span>[</span><span>3</span><span>]</span> <span>=</span> <span>1</span><span>;</span>
                <span>}</span>
            <span>}</span>
            <span>if</span><span>(</span>count<span>[</span><span>0</span><span>]</span><span>+</span>count<span>[</span><span>1</span><span>]</span><span>+</span>count<span>[</span><span>2</span><span>]</span><span>+</span>count<span>[</span><span>3</span><span>]</span><span>&lt;</span><span>3</span><span>)</span><span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"NG"</span><span>)</span><span>;</span>
                <span>continue</span><span>;</span>
            <span>}</span>
            <span>//3.不能有长度大于2的不含公共元素的子串重复 （注：其他符号不含空格或换行）</span>
            <span>if</span><span>(</span><span>getString</span><span>(</span>s<span>,</span><span>0</span><span>,</span><span>3</span><span>)</span><span>)</span><span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"NG"</span><span>)</span><span>;</span>
                <span>continue</span><span>;</span>
            <span>}</span> <span>else</span> <span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"OK"</span><span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>
    <span>//检测是否存在长度大于3的重复子串</span>
     <span>static</span> <span>boolean</span> <span>getString</span><span>(</span><span>String</span> str<span>,</span><span>int</span> l<span>,</span><span>int</span> r<span>)</span> <span>{</span>
         <span>if</span> <span>(</span>r <span>>=</span> str<span>.</span><span>length</span><span>(</span><span>)</span><span>)</span> <span>{</span>
             <span>return</span> <span>false</span><span>;</span>
         <span>}</span>
         <span>if</span> <span>(</span>str<span>.</span><span>substring</span><span>(</span>r<span>)</span><span>.</span><span>contains</span><span>(</span>str<span>.</span><span>substring</span><span>(</span>l<span>,</span> r<span>)</span><span>)</span><span>)</span> <span>{</span>
             <span>return</span> <span>true</span><span>;</span>
         <span>}</span> <span>else</span> <span>{</span>
             <span>return</span> <span>getString</span><span>(</span>str<span>,</span> l <span>+</span> <span>1</span><span>,</span> r <span>+</span> <span>1</span><span>)</span><span>;</span>
         <span>}</span>
     <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="复杂度分析" tabindex="-1"> 复杂度分析</h4>
<ul>
<li>时间复杂度：O(n2)O(n^2)<em>O</em>(<em>n</em>2)，n为单次密码长度，验证重复子串两层循环遍历字符串</li>
<li>空间复杂度：O(1)O(1)<em>O</em>(1)，字符串s属于必要空间</li>
</ul>
<h3 id="方法二-正则表达式" tabindex="-1"> 方法二：正则表达式</h3>
<h4 id="具体做法" tabindex="-1"> 具体做法</h4>
<p>匹配小写字母、大写字母、数字、其他字符，还是匹配串中前后连续三个一样的字符，我们都可以用正则表达式。只要把正则表达式写出来即可</p>
<h4 id="java代码-1" tabindex="-1"> Java代码</h4>
<div><pre><code><span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>BufferedReader</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>IOException</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>InputStreamReader</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span>regex<span>.</span></span><span>Matcher</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span>regex<span>.</span></span><span>Pattern</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>throws</span> <span>IOException</span> <span>{</span>
        <span>BufferedReader</span> bf <span>=</span> <span>new</span> <span>BufferedReader</span><span>(</span><span>new</span> <span>InputStreamReader</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>)</span><span>;</span>
        <span>String</span> s<span>;</span>
        <span>while</span> <span>(</span><span>(</span>s <span>=</span> bf<span>.</span><span>readLine</span><span>(</span><span>)</span><span>)</span><span>!=</span><span>null</span><span>)</span> <span>{</span>
            <span>// 长度check, 相同长度超2的子串重复check</span>
            <span>if</span> <span>(</span>s<span>.</span><span>length</span><span>(</span><span>)</span> <span>&lt;=</span> <span>8</span> <span>)</span> <span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"NG"</span><span>)</span><span>;</span>
                <span>continue</span><span>;</span>
            <span>}</span>
            <span>// 大小写字母.数字.其它符号check</span>
            <span>String</span><span>[</span><span>]</span> regexes <span>=</span> <span>{</span><span>"\\d"</span><span>,</span> <span>"[a-z]"</span><span>,</span> <span>"[A-Z]"</span><span>,</span> <span>"[^\\da-zA-Z]"</span><span>}</span><span>;</span>
            <span>int</span> types <span>=</span> <span>0</span><span>;</span>
            <span>for</span> <span>(</span><span>String</span> re <span>:</span> regexes<span>)</span> <span>{</span>
                <span>Pattern</span> p <span>=</span> <span>Pattern</span><span>.</span><span>compile</span><span>(</span>re<span>)</span><span>;</span>
                <span>Matcher</span> m <span>=</span> p<span>.</span><span>matcher</span><span>(</span>s<span>)</span><span>;</span>
                <span>if</span> <span>(</span>m<span>.</span><span>find</span><span>(</span><span>)</span><span>)</span> <span>{</span>
                    types <span>+=</span> <span>1</span><span>;</span>
                <span>}</span>
            <span>}</span>
            <span>if</span><span>(</span>types<span>&lt;</span><span>3</span><span>)</span><span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"NG"</span><span>)</span><span>;</span>
                <span>continue</span><span>;</span>
            <span>}</span>
          <span>//匹配串前后连续3个字符一样的 </span>
         <span>//public String replaceAll(String replacement)</span>
		 <span>//替换模式与给定替换字符串相匹配的输入中存在长度大于2的不含公共元素的子串重复 删除一个重复字串长度显然变短了 这时输入NG</span>
            <span>if</span><span>(</span>s<span>.</span><span>replaceAll</span><span>(</span><span>"(.{3,})(?=.{3,}\\1)"</span><span>,</span> <span>""</span><span>)</span><span>.</span><span>length</span><span>(</span><span>)</span> <span>&lt;</span> s<span>.</span><span>length</span><span>(</span><span>)</span><span>)</span><span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"NG"</span><span>)</span><span>;</span>
                <span>continue</span><span>;</span>
            <span>}</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"OK"</span><span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="复杂度分析-1" tabindex="-1"> 复杂度分析</h4>
<ul>
<li>时间复杂度：O(n)O(n)<em>O</em>(<em>n</em>)，正则表达式匹配复杂度为O(n)O(n)<em>O</em>(<em>n</em>)</li>
<li>空间复杂度：O(1)O(1)<em>O</em>(1)，常数级空间，字符串s属于必要空间</li>
</ul>
<h2 id="hj23-删除字符串中出现次数最少的字符" tabindex="-1"> <strong>HJ23</strong> <strong>删除字符串中出现次数最少的字符</strong></h2>
<h3 id="描述-8" tabindex="-1"> 描述</h3>
<p>实现删除字符串中出现次数最少的字符，若出现次数最少的字符有多个，则把出现次数最少的字符都删除。输出删除这些单词后的字符串，字符串中其它字符保持原来的顺序。</p>
<p>数据范围：输入的字符串长度满足 1 \le n \le 20 \1≤<em>n</em>≤20 ，保证输入的字符串中仅出现小写字母</p>
<h3 id="输入描述-8" tabindex="-1"> 输入描述：</h3>
<p>字符串只包含小写英文字母, 不考虑非法输入，输入的字符串长度小于等于20个字节。</p>
<h3 id="输出描述-8" tabindex="-1"> 输出描述：</h3>
<p>删除字符串中出现次数最少的字符后的字符串。</p>
<h3 id="示例1-8" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>aabcddd
</code></pre><div aria-hidden="true"><div></div></div></div><p>输出：</p>
<div><pre><code>aaddd
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="_1-哈希表-时间o-n-空间o-1" tabindex="-1"> 1.哈希表，时间O(N)，空间O(1)</h3>
<div><pre><code><span>public</span> <span>String</span> <span>delete</span><span>(</span><span>String</span> str<span>)</span> <span>{</span>
        <span>// Map记录每个字母的次数</span>
        <span>Map</span><span><span>&lt;</span><span>Character</span><span>,</span> <span>Integer</span><span>></span></span> map <span>=</span> <span>new</span> <span>HashMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
        <span>for</span> <span>(</span><span>char</span> ch <span>:</span> str<span>.</span><span>toCharArray</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            map<span>.</span><span>put</span><span>(</span>ch<span>,</span> map<span>.</span><span>getOrDefault</span><span>(</span>ch<span>,</span> <span>0</span><span>)</span> <span>+</span> <span>1</span><span>)</span><span>;</span>
        <span>}</span>
        <span>// 快速找出最少次数</span>
        <span>int</span> min <span>=</span> <span>Integer</span><span>.</span>MAX_VALUE<span>;</span>
        <span>for</span> <span>(</span><span>int</span> times <span>:</span> map<span>.</span><span>values</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            min <span>=</span> <span>Math</span><span>.</span><span>min</span><span>(</span>min<span>,</span> times<span>)</span><span>;</span>
        <span>}</span>
        <span>StringBuilder</span> res <span>=</span> <span>new</span> <span>StringBuilder</span><span>(</span><span>)</span><span>;</span>
        <span>for</span> <span>(</span><span>char</span> ch <span>:</span> str<span>.</span><span>toCharArray</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>if</span> <span>(</span>map<span>.</span><span>get</span><span>(</span>ch<span>)</span> <span>!=</span> min<span>)</span> <span>{</span>
                res<span>.</span><span>append</span><span>(</span>ch<span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
        <span>return</span> res<span>.</span><span>toString</span><span>(</span><span>)</span><span>;</span>
    <span>}</span>
 
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>Main</span> solution <span>=</span> <span>new</span> <span>Main</span><span>(</span><span>)</span><span>;</span>
        <span>Scanner</span> in <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span> <span>(</span>in<span>.</span><span>hasNextLine</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>String</span> str <span>=</span> in<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>;</span>
            <span>String</span> res <span>=</span> solution<span>.</span><span>delete</span><span>(</span>str<span>)</span><span>;</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>res<span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_2" tabindex="-1"> 2.</h3>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Collections</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>HashMap</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Scanner</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span> <span>{</span>

    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>Scanner</span> scanner <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span> <span>(</span>scanner<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>String</span> s <span>=</span> scanner<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>;</span>
            <span>char</span><span>[</span><span>]</span> chars <span>=</span> s<span>.</span><span>toCharArray</span><span>(</span><span>)</span><span>;</span>
            <span>//统计每个字母的数量</span>
            <span>HashMap</span><span><span>&lt;</span><span>Character</span><span>,</span> <span>Integer</span><span>></span></span> map <span>=</span> <span>new</span> <span>HashMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
            <span>for</span> <span>(</span><span>char</span> aChar <span>:</span> chars<span>)</span> <span>{</span>
                map<span>.</span><span>put</span><span>(</span>aChar<span>,</span> <span>(</span>map<span>.</span><span>getOrDefault</span><span>(</span>aChar<span>,</span> <span>0</span><span>)</span> <span>+</span> <span>1</span><span>)</span><span>)</span><span>;</span>
            <span>}</span>
            <span>//找到数量最少的字符数量</span>
            <span>Collection</span><span><span>&lt;</span><span>Integer</span><span>></span></span> values <span>=</span> map<span>.</span><span>values</span><span>(</span><span>)</span><span>;</span>
            <span>Integer</span> min <span>=</span> <span>Collections</span><span>.</span><span>min</span><span>(</span>values<span>)</span><span>;</span>

            <span>//用空字符串替换该字母</span>
            <span>for</span> <span>(</span><span>Character</span> character <span>:</span> map<span>.</span><span>keySet</span><span>(</span><span>)</span><span>)</span> <span>{</span>
                <span>if</span> <span>(</span>map<span>.</span><span>get</span><span>(</span>character<span>)</span> <span>==</span> min<span>)</span><span>{</span>
                    s <span>=</span> s<span>.</span><span>replaceAll</span><span>(</span><span>String</span><span>.</span><span>valueOf</span><span>(</span>character<span>)</span><span>,</span> <span>""</span><span>)</span><span>;</span>
                <span>}</span>
            <span>}</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>s<span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>

</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ol start="3">
<li></li>
</ol>
<p>题目主要意思</p>
<p>1、删除一个字符串中出现次数最少的字符，若多个字符出现次数一样，都删除。</p>
<p>2、字符串需要保持原来的顺序</p>
<p>3、字符串只包含小写字母</p>
<p>4、多行输入输出</p>
<h3 id="方法一-暴力法" tabindex="-1"> 方法一：暴力法</h3>
<h4 id="具体做法-1" tabindex="-1"> 具体做法</h4>
<ol>
<li>直接遍历字符串，将字符串存入到数组中，将字符串转成ASCII格式的，也就是都在128个ASCII里，设置一个26大小的数组即可，因为题目里说了只包含小写字母。</li>
<li>遍历字符串后将字符对应的ASCII的个数存入对应的数组中。</li>
<li>遍历数组找到最小的个数</li>
<li>遍历数组，如果当前字符出现的个数等于最小个数，则被替换掉。</li>
</ol>
<h4 id="java代码-2" tabindex="-1"> Java代码</h4>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>*</span></span><span>;</span>
<span>public</span> <span>class</span> <span>Main</span><span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span><span>throws</span> <span>IOException</span><span>{</span>
        <span>BufferedReader</span> bf <span>=</span> <span>new</span> <span>BufferedReader</span><span>(</span><span>new</span> <span>InputStreamReader</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>)</span><span>;</span>
        <span>String</span> str <span>;</span>
        <span>while</span> <span>(</span><span>(</span>str <span>=</span> bf<span>.</span><span>readLine</span><span>(</span><span>)</span><span>)</span> <span>!=</span> <span>null</span> <span>&amp;&amp;</span> <span>!</span>str<span>.</span><span>equals</span><span>(</span><span>""</span><span>)</span><span>)</span> <span>{</span>
            <span>char</span> <span>[</span><span>]</span>chars <span>=</span> str<span>.</span><span>toCharArray</span><span>(</span><span>)</span><span>;</span>
            <span>// 题目所给出的都是小写字母 共计26个 a~z</span>
            <span>int</span><span>[</span><span>]</span> temp <span>=</span> <span>new</span> <span>int</span><span>[</span><span>26</span><span>]</span><span>;</span>
            <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> chars<span>.</span>length<span>;</span> i<span>++</span><span>)</span> <span>{</span>
                <span>//找到当前字符在数组中的位置 比如97对应的是a的ASCII码，</span>
                <span>int</span> index <span>=</span> chars<span>[</span>i<span>]</span> <span>-</span> <span>97</span><span>;</span>
                temp<span>[</span>index<span>]</span> <span>=</span> temp<span>[</span>index<span>]</span> <span>+</span> <span>1</span><span>;</span>
            <span>}</span>
            <span>//找到次数最少的个数 </span>
            <span>int</span> min <span>=</span> <span>Integer</span><span>.</span>MAX_VALUE<span>;</span>
            <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> <span>26</span><span>;</span> i<span>++</span><span>)</span> <span>{</span>
                <span>// 跳过</span>
                <span>if</span> <span>(</span>temp<span>[</span>i<span>]</span> <span>!=</span> <span>0</span><span>)</span> <span>{</span>
                    min <span>=</span> <span>Math</span><span>.</span><span>min</span><span>(</span>min<span>,</span>temp<span>[</span>i<span>]</span><span>)</span><span>;</span>
                <span>}</span>
            <span>}</span>
            <span>// 开始删除最小 </span>
            <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> <span>26</span><span>;</span> i<span>++</span><span>)</span> <span>{</span>
                <span>if</span> <span>(</span>temp<span>[</span>i<span>]</span> <span>==</span> min<span>)</span> <span>{</span>
                    <span>char</span> ch <span>=</span> <span>(</span><span>char</span><span>)</span> <span>(</span><span>'a'</span> <span>+</span> i<span>)</span><span>;</span>
                    str <span>=</span> str<span>.</span><span>replace</span><span>(</span>ch <span>+</span> <span>""</span><span>,</span> <span>""</span><span>)</span><span>;</span>
                <span>}</span>
            <span>}</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>str<span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="复杂度分析-2" tabindex="-1"> 复杂度分析</h4>
<ul>
<li>时间复杂度：O(n)O(n)<em>O</em>(<em>n</em>),需要遍历字符串和数组。</li>
<li>空间复杂度：O(n)O(n)<em>O</em>(<em>n</em>),临时数组temp。</li>
</ul>
<h3 id="方法二-借助hashmap来存储" tabindex="-1"> 方法二：借助HashMap来存储</h3>
<h4 id="具体做法-2" tabindex="-1"> 具体做法</h4>
<p>遍历字符串，将字符存入HashMap中，在遍历HashMap找到最小的values，在遍历一遍HashMap把不等于最小values的记录，最后输出。</p>
<p>举例说明：aabcddd</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/D5EF2862C00A21BBFC433ECCC33C4476.gif" alt="alt" loading="lazy"></p>
<h4 id="java代码-3" tabindex="-1"> Java代码</h4>
<div><pre><code><span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>BufferedReader</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>IOException</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>InputStreamReader</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>HashMap</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>String</span> <span>delete</span><span>(</span><span>String</span> str<span>)</span> <span>{</span>
        <span>// Map记录每个字母的次数</span>
        <span>HashMap</span><span><span>&lt;</span><span>Character</span><span>,</span> <span>Integer</span><span>></span></span> map <span>=</span> <span>new</span> <span>HashMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
        <span>for</span> <span>(</span><span>char</span> ch <span>:</span> str<span>.</span><span>toCharArray</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>//将每个字符存入其中</span>
            map<span>.</span><span>put</span><span>(</span>ch<span>,</span> map<span>.</span><span>getOrDefault</span><span>(</span>ch<span>,</span> <span>1</span><span>)</span> <span>+</span> <span>1</span><span>)</span><span>;</span>
        <span>}</span>
        <span>// 快速找出最少次数</span>
        <span>int</span> min <span>=</span> <span>Integer</span><span>.</span>MAX_VALUE<span>;</span>
        <span>for</span> <span>(</span><span>int</span> times <span>:</span> map<span>.</span><span>values</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            min <span>=</span> <span>Math</span><span>.</span><span>min</span><span>(</span>min<span>,</span> times<span>)</span><span>;</span>
        <span>}</span>
        <span>//最后输出的值</span>
        <span>StringBuilder</span> result <span>=</span> <span>new</span> <span>StringBuilder</span><span>(</span><span>)</span><span>;</span>
        <span>for</span> <span>(</span><span>char</span> ch <span>:</span> str<span>.</span><span>toCharArray</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>if</span> <span>(</span>map<span>.</span><span>get</span><span>(</span>ch<span>)</span> <span>!=</span> min<span>)</span> <span>{</span>
                result<span>.</span><span>append</span><span>(</span>ch<span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
        <span>return</span> result<span>.</span><span>toString</span><span>(</span><span>)</span><span>;</span>
    <span>}</span>

    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>throws</span> <span>IOException</span> <span>{</span>
        <span>BufferedReader</span> bf <span>=</span> <span>new</span> <span>BufferedReader</span><span>(</span><span>new</span> <span>InputStreamReader</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>)</span><span>;</span>
        <span>String</span> s<span>;</span>
        <span>while</span> <span>(</span><span>(</span>s <span>=</span> bf<span>.</span><span>readLine</span><span>(</span><span>)</span><span>)</span><span>!=</span><span>null</span><span>)</span> <span>{</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>delete</span><span>(</span>s<span>)</span><span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="复杂度分析-3" tabindex="-1"> 复杂度分析</h4>
<ul>
<li>时间复杂度：O(n),需要多次遍历字符串和Map，但都不存在嵌套遍历。</li>
<li>空间复杂度：O(n),借助了Map存储</li>
</ul>
<h2 id="hj25-数据分类处理" tabindex="-1"> <strong>HJ25</strong> <strong>数据分类处理</strong></h2>
<h3 id="描述-9" tabindex="-1"> 描述</h3>
<p>信息社会，有海量的数据需要分析处理，比如公安局分析身份证号码、 QQ 用户、手机号码、银行帐号等信息及活动记录。</p>
<p>采集输入大数据和分类规则，通过大数据分类处理程序，将大数据分类输出。</p>
<p>数据范围：1 \le I,R \le 100 \1≤<em>I</em>,<em>R</em>≤100 ，输入的整数大小满足 0 \le val \le 2^{31}-1\0≤<em>v<strong>a</strong>l</em>≤231−1</p>
<h3 id="输入描述-9" tabindex="-1"> 输入描述：</h3>
<p>一组输入整数序列I和一组规则整数序列R，I和R序列的第一个整数为序列的个数（个数不包含第一个整数）；整数范围为0~(2^31)-1，序列个数不限</p>
<h3 id="输出描述-9" tabindex="-1"> 输出描述：</h3>
<p>从R依次中取出R，对I进行处理，找到满足条件的I：</p>
<p>I整数对应的数字需要连续包含R对应的数字。比如R为23，I为231，那么I包含了R，条件满足 。</p>
<p>按R从小到大的顺序:</p>
<p>(1)先输出R；</p>
<p>(2)再输出满足条件的I的个数；</p>
<p>(3)然后输出满足条件的I在I序列中的位置索引(从0开始)；</p>
<p>(4)最后再输出I。</p>
<p>附加条件：</p>
<p>(1)R需要从小到大排序。相同的R只需要输出索引小的以及满足条件的I，索引大的需要过滤掉</p>
<p>(2)如果没有满足条件的I，对应的R不用输出</p>
<p>(3)最后需要在输出序列的第一个整数位置记录后续整数序列的个数(不包含“个数”本身)</p>
<p>序列I：15,123,456,786,453,46,7,5,3,665,453456,745,456,786,453,123（第一个15表明后续有15个整数）</p>
<p>序列R：5,6,3,6,3,0（第一个5表明后续有5个整数）</p>
<p>输出：<em>30, 3,6,0,123</em>,3,453,7,3,9,453456,13,453,14,123,6,7,1,456,2,786,4,46,8,665,9,453456,11,456,12,786</p>
<p>说明：</p>
<p><em>30</em>----后续有30个整数</p>
<p><em>3</em>----从小到大排序，第一个R为0，但没有满足条件的I，不输出0，而下一个R是3</p>
<p><em>6---</em> <em>存在6个包含3的I</em></p>
<p><em>0---</em> <em>123所在的原序号为0</em></p>
<p><em>123---</em> <em>123包含3，满足条件</em></p>
<h3 id="示例1-9" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>15 123 456 786 453 46 7 5 3 665 453456 745 456 786 453 123
5 6 3 6 3 0
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>输出：</p>
<div><pre><code>30 3 6 0 123 3 453 7 3 9 453456 13 453 14 123 6 7 1 456 2 786 4 46 8 665 9 453456 11 456 12 786
</code></pre><div aria-hidden="true"><div></div></div></div><p>说明：</p>
<div><pre><code>将序列R：5,6,3,6,3,0（第一个5表明后续有5个整数）排序去重后，可得0,3,6。
序列I没有包含0的元素。
序列I中包含3的元素有：I[0]的值为123、I[3]的值为453、I[7]的值为3、I[9]的值为453456、I[13]的值为453、I[14]的值为123。
序列I中包含6的元素有：I[1]的值为456、I[2]的值为786、I[4]的值为46、I[8]的值为665、I[9]的值为453456、I[11]的值为456、I[12]的值为786。
最后按题目要求的格式进行输出即可。    
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>题目主要信息</p>
<p>1、 一组输入整数序列I和一组规则整数序列R，I和R序列的第一个整数为序列的个数（个数不包含第一个整数）；整数范围为0~(2^31)-1，序列个数不限</p>
<p>2、 从R依次中取出R[i]，对I进行处理，找到满足条件的I</p>
<p>3、按R[i]从小到大的顺序:</p>
<p>(1)先输出R[i]；</p>
<p>(2)再输出满足条件的I的个数；</p>
<p>(3)然后输出满足条件的I在I序列中的位置索引(从0开始)；</p>
<p>(4)最后再输出I。</p>
<p>4、附加条件：</p>
<p>(1)R[i]需要从小到大排序。相同的R[i]只需要输出索引小的以及满足条件的I，索引大的需要过滤掉</p>
<p>(2)如果没有满足条件的I，对应的R[i]不用输出</p>
<p>(3)最后需要在输出序列的第一个整数位置记录后续整数序列的个数(不包含“个数”本身)</p>
<h3 id="方法一-直接暴力求解" tabindex="-1"> 方法一：直接暴力求解</h3>
<h4 id="具体方法-1" tabindex="-1"> 具体方法</h4>
<p>遍历每个R[i]，并遍历每个I[i]是否符合要求，符合的话就记录。</p>
<p>Java代码</p>
<div><pre><code><span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>*</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span> <span>{</span><span>//数据分类处理</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>throws</span> <span>IOException</span> <span>{</span>
        <span>BufferedReader</span> br <span>=</span> <span>new</span> <span>BufferedReader</span><span>(</span><span>new</span> <span>InputStreamReader</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>)</span><span>;</span>
        <span>String</span> str<span>;</span>
        <span>while</span> <span>(</span><span>(</span>str <span>=</span> br<span>.</span><span>readLine</span><span>(</span><span>)</span><span>)</span> <span>!=</span> <span>null</span><span>)</span> <span>{</span>
            <span>if</span> <span>(</span>str<span>.</span><span>equals</span><span>(</span><span>""</span><span>)</span><span>)</span> <span>continue</span><span>;</span>
            <span>//需要过了的I</span>
            <span>String</span><span>[</span><span>]</span> <span>I</span> <span>=</span> str<span>.</span><span>split</span><span>(</span><span>" "</span><span>)</span><span>;</span>
            <span>// R</span>
            <span>String</span><span>[</span><span>]</span> temp <span>=</span> br<span>.</span><span>readLine</span><span>(</span><span>)</span><span>.</span><span>split</span><span>(</span><span>" "</span><span>)</span><span>;</span>
            <span>long</span><span>[</span><span>]</span> <span>R</span> <span>=</span> <span>new</span> <span>long</span><span>[</span><span>Integer</span><span>.</span><span>parseInt</span><span>(</span>temp<span>[</span><span>0</span><span>]</span><span>)</span><span>]</span><span>;</span>
            <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> <span>R</span><span>.</span>length<span>;</span> i<span>++</span><span>)</span> <span>R</span><span>[</span>i<span>]</span> <span>=</span> <span>Long</span><span>.</span><span>parseLong</span><span>(</span>temp<span>[</span>i<span>+</span><span>1</span><span>]</span><span>)</span><span>;</span>
            <span>//先对R进行排序 然后在依次遍历</span>
            <span>Arrays</span><span>.</span><span>sort</span><span>(</span><span>R</span><span>)</span><span>;</span>
            <span>//最终的结果记录 </span>
            <span>StringBuilder</span> result <span>=</span> <span>new</span> <span>StringBuilder</span><span>(</span><span>)</span><span>;</span>
            <span>int</span> count <span>=</span> <span>0</span><span>;</span>
            <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> <span>R</span><span>.</span>length<span>;</span> i<span>++</span><span>)</span> <span>{</span>
                <span>//当R中的值相等的时候 只保留第一个出现的 </span>
                <span>if</span> <span>(</span>i <span>></span> <span>0</span> <span>&amp;&amp;</span> <span>R</span><span>[</span>i<span>]</span> <span>==</span> <span>R</span><span>[</span>i<span>-</span><span>1</span><span>]</span><span>)</span> <span>continue</span><span>;</span>
                <span>//需要进行匹配的字符 </span>
                <span>String</span> pattern <span>=</span> <span>R</span><span>[</span>i<span>]</span> <span>+</span> <span>""</span><span>;</span>
                <span>int</span> num <span>=</span> <span>0</span><span>;</span>
                <span>StringBuilder</span> index <span>=</span> <span>new</span> <span>StringBuilder</span><span>(</span><span>)</span><span>;</span>
                <span>for</span> <span>(</span><span>int</span> j <span>=</span> <span>1</span><span>;</span> j <span>&lt;</span> <span>I</span><span>.</span>length<span>;</span> j<span>++</span><span>)</span> <span>{</span>
                    <span>//说明出现了 找到位置</span>
                    <span>if</span> <span>(</span><span>I</span><span>[</span>j<span>]</span><span>.</span><span>indexOf</span><span>(</span>pattern<span>)</span> <span>!=</span> <span>-</span><span>1</span><span>)</span> <span>{</span>
                        num<span>++</span><span>;</span>
                        index<span>.</span><span>append</span><span>(</span><span>" "</span><span>)</span><span>.</span><span>append</span><span>(</span>j<span>-</span><span>1</span><span>)</span><span>.</span><span>append</span><span>(</span><span>" "</span><span>)</span><span>.</span><span>append</span><span>(</span><span>I</span><span>[</span>j<span>]</span><span>)</span><span>;</span>
                    <span>}</span>
                <span>}</span>
                <span>//说明存在跟此时R[i]匹配的I</span>
                <span>if</span> <span>(</span>num <span>></span> <span>0</span><span>)</span><span>{</span>
                    result<span>.</span><span>append</span><span>(</span><span>" "</span><span>)</span><span>.</span><span>append</span><span>(</span><span>R</span><span>[</span>i<span>]</span><span>)</span><span>.</span><span>append</span><span>(</span><span>" "</span><span>)</span><span>.</span><span>append</span><span>(</span>num<span>)</span><span>.</span><span>append</span><span>(</span>index<span>)</span><span>;</span>
                    count <span>+=</span> num<span>*</span><span>2</span><span>+</span><span>2</span><span>;</span>
                <span>}</span>
            <span>}</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>count <span>+</span> result<span>.</span><span>toString</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="复杂度分析-4" tabindex="-1"> 复杂度分析</h4>
<ul>
<li>时间复杂度：O(nm+mlogm)O(nm+mlogm)<em>O</em>(<em>n**m</em>+<em>m<strong>l</strong>o<strong>g</strong>m</em>)，需要两层for循环遍历，一层遍历R一层遍历I，另外就是进行了排序的操作。</li>
<li>空间复杂度：O(1)O(1)<em>O</em>(1) ,都是常数级别变量</li>
</ul>
<h3 id="方法二-借助map" tabindex="-1"> 方法二：借助Map</h3>
<h4 id="具体做法-3" tabindex="-1"> 具体做法</h4>
<p>在每一轮遍历I的过程中，将当前I[i]存入到Map中，并以key和value的形式，其中key是当前元素的下标，value为当前元素的值。</p>
<p>最终在遍历Map,将结果存入到最终的result结果中。</p>
<h4 id="java代码-4" tabindex="-1"> Java代码</h4>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>Scanner</span> sc <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span> <span>(</span>sc<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>int</span> num <span>=</span> sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
            <span>//读取I</span>
            <span>String</span><span>[</span><span>]</span> array <span>=</span> <span>new</span> <span>String</span><span>[</span>num<span>]</span><span>;</span>
            <span>for</span> <span>(</span><span>int</span> i <span>=</span><span>0</span><span>;</span> i<span>&lt;</span>num<span>;</span> i<span>++</span><span>)</span> <span>{</span>
                array<span>[</span>i<span>]</span> <span>=</span> <span>String</span><span>.</span><span>valueOf</span><span>(</span>sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>}</span>
            <span>//读取R</span>
            <span>int</span> rnum <span>=</span> sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
            <span>Set</span><span><span>&lt;</span><span>Integer</span><span>></span></span> set <span>=</span> <span>new</span> <span>TreeSet</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
            <span>for</span> <span>(</span><span>int</span> i <span>=</span><span>0</span><span>;</span> i<span>&lt;</span>rnum<span>;</span> i<span>++</span><span>)</span> <span>{</span>
                set<span>.</span><span>add</span><span>(</span>sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>}</span>


            <span>StringBuilder</span> result <span>=</span> <span>new</span> <span>StringBuilder</span><span>(</span><span>)</span><span>;</span>
            <span>int</span> count <span>=</span> <span>0</span><span>;</span><span>//记录符合的个数</span>
            <span>//遍历 R</span>
            <span>for</span> <span>(</span><span>int</span> i <span>:</span> set<span>)</span> <span>{</span>
                <span>int</span> j <span>=</span> <span>0</span><span>;</span><span>//记录I的每个元素的index</span>
                <span>Map</span><span><span>&lt;</span><span>Integer</span><span>,</span> <span>String</span><span>></span></span> map <span>=</span> <span>new</span> <span>TreeMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
                <span>//在I中寻找符合要求的I[i]</span>
                <span>for</span> <span>(</span><span>String</span> str <span>:</span> array<span>)</span> <span>{</span>
                    <span>if</span> <span>(</span>str<span>.</span><span>contains</span><span>(</span><span>String</span><span>.</span><span>valueOf</span><span>(</span>i<span>)</span><span>)</span><span>)</span><span>{</span>
                        map<span>.</span><span>put</span><span>(</span>j<span>,</span> str<span>)</span><span>;</span>
                    <span>}</span>
                    j<span>++</span><span>;</span>
                <span>}</span>
                <span>//如果Map非空 则存入result中 </span>
                <span>if</span> <span>(</span><span>!</span>map<span>.</span><span>isEmpty</span><span>(</span><span>)</span><span>)</span> <span>{</span>
                    <span>if</span> <span>(</span>count <span>></span> <span>0</span><span>)</span> <span>{</span>
                        result<span>.</span><span>append</span><span>(</span><span>" "</span><span>)</span><span>;</span>
                    <span>}</span>
                    result<span>.</span><span>append</span><span>(</span>i<span>)</span><span>.</span><span>append</span><span>(</span><span>" "</span><span>)</span><span>.</span><span>append</span><span>(</span>map<span>.</span><span>size</span><span>(</span><span>)</span><span>)</span><span>;</span>
                    count <span>+=</span><span>2</span><span>;</span><span>//多两个数组 </span>
                    <span>for</span> <span>(</span><span>Map<span>.</span>Entry</span><span><span>&lt;</span><span>Integer</span><span>,</span> <span>String</span><span>></span></span> entry <span>:</span> map<span>.</span><span>entrySet</span><span>(</span><span>)</span><span>)</span> <span>{</span>
                        count<span>+=</span><span>2</span><span>;</span>
                        result<span>.</span><span>append</span><span>(</span><span>" "</span><span>)</span><span>.</span><span>append</span><span>(</span>entry<span>.</span><span>getKey</span><span>(</span><span>)</span><span>)</span><span>.</span><span>append</span><span>(</span><span>" "</span><span>)</span><span>.</span><span>append</span><span>(</span>entry<span>.</span><span>getValue</span><span>(</span><span>)</span><span>)</span><span>;</span>
                    <span>}</span><span>;</span>
                <span>}</span>
            <span>}</span>
            <span>if</span> <span>(</span>count <span>></span> <span>0</span><span>)</span> <span>{</span>
                <span>StringBuilder</span> result2 <span>=</span> <span>new</span> <span>StringBuilder</span><span>(</span><span>)</span><span>;</span>
                result2<span>.</span><span>append</span><span>(</span>count<span>)</span><span>.</span><span>append</span><span>(</span><span>" "</span><span>)</span><span>.</span><span>append</span><span>(</span>result<span>.</span><span>toString</span><span>(</span><span>)</span><span>)</span><span>;</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>result2<span>.</span><span>toString</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="复杂度分析-5" tabindex="-1"> 复杂度分析</h4>
<ul>
<li>时间复杂度：O(nm+mlog2m)O(nm+mlog2m)<em>O</em>(<em>n**m</em>+<em>m<strong>l</strong>o**g</em>2<em>m</em>)，需要两层for循环遍历，一层遍历R一层遍历I，另外就是进行了排序的操作。</li>
<li>空间复杂度：O(n)O(n)<em>O</em>(<em>n</em>)，辅助空间为哈希表的长度.</li>
</ul>
<h3 id="方法三" tabindex="-1"> 方法三：</h3>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>
<span>public</span> <span>class</span> <span>Main</span><span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span><span>{</span>
        <span>/*
         根据题解可知：整数序列I 和 规则整数序列R
         1、是根据R中元素到I序列中进行匹配查询并将I序列中出现的R[i]的索引(index)和I[i]的值进行记录
         2、定义集合用于记录待查找条件R[i]和R[i]出现的次数(count),最后将第一步得到的集合放进来即可，此处也可使用StringBuffer
         */</span>
        <span>Scanner</span> scanner <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span><span>(</span>scanner<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span><span>{</span>
            <span>int</span> <span>In</span> <span>=</span> scanner<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span> <span>//整数序列I的个数</span>
            <span>String</span><span>[</span><span>]</span> <span>I_arr</span> <span>=</span>  <span>new</span> <span>String</span><span>[</span><span>In</span><span>]</span><span>;</span>
            <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span><span>;</span>i<span>&lt;</span><span>In</span><span>;</span>i<span>++</span><span>)</span><span>{</span>
                <span>I_arr</span><span>[</span>i<span>]</span><span>=</span> <span>String</span><span>.</span><span>valueOf</span><span>(</span>scanner<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>}</span>
            
            <span>int</span> <span>Rn</span> <span>=</span> scanner<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span><span>//规则整数序列R的个数</span>
            <span>Set</span><span><span>&lt;</span><span>Integer</span><span>></span></span> <span>R_set</span> <span>=</span> <span>new</span> <span>TreeSet</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span><span>//使用TreeSet进行排序和去重</span>
            <span>for</span><span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i<span>&lt;</span><span>Rn</span><span>;</span> i<span>++</span><span>)</span><span>{</span>
                <span>R_set</span><span>.</span><span>add</span><span>(</span>scanner<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>}</span>
            
            <span>List</span><span><span>&lt;</span><span>Integer</span><span>></span></span> <span>I_list</span> <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span><span>//用于存储整数序列I</span>
            <span>List</span><span><span>&lt;</span><span>Integer</span><span>></span></span> <span>R_list</span> <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span><span>//用于存储规则整数序列R</span>
            <span>for</span><span>(</span><span>int</span> item <span>:</span> <span>R_set</span><span>)</span><span>{</span>
               <span>int</span> count <span>=</span> <span>0</span><span>;</span><span>//统计R中元素在I中出现的次数</span>
               <span>for</span><span>(</span><span>int</span> i <span>=</span><span>0</span><span>;</span> i<span>&lt;</span><span>I_arr</span><span>.</span>length<span>;</span> i<span>++</span><span>)</span><span>{</span>
                   <span>if</span><span>(</span><span>I_arr</span><span>[</span>i<span>]</span><span>.</span><span>contains</span><span>(</span><span>String</span><span>.</span><span>valueOf</span><span>(</span>item<span>)</span><span>)</span><span>)</span><span>{</span>
                       count<span>++</span><span>;</span>
                       <span>I_list</span><span>.</span><span>add</span><span>(</span>i<span>)</span><span>;</span>
                       <span>I_list</span><span>.</span><span>add</span><span>(</span><span>Integer</span><span>.</span><span>valueOf</span><span>(</span><span>I_arr</span><span>[</span>i<span>]</span><span>)</span><span>)</span><span>;</span>
                   <span>}</span>
               <span>}</span>
               <span>if</span><span>(</span>count<span>></span><span>0</span><span>)</span><span>{</span>
                   <span>R_list</span><span>.</span><span>add</span><span>(</span>item<span>)</span><span>;</span>
                   <span>R_list</span><span>.</span><span>add</span><span>(</span>count<span>)</span><span>;</span>
                   <span>R_list</span><span>.</span><span>addAll</span><span>(</span><span>I_list</span><span>)</span><span>;</span>
               <span>}</span>
               <span>I_list</span><span>.</span><span>clear</span><span>(</span><span>)</span><span>;</span>
            <span>}</span>
            <span>System</span><span>.</span>out<span>.</span><span>print</span><span>(</span><span>R_list</span><span>.</span><span>size</span><span>(</span><span>)</span><span>+</span><span>" "</span><span>)</span><span>;</span>
            <span>for</span><span>(</span><span>Integer</span> i<span>:</span><span>R_list</span><span>)</span><span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>print</span><span>(</span>i<span>+</span><span>" "</span><span>)</span><span>;</span>
            <span>}</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="hj27-查找兄弟单词" tabindex="-1"> <strong>HJ27</strong> <strong>查找兄弟单词</strong></h2>
<h3 id="描述-10" tabindex="-1"> 描述</h3>
<p>定义一个单词的“兄弟单词”为：交换该单词字母顺序（注：可以交换任意次），而不添加、删除、修改原有的字母就能生成的单词。</p>
<p>兄弟单词要求和原来的单词不同。例如： ab 和 ba 是兄弟单词。 ab 和 ab 则不是兄弟单词。</p>
<p>现在给定你 n 个单词，另外再给你一个单词 x ，让你寻找 x 的兄弟单词里，按字典序排列后的第 k 个单词是什么？</p>
<p>注意：字典中可能有重复单词。</p>
<p>数据范围：1 \le n \le 1000 \1≤<em>n</em>≤1000 ，输入的字符串长度满足 1 \le len(str) \le 10 \1≤<em>l<strong>e</strong>n</em>(<em>s<strong>t</strong>r</em>)≤10 ， 1 \le k &lt; n \1≤<em>k</em>&lt;<em>n</em></p>
<h3 id="输入描述-10" tabindex="-1"> 输入描述：</h3>
<p>输入只有一行。 先输入字典中单词的个数n，再输入n个单词作为字典单词。 然后输入一个单词x 最后后输入一个整数k</p>
<h3 id="输出描述-10" tabindex="-1"> 输出描述：</h3>
<p>第一行输出查找到x的兄弟单词的个数m 第二行输出查找到的按照字典顺序排序后的第k个兄弟单词，没有符合第k个的话则不用输出。</p>
<h3 id="示例1-10" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>3 abc bca cab abc 1
</code></pre><div aria-hidden="true"><div></div></div></div><p>复制</p>
<p>输出：</p>
<div><pre><code>2
bca
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>复制</p>
<h3 id="示例2-1" tabindex="-1"> 示例2</h3>
<p>输入：</p>
<div><pre><code>6 cab ad abcd cba abc bca abc 1
</code></pre><div aria-hidden="true"><div></div></div></div><p>输出：</p>
<div><pre><code>3
bca
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>说明：</p>
<div><pre><code>abc的兄弟单词有cab cba bca，所以输出3
经字典序排列后，变为bca cab cba，所以第1个字典序兄弟单词为bca       
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h3 id="代码-6" tabindex="-1"> 代码：</h3>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>
<span>/**
 * 功能描述: <span><span><span>&lt;</span>br</span><span>></span></span>
 * @Param: 输入：
 * 6 cab ad abcd cba abc bca abc 1
 * 复制
 * 输出：
 * 3
 * bca
 * 复制
 * 说明：
 * abc的兄弟单词有cab cba bca，所以输出3
 * 经字典序排列后，变为bca cab cba，所以第1个字典序兄弟单词为bca
 * @Return:
 * @Author: guokun
 * @Date: 2021/10/13 14:18
 */</span>
<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>Scanner</span> scanner <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span> <span>(</span>scanner<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span><span>{</span>
            <span>String</span><span>[</span><span>]</span> ss <span>=</span> scanner<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>.</span><span>split</span><span>(</span><span>" "</span><span>)</span><span>;</span>
            <span>Integer</span> a <span>=</span> <span>Integer</span><span>.</span><span>parseInt</span><span>(</span>ss<span>[</span><span>0</span><span>]</span><span>)</span><span>;</span>
            <span>String</span> x <span>=</span> ss<span>[</span>ss<span>.</span>length<span>-</span><span>2</span><span>]</span><span>;</span>
            <span>Integer</span> k <span>=</span> <span>Integer</span><span>.</span><span>parseInt</span><span>(</span>ss<span>[</span>ss<span>.</span>length<span>-</span><span>1</span><span>]</span><span>)</span><span>;</span>
            <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> list <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>

            <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>1</span><span>;</span> i <span>&lt;=</span>a <span>;</span> i<span>++</span><span>)</span> <span>{</span>
                <span>if</span> <span>(</span><span>isBrother</span><span>(</span>x<span>,</span>ss<span>[</span>i<span>]</span><span>)</span><span>)</span><span>{</span>
                        list<span>.</span><span>add</span><span>(</span>ss<span>[</span>i<span>]</span><span>)</span><span>;</span>
                <span>}</span>
            <span>}</span>
            <span>int</span> size <span>=</span> list<span>.</span><span>size</span><span>(</span><span>)</span><span>;</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>size<span>)</span><span>;</span>
            <span>if</span> <span>(</span>size<span>>=</span>k<span>)</span><span>{</span>
                <span>Collections</span><span>.</span><span>sort</span><span>(</span>list<span>)</span><span>;</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>list<span>.</span><span>get</span><span>(</span>k<span>-</span><span>1</span><span>)</span><span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>
        <span>public</span> <span>static</span> <span>boolean</span> <span>isBrother</span><span>(</span><span>String</span> x<span>,</span><span>String</span> y<span>)</span><span>{</span>
            <span>if</span> <span>(</span>x<span>.</span><span>length</span><span>(</span><span>)</span><span>!=</span>y<span>.</span><span>length</span><span>(</span><span>)</span><span>||</span>y<span>.</span><span>equals</span><span>(</span>x<span>)</span><span>)</span><span>{</span>
                <span>return</span> <span>false</span><span>;</span>
            <span>}</span>
            <span>char</span><span>[</span><span>]</span> s <span>=</span> x<span>.</span><span>toCharArray</span><span>(</span><span>)</span><span>;</span>
            <span>char</span><span>[</span><span>]</span> j<span>=</span> y<span>.</span><span>toCharArray</span><span>(</span><span>)</span><span>;</span>
            <span>Arrays</span><span>.</span><span>sort</span><span>(</span>s<span>)</span><span>;</span>
            <span>Arrays</span><span>.</span><span>sort</span><span>(</span>j<span>)</span><span>;</span>
            <span>return</span> <span>new</span> <span>String</span><span>(</span>s<span>)</span><span>.</span><span>equals</span><span>(</span><span>new</span> <span>String</span><span>(</span>j<span>)</span><span>)</span><span>;</span>
        <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>1、对n个单词升序排序</p>
<p>2、第n个单词和 x 相等 和 长度不一致的跳过</p>
<p>3、对第n个单词 和 x 的每个字符升序排序，并比较是否相等，如果相等则为兄弟单词。</p>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span><span>{</span>

<span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span><span>{</span>
    <span>Scanner</span> in <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
    <span>while</span><span>(</span>in<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span><span>{</span>
        <span>int</span> num <span>=</span> in<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
        <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> datas <span>=</span> <span>new</span> <span>ArrayList</span><span>(</span><span>)</span><span>;</span>
        <span>for</span><span>(</span><span>int</span> i <span>=</span> <span>0</span> <span>;</span> i <span>&lt;</span> num <span>;</span> i<span>++</span><span>)</span><span>{</span>
            datas<span>.</span><span>add</span><span>(</span>in<span>.</span><span>next</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>}</span>
        <span>String</span> x <span>=</span> in<span>.</span><span>next</span><span>(</span><span>)</span><span>;</span>
        <span>char</span><span>[</span><span>]</span> xs <span>=</span> x<span>.</span><span>toCharArray</span><span>(</span><span>)</span><span>;</span><span>//取反</span>
        <span>int</span> index <span>=</span> in<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
        <span>Collections</span><span>.</span><span>sort</span><span>(</span>datas<span>)</span><span>;</span>
        <span>int</span> count <span>=</span> <span>0</span><span>;</span>
        <span>String</span> k <span>=</span> <span>""</span><span>;</span>
        <span>for</span><span>(</span><span>String</span> str <span>:</span> datas<span>)</span><span>{</span>
            <span>if</span><span>(</span>x<span>.</span><span>equals</span><span>(</span>str<span>)</span> <span>||</span> x<span>.</span><span>length</span><span>(</span><span>)</span> <span>!=</span> str<span>.</span><span>length</span><span>(</span><span>)</span><span>)</span><span>{</span>
                <span>continue</span><span>;</span> <span>//字符串一样 和 长度不一样的跳过</span>
            <span>}</span>
            <span>char</span><span>[</span><span>]</span> strs <span>=</span> str<span>.</span><span>toCharArray</span><span>(</span><span>)</span><span>;</span>
            <span>Arrays</span><span>.</span><span>sort</span><span>(</span>xs<span>)</span><span>;</span>
            <span>Arrays</span><span>.</span><span>sort</span><span>(</span>strs<span>)</span><span>;</span>
            <span>if</span><span>(</span><span>!</span><span>Arrays</span><span>.</span><span>equals</span><span>(</span>strs<span>,</span>xs<span>)</span><span>)</span><span>{</span>
                <span>continue</span><span>;</span><span>//升序排序不相等，跳过</span>
            <span>}</span>
            count <span>+=</span> <span>1</span><span>;</span> <span>// 满足条件的累加</span>
            <span>if</span> <span>(</span>count <span>==</span> index<span>)</span> <span>{</span>
                k <span>=</span> str<span>;</span><span>//第K个兄弟单词</span>
            <span>}</span>
        <span>}</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>count<span>)</span><span>;</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>k<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="hj28-素数伴侣" tabindex="-1"> <strong>HJ28</strong> <strong>素数伴侣</strong></h2>
<h3 id="描述-11" tabindex="-1"> 描述</h3>
<p>题目描述
若两个正整数的和为素数，则这两个正整数称之为“素数伴侣”，如2和5、6和13，它们能应用于通信加密。现在密码学会请你设计一个程序，从已有的 N （ N 为偶数）个正整数中挑选出若干对组成“素数伴侣”，挑选方案多种多样，例如有4个正整数：2，5，6，13，如果将5和6分为一组中只能得到一组“素数伴侣”，而将2和5、6和13编组将得到两组“素数伴侣”，能组成“素数伴侣”最多的方案称为“最佳方案”，当然密码学会希望你寻找出“最佳方案”。</p>
<p>输入:</p>
<p>有一个正偶数 n ，表示待挑选的自然数的个数。后面给出 n 个具体的数字。</p>
<p>输出:</p>
<p>输出一个整数 K ，表示你求得的“最佳方案”组成“素数伴侣”的对数。</p>
<p>数据范围： 1 \le n \le 100 \1≤<em>n</em>≤100 ，输入的数据大小满足 2 \le val \le 30000 \2≤<em>v<strong>a</strong>l</em>≤30000</p>
<h3 id="输入描述-11" tabindex="-1"> 输入描述：</h3>
<p>输入说明
1 输入一个正偶数 n
2 输入 n 个整数</p>
<h3 id="输出描述-11" tabindex="-1"> 输出描述：</h3>
<p>求得的“最佳方案”组成“素数伴侣”的对数。</p>
<h3 id="示例1-11" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>4
2 5 6 13
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>输出：</p>
<div><pre><code>2
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="示例2-2" tabindex="-1"> 示例2</h3>
<p>输入：</p>
<div><pre><code>2
3 6
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>输出：</p>
<div><pre><code>0
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="题意整理。" tabindex="-1"> 题意整理。</h3>
<ul>
<li>输入N（N为偶数）个正整数，从其中挑选出若干对组成“素数伴侣”。</li>
<li>问怎么挑选，可以使得“素数伴侣”的对数最多。</li>
<li>如果两个正整数的和为素数，则这两个正整数称之为“素数伴侣”。</li>
</ul>
<h3 id="方法一-匈牙利算法" tabindex="-1"> 方法一（匈牙利算法）</h3>
<h4 id="_1-解题思路" tabindex="-1"> 1.解题思路</h4>
<ul>
<li>首先定义两个list容器，分别存储输入整数中的奇数和偶数。</li>
<li>然后利用匈牙利算法找到“素数伴侣”对数最多时的配对数。匈牙利算法的核心思想是先到先得，能让就让。</li>
<li>最后输出“素数伴侣”最多时的对数。</li>
</ul>
<p>图解展示（匈牙利算法）：
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/0AA5426578FB65FAEA9C18632CFAFCFC.jpeg" alt="alt" loading="lazy"></p>
<p>举例说明：如图所示，首先A1和B2配对（先到先得），然后轮到A2，A2也可以和B2配对，这时候B2发现A1还可以和B4配对，所以放弃了A1，选择和A2组成伴侣（能让就让）。接着A3直接和B1配对（先到先得）。最后A4尝试与B4配对，但是这样A1就只能与B2配对，而A2就找不到伴侣了，一层层递归下来，发现不可行，所以A4不能与B4配对。</p>
<h4 id="_2-代码实现" tabindex="-1"> 2.代码实现</h4>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Scanner</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>ArrayList</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span><span>{</span>
    
    <span>static</span> <span>int</span> max<span>=</span><span>0</span><span>;</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span><span>{</span>
        <span>//标准输入</span>
        <span>Scanner</span> sc<span>=</span><span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span><span>(</span>sc<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span><span>{</span>
            <span>//输入正偶数</span>
            <span>int</span> n<span>=</span>sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
            <span>//用于记录输入的n个整数</span>
            <span>int</span><span>[</span><span>]</span> arr<span>=</span><span>new</span> <span>int</span><span>[</span>n<span>]</span><span>;</span>
            <span>//用于存储所有的奇数</span>
            <span>ArrayList</span><span><span>&lt;</span><span>Integer</span><span>></span></span> odds<span>=</span><span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
            <span>//用于存储所有的偶数</span>
            <span>ArrayList</span><span><span>&lt;</span><span>Integer</span><span>></span></span> evens<span>=</span><span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
            <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span><span>;</span>i<span>&lt;</span>n<span>;</span>i<span>++</span><span>)</span><span>{</span>
                arr<span>[</span>i<span>]</span><span>=</span>sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
                <span>//将奇数添加到odds</span>
                <span>if</span><span>(</span>arr<span>[</span>i<span>]</span><span>%</span><span>2</span><span>==</span><span>1</span><span>)</span><span>{</span>
                    odds<span>.</span><span>add</span><span>(</span>arr<span>[</span>i<span>]</span><span>)</span><span>;</span>
                <span>}</span>
                <span>//将偶数添加到evens</span>
                <span>if</span><span>(</span>arr<span>[</span>i<span>]</span><span>%</span><span>2</span><span>==</span><span>0</span><span>)</span><span>{</span>
                    evens<span>.</span><span>add</span><span>(</span>arr<span>[</span>i<span>]</span><span>)</span><span>;</span>
                <span>}</span>
            <span>}</span>
            <span>//下标对应已经匹配的偶数的下标，值对应这个偶数的伴侣</span>
            <span>int</span><span>[</span><span>]</span> matcheven<span>=</span><span>new</span> <span>int</span><span>[</span>evens<span>.</span><span>size</span><span>(</span><span>)</span><span>]</span><span>;</span>
            <span>//记录伴侣的对数</span>
            <span>int</span> count<span>=</span><span>0</span><span>;</span>
            <span>for</span><span>(</span><span>int</span> j<span>=</span><span>0</span><span>;</span>j<span>&lt;</span>odds<span>.</span><span>size</span><span>(</span><span>)</span><span>;</span>j<span>++</span><span>)</span><span>{</span>
                <span>//用于标记对应的偶数是否查找过</span>
                <span>boolean</span><span>[</span><span>]</span> v<span>=</span><span>new</span> <span>boolean</span><span>[</span>evens<span>.</span><span>size</span><span>(</span><span>)</span><span>]</span><span>;</span>
                <span>//如果匹配上，则计数加1</span>
                <span>if</span><span>(</span><span>find</span><span>(</span>odds<span>.</span><span>get</span><span>(</span>j<span>)</span><span>,</span>matcheven<span>,</span>evens<span>,</span>v<span>)</span><span>)</span><span>{</span>
                    count<span>++</span><span>;</span>
                <span>}</span>
            <span>}</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>count<span>)</span><span>;</span>
        <span>}</span>   
    <span>}</span>
    
    <span>//判断奇数x能否找到伴侣</span>
    <span>private</span> <span>static</span> <span>boolean</span> <span>find</span><span>(</span><span>int</span> x<span>,</span><span>int</span><span>[</span><span>]</span> matcheven<span>,</span><span>ArrayList</span><span><span>&lt;</span><span>Integer</span><span>></span></span> evens<span>,</span><span>boolean</span><span>[</span><span>]</span> v<span>)</span><span>{</span>
        <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span><span>;</span>i<span>&lt;</span>evens<span>.</span><span>size</span><span>(</span><span>)</span><span>;</span>i<span>++</span><span>)</span><span>{</span>
            <span>//该位置偶数没被访问过，并且能与x组成素数伴侣</span>
            <span>if</span><span>(</span><span>isPrime</span><span>(</span>x<span>+</span>evens<span>.</span><span>get</span><span>(</span>i<span>)</span><span>)</span><span>&amp;&amp;</span>v<span>[</span>i<span>]</span><span>==</span><span>false</span><span>)</span><span>{</span>
                v<span>[</span>i<span>]</span><span>=</span><span>true</span><span>;</span>
                <span>/*如果i位置偶数还没有伴侣，则与x组成伴侣，如果已经有伴侣，并且这个伴侣能重新找到新伴侣，
                则把原来伴侣让给别人，自己与x组成伴侣*/</span>
                <span>if</span><span>(</span>matcheven<span>[</span>i<span>]</span><span>==</span><span>0</span><span>||</span><span>find</span><span>(</span>matcheven<span>[</span>i<span>]</span><span>,</span>matcheven<span>,</span>evens<span>,</span>v<span>)</span><span>)</span><span>{</span>
                    matcheven<span>[</span>i<span>]</span><span>=</span>x<span>;</span>
                    <span>return</span> <span>true</span><span>;</span>
                <span>}</span>
            <span>}</span>
        <span>}</span>
        <span>return</span> <span>false</span><span>;</span>
    <span>}</span>
    <span>//判断x是否是素数</span>
    <span>private</span> <span>static</span> <span>boolean</span> <span>isPrime</span><span>(</span><span>int</span> x<span>)</span><span>{</span>
        <span>if</span><span>(</span>x<span>==</span><span>1</span><span>)</span> <span>return</span> <span>false</span><span>;</span>
        <span>//如果能被2到根号x整除，则一定不是素数</span>
        <span>for</span><span>(</span><span>int</span> i<span>=</span><span>2</span><span>;</span>i<span>&lt;=</span><span>(</span><span>int</span><span>)</span><span>Math</span><span>.</span><span>sqrt</span><span>(</span>x<span>)</span><span>;</span>i<span>++</span><span>)</span><span>{</span>
            <span>if</span><span>(</span>x<span>%</span>i<span>==</span><span>0</span><span>)</span><span>{</span>
                <span>return</span> <span>false</span><span>;</span>
            <span>}</span>
        <span>}</span>
        <span>return</span> <span>true</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_3-复杂度分析" tabindex="-1"> 3.复杂度分析</h4>
<ul>
<li>时间复杂度：假设输入的奇数的数目为p，输入的偶数的数目为q，则find函数的时间复杂度为O(q2)O(q<sup>2)*O*(*q*2)，因为循环内还嵌套了一个递归，虽然还有一个判断是否是素数的函数，但是题目中输入的数据范围在1-100之间，所以这个判断素数的函数的时间复杂度为O(1)O(1)*O*(1)。最坏情况下，奇数和偶数的数目相等，均为n/2n/2*n*/2，此时find函数的复杂度为O(n2)O(n</sup>2)<em>O</em>(<em>n</em>2)，需要对所有的奇数执行find，所以时间复杂度为O(n3)O(n^3)<em>O</em>(<em>n</em>3)。</li>
<li>空间复杂度：需要额外大小为p和q的list容器分别存储对应的奇数和偶数，p、q均不大于n，所以空间复杂度为O(n)O(n)<em>O</em>(<em>n</em>)。</li>
</ul>
<h3 id="方法二-利用io流" tabindex="-1"> 方法二（利用io流）</h3>
<h4 id="_1-解题思路-1" tabindex="-1"> 1.解题思路</h4>
<p>思路和方法一基本一致，不同的是通过io流操作来处理输入的数据。</p>
<h4 id="_2-代码实现-1" tabindex="-1"> 2.代码实现</h4>
<div><pre><code><span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>*</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>ArrayList</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span><span>{</span>
    
    <span>static</span> <span>int</span> max<span>=</span><span>0</span><span>;</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>throws</span> <span>Exception</span><span>{</span>
        <span>//io输入</span>
        <span>BufferedReader</span> br<span>=</span><span>new</span> <span>BufferedReader</span><span>(</span><span>new</span> <span>InputStreamReader</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>)</span><span>;</span>
        <span>String</span> s<span>;</span>
        <span>while</span><span>(</span><span>(</span>s<span>=</span>br<span>.</span><span>readLine</span><span>(</span><span>)</span><span>)</span><span>!=</span><span>null</span><span>)</span><span>{</span>
            <span>//输入正偶数n</span>
            <span>int</span> n<span>=</span><span>Integer</span><span>.</span><span>parseInt</span><span>(</span>s<span>)</span><span>;</span>
            <span>//输入n个整数</span>
            <span>String</span><span>[</span><span>]</span> arr<span>=</span>br<span>.</span><span>readLine</span><span>(</span><span>)</span><span>.</span><span>split</span><span>(</span><span>" "</span><span>)</span><span>;</span> 
            <span>//用于存储所有的奇数</span>
            <span>ArrayList</span><span><span>&lt;</span><span>Integer</span><span>></span></span> odds<span>=</span><span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
            <span>//用于存储所有的偶数</span>
            <span>ArrayList</span><span><span>&lt;</span><span>Integer</span><span>></span></span> evens<span>=</span><span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
            <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span><span>;</span>i<span>&lt;</span>n<span>;</span>i<span>++</span><span>)</span><span>{</span>
                <span>int</span> num<span>=</span><span>Integer</span><span>.</span><span>parseInt</span><span>(</span>arr<span>[</span>i<span>]</span><span>)</span><span>;</span>
                <span>//将奇数添加到odds</span>
                <span>if</span><span>(</span>num<span>%</span><span>2</span><span>==</span><span>1</span><span>)</span><span>{</span>
                    odds<span>.</span><span>add</span><span>(</span>num<span>)</span><span>;</span>
                <span>}</span>
                <span>//将偶数添加到evens</span>
                <span>if</span><span>(</span>num<span>%</span><span>2</span><span>==</span><span>0</span><span>)</span><span>{</span>
                    evens<span>.</span><span>add</span><span>(</span>num<span>)</span><span>;</span>
                <span>}</span>
            <span>}</span>
            <span>//下标对应已经匹配的偶数的下标，值对应这个偶数的伴侣</span>
            <span>int</span><span>[</span><span>]</span> matcheven<span>=</span><span>new</span> <span>int</span><span>[</span>evens<span>.</span><span>size</span><span>(</span><span>)</span><span>]</span><span>;</span>
            <span>//记录伴侣的对数</span>
            <span>int</span> count<span>=</span><span>0</span><span>;</span>
            <span>for</span><span>(</span><span>int</span> j<span>=</span><span>0</span><span>;</span>j<span>&lt;</span>odds<span>.</span><span>size</span><span>(</span><span>)</span><span>;</span>j<span>++</span><span>)</span><span>{</span>
                <span>//用于标记对应的偶数是否查找过</span>
                <span>boolean</span><span>[</span><span>]</span> v<span>=</span><span>new</span> <span>boolean</span><span>[</span>evens<span>.</span><span>size</span><span>(</span><span>)</span><span>]</span><span>;</span>
                <span>//如果匹配上，则计数加1</span>
                <span>if</span><span>(</span><span>find</span><span>(</span>odds<span>.</span><span>get</span><span>(</span>j<span>)</span><span>,</span>matcheven<span>,</span>evens<span>,</span>v<span>)</span><span>)</span><span>{</span>
                    count<span>++</span><span>;</span>
                <span>}</span>
            <span>}</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>count<span>)</span><span>;</span>
        <span>}</span>   
    <span>}</span>
    
    <span>//判断奇数x能否找到伴侣</span>
    <span>private</span> <span>static</span> <span>boolean</span> <span>find</span><span>(</span><span>int</span> x<span>,</span><span>int</span><span>[</span><span>]</span> matcheven<span>,</span><span>ArrayList</span><span><span>&lt;</span><span>Integer</span><span>></span></span> evens<span>,</span><span>boolean</span><span>[</span><span>]</span> v<span>)</span><span>{</span>
        <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span><span>;</span>i<span>&lt;</span>evens<span>.</span><span>size</span><span>(</span><span>)</span><span>;</span>i<span>++</span><span>)</span><span>{</span>
            <span>//该位置偶数没被访问过，并且能与x组成素数伴侣</span>
            <span>if</span><span>(</span><span>isPrime</span><span>(</span>x<span>+</span>evens<span>.</span><span>get</span><span>(</span>i<span>)</span><span>)</span><span>&amp;&amp;</span>v<span>[</span>i<span>]</span><span>==</span><span>false</span><span>)</span><span>{</span>
                v<span>[</span>i<span>]</span><span>=</span><span>true</span><span>;</span>
                <span>/*如果i位置偶数还没有伴侣，则与x组成伴侣，如果已经有伴侣，并且这个伴侣能重新找到新伴侣，
                则把原来伴侣让给别人，自己与x组成伴侣*/</span>
                <span>if</span><span>(</span>matcheven<span>[</span>i<span>]</span><span>==</span><span>0</span><span>||</span><span>find</span><span>(</span>matcheven<span>[</span>i<span>]</span><span>,</span>matcheven<span>,</span>evens<span>,</span>v<span>)</span><span>)</span><span>{</span>
                    matcheven<span>[</span>i<span>]</span><span>=</span>x<span>;</span>
                    <span>return</span> <span>true</span><span>;</span>
                <span>}</span>
            <span>}</span>
        <span>}</span>
        <span>return</span> <span>false</span><span>;</span>
    <span>}</span>
    <span>//判断x是否是素数</span>
    <span>private</span> <span>static</span> <span>boolean</span> <span>isPrime</span><span>(</span><span>int</span> x<span>)</span><span>{</span>
        <span>if</span><span>(</span>x<span>==</span><span>1</span><span>)</span> <span>return</span> <span>false</span><span>;</span>
        <span>//如果能被2到根号x整除，则一定不是素数</span>
        <span>for</span><span>(</span><span>int</span> i<span>=</span><span>2</span><span>;</span>i<span>&lt;=</span><span>(</span><span>int</span><span>)</span><span>Math</span><span>.</span><span>sqrt</span><span>(</span>x<span>)</span><span>;</span>i<span>++</span><span>)</span><span>{</span>
            <span>if</span><span>(</span>x<span>%</span>i<span>==</span><span>0</span><span>)</span><span>{</span>
                <span>return</span> <span>false</span><span>;</span>
            <span>}</span>
        <span>}</span>
        <span>return</span> <span>true</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_3-复杂度分析-1" tabindex="-1"> 3.复杂度分析</h4>
<ul>
<li>时间复杂度：假设输入的奇数的数目为p，输入的偶数的数目为q，则find函数的时间复杂度为O(q2)O(q<sup>2)*O*(*q*2)，因为循环内还嵌套了一个递归，虽然还有一个判断是否是素数的函数，但是题目中输入的数据范围在1-100之间，所以这个判断素数的函数的时间复杂度为O(1)O(1)*O*(1)。最坏情况下，奇数和偶数的数目相等，均为n/2n/2*n*/2，此时find函数的复杂度为O(n2)O(n</sup>2)<em>O</em>(<em>n</em>2)，需要对所有的奇数执行find，所以时间复杂度为O(n3)O(n^3)<em>O</em>(<em>n</em>3)。</li>
<li>空间复杂度：需要额外大小为p和q的list容器分别存储对应的奇数和偶数，p、q均不大于n，所以空间复杂度为O(n)O(n)<em>O</em>(<em>n</em>)。</li>
</ul>
<h2 id="hj33-整数与ip地址间的转换" tabindex="-1"> <strong>HJ33</strong> <strong>整数与IP地址间的转换</strong></h2>
<h3 id="描述-12" tabindex="-1"> 描述</h3>
<p>原理：ip地址的每段可以看成是一个0-255的整数，把每段拆分成一个二进制形式组合起来，然后把这个二进制数转变成
一个长整数。
举例：一个ip地址为10.0.3.193
每段数字       相对应的二进制数
10          00001010
0          00000000
3          00000011
193         11000001</p>
<p>组合起来即为：00001010 00000000 00000011 11000001,转换为10进制数就是：167773121，即该IP地址转换后的数字就是它了。</p>
<p>数据范围：保证输入的是合法的 IP 序列</p>
<h3 id="输入描述-12" tabindex="-1"> 输入描述：</h3>
<p>输入
1 输入IP地址
2 输入10进制型的IP地址</p>
<h3 id="输出描述-12" tabindex="-1"> 输出描述：</h3>
<p>输出
1 输出转换成10进制的IP地址
2 输出转换后的IP地址</p>
<h3 id="示例1-12" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>10.0.3.193
167969729
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>输出：</p>
<div><pre><code>167773121
10.3.3.193
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h3 id="题目主要信息-1" tabindex="-1"> 题目主要信息</h3>
<p>1、将ip地址转化为长整数</p>
<p>2、将长整数转换为ip地址</p>
<h3 id="方法一-通过二进制进行转换" tabindex="-1"> 方法一:通过二进制进行转换</h3>
<h3 id="具体方法-2" tabindex="-1"> 具体方法</h3>
<p>在问题中有两个转换过程，一个是将ip地址转换为长整数，一个是将长整数转换为ip地址，通过题目中的转换过程进行转换。 对于ip地址转换成长整数： 1、将ip地址切割成四段数字 2、每段数字用8位2二进制数字表示 3、将四段二进制数字组合 4、将二进制数字转换成长整数 对于长整数转换成ip地址则步骤相反 1、将长整数转换成32位二进制数字 2、将32位二进制数字进行切割 3、将每段的二进制数字转换为十进制数字 4、形成ip地址</p>
<h3 id="java代码-5" tabindex="-1"> Java代码</h3>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Scanner</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span><span>{</span>
        <span>Scanner</span> sc <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span><span>(</span>sc<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span><span>{</span>
            <span>String</span> s <span>=</span> sc<span>.</span><span>next</span><span>(</span><span>)</span><span>;</span>
            <span>if</span><span>(</span>s<span>.</span><span>contains</span><span>(</span><span>"."</span><span>)</span><span>)</span><span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>ip2num</span><span>(</span>s<span>)</span><span>)</span><span>;</span>
            <span>}</span><span>else</span><span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>num2ip</span><span>(</span><span>Long</span><span>.</span><span>parseLong</span><span>(</span>s<span>)</span><span>)</span><span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>

    <span>public</span> <span>static</span> <span>long</span> <span>ip2num</span><span>(</span><span>String</span> ip<span>)</span><span>{</span>
        <span>String</span><span>[</span><span>]</span> iip <span>=</span> ip<span>.</span><span>split</span><span>(</span><span>"\\."</span><span>)</span><span>;</span>
        <span>StringBuilder</span> sb <span>=</span> <span>new</span> <span>StringBuilder</span><span>(</span><span>)</span><span>;</span>
        <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span><span>;</span> i<span>&lt;</span><span>4</span><span>;</span> i<span>++</span><span>)</span><span>{</span>
            <span>int</span> num <span>=</span> <span>Integer</span><span>.</span><span>parseInt</span><span>(</span>iip<span>[</span>i<span>]</span><span>)</span><span>;</span>  <span>// 拆分</span>
            <span>String</span> num2 <span>=</span> <span>Integer</span><span>.</span><span>toBinaryString</span><span>(</span>num<span>)</span><span>;</span>  <span>//转换为二进制</span>
            <span>while</span><span>(</span>num2<span>.</span><span>length</span><span>(</span><span>)</span><span>&lt;</span><span>8</span><span>)</span><span>{</span>
                num2 <span>=</span> <span>"0"</span> <span>+</span> num2<span>;</span>  <span>// 拼接</span>
            <span>}</span>
            sb<span>.</span><span>append</span><span>(</span>num2<span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> <span>Long</span><span>.</span><span>parseLong</span><span>(</span>sb<span>.</span><span>toString</span><span>(</span><span>)</span><span>,</span> <span>2</span><span>)</span><span>;</span>  <span>// 转化为10进制</span>
    <span>}</span>

    <span>public</span> <span>static</span> <span>String</span> <span>num2ip</span><span>(</span><span>long</span> num<span>)</span><span>{</span>
        <span>String</span> num2 <span>=</span> <span>Long</span><span>.</span><span>toBinaryString</span><span>(</span>num<span>)</span><span>;</span>  <span>//转换为2进制</span>
        <span>while</span><span>(</span>num2<span>.</span><span>length</span><span>(</span><span>)</span><span>&lt;</span><span>32</span><span>)</span><span>{</span>
            num2 <span>=</span> <span>"0"</span> <span>+</span> num2<span>;</span>
        <span>}</span>
        <span>String</span><span>[</span><span>]</span> ans <span>=</span> <span>new</span> <span>String</span><span>[</span><span>4</span><span>]</span><span>;</span>
        <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span><span>;</span> i<span>&lt;</span><span>4</span><span>;</span> i<span>++</span><span>)</span><span>{</span>
            <span>String</span> s <span>=</span> num2<span>.</span><span>substring</span><span>(</span><span>8</span><span>*</span>i<span>,</span> <span>8</span><span>*</span>i<span>+</span><span>8</span><span>)</span><span>;</span>  <span>//拆分</span>
            s <span>=</span> <span>Integer</span><span>.</span><span>toString</span><span>(</span><span>Integer</span><span>.</span><span>parseInt</span><span>(</span>s<span>,</span> <span>2</span><span>)</span><span>)</span><span>;</span>  <span>//转化为10进制</span>
            ans<span>[</span>i<span>]</span> <span>=</span> s<span>;</span>
        <span>}</span>
        <span>return</span> <span>String</span><span>.</span><span>join</span><span>(</span><span>"."</span><span>,</span> ans<span>)</span><span>;</span>  <span>//拼接</span>
    <span>}</span>
<span>}</span>

</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="复杂度分析-6" tabindex="-1"> 复杂度分析</h3>
<ul>
<li>时间复杂度：O(1)O(1)<em>O</em>(1)，均为常数级别的转换</li>
<li>空间复杂度：O(1)O(1)<em>O</em>(1)</li>
</ul>
<h3 id="方法二-直接转换-10进制和256进制" tabindex="-1"> 方法二：直接转换（10进制和256进制）</h3>
<h3 id="具体方法-3" tabindex="-1"> 具体方法</h3>
<p>在第一种方法中，我们通过二进制进行转换，但是仔细分析之后，我们发现，二进制在转换过程中并没有起到作用，再进行重新分析，我们可以发现，ip地址实际上是256进制下的四位数字，所以我们可以直接进行转换，将10进制转化为256进制。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/A2CB19422F49F00D316AB0AFCA62827D.png" alt="alt" loading="lazy"></p>
<h3 id="java代码-6" tabindex="-1"> Java代码</h3>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Scanner</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span><span>{</span>
        <span>Scanner</span> sc <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span><span>(</span>sc<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span><span>{</span>
            <span>String</span> s <span>=</span> sc<span>.</span><span>next</span><span>(</span><span>)</span><span>;</span>
            <span>if</span><span>(</span>s<span>.</span><span>contains</span><span>(</span><span>"."</span><span>)</span><span>)</span><span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>ip2num</span><span>(</span>s<span>)</span><span>)</span><span>;</span>
            <span>}</span><span>else</span><span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>num2ip</span><span>(</span><span>Long</span><span>.</span><span>parseLong</span><span>(</span>s<span>)</span><span>)</span><span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>

    <span>public</span> <span>static</span> <span>long</span> <span>ip2num</span><span>(</span><span>String</span> ip<span>)</span><span>{</span>
        <span>String</span><span>[</span><span>]</span> iip <span>=</span> ip<span>.</span><span>split</span><span>(</span><span>"\\."</span><span>)</span><span>;</span>
        <span>Long</span> ans <span>=</span> <span>(</span><span>long</span><span>)</span><span>0</span><span>;</span>
        <span>for</span><span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i<span>&lt;</span><span>4</span><span>;</span> i<span>++</span><span>)</span><span>{</span>
            ans <span>=</span> ans <span>*</span> <span>256</span> <span>+</span> <span>Long</span><span>.</span><span>parseLong</span><span>(</span>iip<span>[</span>i<span>]</span><span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> ans<span>;</span>
    <span>}</span>

    <span>public</span> <span>static</span> <span>String</span> <span>num2ip</span><span>(</span><span>long</span> num<span>)</span><span>{</span>
        <span>String</span><span>[</span><span>]</span> ans <span>=</span> <span>new</span> <span>String</span><span>[</span><span>4</span><span>]</span><span>;</span>
        <span>for</span><span>(</span><span>int</span> i<span>=</span><span>3</span><span>;</span> i<span>>=</span><span>0</span><span>;</span> i<span>--</span><span>)</span><span>{</span>
            ans<span>[</span>i<span>]</span> <span>=</span> <span>Long</span><span>.</span><span>toString</span><span>(</span>num <span>%</span> <span>256</span><span>)</span><span>;</span>
            num <span>=</span> num <span>/</span> <span>256</span><span>;</span>
        <span>}</span>
        <span>return</span> <span>String</span><span>.</span><span>join</span><span>(</span><span>"."</span><span>,</span> ans<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="复杂度分析-7" tabindex="-1"> 复杂度分析</h3>
<ul>
<li>时间复杂度：O(1)O(1)<em>O</em>(1)，均为常数级别的转换</li>
<li>空间复杂度：O(1)O(1)<em>O</em>(1)</li>
</ul>
<h2 id="hj41-称砝码" tabindex="-1"> <strong>HJ41</strong> <strong>称砝码</strong></h2>
<h3 id="描述-13" tabindex="-1"> 描述</h3>
<p>现有n种砝码，重量互不相等，分别为 m1,m2,m3…mn ；
每种砝码对应的数量为 x1,x2,x3...xn 。现在要用这些砝码去称物体的重量(放在同一侧)，问能称出多少种不同的重量。</p>
<p>注：</p>
<p>称重重量包括 0</p>
<p>数据范围：每组输入数据满足 1 \le n \le 10 \1≤<em>n</em>≤10 ， 1 \le m_i \le 2000 \1≤<em>m**i</em>≤2000 ， 1 \le x_i \le 10 \1≤<em>x**i</em>≤10</p>
<h3 id="输入描述-13" tabindex="-1"> 输入描述：</h3>
<p>对于每组测试数据：
第一行：n --- 砝码的种数(范围[1,10])
第二行：m1 m2 m3 ... mn --- 每种砝码的重量(范围[1,2000])
第三行：x1 x2 x3 .... xn --- 每种砝码对应的数量(范围[1,10])</p>
<h3 id="输出描述-13" tabindex="-1"> 输出描述：</h3>
<p>利用给定的砝码可以称出的不同的重量数</p>
<h3 id="示例1-13" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>2
1 2
2 1
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>输出：</p>
<div><pre><code>5
</code></pre><div aria-hidden="true"><div></div></div></div><p>说明：</p>
<div><pre><code>可以表示出0，1，2，3，4五种重量。   
</code></pre><div aria-hidden="true"><div></div></div></div><p>hashset去重，三层循环，遍历砝码，遍历砝码个数，遍历当前set的结果</p>
<h3 id="代码-7" tabindex="-1"> 代码：</h3>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>Scanner</span> in <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span> <span>(</span>in<span>.</span><span>hasNextInt</span><span>(</span><span>)</span><span>)</span> <span>{</span> <span>// 注意 while 处理多个 case</span>
            <span>HashSet</span><span><span>&lt;</span><span>Integer</span><span>></span></span> set <span>=</span> <span>new</span> <span>HashSet</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span><span>//存放所有可能的结果，不用担心重复问题</span>
            set<span>.</span><span>add</span><span>(</span><span>0</span><span>)</span><span>;</span><span>//初始化为0</span>
            <span>int</span> n <span>=</span> in<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span><span>//个数</span>
            <span>int</span><span>[</span><span>]</span> w <span>=</span> <span>new</span> <span>int</span><span>[</span>n<span>]</span><span>;</span>
            <span>int</span><span>[</span><span>]</span> nums <span>=</span> <span>new</span> <span>int</span><span>[</span>n<span>]</span><span>;</span>
            <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span><span>;</span>i<span>&lt;</span>n<span>;</span>i<span>++</span><span>)</span><span>{</span>
                w<span>[</span>i<span>]</span> <span>=</span> in<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span><span>//砝码的重量</span>
            <span>}</span>
            <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span><span>;</span>i<span>&lt;</span>n<span>;</span>i<span>++</span><span>)</span><span>{</span>
                nums<span>[</span>i<span>]</span> <span>=</span> in<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span><span>//砝码个数</span>
            <span>}</span>
            <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span><span>;</span>i<span>&lt;</span>n<span>;</span>i<span>++</span><span>)</span><span>{</span><span>//遍历砝码</span>
                <span>ArrayList</span><span><span>&lt;</span><span>Integer</span><span>></span></span> list <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span>set<span>)</span><span>;</span><span>//取当前所有的结果</span>
                <span>for</span><span>(</span><span>int</span> j<span>=</span><span>1</span><span>;</span>j<span>&lt;=</span>nums<span>[</span>i<span>]</span><span>;</span>j<span>++</span><span>)</span><span>{</span><span>//遍历个数</span>
                    <span>for</span><span>(</span><span>int</span> k<span>=</span><span>0</span><span>;</span>k<span>&lt;</span>list<span>.</span><span>size</span><span>(</span><span>)</span><span>;</span>k<span>++</span><span>)</span><span>{</span>
                        set<span>.</span><span>add</span><span>(</span>list<span>.</span><span>get</span><span>(</span>k<span>)</span> <span>+</span> w<span>[</span>i<span>]</span> <span>*</span> j<span>)</span><span>;</span>
                    <span>}</span>
                <span>}</span>
            <span>}</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>set<span>.</span><span>size</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="hj60-查找组成一个偶数最接近的两个素数" tabindex="-1"> <strong>HJ60</strong> <strong>查找组成一个偶数最接近的两个素数</strong></h2>
<h3 id="描述-14" tabindex="-1"> 描述</h3>
<p>任意一个偶数（大于2）都可以由2个素数组成，组成偶数的2个素数有很多种情况，本题目要求输出组成指定偶数的两个素数差值最小的素数对。</p>
<p>数据范围：输入的数据满足 4 \le n \le 1000 \4≤<em>n</em>≤1000</p>
<h3 id="输入描述-14" tabindex="-1"> 输入描述：</h3>
<p>输入一个大于2的偶数</p>
<h3 id="输出描述-14" tabindex="-1"> 输出描述：</h3>
<p>从小到大输出两个素数</p>
<h3 id="示例1-14" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>20
</code></pre><div aria-hidden="true"><div></div></div></div><p>输出：</p>
<div><pre><code>7
13
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h2 id="示例2-3" tabindex="-1"> 示例2</h2>
<p>输入：</p>
<div><pre><code>4
</code></pre><div aria-hidden="true"><div></div></div></div><p>输出：</p>
<div><pre><code>2
2
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h3 id="穷举优化" tabindex="-1"> 穷举优化</h3>
<p><strong>解题思路：</strong></p>
<p>采取从中间向两边枚举的方式，这样贪心的控制住两素数之差距离最小的这个限制</p>
<p><strong>算法流程</strong>：</p>
<ul>
<li>对于每个数字，从最接近的两个中位数开始处理判断是否素数</li>
<li>如果两个组成偶数的数字都是素数，因为是从最接近的两个数开始枚举，因此一旦都是素数则输出并返回，得到结果</li>
</ul>
<p><strong>Java 版本代码如下：</strong></p>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>
 
<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>Scanner</span> scanner <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span> <span>(</span>scanner<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span><span>{</span>
        	<span>int</span> num <span>=</span> scanner<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
        	<span>solution</span><span>(</span>num<span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>

    <span>private</span> <span>static</span> <span>void</span> <span>solution</span><span>(</span><span>int</span> num<span>)</span> <span>{</span>
        <span>//如num=10, 遍历:5,6,7,8</span>
        <span>// 从最接近的两个中位数开始处理判断</span>
        <span>for</span><span>(</span><span>int</span> i <span>=</span> num <span>/</span> <span>2</span><span>;</span> i <span>&lt;</span> num <span>-</span> <span>1</span><span>;</span> i<span>++</span><span>)</span> <span>{</span>
            <span>if</span><span>(</span><span>isPrime</span><span>(</span>i<span>)</span> <span>&amp;&amp;</span> <span>isPrime</span><span>(</span>num <span>-</span> i<span>)</span><span>)</span> <span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>(</span>num <span>-</span> i<span>)</span> <span>+</span> <span>"\n"</span> <span>+</span> i<span>)</span><span>;</span>
                <span>return</span><span>;</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>
    <span>// 判断是否素数</span>
    <span>private</span> <span>static</span> <span>boolean</span> <span>isPrime</span><span>(</span><span>int</span> num<span>)</span> <span>{</span>
        <span>for</span><span>(</span><span>int</span> i <span>=</span> <span>2</span><span>;</span> i <span>&lt;=</span> <span>Math</span><span>.</span><span>sqrt</span><span>(</span>num<span>)</span><span>;</span> i<span>++</span><span>)</span> <span>{</span>
            <span>if</span><span>(</span>num <span>%</span> i <span>==</span> <span>0</span><span>)</span> <span>{</span>
                <span>return</span> <span>false</span><span>;</span>
            <span>}</span>
        <span>}</span> 
        <span>return</span> <span>true</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="hj68-成绩排序" tabindex="-1"> <strong>HJ68</strong> <strong>成绩排序</strong></h2>
<h3 id="描述-15" tabindex="-1"> 描述</h3>
<p>给定一些同学的信息（名字，成绩）序列，请你将他们的信息按照成绩从高到低或从低到高的排列,相同成绩</p>
<p>都按先录入排列在前的规则处理。</p>
<p>例示：
jack   70
peter   96
Tom    70
smith   67</p>
<p>从高到低 成绩
peter   96
jack   70
Tom    70
smith   67</p>
<p>从低到高</p>
<p>smith   67</p>
<p>jack   70</p>
<p>Tom    70</p>
<p>peter   96</p>
<p>注：0代表从高到低，1代表从低到高</p>
<p>数据范围：人数：1\le n \le 200\1≤<em>n</em>≤200</p>
<p>进阶：时间复杂度：O(nlogn)*O*(<em>n<strong>l</strong>o<strong>g</strong>n</em>) ，空间复杂度：O(n)*O*(<em>n</em>)</p>
<h3 id="输入描述-15" tabindex="-1"> 输入描述：</h3>
<p>第一行输入要排序的人的个数n，第二行输入一个整数表示排序的方式，之后n行分别输入他们的名字和成绩，以一个空格隔开</p>
<h3 id="输出描述-15" tabindex="-1"> 输出描述：</h3>
<p>按照指定方式输出名字和成绩，名字和成绩之间以一个空格隔开</p>
<h3 id="示例1-15" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>3
0
fang 90
yang 50
ning 70
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>输出：</p>
<div><pre><code>fang 90
ning 70
yang 50
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><h3 id="示例2-4" tabindex="-1"> 示例2</h3>
<p>输入：</p>
<div><pre><code>3
1
fang 90
yang 50
ning 70
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>输出：</p>
<div><pre><code>yang 50
ning 70
fang 90
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p><strong>算法流程</strong>：</p>
<ul>
<li>通过一个二维数组，每一行包括姓名编号，成绩，将输入的姓名用编号代替，第二列保存成绩</li>
<li>自定义排序
<ul>
<li>倒序，按第二列的成绩降序排列,如果相等的话，返回0，顺序不变，因为默认编号是升序的，符合题意</li>
<li>升序则 按成绩升序排序</li>
</ul>
</li>
<li>最后根据已经排序后的数组，顺序输出结果</li>
</ul>
<h3 id="代码-8" tabindex="-1"> 代码：</h3>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span><span>{</span>
        <span>Scanner</span> sc <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>HashMap</span><span><span>&lt;</span><span>Integer</span><span>,</span><span>String</span><span>></span></span> map <span>=</span> <span>new</span> <span>HashMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
        <span>while</span><span>(</span>sc<span>.</span><span>hasNextLine</span><span>(</span><span>)</span><span>)</span><span>{</span>
            <span>// 学生成绩数</span>
            <span>int</span> n <span>=</span> <span>Integer</span><span>.</span><span>parseInt</span><span>(</span>sc<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>//1是升序，0是降序</span>
            <span>int</span> flag <span>=</span> <span>Integer</span><span>.</span><span>parseInt</span><span>(</span>sc<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>// 每一行包括姓名编号，成绩</span>
            <span>int</span><span>[</span><span>]</span><span>[</span><span>]</span> score <span>=</span> <span>new</span> <span>int</span><span>[</span>n<span>]</span><span>[</span><span>2</span><span>]</span><span>;</span>
            <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span><span>;</span>i<span>&lt;</span>n<span>;</span>i<span>++</span><span>)</span><span>{</span>
                <span>String</span><span>[</span><span>]</span> nameAndScore <span>=</span> sc<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>.</span><span>split</span><span>(</span><span>" "</span><span>)</span><span>;</span>
                <span>// 学生用编号代替</span>
                score<span>[</span>i<span>]</span><span>[</span><span>0</span><span>]</span> <span>=</span> i<span>;</span>
                score<span>[</span>i<span>]</span><span>[</span><span>1</span><span>]</span> <span>=</span> <span>Integer</span><span>.</span><span>parseInt</span><span>(</span>nameAndScore<span>[</span><span>1</span><span>]</span><span>)</span><span>;</span>
                map<span>.</span><span>put</span><span>(</span>i<span>,</span>nameAndScore<span>[</span><span>0</span><span>]</span><span>)</span><span>;</span>
            <span>}</span>
            <span>// 自定义排序</span>
            <span>Arrays</span><span>.</span><span>sort</span><span>(</span>score<span>,</span><span>(</span>o1<span>,</span>o2<span>)</span> <span>-></span><span>{</span>
                <span>// 倒序，按第二列的成绩降序排列,如果相等的话，返回0，顺序不变，因为默认编号是升序的，符合题意</span>
                <span>if</span><span>(</span>flag<span>==</span><span>0</span><span>)</span><span>{</span>
                    <span>return</span> o2<span>[</span><span>1</span><span>]</span> <span>-</span> o1<span>[</span><span>1</span><span>]</span><span>;</span>
                <span>}</span><span>else</span><span>{</span>
                    <span>// 按成绩升序排序</span>
                    <span>return</span> o1<span>[</span><span>1</span><span>]</span> <span>-</span> o2<span>[</span><span>1</span><span>]</span><span>;</span>
                <span>}</span>
            <span>}</span><span>)</span><span>;</span>
            <span>// 根据已经排序后的数组，顺序输出结果</span>
            <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span><span>;</span>i<span>&lt;</span>n<span>;</span>i<span>++</span><span>)</span><span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>map<span>.</span><span>get</span><span>(</span>score<span>[</span>i<span>]</span><span>[</span><span>0</span><span>]</span><span>)</span> <span>+</span> <span>" "</span> <span>+</span> score<span>[</span>i<span>]</span><span>[</span><span>1</span><span>]</span><span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="hj101-输入整型数组和排序标识-对其元素按照升序或降序进行排序" tabindex="-1"> <strong>HJ101</strong> <strong>输入整型数组和排序标识，对其元素按照升序或降序进行排序</strong></h2>
<h3 id="描述-16" tabindex="-1"> 描述</h3>
<p>输入整型数组和排序标识，对其元素按照升序或降序进行排序</p>
<p>数据范围： 1 \le n \le 1000 \1≤<em>n</em>≤1000 ，元素大小满足 0 \le val \le 100000 \0≤<em>v<strong>a</strong>l</em>≤100000</p>
<h3 id="输入描述-16" tabindex="-1"> 输入描述：</h3>
<p>第一行输入数组元素个数
第二行输入待排序的数组，每个数用空格隔开
第三行输入一个整数0或1。0代表升序排序，1代表降序排序</p>
<h3 id="输出描述-16" tabindex="-1"> 输出描述：</h3>
<p>输出排好序的数字</p>
<h3 id="示例1-16" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>8
1 2 4 9 3 55 64 25
0
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>输出：</p>
<div><pre><code>1 2 3 4 9 25 55 64
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="示例2-5" tabindex="-1"> 示例2</h3>
<p>输入：</p>
<div><pre><code>5
1 2 3 4 5
1
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>输出：</p>
<div><pre><code>5 4 3 2 1
</code></pre><div aria-hidden="true"><div></div></div></div><blockquote>
<p>Scanner有多次输入，且存在输入数字组成数组的情况 建议使用while(sc.hasNext()) 判断是否存在下次输入，并按业务录入数字组成数组</p>
</blockquote>
<blockquote>
<p>Arrays.sort方法可以对Integer数组 按Comparator自定义比较器执行排序，注意参数o1,o2, 左-右（o1-o2）是升序排序; 右-左（o2-o1）是降序排序;</p>
</blockquote>
<blockquote>
<p>题解源代码</p>
</blockquote>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>
<span>public</span> <span>class</span> <span>Main</span><span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span><span>{</span>
        <span>Scanner</span> sc <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
   
        <span>//有多次输入，且存在输入数字组成数组的情况</span>
        <span>while</span><span>(</span>sc<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span><span>{</span>
            <span>//第一行输入数组元素个数</span>
             <span>int</span> arrCount <span>=</span> sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
            <span>//第二行输入待排序的数组，每个数用空格隔开</span>
            <span>Integer</span><span>[</span><span>]</span> arr <span>=</span> <span>new</span> <span>Integer</span><span>[</span>arrCount<span>]</span><span>;</span>
            <span>//录入 arrCount 个 数字，组成数组</span>
            <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span><span>;</span>i<span>&lt;</span>arrCount<span>;</span>i<span>++</span><span>)</span><span>{</span>
                arr<span>[</span>i<span>]</span> <span>=</span> sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
            <span>}</span>
            <span>//第三行输入一个整数0或1。0代表升序排序，1代表降序排序</span>
            <span>int</span> flagSort <span>=</span> sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
            
            <span>if</span><span>(</span>flagSort<span>==</span><span>0</span><span>)</span><span>{</span>
                <span>Arrays</span><span>.</span><span>sort</span><span>(</span>arr<span>,</span><span>new</span> <span>Comparator</span><span><span>&lt;</span><span>Integer</span><span>></span></span><span>(</span><span>)</span><span>{</span>
                    <span>public</span> <span>int</span> <span>compare</span><span>(</span><span>Integer</span> o1 <span>,</span><span>Integer</span> o2<span>)</span><span>{</span>
                        <span>return</span> o1<span>-</span>o2<span>;</span>
                    <span>}</span>
                <span>}</span><span>)</span><span>;</span>
            <span>}</span>
            <span>if</span><span>(</span>flagSort<span>==</span><span>1</span><span>)</span><span>{</span>
                <span>Arrays</span><span>.</span><span>sort</span><span>(</span>arr<span>,</span><span>new</span> <span>Comparator</span><span><span>&lt;</span><span>Integer</span><span>></span></span><span>(</span><span>)</span><span>{</span>
                    <span>public</span> <span>int</span> <span>compare</span><span>(</span><span>Integer</span> o1 <span>,</span><span>Integer</span> o2<span>)</span><span>{</span>
                        <span>return</span> o2<span>-</span>o1<span>;</span>
                    <span>}</span>
                <span>}</span><span>)</span><span>;</span>
            <span>}</span>
      
            <span>for</span><span>(</span><span>Integer</span> m <span>:</span> arr<span>)</span><span>{</span>
                <span>System</span><span>.</span>out<span>.</span><span>print</span><span>(</span>m <span>+</span> <span>" "</span><span>)</span><span>;</span>
            <span>}</span>
            <span>break</span><span>;</span>
        <span>}</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>)</span><span>;</span>
  
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ol start="2">
<li></li>
</ol>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>
<span>public</span> <span>class</span> <span>Main</span><span>{</span>
	<span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span><span>{</span>
		<span>Scanner</span> sc <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
		<span>while</span><span>(</span>sc<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span><span>{</span>
			<span>int</span> n <span>=</span> sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span><span>//接收数组长度</span>
			<span>int</span><span>[</span><span>]</span> arr <span>=</span> <span>new</span> <span>int</span><span>[</span>n<span>]</span><span>;</span><span>//创建数组</span>

			<span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> n<span>;</span> i<span>++</span><span>)</span> <span>{</span><span>//数组填入</span>
				arr<span>[</span>i<span>]</span> <span>=</span> sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
			<span>}</span>
			
			<span>int</span> flag <span>=</span> sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span><span>//接收排序标识</span>
			<span>Arrays</span><span>.</span><span>sort</span><span>(</span>arr<span>)</span><span>;</span><span>//数组排序</span>

			<span>if</span> <span>(</span>flag <span>==</span> <span>0</span><span>)</span> <span>{</span><span>//正序输出</span>
				<span>for</span><span>(</span><span>int</span> i <span>=</span><span>0</span><span>;</span> i <span>&lt;</span> arr<span>.</span>length<span>;</span> i<span>++</span><span>)</span><span>{</span>
					<span>System</span><span>.</span>out<span>.</span><span>print</span><span>(</span>arr<span>[</span>i<span>]</span> <span>+</span> <span>" "</span><span>)</span><span>;</span>
				<span>}</span> 
			<span>}</span>
			<span>else</span> <span>{</span><span>//逆序输出</span>
					<span>for</span><span>(</span><span>int</span> i <span>=</span> arr<span>.</span>length <span>-</span> <span>1</span><span>;</span> i <span>>=</span> <span>0</span><span>;</span> i<span>--</span><span>)</span><span>{</span>
						<span>System</span><span>.</span>out<span>.</span><span>print</span><span>(</span>arr<span>[</span>i<span>]</span> <span>+</span> <span>" "</span><span>)</span><span>;</span>
					<span>}</span>
			<span>}</span>
		<span>}</span>
	<span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="hj106-字符逆序" tabindex="-1"> <strong>HJ106</strong> <strong>字符逆序</strong></h2>
<h3 id="描述-17" tabindex="-1"> 描述</h3>
<p>将一个字符串str的内容颠倒过来，并输出。</p>
<p>数据范围：1 \le len(str) \le 10000\1≤<em>l<strong>e</strong>n</em>(<em>s<strong>t</strong>r</em>)≤10000</p>
<h3 id="输入描述-17" tabindex="-1"> 输入描述：</h3>
<p>输入一个字符串，可以有空格</p>
<h3 id="输出描述-17" tabindex="-1"> 输出描述：</h3>
<p>输出逆序的字符串</p>
<h3 id="示例1-17" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>I am a student
</code></pre><div aria-hidden="true"><div></div></div></div><p>输出：</p>
<div><pre><code>tneduts a ma I
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="示例2-6" tabindex="-1"> 示例2</h3>
<p>输入：</p>
<div><pre><code>nowcoder
</code></pre><div aria-hidden="true"><div></div></div></div><p>输出：</p>
<div><pre><code>redocwon
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="代码-9" tabindex="-1"> 代码：</h3>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span><span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span><span>{</span>
        <span>Scanner</span> scan <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>String</span> input <span>=</span> scan<span>.</span><span>nextLine</span><span>(</span><span>)</span><span>;</span>
        <span>StringBuilder</span> res <span>=</span> <span>new</span> <span>StringBuilder</span><span>(</span>input<span>)</span><span>;</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>res<span>.</span><span>reverse</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="hj108-求最小公倍数" tabindex="-1"> <strong>HJ108</strong> <strong>求最小公倍数</strong></h2>
<h3 id="描述-18" tabindex="-1"> 描述</h3>
<p>正整数A和正整数B 的最小公倍数是指 能被A和B整除的最小的正整数值，设计一个算法，求输入A和B的最小公倍数。</p>
<p>数据范围：1 \le a,b \le 100000 \1≤<em>a</em>,<em>b</em>≤100000</p>
<h3 id="输入描述-18" tabindex="-1"> 输入描述：</h3>
<p>输入两个正整数A和B。</p>
<h3 id="输出描述-18" tabindex="-1"> 输出描述：</h3>
<p>输出A和B的最小公倍数。</p>
<h3 id="示例1-18" tabindex="-1"> 示例1</h3>
<p>输入：</p>
<div><pre><code>5 7
</code></pre><div aria-hidden="true"><div></div></div></div><p>输出：</p>
<div><pre><code>35
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="示例2-7" tabindex="-1"> 示例2</h3>
<p>输入：</p>
<div><pre><code>2 4
</code></pre><div aria-hidden="true"><div></div></div></div><p>输出：</p>
<div><pre><code>4
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="代码-10" tabindex="-1"> 代码：</h3>
<p>a，b的最大公约数为gcd（a，b），最小公倍数的公式为：
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/right}{gcd(a%2Cb)}.svg" alt="图片说明" loading="lazy">
此题说是正数，所以绝对值无所谓了。我们可以发现题目带了‘递归’的标签，那么就用递归来实现gcd，既是面向题目编程，又方便了自己，一举两得。</p>
<p>gcd的算法是根据Euclidean algorithm来的，拿维基百科的例子来说：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/equation.svg" alt="图片说明" loading="lazy"></p>
<blockquote>
<p>计算<em>a</em> = 1071和<em>b</em> = 462的最大公约数的过程如下：从1071中不断减去462直到小于462（可以减2次，即商<em>q</em>0 = 2），余数是147：</p>
<p>1071 = 2 × 462 + 147.</p>
<p>然后从462中不断减去147直到小于147（可以减3次，即<em>q</em>1 = 3），余数是21：</p>
<p>462 = 3 × 147 + 21.</p>
<p>再从147中不断减去21直到小于21（可以减7次，即<em>q</em>2 = 7），没有余数：</p>
<p>147 = 7 × 21 + 0.</p>
<p>此时，余数是0，所以1071和462的<strong>最大公约数</strong>是21。</p>
</blockquote>
<div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>*</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span><span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span><span>{</span>
        <span>Scanner</span> sc <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span><span>(</span>sc<span>.</span><span>hasNextInt</span><span>(</span><span>)</span><span>)</span><span>{</span>
            <span>int</span> a <span>=</span> sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
            <span>int</span> b <span>=</span> sc<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
            <span>for</span><span>(</span><span>int</span> i <span>=</span> <span>Math</span><span>.</span><span>min</span><span>(</span>a<span>,</span>b<span>)</span><span>;</span> i <span>></span> <span>0</span><span>;</span> i<span>--</span><span>)</span><span>{</span>
                <span>if</span><span>(</span>a<span>%</span>i <span>==</span> <span>0</span> <span>&amp;&amp;</span> b<span>%</span>i <span>==</span> <span>0</span><span>)</span><span>{</span>
                    <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>a<span>*</span>b<span>/</span>i<span>)</span><span>;</span>
                    <span>break</span><span>;</span>
                <span>}</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><div><pre><code><span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Scanner</span></span><span>;</span>

<span>public</span> <span>class</span> <span>Main</span> <span>{</span>
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>Scanner</span> in <span>=</span> <span>new</span> <span>Scanner</span><span>(</span><span>System</span><span>.</span>in<span>)</span><span>;</span>
        <span>while</span> <span>(</span>in<span>.</span><span>hasNextInt</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>int</span> a <span>=</span> in<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
            <span>int</span> b <span>=</span> in<span>.</span><span>nextInt</span><span>(</span><span>)</span><span>;</span>
            <span>int</span> lcm <span>=</span> a<span>*</span>b <span>/</span> <span>gcd</span><span>(</span>a<span>,</span>b<span>)</span><span>;</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>lcm<span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>

    <span>public</span> <span>static</span> <span>int</span> <span>gcd</span><span>(</span><span>int</span> a<span>,</span> <span>int</span> b<span>)</span> <span>{</span>
            <span>if</span> <span>(</span>b<span>==</span><span>0</span><span>)</span> <span>return</span> a<span>;</span>
            <span>return</span> <span>gcd</span><span>(</span>b<span>,</span>a<span>%</span>b<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="algorithm" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-31T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Springboot利用ThreadPoolTaskExecutor多线程批量插入百万级数据</title>
    <id>https://blog.ciberviler.top/dev/Springboot%E5%88%A9%E7%94%A8ThreadPoolTaskExecutor%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5%E7%99%BE%E4%B8%87%E7%BA%A7%E6%95%B0%E6%8D%AE.html</id>
    <link href="https://blog.ciberviler.top/dev/Springboot%E5%88%A9%E7%94%A8ThreadPoolTaskExecutor%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5%E7%99%BE%E4%B8%87%E7%BA%A7%E6%95%B0%E6%8D%AE.html"/>
    <updated>2022-05-28T14:44:42.000Z</updated>
    <summary type="html">Springboot利用ThreadPoolTaskExecutor多线程批量插入百万级数据</summary>
    <content type="html"><![CDATA[<h1 id="springboot利用threadpooltaskexecutor多线程批量插入百万级数据" tabindex="-1"> Springboot利用ThreadPoolTaskExecutor多线程批量插入百万级数据</h1>
<h2 id="前言" tabindex="-1"> 前言</h2>
<p>开发目的：提高百万级数据插入效率。</p>
<p>采取方案：利用ThreadPoolTaskExecutor多线程批量插入。</p>
<p>采用技术：springboot2.1.1+mybatisPlus3.0.6+swagger2.5.0+Lombok1.18.4+postgresql+ThreadPoolTaskExecutor等。</p>
<h2 id="具体实现细节" tabindex="-1"> <strong>具体实现细节</strong></h2>
<h3 id="application-dev-properties添加线程池配置信息" tabindex="-1"> application-dev.properties添加线程池配置信息</h3>
<div><pre><code># 异步线程配置
# 配置核心线程数
async.executor.thread.core_pool_size = 30
# 配置最大线程数
async.executor.thread.max_pool_size = 30
# 配置队列大小
async.executor.thread.queue_capacity = 99988
# 配置线程池中的线程的名称前缀
async.executor.thread.name.prefix = async-importDB-
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="spring容器注入线程池bean对象" tabindex="-1"> spring容器注入线程池bean对象</h3>
<div><pre><code><span>@Configuration</span>
 
<span>@EnableAsync</span>
 
<span>@Slf4j</span>
 
<span>public</span> <span>class</span> <span>ExecutorConfig</span> <span>{</span>
    <span>@Value</span><span>(</span><span>"${async.executor.thread.core_pool_size}"</span><span>)</span>
    <span>private</span> <span>int</span> corePoolSize<span>;</span>
    <span>@Value</span><span>(</span><span>"${async.executor.thread.max_pool_size}"</span><span>)</span>
    <span>private</span> <span>int</span> maxPoolSize<span>;</span>
    <span>@Value</span><span>(</span><span>"${async.executor.thread.queue_capacity}"</span><span>)</span>
    <span>private</span> <span>int</span> queueCapacity<span>;</span>
    <span>@Value</span><span>(</span><span>"${async.executor.thread.name.prefix}"</span><span>)</span>
    <span>private</span> <span>String</span> namePrefix<span>;</span>
 
    <span>@Bean</span><span>(</span>name <span>=</span> <span>"asyncServiceExecutor"</span><span>)</span>
    <span>public</span> <span>Executor</span> <span>asyncServiceExecutor</span><span>(</span><span>)</span> <span>{</span>
        log<span>.</span><span>warn</span><span>(</span><span>"start asyncServiceExecutor"</span><span>)</span><span>;</span>
        <span>//在这里修改</span>
        <span>ThreadPoolTaskExecutor</span> executor <span>=</span> <span>new</span> <span>VisiableThreadPoolTaskExecutor</span><span>(</span><span>)</span><span>;</span>
        <span>//配置核心线程数</span>
        executor<span>.</span><span>setCorePoolSize</span><span>(</span>corePoolSize<span>)</span><span>;</span>
        <span>//配置最大线程数</span>
        executor<span>.</span><span>setMaxPoolSize</span><span>(</span>maxPoolSize<span>)</span><span>;</span>
        <span>//配置队列大小</span>
        executor<span>.</span><span>setQueueCapacity</span><span>(</span>queueCapacity<span>)</span><span>;</span>
        <span>//配置线程池中的线程的名称前缀</span>
        executor<span>.</span><span>setThreadNamePrefix</span><span>(</span>namePrefix<span>)</span><span>;</span>
        <span>// rejection-policy：当pool已经达到max size的时候，如何处理新任务</span>
        <span>// CALLER_RUNS：不在新线程中执行任务，而是有调用者所在的线程来执行</span>
        executor<span>.</span><span>setRejectedExecutionHandler</span><span>(</span><span>new</span> <span>ThreadPoolExecutor<span>.</span>CallerRunsPolicy</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>//执行初始化</span>
        executor<span>.</span><span>initialize</span><span>(</span><span>)</span><span>;</span>
        <span>return</span> executor<span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="创建异步线程-业务类" tabindex="-1"> 创建异步线程 业务类</h3>
<div><pre><code><span>@Service</span>
 
<span>@Slf4j</span>
 
<span>public</span> <span>class</span> <span>AsyncServiceImpl</span> <span>implements</span> <span>AsyncService</span> <span>{</span>
<span>@Override</span>
    <span>@Async</span><span>(</span><span>"asyncServiceExecutor"</span><span>)</span>
    <span>public</span> <span>void</span> <span>executeAsync</span><span>(</span><span>List</span><span><span>&lt;</span><span>LogOutputResult</span><span>></span></span> logOutputResults<span>,</span> <span>LogOutputResultMapper</span> logOutputResultMapper<span>,</span> <span>CountDownLatch</span> countDownLatch<span>)</span> <span>{</span>
        <span>try</span><span>{</span>
            log<span>.</span><span>warn</span><span>(</span><span>"start executeAsync"</span><span>)</span><span>;</span>
            <span>//异步线程要做的事情</span>
            logOutputResultMapper<span>.</span><span>addLogOutputResultBatch</span><span>(</span>logOutputResults<span>)</span><span>;</span>
            log<span>.</span><span>warn</span><span>(</span><span>"end executeAsync"</span><span>)</span><span>;</span>
        <span>}</span><span>finally</span> <span>{</span>
            countDownLatch<span>.</span><span>countDown</span><span>(</span><span>)</span><span>;</span><span>// 很关键, 无论上面程序是否异常必须执行countDown,否则await无法释放</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="创建多线程批量插入具体业务方法" tabindex="-1"> 创建多线程批量插入具体业务方法</h3>
<div><pre><code>@Override
    public int testMultiThread() {
        List<span><span><span>&lt;</span>LogOutputResult</span><span>></span></span> logOutputResults = getTestData();
        //测试每100条数据插入开一个线程
        List&lt;List<span><span><span>&lt;</span>LogOutputResult</span><span>></span></span>> lists = ConvertHandler.splitList(logOutputResults, 100);
        CountDownLatch countDownLatch = new CountDownLatch(lists.size());
        for (List<span><span><span>&lt;</span>LogOutputResult</span><span>></span></span> listSub:lists) {
            asyncService.executeAsync(listSub, logOutputResultMapper,countDownLatch);
        }
        try {
            countDownLatch.await(); //保证之前的所有的线程都执行完成，才会走下面的；
            // 这样就可以在下面拿到所有线程执行完的集合结果
        } catch (Exception e) {
            log.error("阻塞异常:"+e.getMessage());
        }
        return logOutputResults.size();
    }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="模拟2000003-条数据进行测试" tabindex="-1"> 模拟2000003 条数据进行测试</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20191225121702208.png" alt="img" loading="lazy"></p>
<p>多线程 测试 2000003 耗时如下：耗时1.67分钟</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2019122512171971.png" alt="img" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20191225121745132.png" alt="img" loading="lazy"></p>
<p>本次开启30个线程，截图如下：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20191225121812550.png" alt="img" loading="lazy"></p>
<p>单线程测试2000003 耗时如下：耗时5.75分钟</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20191225121832495.png" alt="img" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20191225121848593.png" alt="img" loading="lazy"></p>
<h3 id="检查多线程入库的数据-检查是否存在重复入库的问题" tabindex="-1"> 检查多线程入库的数据，检查是否存在重复入库的问题：</h3>
<p>根据id分组，查看是否有id重复的数据，通过sql语句检查，没有发现重复入库的问题</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2019122512191274.png" alt="img" loading="lazy"></p>
<p>检查数据完整性： 通过sql语句查询，多线程录入数据完整
<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20191225122051393.png" alt="img" loading="lazy"></p>
<h2 id="测试结果" tabindex="-1"> 测试结果</h2>
<p>不同线程数测试：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2019122512213611.png" alt="img" loading="lazy"></p>
<p><img src="https://img-blog.csdnimg.cn/20191225122203925.png" alt="img" loading="lazy"></p>
<h2 id="总结" tabindex="-1"> 总结</h2>
<p>通过以上测试案列，同样是导入2000003 条数据，多线程耗时1.67分钟，单线程耗时5.75分钟。通过对不同线程数的测试，发现不是线程数越多越好，具体多少合适，网上有一个不成文的算法：</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-10T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">使用CloudFlareWorkers反代网站</title>
    <id>https://blog.ciberviler.top/script/%E4%BD%BF%E7%94%A8CloudFlareWorkers%E5%8F%8D%E4%BB%A3%E7%BD%91%E7%AB%99.html</id>
    <link href="https://blog.ciberviler.top/script/%E4%BD%BF%E7%94%A8CloudFlareWorkers%E5%8F%8D%E4%BB%A3%E7%BD%91%E7%AB%99.html"/>
    <updated>2022-05-27T11:24:46.000Z</updated>
    <content type="html"><![CDATA[<h1 id="使用cloudflareworkers反代网站" tabindex="-1"> 使用CloudFlareWorkers反代网站</h1>
<p>给出三种反代源码。</p>
<h2 id="镜像整个网站" tabindex="-1"> 镜像整个网站</h2>
<div><pre><code><span>// 替换成你想镜像的站点</span>
<span>const</span> upstream <span>=</span> <span>'www.google.com'</span>
 
<span>// 如果那个站点有专门的移动适配站点，否则保持和上面一致</span>
<span>const</span> upstream_mobile <span>=</span> <span>'www.google.com'</span>
 
<span>// 你希望禁止哪些国家访问</span>
<span>const</span> blocked_region <span>=</span> <span>[</span><span>'RU'</span><span>]</span>
 
<span>// 禁止自访问</span>
<span>const</span> blocked_ip_address <span>=</span> <span>[</span><span>'0.0.0.0'</span><span>,</span> <span>'127.0.0.1'</span><span>]</span>
 
<span>// 替换成你想镜像的站点</span>
<span>const</span> replace_dict <span>=</span> <span>{</span>
    <span>'$upstream'</span><span>:</span> <span>'$custom_domain'</span><span>,</span>
    <span>'//www.google.com'</span><span>:</span> <span>''</span>
<span>}</span>
 
<span>//以下内容都不用动</span>
<span>addEventListener</span><span>(</span><span>'fetch'</span><span>,</span> <span>event</span> <span>=></span> <span>{</span>
    event<span>.</span><span>respondWith</span><span>(</span><span>fetchAndApply</span><span>(</span>event<span>.</span>request<span>)</span><span>)</span><span>;</span>
<span>}</span><span>)</span>
 
<span>async</span> <span>function</span> <span>fetchAndApply</span><span>(</span><span>request</span><span>)</span> <span>{</span>
 
    <span>const</span> region <span>=</span> request<span>.</span>headers<span>.</span><span>get</span><span>(</span><span>'cf-ipcountry'</span><span>)</span><span>.</span><span>toUpperCase</span><span>(</span><span>)</span><span>;</span>
    <span>const</span> ip_address <span>=</span> request<span>.</span>headers<span>.</span><span>get</span><span>(</span><span>'cf-connecting-ip'</span><span>)</span><span>;</span>
    <span>const</span> user_agent <span>=</span> request<span>.</span>headers<span>.</span><span>get</span><span>(</span><span>'user-agent'</span><span>)</span><span>;</span>
 
    <span>let</span> response <span>=</span> <span>null</span><span>;</span>
    <span>let</span> url <span>=</span> <span>new</span> <span>URL</span><span>(</span>request<span>.</span>url<span>)</span><span>;</span>
    <span>let</span> url_host <span>=</span> url<span>.</span>host<span>;</span>
 
    <span>if</span> <span>(</span>url<span>.</span>protocol <span>==</span> <span>'http:'</span><span>)</span> <span>{</span>
        url<span>.</span>protocol <span>=</span> <span>'https:'</span>
        response <span>=</span> Response<span>.</span><span>redirect</span><span>(</span>url<span>.</span>href<span>)</span><span>;</span>
        <span>return</span> response<span>;</span>
    <span>}</span>
 
    <span>if</span> <span>(</span><span>await</span> <span>device_status</span><span>(</span>user_agent<span>)</span><span>)</span> <span>{</span>
        upstream_domain <span>=</span> upstream
    <span>}</span> <span>else</span> <span>{</span>
        upstream_domain <span>=</span> upstream_mobile
    <span>}</span>
 
    url<span>.</span>host <span>=</span> upstream_domain<span>;</span>
 
    <span>if</span> <span>(</span>blocked_region<span>.</span><span>includes</span><span>(</span>region<span>)</span><span>)</span> <span>{</span>
        response <span>=</span> <span>new</span> <span>Response</span><span>(</span><span>'Access denied: WorkersProxy is not available in your region yet.'</span><span>,</span> <span>{</span>
            <span>status</span><span>:</span> <span>403</span>
        <span>}</span><span>)</span><span>;</span>
    <span>}</span> <span>else</span> <span>if</span><span>(</span>blocked_ip_address<span>.</span><span>includes</span><span>(</span>ip_address<span>)</span><span>)</span><span>{</span>
        response <span>=</span> <span>new</span> <span>Response</span><span>(</span><span>'Access denied: Your IP address is blocked by WorkersProxy.'</span><span>,</span> <span>{</span>
            <span>status</span><span>:</span> <span>403</span>
        <span>}</span><span>)</span><span>;</span>
    <span>}</span> <span>else</span><span>{</span>
        <span>let</span> method <span>=</span> request<span>.</span>method<span>;</span>
        <span>let</span> request_headers <span>=</span> request<span>.</span>headers<span>;</span>
        <span>let</span> new_request_headers <span>=</span> <span>new</span> <span>Headers</span><span>(</span>request_headers<span>)</span><span>;</span>
 
        new_request_headers<span>.</span><span>set</span><span>(</span><span>'Host'</span><span>,</span> upstream_domain<span>)</span><span>;</span>
        new_request_headers<span>.</span><span>set</span><span>(</span><span>'Referer'</span><span>,</span> url<span>.</span>href<span>)</span><span>;</span>
 
        <span>let</span> original_response <span>=</span> <span>await</span> <span>fetch</span><span>(</span>url<span>.</span>href<span>,</span> <span>{</span>
            <span>method</span><span>:</span> method<span>,</span>
            <span>headers</span><span>:</span> new_request_headers
        <span>}</span><span>)</span>
 
        <span>let</span> original_response_clone <span>=</span> original_response<span>.</span><span>clone</span><span>(</span><span>)</span><span>;</span>
        <span>let</span> original_text <span>=</span> <span>null</span><span>;</span>
        <span>let</span> response_headers <span>=</span> original_response<span>.</span>headers<span>;</span>
        <span>let</span> new_response_headers <span>=</span> <span>new</span> <span>Headers</span><span>(</span>response_headers<span>)</span><span>;</span>
        <span>let</span> status <span>=</span> original_response<span>.</span>status<span>;</span>
 
        new_response_headers<span>.</span><span>set</span><span>(</span><span>'access-control-allow-origin'</span><span>,</span> <span>'*'</span><span>)</span><span>;</span>
        new_response_headers<span>.</span><span>set</span><span>(</span><span>'access-control-allow-credentials'</span><span>,</span> <span>true</span><span>)</span><span>;</span>
        new_response_headers<span>.</span><span>delete</span><span>(</span><span>'content-security-policy'</span><span>)</span><span>;</span>
        new_response_headers<span>.</span><span>delete</span><span>(</span><span>'content-security-policy-report-only'</span><span>)</span><span>;</span>
        new_response_headers<span>.</span><span>delete</span><span>(</span><span>'clear-site-data'</span><span>)</span><span>;</span>
 
        <span>const</span> content_type <span>=</span> new_response_headers<span>.</span><span>get</span><span>(</span><span>'content-type'</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span>content_type<span>.</span><span>includes</span><span>(</span><span>'text/html'</span><span>)</span> <span>&amp;&amp;</span> content_type<span>.</span><span>includes</span><span>(</span><span>'UTF-8'</span><span>)</span><span>)</span> <span>{</span>
            original_text <span>=</span> <span>await</span> <span>replace_response_text</span><span>(</span>original_response_clone<span>,</span> upstream_domain<span>,</span> url_host<span>)</span><span>;</span>
        <span>}</span> <span>else</span> <span>{</span>
            original_text <span>=</span> original_response_clone<span>.</span>body
        <span>}</span>
 
        response <span>=</span> <span>new</span> <span>Response</span><span>(</span>original_text<span>,</span> <span>{</span>
            status<span>,</span>
            <span>headers</span><span>:</span> new_response_headers
        <span>}</span><span>)</span>
    <span>}</span>
    <span>return</span> response<span>;</span>
<span>}</span>
 
<span>async</span> <span>function</span> <span>replace_response_text</span><span>(</span><span>response<span>,</span> upstream_domain<span>,</span> host_name</span><span>)</span> <span>{</span>
    <span>let</span> text <span>=</span> <span>await</span> response<span>.</span><span>text</span><span>(</span><span>)</span>
 
    <span>var</span> i<span>,</span> j<span>;</span>
    <span>for</span> <span>(</span>i <span>in</span> replace_dict<span>)</span> <span>{</span>
        j <span>=</span> replace_dict<span>[</span>i<span>]</span>
        <span>if</span> <span>(</span>i <span>==</span> <span>'$upstream'</span><span>)</span> <span>{</span>
            i <span>=</span> upstream_domain
        <span>}</span> <span>else</span> <span>if</span> <span>(</span>i <span>==</span> <span>'$custom_domain'</span><span>)</span> <span>{</span>
            i <span>=</span> host_name
        <span>}</span>
 
        <span>if</span> <span>(</span>j <span>==</span> <span>'$upstream'</span><span>)</span> <span>{</span>
            j <span>=</span> upstream_domain
        <span>}</span> <span>else</span> <span>if</span> <span>(</span>j <span>==</span> <span>'$custom_domain'</span><span>)</span> <span>{</span>
            j <span>=</span> host_name
        <span>}</span>
 
        <span>let</span> re <span>=</span> <span>new</span> <span>RegExp</span><span>(</span>i<span>,</span> <span>'g'</span><span>)</span>
        text <span>=</span> text<span>.</span><span>replace</span><span>(</span>re<span>,</span> j<span>)</span><span>;</span>
    <span>}</span>
    <span>return</span> text<span>;</span>
<span>}</span>
 
<span>async</span> <span>function</span> <span>device_status</span> <span>(</span><span>user_agent_info</span><span>)</span> <span>{</span>
    <span>var</span> agents <span>=</span> <span>[</span><span>"Android"</span><span>,</span> <span>"iPhone"</span><span>,</span> <span>"SymbianOS"</span><span>,</span> <span>"Windows Phone"</span><span>,</span> <span>"iPad"</span><span>,</span> <span>"iPod"</span><span>]</span><span>;</span>
    <span>var</span> flag <span>=</span> <span>true</span><span>;</span>
    <span>for</span> <span>(</span><span>var</span> v <span>=</span> <span>0</span><span>;</span> v <span>&lt;</span> agents<span>.</span>length<span>;</span> v<span>++</span><span>)</span> <span>{</span> <span>if</span> <span>(</span>user_agent_info<span>.</span><span>indexOf</span><span>(</span>agents<span>[</span>v<span>]</span><span>)</span> <span>></span> <span>0</span><span>)</span> <span>{</span>
            flag <span>=</span> <span>false</span><span>;</span>
            <span>break</span><span>;</span>
        <span>}</span>
    <span>}</span>
    <span>return</span> flag<span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="镜像网站带密码访问" tabindex="-1"> 镜像网站带密码访问</h2>
<div><pre><code><span>// 替换成你想镜像的站点</span>
<span>const</span> upstream <span>=</span> <span>'google.com'</span>
 
<span>// 如果那个站点有专门的移动适配站点，否则保持和上面一致</span>
<span>const</span> upstream_mobile <span>=</span> <span>'m.google.com'</span>
 
<span>// 密码访问</span>
 
<span>const</span> openAuth <span>=</span> <span>false</span>
<span>const</span> username <span>=</span> <span>'username'</span>
<span>const</span> password <span>=</span> <span>'password'</span>
 
<span>// 你希望禁止哪些国家访问</span>
<span>const</span> blocked_region <span>=</span> <span>[</span><span>'RU'</span><span>]</span>
 
<span>// 禁止自访问</span>
<span>const</span> blocked_ip_address <span>=</span> <span>[</span><span>'0.0.0.0'</span><span>,</span> <span>'127.0.0.1'</span><span>]</span>
 
<span>// 替换成你想镜像的站点</span>
<span>const</span> replace_dict <span>=</span> <span>{</span>
    <span>'$upstream'</span><span>:</span> <span>'$custom_domain'</span><span>,</span>
    <span>'//google.com'</span><span>:</span> <span>''</span>
<span>}</span>
 
<span>function</span> <span>unauthorized</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>new</span> <span>Response</span><span>(</span><span>'Unauthorized'</span><span>,</span> <span>{</span>
    <span>headers</span><span>:</span> <span>{</span>
      <span>'WWW-Authenticate'</span><span>:</span> <span>'Basic realm="goindex"'</span><span>,</span>
      <span>'Access-Control-Allow-Origin'</span><span>:</span> <span>'*'</span>
    <span>}</span><span>,</span>
    <span>status</span><span>:</span> <span>401</span>
  <span>}</span><span>)</span><span>;</span>
<span>}</span>
 
<span>function</span> <span>parseBasicAuth</span><span>(</span><span>auth</span><span>)</span> <span>{</span>
    <span>try</span> <span>{</span>
      <span>return</span> <span>atob</span><span>(</span>auth<span>.</span><span>split</span><span>(</span><span>' '</span><span>)</span><span>.</span><span>pop</span><span>(</span><span>)</span><span>)</span><span>.</span><span>split</span><span>(</span><span>':'</span><span>)</span><span>;</span>
    <span>}</span> <span>catch</span> <span>(</span>e<span>)</span> <span>{</span>
      <span>return</span> <span>[</span><span>]</span><span>;</span>
    <span>}</span>
<span>}</span>
 
<span>function</span> <span>doBasicAuth</span><span>(</span><span>request</span><span>)</span> <span>{</span>
  <span>const</span> auth <span>=</span> request<span>.</span>headers<span>.</span><span>get</span><span>(</span><span>'Authorization'</span><span>)</span><span>;</span>
 
  <span>if</span> <span>(</span><span>!</span>auth <span>||</span> <span>!</span><span><span>/</span><span>^Basic [A-Za-z0-9._~+/-]+=*$</span><span>/</span><span>i</span></span><span>.</span><span>test</span><span>(</span>auth<span>)</span><span>)</span> <span>{</span>
    <span>return</span> <span>false</span><span>;</span>
  <span>}</span>
 
  <span>const</span> <span>[</span>user<span>,</span> pass<span>]</span> <span>=</span> <span>parseBasicAuth</span><span>(</span>auth<span>)</span><span>;</span>
  <span>return</span> user <span>===</span> username <span>&amp;&amp;</span> pass <span>===</span> password<span>;</span>
<span>}</span>
 
 
<span>async</span> <span>function</span> <span>fetchAndApply</span><span>(</span><span>request</span><span>)</span> <span>{</span>
  <span>if</span> <span>(</span>request<span>.</span>method <span>===</span> <span>'OPTIONS'</span><span>)</span> <span>// allow preflight request</span>
    <span>return</span> <span>new</span> <span>Response</span><span>(</span><span>''</span><span>,</span> <span>{</span>
      <span>status</span><span>:</span> <span>200</span><span>,</span>
      <span>headers</span><span>:</span> <span>{</span>
        <span>'Access-Control-Allow-Origin'</span><span>:</span> <span>'*'</span><span>,</span>
        <span>'Access-Control-Allow-Headers'</span><span>:</span> <span>'*'</span><span>,</span>
        <span>'Access-Control-Allow-Methods'</span><span>:</span> <span>'GET, POST, PUT, HEAD, OPTIONS'</span>
      <span>}</span>
    <span>}</span><span>)</span><span>;</span>
 
  <span>if</span> <span>(</span>openAuth <span>&amp;&amp;</span> <span>!</span><span>doBasicAuth</span><span>(</span>request<span>)</span><span>)</span> <span>{</span>
    <span>return</span> <span>unauthorized</span><span>(</span><span>)</span><span>;</span>
  <span>}</span>
    <span>const</span> region <span>=</span> request<span>.</span>headers<span>.</span><span>get</span><span>(</span><span>'cf-ipcountry'</span><span>)</span><span>.</span><span>toUpperCase</span><span>(</span><span>)</span><span>;</span>
    <span>const</span> ip_address <span>=</span> request<span>.</span>headers<span>.</span><span>get</span><span>(</span><span>'cf-connecting-ip'</span><span>)</span><span>;</span>
    <span>const</span> user_agent <span>=</span> request<span>.</span>headers<span>.</span><span>get</span><span>(</span><span>'user-agent'</span><span>)</span><span>;</span>
 
    <span>let</span> response <span>=</span> <span>null</span><span>;</span>
    <span>let</span> url <span>=</span> <span>new</span> <span>URL</span><span>(</span>request<span>.</span>url<span>)</span><span>;</span>
    <span>let</span> url_host <span>=</span> url<span>.</span>host<span>;</span>
 
    <span>if</span> <span>(</span>url<span>.</span>protocol <span>==</span> <span>'http:'</span><span>)</span> <span>{</span>
        url<span>.</span>protocol <span>=</span> <span>'https:'</span>
        response <span>=</span> Response<span>.</span><span>redirect</span><span>(</span>url<span>.</span>href<span>)</span><span>;</span>
        <span>return</span> response<span>;</span>
    <span>}</span>
 
    <span>if</span> <span>(</span><span>await</span> <span>device_status</span><span>(</span>user_agent<span>)</span><span>)</span> <span>{</span>
        upstream_domain <span>=</span> upstream
    <span>}</span> <span>else</span> <span>{</span>
        upstream_domain <span>=</span> upstream_mobile
    <span>}</span>
 
    url<span>.</span>host <span>=</span> upstream_domain<span>;</span>
 
    <span>if</span> <span>(</span>blocked_region<span>.</span><span>includes</span><span>(</span>region<span>)</span><span>)</span> <span>{</span>
        response <span>=</span> <span>new</span> <span>Response</span><span>(</span><span>'Access denied: WorkersProxy is not available in your region yet.'</span><span>,</span> <span>{</span>
            <span>status</span><span>:</span> <span>403</span>
        <span>}</span><span>)</span><span>;</span>
    <span>}</span> <span>else</span> <span>if</span><span>(</span>blocked_ip_address<span>.</span><span>includes</span><span>(</span>ip_address<span>)</span><span>)</span><span>{</span>
        response <span>=</span> <span>new</span> <span>Response</span><span>(</span><span>'Access denied: Your IP address is blocked by WorkersProxy.'</span><span>,</span> <span>{</span>
            <span>status</span><span>:</span> <span>403</span>
        <span>}</span><span>)</span><span>;</span>
    <span>}</span> <span>else</span><span>{</span>
        <span>let</span> method <span>=</span> request<span>.</span>method<span>;</span>
        <span>let</span> request_headers <span>=</span> request<span>.</span>headers<span>;</span>
        <span>let</span> new_request_headers <span>=</span> <span>new</span> <span>Headers</span><span>(</span>request_headers<span>)</span><span>;</span>
 
        new_request_headers<span>.</span><span>set</span><span>(</span><span>'Host'</span><span>,</span> upstream_domain<span>)</span><span>;</span>
        new_request_headers<span>.</span><span>set</span><span>(</span><span>'Referer'</span><span>,</span> url<span>.</span>href<span>)</span><span>;</span>
 
        <span>let</span> original_response <span>=</span> <span>await</span> <span>fetch</span><span>(</span>url<span>.</span>href<span>,</span> <span>{</span>
            <span>method</span><span>:</span> method<span>,</span>
            <span>headers</span><span>:</span> new_request_headers
        <span>}</span><span>)</span>
 
        <span>let</span> original_response_clone <span>=</span> original_response<span>.</span><span>clone</span><span>(</span><span>)</span><span>;</span>
        <span>let</span> original_text <span>=</span> <span>null</span><span>;</span>
        <span>let</span> response_headers <span>=</span> original_response<span>.</span>headers<span>;</span>
        <span>let</span> new_response_headers <span>=</span> <span>new</span> <span>Headers</span><span>(</span>response_headers<span>)</span><span>;</span>
        <span>let</span> status <span>=</span> original_response<span>.</span>status<span>;</span>
 
        new_response_headers<span>.</span><span>set</span><span>(</span><span>'access-control-allow-origin'</span><span>,</span> <span>'*'</span><span>)</span><span>;</span>
        new_response_headers<span>.</span><span>set</span><span>(</span><span>'access-control-allow-credentials'</span><span>,</span> <span>true</span><span>)</span><span>;</span>
        new_response_headers<span>.</span><span>delete</span><span>(</span><span>'content-security-policy'</span><span>)</span><span>;</span>
        new_response_headers<span>.</span><span>delete</span><span>(</span><span>'content-security-policy-report-only'</span><span>)</span><span>;</span>
        new_response_headers<span>.</span><span>delete</span><span>(</span><span>'clear-site-data'</span><span>)</span><span>;</span>
 
        <span>const</span> content_type <span>=</span> new_response_headers<span>.</span><span>get</span><span>(</span><span>'content-type'</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span>content_type<span>.</span><span>includes</span><span>(</span><span>'text/html'</span><span>)</span> <span>&amp;&amp;</span> content_type<span>.</span><span>includes</span><span>(</span><span>'UTF-8'</span><span>)</span><span>)</span> <span>{</span>
            original_text <span>=</span> <span>await</span> <span>replace_response_text</span><span>(</span>original_response_clone<span>,</span> upstream_domain<span>,</span> url_host<span>)</span><span>;</span>
        <span>}</span> <span>else</span> <span>{</span>
            original_text <span>=</span> original_response_clone<span>.</span>body
        <span>}</span>
 
        response <span>=</span> <span>new</span> <span>Response</span><span>(</span>original_text<span>,</span> <span>{</span>
            status<span>,</span>
            <span>headers</span><span>:</span> new_response_headers
        <span>}</span><span>)</span>
    <span>}</span>
    <span>return</span> response<span>;</span>
<span>}</span>
 
<span>addEventListener</span><span>(</span><span>'fetch'</span><span>,</span> <span>event</span> <span>=></span> <span>{</span>
    event<span>.</span><span>respondWith</span><span>(</span><span>fetchAndApply</span><span>(</span>event<span>.</span>request<span>)</span><span>.</span><span>catch</span><span>(</span><span>err</span> <span>=></span> <span>{</span>
      console<span>.</span><span>error</span><span>(</span>err<span>)</span><span>;</span>
      <span>new</span> <span>Response</span><span>(</span><span>JSON</span><span>.</span><span>stringify</span><span>(</span>err<span>.</span>stack<span>)</span><span>,</span> <span>{</span>
        <span>status</span><span>:</span> <span>500</span><span>,</span>
        <span>headers</span><span>:</span> <span>{</span>
          <span>'Content-Type'</span><span>:</span> <span>'application/json'</span>
        <span>}</span>
      <span>}</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>)</span><span>;</span>
<span>}</span><span>)</span>
 
 
<span>async</span> <span>function</span> <span>replace_response_text</span><span>(</span><span>response<span>,</span> upstream_domain<span>,</span> host_name</span><span>)</span> <span>{</span>
    <span>let</span> text <span>=</span> <span>await</span> response<span>.</span><span>text</span><span>(</span><span>)</span>
 
    <span>var</span> i<span>,</span> j<span>;</span>
    <span>for</span> <span>(</span>i <span>in</span> replace_dict<span>)</span> <span>{</span>
        j <span>=</span> replace_dict<span>[</span>i<span>]</span>
        <span>if</span> <span>(</span>i <span>==</span> <span>'$upstream'</span><span>)</span> <span>{</span>
            i <span>=</span> upstream_domain
        <span>}</span> <span>else</span> <span>if</span> <span>(</span>i <span>==</span> <span>'$custom_domain'</span><span>)</span> <span>{</span>
            i <span>=</span> host_name
        <span>}</span>
 
        <span>if</span> <span>(</span>j <span>==</span> <span>'$upstream'</span><span>)</span> <span>{</span>
            j <span>=</span> upstream_domain
        <span>}</span> <span>else</span> <span>if</span> <span>(</span>j <span>==</span> <span>'$custom_domain'</span><span>)</span> <span>{</span>
            j <span>=</span> host_name
        <span>}</span>
 
        <span>let</span> re <span>=</span> <span>new</span> <span>RegExp</span><span>(</span>i<span>,</span> <span>'g'</span><span>)</span>
        text <span>=</span> text<span>.</span><span>replace</span><span>(</span>re<span>,</span> j<span>)</span><span>;</span>
    <span>}</span>
    <span>return</span> text<span>;</span>
<span>}</span>
 
<span>async</span> <span>function</span> <span>device_status</span> <span>(</span><span>user_agent_info</span><span>)</span> <span>{</span>
    <span>var</span> agents <span>=</span> <span>[</span><span>"Android"</span><span>,</span> <span>"iPhone"</span><span>,</span> <span>"SymbianOS"</span><span>,</span> <span>"Windows Phone"</span><span>,</span> <span>"iPad"</span><span>,</span> <span>"iPod"</span><span>]</span><span>;</span>
    <span>var</span> flag <span>=</span> <span>true</span><span>;</span>
    <span>for</span> <span>(</span><span>var</span> v <span>=</span> <span>0</span><span>;</span> v <span>&lt;</span> agents<span>.</span>length<span>;</span> v<span>++</span><span>)</span> <span>{</span> <span>if</span> <span>(</span>user_agent_info<span>.</span><span>indexOf</span><span>(</span>agents<span>[</span>v<span>]</span><span>)</span> <span>></span> <span>0</span><span>)</span> <span>{</span>
            flag <span>=</span> <span>false</span><span>;</span>
            <span>break</span><span>;</span>
        <span>}</span>
    <span>}</span>
    <span>return</span> flag<span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="镜像网站指定目录" tabindex="-1"> 镜像网站指定目录</h2>
<div><pre><code><span>// 你要镜像的网站.</span>
<span>const</span> upstream <span>=</span> <span>'objectstorage.ap-seoul-1.oraclecloud.com'</span>
 
<span>// 镜像网站的目录，比如你想镜像某个网站的二级目录则填写二级目录的目录名，镜像 google 用不到，默认即可.</span>
<span>const</span> upstream_path <span>=</span> <span>'/test/'</span>
 
<span>// 镜像站是否有手机访问专用网址，没有则填一样的.</span>
<span>const</span> upstream_mobile <span>=</span> <span>'objectstorage.ap-seoul-1.oraclecloud.com'</span>
 
<span>// 屏蔽国家和地区.</span>
<span>const</span> blocked_region <span>=</span> <span>[</span><span>''</span><span>]</span>
 
<span>// 屏蔽 IP 地址.</span>
<span>const</span> blocked_ip_address <span>=</span> <span>[</span><span>'0.0.0.0'</span><span>,</span> <span>'127.0.0.1'</span><span>]</span>
 
<span>// 镜像站是否开启 HTTPS.</span>
<span>const</span> https <span>=</span> <span>true</span>
 
<span>// 文本替换.填你要镜像的网站</span>
<span>const</span> replace_dict <span>=</span> <span>{</span>
    <span>'$upstream'</span><span>:</span> <span>'$custom_domain'</span><span>,</span>
    <span>'//objectstorage.ap-seoul-1.oraclecloud.com'</span><span>:</span> <span>''</span>
<span>}</span>
 
<span>// 以下保持默认，不要动</span>
<span>addEventListener</span><span>(</span><span>'fetch'</span><span>,</span> <span>event</span> <span>=></span> <span>{</span>
    event<span>.</span><span>respondWith</span><span>(</span><span>fetchAndApply</span><span>(</span>event<span>.</span>request<span>)</span><span>)</span><span>;</span>
<span>}</span><span>)</span>
 
<span>async</span> <span>function</span> <span>fetchAndApply</span><span>(</span><span>request</span><span>)</span> <span>{</span>
 
    <span>const</span> region <span>=</span> request<span>.</span>headers<span>.</span><span>get</span><span>(</span><span>'cf-ipcountry'</span><span>)</span><span>.</span><span>toUpperCase</span><span>(</span><span>)</span><span>;</span>
    <span>const</span> ip_address <span>=</span> request<span>.</span>headers<span>.</span><span>get</span><span>(</span><span>'cf-connecting-ip'</span><span>)</span><span>;</span>
    <span>const</span> user_agent <span>=</span> <span>"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36"</span>
 
    <span>let</span> response <span>=</span> <span>null</span><span>;</span>
    <span>let</span> url <span>=</span> <span>new</span> <span>URL</span><span>(</span>request<span>.</span>url<span>)</span><span>;</span>
    <span>let</span> url_hostname <span>=</span> url<span>.</span>hostname<span>;</span>
 
    <span>if</span> <span>(</span>https <span>==</span> <span>true</span><span>)</span> <span>{</span>
        url<span>.</span>protocol <span>=</span> <span>'https:'</span><span>;</span>
    <span>}</span> <span>else</span> <span>{</span>
        url<span>.</span>protocol <span>=</span> <span>'http:'</span><span>;</span>
    <span>}</span>
 
    <span>if</span> <span>(</span><span>await</span> <span>device_status</span><span>(</span>user_agent<span>)</span><span>)</span> <span>{</span>
        <span>var</span> upstream_domain <span>=</span> upstream<span>;</span>
    <span>}</span> <span>else</span> <span>{</span>
        <span>var</span> upstream_domain <span>=</span> upstream_mobile<span>;</span>
    <span>}</span>
 
    url<span>.</span>host <span>=</span> upstream_domain<span>;</span>
    <span>if</span> <span>(</span>url<span>.</span>pathname <span>==</span> <span>'/'</span><span>)</span> <span>{</span>
        url<span>.</span>pathname <span>=</span> upstream_path<span>;</span>
    <span>}</span> <span>else</span> <span>{</span>
        url<span>.</span>pathname <span>=</span> upstream_path <span>+</span> url<span>.</span>pathname<span>;</span>
    <span>}</span>
 
    <span>if</span> <span>(</span>blocked_region<span>.</span><span>includes</span><span>(</span>region<span>)</span><span>)</span> <span>{</span>
        response <span>=</span> <span>new</span> <span>Response</span><span>(</span><span>'Access denied: WorkersProxy is not available in your region yet.'</span><span>,</span> <span>{</span>
            <span>status</span><span>:</span> <span>403</span>
        <span>}</span><span>)</span><span>;</span>
    <span>}</span> <span>else</span> <span>if</span> <span>(</span>blocked_ip_address<span>.</span><span>includes</span><span>(</span>ip_address<span>)</span><span>)</span> <span>{</span>
        response <span>=</span> <span>new</span> <span>Response</span><span>(</span><span>'Access denied: Your IP address is blocked by WorkersProxy.'</span><span>,</span> <span>{</span>
            <span>status</span><span>:</span> <span>403</span>
        <span>}</span><span>)</span><span>;</span>
    <span>}</span> <span>else</span> <span>{</span>
        <span>let</span> method <span>=</span> request<span>.</span>method<span>;</span>
        <span>let</span> request_headers <span>=</span> request<span>.</span>headers<span>;</span>
        <span>let</span> new_request_headers <span>=</span> <span>new</span> <span>Headers</span><span>(</span>request_headers<span>)</span><span>;</span>
 
        new_request_headers<span>.</span><span>set</span><span>(</span><span>'Host'</span><span>,</span> url<span>.</span>hostname<span>)</span><span>;</span>
        new_request_headers<span>.</span><span>set</span><span>(</span><span>'Referer'</span><span>,</span> url<span>.</span>hostname<span>)</span><span>;</span>
 
        <span>let</span> original_response <span>=</span> <span>await</span> <span>fetch</span><span>(</span>url<span>.</span>href<span>,</span> <span>{</span>
            <span>method</span><span>:</span> method<span>,</span>
            <span>headers</span><span>:</span> new_request_headers
        <span>}</span><span>)</span>
 
        <span>let</span> original_response_clone <span>=</span> original_response<span>.</span><span>clone</span><span>(</span><span>)</span><span>;</span>
        <span>let</span> original_text <span>=</span> <span>null</span><span>;</span>
        <span>let</span> response_headers <span>=</span> original_response<span>.</span>headers<span>;</span>
        <span>let</span> new_response_headers <span>=</span> <span>new</span> <span>Headers</span><span>(</span>response_headers<span>)</span><span>;</span>
        <span>let</span> status <span>=</span> original_response<span>.</span>status<span>;</span>
 
        new_response_headers<span>.</span><span>set</span><span>(</span><span>'access-control-allow-origin'</span><span>,</span> <span>'*'</span><span>)</span><span>;</span>
        new_response_headers<span>.</span><span>set</span><span>(</span><span>'access-control-allow-credentials'</span><span>,</span> <span>true</span><span>)</span><span>;</span>
        new_response_headers<span>.</span><span>delete</span><span>(</span><span>'content-security-policy'</span><span>)</span><span>;</span>
        new_response_headers<span>.</span><span>delete</span><span>(</span><span>'content-security-policy-report-only'</span><span>)</span><span>;</span>
        new_response_headers<span>.</span><span>delete</span><span>(</span><span>'clear-site-data'</span><span>)</span><span>;</span>
 
        <span>const</span> content_type <span>=</span> new_response_headers<span>.</span><span>get</span><span>(</span><span>'content-type'</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span>content_type<span>.</span><span>includes</span><span>(</span><span>'text/html'</span><span>)</span> <span>&amp;&amp;</span> content_type<span>.</span><span>includes</span><span>(</span><span>'UTF-8'</span><span>)</span><span>)</span> <span>{</span>
            original_text <span>=</span> <span>await</span> <span>replace_response_text</span><span>(</span>original_response_clone<span>,</span> upstream_domain<span>,</span> url_hostname<span>)</span><span>;</span>
        <span>}</span> <span>else</span> <span>{</span>
            original_text <span>=</span> original_response_clone<span>.</span>body
        <span>}</span>
 
        response <span>=</span> <span>new</span> <span>Response</span><span>(</span>original_text<span>,</span> <span>{</span>
            status<span>,</span>
            <span>headers</span><span>:</span> new_response_headers
        <span>}</span><span>)</span>
    <span>}</span>
    <span>return</span> response<span>;</span>
<span>}</span>
 
<span>async</span> <span>function</span> <span>replace_response_text</span><span>(</span><span>response<span>,</span> upstream_domain<span>,</span> host_name</span><span>)</span> <span>{</span>
    <span>let</span> text <span>=</span> <span>await</span> response<span>.</span><span>text</span><span>(</span><span>)</span>
 
    <span>var</span> i<span>,</span> j<span>;</span>
    <span>for</span> <span>(</span>i <span>in</span> replace_dict<span>)</span> <span>{</span>
        j <span>=</span> replace_dict<span>[</span>i<span>]</span>
        <span>if</span> <span>(</span>i <span>==</span> <span>'$upstream'</span><span>)</span> <span>{</span>
            i <span>=</span> upstream_domain
        <span>}</span> <span>else</span> <span>if</span> <span>(</span>i <span>==</span> <span>'$custom_domain'</span><span>)</span> <span>{</span>
            i <span>=</span> host_name
        <span>}</span>
 
        <span>if</span> <span>(</span>j <span>==</span> <span>'$upstream'</span><span>)</span> <span>{</span>
            j <span>=</span> upstream_domain
        <span>}</span> <span>else</span> <span>if</span> <span>(</span>j <span>==</span> <span>'$custom_domain'</span><span>)</span> <span>{</span>
            j <span>=</span> host_name
        <span>}</span>
 
        <span>let</span> re <span>=</span> <span>new</span> <span>RegExp</span><span>(</span>i<span>,</span> <span>'g'</span><span>)</span>
        text <span>=</span> text<span>.</span><span>replace</span><span>(</span>re<span>,</span> j<span>)</span><span>;</span>
    <span>}</span>
    <span>return</span> text<span>;</span>
<span>}</span>
 
 
<span>async</span> <span>function</span> <span>device_status</span><span>(</span><span>user_agent_info</span><span>)</span> <span>{</span>
    <span>var</span> agents <span>=</span> <span>[</span><span>"Android"</span><span>,</span> <span>"iPhone"</span><span>,</span> <span>"SymbianOS"</span><span>,</span> <span>"Windows Phone"</span><span>,</span> <span>"iPad"</span><span>,</span> <span>"iPod"</span><span>]</span><span>;</span>
    <span>var</span> flag <span>=</span> <span>true</span><span>;</span>
    <span>for</span> <span>(</span><span>var</span> v <span>=</span> <span>0</span><span>;</span> v <span>&lt;</span> agents<span>.</span>length<span>;</span> v<span>++</span><span>)</span> <span>{</span>
        <span>if</span> <span>(</span>user_agent_info<span>.</span><span>indexOf</span><span>(</span>agents<span>[</span>v<span>]</span><span>)</span> <span>></span> <span>0</span><span>)</span> <span>{</span>
            flag <span>=</span> <span>false</span><span>;</span>
            <span>break</span><span>;</span>
        <span>}</span>
    <span>}</span>
    <span>return</span> flag<span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="注意" tabindex="-1"> 注意：</h2>
<p>如果出现：</p>
<p>“需要网站所有者处理的错误:网站密钥的网域无效”</p>
<p>Google reCAPTCHA V3.0无效. “网站所有者的错误：密钥类型无效”</p>
<h3 id="解决方法" tabindex="-1"> 解决方法：</h3>
<p>在代码中修改<code>new_request_headers.set('Referer'.......</code>，为对应的反代网站</p>
<div><pre><code>new_request_headers<span>.</span><span>set</span><span>(</span><span>'Referer'</span><span>,</span> <span>'https://github.com'</span><span>)</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Script" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-09T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">谷歌Gmail注册显示此号码不能验证的解决办法</title>
    <id>https://blog.ciberviler.top/other/%E8%B0%B7%E6%AD%8CGmail%E6%B3%A8%E5%86%8C%E6%98%BE%E7%A4%BA%E6%AD%A4%E5%8F%B7%E7%A0%81%E4%B8%8D%E8%83%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95.html</id>
    <link href="https://blog.ciberviler.top/other/%E8%B0%B7%E6%AD%8CGmail%E6%B3%A8%E5%86%8C%E6%98%BE%E7%A4%BA%E6%AD%A4%E5%8F%B7%E7%A0%81%E4%B8%8D%E8%83%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95.html"/>
    <updated>2022-05-27T11:24:40.000Z</updated>
    <content type="html"><![CDATA[<h1 id="谷歌gmail注册显示此号码不能验证的解决办法" tabindex="-1"> 谷歌Gmail注册显示此号码不能验证的解决办法</h1>
<p>谷歌账号注册中国手机号不能验证，很多同学在注册谷歌账号时经常会遇到这个问题，一直卡在电话号码验证上，是国内手机号不能通过谷歌的验证吗？</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-165365038994811.png" alt="img" loading="lazy"></p>
<p>基本都不是号码本身引起的，换新号码往往也没用，这里介绍几个靠谱的Gmail邮箱注册教程：</p>
<p>网上很多方法不能注册成功，说明目前使用的网络IP质量不行，需要找一个纯净的IP。</p>
<p>什么是纯净的IP？简单的讲就是这个IP用的人越少越好。</p>
<p>谷歌能否申请成功最关键的不是用哪个国家的手机号，而是需要一个纯净的IP，申请之前我们首先需要确认谷歌注册手机号无法进行验证两种状态。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536503899481.png" alt="img" loading="lazy"></p>
<p><strong>状态①：</strong>“无法用于验证”说明手机号之前没有注册过谷歌这种比较好解决只需要按照下面的方法操作即可</p>
<p><strong>状态②：</strong>“多次用于验证”说明手机号之前注册过谷歌或者尝试很多次,需要冷却。注册过等一个月/没有注册过等三天左右，这个状态不要再进行尝试，注册不了。</p>
<p><strong>目前网上绝大部分解决谷歌注册手机号无法进行验证显示“此电话号码无法用于进行验证”的教程都是以下两种:</strong></p>
<p>**方法一：**通过QQ邮箱APP注册。这种方法很简单在这里就不做过多介绍,但是不是很建议通过这种渠道注册。</p>
<p>具体原因是:由于国内网络限制,不借助上网工具是不能访问google的,那为什么通过QQ邮箱能够访问,是因为APP自带的联网工具,但是每天通过这个APP的单个IP去注册的用户可以说是成千上万,势必多账户关联引起谷歌的特殊关照,我们接到反馈很多小伙伴注册成功几个小时就报异常了。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536503899482.jpeg" alt="img" loading="lazy"></p>
<p>**方法二：**切换chrome浏览器的语言完成注册。这种方法还是有小伙伴注册不成功，经过本人实战前后加起来注册了20000+个谷歌号总结出的经验，谷歌号能否注册成功最关键不是使用什么语言，也不是使用哪个国家的手机号决定的，而是需要的是一个纯净的网络IP。</p>
<p>下面就给大家分享一下这种方法容易被忽略的步骤。①首先需要做的是清楚浏览器的历史记录</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536503899483.jpeg" alt="img" loading="lazy"></p>
<p>【重点】这里很关键容易被忽略，这里需要选择高级保证浏览器的所有缓存全部被清理干净，清理后关闭浏览器器</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536503899494.jpeg" alt="img" loading="lazy"></p>
<p>②【重点】首先链接到一个使用人数较少的代理网络，在开始注册谷歌账号之前先使用IP查询工具，查询你现在所接入网络的所在国家。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536503899495.jpeg" alt="img" loading="lazy"></p>
<p>③点击chrome浏览器右上角的菜单按钮→选择“设置”→高级→语言→添加日语并置顶同时移除其他语言</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536503899496.jpeg" alt="img" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536503899497.jpeg" alt="img" loading="lazy"></p>
<p>【重点】如果通过查询你的IP是其他国家，就添加相应国家的语言即可。我这里的IP是日本，所以我就把浏览器设置成日语，网上的教程都是直接叫设置成英语。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536503899498.jpeg" alt="img" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536503899499.jpeg" alt="img" loading="lazy"></p>
<p>④【重点】完成这个步骤以后再次清除浏览缓存，并关闭浏览器， ⑤再次打开chrome浏览器进入谷歌主页点击右上角蓝色注册按钮，依次操作即可。即可注册成功。</p>
<p>注册几分钟就成功了。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-165365038994910.jpeg" alt="img" loading="lazy"></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-06T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">新版QQ修改彩色颜色字体代码教程</title>
    <id>https://blog.ciberviler.top/other/%E6%96%B0%E7%89%88QQ%E4%BF%AE%E6%94%B9%E5%BD%A9%E8%89%B2%E9%A2%9C%E8%89%B2%E5%AD%97%E4%BD%93%E4%BB%A3%E7%A0%81%E6%95%99%E7%A8%8B.html</id>
    <link href="https://blog.ciberviler.top/other/%E6%96%B0%E7%89%88QQ%E4%BF%AE%E6%94%B9%E5%BD%A9%E8%89%B2%E9%A2%9C%E8%89%B2%E5%AD%97%E4%BD%93%E4%BB%A3%E7%A0%81%E6%95%99%E7%A8%8B.html"/>
    <updated>2022-05-27T11:24:33.000Z</updated>
    <summary type="html">Other</summary>
    <content type="html"><![CDATA[<h1 id="新版qq修改彩色颜色字体代码教程" tabindex="-1"> 新版QQ修改彩色颜色字体代码教程</h1>
<p>QQ群彩色昵称，</p>
<p>玩过的都知道，以前是可以直接设置的，但新版QQ群昵称好像不太行！效果自测！</p>
<p>这里我就分享 <strong>两类</strong> 颜色代码吧，用的话把后面的颜色替换成自己的昵称就行了其实找一个旧版QQ，复制好改完的昵称就会在剪切板显示颜色代码</p>
<p>q群改群昵称颜色代码合集（ <strong>需要SVIP</strong> ） 不喜勿喷，不喜勿喷，不喜勿喷！</p>
<h2 id="文字教程" tabindex="-1"> 文字教程：</h2>
<p>复制你需要的颜色到群昵称输入框内，然后删除文字(是删文字 不要删到代码)再打上你自己需要设置的群昵称即可！</p>
<p>记住名称放前面代码放后面，别搞错了，搞错了就提示有非法字符！就设置不成功咯！</p>
<h2 id="详细教程如下" tabindex="-1"> 详细教程如下:</h2>
<p>随便找一个群，找到编辑群昵称 选择自己想修改的颜色，这里我举例红色，红色代码是&lt;&amp;ÿÿ5@&gt;红色，我们把红色二个文字删掉，直接把&lt;&amp;ÿÿ5@&gt;复制粘贴到群昵称编辑里面，点击确定，我们来看看效果如何滑稽</p>
<h2 id="纯色昵称代码" tabindex="-1"> 纯色昵称代码：</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536501289982.jpeg" alt="img" loading="lazy"></p>
<div><pre><code>&lt;&amp;ÿĀĀĀ>黑色

&lt;&amp;ÿÿ5@>红色

&lt;&amp;ÿÿ]>粉色

&lt;&amp;ÿÒUÐ>紫色

&lt;&amp;ÿÇý>蓝色

&lt;&amp;ÿÄW>绿色
  
&lt;&amp;ÿÿÏP>黄色
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="彩色昵称代码" tabindex="-1"> 彩色昵称代码</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536501289981.jpeg" alt="img" loading="lazy"></p>
<p>代码如下</p>
<div><pre><code>&lt;&amp;ÿĀĀĀ>黑色
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code>&lt;&amp;ÿÿ5@>红色
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code>&lt;&amp;ÿÿ]>粉色
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code>&lt;&amp;ÿÒUÐ>紫色
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code>&lt;&amp;ÿÇý>蓝色
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code>&lt;&amp;ÿÄW>绿色
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code>&lt;&amp;ÿÿÏP>黄色
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code>&lt;%ĀĀÐ>初春
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code>&lt;%ĀĀÑ>冬梅
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code><span>&lt;</span><span>%</span>ĀĀÒ<span>></span>高级灰
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code><span>&lt;</span><span>%</span>ĀĀÓ<span>></span>黄昏
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code><span>&lt;</span><span>%</span>ĀĀÔ<span>></span>科技感
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code><span>&lt;</span><span>%</span>ĀĀÕ<span>></span>马卡龙
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code><span>&lt;</span><span>%</span>ĀĀÖ<span>></span>霓虹闪烁
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code><span>&lt;</span><span>%</span>ĀĀ×<span>></span>日出
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code><span>&lt;</span><span>%</span>ĀĀØ<span>></span>盛夏
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code><span>&lt;</span><span>%</span>ĀĀÙ<span>></span>糖果冰纷
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code><span>&lt;</span><span>%</span>ĀĀÚ<span>></span>晚秋
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code><span>&lt;</span><span>%</span>ĀĀÛ<span>></span>夜空
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code><span>&lt;</span><span>%</span>ĀĀÜ<span>></span>粉黛
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code><span>&lt;</span><span>%</span>ĀĀÝ<span>></span>朝夕
</code></pre><div aria-hidden="true"><div></div></div></div><div><pre><code><span>&lt;</span><span>%</span>ĀĀÞ<span>></span>潮流
</code></pre><div aria-hidden="true"><div></div></div></div><h2 id="效果展示" tabindex="-1"> 效果展示</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536501289982.png" alt="img" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536501289983.jpeg" alt="img" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536501289984.jpeg" alt="img" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536501289985.jpeg" alt="img" loading="lazy"></p>
<p>效果图来源于网络，若无意侵权，联系删除即可！</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-04T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">QQ动态群聊昵称代码</title>
    <id>https://blog.ciberviler.top/other/QQ%E5%8A%A8%E6%80%81%E7%BE%A4%E8%81%8A%E6%98%B5%E7%A7%B0%E4%BB%A3%E7%A0%81.html</id>
    <link href="https://blog.ciberviler.top/other/QQ%E5%8A%A8%E6%80%81%E7%BE%A4%E8%81%8A%E6%98%B5%E7%A7%B0%E4%BB%A3%E7%A0%81.html"/>
    <updated>2022-05-27T11:24:25.000Z</updated>
    <content type="html"><![CDATA[<h1 id="qq动态群聊昵称代码" tabindex="-1"> QQ动态群聊昵称代码</h1>
<h2 id="代码" tabindex="-1"> 代码</h2>
<ul>
<li>会变色钻石 <code>&lt;$ǿĀD&gt;钻石&lt;$ǿĀD&gt;</code> 效果图：</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536500405884.png" alt="img" loading="lazy"></p>
<p>钻石</p>
<ul>
<li>手掌比心 <code>&lt;$ÿĀ&quot;&gt;比心&lt;$ÿĀ&quot;&gt;</code> 效果图：</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536500405881.png" alt="img" loading="lazy"></p>
<p>比心</p>
<ul>
<li>滑稽 <code>&lt;$²&gt;滑稽&lt;$²&gt;</code> 效果图：</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536500405882.png" alt="img" loading="lazy"></p>
<p>滑稽</p>
<ul>
<li>可爱的手掌 <code>&lt;$ÿĀ&gt;小手&lt;$ÿĀ&gt;</code> 效果图：</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1620-16536500405883.png" alt="img" loading="lazy"></p>
<p>会动的小手</p>
<h2 id="注意" tabindex="-1"> 注意</h2>
<p>用代码改完群聊名称后不会立即显示，可以重新进去一次群资料即可刷新出来。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="other" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-02T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">服务器入侵排查</title>
    <id>https://blog.ciberviler.top/linux/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5.html</id>
    <link href="https://blog.ciberviler.top/linux/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5.html"/>
    <updated>2022-05-27T07:56:31.000Z</updated>
    <content type="html"><![CDATA[<h1 id="服务器入侵排查" tabindex="-1"> 服务器入侵排查</h1>
<h3 id="_1-入侵者可能会删除机器的日志信息" tabindex="-1"> 1.<strong>入侵者可能会删除机器的日志信息</strong></h3>
<p>可以查看日志信息是否还存在或者是否被清空，相关命令示例：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-165357407084712.png" alt="图片" loading="lazy"></p>
<h3 id="_2-入侵者可能创建一个新的存放用户名及密码文件" tabindex="-1"> 2.<strong>入侵者可能创建一个新的存放用户名及密码文件</strong></h3>
<p>可以查看/etc/passwd及/etc/shadow文件，相关命令示例：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535740708461.png" alt="图片" loading="lazy"></p>
<h3 id="_3-入侵者可能修改用户名及密码文件" tabindex="-1"> 3.<strong>入侵者可能修改用户名及密码文件</strong></h3>
<p>可以查看/etc/passwd及/etc/shadow文件内容进行鉴别，相关命令示例：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535740708462.png" alt="图片" loading="lazy"></p>
<h3 id="_4-查看机器最近成功登陆的事件和最后一次不成功的登陆事" tabindex="-1"> 4.<strong>查看机器最近成功登陆的事件和最后一次不成功的登陆事</strong></h3>
<p>对应日志“/var/log/lastlog”，相关命令示例：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535740708473.png" alt="图片" loading="lazy"></p>
<h3 id="_5-查看机器当前登录的全部用户" tabindex="-1"> 5.<strong>查看机器当前登录的全部用户</strong></h3>
<p>对应日志文件“/var/run/utmp”，相关命令示例：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535740708474.png" alt="图片" loading="lazy"></p>
<h3 id="_6-查看机-器创建以来登陆过的用户" tabindex="-1"> 6.*<em>查看机***<em>器创建以来登陆过的用户</em></em></h3>
<p>对应日志文件“/var/log/wtmp”，相关命令示例：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535740708475.png" alt="图片" loading="lazy"></p>
<h3 id="_7-查看机器所有用户的连接时间-小时" tabindex="-1"> 7.<strong>查看机器所有用户的连接时间（小时）</strong></h3>
<p>对应日志文件“/var/log/wtmp”，相关命令示例：<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535740708476.png" alt="图片" loading="lazy"></p>
<h3 id="_8-如果发现机器产生了异常流量" tabindex="-1"> 8.<strong>如果发现机器产生了异常流量</strong></h3>
<p>可以使用命令“tcpdump”抓取网络包查看流量情况或者使用工具”iperf”查看流量情况</p>
<h3 id="_9-可以查看-var-log-secure日志文件" tabindex="-1"> 9.<strong>可以查看/var/log/secure日志文件</strong></h3>
<p>尝试发现入侵者的信息，相关命令示例：<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535740708477.png" alt="图片" loading="lazy"></p>
<h3 id="_10-查询异常进程所对应的执行脚本文件" tabindex="-1"> 10.查询异常进程所对应的执行脚本文件</h3>
<p>a.top命令查看异常进程对应的PID</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535740708478.jpeg" alt="图片" loading="lazy"></p>
<p>b.在虚拟文件系统目录查找该进程的可执行文件</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535740708479.png" alt="图片" loading="lazy"></p>
<h3 id="_11-如果确认机器已被入侵-重要文件已被删除-可以尝试找回被删除的文件note" tabindex="-1"> 11.如果确认机器已被入侵，重要文件已被删除，可以尝试找回被删除的文件Note:</h3>
<p>1、当进程打开了某个文件时，只要该进程保持打开该文件，即使将其删除，它依然存在于磁盘中。这意味着，进程并不知道文件已经被删除，它仍然可以向打开该文件时提供给它的文件描述符进行读取和写入。除了该进程之外，这个文件是不可见的，因为已经删除了其相应的目录索引节点。</p>
<p>2、在/proc 目录下，其中包含了反映内核和进程树的各种文件。/proc目录挂载的是在内存中所映射的一块区域，所以这些文件和目录并不存在于磁盘中，因此当我们对这些文件进行读取和写入时，实际上是在从内存中获取相关信息。大多数与 lsof 相关的信息都存储于以进程的 PID 命名的目录中，即 /proc/1234 中包含的是 PID 为 1234 的进程的信息。每个进程目录中存在着各种文件，它们可以使得应用程序简单地了解进程的内存空间、文件描述符列表、指向磁盘上的文件的符号链接和其他系统信息。lsof 程序使用该信息和其他关于内核内部状态的信息来产生其输出。所以lsof 可以显示进程的文件描述符和相关的文件名等信息。也就是我们通过访问进程的文件描述符可以找到该文件的相关信息。</p>
<p>3、当系统中的某个文件被意外地删除了，只要这个时候系统中还有进程正在访问该文件，那么我们就可以通过lsof从/proc目录下恢复该文件的内容。</p>
<p>假设入侵者将/var/log/secure文件删除掉了，尝试将/var/log/secure文件恢复的方法可以参考如下：</p>
<p>a.查看/var/log/secure文件，发现已经没有该文件</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-165357407084710.png" alt="图片" loading="lazy"></p>
<p>b.使用lsof命令查看当前是否有进程打开/var/log/secure，</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-165357407084711.png" alt="图片" loading="lazy"></p>
<p>c.从上面的信息可以看到 PID 1264（rsyslogd）打开文件的文件描述符为4。同时还可以看到/var/log/ secure已经标记为被删除了。因此我们可以在/proc/1264/fd/4（fd下的每个以数字命名的文件表示进程对应的文件描述符）中查看相应的信息，如下：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-165357407084812.jpeg" alt="图片" loading="lazy"></p>
<p>d.从上面的信息可以看出，查看/proc/1264/fd/4就可以得到所要恢复的数据。如果可以通过文件描述符查看相应的数据，那么就可以使用I/O重定向将其重定向到文件中，如:</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-165357407084813.png" alt="图片" loading="lazy"></p>
<p>e.再次查看/var/log/secure，发现该文件已经存在。对于许多应用程序，尤其是日志文件和数据库，这种恢复删除文件的方法非常有用。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-165357407084814.jpeg" alt="图片" loading="lazy"></p>
<p><strong>版权申明：内容来源网络，版权归原创者所有。除非无法确认，都会标明作者及出处，如有侵权，烦请告知，我们会立即删除!</strong></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Linux" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-07T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">搞定 SpringBoot 接口恶意刷新和暴力请求</title>
    <id>https://blog.ciberviler.top/dev/%E6%90%9E%E5%AE%9ASpringBoot%E6%8E%A5%E5%8F%A3%E6%81%B6%E6%84%8F%E5%88%B7%E6%96%B0%E5%92%8C%E6%9A%B4%E5%8A%9B%E8%AF%B7%E6%B1%82.html</id>
    <link href="https://blog.ciberviler.top/dev/%E6%90%9E%E5%AE%9ASpringBoot%E6%8E%A5%E5%8F%A3%E6%81%B6%E6%84%8F%E5%88%B7%E6%96%B0%E5%92%8C%E6%9A%B4%E5%8A%9B%E8%AF%B7%E6%B1%82.html"/>
    <updated>2022-05-27T07:56:12.000Z</updated>
    <content type="html"><![CDATA[<h1 id="搞定-springboot-接口恶意刷新和暴力请求" tabindex="-1"> 搞定 SpringBoot 接口恶意刷新和暴力请求</h1>
<p>在实际项目使用中，必须要考虑服务的安全性，当服务部署到互联网以后，就要考虑服务被恶意请求和暴力攻击的情况，下面的教程，通过<code>intercept</code>和<code>redis</code>针对<code>url+ip</code>在一定时间内访问的次数来将ip禁用，可以根据自己的需求进行相应的修改，来打打自己的目的；</p>
<p>首先工程为springboot框架搭建，不再详细叙述。</p>
<p>首先创建一个自定义的拦截器类，也是最核心的代码：</p>
<div><pre><code><span>/**
 * <span>@package</span>: com.technicalinterest.group.interceptor
 * <span>@className</span>: IpUrlLimitInterceptor
 * <span>@description</span>: ip+url重复请求现在拦截器
 * <span>@author</span>: Shuyu.Wang
 * <span>@since</span>: 0.1
 **/</span>
<span>@Slf4j</span>
<span>public</span> <span>class</span> <span>IpUrlLimitInterceptor</span> <span>implements</span> <span>HandlerInterceptor</span> <span>{</span>
 
 
 <span>private</span> <span>RedisUtil</span> <span>getRedisUtil</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span>  <span>SpringContextUtil</span><span>.</span><span>getBean</span><span>(</span><span>RedisUtil</span><span>.</span><span>class</span><span>)</span><span>;</span>
 <span>}</span>
 
 <span>private</span> <span>static</span> <span>final</span> <span>String</span> LOCK_IP_URL_KEY<span>=</span><span>"lock_ip_"</span><span>;</span>
 
 <span>private</span> <span>static</span> <span>final</span> <span>String</span> IP_URL_REQ_TIME<span>=</span><span>"ip_url_times_"</span><span>;</span>
 
 <span>private</span> <span>static</span> <span>final</span> <span>long</span> LIMIT_TIMES<span>=</span><span>5</span><span>;</span>
 
 <span>private</span> <span>static</span> <span>final</span> <span>int</span> IP_LOCK_TIME<span>=</span><span>60</span><span>;</span>
 
 <span>@Override</span>
 <span>public</span> <span>boolean</span> <span>preHandle</span><span>(</span><span>HttpServletRequest</span> httpServletRequest<span>,</span> <span>HttpServletResponse</span> httpServletResponse<span>,</span> <span>Object</span> o<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
  log<span>.</span><span>info</span><span>(</span><span>"request请求地址uri={},ip={}"</span><span>,</span> httpServletRequest<span>.</span><span>getRequestURI</span><span>(</span><span>)</span><span>,</span> <span>IpAdrressUtil</span><span>.</span><span>getIpAdrress</span><span>(</span>httpServletRequest<span>)</span><span>)</span><span>;</span>
  <span>if</span> <span>(</span><span>ipIsLock</span><span>(</span><span>IpAdrressUtil</span><span>.</span><span>getIpAdrress</span><span>(</span>httpServletRequest<span>)</span><span>)</span><span>)</span><span>{</span>
   log<span>.</span><span>info</span><span>(</span><span>"ip访问被禁止={}"</span><span>,</span><span>IpAdrressUtil</span><span>.</span><span>getIpAdrress</span><span>(</span>httpServletRequest<span>)</span><span>)</span><span>;</span>
   <span>ApiResult</span> result <span>=</span> <span>new</span> <span>ApiResult</span><span>(</span><span>ResultEnum</span><span>.</span>LOCK_IP<span>)</span><span>;</span>
   <span>returnJson</span><span>(</span>httpServletResponse<span>,</span> JSON<span>.</span><span>toJSONString</span><span>(</span>result<span>)</span><span>)</span><span>;</span>
   <span>return</span> <span>false</span><span>;</span>
  <span>}</span>
  <span>if</span><span>(</span><span>!</span><span>addRequestTime</span><span>(</span><span>IpAdrressUtil</span><span>.</span><span>getIpAdrress</span><span>(</span>httpServletRequest<span>)</span><span>,</span>httpServletRequest<span>.</span><span>getRequestURI</span><span>(</span><span>)</span><span>)</span><span>)</span><span>{</span>
   <span>ApiResult</span> result <span>=</span> <span>new</span> <span>ApiResult</span><span>(</span><span>ResultEnum</span><span>.</span>LOCK_IP<span>)</span><span>;</span>
   <span>returnJson</span><span>(</span>httpServletResponse<span>,</span> JSON<span>.</span><span>toJSONString</span><span>(</span>result<span>)</span><span>)</span><span>;</span>
   <span>return</span> <span>false</span><span>;</span>
  <span>}</span>
  <span>return</span> <span>true</span><span>;</span>
 <span>}</span>
 
 <span>@Override</span>
 <span>public</span> <span>void</span> <span>postHandle</span><span>(</span><span>HttpServletRequest</span> httpServletRequest<span>,</span> <span>HttpServletResponse</span> httpServletResponse<span>,</span> <span>Object</span> o<span>,</span> <span>ModelAndView</span> modelAndView<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
 
 <span>}</span>
 
 <span>@Override</span>
 <span>public</span> <span>void</span> <span>afterCompletion</span><span>(</span><span>HttpServletRequest</span> httpServletRequest<span>,</span> <span>HttpServletResponse</span> httpServletResponse<span>,</span> <span>Object</span> o<span>,</span> <span>Exception</span> e<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
 
 <span>}</span>
 
 <span>/**
  * @Description: 判断ip是否被禁用
  * <span>@author</span>: shuyu.wang
  * <span>@date</span>: 2019-10-12 13:08
  * <span>@param</span> <span>ip</span>
  * <span>@return</span> java.lang.Boolean
  */</span>
 <span>private</span> <span>Boolean</span> <span>ipIsLock</span><span>(</span><span>String</span> ip<span>)</span><span>{</span>
  <span>RedisUtil</span> redisUtil<span>=</span><span>getRedisUtil</span><span>(</span><span>)</span><span>;</span>
  <span>if</span><span>(</span>redisUtil<span>.</span><span>hasKey</span><span>(</span>LOCK_IP_URL_KEY<span>+</span>ip<span>)</span><span>)</span><span>{</span>
   <span>return</span> <span>true</span><span>;</span>
  <span>}</span>
  <span>return</span> <span>false</span><span>;</span>
 <span>}</span>
 <span>/**
  * @Description: 记录请求次数
  * <span>@author</span>: shuyu.wang
  * <span>@date</span>: 2019-10-12 17:18
  * <span>@param</span> <span>ip</span>
  * <span>@param</span> <span>uri</span>
  * <span>@return</span> java.lang.Boolean
  */</span>
 <span>private</span> <span>Boolean</span> <span>addRequestTime</span><span>(</span><span>String</span> ip<span>,</span><span>String</span> uri<span>)</span><span>{</span>
  <span>String</span> key<span>=</span>IP_URL_REQ_TIME<span>+</span>ip<span>+</span>uri<span>;</span>
  <span>RedisUtil</span> redisUtil<span>=</span><span>getRedisUtil</span><span>(</span><span>)</span><span>;</span>
  <span>if</span> <span>(</span>redisUtil<span>.</span><span>hasKey</span><span>(</span>key<span>)</span><span>)</span><span>{</span>
   <span>long</span> time<span>=</span>redisUtil<span>.</span><span>incr</span><span>(</span>key<span>,</span><span>(</span><span>long</span><span>)</span><span>1</span><span>)</span><span>;</span>
   <span>if</span> <span>(</span>time<span>>=</span>LIMIT_TIMES<span>)</span><span>{</span>
    redisUtil<span>.</span><span>getLock</span><span>(</span>LOCK_IP_URL_KEY<span>+</span>ip<span>,</span>ip<span>,</span>IP_LOCK_TIME<span>)</span><span>;</span>
    <span>return</span> <span>false</span><span>;</span>
   <span>}</span>
  <span>}</span><span>else</span> <span>{</span>
   redisUtil<span>.</span><span>getLock</span><span>(</span>key<span>,</span><span>(</span><span>long</span><span>)</span><span>1</span><span>,</span><span>1</span><span>)</span><span>;</span>
  <span>}</span>
  <span>return</span> <span>true</span><span>;</span>
 <span>}</span>
 
 <span>private</span> <span>void</span> <span>returnJson</span><span>(</span><span>HttpServletResponse</span> response<span>,</span> <span>String</span> json<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
  <span>PrintWriter</span> writer <span>=</span> <span>null</span><span>;</span>
  response<span>.</span><span>setCharacterEncoding</span><span>(</span><span>"UTF-8"</span><span>)</span><span>;</span>
  response<span>.</span><span>setContentType</span><span>(</span><span>"text/json; charset=utf-8"</span><span>)</span><span>;</span>
  <span>try</span> <span>{</span>
   writer <span>=</span> response<span>.</span><span>getWriter</span><span>(</span><span>)</span><span>;</span>
   writer<span>.</span><span>print</span><span>(</span>json<span>)</span><span>;</span>
  <span>}</span> <span>catch</span> <span>(</span><span>IOException</span> e<span>)</span> <span>{</span>
   log<span>.</span><span>error</span><span>(</span><span>"LoginInterceptor response error ---> {}"</span><span>,</span> e<span>.</span><span>getMessage</span><span>(</span><span>)</span><span>,</span> e<span>)</span><span>;</span>
  <span>}</span> <span>finally</span> <span>{</span>
   <span>if</span> <span>(</span>writer <span>!=</span> <span>null</span><span>)</span> <span>{</span>
    writer<span>.</span><span>close</span><span>(</span><span>)</span><span>;</span>
   <span>}</span>
  <span>}</span>
 <span>}</span>
 
 
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>代码中redis的使用的是分布式锁的形式，这样可以最大程度保证线程安全和功能的实现效果。代码中设置的是1S内同一个接口通过同一个ip访问5次，就将该ip禁用1个小时，根据自己项目需求可以自己适当修改，实现自己想要的功能；</p>
<p>redis分布式锁的关键代码:</p>
<div><pre><code><span>/**
 * <span>@package</span>: com.shuyu.blog.util
 * <span>@className</span>: RedisUtil
 * <span>@description</span>:
 * <span>@author</span>: Shuyu.Wang
 * <span>@since</span>: 0.1
 **/</span>
<span>@Component</span>
<span>@Slf4j</span>
<span>public</span> <span>class</span> <span>RedisUtil</span> <span>{</span>
 
 <span>private</span> <span>static</span> <span>final</span> <span>Long</span> SUCCESS <span>=</span> <span>1L</span><span>;</span>
 
 <span>@Autowired</span>
 <span>private</span> <span>RedisTemplate</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span></span> redisTemplate<span>;</span>
 <span>// =============================common============================</span>
 
 
 
 <span>/**
  * 获取锁
  * <span>@param</span> <span>lockKey</span>
  * <span>@param</span> <span>value</span>
  * <span>@param</span> <span>expireTime</span>：单位-秒
  * <span>@return</span>
  */</span>
 <span>public</span> <span>boolean</span> <span>getLock</span><span>(</span><span>String</span> lockKey<span>,</span> <span>Object</span> value<span>,</span> <span>int</span> expireTime<span>)</span> <span>{</span>
  <span>try</span> <span>{</span>
   log<span>.</span><span>info</span><span>(</span><span>"添加分布式锁key={},expireTime={}"</span><span>,</span>lockKey<span>,</span>expireTime<span>)</span><span>;</span>
   <span>String</span> script <span>=</span> <span>"if redis.call('setNx',KEYS[1],ARGV[1]) then if redis.call('get',KEYS[1])==ARGV[1] then return redis.call('expire',KEYS[1],ARGV[2]) else return 0 end end"</span><span>;</span>
   <span>RedisScript</span><span><span>&lt;</span><span>String</span><span>></span></span> redisScript <span>=</span> <span>new</span> <span>DefaultRedisScript</span><span><span>&lt;</span><span>></span></span><span>(</span>script<span>,</span> <span>String</span><span>.</span><span>class</span><span>)</span><span>;</span>
   <span>Object</span> result <span>=</span> redisTemplate<span>.</span><span>execute</span><span>(</span>redisScript<span>,</span> <span>Collections</span><span>.</span><span>singletonList</span><span>(</span>lockKey<span>)</span><span>,</span> value<span>,</span> expireTime<span>)</span><span>;</span>
   <span>if</span> <span>(</span>SUCCESS<span>.</span><span>equals</span><span>(</span>result<span>)</span><span>)</span> <span>{</span>
    <span>return</span> <span>true</span><span>;</span>
   <span>}</span>
  <span>}</span> <span>catch</span> <span>(</span><span>Exception</span> e<span>)</span> <span>{</span>
   e<span>.</span><span>printStackTrace</span><span>(</span><span>)</span><span>;</span>
  <span>}</span>
  <span>return</span> <span>false</span><span>;</span>
 <span>}</span>
 
 <span>/**
  * 释放锁
  * <span>@param</span> <span>lockKey</span>
  * <span>@param</span> <span>value</span>
  * <span>@return</span>
  */</span>
 <span>public</span> <span>boolean</span> <span>releaseLock</span><span>(</span><span>String</span> lockKey<span>,</span> <span>String</span> value<span>)</span> <span>{</span>
  <span>String</span> script <span>=</span> <span>"if redis.call('get', KEYS[1]) == ARGV[1] then return redis.call('del', KEYS[1]) else return 0 end"</span><span>;</span>
  <span>RedisScript</span><span><span>&lt;</span><span>String</span><span>></span></span> redisScript <span>=</span> <span>new</span> <span>DefaultRedisScript</span><span><span>&lt;</span><span>></span></span><span>(</span>script<span>,</span> <span>String</span><span>.</span><span>class</span><span>)</span><span>;</span>
  <span>Object</span> result <span>=</span> redisTemplate<span>.</span><span>execute</span><span>(</span>redisScript<span>,</span> <span>Collections</span><span>.</span><span>singletonList</span><span>(</span>lockKey<span>)</span><span>,</span> value<span>)</span><span>;</span>
  <span>if</span> <span>(</span>SUCCESS<span>.</span><span>equals</span><span>(</span>result<span>)</span><span>)</span> <span>{</span>
   <span>return</span> <span>true</span><span>;</span>
  <span>}</span>
  <span>return</span> <span>false</span><span>;</span>
 <span>}</span>
 
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>最后将上面自定义的拦截器通过<code>registry.addInterceptor</code>添加一下，就生效了；</p>
<div><pre><code><span>@Configuration</span>
<span>@Slf4j</span>
<span>public</span> <span>class</span> <span>MyWebAppConfig</span> <span>extends</span> <span>WebMvcConfigurerAdapter</span> <span>{</span>
    <span>@Bean</span>
 <span>IpUrlLimitInterceptor</span> <span>getIpUrlLimitInterceptor</span><span>(</span><span>)</span><span>{</span>
     <span>return</span> <span>new</span> <span>IpUrlLimitInterceptor</span><span>(</span><span>)</span><span>;</span>
 <span>}</span>
 
 <span>@Override</span>
    <span>public</span> <span>void</span> <span>addInterceptors</span><span>(</span><span>InterceptorRegistry</span> registry<span>)</span> <span>{</span>
  registry<span>.</span><span>addInterceptor</span><span>(</span><span>getIpUrlLimitInterceptor</span><span>(</span><span>)</span><span>)</span><span>.</span><span>addPathPatterns</span><span>(</span><span>"/**"</span><span>)</span><span>;</span>
        <span>super</span><span>.</span><span>addInterceptors</span><span>(</span>registry<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>自己可以写一个for循环来测试方面的功能，这里就不详细介绍了。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-05T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">9个很酷的CMD命令</title>
    <id>https://blog.ciberviler.top/pc/9%E4%B8%AA%E5%BE%88%E9%85%B7%E7%9A%84CMD%E5%91%BD%E4%BB%A4.html</id>
    <link href="https://blog.ciberviler.top/pc/9%E4%B8%AA%E5%BE%88%E9%85%B7%E7%9A%84CMD%E5%91%BD%E4%BB%A4.html"/>
    <updated>2022-05-27T07:56:04.000Z</updated>
    <content type="html"><![CDATA[<h1 id="_9个很酷的cmd命令" tabindex="-1"> 9个很酷的CMD命令</h1>
<h2 id="ipconfig" tabindex="-1"> <strong>ipconfig</strong></h2>
<p>功能：查询本机IP地址</p>
<p>操作方法：只要在在打开的cmd命令界面中输入“ipconfig”就可以了。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535737928341.png" alt="图片" loading="lazy"></p>
<h2 id="msg" tabindex="-1"> <strong>msg</strong></h2>
<p>功能：向对方电脑发送一条文本提示</p>
<p>操作方法：首先你要知道对方的IP地址，接下来输入命令“msg /server:对方电脑IP * ”。在“*”后输入你要发送的内容即可。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535737928331.png" alt="图片" loading="lazy"></p>
<h2 id="net-user" tabindex="-1"> <strong>Net user</strong></h2>
<p>功能：查看本机账户情况</p>
<p>操作方法：和ipconfig一样，net user也有很多衍生的命令后缀，比方说“net user xxx 123456 /add”，输入后就会在系统中创建一个名为“xxx”的新用户，而新用户密码则是“123456”。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535737928342.png" alt="图片" loading="lazy"></p>
<h2 id="net-share" tabindex="-1"> <strong>Net share</strong></h2>
<p>作用：查看共享资源</p>
<p>操作方法：在cmd界面中输入“net share”查看所有已共享资源，然后输入“net share 要删除的共享文件夹 /delete”就可以啦！</p>
<p><img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="图片" loading="lazy"></p>
<h2 id="nslookup" tabindex="-1"> <strong>Nslookup</strong></h2>
<p>作用：检查网站IP地址</p>
<p>操作方法：在提示符状态输入“nslookup 对方网站域名”，哒哒哒哒……结果出来了！</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535737928343.png" alt="图片" loading="lazy"></p>
<h2 id="netsh-wlan-show" tabindex="-1"> <strong>Netsh wlan show</strong></h2>
<p>作用：探秘Wi-Fi配置文件</p>
<p>操作方法：在提示符状态输入命令“netsh wlan show profile SSID key=clear”，输入完成后Windows会自动返回当前已连接WIFI的详细信息，包括SSID和连接密码。当前这里有一个前提，那就是你现在已经成功连接了。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535737928344.png" alt="图片" loading="lazy"></p>
<h2 id="telnet" tabindex="-1"> <strong>telnet</strong></h2>
<p>作用：看电影《星球大战》</p>
<p>操作方法：在提示符状态输入命令“telnet <a href="http://towel.blinkenlights.nl" target="_blank" rel="noopener noreferrer">towel.blinkenlights.nl</a>”，输入完成后稍等一会即可，电影会自动开演</p>
<p><img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="图片" loading="lazy"></p>
<h2 id="" tabindex="-1"> <strong>|</strong></h2>
<p>作用：将命令结果输出到剪贴板</p>
<p>操作方法：在需要导出结果的命令后方添加“|”，再加入导出位置就可以了。比方说“| clip”是导出到剪贴板，“| xxx.txt”是导出到xxx.txt。总之，你需要什么地方用，就放到哪儿，“|”支持绝大多数CMD指令。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535737928345.png" alt="图片" loading="lazy"></p>
<h2 id="-1" tabindex="-1"> <strong>&amp;&amp;</strong></h2>
<p>作用：将多个命令“连接”起来，一步运行多组命令</p>
<p>操作方法：&amp;&amp;是CMD里一项“命令连接”语句，直接放在要连接的命令行中间即可。效果就是下图所示，一次输入后CMD会顺序执行所有命令。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535737928346.png" alt="图片" loading="lazy"></p>
<p>--- EOF ---</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="pc" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-03T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Quartz - 任务调度框架整合使用</title>
    <id>https://blog.ciberviler.top/dev/Quartz%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E6%A1%86%E6%9E%B6%E6%95%B4%E5%90%88%E4%BD%BF%E7%94%A8.html</id>
    <link href="https://blog.ciberviler.top/dev/Quartz%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E6%A1%86%E6%9E%B6%E6%95%B4%E5%90%88%E4%BD%BF%E7%94%A8.html"/>
    <updated>2022-05-26T05:05:28.000Z</updated>
    <content type="html"><![CDATA[<h1 id="quartz-任务调度框架整合使用" tabindex="-1"> Quartz - 任务调度框架整合使用</h1>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535411548287.png" alt="图片" loading="lazy"></p>
<p>各种实现自定义定时任务的方案，从Quartz到Xxl-job，再到Elastic-job，能聊的都聊了一圈儿；刚刚好手头有一份关于 Quartz 的保姆级教程，在这里分享给大家；</p>
<h2 id="_1前言" tabindex="-1"> 1前言</h2>
<p>项目中遇到一个，需要 客户自定任务启动时间 的需求。原来一直都是在项目里硬编码一些定时器，所以没有学习过。</p>
<p>很多开源的项目管理框架都已经做了 Quartz 的集成。我们居然连这么常用得东西居然没有做成模块化，实在是不应该。</p>
<p>Quartz是<code>OpenSymphony</code>开源组织在<code>Job scheduling</code>领域又一个开源项目，完全由Java开发，可以用来执行定时任务，类似于<code>java.util.Timer</code>。但是相较于Timer， Quartz增加了很多功能：</p>
<ul>
<li>持久性作业 - 就是保持调度定时的状态;</li>
<li>作业管理 - 对调度作业进行有效的管理;</li>
</ul>
<p>官方文档：</p>
<ul>
<li><a href="http://www.quartz-scheduler.org/documentation/" target="_blank" rel="noopener noreferrer">http://www.quartz-scheduler.org/documentation/</a></li>
<li><a href="http://www.quartz-scheduler.org/api/2.3.0/index.html" target="_blank" rel="noopener noreferrer">http://www.quartz-scheduler.org/api/2.3.0/index.html</a></li>
</ul>
<h2 id="_2基础使用" tabindex="-1"> 2基础使用</h2>
<p>Quartz 的核心类有以下三部分：</p>
<ul>
<li><strong>任务 Job ：</strong> 需要实现的任务类，实现 <code>execute()</code> 方法，执行后完成任务。</li>
<li><strong>触发器 Trigger ：</strong> 包括 <code>SimpleTrigger</code> 和 <code>CronTrigger</code>。</li>
<li><strong>调度器 Scheduler ：</strong> 任务调度器，负责基于 <code>Trigger</code>触发器，来执行 Job任务。</li>
</ul>
<p>主要关系如下：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535411548281.png" alt="图片" loading="lazy"></p>
<h2 id="_3demo" tabindex="-1"> 3Demo</h2>
<p>按照官网的 Demo，搭建一个纯 maven 项目，添加依赖：</p>
<div><pre><code><span>&lt;!-- 核心包 --></span>
<span><span><span>&lt;</span>dependency</span><span>></span></span>
    <span><span><span>&lt;</span>groupId</span><span>></span></span>org.quartz-scheduler<span><span><span>&lt;/</span>groupId</span><span>></span></span>
    <span><span><span>&lt;</span>artifactId</span><span>></span></span>quartz<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
    <span><span><span>&lt;</span>version</span><span>></span></span>2.3.0<span><span><span>&lt;/</span>version</span><span>></span></span>
<span><span><span>&lt;/</span>dependency</span><span>></span></span>
<span>&lt;!-- 工具包 --></span>
<span><span><span>&lt;</span>dependency</span><span>></span></span>
    <span><span><span>&lt;</span>groupId</span><span>></span></span>org.quartz-scheduler<span><span><span>&lt;/</span>groupId</span><span>></span></span>
    <span><span><span>&lt;</span>artifactId</span><span>></span></span>quartz-jobs<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
    <span><span><span>&lt;</span>version</span><span>></span></span>2.3.0<span><span><span>&lt;/</span>version</span><span>></span></span>
<span><span><span>&lt;/</span>dependency</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>新建一个任务，实现了 <code>org.quartz.Job</code> 接口：</p>
<div><pre><code><span>public</span> <span>class</span> <span>MyJob</span> <span>implements</span> <span>Job</span> <span>{</span>
    <span>@Override</span>
    <span>public</span> <span>void</span> <span>execute</span><span>(</span><span>JobExecutionContext</span> context<span>)</span> <span>throws</span> <span>JobExecutionException</span> <span>{</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"任务被执行了。。。"</span><span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>main 方法，创建调度器、jobDetail 实例、trigger 实例、执行：</p>
<div><pre><code><span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
    <span>// 1.创建调度器 Scheduler</span>
    <span>SchedulerFactory</span> factory <span>=</span> <span>new</span> <span>StdSchedulerFactory</span><span>(</span><span>)</span><span>;</span>
    <span>Scheduler</span> scheduler <span>=</span> factory<span>.</span><span>getScheduler</span><span>(</span><span>)</span><span>;</span>

    <span>// 2.创建JobDetail实例，并与MyJob类绑定(Job执行内容)</span>
    <span>JobDetail</span> job <span>=</span> <span>JobBuilder</span><span>.</span><span>newJob</span><span>(</span><span>MyJob</span><span>.</span><span>class</span><span>)</span>
        <span>.</span><span>withIdentity</span><span>(</span><span>"job1"</span><span>,</span> <span>"group1"</span><span>)</span>
        <span>.</span><span>build</span><span>(</span><span>)</span><span>;</span>

    <span>// 3.构建Trigger实例,每隔30s执行一次</span>
    <span>Trigger</span> trigger <span>=</span> <span>TriggerBuilder</span><span>.</span><span>newTrigger</span><span>(</span><span>)</span>
        <span>.</span><span>withIdentity</span><span>(</span><span>"trigger1"</span><span>,</span> <span>"group1"</span><span>)</span>
        <span>.</span><span>startNow</span><span>(</span><span>)</span>
        <span>.</span><span>withSchedule</span><span>(</span><span>simpleSchedule</span><span>(</span><span>)</span>
                      <span>.</span><span>withIntervalInSeconds</span><span>(</span><span>30</span><span>)</span>
                      <span>.</span><span>repeatForever</span><span>(</span><span>)</span><span>)</span>
        <span>.</span><span>build</span><span>(</span><span>)</span><span>;</span>

    <span>// 4.执行，开启调度器</span>
    scheduler<span>.</span><span>scheduleJob</span><span>(</span>job<span>,</span> trigger<span>)</span><span>;</span>
    <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>System</span><span>.</span><span>currentTimeMillis</span><span>(</span><span>)</span><span>)</span><span>;</span>
    scheduler<span>.</span><span>start</span><span>(</span><span>)</span><span>;</span>

    <span>//主线程睡眠1分钟，然后关闭调度器</span>
    <span>TimeUnit</span><span>.</span>MINUTES<span>.</span><span>sleep</span><span>(</span><span>1</span><span>)</span><span>;</span>
    scheduler<span>.</span><span>shutdown</span><span>(</span><span>)</span><span>;</span>
    <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>System</span><span>.</span><span>currentTimeMillis</span><span>(</span><span>)</span><span>)</span><span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>日志打印情况：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535411548282.png" alt="图片" loading="lazy"></p>
<h2 id="_4jobdetail" tabindex="-1"> 4JobDetail</h2>
<p>JobDetail 的作用是绑定 Job，是一个任务实例，它为 Job 添加了许多扩展参数。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535411548293.png" alt="图片" loading="lazy"></p>
<p>每次<code>Scheduler</code>调度执行一个Job的时候，首先会拿到对应的Job，然后创建该Job实例，再去执行Job中的<code>execute()</code>的内容，任务执行结束后，关联的Job对象实例会被释放，且会被JVM GC清除。</p>
<p><strong>为什么设计成JobDetail + Job，不直接使用Job？</strong></p>
<p>JobDetail 定义的是任务数据，而真正的执行逻辑是在Job中。</p>
<p>这是因为任务是有可能并发执行，如果Scheduler直接使用Job，就会存在对同一个Job实例并发访问的问题。</p>
<p>而<code>JobDetail &amp; Job</code> 方式，Sheduler每次执行，都会根据JobDetail创建一个新的Job实例，这样就可以 规避并发访问 的问题。</p>
<h2 id="_5jobexecutioncontext" tabindex="-1"> 5JobExecutionContext</h2>
<ul>
<li>当 <code>Scheduler</code> 调用一个 job，就会将 <code>JobExecutionContext</code> 传递给 Job 的 <code>execute()</code> 方法;</li>
<li>Job 能通过 <code>JobExecutionContext</code> 对象访问到 Quartz 运行时候的环境以及 Job 本身的明细数据。</li>
</ul>
<p>任务实现的 <code>execute()</code> 方法，可以通过 context 参数获取。</p>
<div><pre><code><span>public</span> <span>interface</span> <span>Job</span> <span>{</span>
    <span>void</span> <span>execute</span><span>(</span><span>JobExecutionContext</span> context<span>)</span>
        <span>throws</span> <span>JobExecutionException</span><span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p>在 <code>Builder</code> 建造过程中，可以使用如下方法：</p>
<div><pre><code><span>usingJobData</span><span>(</span><span>"tiggerDataMap"</span><span>,</span> <span>"测试传参"</span><span>)</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>在 <code>execute</code> 方法中获取：</p>
<div><pre><code>context<span>.</span><span>getTrigger</span><span>(</span><span>)</span><span>.</span><span>getJobDataMap</span><span>(</span><span>)</span><span>.</span><span>get</span><span>(</span><span>"tiggerDataMap"</span><span>)</span><span>;</span>
context<span>.</span><span>getJobDetail</span><span>(</span><span>)</span><span>.</span><span>getJobDataMap</span><span>(</span><span>)</span><span>.</span><span>get</span><span>(</span><span>"tiggerDataMap"</span><span>)</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h2 id="_6job-状态参数" tabindex="-1"> 6Job 状态参数</h2>
<p>有状态的 job 可以理解为多次 job调用期间可以持有一些状态信息，这些状态信息存储在 <code>JobDataMap</code> 中。</p>
<p>而默认的无状态 job，每次调用时都会创建一个新的 <code>JobDataMap</code>。</p>
<p>示例如下：</p>
<div><pre><code><span>//多次调用 Job 的时候，将参数保留在 JobDataMap</span>
<span>@PersistJobDataAfterExecution</span>
<span>public</span> <span>class</span> <span>JobStatus</span> <span>implements</span> <span>Job</span> <span>{</span>
    <span>@Override</span>
    <span>public</span> <span>void</span> <span>execute</span><span>(</span><span>JobExecutionContext</span> context<span>)</span> <span>throws</span> <span>JobExecutionException</span> <span>{</span>
        <span>long</span> count <span>=</span> <span>(</span><span>long</span><span>)</span> context<span>.</span><span>getJobDetail</span><span>(</span><span>)</span><span>.</span><span>getJobDataMap</span><span>(</span><span>)</span><span>.</span><span>get</span><span>(</span><span>"count"</span><span>)</span><span>;</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"当前执行，第"</span> <span>+</span> count <span>+</span> <span>"次"</span><span>)</span><span>;</span>
        context<span>.</span><span>getJobDetail</span><span>(</span><span>)</span><span>.</span><span>getJobDataMap</span><span>(</span><span>)</span><span>.</span><span>put</span><span>(</span><span>"count"</span><span>,</span> <span>++</span>count<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
<span>JobDetail</span> job <span>=</span> <span>JobBuilder</span><span>.</span><span>newJob</span><span>(</span><span>JobStatus</span><span>.</span><span>class</span><span>)</span>
                <span>.</span><span>withIdentity</span><span>(</span><span>"statusJob"</span><span>,</span> <span>"group1"</span><span>)</span>
                <span>.</span><span>usingJobData</span><span>(</span><span>"count"</span><span>,</span> <span>1L</span><span>)</span>
                <span>.</span><span>build</span><span>(</span><span>)</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>输出结果：</p>
<div><pre><code>当前执行，第1次
<span>[</span>main<span>]</span> INFO org.quartz.core.QuartzScheduler - Scheduler DefaultQuartzScheduler_<span>$_NON_CLUSTERED</span> started.
当前执行，第2次
当前执行，第3次
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><h2 id="_7trigger" tabindex="-1"> 7Trigger</h2>
<h3 id="定时启动-关闭" tabindex="-1"> 定时启动/关闭</h3>
<p><code>Trigger</code> 可以设置任务的开始结束时间， <code>Scheduler</code> 会根据参数进行触发。</p>
<div><pre><code><span>Calendar</span> instance <span>=</span> <span>Calendar</span><span>.</span><span>getInstance</span><span>(</span><span>)</span><span>;</span>
<span>Date</span> startTime <span>=</span> instance<span>.</span><span>getTime</span><span>(</span><span>)</span><span>;</span>
instance<span>.</span><span>add</span><span>(</span><span>Calendar</span><span>.</span>MINUTE<span>,</span> <span>1</span><span>)</span><span>;</span>
<span>Date</span> endTime <span>=</span> instance<span>.</span><span>getTime</span><span>(</span><span>)</span><span>;</span>

<span>// 3.构建Trigger实例</span>
<span>Trigger</span> trigger <span>=</span> <span>TriggerBuilder</span><span>.</span><span>newTrigger</span><span>(</span><span>)</span>
    <span>.</span><span>withIdentity</span><span>(</span><span>"trigger1"</span><span>,</span> <span>"group1"</span><span>)</span>
    <span>// 开始时间</span>
    <span>.</span><span>startAt</span><span>(</span>startTime<span>)</span>
    <span>// 结束时间</span>
    <span>.</span><span>endAt</span><span>(</span>endTime<span>)</span>
    <span>.</span><span>build</span><span>(</span><span>)</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>在 job 中也能拿到对应的时间，并进行业务判断</p>
<div><pre><code><span>public</span> <span>void</span> <span>execute</span><span>(</span><span>JobExecutionContext</span> context<span>)</span> <span>throws</span> <span>JobExecutionException</span> <span>{</span>
    <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"任务执行。。。"</span><span>)</span><span>;</span>
    <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>context<span>.</span><span>getTrigger</span><span>(</span><span>)</span><span>.</span><span>getStartTime</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>context<span>.</span><span>getTrigger</span><span>(</span><span>)</span><span>.</span><span>getEndTime</span><span>(</span><span>)</span><span>)</span><span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>运行结果：</p>
<div><pre><code><span>[</span>main<span>]</span> INFO <span><span>org<span>.</span>quartz<span>.</span>impl<span>.</span></span>StdSchedulerFactory</span> <span>-</span> <span>Quartz</span> scheduler version<span>:</span> <span>2.3</span><span>.0</span>
<span>1633149326723</span>
任务执行。。。
<span>Sat</span> <span>Oct</span> <span>02</span> <span>12</span><span>:</span><span>35</span><span>:</span><span>26</span> CST <span>2021</span>
<span>Sat</span> <span>Oct</span> <span>02</span> <span>12</span><span>:</span><span>36</span><span>:</span><span>26</span> CST <span>2021</span>
<span>[</span>main<span>]</span> INFO <span><span>org<span>.</span>quartz<span>.</span>core<span>.</span></span>QuartzScheduler</span> <span>-</span> <span>Scheduler</span> <span>DefaultQuartzScheduler_</span>$_NON_CLUSTERED started<span>.</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="_8simpletrigger" tabindex="-1"> 8SimpleTrigger</h2>
<p>这是比较简单的一类触发器，用它能实现很多基础的应用。使用它的主要场景包括：</p>
<ul>
<li>
<p><strong>在指定时间段内，执行一次任务</strong></p>
<p>最基础的 Trigger 不设置循环，设置开始时间。</p>
</li>
<li>
<p><strong>在指定时间段内，循环执行任务</strong></p>
<p>在 1 基础上加上循环间隔。可以指定 永远循环、运行指定次数</p>
<div><pre><code><span>TriggerBuilder</span><span>.</span><span>newTrigger</span><span>(</span><span>)</span>
    <span>.</span><span>withSchedule</span><span>(</span><span>SimpleScheduleBuilder</span>
                  <span>.</span><span>simpleSchedule</span><span>(</span><span>)</span>
                  <span>.</span><span>withIntervalInSeconds</span><span>(</span><span>30</span><span>)</span>
                  <span>.</span><span>repeatForever</span><span>(</span><span>)</span><span>)</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><blockquote>
<p><code>withRepeatCount(count)</code> 是重复次数，实际运行次数为 <code>count+1</code></p>
</blockquote>
<div><pre><code><span>TriggerBuilder</span><span>.</span><span>newTrigger</span><span>(</span><span>)</span>
    <span>.</span><span>withSchedule</span><span>(</span><span>SimpleScheduleBuilder</span>
                  <span>.</span><span>simpleSchedule</span><span>(</span><span>)</span>
                  <span>.</span><span>withIntervalInSeconds</span><span>(</span><span>30</span><span>)</span>
                  <span>.</span><span>withRepeatCount</span><span>(</span><span>5</span><span>)</span><span>)</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div></li>
<li>
<p><strong>立即开始，指定时间结束</strong></p>
<p>这个，略。</p>
</li>
</ul>
<h2 id="_9crontrigger" tabindex="-1"> 9CronTrigger</h2>
<p><code>CronTrigger</code> 是基于日历的任务调度器，在实际应用中更加常用。</p>
<p>虽然很常用，但是知识点都一样，只是可以通过表达式来设置时间而已。</p>
<p>使用方式就是绑定调度器时换一下：</p>
<div><pre><code>TriggerBuilder.newTrigger().withSchedule(CronScheduleBuilder.cronSchedule("* * * * * ?"))
</code></pre><div aria-hidden="true"><div></div></div></div><p>Cron 表达式这里不介绍，贴个图跳过</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535411548294.png" alt="图片" loading="lazy"></p>
<p>顺便推荐一个非常好用的Cron 表达式在线生成，反解析的工具：<a href="http://www.matools.com/cron" target="_blank" rel="noopener noreferrer">www.matools.com/cron</a> 非常好用，点几下，就能得到自己想要的cron表达式；</p>
<h2 id="_10springboot-整合" tabindex="-1"> 10SpringBoot 整合</h2>
<p>下面集成应用截图来自 Ruoyi 框架：</p>
<p><img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="图片" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535411548295.png" alt="图片" loading="lazy"></p>
<p>从上面的截图中，可以看到这个定时任务模块实现了：</p>
<ul>
<li>cron表达式定时执行</li>
<li>并发执行</li>
<li>错误策略</li>
<li>启动执行、暂停执行</li>
</ul>
<p>如果再加上：设置启动时间、停止时间 就更好了。不过启停时间只是调用两个方法而已，也就不写了。</p>
<p>这一部分就主要是看 RuoYi 框架 代码，然后加一点我需要用的功能。</p>
<p>前端部分就不写了，全部用 swagger 代替，一些基础字段也删除了，仅复制主体功能。</p>
<p>已完成代码示例：</p>
<blockquote>
<p><a href="https://gitee.com/qianwei4712/code-of-shiva/tree/master/quartz" target="_blank" rel="noopener noreferrer">https://gitee.com/qianwei4712/code-of-shiva/tree/master/quartz</a></p>
</blockquote>
<h2 id="_11环境准备" tabindex="-1"> 11环境准备</h2>
<p>从 springboot 2.4.10 开始，添加 quartz 的 maven 依赖：</p>
<div><pre><code><span>&lt;!--  Quartz 任务调度 --></span>
<span><span><span>&lt;</span>dependency</span><span>></span></span>
    <span><span><span>&lt;</span>groupId</span><span>></span></span>org.springframework.boot<span><span><span>&lt;/</span>groupId</span><span>></span></span>
    <span><span><span>&lt;</span>artifactId</span><span>></span></span>spring-boot-starter-quartz<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
<span><span><span>&lt;/</span>dependency</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>application 配置文件：</p>
<div><pre><code><span># 开发环境配置</span>
<span>server</span><span>:</span>
  <span># 服务器的HTTP端口</span>
  <span>port</span><span>:</span> <span>80</span>
  <span>servlet</span><span>:</span>
    <span># 应用的访问路径</span>
    <span>context-path</span><span>:</span> /
  <span>tomcat</span><span>:</span>
    <span># tomcat的URI编码</span>
    <span>uri-encoding</span><span>:</span> UTF<span>-</span><span>8</span>

<span>spring</span><span>:</span>
  <span>datasource</span><span>:</span>
    <span>username</span><span>:</span> root
    <span>password</span><span>:</span> root
    <span>url</span><span>:</span> jdbc<span>:</span>mysql<span>:</span>//127.0.0.1<span>:</span>3306/quartz<span>?</span>useUnicode=true<span>&amp;characterEncoding=utf-8&amp;useSSL=true</span>
    <span>driver-class-name</span><span>:</span> com.mysql.cj.jdbc.Driver

    <span># HikariPool 较佳配置</span>
    <span>hikari</span><span>:</span>
      <span># 客户端（即您）等待来自池的连接的最大毫秒数</span>
      <span>connection-timeout</span><span>:</span> <span>60000</span>
      <span># 控制将测试连接的活动性的最长时间</span>
      <span>validation-timeout</span><span>:</span> <span>3000</span>
      <span># 控制允许连接在池中保持空闲状态的最长时间</span>
      <span>idle-timeout</span><span>:</span> <span>60000</span>

      <span>login-timeout</span><span>:</span> <span>5</span>
      <span># 控制池中连接的最大生存期</span>
      <span>max-lifetime</span><span>:</span> <span>60000</span>
      <span># 控制允许池达到的最大大小，包括空闲和使用中的连接</span>
      <span>maximum-pool-size</span><span>:</span> <span>10</span>
      <span># 控制HikariCP尝试在池中维护的最小空闲连接数</span>
      <span>minimum-idle</span><span>:</span> <span>10</span>
      <span># 控制默认情况下从池获得的连接是否处于只读模式</span>
      <span>read-only</span><span>:</span> <span>false</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>Quartz 自带有数据库模式，脚本都是现成的：</p>
<p>下载这个脚本：</p>
<blockquote>
<p><a href="https://gitee.com/qianwei4712/code-of-shiva/blob/master/quartz/quartz.sql" target="_blank" rel="noopener noreferrer">https://gitee.com/qianwei4712/code-of-shiva/blob/master/quartz/quartz.sql</a></p>
</blockquote>
<p>保存任务的数据库表：</p>
<div><pre><code><span>CREATE</span> <span>TABLE</span> <span><span>`</span>quartz_job<span>`</span></span> <span>(</span>
  <span><span>`</span>job_id<span>`</span></span> <span>bigint</span><span>(</span><span>20</span><span>)</span> <span>NOT</span> <span>NULL</span> <span>AUTO_INCREMENT</span> <span>COMMENT</span> <span>'任务ID'</span><span>,</span>
  <span><span>`</span>job_name<span>`</span></span> <span>varchar</span><span>(</span><span>64</span><span>)</span> <span>NOT</span> <span>NULL</span> <span>DEFAULT</span> <span>''</span> <span>COMMENT</span> <span>'任务名称'</span><span>,</span>
  <span><span>`</span>job_group<span>`</span></span> <span>varchar</span><span>(</span><span>64</span><span>)</span> <span>NOT</span> <span>NULL</span> <span>DEFAULT</span> <span>'DEFAULT'</span> <span>COMMENT</span> <span>'任务组名'</span><span>,</span>
  <span><span>`</span>invoke_target<span>`</span></span> <span>varchar</span><span>(</span><span>500</span><span>)</span> <span>NOT</span> <span>NULL</span> <span>COMMENT</span> <span>'调用目标字符串'</span><span>,</span>
  <span><span>`</span>cron_expression<span>`</span></span> <span>varchar</span><span>(</span><span>255</span><span>)</span> <span>DEFAULT</span> <span>''</span> <span>COMMENT</span> <span>'cron执行表达式'</span><span>,</span>
  <span><span>`</span>misfire_policy<span>`</span></span> <span>varchar</span><span>(</span><span>20</span><span>)</span> <span>DEFAULT</span> <span>'3'</span> <span>COMMENT</span> <span>'计划执行错误策略（1立即执行 2执行一次 3放弃执行）'</span><span>,</span>
  <span><span>`</span>concurrent<span>`</span></span> <span>char</span><span>(</span><span>1</span><span>)</span> <span>DEFAULT</span> <span>'1'</span> <span>COMMENT</span> <span>'是否并发执行（0允许 1禁止）'</span><span>,</span>
  <span><span>`</span>status<span>`</span></span> <span>char</span><span>(</span><span>1</span><span>)</span> <span>DEFAULT</span> <span>'0'</span> <span>COMMENT</span> <span>'状态（0正常 1暂停）'</span><span>,</span>
  <span><span>`</span>remark<span>`</span></span> <span>varchar</span><span>(</span><span>500</span><span>)</span> <span>DEFAULT</span> <span>''</span> <span>COMMENT</span> <span>'备注信息'</span><span>,</span>
  <span>PRIMARY</span> <span>KEY</span> <span>(</span><span><span>`</span>job_id<span>`</span></span><span>,</span><span><span>`</span>job_name<span>`</span></span><span>,</span><span><span>`</span>job_group<span>`</span></span><span>)</span>
<span>)</span> <span>ENGINE</span><span>=</span><span>InnoDB</span> <span>AUTO_INCREMENT</span><span>=</span><span>2</span> <span>DEFAULT</span> <span>CHARSET</span><span>=</span>utf8 <span>COMMENT</span><span>=</span><span>'定时任务调度表'</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>最后准备一个任务方法：</p>
<div><pre><code><span>@Slf4j</span>
<span>@Component</span><span>(</span><span>"mysqlJob"</span><span>)</span>
<span>public</span> <span>class</span> <span>MysqlJob</span> <span>{</span>
    <span>protected</span> <span>final</span> <span>Logger</span> logger <span>=</span> <span>LoggerFactory</span><span>.</span><span>getLogger</span><span>(</span><span>this</span><span>.</span><span>getClass</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>public</span> <span>void</span> <span>execute</span><span>(</span><span>String</span> param<span>)</span> <span>{</span>
        logger<span>.</span><span>info</span><span>(</span><span>"执行 Mysql Job，当前时间：{}，任务参数：{}"</span><span>,</span> <span>LocalDateTime</span><span>.</span><span>now</span><span>(</span><span>)</span><span>.</span><span>format</span><span>(</span><span>DateTimeFormatter</span><span>.</span><span>ofPattern</span><span>(</span><span>"yyyy-MM-dd HH:mm:ss"</span><span>)</span><span>)</span><span>,</span> param<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="_12核心代码" tabindex="-1"> 12核心代码</h2>
<p><code>ScheduleConfig</code> 配置代码类：</p>
<div><pre><code><span>@Configuration</span>
<span>public</span> <span>class</span> <span>ScheduleConfig</span> <span>{</span>

    <span>@Bean</span>
    <span>public</span> <span>SchedulerFactoryBean</span> <span>schedulerFactoryBean</span><span>(</span><span>DataSource</span> dataSource<span>)</span> <span>{</span>
        <span>SchedulerFactoryBean</span> factory <span>=</span> <span>new</span> <span>SchedulerFactoryBean</span><span>(</span><span>)</span><span>;</span>
        factory<span>.</span><span>setDataSource</span><span>(</span>dataSource<span>)</span><span>;</span>

        <span>// quartz参数</span>
        <span>Properties</span> prop <span>=</span> <span>new</span> <span>Properties</span><span>(</span><span>)</span><span>;</span>
        prop<span>.</span><span>put</span><span>(</span><span>"org.quartz.scheduler.instanceName"</span><span>,</span> <span>"shivaScheduler"</span><span>)</span><span>;</span>
        prop<span>.</span><span>put</span><span>(</span><span>"org.quartz.scheduler.instanceId"</span><span>,</span> <span>"AUTO"</span><span>)</span><span>;</span>
        <span>// 线程池配置</span>
        prop<span>.</span><span>put</span><span>(</span><span>"org.quartz.threadPool.class"</span><span>,</span> <span>"org.quartz.simpl.SimpleThreadPool"</span><span>)</span><span>;</span>
        prop<span>.</span><span>put</span><span>(</span><span>"org.quartz.threadPool.threadCount"</span><span>,</span> <span>"20"</span><span>)</span><span>;</span>
        prop<span>.</span><span>put</span><span>(</span><span>"org.quartz.threadPool.threadPriority"</span><span>,</span> <span>"5"</span><span>)</span><span>;</span>
        <span>// JobStore配置</span>
        prop<span>.</span><span>put</span><span>(</span><span>"org.quartz.jobStore.class"</span><span>,</span> <span>"org.quartz.impl.jdbcjobstore.JobStoreTX"</span><span>)</span><span>;</span>
        <span>// 集群配置</span>
        prop<span>.</span><span>put</span><span>(</span><span>"org.quartz.jobStore.isClustered"</span><span>,</span> <span>"true"</span><span>)</span><span>;</span>
        prop<span>.</span><span>put</span><span>(</span><span>"org.quartz.jobStore.clusterCheckinInterval"</span><span>,</span> <span>"15000"</span><span>)</span><span>;</span>
        prop<span>.</span><span>put</span><span>(</span><span>"org.quartz.jobStore.maxMisfiresToHandleAtATime"</span><span>,</span> <span>"1"</span><span>)</span><span>;</span>
        prop<span>.</span><span>put</span><span>(</span><span>"org.quartz.jobStore.txIsolationLevelSerializable"</span><span>,</span> <span>"true"</span><span>)</span><span>;</span>

        <span>// sqlserver 启用</span>
        <span>// prop.put("org.quartz.jobStore.selectWithLockSQL", "SELECT * FROM {0}LOCKS UPDLOCK WHERE LOCK_NAME = ?");</span>
        prop<span>.</span><span>put</span><span>(</span><span>"org.quartz.jobStore.misfireThreshold"</span><span>,</span> <span>"12000"</span><span>)</span><span>;</span>
        prop<span>.</span><span>put</span><span>(</span><span>"org.quartz.jobStore.tablePrefix"</span><span>,</span> <span>"QRTZ_"</span><span>)</span><span>;</span>
        factory<span>.</span><span>setQuartzProperties</span><span>(</span>prop<span>)</span><span>;</span>

        factory<span>.</span><span>setSchedulerName</span><span>(</span><span>"shivaScheduler"</span><span>)</span><span>;</span>
        <span>// 延时启动</span>
        factory<span>.</span><span>setStartupDelay</span><span>(</span><span>1</span><span>)</span><span>;</span>
        factory<span>.</span><span>setApplicationContextSchedulerContextKey</span><span>(</span><span>"applicationContextKey"</span><span>)</span><span>;</span>
        <span>// 可选，QuartzScheduler</span>
        <span>// 启动时更新己存在的Job，这样就不用每次修改targetObject后删除qrtz_job_details表对应记录了</span>
        factory<span>.</span><span>setOverwriteExistingJobs</span><span>(</span><span>true</span><span>)</span><span>;</span>
        <span>// 设置自动启动，默认为true</span>
        factory<span>.</span><span>setAutoStartup</span><span>(</span><span>true</span><span>)</span><span>;</span>

        <span>return</span> factory<span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><code>ScheduleUtils</code> 调度工具类，这是本篇中最核心的代码：</p>
<div><pre><code><span>public</span> <span>class</span> <span>ScheduleUtils</span> <span>{</span>
    <span>/**
     * 得到quartz任务类
     *
     * <span>@param</span> <span>job</span> 执行计划
     * <span>@return</span> 具体执行任务类
     */</span>
    <span>private</span> <span>static</span> <span>Class</span><span><span>&lt;</span><span>?</span> <span>extends</span> <span>Job</span><span>></span></span> <span>getQuartzJobClass</span><span>(</span><span>QuartzJob</span> job<span>)</span> <span>{</span>
        <span>boolean</span> isConcurrent <span>=</span> <span>"0"</span><span>.</span><span>equals</span><span>(</span>job<span>.</span><span>getConcurrent</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>return</span> isConcurrent <span>?</span> <span>QuartzJobExecution</span><span>.</span><span>class</span> <span>:</span> <span>QuartzDisallowConcurrentExecution</span><span>.</span><span>class</span><span>;</span>
    <span>}</span>

    <span>/**
     * 构建任务触发对象
     */</span>
    <span>public</span> <span>static</span> <span>TriggerKey</span> <span>getTriggerKey</span><span>(</span><span>Long</span> jobId<span>,</span> <span>String</span> jobGroup<span>)</span> <span>{</span>
        <span>return</span> <span>TriggerKey</span><span>.</span><span>triggerKey</span><span>(</span><span>ScheduleConstants</span><span>.</span>TASK_CLASS_NAME <span>+</span> jobId<span>,</span> jobGroup<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 构建任务键对象
     */</span>
    <span>public</span> <span>static</span> <span>JobKey</span> <span>getJobKey</span><span>(</span><span>Long</span> jobId<span>,</span> <span>String</span> jobGroup<span>)</span> <span>{</span>
        <span>return</span> <span>JobKey</span><span>.</span><span>jobKey</span><span>(</span><span>ScheduleConstants</span><span>.</span>TASK_CLASS_NAME <span>+</span> jobId<span>,</span> jobGroup<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 创建定时任务
     */</span>
    <span>public</span> <span>static</span> <span>void</span> <span>createScheduleJob</span><span>(</span><span>Scheduler</span> scheduler<span>,</span> <span>QuartzJob</span> job<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
        <span>Class</span><span><span>&lt;</span><span>?</span> <span>extends</span> <span>Job</span><span>></span></span> jobClass <span>=</span> <span>getQuartzJobClass</span><span>(</span>job<span>)</span><span>;</span>
        <span>// 构建job信息</span>
        <span>Long</span> jobId <span>=</span> job<span>.</span><span>getJobId</span><span>(</span><span>)</span><span>;</span>
        <span>String</span> jobGroup <span>=</span> job<span>.</span><span>getJobGroup</span><span>(</span><span>)</span><span>;</span>
        <span>JobDetail</span> jobDetail <span>=</span> <span>JobBuilder</span><span>.</span><span>newJob</span><span>(</span>jobClass<span>)</span><span>.</span><span>withIdentity</span><span>(</span><span>getJobKey</span><span>(</span>jobId<span>,</span> jobGroup<span>)</span><span>)</span><span>.</span><span>build</span><span>(</span><span>)</span><span>;</span>

        <span>// 表达式调度构建器</span>
        <span>CronScheduleBuilder</span> cronScheduleBuilder <span>=</span> <span>CronScheduleBuilder</span><span>.</span><span>cronSchedule</span><span>(</span>job<span>.</span><span>getCronExpression</span><span>(</span><span>)</span><span>)</span><span>;</span>
        cronScheduleBuilder <span>=</span> <span>handleCronScheduleMisfirePolicy</span><span>(</span>job<span>,</span> cronScheduleBuilder<span>)</span><span>;</span>

        <span>// 按新的cronExpression表达式构建一个新的trigger</span>
        <span>CronTrigger</span> trigger <span>=</span> <span>TriggerBuilder</span><span>.</span><span>newTrigger</span><span>(</span><span>)</span><span>.</span><span>withIdentity</span><span>(</span><span>getTriggerKey</span><span>(</span>jobId<span>,</span> jobGroup<span>)</span><span>)</span>
                <span>.</span><span>withSchedule</span><span>(</span>cronScheduleBuilder<span>)</span><span>.</span><span>build</span><span>(</span><span>)</span><span>;</span>

        <span>// 放入参数，运行时的方法可以获取</span>
        jobDetail<span>.</span><span>getJobDataMap</span><span>(</span><span>)</span><span>.</span><span>put</span><span>(</span><span>ScheduleConstants</span><span>.</span>TASK_PROPERTIES<span>,</span> job<span>)</span><span>;</span>

        <span>// 判断是否存在</span>
        <span>if</span> <span>(</span>scheduler<span>.</span><span>checkExists</span><span>(</span><span>getJobKey</span><span>(</span>jobId<span>,</span> jobGroup<span>)</span><span>)</span><span>)</span> <span>{</span>
            <span>// 防止创建时存在数据问题 先移除，然后在执行创建操作</span>
            scheduler<span>.</span><span>deleteJob</span><span>(</span><span>getJobKey</span><span>(</span>jobId<span>,</span> jobGroup<span>)</span><span>)</span><span>;</span>
        <span>}</span>

        scheduler<span>.</span><span>scheduleJob</span><span>(</span>jobDetail<span>,</span> trigger<span>)</span><span>;</span>

        <span>// 暂停任务</span>
        <span>if</span> <span>(</span>job<span>.</span><span>getStatus</span><span>(</span><span>)</span><span>.</span><span>equals</span><span>(</span><span>ScheduleConstants<span>.</span>Status</span><span>.</span>PAUSE<span>.</span><span>getValue</span><span>(</span><span>)</span><span>)</span><span>)</span> <span>{</span>
            scheduler<span>.</span><span>pauseJob</span><span>(</span><span>ScheduleUtils</span><span>.</span><span>getJobKey</span><span>(</span>jobId<span>,</span> jobGroup<span>)</span><span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>

    <span>/**
     * 设置定时任务策略
     */</span>
    <span>public</span> <span>static</span> <span>CronScheduleBuilder</span> <span>handleCronScheduleMisfirePolicy</span><span>(</span><span>QuartzJob</span> job<span>,</span> <span>CronScheduleBuilder</span> cb<span>)</span>
            <span>throws</span> <span>Exception</span> <span>{</span>
        <span>switch</span> <span>(</span>job<span>.</span><span>getMisfirePolicy</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>case</span> <span>ScheduleConstants</span><span>.</span>MISFIRE_DEFAULT<span>:</span>
                <span>return</span> cb<span>;</span>
            <span>case</span> <span>ScheduleConstants</span><span>.</span>MISFIRE_IGNORE_MISFIRES<span>:</span>
                <span>return</span> cb<span>.</span><span>withMisfireHandlingInstructionIgnoreMisfires</span><span>(</span><span>)</span><span>;</span>
            <span>case</span> <span>ScheduleConstants</span><span>.</span>MISFIRE_FIRE_AND_PROCEED<span>:</span>
                <span>return</span> cb<span>.</span><span>withMisfireHandlingInstructionFireAndProceed</span><span>(</span><span>)</span><span>;</span>
            <span>case</span> <span>ScheduleConstants</span><span>.</span>MISFIRE_DO_NOTHING<span>:</span>
                <span>return</span> cb<span>.</span><span>withMisfireHandlingInstructionDoNothing</span><span>(</span><span>)</span><span>;</span>
            <span>default</span><span>:</span>
                <span>throw</span> <span>new</span> <span>Exception</span><span>(</span><span>"The task misfire policy '"</span> <span>+</span> job<span>.</span><span>getMisfirePolicy</span><span>(</span><span>)</span>
                        <span>+</span> <span>"' cannot be used in cron schedule tasks"</span><span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>这里可以看到，在完成任务与触发器的关联后，如果是暂停状态，会先让调度器停止任务。</p>
<p><code>AbstractQuartzJob</code> 抽象任务：</p>
<div><pre><code><span>public</span> <span>abstract</span> <span>class</span> <span>AbstractQuartzJob</span> <span>implements</span> <span>Job</span> <span>{</span>
    <span>private</span> <span>static</span> <span>final</span> <span>Logger</span> log <span>=</span> <span>LoggerFactory</span><span>.</span><span>getLogger</span><span>(</span><span>AbstractQuartzJob</span><span>.</span><span>class</span><span>)</span><span>;</span>

    <span>/**
     * 线程本地变量
     */</span>
    <span>private</span> <span>static</span> <span>ThreadLocal</span><span><span>&lt;</span><span>Date</span><span>></span></span> threadLocal <span>=</span> <span>new</span> <span>ThreadLocal</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>

    <span>@Override</span>
    <span>public</span> <span>void</span> <span>execute</span><span>(</span><span>JobExecutionContext</span> context<span>)</span> <span>throws</span> <span>JobExecutionException</span> <span>{</span>
        <span>QuartzJob</span> job <span>=</span> <span>new</span> <span>QuartzJob</span><span>(</span><span>)</span><span>;</span>
        <span>BeanUtils</span><span>.</span><span>copyBeanProp</span><span>(</span>job<span>,</span> context<span>.</span><span>getMergedJobDataMap</span><span>(</span><span>)</span><span>.</span><span>get</span><span>(</span><span>ScheduleConstants</span><span>.</span>TASK_PROPERTIES<span>)</span><span>)</span><span>;</span>
        <span>try</span> <span>{</span>
            <span>before</span><span>(</span>context<span>,</span> job<span>)</span><span>;</span>
            <span>if</span> <span>(</span>job <span>!=</span> <span>null</span><span>)</span> <span>{</span>
                <span>doExecute</span><span>(</span>context<span>,</span> job<span>)</span><span>;</span>
            <span>}</span>
            <span>after</span><span>(</span>context<span>,</span> job<span>,</span> <span>null</span><span>)</span><span>;</span>
        <span>}</span> <span>catch</span> <span>(</span><span>Exception</span> e<span>)</span> <span>{</span>
            log<span>.</span><span>error</span><span>(</span><span>"任务执行异常  - ："</span><span>,</span> e<span>)</span><span>;</span>
            <span>after</span><span>(</span>context<span>,</span> job<span>,</span> e<span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>

    <span>/**
     * 执行前
     *
     * <span>@param</span> <span>context</span> 工作执行上下文对象
     * <span>@param</span> <span>job</span>     系统计划任务
     */</span>
    <span>protected</span> <span>void</span> <span>before</span><span>(</span><span>JobExecutionContext</span> context<span>,</span> <span>QuartzJob</span> job<span>)</span> <span>{</span>
        threadLocal<span>.</span><span>set</span><span>(</span><span>new</span> <span>Date</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 执行后
     *
     * <span>@param</span> <span>context</span> 工作执行上下文对象
     * <span>@param</span> <span>sysJob</span>  系统计划任务
     */</span>
    <span>protected</span> <span>void</span> <span>after</span><span>(</span><span>JobExecutionContext</span> context<span>,</span> <span>QuartzJob</span> sysJob<span>,</span> <span>Exception</span> e<span>)</span> <span>{</span>

    <span>}</span>

    <span>/**
     * 执行方法，由子类重载
     *
     * <span>@param</span> <span>context</span> 工作执行上下文对象
     * <span>@param</span> <span>job</span>     系统计划任务
     * <span>@throws</span> <span><span>Exception</span></span> 执行过程中的异常
     */</span>
    <span>protected</span> <span>abstract</span> <span>void</span> <span>doExecute</span><span>(</span><span>JobExecutionContext</span> context<span>,</span> <span>QuartzJob</span> job<span>)</span> <span>throws</span> <span>Exception</span><span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><blockquote>
<p>这个类将原本 <code>execute</code> 方法执行的任务，下放到了子类重载的 <code>doExecute</code> 方法中</p>
</blockquote>
<p>同时准备实现，分了允许并发和不允许并发，差别就是一个注解：</p>
<div><pre><code><span>public</span> <span>class</span> <span>QuartzJobExecution</span> <span>extends</span> <span>AbstractQuartzJob</span> <span>{</span>
    <span>@Override</span>
    <span>protected</span> <span>void</span> <span>doExecute</span><span>(</span><span>JobExecutionContext</span> context<span>,</span> <span>QuartzJob</span> job<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
        <span>JobInvokeUtil</span><span>.</span><span>invokeMethod</span><span>(</span>job<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
<span>@DisallowConcurrentExecution</span>
<span>public</span> <span>class</span> <span>QuartzDisallowConcurrentExecution</span> <span>extends</span> <span>AbstractQuartzJob</span> <span>{</span>
    <span>@Override</span>
    <span>protected</span> <span>void</span> <span>doExecute</span><span>(</span><span>JobExecutionContext</span> context<span>,</span> <span>QuartzJob</span> job<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
        <span>JobInvokeUtil</span><span>.</span><span>invokeMethod</span><span>(</span>job<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>最后由 <code>JobInvokeUtil</code> 通过反射，进行实际的方法调用：</p>
<div><pre><code><span>public</span> <span>class</span> <span>JobInvokeUtil</span> <span>{</span>
    <span>/**
     * 执行方法
     *
     * <span>@param</span> <span>job</span> 系统任务
     */</span>
    <span>public</span> <span>static</span> <span>void</span> <span>invokeMethod</span><span>(</span><span>QuartzJob</span> job<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
        <span>String</span> invokeTarget <span>=</span> job<span>.</span><span>getInvokeTarget</span><span>(</span><span>)</span><span>;</span>
        <span>String</span> beanName <span>=</span> <span>getBeanName</span><span>(</span>invokeTarget<span>)</span><span>;</span>
        <span>String</span> methodName <span>=</span> <span>getMethodName</span><span>(</span>invokeTarget<span>)</span><span>;</span>
        <span>List</span><span>&lt;</span><span>Object</span><span>[</span><span>]</span><span>></span> methodParams <span>=</span> <span>getMethodParams</span><span>(</span>invokeTarget<span>)</span><span>;</span>

        <span>if</span> <span>(</span><span>!</span><span>isValidClassName</span><span>(</span>beanName<span>)</span><span>)</span> <span>{</span>
            <span>Object</span> bean <span>=</span> <span>SpringUtils</span><span>.</span><span>getBean</span><span>(</span>beanName<span>)</span><span>;</span>
            <span>invokeMethod</span><span>(</span>bean<span>,</span> methodName<span>,</span> methodParams<span>)</span><span>;</span>
        <span>}</span> <span>else</span> <span>{</span>
            <span>Object</span> bean <span>=</span> <span>Class</span><span>.</span><span>forName</span><span>(</span>beanName<span>)</span><span>.</span><span>newInstance</span><span>(</span><span>)</span><span>;</span>
            <span>invokeMethod</span><span>(</span>bean<span>,</span> methodName<span>,</span> methodParams<span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>

    <span>/**
     * 调用任务方法
     *
     * <span>@param</span> <span>bean</span>         目标对象
     * <span>@param</span> <span>methodName</span>   方法名称
     * <span>@param</span> <span>methodParams</span> 方法参数
     */</span>
    <span>private</span> <span>static</span> <span>void</span> <span>invokeMethod</span><span>(</span><span>Object</span> bean<span>,</span> <span>String</span> methodName<span>,</span> <span>List</span><span>&lt;</span><span>Object</span><span>[</span><span>]</span><span>></span> methodParams<span>)</span>
            <span>throws</span> <span>NoSuchMethodException</span><span>,</span> <span>SecurityException</span><span>,</span> <span>IllegalAccessException</span><span>,</span> <span>IllegalArgumentException</span><span>,</span>
            <span>InvocationTargetException</span> <span>{</span>
        <span>if</span> <span>(</span><span>StringUtils</span><span>.</span><span>isNotNull</span><span>(</span>methodParams<span>)</span> <span>&amp;&amp;</span> methodParams<span>.</span><span>size</span><span>(</span><span>)</span> <span>></span> <span>0</span><span>)</span> <span>{</span>
            <span>Method</span> method <span>=</span> bean<span>.</span><span>getClass</span><span>(</span><span>)</span><span>.</span><span>getDeclaredMethod</span><span>(</span>methodName<span>,</span> <span>getMethodParamsType</span><span>(</span>methodParams<span>)</span><span>)</span><span>;</span>
            method<span>.</span><span>invoke</span><span>(</span>bean<span>,</span> <span>getMethodParamsValue</span><span>(</span>methodParams<span>)</span><span>)</span><span>;</span>
        <span>}</span> <span>else</span> <span>{</span>
            <span>Method</span> method <span>=</span> bean<span>.</span><span>getClass</span><span>(</span><span>)</span><span>.</span><span>getDeclaredMethod</span><span>(</span>methodName<span>)</span><span>;</span>
            method<span>.</span><span>invoke</span><span>(</span>bean<span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>

    <span>/**
     * 校验是否为为class包名
     *
     * <span>@param</span> <span>invokeTarget</span> 名称
     * <span>@return</span> true是 false否
     */</span>
    <span>public</span> <span>static</span> <span>boolean</span> <span>isValidClassName</span><span>(</span><span>String</span> invokeTarget<span>)</span> <span>{</span>
        <span>return</span> <span>StringUtils</span><span>.</span><span>countMatches</span><span>(</span>invokeTarget<span>,</span> <span>"."</span><span>)</span> <span>></span> <span>1</span><span>;</span>
    <span>}</span>

    <span>/**
     * 获取bean名称
     *
     * <span>@param</span> <span>invokeTarget</span> 目标字符串
     * <span>@return</span> bean名称
     */</span>
    <span>public</span> <span>static</span> <span>String</span> <span>getBeanName</span><span>(</span><span>String</span> invokeTarget<span>)</span> <span>{</span>
        <span>String</span> beanName <span>=</span> <span>StringUtils</span><span>.</span><span>substringBefore</span><span>(</span>invokeTarget<span>,</span> <span>"("</span><span>)</span><span>;</span>
        <span>return</span> <span>StringUtils</span><span>.</span><span>substringBeforeLast</span><span>(</span>beanName<span>,</span> <span>"."</span><span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 获取bean方法
     *
     * <span>@param</span> <span>invokeTarget</span> 目标字符串
     * <span>@return</span> method方法
     */</span>
    <span>public</span> <span>static</span> <span>String</span> <span>getMethodName</span><span>(</span><span>String</span> invokeTarget<span>)</span> <span>{</span>
        <span>String</span> methodName <span>=</span> <span>StringUtils</span><span>.</span><span>substringBefore</span><span>(</span>invokeTarget<span>,</span> <span>"("</span><span>)</span><span>;</span>
        <span>return</span> <span>StringUtils</span><span>.</span><span>substringAfterLast</span><span>(</span>methodName<span>,</span> <span>"."</span><span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 获取method方法参数相关列表
     *
     * <span>@param</span> <span>invokeTarget</span> 目标字符串
     * <span>@return</span> method方法相关参数列表
     */</span>
    <span>public</span> <span>static</span> <span>List</span><span>&lt;</span><span>Object</span><span>[</span><span>]</span><span>></span> <span>getMethodParams</span><span>(</span><span>String</span> invokeTarget<span>)</span> <span>{</span>
        <span>String</span> methodStr <span>=</span> <span>StringUtils</span><span>.</span><span>substringBetween</span><span>(</span>invokeTarget<span>,</span> <span>"("</span><span>,</span> <span>")"</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span><span>StringUtils</span><span>.</span><span>isEmpty</span><span>(</span>methodStr<span>)</span><span>)</span> <span>{</span>
            <span>return</span> <span>null</span><span>;</span>
        <span>}</span>
        <span>String</span><span>[</span><span>]</span> methodParams <span>=</span> methodStr<span>.</span><span>split</span><span>(</span><span>","</span><span>)</span><span>;</span>
        <span>List</span><span>&lt;</span><span>Object</span><span>[</span><span>]</span><span>></span> classs <span>=</span> <span>new</span> <span>LinkedList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
        <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> methodParams<span>.</span>length<span>;</span> i<span>++</span><span>)</span> <span>{</span>
            <span>String</span> str <span>=</span> <span>StringUtils</span><span>.</span><span>trimToEmpty</span><span>(</span>methodParams<span>[</span>i<span>]</span><span>)</span><span>;</span>
            <span>// String字符串类型，包含'</span>
            <span>if</span> <span>(</span><span>StringUtils</span><span>.</span><span>contains</span><span>(</span>str<span>,</span> <span>"'"</span><span>)</span><span>)</span> <span>{</span>
                classs<span>.</span><span>add</span><span>(</span><span>new</span> <span>Object</span><span>[</span><span>]</span><span>{</span><span>StringUtils</span><span>.</span><span>replace</span><span>(</span>str<span>,</span> <span>"'"</span><span>,</span> <span>""</span><span>)</span><span>,</span> <span>String</span><span>.</span><span>class</span><span>}</span><span>)</span><span>;</span>
            <span>}</span>
            <span>// boolean布尔类型，等于true或者false</span>
            <span>else</span> <span>if</span> <span>(</span><span>StringUtils</span><span>.</span><span>equals</span><span>(</span>str<span>,</span> <span>"true"</span><span>)</span> <span>||</span> <span>StringUtils</span><span>.</span><span>equalsIgnoreCase</span><span>(</span>str<span>,</span> <span>"false"</span><span>)</span><span>)</span> <span>{</span>
                classs<span>.</span><span>add</span><span>(</span><span>new</span> <span>Object</span><span>[</span><span>]</span><span>{</span><span>Boolean</span><span>.</span><span>valueOf</span><span>(</span>str<span>)</span><span>,</span> <span>Boolean</span><span>.</span><span>class</span><span>}</span><span>)</span><span>;</span>
            <span>}</span>
            <span>// long长整形，包含L</span>
            <span>else</span> <span>if</span> <span>(</span><span>StringUtils</span><span>.</span><span>containsIgnoreCase</span><span>(</span>str<span>,</span> <span>"L"</span><span>)</span><span>)</span> <span>{</span>
                classs<span>.</span><span>add</span><span>(</span><span>new</span> <span>Object</span><span>[</span><span>]</span><span>{</span><span>Long</span><span>.</span><span>valueOf</span><span>(</span><span>StringUtils</span><span>.</span><span>replaceIgnoreCase</span><span>(</span>str<span>,</span> <span>"L"</span><span>,</span> <span>""</span><span>)</span><span>)</span><span>,</span> <span>Long</span><span>.</span><span>class</span><span>}</span><span>)</span><span>;</span>
            <span>}</span>
            <span>// double浮点类型，包含D</span>
            <span>else</span> <span>if</span> <span>(</span><span>StringUtils</span><span>.</span><span>containsIgnoreCase</span><span>(</span>str<span>,</span> <span>"D"</span><span>)</span><span>)</span> <span>{</span>
                classs<span>.</span><span>add</span><span>(</span><span>new</span> <span>Object</span><span>[</span><span>]</span><span>{</span><span>Double</span><span>.</span><span>valueOf</span><span>(</span><span>StringUtils</span><span>.</span><span>replaceIgnoreCase</span><span>(</span>str<span>,</span> <span>"D"</span><span>,</span> <span>""</span><span>)</span><span>)</span><span>,</span> <span>Double</span><span>.</span><span>class</span><span>}</span><span>)</span><span>;</span>
            <span>}</span>
            <span>// 其他类型归类为整形</span>
            <span>else</span> <span>{</span>
                classs<span>.</span><span>add</span><span>(</span><span>new</span> <span>Object</span><span>[</span><span>]</span><span>{</span><span>Integer</span><span>.</span><span>valueOf</span><span>(</span>str<span>)</span><span>,</span> <span>Integer</span><span>.</span><span>class</span><span>}</span><span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
        <span>return</span> classs<span>;</span>
    <span>}</span>

    <span>/**
     * 获取参数类型
     *
     * <span>@param</span> <span>methodParams</span> 参数相关列表
     * <span>@return</span> 参数类型列表
     */</span>
    <span>public</span> <span>static</span> <span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span><span>[</span><span>]</span> <span>getMethodParamsType</span><span>(</span><span>List</span><span>&lt;</span><span>Object</span><span>[</span><span>]</span><span>></span> methodParams<span>)</span> <span>{</span>
        <span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span><span>[</span><span>]</span> classs <span>=</span> <span>new</span> <span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span><span>[</span>methodParams<span>.</span><span>size</span><span>(</span><span>)</span><span>]</span><span>;</span>
        <span>int</span> index <span>=</span> <span>0</span><span>;</span>
        <span>for</span> <span>(</span><span>Object</span><span>[</span><span>]</span> os <span>:</span> methodParams<span>)</span> <span>{</span>
            classs<span>[</span>index<span>]</span> <span>=</span> <span>(</span><span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span><span>)</span> os<span>[</span><span>1</span><span>]</span><span>;</span>
            index<span>++</span><span>;</span>
        <span>}</span>
        <span>return</span> classs<span>;</span>
    <span>}</span>

    <span>/**
     * 获取参数值
     *
     * <span>@param</span> <span>methodParams</span> 参数相关列表
     * <span>@return</span> 参数值列表
     */</span>
    <span>public</span> <span>static</span> <span>Object</span><span>[</span><span>]</span> <span>getMethodParamsValue</span><span>(</span><span>List</span><span>&lt;</span><span>Object</span><span>[</span><span>]</span><span>></span> methodParams<span>)</span> <span>{</span>
        <span>Object</span><span>[</span><span>]</span> classs <span>=</span> <span>new</span> <span>Object</span><span>[</span>methodParams<span>.</span><span>size</span><span>(</span><span>)</span><span>]</span><span>;</span>
        <span>int</span> index <span>=</span> <span>0</span><span>;</span>
        <span>for</span> <span>(</span><span>Object</span><span>[</span><span>]</span> os <span>:</span> methodParams<span>)</span> <span>{</span>
            classs<span>[</span>index<span>]</span> <span>=</span> <span>(</span><span>Object</span><span>)</span> os<span>[</span><span>0</span><span>]</span><span>;</span>
            index<span>++</span><span>;</span>
        <span>}</span>
        <span>return</span> classs<span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>启动程序后可以看到，调度器已经启动：</p>
<div><pre><code>2021-10-06 16:26:05.162  INFO 10764 --- [shivaScheduler]] o.s.s.quartz.SchedulerFactoryBean        : Starting Quartz Scheduler now, after delay of 1 seconds
2021-10-06 16:26:05.306  INFO 10764 --- [shivaScheduler]] org.quartz.core.QuartzScheduler          : Scheduler shivaScheduler_$_DESKTOP-OKMJ1351633508761366 started.
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h2 id="_13新增调度任务" tabindex="-1"> 13新增调度任务</h2>
<p>添加任务，使用如下 json 进行请求：</p>
<div><pre><code><span>{</span>
  <span>"concurrent"</span><span>:</span> <span>"1"</span><span>,</span>
  <span>"cronExpression"</span><span>:</span> <span>"0/10 * * * * ?"</span><span>,</span>
  <span>"invokeTarget"</span><span>:</span> <span>"mysqlJob.execute('got it!!!')"</span><span>,</span>
  <span>"jobGroup"</span><span>:</span> <span>"mysqlGroup"</span><span>,</span>
  <span>"jobId"</span><span>:</span> <span>9</span><span>,</span>
  <span>"jobName"</span><span>:</span> <span>"新增 mysqlJob 任务"</span><span>,</span>
  <span>"misfirePolicy"</span><span>:</span> <span>"1"</span><span>,</span>
  <span>"remark"</span><span>:</span> <span>""</span><span>,</span>
  <span>"status"</span><span>:</span> <span>"0"</span>
<span>}</span>
<span>@Override</span>
<span>@Transactional</span><span>(</span>rollbackFor <span>=</span> <span>Exception</span><span>.</span><span>class</span><span>)</span>
<span>public</span> <span>int</span> <span>insertJob</span><span>(</span><span>QuartzJob</span> job<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
    <span>// 先将任务设置为暂停状态</span>
    job<span>.</span><span>setStatus</span><span>(</span><span>ScheduleConstants<span>.</span>Status</span><span>.</span>PAUSE<span>.</span><span>getValue</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>int</span> rows <span>=</span> quartzMapper<span>.</span><span>insert</span><span>(</span>job<span>)</span><span>;</span>
    <span>if</span> <span>(</span>rows <span>></span> <span>0</span><span>)</span> <span>{</span>
        <span>ScheduleUtils</span><span>.</span><span>createScheduleJob</span><span>(</span>scheduler<span>,</span> job<span>)</span><span>;</span>
    <span>}</span>
    <span>return</span> rows<span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>先将任务设置为暂停状态，数据库插入成功后，在调度器创建任务。</p>
<p>再手动启动任务，根据 ID 来启动任务：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16535411548296.png" alt="图片" loading="lazy"></p>
<p>实现代码：</p>
<div><pre><code><span>@Override</span>
    <span>public</span> <span>int</span> <span>changeStatus</span><span>(</span><span>Long</span> jobId<span>,</span> <span>String</span> status<span>)</span> <span>throws</span> <span>SchedulerException</span> <span>{</span>
        <span>int</span> rows <span>=</span> quartzMapper<span>.</span><span>changeStatus</span><span>(</span>jobId<span>,</span> status<span>)</span><span>;</span>
        <span>if</span> <span>(</span>rows <span>==</span> <span>0</span><span>)</span> <span>{</span>
            <span>return</span> rows<span>;</span>
        <span>}</span>
        <span>//更新成功，需要改调度器内任务的状态</span>
        <span>//拿到整个任务</span>
        <span>QuartzJob</span> job <span>=</span> quartzMapper<span>.</span><span>selectJobById</span><span>(</span>jobId<span>)</span><span>;</span>
        <span>//根据状态来启动或者关闭</span>
        <span>if</span> <span>(</span><span>ScheduleConstants<span>.</span>Status</span><span>.</span>NORMAL<span>.</span><span>getValue</span><span>(</span><span>)</span><span>.</span><span>equals</span><span>(</span>status<span>)</span><span>)</span> <span>{</span>
            rows <span>=</span> <span>resumeJob</span><span>(</span>job<span>)</span><span>;</span>
        <span>}</span> <span>else</span> <span>if</span> <span>(</span><span>ScheduleConstants<span>.</span>Status</span><span>.</span>PAUSE<span>.</span><span>getValue</span><span>(</span><span>)</span><span>.</span><span>equals</span><span>(</span>status<span>)</span><span>)</span> <span>{</span>
            rows <span>=</span> <span>pauseJob</span><span>(</span>job<span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> rows<span>;</span>
    <span>}</span>
<span>@Override</span>
<span>public</span> <span>int</span> <span>resumeJob</span><span>(</span><span>QuartzJob</span> job<span>)</span> <span>throws</span> <span>SchedulerException</span> <span>{</span>
    <span>Long</span> jobId <span>=</span> job<span>.</span><span>getJobId</span><span>(</span><span>)</span><span>;</span>
    <span>String</span> jobGroup <span>=</span> job<span>.</span><span>getJobGroup</span><span>(</span><span>)</span><span>;</span>
    job<span>.</span><span>setStatus</span><span>(</span><span>ScheduleConstants<span>.</span>Status</span><span>.</span>NORMAL<span>.</span><span>getValue</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>int</span> rows <span>=</span> quartzMapper<span>.</span><span>updateById</span><span>(</span>job<span>)</span><span>;</span>
    <span>if</span> <span>(</span>rows <span>></span> <span>0</span><span>)</span> <span>{</span>
        scheduler<span>.</span><span>resumeJob</span><span>(</span><span>ScheduleUtils</span><span>.</span><span>getJobKey</span><span>(</span>jobId<span>,</span> jobGroup<span>)</span><span>)</span><span>;</span>
    <span>}</span>
    <span>return</span> rows<span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>暂停任务的代码也相同。</p>
<p>调用启动后可以看到控制台打印日志：</p>
<div><pre><code>2021-10-06 20:36:30.018  INFO 8536 --- [eduler_Worker-3] cn.shiva.quartz.job.MysqlJob             : 执行 Mysql Job，当前时间：2021-10-06 20:36:30，任务参数：got it!!!
2021-10-06 20:36:40.016  INFO 8536 --- [eduler_Worker-4] cn.shiva.quartz.job.MysqlJob             : 执行 Mysql Job，当前时间：2021-10-06 20:36:40，任务参数：got it!!!
2021-10-06 20:36:50.017  INFO 8536 --- [eduler_Worker-5] cn.shiva.quartz.job.MysqlJob             : 执行 Mysql Job，当前时间：2021-10-06 20:36:50，任务参数：got it!!!
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>如果涉及到任务修改，需要在调度器先删除原有任务，重新创建调度任务。</p>
<h3 id="启动初始化任务" tabindex="-1"> 启动初始化任务</h3>
<p>这部分倒是比较简单，初始化的时候清空原有任务，重新创建就好了：</p>
<div><pre><code><span>/**
  * 项目启动时，初始化定时器 主要是防止手动修改数据库导致未同步到定时任务处理（注：不能手动修改数据库ID和任务组名，否则会导致脏数据）
  */</span>
<span>@PostConstruct</span>
<span>public</span> <span>void</span> <span>init</span><span>(</span><span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
    scheduler<span>.</span><span>clear</span><span>(</span><span>)</span><span>;</span>
    <span>List</span><span><span>&lt;</span><span>QuartzJob</span><span>></span></span> jobList <span>=</span> quartzMapper<span>.</span><span>selectJobAll</span><span>(</span><span>)</span><span>;</span>
    <span>for</span> <span>(</span><span>QuartzJob</span> job <span>:</span> jobList<span>)</span> <span>{</span>
        <span>ScheduleUtils</span><span>.</span><span>createScheduleJob</span><span>(</span>scheduler<span>,</span> job<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="_14其他说明" tabindex="-1"> 14其他说明</h2>
<h3 id="并发执行" tabindex="-1"> 并发执行</h3>
<p>上面有并发和非并发的区别，通过 <code>@DisallowConcurrentExecution</code> 注解来实现阻止并发。</p>
<p>Quartz定时任务默认都是并发执行的，不会等待上一次任务执行完毕，只要间隔时间到就会执行, 如果定时任执行太长，会长时间占用资源，导致其它任务堵塞。</p>
<p><code>@DisallowConcurrentExecution</code> 禁止并发执行多个相同定义的JobDetail, 这个注解是加在Job类上的, 但意思并不是不能同时执行多个Job, 而是不能并发执行同一个<code>Job Definition</code>(由JobDetail定义), 但是可以同时执行多个不同的JobDetail。</p>
<p>举例说明，我们有一个Job类,叫做SayHelloJob, 并在这个Job上加了这个注解, 然后在这个Job上定义了很多个<code>JobDetail</code>, <code>如sayHelloToJoeJobDetail</code>, <code>sayHelloToMikeJobDetail</code>, 那么当scheduler启动时, 不会并发执行多个<code>sayHelloToJoeJobDetail</code>或者<code>sayHelloToMikeJobDetail</code>, 但可以同时执行<code>sayHelloToJoeJobDetail</code>跟<code>sayHelloToMikeJobDetail</code></p>
<p><code>@PersistJobDataAfterExecution</code> 同样, 也是加在Job上。表示当正常执行完Job后, JobDataMap中的数据应该被改动, 以被下一次调用时用。</p>
<p>当使用 <code>@PersistJobDataAfterExecution</code> 注解时, 为了避免并发时, 存储数据造成混乱, 强烈建议把 <code>@DisallowConcurrentExecution</code> 注解也加上。</p>
<p>测试代码，设定的时间间隔为3秒,但job执行时间是5秒,设置 <code>@DisallowConcurrentExecution</code>以 后程序会等任务执行完毕以后再去执行,否则会在3秒时再启用新的线程执行。</p>
<h3 id="阻止特定时间运行" tabindex="-1"> 阻止特定时间运行</h3>
<p>仍然是通过调度器实现的：</p>
<div><pre><code><span>//2014-8-15这一天不执行任何任务</span>
<span>Calendar</span> c <span>=</span> <span>new</span> <span>GregorianCalendar</span><span>(</span><span>2014</span><span>,</span> <span>7</span><span>,</span> <span>15</span><span>)</span><span>;</span>
cal<span>.</span><span>setDayExcluded</span><span>(</span>c<span>,</span> <span>true</span><span>)</span><span>;</span>
scheduler<span>.</span><span>addCalendar</span><span>(</span><span>"exclude"</span><span>,</span> cal<span>,</span> <span>false</span><span>,</span> <span>false</span><span>)</span><span>;</span>

<span>//...中间省略</span>
<span>TriggerBuilder</span><span>.</span><span>newTrigger</span><span>(</span><span>)</span><span>.</span><span>modifiedByCalendar</span><span>(</span><span>"exclude"</span><span>)</span><span>.</span><span>.</span><span>.</span><span>.</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-06-01T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Java 命名规范</title>
    <id>https://blog.ciberviler.top/dev/Java%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83.html</id>
    <link href="https://blog.ciberviler.top/dev/Java%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83.html"/>
    <updated>2022-05-26T03:43:23.000Z</updated>
    <content type="html"><![CDATA[<h1 id="java-命名规范" tabindex="-1"> Java 命名规范</h1>
<p>在本文中，将从大到小，从外到内，总结Java编程中的命名规范。文中将会涉及到日常工作中常见的命名示例，如包命名，类命名，接口命名，方法命名，变量命名，常类命名，抽象类命名，异常类命名以及扩展类命名等。我将按照项目工程目录结构，从包，类(接口，抽象类，异常类)，方法，变量和常量的顺序展开介绍。</p>
<p>本文是 Java 命名规范的介绍，建议收藏转发。更多文章可以关注公众号「Java后端」自行搜索。</p>
<h2 id="_1-包命名规范" tabindex="-1"> <strong>1. 包命名规范</strong></h2>
<p>包(Package)的作用是将功能相似或相关的类或者接口进行分组管理，便于类的定位和查找，同时也可以使用包来避免类名的冲突和访问控制，使代码更容易维护。通常，包命使用小写英文字母进行命名，并使用“.”进行分割，每个被分割的单元只能包含一个名词。</p>
<p>一般地，包命名常采用顶级域名作为前缀，例如com，net，org，edu，gov，cn，io等，随后紧跟公司/组织/个人名称以及功能模块名称。下面是一些包命名示例：</p>
<div><pre><code>package org.springframework.boot.autoconfigure.cloud
package org.springframework.boot.util
package org.hibernate.action
package org.hibernate.cfg
package com.alibaba.druid
package com.alibaba.druid.filter
package com.alibaba.nacos.client.config
package com.ramostear.blog.web
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>下面是Oracle Java的一些常见包命名例子：</p>
<div><pre><code>package java.beans
package java.io
package java.lang
package java.net
package java.util
package javax.annotation
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="_2-类命名规范" tabindex="-1"> <strong>2. 类命名规范</strong></h2>
<p>类(Class)通常采用名词进行命名，且首字母大写，如果一个类名包含两个以上名词，建议使用驼峰命名(Camel-Case)法书写类名,每个名词首字母也应该大写。一般地，类名的书写尽量使其保持简单和描述的完整性，因此在书写类名时不建议使用缩写(一些约定俗成的命名除外。</p>
<p>例如 Internationalization and Localization 缩写成i18n，Uniform Resource Identifier缩写成URI，Data Access Object缩写成DAO，JSON Web Token缩写成JWT，HyperText Markup Language缩写成HTML等等)。下列是一些常见的类命名示例：</p>
<div><pre><code>public class UserDTO{

}
class EmployeeService{
    
}
class StudentDAO{
    
}
class OrderItemEntity{
    
}
public class UserServiceImpl{
    
}
public class OrderItemController{
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>下面是 Oracle Java 中的一些标准命名示例：</p>
<div><pre><code>public class HTMLEditorKit{
    
}
public abstract class HttpContext{
    
}
public interface ImageObserver{
    
}
public class ArrayIndexOutOfBoundsException{
    
}
public class enum Thread.State{
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_2-1-接口命名规范" tabindex="-1"> <strong>2.1 接口命名规范</strong></h3>
<p>首先，接口(Interface)是一种表述某一类型对象动作的特殊类；简单来说，接口也是类(不太严谨)，所以，接口的名称的书写也应该符合类名书写规范，首字母应该大写，与普通类名不同的是，接口命名时通常采用形容词或动词来描述接口的动作行为。下列是Oracle Java中一些标准库的接口使用形容词命名示例：</p>
<div><pre><code>public interface Closeable{
    
}
public interface Cloneable{
    
}
public interface Runnable{
    
}
public interface Comparable&lt;T>{
    
}
public interface CompletionService&lt;V>{
    
}
public interface Iterable&lt;T>{
    
}
public interface EventListener{
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>在Spring Framework标准库中，通常采用名词+动词/形容词的组合方式来命名接口，下列是Spring Framework中一些接口命名示例：</p>
<div><pre><code>public interface AfterAdvice{
    
}
public interface TargetClassAware{
    
}
public interface ApplicationContextAware{
    
}
public interface MessageSourceResolvable{
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>2.2 抽象类命名规范</strong></p>
<p>抽象类(Abstract Class)是一种特殊的类，其命名与普通类的命名规范相当。一般地，为了将抽象类与普通类和接口做出区别，提高抽象类的可读性，在命名抽象类时，会以“Abstract”/“Base”作为类命的前缀。下面是编程中一些常规的命名示例：</p>
<div><pre><code>public abstract class AbstractRepository&lt;T>{
    
}
public abstract class AbstractController{
    
}
public abstract class BaseDao&lt;T,ID>{
    
}
public abstract class AbstractCommonService&lt;T>{
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>以下是Spring Framework中常见的抽象类示例：</p>
<div><pre><code>public abstract class AbstractAspectJAdvice{
    
}
public abstract class AbstractSingletonProxyFactoryBean{
    
}
public abstract class AbstractBeanFactoryPointcutAdvisor{
    
}
public abstract class AbstractCachingConfiguration{
    
}
public abstract class AbstractContextLoaderInitializer{
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>2.3 异常类命名规范</strong></p>
<p>异常类(Exception Class)也是类的一种，但与普通类命名不同的是，异常类在命名时需要使用“Exception”作为其后缀。下面是常见的异常类命名示例：</p>
<div><pre><code>public class FileNotFoundException{
    
}
public class UserAlreadyExistException{
    
}
public class TransactionException{
    
}
public class ClassNotFoundException{
    
}
public class IllegalArgumentException{
    
}
public class IndexOutOfBoundsException{
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>另外，在Java中还有另外一类异常类，它们属于系统异常，这一类异常类的命名使用“Error”作为其后缀，以区分Exception(编码，环境，操作等异常)。下面是系统异常(非检查异常)的命名示例：</p>
<div><pre><code>public abstract class VirtualMachineError{
    
}
public class StackOverflowError{
    
}
public class OutOfMemoryError{
    
}
public class IllegalAccessError{
    
}
public class NoClassDefFoundError{
    
}
public class NoSuchFieldError{
    
}
public class NoSuchMethodError{
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>3.方法命名规范</strong></p>
<p>方法(Method)命名时,其首字母应该小写，如果方法签名由多个单词组成，则从第二个单词起，使用驼峰命名法进行书写。一般地，在对方法进行命名时，通常采用动词/动词+名词的组合，下面是方法命名的一些常见示例。</p>
<h3 id="_3-1-表述获取" tabindex="-1"> <strong>3.1 表述获取</strong></h3>
<p>如果一个方法用于获取某个值，通常使用“get”作为其前缀，例如：</p>
<div><pre><code>public String getUserName(){
    
}
public List&lt;Integer> getUserIds(){
    
}
public User getOne(){
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>3.2 表述查询</strong></p>
<p>如果方法需要通过查询或筛选的方式获取某个数据，通常使用“find”/“query”作为其前缀，例如：</p>
<div><pre><code>public List&lt;User> findOne(Integer id){
    
}
public List&lt;Integer> findAll(){
    
}
public List&lt;String> queryOrders(){
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_3-3-表述条件" tabindex="-1"> <strong>3.3 表述条件</strong></h3>
<p>如果一个方法需要一些条件参数，则可以使用“by”/“with”等字符作为方法名中条件的连接符，例如：</p>
<div><pre><code>public User findByUsername(String username){
    
}
public List&lt;Integer> getUserIdsWithState(boolean state){
    
}
public List&lt;User> findAllByUsernameOrderByIdDesc(String username){
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>3.4 表述设置</strong></p>
<p>如果一个方法是要设置，插入，修改，删除等操作，应该将对应的动词(set,insert,update,delete)作为其名词的前缀，例如：</p>
<div><pre><code>public void setName(String name){
    
}
public User insert(User user){
    
}
public void update(User user){
    
}
public void clearAll(){
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>3.5 其他规范</strong></p>
<p>如果一个方法用于获取某组数据的长度或数量，则该方法应该使用length或size命名；如果方法的返回值为布尔类型(Boolean)，则该方法应该使用“is”或”has”作为前缀；</p>
<p>如果方法用于将一种类型的数据转换为另一种数据数类型，则可以使用“to”作为前缀。下面是综合示例：</p>
<div><pre><code>public long length(){
    
}
public int size(){
    
}
public boolean isOpen(){
    
}
public boolean isNotEmpty(){
    
}
public boolean hasLength(){
    
}
public Set&lt;Integer> mapToSet(Map map){
    
}
public UserDto convertTo(User user){
    
}
public String toString(Object obj){
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>4. 变量命名规范</strong></p>
<p>变量(Variable)命名包括参数名称，成员变量和局部变量。变量命名通常以小写字母开头，如果变量名由多个单词构成，则从第二个单词起首字母需要大写，在变量命名过程中，不建议使用“_”作为前缀或者单词之间的分割符号。下面是一些常见的变量命名示例：</p>
<div><pre><code>private String nickName;
private String mobileNumber;
private Long id;
private String username;
private Long orderId;
private Long orderItemId;
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>\5. 常量命名规范</p>
<p>一般地，常量名称采用全部大写的英文单词书写，如果常量名称由多个单词组成，则单词之间统一使用“_”进行分割，下面是常量命名示例：</p>
<div><pre><code>public static final String LOGIN_USER_SESSION_KEY = "current_login_user";
public static final int MAX_AGE_VALUE = 120;
public static final int DEFAULT_PAGE_NO = 1;
public static final long MAX_PAGE_SIZE = 1000;
public static final boolean HAS_LICENSE = false;
public static final boolean IS_CHECKED = false;
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="_6-枚举命名规范" tabindex="-1"> <strong>6. 枚举命名规范</strong></h2>
<p>枚举(Enum)类是一种特殊的类，其命名规范遵循普通类的命名约束条件，首字母大写，采用驼峰命名法；枚举类中定义的值的名称遵循常量的命名规范，且枚举值的名称需要与类名有一定的关联性，下面是枚举的一些示例：</p>
<div><pre><code>public enum Color{
    RED,YELLOW,BLUE,GREEN,WHITE;
}
public enum PhysicalSize{
    TINY,SMALL,MEDIUM,LARGE,HUGE,GIGANTIC;
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>下面是Oracle Java标准库中的一个示例：</p>
<div><pre><code>public enum ElementType{
    TYPE,
    FIELD,
    METHOD,
    PARAMETER,
    CONSTRUCTOR,
    LOCAL_VARIABLE,
    ANNOTATION_TYPE,
    PACKAGE,
    TYPE_PARAMETER,
    TYPE_USE;
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="_7-其他命名规范" tabindex="-1"> <strong>7. 其他命名规范</strong></h2>
<h3 id="_7-1-数组" tabindex="-1"> <strong>7.1 数组</strong></h3>
<p>在定义数组时，为了便于阅读，尽量保持以下的书写规范：</p>
<div><pre><code>int[] array = new int[10];
int[] idArray ={1,2,3,4,5};
String[] nameArray = {"First","Yellow","Big"}

public List&lt;String> getNameById(Integer[] ids){
    
}

public List&lt;String> getNameById(Integer...ids){
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_7-2-表述复数或者集合" tabindex="-1"> <strong>7.2 表述复数或者集合</strong></h3>
<p>如果一个变量用于描述多个数据时，尽量使用单词的复数形式进行书写，例如：</p>
<div><pre><code>Collection&lt;Order> orders;
int[] values;
List&lt;Item> items;
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>另外，如果表述的是一个Map数据，则应使用“map”作为其后缀，例如：</p>
<div><pre><code>Map&lt;String,User> userMap;
Map&lt;String,List&lt;Object>> listMap;
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h3 id="_7-3-泛型类" tabindex="-1"> <strong>7.3 泛型类</strong></h3>
<p>在书写泛型类时，通常做以下的约定：</p>
<ul>
<li>E表示Element，通常用在集合中；</li>
<li>ID用于表示对象的唯一标识符类型</li>
<li>T表示Type(类型)，通常指代类；</li>
<li>K表示Key(键),通常用于Map中；</li>
<li>V表示Value(值),通常用于Map中，与K结对出现；</li>
<li>N表示Number,通常用于表示数值类型；</li>
<li>？表示不确定的Java类型；</li>
<li>X用于表示异常；</li>
<li>U,S表示任意的类型。</li>
</ul>
<p>下面时泛型类的书写示例：</p>
<div><pre><code>public class HashSet&lt;E> extends AbstractSet&lt;E>{
    
}
public class HashMap&lt;K,V> extends AbstractMap&lt;K,V>{
    
}
public class ThreadLocal&lt;T>{
    
}
public interface Functor&lt;T,X extends Throwable>{
    T val() throws X;
}
public class Container&lt;K,V>{
    private K key;
    private V value;
    Container(K key,V value){
        this.key = key;
        this.value = value;
    }
    
}

public interface BaseRepository&lt;T,ID>{
    T findById(ID id);

    void update(T t);

    List&lt;T> findByIds(ID...ids);
}

public static &lt;T> List&lt;T> methodName(Class&lt;T> clz){
    List&lt;T> dataList = getByClz(clz);
    return dataList;
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>7.4 接口实现类</strong></p>
<p>为了便于阅读，在通常情况下，建议接口实现类使用“Impl作为后缀”，不建议使用大写的“I”作为接口前缀，下面是接口和接口实现类的书写示例。</p>
<p>推荐写法：</p>
<div><pre><code>public interface OrderService{
    
}
public class OrderServiceImpl implements OrderService{
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>不建议的写法：</p>
<div><pre><code>public interface IOrderService{
    
}
public class OrderService implements IOrderService{
    
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_7-5-测试类和测试方法" tabindex="-1"> <strong>7.5 测试类和测试方法</strong></h3>
<p>在项目中，测试类采用被测试业务模块名/被测试接口/被测试类+“Test”的方法进行书写，测试类中的测试函数采用“test”+用例操作_状态的组合方式进行书写，例如：</p>
<div><pre><code>public class UserServiceTest{

    public void testFindByUsernameAndPassword(){
        
    }

    public void testUsernameExist_notExist(){
        
    }

    public void testDeleteById_isOk(){
        
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>8 扩展：速记 Java 开发中的各种O</strong></p>
<p>最后，通过一张表和图快速对Java中的<code>BO</code>,<code>DTO</code>,<code>DAO</code>,<code>PO</code>,<code>POJO</code>,<code>VO</code>之间的含义，区别以及联系进行梳理。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>使用范围</th>
<th>解释说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>BO</td>
<td>用于Service,Manager,Business等业务相关类的命名</td>
<td>Business Object业务处理对象，主要作用是把业务逻辑封装成一个对象。</td>
</tr>
<tr>
<td>DTO</td>
<td>经过加工后的PO对象，其内部属性可能增加或减少</td>
<td>Data Transfer Object数据传输对象，主要用于远程调用等需要大量传输数据的地方，例如，可以将一个或多个PO类的部分或全部属性封装为DTO进行传输</td>
</tr>
<tr>
<td>DAO</td>
<td>用于对数据库进行读写操作的类进行命名</td>
<td>Data Access Object数据访问对象，主要用来封装对数据库的访问，通过DAO可以将POJO持久化为PO，也可以利用PO封装出VO和DTO</td>
</tr>
<tr>
<td>PO</td>
<td>Bean,Entity等类的命名</td>
<td>Persistant Object持久化对象，数据库表中的数据在Java对象中的映射状态，可以简单的理解为一个PO对象即为数据库表中的一条记录</td>
</tr>
<tr>
<td>POJO</td>
<td>POJO是DO/DTO/BO/VO的统称</td>
<td>Plain Ordinary Java Object 简单Java对象，它是一个简单的普通Java对象，禁止将类命名为XxxxPOJO</td>
</tr>
<tr>
<td>VO</td>
<td>通常是视图控制层和模板引擎之间传递的数据对象</td>
<td>Value Object 值对象，主要用于视图层，视图控制器将视图层所需的属性封装成一个对象，然后用一个VO对象在视图控制器和视图之间进行数据传输。</td>
</tr>
<tr>
<td>AO</td>
<td>应用层对象</td>
<td>Application Object，在Web层与Service层之间抽象的复用对象模型，很少用。</td>
</tr>
</tbody>
</table>
<p>下面将通过一张图来理解上述几种O之间相互转换的关系：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220526110603169.png" alt="image-20220526110603169" loading="lazy"></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-28T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Python 批量下载某网页的所有图片</title>
    <id>https://blog.ciberviler.top/dev/Python%E6%89%B9%E9%87%8F%E4%B8%8B%E8%BD%BD%E6%9F%90%E7%BD%91%E9%A1%B5%E7%9A%84%E6%89%80%E6%9C%89%E5%9B%BE%E7%89%87.html</id>
    <link href="https://blog.ciberviler.top/dev/Python%E6%89%B9%E9%87%8F%E4%B8%8B%E8%BD%BD%E6%9F%90%E7%BD%91%E9%A1%B5%E7%9A%84%E6%89%80%E6%9C%89%E5%9B%BE%E7%89%87.html"/>
    <updated>2022-05-26T03:43:16.000Z</updated>
    <summary type="html">Python 批量下载某网页的所有图片</summary>
    <content type="html"><![CDATA[<h1 id="python-批量下载某网页的所有图片" tabindex="-1"> Python 批量下载某网页的所有图片</h1>
<div><pre><code><span># requests是第三方库：用pip install requests安装</span>
<span>import</span> requests

<span>from</span> bs4 <span>import</span> BeautifulSoup

<span># 设置变量用于拼接网址</span>
page_number <span>=</span> <span>4</span>

<span># 用while循环控制访问的网页</span>
<span>while</span> page_number <span>&lt;</span> <span>8</span> <span>:</span>

    <span># page_number = 4时，访问的是网址的第4页</span>
    html_url <span>=</span> <span>'https://www.tukuppt.com/peitu/zonghe_0_0_0_0_0_0_{}.html'</span><span>.</span><span>format</span><span>(</span>page_number<span>)</span>

    <span># 用get函数发送网页请求</span>
    url_response <span>=</span> requests<span>.</span>get<span>(</span>html_url<span>)</span>
    
    <span># 检验请求是否成功</span>
    <span>print</span><span>(</span>url_response<span>.</span>status_code<span>)</span>

    <span># 解析请求到的网页内容</span>
    bs <span>=</span> BeautifulSoup<span>(</span>url_response<span>.</span>text<span>,</span><span>'html.parser'</span><span>)</span>
    <span>#print(bs)</span>

    <span># 搜索网页中所有包含图片名称和图片链接的tag</span>
    <span># 得到一整个dl标签</span>
    picture_list <span>=</span> bs<span>.</span>find_all<span>(</span><span>'dl'</span><span>,</span>class_<span>=</span><span>'cbox item'</span><span>)</span>
    <span>#print(picture_list)</span>

    <span># for 循环取出dl中的每一个标签</span>
    <span>for</span> i <span>in</span> picture_list <span>:</span>
        <span># 取出dl标签中的所有a标签中的第2个a标签</span>
        <span># [1]取到的是第2个标签</span>
        picture_list_a <span>=</span> i<span>.</span>find_all<span>(</span><span>'a'</span><span>)</span><span>[</span><span>1</span><span>]</span>
        <span>#print(picture_list_a)</span>

        <span># 取出图片名称：图片名称在img标签内属性为'alt'</span>
        picture_name <span>=</span> picture_list_a<span>.</span>find<span>(</span><span>'img'</span><span>)</span><span>[</span><span>'alt'</span><span>]</span>
        <span>#print(picture_name)</span>

        <span># 取出图片链接：图片链接在img标签内属性为'data-original'</span>
        picture_url_d <span>=</span> picture_list_a<span>.</span>find<span>(</span><span>'img'</span><span>)</span><span>[</span><span>'data-original'</span><span>]</span>
        <span>#print(picture_url_d)</span>
        
        <span># 完整的图片链接</span>
        picture_url <span>=</span> <span>(</span><span>'https:'</span><span>+</span>picture_url_d<span>)</span>
        <span>#print(picture_url)</span>

        <span># 访问图片链接</span>
        picture_url_response <span>=</span> requests<span>.</span>get<span>(</span>picture_url<span>)</span>

        <span># 将访问的响应结果以二进制数据的形式返回</span>
        picture_content <span>=</span> picture_url_response<span>.</span>content

        <span># 图片内容以二进制形式写入</span>
        <span>with</span> <span>open</span> <span>(</span><span>'.\\摄影图\\'</span><span>+</span>picture_name<span>+</span><span>'.jpg'</span><span>,</span> <span>'wb'</span> <span>)</span> <span>as</span> f <span>:</span>
          
            <span># 将二进制数据写入文件</span>
            f<span>.</span>write<span>(</span>picture_content<span>)</span>
        <span># 用print查看代码运行步骤</span>
        <span>print</span><span>(</span><span>'《{}》已保存'</span><span>.</span><span>format</span><span>(</span>picture_name<span>)</span><span>)</span>

    page_number <span>+=</span> <span>1</span>
<span>print</span><span>(</span><span>'程序结束!'</span><span>)</span>

</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Python" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-31T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">短视频解析</title>
    <id>https://blog.ciberviler.top/tools/%E7%9F%AD%E8%A7%86%E9%A2%91%E8%A7%A3%E6%9E%90.html</id>
    <link href="https://blog.ciberviler.top/tools/%E7%9F%AD%E8%A7%86%E9%A2%91%E8%A7%A3%E6%9E%90.html"/>
    <updated>2022-05-26T03:43:07.000Z</updated>
    <content type="html"><![CDATA[<h1 id="短视频解析" tabindex="-1"> 短视频解析</h1>
<p>1.去水印视频解析： <a href="https://parse.bqrdh.com/smart" target="_blank" rel="noopener noreferrer">https://parse.bqrdh.com/smart</a></p>
<p>2.酷豆去水印： <a href="https://dy.kukutool.com/" target="_blank" rel="noopener noreferrer">https://dy.kukutool.com/</a></p>
<p>3.疯狂视频去水印： <a href="https://douyin.video996.com/" target="_blank" rel="noopener noreferrer">https://douyin.video996.com/</a></p>
<p>4.视频去水印： <a href="https://weibo.iiilab.com/" target="_blank" rel="noopener noreferrer">https://weibo.iiilab.com/</a></p>
<p>5.映客小视频去水印： <a href="https://inke.iiilab.com/" target="_blank" rel="noopener noreferrer">https://inke.iiilab.com/</a></p>
<p>6.蜜蜂去水印： <a href="https://video.ciding.cc/" target="_blank" rel="noopener noreferrer">https://video.ciding.cc/</a></p>
<p>7.短视频解析： <a href="http://www.dspjx.com/" target="_blank" rel="noopener noreferrer">http://www.dspjx.com/</a></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Tools" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-29T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">SpringBoot 引入线程池+Queue缓冲队列实现高并发下单业务</title>
    <id>https://blog.ciberviler.top/dev/SpringBoot%E5%BC%95%E5%85%A5%E7%BA%BF%E7%A8%8B%E6%B1%A0+Queue%E7%BC%93%E5%86%B2%E9%98%9F%E5%88%97%E5%AE%9E%E7%8E%B0%E9%AB%98%E5%B9%B6%E5%8F%91%E4%B8%8B%E5%8D%95%E4%B8%9A%E5%8A%A1.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringBoot%E5%BC%95%E5%85%A5%E7%BA%BF%E7%A8%8B%E6%B1%A0+Queue%E7%BC%93%E5%86%B2%E9%98%9F%E5%88%97%E5%AE%9E%E7%8E%B0%E9%AB%98%E5%B9%B6%E5%8F%91%E4%B8%8B%E5%8D%95%E4%B8%9A%E5%8A%A1.html"/>
    <updated>2022-05-24T14:53:48.000Z</updated>
    <content type="html"><![CDATA[<h1 id="springboot-引入线程池-queue缓冲队列实现高并发下单业务" tabindex="-1"> SpringBoot 引入线程池+Queue缓冲队列实现高并发下单业务</h1>
<ul>
<li>1.首先是springBoot的项目框架如下：</li>
<li>2.业务测试流程涉及的类，如下</li>
<li>3.使用JMeter模拟并发下单请求</li>
<li>4.结果</li>
</ul>
<hr>
<p>主要是自己在项目中(中小型项目) 有支付下单业务(只是办理VIP，没有涉及到商品库存)，目前用户量还没有上来，目前没有出现问题，但是想到如果用户量变大，下单并发量变大，可能会出现一系列的问题，趁着空闲时间，做了这个demo测试相关问题。</p>
<p>可能遇到的问题如下：</p>
<ol>
<li>订单重复</li>
<li>高并发下，性能变慢</li>
</ol>
<p>解决方式：<code>ThreadPoolExecutor</code>线程池 + Queue队列</p>
<h2 id="_1-首先是springboot的项目框架如下" tabindex="-1"> 1.首先是springBoot的项目框架如下：</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220524225159288.png" alt="image-20220524225159288" loading="lazy"></p>
<h2 id="_2-业务测试流程涉及的类-如下" tabindex="-1"> 2.业务测试流程涉及的类，如下</h2>
<ul>
<li>BusinessThread 类</li>
</ul>
<div><pre><code>package com.springboot.demo.Threads;

import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Component;

@Component
@Scope("prototype")//spring 多例
public class BusinessThread implements Runnable{

    private String acceptStr;

    public BusinessThread(String acceptStr) {
        this.acceptStr = acceptStr;
    }

    public String getAcceptStr() {
        return acceptStr;
    }

    public void setAcceptStr(String acceptStr) {
        this.acceptStr = acceptStr;
    }

    @Override
    public void run() {
        //业务操作
        System.out.println("多线程已经处理订单插入系统，订单号："+acceptStr);

        //线程阻塞
        /*try {
            Thread.sleep(1000);
            System.out.println("多线程已经处理订单插入系统，订单号："+acceptStr);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }*/
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>TestThreadPoolManager 类</li>
</ul>
<div><pre><code>package com.springboot.demo.Threads;

import org.springframework.beans.BeansException;
import org.springframework.beans.factory.BeanFactory;
import org.springframework.beans.factory.BeanFactoryAware;
import org.springframework.stereotype.Component;

import java.util.Map;
import java.util.Queue;
import java.util.concurrent.*;

@Component
public class TestThreadPoolManager implements BeanFactoryAware {

    //用于从IOC里取对象
    private BeanFactory factory; //如果实现Runnable的类是通过spring的application.xml文件进行注入,可通过 factory.getBean()获取，这里只是提一下

    // 线程池维护线程的最少数量
    private final static int CORE_POOL_SIZE = 2;
    // 线程池维护线程的最大数量
    private final static int MAX_POOL_SIZE = 10;
    // 线程池维护线程所允许的空闲时间
    private final static int KEEP_ALIVE_TIME = 0;
    // 线程池所使用的缓冲队列大小
    private final static int WORK_QUEUE_SIZE = 50;

    @Override
    public void setBeanFactory(BeanFactory beanFactory) throws BeansException {
        factory = beanFactory;
    }

    /**
     * 用于储存在队列中的订单,防止重复提交,在真实场景中，可用redis代替 验证重复
     */
    Map&lt;String, Object> cacheMap = new ConcurrentHashMap&lt;>();


    /**
     * 订单的缓冲队列,当线程池满了，则将订单存入到此缓冲队列
     */
    Queue&lt;Object> msgQueue = new LinkedBlockingQueue&lt;Object>();


    /**
     * 当线程池的容量满了，执行下面代码，将订单存入到缓冲队列
     */
    final RejectedExecutionHandler handler = new RejectedExecutionHandler() {
        @Override
        public void rejectedExecution(Runnable r, ThreadPoolExecutor executor) {
            //订单加入到缓冲队列
            msgQueue.offer(((BusinessThread) r).getAcceptStr());
            System.out.println("系统任务太忙了,把此订单交给(调度线程池)逐一处理，订单号：" + ((BusinessThread) r).getAcceptStr());
        }
    };


    /**创建线程池*/
   final ThreadPoolExecutor threadPool = new ThreadPoolExecutor(CORE_POOL_SIZE, MAX_POOL_SIZE, KEEP_ALIVE_TIME, TimeUnit.SECONDS, new ArrayBlockingQueue(WORK_QUEUE_SIZE), this.handler);


    /**将任务加入订单线程池*/
    public void addOrders(String orderId){
        System.out.println("此订单准备添加到线程池，订单号：" + orderId);
        //验证当前进入的订单是否已经存在
        if (cacheMap.get(orderId) == null) {
            cacheMap.put(orderId, new Object());
            BusinessThread businessThread = new BusinessThread(orderId);
            threadPool.execute(businessThread);
        }
    }

    /**
     * 线程池的定时任务----> 称为(调度线程池)。此线程池支持 定时以及周期性执行任务的需求。
     */
    final ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(5);


    /**
     * 检查(调度线程池)，每秒执行一次，查看订单的缓冲队列是否有 订单记录，则重新加入到线程池
     */
    final ScheduledFuture scheduledFuture = scheduler.scheduleAtFixedRate(new Runnable() {
        @Override
        public void run() {
            //判断缓冲队列是否存在记录
            if(!msgQueue.isEmpty()){
                //当线程池的队列容量少于WORK_QUEUE_SIZE，则开始把缓冲队列的订单 加入到 线程池
                if (threadPool.getQueue().size() &lt; WORK_QUEUE_SIZE) {
                    String orderId = (String) msgQueue.poll();
                    BusinessThread businessThread = new BusinessThread(orderId);
                    threadPool.execute(businessThread);
                    System.out.println("(调度线程池)缓冲队列出现订单业务，重新添加到线程池，订单号："+orderId);
                }
            }
        }
    }, 0, 1, TimeUnit.SECONDS);


    /**获取消息缓冲队列*/
    public Queue&lt;Object> getMsgQueue() {
        return msgQueue;
    }

    /**终止订单线程池+调度线程池*/
    public void shutdown() {
        //true表示如果定时任务在执行，立即中止，false则等待任务结束后再停止
        System.out.println("终止订单线程池+调度线程池："+scheduledFuture.cancel(false));
        scheduler.shutdown();
        threadPool.shutdown();

    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>TestController 类</li>
</ul>
<div><pre><code>package com.springboot.demo;

import com.springboot.demo.Threads.TestThreadPoolManager;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;

import java.util.Queue;
import java.util.UUID;

/**
 * Created by Administrator on 2018/5/9.
 */
@RestController
public class TestController {

    @Autowired
    TestThreadPoolManager testThreadPoolManager;

    /**
     * 测试模拟下单请求 入口
     * @param id
     * @return
     */
    @GetMapping("/start/{id}")
    public String start(@PathVariable Long id) {
        //模拟的随机数
        String orderNo = System.currentTimeMillis() + UUID.randomUUID().toString();

        testThreadPoolManager.addOrders(orderNo);

        return "Test ThreadPoolExecutor start";
    }

    /**
     * 停止服务
     * @param id
     * @return
     */
    @GetMapping("/end/{id}")
    public String end(@PathVariable Long id) {

        testThreadPoolManager.shutdown();

        Queue q = testThreadPoolManager.getMsgQueue();
        System.out.println("关闭了线程服务，还有未处理的信息条数：" + q.size());
        return "Test ThreadPoolExecutor start";
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><blockquote>
<p>基于微服务的思想，构建在 B2C 电商场景下的项目实战。核心技术栈，是 Spring Boot + Dubbo 。未来，会重构成 Spring Cloud Alibaba 。</p>
<p>项目地址：<a href="https://github.com/YunaiV/onemall" target="_blank" rel="noopener noreferrer">https://github.com/YunaiV/onemall</a></p>
</blockquote>
<h2 id="_3-使用jmeter模拟并发下单请求" tabindex="-1"> 3.使用JMeter模拟并发下单请求</h2>
<p>[<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16533988082341.png" alt="图片" loading="lazy">]</p>
<h2 id="_4-结果" tabindex="-1"> 4.结果</h2>
<p>打印的日志说明，开始的订单直接执行插入到系统，当线程池的容量已经满了，则使用<code>RejectedExecutionHandler</code>方法把后面的订单添加到 Queue缓冲队列，使用<code>ScheduledFuture</code>方法定时(我这里是每秒一次)检查Queue队列，重新把队列里面的订单添加到线程池，执行后面的插入任务。</p>
<p>部分日志如下</p>
<p>[<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16533988082342.png" alt="图片" loading="lazy">]</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-26T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Spring Boot + Mybatis Plus + ClickHouse 轻松实现增删改查</title>
    <id>https://blog.ciberviler.top/dev/SpringBoot+MybatisPlus+ClickHouse%E8%BD%BB%E6%9D%BE%E5%AE%9E%E7%8E%B0%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringBoot+MybatisPlus+ClickHouse%E8%BD%BB%E6%9D%BE%E5%AE%9E%E7%8E%B0%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5.html"/>
    <updated>2022-05-24T14:53:56.000Z</updated>
    <content type="html"><![CDATA[<h1 id="spring-boot-mybatis-plus-clickhouse-轻松实现增删改查" tabindex="-1"> Spring Boot + Mybatis Plus + ClickHouse 轻松实现增删改查</h1>
<h2 id="项目场景" tabindex="-1"> 项目场景：</h2>
<p><strong>ClickHouse 操作基于 Mybatis-puls源码扩展开发。解决ClickHouse的修改和删除 SQL操作与Mysql不相同。</strong></p>
<h2 id="基于-mybatis-puls" tabindex="-1"> 基于 <strong>Mybatis-puls</strong>：</h2>
<p>update 、updateById 、 delete 函数</p>
<p>1、<code>SqlMethodDiv.java</code> 文件枚举类，对sql脚本定义</p>
<div><pre><code><span>package</span> <span>com<span>.</span>demo<span>.</span>infrastructure<span>.</span>injector<span>.</span>enums</span><span>;</span>
 
<span>/**
 * <span>@author</span> liuxiansong
 */</span>
<span>public</span> <span>enum</span> <span>SqlMethodDiv</span> <span>{</span>
 
    <span>/**
     * 删除
     */</span>
    <span>DELETE_BY_ID</span><span>(</span><span>"deleteByIdClickHouse"</span><span>,</span> <span>"根据ID 删除一条数据"</span><span>,</span> <span>"&lt;script>\nALTER TABLE %s DELETE WHERE %s=#{%s}\n&lt;/script>"</span><span>)</span><span>,</span>
 
    <span>/**
     * 逻辑删除
     */</span>
    <span>LOGIC_DELETE_BY_ID</span><span>(</span><span>"deleteByIdClickHouse"</span><span>,</span> <span>"根据ID 逻辑删除一条数据"</span><span>,</span> <span>"&lt;script>\nALTER TABLE %s UPDATE %s where %s=#{%s} %s\n&lt;/script>"</span><span>)</span><span>,</span>
 
    <span>/**
     * 修改 条件主键
     */</span>
    <span>UPDATE_BY_ID</span><span>(</span><span>"updateByIdClickHouse"</span><span>,</span> <span>"根据ID 选择修改数据"</span><span>,</span> <span>"&lt;script>\nALTER TABLE %s UPDATE %s where %s=#{%s} %s\n&lt;/script>"</span><span>)</span><span>,</span>
    <span>/**
     * 修改 条件主键
     */</span>
    <span>UPDATE</span><span>(</span><span>"updateClickHouse"</span><span>,</span> <span>"根据 whereEntity 条件，更新记录"</span><span>,</span> <span>"&lt;script>\nALTER TABLE %s UPDATE  %s %s %s\n&lt;/script>"</span><span>)</span><span>;</span>
 
    <span>private</span> <span>final</span> <span>String</span> method<span>;</span>
    <span>private</span> <span>final</span> <span>String</span> desc<span>;</span>
    <span>private</span> <span>final</span> <span>String</span> sql<span>;</span>
 
    <span>SqlMethodDiv</span><span>(</span><span>String</span> method<span>,</span> <span>String</span> desc<span>,</span> <span>String</span> sql<span>)</span> <span>{</span>
        <span>this</span><span>.</span>method <span>=</span> method<span>;</span>
        <span>this</span><span>.</span>desc <span>=</span> desc<span>;</span>
        <span>this</span><span>.</span>sql <span>=</span> sql<span>;</span>
    <span>}</span>
 
    <span>public</span> <span>String</span> <span>getMethod</span><span>(</span><span>)</span> <span>{</span>
        <span>return</span> method<span>;</span>
    <span>}</span>
 
    <span>public</span> <span>String</span> <span>getDesc</span><span>(</span><span>)</span> <span>{</span>
        <span>return</span> desc<span>;</span>
    <span>}</span>
 
    <span>public</span> <span>String</span> <span>getSql</span><span>(</span><span>)</span> <span>{</span>
        <span>return</span> sql<span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>2、<code>UpdateByIdClickHouse.java</code> 类文件，继承 AbstractMethod 重载 injectMappedStatement</p>
<div><pre><code><span>package</span> <span>com<span>.</span>demo<span>.</span>infrastructure<span>.</span>injector<span>.</span>methods</span><span>;</span>
 
<span>import</span> <span><span>com<span>.</span>baomidou<span>.</span>mybatisplus<span>.</span>core<span>.</span>injector<span>.</span></span><span>AbstractMethod</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>baomidou<span>.</span>mybatisplus<span>.</span>core<span>.</span>metadata<span>.</span></span><span>TableInfo</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>baomidou<span>.</span>mybatisplus<span>.</span>core<span>.</span>toolkit<span>.</span>sql<span>.</span></span><span>SqlScriptUtils</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>infrastructure<span>.</span>injector<span>.</span>enums<span>.</span></span><span>SqlMethodDiv</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>apache<span>.</span>ibatis<span>.</span>executor<span>.</span>keygen<span>.</span></span><span>NoKeyGenerator</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>apache<span>.</span>ibatis<span>.</span>mapping<span>.</span></span><span>MappedStatement</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>apache<span>.</span>ibatis<span>.</span>mapping<span>.</span></span><span>SqlSource</span></span><span>;</span>
 
<span>/**
 * <span>@author</span> liuxiansong
 * <span>@date</span> 2021-05-20
 * <span>@desc</span> 通过MybatisPlus源码 扩展修改
 */</span>
<span>public</span> <span>class</span> <span>UpdateByIdClickHouse</span> <span>extends</span> <span>AbstractMethod</span> <span>{</span>
 
    <span>@Override</span>
    <span>public</span> <span>MappedStatement</span> <span>injectMappedStatement</span><span>(</span><span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> mapperClass<span>,</span> <span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> modelClass<span>,</span> <span>TableInfo</span> tableInfo<span>)</span> <span>{</span>
        <span>SqlMethodDiv</span> sqlMethod <span>=</span> <span>SqlMethodDiv</span><span>.</span>UPDATE_BY_ID<span>;</span>
 
        <span>final</span> <span>String</span> additional <span>=</span> <span>optlockVersion</span><span>(</span>tableInfo<span>)</span> <span>+</span> tableInfo<span>.</span><span>getLogicDeleteSql</span><span>(</span><span>true</span><span>,</span> <span>true</span><span>)</span><span>;</span>
        <span>String</span> sql <span>=</span> <span>String</span><span>.</span><span>format</span><span>(</span>sqlMethod<span>.</span><span>getSql</span><span>(</span><span>)</span><span>,</span> tableInfo<span>.</span><span>getTableName</span><span>(</span><span>)</span><span>,</span>
                <span>this</span><span>.</span><span>sqlSet</span><span>(</span>tableInfo<span>.</span><span>isWithLogicDelete</span><span>(</span><span>)</span><span>,</span> <span>false</span><span>,</span> tableInfo<span>,</span> <span>false</span><span>,</span> ENTITY<span>,</span> ENTITY_DOT<span>)</span><span>,</span>
                tableInfo<span>.</span><span>getKeyColumn</span><span>(</span><span>)</span><span>,</span> ENTITY_DOT <span>+</span> tableInfo<span>.</span><span>getKeyProperty</span><span>(</span><span>)</span><span>,</span> additional<span>)</span><span>;</span>
        <span>SqlSource</span> sqlSource <span>=</span> languageDriver<span>.</span><span>createSqlSource</span><span>(</span>configuration<span>,</span> sql<span>,</span> modelClass<span>)</span><span>;</span>
        <span>return</span> <span>this</span><span>.</span><span>addInsertMappedStatement</span><span>(</span>mapperClass<span>,</span> modelClass<span>,</span>
                sqlMethod<span>.</span><span>getMethod</span><span>(</span><span>)</span><span>,</span> sqlSource<span>,</span> <span>new</span> <span>NoKeyGenerator</span><span>(</span><span>)</span><span>,</span> <span>null</span><span>,</span> <span>null</span><span>)</span><span>;</span>
    <span>}</span>
 
 
    <span>/**
     * SQL 更新 set 语句
     *
     * <span>@param</span> <span>logic</span>  是否逻辑删除注入器
     * <span>@param</span> <span>ew</span>     是否存在 UpdateWrapper 条件
     * <span>@param</span> <span>table</span>  表信息
     * <span>@param</span> <span>alias</span>  别名
     * <span>@param</span> <span>prefix</span> 前缀
     * <span>@return</span> sql
     */</span>
    <span>@Override</span>
    <span>protected</span> <span>String</span> <span>sqlSet</span><span>(</span><span>boolean</span> logic<span>,</span> <span>boolean</span> ew<span>,</span> <span>TableInfo</span> table<span>,</span> <span>boolean</span> judgeAliasNull<span>,</span> <span>final</span> <span>String</span> alias<span>,</span>
                            <span>final</span> <span>String</span> prefix<span>)</span> <span>{</span>
        <span>String</span> sqlScript <span>=</span> table<span>.</span><span>getAllSqlSet</span><span>(</span>logic<span>,</span> prefix<span>)</span><span>;</span>
        <span>if</span> <span>(</span>judgeAliasNull<span>)</span> <span>{</span>
            sqlScript <span>=</span> <span>SqlScriptUtils</span><span>.</span><span>convertIf</span><span>(</span>sqlScript<span>,</span> <span>String</span><span>.</span><span>format</span><span>(</span><span>"%s != null"</span><span>,</span> alias<span>)</span><span>,</span> <span>true</span><span>)</span><span>;</span>
        <span>}</span>
        <span>if</span> <span>(</span>ew<span>)</span> <span>{</span>
            sqlScript <span>+=</span> NEWLINE<span>;</span>
            sqlScript <span>+=</span> <span>SqlScriptUtils</span><span>.</span><span>convertIf</span><span>(</span><span>SqlScriptUtils</span><span>.</span><span>unSafeParam</span><span>(</span>U_WRAPPER_SQL_SET<span>)</span><span>,</span>
                    <span>String</span><span>.</span><span>format</span><span>(</span><span>"%s != null and %s != null"</span><span>,</span> WRAPPER<span>,</span> U_WRAPPER_SQL_SET<span>)</span><span>,</span> <span>false</span><span>)</span><span>;</span>
        <span>}</span>
        sqlScript <span>=</span> <span>convertSet</span><span>(</span>sqlScript<span>)</span><span>;</span>
        <span>return</span> sqlScript<span>;</span>
    <span>}</span>
 
    <span>/**
     * 去掉sest 和 suffixOverrides=","代表去掉第一个逗号
     *
     * <span>@param</span> <span>sqlScript</span>
     * <span>@return</span>
     */</span>
    <span>public</span> <span>static</span> <span>String</span> <span>convertSet</span><span>(</span><span>final</span> <span>String</span> sqlScript<span>)</span> <span>{</span>
        <span>return</span> <span>"&lt;trim prefix=\"\" suffixOverrides=\",\"> "</span> <span>+</span> sqlScript <span>+</span> <span>"\n"</span> <span>+</span> <span>"&lt;/trim>"</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>3、<code>ClickHouseSqlInjector.java</code> 注册方法，继承 DefaultSqlInjector</p>
<div><pre><code><span>package</span> <span>com<span>.</span>demo<span>.</span>infrastructure<span>.</span>injector</span><span>;</span>
 
<span>import</span> <span><span>com<span>.</span>baomidou<span>.</span>mybatisplus<span>.</span>core<span>.</span>injector<span>.</span></span><span>AbstractMethod</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>baomidou<span>.</span>mybatisplus<span>.</span>core<span>.</span>injector<span>.</span></span><span>DefaultSqlInjector</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>infrastructure<span>.</span>injector<span>.</span>methods<span>.</span></span><span>DeleteClickHouse</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>infrastructure<span>.</span>injector<span>.</span>methods<span>.</span></span><span>UpdateByIdClickHouse</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>infrastructure<span>.</span>injector<span>.</span>methods<span>.</span></span><span>UpdateClickHouse</span></span><span>;</span>
 
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>List</span></span><span>;</span>
 
<span>/**
 * 注册方法
 *
 * <span>@author</span> liuxiansong
 */</span>
<span>public</span> <span>class</span> <span>ClickHouseSqlInjector</span> <span>extends</span> <span>DefaultSqlInjector</span> <span>{</span>
 
    <span>@Override</span>
    <span>public</span> <span>List</span><span><span>&lt;</span><span>AbstractMethod</span><span>></span></span> <span>getMethodList</span><span>(</span><span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> mapperClass<span>)</span> <span>{</span>
        <span>/**
         * 这里很重要，先要通过父类方法，获取到原有的集合，不然会自带的通用方法会失效的
         */</span>
        <span>List</span><span><span>&lt;</span><span>AbstractMethod</span><span>></span></span> methodList <span>=</span> <span>super</span><span>.</span><span>getMethodList</span><span>(</span>mapperClass<span>)</span><span>;</span>
        <span>/***
         * 添加自定义方法类
         */</span>
        methodList<span>.</span><span>add</span><span>(</span><span>new</span> <span>UpdateByIdClickHouse</span><span>(</span><span>)</span><span>)</span><span>;</span>
        methodList<span>.</span><span>add</span><span>(</span><span>new</span> <span>UpdateClickHouse</span><span>(</span><span>)</span><span>)</span><span>;</span>
        methodList<span>.</span><span>add</span><span>(</span><span>new</span> <span>DeleteClickHouse</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>return</span> methodList<span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>4、编写SuperMapper 继承BaseMapper，让所有Mapper 继承extends</p>
<div><pre><code><span>package</span> <span>com<span>.</span>demo<span>.</span>domain<span>.</span>mapper</span><span>;</span>
 
<span>import</span> <span><span>com<span>.</span>baomidou<span>.</span>mybatisplus<span>.</span>core<span>.</span>conditions<span>.</span></span><span>Wrapper</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>baomidou<span>.</span>mybatisplus<span>.</span>core<span>.</span>mapper<span>.</span></span><span>BaseMapper</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>apache<span>.</span>ibatis<span>.</span>annotations<span>.</span></span><span>Param</span></span><span>;</span>
 
<span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>Serializable</span></span><span>;</span>
 
<span>/**
 * <span>@author</span> liuxiansong
 * 自定义方法
 */</span>
<span>@SuppressWarnings</span><span>(</span><span>"all"</span><span>)</span>
<span>public</span> <span>interface</span> <span>SuperMapper</span><span><span>&lt;</span><span>T</span><span>></span></span> <span>extends</span> <span>BaseMapper</span><span><span>&lt;</span><span>T</span><span>></span></span> <span>{</span>
 
    <span>/**
     * <span>@return</span>
     * @Description: 删除并填充删除人信息
     * <span>@param</span>: id 主键id
     * <span>@auther</span>: zpq
     * <span>@date</span>: 2020/11/10 11:47 上午
     */</span>
    <span>boolean</span> <span>updateByIdClickHouse</span><span>(</span><span>@Param</span><span>(</span><span>"et"</span><span>)</span> <span>T</span> entity<span>)</span><span>;</span>
 
 
    <span>/**
     * <span>@return</span>
     * @Description: 删除并填充删除人信息
     * <span>@param</span>: id 主键id
     * <span>@auther</span>: zpq
     * <span>@date</span>: 2020/11/10 11:47 上午
     */</span>
    <span>boolean</span> <span>updateClickHouse</span><span>(</span><span>@Param</span><span>(</span><span>"et"</span><span>)</span> <span>T</span> entity<span>,</span> <span>@Param</span><span>(</span><span>"ew"</span><span>)</span> <span>Wrapper</span><span><span>&lt;</span><span>T</span><span>></span></span> updateWrapper<span>)</span><span>;</span>
 
    <span>/**
     * 主键删除
     *
     * <span>@param</span> <span>id</span>
     * <span>@return</span>
     */</span>
    <span>int</span> <span>deleteByIdClickHouse</span><span>(</span><span>Serializable</span> id<span>)</span><span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>5、单元测试看效果</p>
<div><pre><code><span>package</span> <span>com<span>.</span>demo<span>.</span>test</span><span>;</span>
 
<span>import</span> <span><span>com<span>.</span>demo<span>.</span></span><span>DemoClickHouse</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>domain<span>.</span>dataobject<span>.</span></span><span>User</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>domain<span>.</span>service<span>.</span></span><span>UserService</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>demo<span>.</span>infrastructure<span>.</span>util<span>.</span>page<span>.</span></span><span>PageResult</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>junit<span>.</span></span><span>Test</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>junit<span>.</span>runner<span>.</span></span><span>RunWith</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>beans<span>.</span>factory<span>.</span>annotation<span>.</span></span><span>Autowired</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>boot<span>.</span>test<span>.</span>context<span>.</span></span><span>SpringBootTest</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>test<span>.</span>context<span>.</span>junit4<span>.</span></span><span>SpringRunner</span></span><span>;</span>
 
<span>@RunWith</span><span>(</span><span>SpringRunner</span><span>.</span><span>class</span><span>)</span>
<span>@SpringBootTest</span><span>(</span>classes <span>=</span> <span>DemoClickHouse</span><span>.</span><span>class</span><span>)</span>
<span>public</span> <span>class</span> <span>UserMapperTest</span> <span>{</span>
 
    <span>@Autowired</span>
    <span>UserService</span> userService<span>;</span>
 
 
    <span>@Test</span>
    <span>public</span> <span>void</span> <span>findById_Test</span><span>(</span><span>)</span> <span>{</span>
        <span>User</span> byId <span>=</span> userService<span>.</span><span>findById</span><span>(</span><span>1</span><span>)</span><span>;</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"查询用户ID=1信息："</span> <span>+</span> byId<span>)</span><span>;</span>
    <span>}</span>
 
    <span>@Test</span>
    <span>public</span> <span>void</span> <span>page_Test</span><span>(</span><span>)</span> <span>{</span>
        <span>User</span> user <span>=</span> <span>new</span> <span>User</span><span>(</span><span>)</span><span>;</span>
        <span>Integer</span> page <span>=</span> <span>1</span><span>;</span>
        <span>Integer</span> limit <span>=</span> <span>2</span><span>;</span>
        <span>PageResult</span><span><span>&lt;</span><span>User</span><span>></span></span> userList <span>=</span> userService<span>.</span><span>page</span><span>(</span>user<span>,</span> page<span>,</span> limit<span>)</span><span>;</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"查询用户信息分页："</span> <span>+</span> userList<span>)</span><span>;</span>
    <span>}</span>
 
    <span>@Test</span>
    <span>public</span> <span>void</span> <span>create_Test</span><span>(</span><span>)</span> <span>{</span>
        <span>User</span> user <span>=</span> <span>new</span> <span>User</span><span>(</span><span>)</span><span>;</span>
        user<span>.</span><span>setUserName</span><span>(</span><span>"张三"</span><span>)</span><span>;</span>
        user<span>.</span><span>setPassWord</span><span>(</span><span>"123"</span><span>)</span><span>;</span>
        user<span>.</span><span>setPhone</span><span>(</span><span>"12312222"</span><span>)</span><span>;</span>
        user<span>.</span><span>setEmail</span><span>(</span><span>"326427540@qq.com"</span><span>)</span><span>;</span>
        userService<span>.</span><span>create</span><span>(</span>user<span>)</span><span>;</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"创建："</span> <span>+</span> user<span>)</span><span>;</span>
    <span>}</span>
 
    <span>@Test</span>
    <span>public</span> <span>void</span> <span>update_Test</span><span>(</span><span>)</span> <span>{</span>
        <span>User</span> user <span>=</span> <span>new</span> <span>User</span><span>(</span><span>)</span><span>;</span>
        user<span>.</span><span>setId</span><span>(</span><span>1395347901827317761l</span><span>)</span><span>;</span>
        user<span>.</span><span>setUserName</span><span>(</span><span>"小李飞刀"</span><span>)</span><span>;</span>
        user<span>.</span><span>setPassWord</span><span>(</span><span>"123"</span><span>)</span><span>;</span>
        user<span>.</span><span>setPhone</span><span>(</span><span>"12312222"</span><span>)</span><span>;</span>
        user<span>.</span><span>setEmail</span><span>(</span><span>"326427540@qq.com"</span><span>)</span><span>;</span>
        userService<span>.</span><span>update</span><span>(</span>user<span>)</span><span>;</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"创建："</span> <span>+</span> user<span>)</span><span>;</span>
    <span>}</span>
 
 
    <span>@Test</span>
    <span>public</span> <span>void</span> <span>delete_Test</span><span>(</span><span>)</span> <span>{</span>
        userService<span>.</span><span>delete</span><span>(</span><span>1l</span><span>)</span><span>;</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"删除："</span> <span>+</span> <span>1l</span><span>)</span><span>;</span>
    <span>}</span>
 
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220524224012350.png" alt="image-20220524224012350" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16534030656526.png" alt="图片" loading="lazy"></p>
<h2 id="源码" tabindex="-1"> 源码</h2>
<p><a href="https://github.com/saimen90/clickhouse" target="_blank" rel="noopener noreferrer">https://github.com/saimen90/clickhouse</a></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-27T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Linux图形化管理服务器的神器：Cockpit</title>
    <id>https://blog.ciberviler.top/linux/Linux%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E7%A5%9E%E5%99%A8Cockpit.html</id>
    <link href="https://blog.ciberviler.top/linux/Linux%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E7%A5%9E%E5%99%A8Cockpit.html"/>
    <updated>2022-05-24T08:24:51.000Z</updated>
    <content type="html"><![CDATA[<h1 id="linux图形化管理服务器的神器-cockpit" tabindex="-1"> Linux图形化管理服务器的神器：Cockpit</h1>
<h2 id="什么是-linux-的-cockpit-项目" tabindex="-1"> <strong>什么是 Linux 的 Cockpit 项目？</strong></h2>
<p>Cockpit是一个基于浏览器的图形管理工具，适用于您的 Linux 服务器，在服务器上安装 Cockpit 后，您可以从浏览器访问服务器并执行所有常规管理任务，例如配置防火墙、更改网络设置、管理存储、管理用户帐户、运行容器、安装更新、更新软件等。您还可以分析 CPU 负载、内存使用情况、网络活动和磁盘性能</p>
<p>如果您对 Linux 有点熟悉，Cockpit 是一个以图形方式管理服务器的好选择。即使您是一位经验丰富的系统管理员，Cockpit 也让您有机会了解您的服务器。</p>
<p>我知道如今像Ansible这样的现代实用程序是首选，但 Cockpit 对于各种用户来说仍然是一个不错的选择。</p>
<h2 id="使用-cockpit-以图形方式远程管理-linux-服务器" tabindex="-1"> <strong>使用 Cockpit 以图形方式远程管理 Linux 服务器</strong></h2>
<p>我将带您进行 Cockpit 演练，并展示您可以用它做什么。</p>
<h3 id="在要监控的服务器上安装-cockpit" tabindex="-1"> 在要监控的服务器上安装 Cockpit</h3>
<p>您需要在要监控的服务器上安装 Cockpit，可以从一个 Cockpit 界面监控多台服务器，稍后我将展示多台服务器的步骤。</p>
<p>对于这个快速教程，我将在 Ubuntu 18.04 服务器上安装 Cockpit：</p>
<div><pre><code>sudo apt -y install cockpit
</code></pre><div aria-hidden="true"><div></div></div></div><p>完成后，您现在可以使用端口号 9090 访问接口。</p>
<p>如果您可以物理访问服务器，则可以像这样在 Web 浏览器中使用 localhost。</p>
<p>localhost:9090</p>
<blockquote>
<p><strong>“</strong></p>
<p>确保服务器的防火墙允许端口 9090。<strong>”</strong></p>
</blockquote>
<p>您可以使用服务器的 IP 地址和端口号访问 Cockpit 界面，例如，如果您的 IP 地址是 1.2.3.4，那么您的访问 URL 将是：</p>
<div><pre><code>1.2.3.4:9090
</code></pre><div aria-hidden="true"><div></div></div></div><p>请注意，您必须允许 Web 浏览器的自定义 https 访问。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101207.png" alt="Cockpit" loading="lazy"></p>
<p>之后，您应该会看到如下界面：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101224.png" alt="Cockpit" loading="lazy"></p>
<p>请注意，此处所需的用户名和密码与您用于服务器的凭据相同。</p>
<p>还要确保选中“为特权任务重用我的密码”。登录后需要执行管理任务。</p>
<h3 id="探索cockpit" tabindex="-1"> 探索Cockpit</h3>
<p>首次登录时，您将被带到 localhost 设置下的系统概览页面：</p>
<h3 id="系统总览" tabindex="-1"> 系统总览</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101239.png" alt="Cockpit" loading="lazy"></p>
<h3 id="日志" tabindex="-1"> 日志</h3>
<p>在日志部分，您可以根据以下严重性过滤日志消息：</p>
<ul>
<li>一切</li>
<li>只有紧急</li>
<li>警报及以上</li>
<li>危急及以上</li>
<li>错误及以上</li>
<li>警告及以上</li>
<li>通知及以上</li>
<li>信息及以上</li>
<li>调试及以上</li>
</ul>
<p>默认情况下，它会显示基于“错误及以上”的严重性日志，您还可以根据特定时间段过滤消息：</p>
<ul>
<li>最近的</li>
<li>当前的</li>
<li>过去 24 小时</li>
<li>过去 7 天</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101256.png" alt="Cockpit" loading="lazy"></p>
<h3 id="贮存" tabindex="-1"> 贮存</h3>
<p>在存储中，您可以获得所有存储统计信息的简明概览，它们分为以下几类：</p>
<ul>
<li>文件系统</li>
<li>NFS 挂载</li>
<li>存储日志</li>
<li>RAID 设备</li>
<li>驱动器</li>
<li>其他设备</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101310.png" alt="Cockpit" loading="lazy"></p>
<p>即使您有一个单独的日志部分，也有一个专门的日志部分用于单独存储是有帮助的。</p>
<h3 id="联网" tabindex="-1"> 联网</h3>
<p>在这里您可以查看与您的网络接口相关的所有信息：</p>
<ul>
<li>接口</li>
<li>网络日志</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101323.png" alt="Cockpit" loading="lazy"></p>
<p>网络日志，类似于存储日志，仅列出与网络统计相关的所有消息。</p>
<h3 id="账户" tabindex="-1"> 账户</h3>
<p>此部分显示在相应 Linux 服务器上注册的所有系统用户。您可以通过此界面创建或删除用户。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101337.png" alt="Cockpit" loading="lazy"></p>
<h3 id="服务" tabindex="-1"> 服务</h3>
<p>您服务器的所有系统服务都分类为启用、禁用和静态。您可以根据以下条件过滤它们：</p>
<ul>
<li>目标</li>
<li>系统服务</li>
<li>Socket</li>
<li>计时器</li>
<li>路径</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101351.png" alt="Cockpit" loading="lazy"></p>
<h3 id="终端" tabindex="-1"> 终端</h3>
<p>这是我最喜欢的，不仅仅是因为您可以在这里运行命令或四处寻找，当您需要运行重要但冗长的命令时，如果使用 Web 界面，在终端上输入整个内容可能会非常烦人。我在 Linode 提供的基于 Web 的控制台（即 Weblish 和Glish ）上体验过这一点。您不能在其中复制和粘贴任何命令。但在 Cockpit 上，您绝对可以！</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101411.png" alt="Cockpit" loading="lazy"></p>
<h2 id="系统状态监控" tabindex="-1"> <strong>系统状态监控</strong></h2>
<p>如果您想要更简单的实时统计概览，您可以转至仪表板。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101430.png" alt="Cockpit" loading="lazy"></p>
<p>统计信息分为四个基本选项卡：CPU、内存、网络和磁盘 I/O。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101544.png" alt="Cockpit" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101556.png" alt="Cockpit" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101721.png" alt="Cockpit" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101728.png" alt="Cockpit" loading="lazy"></p>
<h3 id="添加-ssh-密钥" tabindex="-1"> 添加 SSH 密钥</h3>
<p>在右上角，单击您的用户名，然后单击“身份验证”。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101744.png" alt="Cockpit" loading="lazy"></p>
<p>如果您的 SSH 密钥位于其默认位置，则会自动检测到它，否则，您需要手动添加并启用它。这与您通过终端使用的 SSH 配置相同。如果您在本地使用 SSH 密码，则必须在单击下面显示的按钮后输入该密码。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101810.png" alt="Cockpit" loading="lazy"></p>
<h2 id="在-cockpit-仪表板中添加更多-linux-服务器" tabindex="-1"> <strong>在 Cockpit 仪表板中添加更多 Linux 服务器</strong></h2>
<p>通过这个简单的仪表板，您可以添加更多服务器以从单个界面进行监控。但要确保这一点，您必须确保满足以下先决条件：</p>
<ul>
<li>您已选中“重复使用我的密码执行特权任务”登录。</li>
<li>Cockpit 在添加之前安装在所有服务器上。</li>
<li>您的 SSH 密钥（此处假定为标准）已预先添加并启用</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101824.png" alt="Cockpit" loading="lazy"></p>
<p>要添加机器，而不是上面提到的 9090，您必须使用与远程服务器上相同的 SSH 端口号。默认情况下，它是 22。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101842.png" alt="Cockpit" loading="lazy"></p>
<p>单击“添加”后，您可能会收到如下错误：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101852.png" alt="Cockpit" loading="lazy"></p>
<p>这是因为，Cockpit 正在尝试使用与远程服务器的当前系统相同的凭据。在同一错误页面上（如上图所示），您可以将用户名更改为远程服务器可识别的名称。</p>
<p>完成此操作并单击登录后，将添加您的远程服务器。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101906.png" alt="Cockpit" loading="lazy"></p>
<h2 id="从-cockpit-中删除服务器" tabindex="-1"> <strong>从 Cockpit 中删除服务器</strong></h2>
<p>要删除已添加的服务器，您需要单击“编辑服务器”图标：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101920.png" alt="Cockpit" loading="lazy"></p>
<p>单击后，您可以删除标记为红色的添加服务器，另一个是灰色的，因为您无法删除当前连接的服务器。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/20220513101934.png" alt="Cockpit" loading="lazy"></p>
<p>请记住，删除的服务器将从该 Cockpit 的仪表板中删除。由于 Cockpit 仍然安装在该服务器上，您可以在服务器 IP 地址的端口 9090 上使用它。您应该卸载服务器的 Cockpit 程序。</p>
<h2 id="关于cockpit的最终想法" tabindex="-1"> <strong>关于Cockpit的最终想法</strong></h2>
<p>没想到它的用户界面如此简单，同时又是一款足智多谋的服务器监控软件！我一看到它超级直观的仪表板和界面统计信息就爱上了它！</p>
<p>并不是说我没有想到将Cockpit 安装为 Docker 容器，但它的设计并不是很理想。来自此 GitHub链接的以下引用非常清楚：</p>
<p>“Cockpit的设计方式，它真的希望/需要在整台机器上运行，而不是单任务 docker 应用程序容器。”</p>
<p>但如果您仍想尝试，请查看这个非官方的 docker 镜像。它还包括一个 docker compose 配置供您开始使用。</p>
<p>对于不愿意使用命令行的人来说，Cockpit 是一个非常方便的工具。对于经验丰富的系统管理员来说，在一个仪表板下概览多个 Linux 服务器也很方便。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Linux" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-23T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">分布式JVM监控工具</title>
    <id>https://blog.ciberviler.top/dev/%E5%88%86%E5%B8%83%E5%BC%8FJVM%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7.html</id>
    <link href="https://blog.ciberviler.top/dev/%E5%88%86%E5%B8%83%E5%BC%8FJVM%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7.html"/>
    <updated>2022-05-24T08:24:43.000Z</updated>
    <content type="html"><![CDATA[<h1 id="分布式jvm监控工具" tabindex="-1"> 分布式JVM监控工具</h1>
<h2 id="介绍" tabindex="-1"> 介绍</h2>
<p><strong>该项目为了方便开发者更快监控多个远程主机jvm，如果你的项目是Spring boot那么很方便集成，jar包引入即可，不是Spring boot也不用气馁，你可以快速自行初始化一个Spirng boot程序引入jar包即可</strong></p>
<h2 id="效果展示" tabindex="-1"> 效果展示</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-16533795511054.png" alt="分布式JVM监控工具" loading="lazy"></p>
<h2 id="整体架构" tabindex="-1"> 整体架构</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-16533795511055.png" alt="分布式JVM监控工具" loading="lazy"></p>
<h2 id="git地址" tabindex="-1"> git地址</h2>
<p><a href="https://github.com/xk4848123/monitor" target="_blank" rel="noopener noreferrer">https://github.com/xk4848123/monitor</a>
<a href="https://github.com/xk4848123/monitor-server" target="_blank" rel="noopener noreferrer">https://github.com/xk4848123/monitor-server</a></p>
<h2 id="使用前提" tabindex="-1"> 使用前提</h2>
<p>需要机器中有JDK，不仅仅是JRE，配置好java path，程序中依靠ExcuteCmd找寻jdk基本命令</p>
<h2 id="手把手教你用" tabindex="-1"> 手把手教你用</h2>
<h3 id="克隆monitor-server" tabindex="-1"> 克隆monitor-server</h3>
<div><pre><code><span>git</span> clone https://github.com/xk4848123/monitor-server.git
</code></pre><div aria-hidden="true"><div></div></div></div><p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-16533795511051.png" alt="分布式JVM监控工具" loading="lazy"></p>
<h3 id="idea-project-from-existing-sources" tabindex="-1"> idea -&gt; Project from Existing Sources…</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-16533795511052.png" alt="分布式JVM监控工具" loading="lazy"></p>
<h3 id="选中项目pom-xml" tabindex="-1"> 选中项目pom.xml</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-16533795511053.png" alt="分布式JVM监控工具" loading="lazy"></p>
<h3 id="修改resources-application-properties" tabindex="-1"> 修改resources/application.properties</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-16533795511064.png" alt="分布式JVM监控工具" loading="lazy"></p>
<div><pre><code>monitor<span>.</span>serve<span>[</span><span>0</span><span>]</span><span>.</span>name<span>=</span>serve<span>-</span><span>1</span>
monitor<span>.</span>serve<span>[</span><span>0</span><span>]</span><span>.</span>address<span>=</span>http<span>:</span><span>/</span><span>/</span><span>127.0</span><span>.0</span><span>.1</span><span>:</span><span>8081</span><span>/</span><span>monitor</span><span>(</span>这里需要与客户端的monitor<span>.</span>path对应<span>)</span>
monitor<span>.</span>serve<span>[</span><span>1</span><span>]</span><span>.</span>name<span>=</span>serve<span>-</span><span>2</span>
monitor<span>.</span>serve<span>[</span><span>1</span><span>]</span><span>.</span>address<span>=</span>http<span>:</span><span>/</span><span>/</span><span>127.0</span><span>.0</span><span>.1</span><span>:</span><span>8082</span><span>(</span>同上<span>)</span>
<span>.</span><span>.</span><span>.</span><span>.</span>
<span>12345</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>这里可以配置多个监控主机,格式注意下</p>
<div><pre><code>address=http://ip:port/xxx(xxx是你在monitor上配置的，下文中会有)
name=server-1(每个monitor不同即可，便于显示时区分)
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h3 id="run-monitor-server" tabindex="-1"> run monitor-server</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-16533795511065.png" alt="分布式JVM监控工具" loading="lazy">
有异常没关系，我们把监控客户端也部起来就好了</p>
<h3 id="说在前面" tabindex="-1"> 说在前面</h3>
<p>一个操作系统内部署一个监控客户端就好，当你有个多个<a href="https://so.csdn.net/so/search?q=jvm&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">jvm</a>程序时，只要有一个部署就可以监控</p>
<h3 id="下载release" tabindex="-1"> 下载Release</h3>
<p><a href="https://github.com/xk4848123/monitor" target="_blank" rel="noopener noreferrer">https://github.com/xk4848123/monitor</a></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-16533795511066.png" alt="分布式JVM监控工具" loading="lazy"></p>
<h3 id="进入release列表-下载jar" tabindex="-1"> 进入Release列表，下载jar</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-16533795511067.png" alt="分布式JVM监控工具" loading="lazy"></p>
<h3 id="本地mvn-install-等到博主把jar传到中心仓库就不用这么么麻烦了" tabindex="-1"> 本地mvn install(等到博主把jar传到中心仓库就不用这么么麻烦了)</h3>
<p><strong>cmd执行以下命令</strong></p>
<div><pre><code>mvn install:install-file -DgroupId<span>=</span>com.github.xk4848123 -DartifactId<span>=</span>monitor-spring-boot-starter -Dversion<span>=</span><span>2.3</span>.1 -Dpackaging<span>=</span>jar -Dfile<span>=</span>C:<span>\</span>Users<span>\</span>Administrator<span>\</span>Downloads<span>\</span>monitor-spring-boot-starter.jar
</code></pre><div aria-hidden="true"><div></div></div></div><p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-16533795511068.png" alt="分布式JVM监控工具" loading="lazy"></p>
<h3 id="在任意一个spring-boot项目中使用-我这里打开我本地一个叫chat的项目" tabindex="-1"> 在任意一个Spring boot项目中使用，我这里打开我本地一个叫chat的项目</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-16533795511069.png" alt="分布式JVM监控工具" loading="lazy"></p>
<h3 id="在resources-application-properties增加属性" tabindex="-1"> 在resources/application.properties增加属性</h3>
<div><pre><code>#决定访问路径<span>,</span>可以自行定义
monitor<span>.</span>path<span>=</span>monitor
#决定是否启动监控客户端
monitor<span>.</span>enable<span>=</span><span>true</span>
<span>1234</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-165337955110610.png" alt="分布式JVM监控工具" loading="lazy"></p>
<h3 id="pom-xml引入" tabindex="-1"> pom.xml引入</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-165337955110611.png" alt="分布式JVM监控工具" loading="lazy"></p>
<h3 id="跑起项目" tabindex="-1"> 跑起项目</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-165337955110612.png" alt="分布式JVM监控工具" loading="lazy">
OK！</p>
<h3 id="我们现在访问monitor-server-我当下部署的在http-127-0-0-1-8888-大家根据自己的配置访问" tabindex="-1"> 我们现在访问monitor-server(我当下部署的在<a href="http://127.0.0.1:8888" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8888</a>,大家根据自己的配置访问)</h3>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/t_70-165337955110613.png" alt="分布式JVM监控工具" loading="lazy"></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-24T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">OpenSSL生成自签名证书</title>
    <id>https://blog.ciberviler.top/linux/OpenSSL%E7%94%9F%E6%88%90%E8%87%AA%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6.html</id>
    <link href="https://blog.ciberviler.top/linux/OpenSSL%E7%94%9F%E6%88%90%E8%87%AA%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6.html"/>
    <updated>2022-05-23T02:51:36.000Z</updated>
    <content type="html"><![CDATA[<h1 id="使用openssl生成自签名证书-实现https传输" tabindex="-1"> 使用OpenSSL生成自签名证书，实现HTTPS传输</h1>
<p><strong>导读</strong></p>
<p>SSL协议是一种网络安全协议，用于加密浏览器和服务器之间传输的数据信息。SSL证书就是遵守SSL协议，由数字证书颁发机构CA在验证服务器身份后颁发的一种数字证书，网站通过部署SSL证书实现加密传输数据。如果网站涉及敏感信息，例如：登录账号及口令、身份证号码、手机号码等重要个人信息，或者医院、银行、保险公司等机构的重要业务数据，则需要使用SSL证书，防止信息被第三方窃听和篡改。</p>
<p>SSL证书可分为专业证书（由受信任的证书颁发机构签名的证书）和自签名证书。专业证书由可信任的CA安全机构颁发，机构颁发给用户的证书是唯一可信任的，不可被伪造，此外，它们还具有保护措施来减少错误颁发和其他类型的欺诈行为。专业证书的安全性越高，申请证书的费用越昂贵，于是一些企业将目光转向了自签名证书。自签名证书是可以自己签发的SSL证书，相比于专业证书，自签名证书签发流程简单，几乎0成本，且同样使用与专业证书相同的方法加密传输数据。可是制作难度低，意味着自签名证书极容易被恶意模仿，进而伪造成有同样证书的假冒网站，所以面向公众的网站使用自签名证书存在一定安全风险。但在一些安全可控的网络环境下，为了节省网站建设成本，可以考虑使用自签名证书，例如：测试环境，具备安全防护的内网环境，面向内部、少数人员使用的不涉及敏感数据的网站等。</p>
<h2 id="_01-openssl介绍" tabindex="-1"> <strong>01 OpenSSL介绍</strong></h2>
<p>在计算机网络上，OpenSSL是一个开放源代码的软件库包，应用程序可以使用这个包来进行安全通信，避免窃听，同时确认对端连接者的身份。这个包广泛被应用在互联网的网页服务器上。作为一个基于密码学的安全开发包，OpenSSL提供的功能相当强大和全面，囊括了主要的密码算法、常用的密钥和证书封装管理功能以及SSL协议[1]。</p>
<p>OpenSSL在Linux操作系统、Windows操作系统、MAC操作系统里均可安装使用，本文实例操作演示是在Linux操作系统下安装和使用。</p>
<h2 id="_02-ssl证书握手流程图" tabindex="-1"> <strong>02 SSL证书握手流程图</strong></h2>
<p>如下图所示，基于RSA握手和密钥交换的客户端验证服务器端为示例详解SSL证书握手过程[2]。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16532729545682.png" alt="图片" loading="lazy"></p>
<h2 id="_03-自签名证书生成过程" tabindex="-1"> <strong>03 自签名证书生成过程</strong></h2>
<p><strong>3.1环境及证书生成流程：</strong></p>
<p>本文实例操作模拟的是内网环境，演示所使用的环境如下：</p>
<p>CentOS 7虚拟机（模拟服务器端），Nginx服务器，Windows 10 本机（模拟客户端）。</p>
<p>自签名证书生成与部署流程如下图所示：</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16532729545681.png" alt="图片" loading="lazy"></p>
<p><strong>3.2搭建私有CA</strong></p>
<p><strong>命令：yum install openssl-devel</strong></p>
<p>在CentOS 7虚拟机上安装OpenSSL。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16532729545692.png" alt="图片" loading="lazy"></p>
<p><strong>命令：openssl genrsa -out /etc/pki/CA/private/cakey.pem 2048</strong></p>
<p>生成基于非对称加密算法的私钥文件。</p>
<p>genrsa  用于生成RSA密钥对的OpenSSL命令</p>
<p>-out   输出文件的保存位置</p>
<p>2048   表示密钥强度</p>
<p>【注：OpenSSL-1.1.1及以上版本可使用命令（openssl ecparam -genkey -name SM2 -out priv.key）生成基于SM2国密算法的私钥文件】</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16532729545693.png" alt="图片" loading="lazy"></p>
<p><strong>命令：openssl req -new -x509 -key /etc/pki/CA/private/cakey.pem -out /etc/pki/CA/cacert.pem -days 900</strong></p>
<p>生成私有CA的自签名证书。依次填入国家、省份、地区、公司名称、部门名称、CA服务器的主机名、管理员邮箱。</p>
<p>相关字段的信息</p>
<div><pre><code>C  => 国家 Country 
ST => 省 State
L  => 市 City
O  => 机构 Organization
OU => 部门 Organization Unit
CN => 域名 Common Name (证书所请求的域名)
emailAddress => main administrative point of contact for the certificate
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="req-指令" tabindex="-1"> req 指令</h4>
<p>req指令既可以直接生成一个新的自签名证书，也可以根据现有的证书请求和其相应私钥生成自签名根证书。如果是根据现有证书请求生成自签名根证书，那么一定要-key选项指定相应的私钥指令才能执行成功。</p>
<p>req 指令也可以生成密钥对，但在使用req 同时生成密钥对是对密钥对保存和格式有限制（只能是PEM编码，DES3-CBC模式加密）。如果需要更灵活的处理，可以使用genrsa或者gendsa先生成密钥然后使用-key选项指定。</p>
<p>参数选项</p>
<ul>
<li>-new 指定执行生成新的证书请求，此时会忽略-in 指定的内容</li>
<li>-x509 根据现有的证书请求生成自签名根证书（要求使用-key指定证书请求里面的公钥相应的私钥，以便对自签名根证书进行签名）</li>
<li>-key 指定输入的密钥，如果不指定此选项会根据-newkey选项的参数生成密钥对</li>
<li>-newkey 指定生成一个新的密钥对，只有在没有-key 选项的时候才生效，参数形式为rsa:numbits 或者 dsa:file</li>
<li>-subj直接从指令行指定证书请求的主体名称，格式为/分割的键值对字符串，如果没有此选项，那么会弹出交互提示；</li>
<li>-days 设定了生成的自签名根证书的有效期，单位为天；该选项只有在使用了-x509选项生成自签名证书的时候才生效，默认为30天。</li>
<li>-config 指定req指令在生成证书请求的时候使用的OpenSSL配置文件，一般默认为openssl.cnf</li>
<li>-extensions 选项指定了生成自签名根证书的时候使用的扩展字段，其参数为OpenSSL配置文件中的某个字段名</li>
<li>-reqexts 选项指定了生成证书请求是使用的扩展字段，该字段参数也是配置文件中的某个字段名</li>
<li>-text 让指令输出证书请求或者自签名根证书内容的明文解析，默认情况下，它将输出所有可能输出的内容，如果使用了reqopt选项，则输出内容取决于reqopt选项</li>
<li>-reqopt 指定text 选项输出的内容,可以为多个，每个之间使用,分隔</li>
<li>set_serial指定生成的自签名根证书的序列号，默认情况下生成的自签名根证书序列号是0；该选项也只有在生成自签名根证书的时候有效。</li>
<li>-keyout 置顶新生成的私钥的输出（仅在使用了-newKey 或-new 选项导致生成新密钥对的时候才有效，如果使用了-key则此选项被忽略）</li>
<li>-keyform 指定输入密钥的编码格式（比如PEM，DER，PKCS#12，Netscape，IIS SGC，Engine等）</li>
<li>-in 指定输入证书请求文件，如果使用了-new 或者 -newkey选项，此选项被忽略</li>
<li>-inform 指定输入证书请求文件的编码格式（比如PEM，DER）</li>
<li>-out 指定输出证书请求文件或自签名证书文件</li>
<li>-noout 使用此选项后，指令将不会输出编码的证书请求或者自签名根证书到-out选项指定的文件中，一般用来测试指令或者查看证书请求的信息</li>
<li>-outform 指定输出证书请求文件或自签名证书的编码格式（比如PEM,DER）</li>
<li>-pubkey 使用此选项活 指令将输出PEM编码的公钥到-out选择指定的文件中，默认情况下只输出私钥到-keyout指定的文件，并不输出公钥。</li>
<li>-passin 指定读取-key 选项指定的私钥所需要的解密口令，如果没有指定，私钥又有密钥的话，会弹出交互提示</li>
<li>-passout 指定-keyout 选项输出私钥时使用的加密口令</li>
<li>-nodes 表示不对私钥进行加密，如果指定此选项，则忽略-passout指定的口令；如果没有此选项，却指定了-passout则会有交互提示。</li>
<li>-digest 指定生成证书请求或者自签名根证书是使用的信息摘要算法，一般在生成数字签名的时候使用。</li>
<li>-verify 使用此选项对证书请求中的数字签名进行验证操作，并给出失败或者成功的提示信息，其验证的过程是从证书请求里面提取公钥，然后使用该公钥对证书请求的数字签名进行验证。</li>
<li>如果没有-key选项也没有-newkey选项，则会根据openssl.cnf中req字段的default_bits选项的参数，生成一个RSA密钥</li>
<li>如果没有使用-nodes选项，并且生成了新的私钥，私钥会被输出到-keyout指定的文件中时将被以DES3的CBC模式加密。</li>
</ul>
<p>【注：参数中带-x509表示直接生成自签证书，不带则表示生成证书签署请求】</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16532729545694.png" alt="图片" loading="lazy"></p>
<h4 id="x509" tabindex="-1"> x509</h4>
<p>x509指令能已各种方式显示一个证书的内容，也可以对一个证书的格式进行转换，还可以签发证书</p>
<p>参数选项</p>
<ul>
<li>-in</li>
<li>-inform</li>
<li>-out</li>
<li>-outform</li>
<li>-keyform</li>
<li>-CA 指定签发证书或者转换证书格式的时候需要的CA证书文件</li>
<li>-CAkey 指定签发证书或者转换证书格式时需要的CA证书对应的私钥文件路径</li>
<li>-CAform 指定CA证书文件的格式</li>
<li>-CAkeyform 私钥文件格式</li>
<li>-startdate</li>
<li>-enddate</li>
<li>-pubkey</li>
<li>-noout</li>
</ul>
<p><strong>命令：touch /etc/pki/CA/index.txt</strong></p>
<p>生成证书索引数据库文件。</p>
<p><strong>命令：echo 01 &gt; /etc/pki/CA/serial</strong></p>
<p>指定第一个颁发证书的序列号。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16532729545695.png" alt="图片" loading="lazy"></p>
<p><strong>3.3签署CA用户服务器证书</strong></p>
<p><strong>命令：openssl genrsa -out test.key 2048</strong></p>
<p>生成CA用户服务器的私钥文件。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16532729545696.png" alt="图片" loading="lazy"></p>
<p><strong>命令：openssl req -new -key test.key -out test.csr</strong></p>
<p>生成请求签署文件。依次填入国家、省份、地区、公司名称、部门名称、虚拟机IP地址（192.168.231.135）、管理员邮箱。</p>
<p>Conmon Name  此处填写要申请SSL证书认证的域名/IP地址</p>
<p>A challenge password 为了保证证书在互联网中传输安全可以添加密码，如不添加密码可以两次回车跳过</p>
<p>【注：此文件中的国家、省份、地区、公司名称必须与CA自签名证书一致】</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16532729545697.png" alt="图片" loading="lazy"></p>
<h4 id="ca-指令" tabindex="-1"> ca 指令</h4>
<p>ca指令模拟一个完整的CA服务器，它包括签发用户证书，吊销证书，产生CRL及更新证书库等管理操作</p>
<p>参数选项</p>
<ul>
<li>-config 指定要使用的配置文件，如果没有此选项，则会先查找OPENSSL_CONF或者SSLEAY_CONF定义的文件名，如果这两个环境变量都没有定义，就使用OpenSSL安装的默认路径，一般是/usr/local/openssl/openssl.cnf，具体看安装配置</li>
<li>-startdate 设置证书的生效时间 格式为YYMMDDHHMMSSZ指定年月日时分秒，如果没有则使用主配置文件中的default_startdate</li>
<li>-enddate 格式跟-startdate一样</li>
<li>-days 设置证书的有效天数，生效时间到到期时间之间的天数，如果使用了-enddate，此选项被忽略</li>
<li>-name 指定配置文件中CA选项的名称</li>
<li>-notext 不输出明文信息到证书文件</li>
<li>-subj直接从指令行指定证书请求的主体名称，格式为/分割的键值对字符串，如果没有此选项，那么会弹出交互提示；</li>
<li>-cert 参数是一个可以包含路径的文件名，该文件是一个PEM编码的X.509证书文件</li>
<li>-keyfile 参数是一个包含路径的文件名，文件格式可以为PEM，DER，PKCS#12，Netscape，IIS SGC，Engine，但需要通过-keyform指定到底是哪种格式</li>
<li>-policy 指定CA的匹配策略</li>
<li>-extensions 指定x509 v3扩展字段的字段名，如果没有这个选项就由-extfile中内容</li>
<li>-extfile 指定x509 v3扩展的配置文件，如果没有-extensions字段，则由CA主配置文件中的x509_extensions选项指定</li>
<li>-in 指定一个可以包含路径的证书请求文件名，应该是PEM变得PKCS#10格式的证书请求</li>
<li>-infiles指定一系列包含PEM编码证书请求的文件，包含多个，只能作为指令的最后一个选项，其后的参数都被认为是证书请求文件</li>
<li>-out 选项指定了输出签发好的证书或者新生成的CRL的文件，如果没有使用-notext选项，那么证书的明文信息也会输出到-out选项指定的文件中</li>
<li>-outdir选项指定了新生成的证书的输出目录，默认输出到newecerts目录，并使用.pem作为后缀，都是PEM编码。</li>
</ul>
<p><strong>命令：openssl ca -in test.csr -out test.crt -days 300</strong></p>
<p>使用前面搭建的私有CA对用户的证书请求进行签名，为用户颁发证书。</p>
<p>-in 证书请求签署文件</p>
<p>-out 签发后的证书文件</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16532729545698.png" alt="图片" loading="lazy"></p>
<h2 id="_04-部署自签名证书" tabindex="-1"> <strong>04 部署自签名证书，</strong></h2>
<p><strong>实现HTTPS加密传输</strong></p>
<p><strong>命令：yum install nginx</strong></p>
<p>安装Nginx服务器。Nginx服务器位于客户端与目标服务器之间，提供正向代理功能，客户端访问目标服务器的请求，需通过Nginx进行处理再转交给目标服务器，并将获得的内容返回给客户端，本文通过Nginx服务器部署自签名证书。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-16532729545699.png" alt="图片" loading="lazy"></p>
<p>图10在/usr/share/nginx/html目录下放入编写好的静态网页index.html。从客户端访问虚拟机地址：<a href="http://192.168.231.135" target="_blank" rel="noopener noreferrer">http://192.168.231.135</a> ，如下图所示，可访问静态网页，并具有“不安全”的提示字样。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-165327295456910.png" alt="图片" loading="lazy"></p>
<p>**令：cp /test.key /etc/nginx
**</p>
<p><strong>命令：cp /test.crt /etc/nginx</strong></p>
<p>将在根目录下的证书test.crt、私钥文件test.key复制到/etc/nginx/目录下。</p>
<p><strong>命令：cd /etc/nginx</strong></p>
<p><strong>命令：vim nginx.conf</strong></p>
<p>进入nginx所在的目录，通过vim指令访问nginx.conf配置文件。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-165327295456911.png" alt="图片" loading="lazy"></p>
<p>修改nginx.conf配置文件，在ssl_certificate字段后面填写证书test.crt的路径；在ssl_certificate_key字段后面填写私钥文件test.key的路径；在root字段后添加静态网页所在的目录；配置完成后退出vim模式。</p>
<p><strong>命令：systemctl restart nginx</strong></p>
<p>重启Nginx服务。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-165327295456912.png" alt="图片" loading="lazy"></p>
<p>从客户端浏览器访问地址：<a href="https://192.168.231.135" target="_blank" rel="noopener noreferrer">https://192.168.231.135</a> ，如下图所示，浏览器提示“您的连接不是私密连接”， 这是因为自签名证书不受浏览器的信任，浏览器就会弹出安全警告，需要用户确认访问此连接。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-165327295456913.png" alt="图片" loading="lazy"></p>
<p>点击“高级”按钮，选择“继续前往192.168.231.135（不安全）”，通过HTTPS请求访问到静态网页，证明自签名证书部署成功。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-165327295457014.png" alt="图片" loading="lazy"></p>
<p>可以从火狐浏览器查看自签名证书的相关信息。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-165327295457015.png" alt="图片" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-165327295457016.png" alt="图片" loading="lazy"></p>
<p>打开nginx.conf文件，在监听80端口（HTTP协议默认端口）的配置中，添加语句：**rewrite ^(.)$ <a href="https://192.168.231.135" target="_blank" rel="noopener noreferrer">https://192.168.231.135</a> permanent;**可使HTTP请求重定向为HTTPS请求。重启Nginx服务后，从客户端访问地址：<a href="http://192.168.231.135" target="_blank" rel="noopener noreferrer">http://192.168.231.135</a>，将自动跳转为<a href="https://192.168.231.135" target="_blank" rel="noopener noreferrer">https://192.168.231.135</a> 。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/640-165327295457017.png" alt="图片" loading="lazy"></p>
<h2 id="_05-总结" tabindex="-1"> <strong>05 总结</strong></h2>
<p>自签名证书可以由公司、软件开发商或个人用户创建、颁发和签名，虽然自签名证书使用的是与X.509证书相同的加密密钥对架构，但是缺少受信任第三方（如DigiCert、GeoTrust、GlobalSign）的验证。在颁发过程中缺乏独立验证会产生额外的风险，容易被攻击者假冒和伪造，这就是为什么对于面向公众的网站和应用程序来说，自签名证书是不安全的。</p>
<p>此外，自签名SSL证书不被浏览器信任，用户在访问自签名证书网站时，浏览器会发出安全警告提示用户此证书不受信任，需要人工确认是否信任该证书，用户只有点击信任后才可继续浏览网站。长此以往，用户逐渐养成了忽略浏览器警告提示的习惯，这就给了攻击者可乘之机，使网站更容易受到中间人攻击[5]。</p>
<p>综上所述，面向互联网的应用系统不建议使用自签名证书，即使实现了HTTPS加密传输，也不能保证数据传输的安全性。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Linux" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-21T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">SpringBoot项目中引用百度云人脸识别功能实现人脸识别登录</title>
    <id>https://blog.ciberviler.top/dev/springboot%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB%E7%99%BB%E5%BD%95.html</id>
    <link href="https://blog.ciberviler.top/dev/springboot%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB%E7%99%BB%E5%BD%95.html"/>
    <updated>2022-05-22T14:20:33.000Z</updated>
    <content type="html"><![CDATA[<h1 id="springboot项目中引用百度云人脸识别功能实现人脸识别登录" tabindex="-1"> SpringBoot项目中引用百度云人脸识别功能实现人脸识别登录</h1>
<p><strong>需求分析：</strong></p>
<p>一、人脸注册</p>
<p>step1：人像采集。在注册页面上用html中video组件和js调用笔记本摄像头，并抓取人像图片。没有摄像头的笔记本、台式机的童鞋告辞吧，走好不送。。。</p>
<p>step2：人像上传至项目文件夹。将在页面采集到的人像数据转换成bash64字符传输到web后台，在后台将bash64转换成图片上传至项目文件夹。</p>
<p>step3：将用户的注册信息写入数据库，用户的照片使用路径存储。</p>
<p>step4：将采集到的人像信息（bash64）上传至百度云的人脸识别云端服务器。ps这块实现也可离线私有化处理方案，有兴趣的童鞋可自行研究。</p>
<p>二、人脸登录</p>
<p>step1：人像采集。在登录页面上用html中video组件和js调用笔记本摄像头，并抓取人像图片。</p>
<p>step2：人像数据传输。抓取的人脸图片信息回传至web后台。</p>
<p>step3：人像比对。在web后台实例化并调用百度云人脸识别的sdk，将登录页面采集到的图像数据和注册的图像信息相比对（这块是百度云人脸识别解决方案实现的，也是最牛B的地方），返回的比分大于95分即可实现登录。</p>
<p><strong>具体实现：</strong></p>
<p>好了，前言和需求分析也哔哔了这么久了，接下来是实现和上代码了。</p>
<p>一、人脸注册</p>
<p>前端页面代码</p>
<div><pre><code><span><span>&lt;!</span><span>DOCTYPE</span> <span>html</span><span>></span></span>
<span><span><span>&lt;</span>html</span><span>></span></span>
<span><span><span>&lt;</span>head</span><span>></span></span>
<span><span><span>&lt;</span>meta</span> <span>charset</span><span><span>=</span><span>"</span>UTF-8<span>"</span></span><span>></span></span>
<span><span><span>&lt;</span>title</span><span>></span></span>Insert title here<span><span><span>&lt;/</span>title</span><span>></span></span>
 <span><span><span>&lt;</span>style</span> <span>type</span><span><span>=</span><span>"</span>text/css<span>"</span></span><span>></span></span><span><span>
   <span>/**解决浏览器兼容性问题**/</span>
  <span>*</span><span>{</span><span>margin</span><span>:</span> 0<span>;</span><span>padding</span><span>:</span> 0<span>;</span><span>}</span>
  <span>html,body</span><span>{</span><span>width</span><span>:</span> 100%<span>;</span><span>height</span><span>:</span> 100%<span>;</span><span>}</span><span>/**/</span>
  <span>body</span><span>{</span><span>background</span><span>:</span> <span><span>url</span><span>(</span>img/bg03.jpg?watermark/2/text/5YWs5LyX5Y-377yaSmF2YeWfuuWfug/font/5a6L5L2T/fontsize/400/fill/cmVk<span>)</span></span> no-repeat center<span>;</span><span>}</span>
  <span>h1</span><span>{</span><span>color</span><span>:</span> #fff<span>;</span><span>text-align</span><span>:</span> center<span>;</span><span>line-height</span><span>:</span> 80px<span>;</span><span>}</span>
  <span>.media</span><span>{</span><span>width</span><span>:</span> 534px<span>;</span><span>height</span><span>:</span> 400px<span>;</span><span>margin</span><span>:</span> 40px auto 0<span>;</span>
    <span>}</span>
  <span>#register</span><span>{</span><span>width</span><span>:</span> 200px<span>;</span><span>height</span><span>:</span>50px<span>;</span><span>background-color</span><span>:</span> #2196f3<span>;</span> <span>margin</span><span>:</span> 60px auto 0<span>;</span>
  <span>text-align</span><span>:</span> center<span>;</span><span>line-height</span><span>:</span> 50px<span>;</span><span>color</span><span>:</span> #fff<span>;</span><span>border-radius</span><span>:</span> 10px<span>;</span><span>}</span>
  <span>#canvas</span><span>{</span><span>display</span><span>:</span> none<span>;</span><span>}</span>
  <span>#shuru</span><span>{</span><span>width</span><span>:</span> 200px<span>;</span><span>height</span><span>:</span>50px<span>;</span><span>background-color</span><span>:</span> #2196f3<span>;</span> <span>margin</span><span>:</span> 20px auto 0<span>;</span><span>}</span>
 </span></span><span><span><span>&lt;/</span>style</span><span>></span></span>
<span><span><span>&lt;/</span>head</span><span>></span></span>
<span><span><span>&lt;</span>body</span><span>></span></span>
 <span><span><span>&lt;</span>h1</span><span>></span></span>百度云人脸注册<span><span><span>&lt;/</span>h1</span><span>></span></span>
 <span><span><span>&lt;</span>div</span> <span>id</span><span><span>=</span><span>"</span>shuru<span>"</span></span><span>></span></span>
 用户名：
 <span><span><span>&lt;</span>input</span> <span>type</span><span><span>=</span><span>"</span>text<span>"</span></span> <span>name</span><span><span>=</span><span>"</span>username<span>"</span></span> <span>id</span><span><span>=</span><span>"</span>username<span>"</span></span><span>/></span></span>
 <span><span><span>&lt;/</span>div</span><span>></span></span>
 
 <span><span><span>&lt;</span>div</span> <span>class</span><span><span>=</span><span>"</span>media<span>"</span></span><span>></span></span>
  <span><span><span>&lt;</span>video</span> <span>id</span><span><span>=</span><span>"</span>video<span>"</span></span> <span>width</span><span><span>=</span><span>"</span>450<span>"</span></span> <span>height</span><span><span>=</span><span>"</span>300<span>"</span></span> <span>src</span><span><span>=</span><span>"</span><span>"</span></span> <span>autoplay</span><span>></span></span><span><span><span>&lt;/</span>video</span><span>></span></span>
  <span><span><span>&lt;</span>canvas</span> <span>id</span><span><span>=</span><span>"</span>canvas<span>"</span></span> <span>width</span><span><span>=</span><span>"</span>450<span>"</span></span> <span>height</span><span><span>=</span><span>"</span>300<span>"</span></span><span>></span></span><span><span><span>&lt;/</span>canvas</span><span>></span></span>
  
 <span><span><span>&lt;/</span>div</span><span>></span></span>
 <span><span><span>&lt;</span>button</span> <span>id</span><span><span>=</span><span>"</span>register<span>"</span></span> <span>></span></span>确定注册<span><span><span>&lt;/</span>button</span><span>></span></span>
 <span><span><span>&lt;</span>script</span> <span>type</span><span><span>=</span><span>"</span>text/javascript<span>"</span></span> <span>src</span><span><span>=</span><span>"</span>js/jquery-3.3.1.js<span>"</span></span><span>></span></span><span></span><span><span><span>&lt;/</span>script</span><span>></span></span>
 <span><span><span>&lt;</span>script</span> <span>type</span><span><span>=</span><span>"</span>text/javascript<span>"</span></span><span>></span></span><span><span>
 <span>/**调用摄像头，获取媒体视频流**/</span>
 <span>var</span> video <span>=</span> document<span>.</span><span>getElementById</span><span>(</span><span>'video'</span><span>)</span><span>;</span>
 <span>//返回画布二维画图环境</span>
 <span>var</span> userContext <span>=</span> canvas<span>.</span><span>getContext</span><span>(</span><span>"2d"</span><span>)</span><span>;</span>
 <span>var</span> getUserMedia <span>=</span> 
  <span>//浏览器兼容,表示在火狐、Google、IE等浏览器都可正常支持</span>
  <span>(</span>navigator<span>.</span>getUserMedia <span>||</span> navigator<span>.</span>webkitGetUserMedia <span>||</span> navigator<span>.</span>mozGetUserMedia <span>||</span> navigator<span>.</span>msGetUserMedia<span>)</span>
  <span>//getUserMedia.call(要调用的对象，约束条件，调用成功的函数，调用失败的函数)</span>
  <span>getUserMedia</span><span>.</span><span>call</span><span>(</span>navigator<span>,</span><span>{</span><span>video</span><span>:</span> <span>true</span><span>,</span><span>audio</span><span>:</span> <span>false</span><span>}</span><span>,</span><span>function</span><span>(</span><span>localMediaStream</span><span>)</span><span>{</span>
   <span>//获取摄像头捕捉的视频流</span>
   video<span>.</span>srcObject<span>=</span>localMediaStream<span>;</span>
  <span>}</span><span>,</span><span>function</span><span>(</span><span>e</span><span>)</span><span>{</span>
   console<span>.</span><span>log</span><span>(</span><span>"获取摄像头失败！！"</span><span>)</span>
  <span>}</span><span>)</span><span>;</span>
 <span>//点击按钮注册事件</span>
  <span>var</span> btn <span>=</span> document<span>.</span><span>getElementById</span><span>(</span><span>"register"</span><span>)</span><span>;</span>
 
 btn<span>.</span><span>onclick</span> <span>=</span> <span>function</span> <span>(</span><span>)</span> <span>{</span>
  <span>var</span> username <span>=</span> <span>$</span><span>(</span><span>"#username"</span><span>)</span><span>.</span><span>val</span><span>(</span><span>)</span><span>;</span>
  <span>alert</span><span>(</span><span>$</span><span>(</span><span>"#username"</span><span>)</span><span>.</span><span>val</span><span>(</span><span>)</span><span>)</span><span>;</span>
   <span>if</span><span>(</span>username <span>!=</span> <span>null</span><span>)</span><span>{</span>
    <span>//点击按钮时拿到登陆者面部信息</span>
             userContext<span>.</span><span>drawImage</span><span>(</span>video<span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>450</span><span>,</span><span>300</span><span>)</span><span>;</span>
             <span>var</span> userImgSrc <span>=</span> document<span>.</span><span>getElementById</span><span>(</span><span>"canvas"</span><span>)</span><span>.</span><span>toDataURL</span><span>(</span><span>"img/png"</span><span>)</span><span>;</span>
             <span>//拿到bash64格式的照片信息</span>
             <span>var</span> faceBase <span>=</span> userImgSrc<span>.</span><span>split</span><span>(</span><span>","</span><span>)</span><span>[</span><span>1</span><span>]</span><span>;</span>
             
             <span>//ajax异步请求</span>
             $<span>.</span><span>ajax</span><span>(</span><span>{</span>
              <span>url</span><span>:</span> <span>"register"</span><span>,</span>
              <span>type</span><span>:</span> <span>"post"</span><span>,</span>
              <span>data</span><span>:</span> <span>{</span><span>"faceBase"</span><span>:</span> faceBase<span>,</span>
               <span>"userName"</span><span>:</span> username
              <span>}</span><span>,</span>
              <span>success</span><span>:</span> <span>function</span><span>(</span><span>result</span><span>)</span><span>{</span>
               <span>if</span><span>(</span>result <span>===</span> <span>'1'</span><span>)</span><span>{</span>
                <span>alert</span><span>(</span><span>"注册成功！！，点击确认跳转至登录页面"</span><span>)</span><span>;</span>
                window<span>.</span>location<span>.</span>href<span>=</span><span>"toLogin"</span><span>;</span>
               <span>}</span><span>else</span> <span>if</span><span>(</span>result <span>===</span> <span>'2'</span><span>)</span><span>{</span>
                <span>alert</span><span>(</span><span>"您已经注册过啦！！"</span><span>)</span><span>;</span>
               <span>}</span><span>else</span><span>{</span>
                <span>alert</span><span>(</span><span>"系统错误！！"</span><span>)</span><span>;</span>
               <span>}</span>
               
              <span>}</span>
             <span>}</span><span>)</span>
   <span>}</span><span>else</span><span>{</span>
    <span>alert</span><span>(</span><span>"用户名不能为空"</span><span>)</span><span>;</span>
   <span>}</span>
           
       <span>}</span> 
 </span></span><span><span><span>&lt;/</span>script</span><span>></span></span>
<span><span><span>&lt;/</span>body</span><span>></span></span>
<span><span><span>&lt;/</span>html</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>页面截图，本人太帅，先行打码，嘿嘿</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/16532156632002.png" alt="img" loading="lazy"></p>
<p>后台具体代码如下:</p>
<div><pre><code><span>private</span> <span>static</span> <span>final</span> <span>String</span> APP_ID <span>=</span> <span>"****"</span><span>;</span>
 
 <span>private</span> <span>static</span> <span>final</span> <span>String</span> API_KEY <span>=</span> <span>"*******"</span><span>;</span>
 
 <span>private</span> <span>static</span> <span>final</span> <span>String</span> SECRET_KEY <span>=</span> <span>"*******"</span><span>;</span>
 
 <span>@Autowired</span>
 <span>private</span> <span>IUserService</span> userService<span>;</span>
 
 
 <span>@RequestMapping</span><span>(</span>value <span>=</span> <span>"register"</span><span>,</span>method <span>=</span> <span>RequestMethod</span><span>.</span>POST<span>)</span>
 <span>public</span> <span>String</span> <span>register</span><span>(</span><span>String</span> userName<span>,</span><span>String</span> faceBase<span>)</span> <span>throws</span> <span>IOException</span> <span>{</span>
  <span>if</span><span>(</span><span>!</span><span>StringUtils</span><span>.</span><span>isEmpty</span><span>(</span>userName<span>)</span> <span>&amp;&amp;</span> <span>!</span><span>StringUtils</span><span>.</span><span>isEmpty</span><span>(</span>faceBase<span>)</span><span>)</span> <span>{</span>
    <span>//文件上传的地址</span>
         <span>String</span> upPath <span>=</span> <span>ResourceUtils</span><span>.</span><span>getURL</span><span>(</span><span>"classpath:"</span><span>)</span><span>.</span><span>getPath</span><span>(</span><span>)</span><span>+</span><span>"static\\photo"</span><span>;</span>
         <span>//用于查看路径是否正确</span>
         <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>upPath<span>)</span><span>;</span>
         <span>// 图片名称</span>
         <span>String</span> fileName <span>=</span> userName<span>+</span><span>System</span><span>.</span><span>currentTimeMillis</span><span>(</span><span>)</span> <span>+</span> <span>".png"</span><span>;</span>
         <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>upPath<span>+</span><span>"\\"</span><span>+</span>fileName<span>)</span><span>;</span>
         <span>File</span> file <span>=</span> <span>new</span> <span>File</span><span>(</span>upPath<span>+</span><span>"\\"</span><span>+</span>fileName<span>)</span><span>;</span>
   <span>//初始化百度云的AipFace</span>
   <span>AipFace</span> client <span>=</span> <span>new</span> <span>AipFace</span><span>(</span>APP_ID<span>,</span> API_KEY<span>,</span> SECRET_KEY<span>)</span><span>;</span>
   
   <span>//往自己demo数据库里插入一条用户数据</span>
   <span>Users</span> user <span>=</span> <span>new</span> <span>Users</span><span>(</span><span>)</span><span>;</span>
   user<span>.</span><span>setUserName</span><span>(</span>userName<span>)</span><span>;</span>
   user<span>.</span><span>setUserPhoto</span><span>(</span>upPath<span>+</span><span>"\\"</span><span>+</span>fileName<span>)</span><span>;</span>
   <span>Users</span> exitUser <span>=</span> userService<span>.</span><span>selectUserByName</span><span>(</span>user<span>)</span><span>;</span>
   <span>if</span><span>(</span>exitUser <span>!=</span> <span>null</span><span>)</span> <span>{</span> 
    <span>return</span> <span>"2"</span><span>;</span>
   <span>}</span>
   userService<span>.</span><span>addUsers</span><span>(</span>user<span>)</span><span>;</span>
   
   
   <span>// 往自己demo服务器里面上传摄像头捕获的图片</span>
   <span>GenerateImage</span><span>(</span>faceBase<span>,</span> file<span>)</span><span>;</span>
   <span>//向百度云人脸库插入一张人脸</span>
   <span>facesetAddUser</span><span>(</span>client<span>,</span>faceBase<span>,</span>userName<span>)</span><span>;</span>
  <span>}</span>
  <span>return</span> <span>"1"</span><span>;</span>
  
 <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>APP_ID 、API_KEY、SECRET_KEY三个参数分别为百度云人脸识别上面的三个数据项，如下图</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/16532156632001.png" alt="img" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/16532156632012.png" alt="img" loading="lazy"></p>
<p>点击完注册按钮后，就会发现。。。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/16532156632013.png" alt="img" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/16532156632014.png" alt="img" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/16532156632015.png" alt="img" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/16532156632016.png" alt="img" loading="lazy"></p>
<p>到这就算一个用户注册成功了，个人这张大帅脸也算是录进去了，下面就是刷脸登录了。</p>
<p>二、刷脸登录</p>
<p>当我注册完周后就会进入登录页面</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/16532156632017.png" alt="img" loading="lazy"></p>
<p>这时我点击登录按钮，js触发后台方法，具体入下：</p>
<div><pre><code><span>@RequestMapping</span><span>(</span>value <span>=</span> <span>"login"</span><span>,</span>method <span>=</span> <span>RequestMethod</span><span>.</span>POST<span>)</span>
 <span>public</span> <span>String</span> <span>login</span><span>(</span><span>String</span> faceBase<span>)</span> <span>{</span>
  <span>String</span> faceData <span>=</span> faceBase<span>;</span>
  <span>//进行人像数据对比</span>
  <span>AipFace</span> client <span>=</span> <span>new</span> <span>AipFace</span><span>(</span>APP_ID<span>,</span>API_KEY<span>,</span>SECRET_KEY<span>)</span><span>;</span>
  <span>Double</span> num <span>=</span> <span>verifyUser</span><span>(</span>faceData<span>,</span>client<span>)</span><span>;</span>
  <span>if</span><span>(</span>num<span>></span><span>95</span><span>)</span> <span>{</span>
   <span>return</span> <span>"1"</span><span>;</span>
  <span>}</span><span>else</span> <span>{</span>
   <span>return</span> <span>"2"</span><span>;</span>
  <span>}</span>
  
 <span>}</span>
 
 <span>/**
  * 人脸比对
  * <span>@param</span> <span>imgBash64</span> 照片转bash64格式
  * <span>@param</span> <span>imgType</span> 类型
  * <span>@param</span> <span>groupList</span> 百度云人脸识别用户组
  * <span>@return</span>
  */</span>
 <span>public</span> <span>Double</span> <span>verifyUser</span><span>(</span><span>String</span> imgBash64<span>,</span><span>AipFace</span> client<span>)</span> <span>{</span>
  <span>// 传入可选参数调用接口</span>
     <span>HashMap</span><span><span>&lt;</span><span>String</span><span>,</span> <span>String</span><span>></span></span> options <span>=</span> <span>new</span> <span>HashMap</span><span><span>&lt;</span><span>String</span><span>,</span> <span>String</span><span>></span></span><span>(</span><span>)</span><span>;</span>
     
     <span>JSONObject</span> res <span>=</span> client<span>.</span><span>search</span><span>(</span>imgBash64<span>,</span> <span>"BASE64"</span><span>,</span> <span>"user_01"</span><span>,</span> options<span>)</span><span>;</span>
     
     <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>res<span>.</span><span>toString</span><span>(</span><span>2</span><span>)</span><span>)</span><span>;</span>
     <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>res<span>.</span><span>getJSONObject</span><span>(</span><span>"result"</span><span>)</span><span>)</span><span>;</span>
     <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>res<span>.</span><span>getJSONObject</span><span>(</span><span>"result"</span><span>)</span><span>.</span><span>getJSONArray</span><span>(</span><span>"user_list"</span><span>)</span><span>)</span><span>;</span>
     <span>JSONObject</span> user <span>=</span> <span>(</span><span>JSONObject</span><span>)</span> res<span>.</span><span>getJSONObject</span><span>(</span><span>"result"</span><span>)</span><span>.</span><span>getJSONArray</span><span>(</span><span>"user_list"</span><span>)</span><span>.</span><span>get</span><span>(</span><span>0</span><span>)</span><span>;</span>
     <span>Double</span> score <span>=</span> <span>(</span><span>Double</span><span>)</span> user<span>.</span><span>get</span><span>(</span><span>"score"</span><span>)</span><span>;</span>
     
  <span>return</span> score<span>;</span>
 <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>接着我正面面对摄像头，点击登录按钮，就进入了一个大大的success页面</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/16532156632018.png" alt="img" loading="lazy"></p>
<p>我侧脸或者拿照片试一下，不好意思，您老只能是404了</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/16532156632029.png" alt="img" loading="lazy"></p>
<p>以上就是整个实现的思路和一些步骤了，demo涉及的类和页面比较多，不方便一一截图，随后我把资源上传到本站。如有需要可自行下载。</p>
<p>综合而言实现还是比较简单的，牛逼的地方都在人家百度云那边呢，咱们只是根据需求合理利用人家的解决方案罢了。其实如果不是很牛逼的专项技术研发公司，做项目能合理利用别人的产品是最有效率的，项目建设最重要的还是投入产出比嘛。与其自己团队苦苦研究，花点成本买人家的成品直接用它不香吗？</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-20T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Spring线程池多线程并发处理大批量数据，解决IO效率问题</title>
    <id>https://blog.ciberviler.top/dev/spring%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%B9%B6%E5%8F%91%E5%A4%84%E7%90%86%E5%A4%A7%E6%89%B9%E9%87%8F%E6%95%B0%E6%8D%AE.html</id>
    <link href="https://blog.ciberviler.top/dev/spring%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%B9%B6%E5%8F%91%E5%A4%84%E7%90%86%E5%A4%A7%E6%89%B9%E9%87%8F%E6%95%B0%E6%8D%AE.html"/>
    <updated>2022-05-22T14:20:25.000Z</updated>
    <content type="html"><![CDATA[<h1 id="spring线程池多线程并发处理大批量数据-解决io效率问题" tabindex="-1"> Spring线程池多线程并发处理大批量数据，解决IO效率问题</h1>
<p>首先，叙述一下当前面临的问题所在。当前系统通过接口调用其他系统的数据，返回的数据达到10万级，然后将这批数据插入到oracle数据库。怎样尽可能提高这一过程的效率？</p>
<h2 id="大致从两个时间节点来优化" tabindex="-1"> 大致从两个时间节点来优化：</h2>
<p>一个节点是优化接口之间调用的响应速度，可以项目之间使用集群，实现负载均衡。接口拿到数据后可以暂存到Redis或kafka再者是MQ队列中，以提高接口直接的相率。</p>
<p>当然了如果项目团队允许，分布式的Hbase也是个不错的选择。当然了这些都不是重点，吹了半天下面才是重点。</p>
<p>今天的主题是大批量数据并发入库的问题，现在主流的项目工程大部分spring全家桶占大部分，所以咱们选择使用spring的线程池解决这一问题。大家可以思考一下10万条数据入库传统的web是一个线程运作，把这部分数据拆成10份或者20份分给多个线程去处理不就提高效率了？</p>
<p>思路有了，接下来，不哔哔了，直接干代码。</p>
<h2 id="两个方案" tabindex="-1"> 两个方案：</h2>
<h3 id="方案一-新建几个线程-交给线程池管理" tabindex="-1"> 方案一：新建几个线程，交给线程池管理</h3>
<p>1、准备测试数据</p>
<div><pre><code><span>public</span> <span>List</span><span><span>&lt;</span><span>BookStatistic</span><span>></span></span> <span>getPsrList</span><span>(</span><span>)</span><span>{</span>
  <span>List</span><span><span>&lt;</span><span>BookStatistic</span><span>></span></span> psrList <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>BookStatistic</span><span>></span></span><span>(</span><span>)</span><span>;</span>
  <span>for</span><span>(</span><span>int</span> i<span>=</span><span>0</span> <span>;</span> i<span>&lt;</span><span>20000</span> <span>;</span>i<span>++</span><span>)</span><span>{</span>
   <span>BookStatistic</span> book <span>=</span> <span>new</span> <span>BookStatistic</span><span>(</span><span>)</span><span>;</span>
   book<span>.</span><span>setPno</span><span>(</span><span>"zxl"</span><span>+</span>i<span>)</span><span>;</span>
   psrList<span>.</span><span>add</span><span>(</span>book<span>)</span><span>;</span>
  <span>}</span>
  
  <span>return</span> bookList<span>;</span>
 <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>2、线程池配置类</p>
<div><pre><code><span>@Configuration</span>
<span>@EnableAsync</span>
<span>public</span> <span>class</span> <span>AsyncConfig</span> <span>{</span>
 
  <span>//接收报文核心线程数</span>
  <span>@Value</span><span>(</span><span>"${book.core.poolsize}"</span><span>)</span>
  <span>private</span> <span>int</span> bookCorePoolSize<span>;</span>
  <span>//接收报文最大线程数</span>
  <span>@Value</span><span>(</span><span>"${book.max.poolsize}"</span><span>)</span>
  <span>private</span> <span>int</span> bookMaxPoolSize<span>;</span>
  <span>//接收报文队列容量</span>
  <span>@Value</span><span>(</span><span>"${book.queue.capacity}"</span><span>)</span>
  <span>private</span> <span>int</span> bookQueueCapacity<span>;</span>
  <span>//接收报文线程活跃时间（秒）</span>
  <span>@Value</span><span>(</span><span>"${book.keepAlive.seconds}"</span><span>)</span>
  <span>private</span> <span>int</span> bookKeepAliveSeconds<span>;</span>
  <span>//接收报文默认线程名称</span>
  <span>@Value</span><span>(</span><span>"${book.thread.name.prefix}"</span><span>)</span>
  <span>private</span> <span>String</span> bookThreadNamePrefix<span>;</span>
  
   <span>/**
    * bookTaskExecutor:(接口的线程池). <span><span><span>&lt;</span>br</span><span>/></span></span>
    * <span>@return</span> TaskExecutor taskExecutor接口
    * <span>@since</span> JDK 1.8
    */</span>
     <span>@Bean</span><span>(</span>name<span>=</span><span>"BookTask"</span><span>)</span>
     <span>public</span> <span>ThreadPoolTaskExecutor</span> <span>bookTaskExecutor</span><span>(</span><span>)</span> <span>{</span>
      <span>//newFixedThreadPool</span>
         <span>ThreadPoolTaskExecutor</span> executor <span>=</span> <span>new</span> <span>ThreadPoolTaskExecutor</span><span>(</span><span>)</span><span>;</span>
         <span>// 设置核心线程数</span>
         executor<span>.</span><span>setCorePoolSize</span><span>(</span>bookCorePoolSize<span>)</span><span>;</span>
         <span>// 设置最大线程数</span>
         executor<span>.</span><span>setMaxPoolSize</span><span>(</span>bookMaxPoolSize<span>)</span><span>;</span>
         <span>// 设置队列容量</span>
         executor<span>.</span><span>setQueueCapacity</span><span>(</span>bookQueueCapacity<span>)</span><span>;</span>
         <span>// 设置线程活跃时间（秒）</span>
         executor<span>.</span><span>setKeepAliveSeconds</span><span>(</span>bookKeepAliveSeconds<span>)</span><span>;</span>
         <span>// 设置默认线程名称</span>
         executor<span>.</span><span>setThreadNamePrefix</span><span>(</span>bookThreadNamePrefix<span>)</span><span>;</span>
         <span>// 设置拒绝策略</span>
         <span>// rejection-policy：当pool已经达到max size的时候，如何处理新任务  </span>
         <span>// CALLER_RUNS：不在新线程中执行任务，而是由调用者所在的线程来执行 </span>
         executor<span>.</span><span>setRejectedExecutionHandler</span><span>(</span><span>new</span> <span>ThreadPoolExecutor<span>.</span>CallerRunsPolicy</span><span>(</span><span>)</span><span>)</span><span>;</span>
         <span>// 等待所有任务结束后再关闭线程池</span>
         executor<span>.</span><span>setWaitForTasksToCompleteOnShutdown</span><span>(</span><span>true</span><span>)</span><span>;</span>
         executor<span>.</span><span>initialize</span><span>(</span><span>)</span><span>;</span>
         <span>return</span> executor<span>;</span>
     <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>3、实现过程函数</p>
<div><pre><code><span>public</span> <span>void</span> <span>ReceivePsrJobRun</span><span>(</span><span>)</span><span>{</span>
  
  <span>List</span><span><span>&lt;</span><span>BookStatistic</span><span>></span></span> bookList <span>=</span> <span>null</span><span>;</span>
  
 
  bookList <span>=</span> <span>getBookList</span><span>(</span><span>)</span><span>;</span>
  <span>//接收集合各段的 执行的返回结果</span>
  <span>List</span><span><span>&lt;</span><span>Future</span><span>&lt;</span><span>String</span><span>></span><span>></span></span> futureList <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>Future</span><span>&lt;</span><span>String</span><span>></span><span>></span></span><span>(</span><span>)</span><span>;</span>
  <span>//集合总条数</span>
  <span>int</span> size <span>=</span> bookList<span>.</span><span>size</span><span>(</span><span>)</span><span>;</span>
  <span>//将集合切分的段数(2*CPU的核心数)</span>
  <span>int</span> sunSum <span>=</span> <span>2</span><span>*</span><span>Runtime</span><span>.</span><span>getRuntime</span><span>(</span><span>)</span><span>.</span><span>availableProcessors</span><span>(</span><span>)</span><span>;</span>
  <span>int</span> listStart<span>,</span>listEnd<span>;</span>
  <span>//当总条数不足sunSum条时 用总条数 当做线程切分值</span>
  <span>if</span><span>(</span>sunSum <span>></span> size<span>)</span><span>{</span>
   sunSum <span>=</span> size<span>;</span>
  <span>}</span>
  
  <span>//定义子线程</span>
  <span>/*BookThread bookThread;*/</span>
  
  <span>//将list 切分多份 多线程执行</span>
  <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> sunSum<span>;</span> i<span>++</span><span>)</span> <span>{</span>
   <span>//计算切割  开始和结束</span>
   listStart <span>=</span> size <span>/</span> sunSum <span>*</span> i <span>;</span>
   listEnd <span>=</span> size <span>/</span> sunSum <span>*</span> <span>(</span> i <span>+</span> <span>1</span> <span>)</span><span>;</span>
   <span>//最后一段线程会 出现与其他线程不等的情况</span>
   <span>if</span><span>(</span>i <span>==</span> sunSum <span>-</span> <span>1</span><span>)</span><span>{</span>
    listEnd <span>=</span> size<span>;</span>
   <span>}</span>
   <span>//线程切断**/</span>
   <span>List</span><span><span>&lt;</span><span>BookStatistic</span><span>></span></span> sunList <span>=</span> bookList<span>.</span><span>subList</span><span>(</span>listStart<span>,</span>listEnd<span>)</span><span>;</span> 
   <span>//子线程初始化</span>
   bookThread <span>=</span> <span>new</span> <span>BookThread</span><span>(</span>i<span>,</span>sunList<span>)</span><span>;</span>
   
   <span>//多线程执行</span>
   futureList<span>.</span><span>add</span><span>(</span>taskExecutor<span>.</span><span>submit</span><span>(</span>bookThread<span>)</span><span>)</span><span>;</span>
  <span>}</span>
  <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"----------1111111111"</span><span>)</span><span>;</span>
  <span>//对各个线程段结果进行解析</span>
  <span>for</span><span>(</span><span>Future</span><span><span>&lt;</span><span>String</span><span>></span></span> future <span>:</span> futureList<span>)</span><span>{</span>
   <span>try</span> <span>{</span>
    <span>String</span> str <span>;</span>
    <span>if</span><span>(</span><span>null</span> <span>!=</span> future <span>)</span><span>{</span>
     str <span>=</span> future<span>.</span><span>get</span><span>(</span><span>)</span><span>.</span><span>toString</span><span>(</span><span>)</span><span>;</span>
     <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"##############current thread id ="</span><span>+</span><span>Thread</span><span>.</span><span>currentThread</span><span>(</span><span>)</span><span>.</span><span>getName</span><span>(</span><span>)</span><span>+</span><span>",result="</span><span>+</span>str<span>)</span><span>;</span>
    <span>}</span><span>else</span><span>{</span>
     <span>System</span><span>.</span>err<span>.</span><span>println</span><span>(</span><span>"失败"</span><span>)</span><span>;</span>
    <span>}</span>
   <span>}</span> <span>catch</span> <span>(</span><span>InterruptedException</span> <span>|</span> <span>ExecutionException</span> e<span>)</span> <span>{</span>
    
    <span>// TODO Auto-generated catch block</span>
    e<span>.</span><span>printStackTrace</span><span>(</span><span>)</span><span>;</span>
    
   <span>}</span>
  <span>}</span>
  <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"----------2222"</span><span>)</span><span>;</span>
 
 <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>4、线程类</p>
<div><pre><code><span>@Component</span>
<span>public</span> <span>class</span> <span>BookThread</span> <span>implements</span> <span>Callable</span><span><span>&lt;</span><span>Boolean</span><span>></span></span><span>{</span>
 <span>private</span> <span>static</span> <span>final</span> <span>Logger</span> LOG <span>=</span> <span>LoggerFactory</span><span>.</span><span>getLogger</span><span>(</span><span>BookThread</span><span>.</span><span>class</span><span>)</span><span>;</span>
 <span>//当前是属于第几段线程</span>
 <span>private</span> <span>int</span> pageIndex<span>;</span>
 <span>//此段数据的集合</span>
 <span>private</span> <span>List</span><span><span>&lt;</span><span>BookStatistic</span><span>></span></span> bookList<span>;</span>
 
 <span>public</span> <span>BookThread</span><span>(</span><span>int</span> pageIndex<span>,</span><span>List</span><span><span>&lt;</span><span>BookStatistic</span><span>></span></span> list<span>)</span><span>{</span>
  <span>this</span><span>.</span>pageIndex <span>=</span> pageIndex<span>;</span>
  <span>this</span><span>.</span>psrList <span>=</span> list<span>;</span>
 <span>}</span>
 <span>@Override</span>
 <span>public</span> <span>Boolean</span> <span>call</span><span>(</span><span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
  
   <span>System</span><span>.</span>err<span>.</span><span>println</span><span>(</span><span>String</span><span>.</span><span>format</span><span>(</span><span>"此批数据的段数为:%s 此段数据的数据条数为:%s"</span><span>,</span>pageIndex<span>,</span>psrList<span>.</span><span>size</span><span>(</span><span>)</span><span>)</span><span>)</span><span>;</span>
   <span>Boolean</span> result <span>=</span> <span>Boolean</span><span>.</span>TRUE<span>;</span>
  
   <span>if</span><span>(</span><span>null</span> <span>!=</span> bookList<span>&amp;&amp;</span> bookList<span>.</span><span>size</span><span>(</span><span>)</span> <span>></span><span>0</span><span>)</span><span>{</span>
    <span>for</span><span>(</span><span>BookStatistic</span> book<span>:</span> bookList<span>)</span><span>{</span>
   
     <span>try</span> <span>{</span>
       <span>//数据入库函数</span>
     <span>}</span> <span>catch</span> <span>(</span><span>Exception</span> e<span>)</span> <span>{</span>
      
      result <span>=</span> <span>Boolean</span><span>.</span>FALSE<span>;</span>
      <span>continue</span><span>;</span>
     <span>}</span>
    <span>}</span>
   <span>}</span>
   <span>return</span> result<span>;</span>
  <span>}</span>
 
 
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="方案二-只定义线程的数量-线程的新建管理都交给线程池" tabindex="-1"> 方案二：只定义线程的数量，线程的新建管理都交给线程池</h3>
<p>准备测试数据和线程池的配置和方案一一样，不再赘述。</p>
<p>方案二不再新建线程类了，这个过程交给spring线程池去处理，取而代之的是spring下的一个异步注解@Async</p>
<div><pre><code><span>@Component</span>
<span>public</span> <span>class</span> <span>SyncBookHandler</span> <span>{</span>
 
 
 <span>private</span> <span>static</span> <span>final</span> <span>Logger</span> LOG <span>=</span> <span>LoggerFactory</span><span>.</span><span>getLogger</span><span>(</span><span>SyncBookHandler</span><span>.</span><span>class</span><span>)</span><span>;</span>
 <span>/**
  * syncMargePsr:(多线程同步处理数据方法). <span><span><span>&lt;</span>br</span><span>/></span></span>
  * <span>@author</span> LW
  * <span>@param</span> <span>bookList</span> 一段数据集合
  * <span>@param</span> <span>pageIndex</span> 段数
  * <span>@return</span> Future<span><span><span>&lt;</span>String</span><span>></span></span> future对象
  * <span>@since</span> JDK 1.8
  */</span>
 <span>@Async</span>
 <span>public</span> <span>Future</span><span><span>&lt;</span><span>String</span><span>></span></span> <span>syncMargePsr</span><span>(</span><span>List</span><span><span>&lt;</span><span>BookStatistic</span><span>></span></span> bookList<span>,</span><span>int</span> pageIndex<span>)</span><span>{</span>
  
 
    LOG<span>.</span><span>info</span><span>(</span><span>String</span><span>.</span><span>format</span><span>(</span><span>"此批数据的段数为:%s 此段数据的数据条数为:%s"</span><span>,</span>pageIndex<span>,</span>psrList<span>.</span><span>size</span><span>(</span><span>)</span><span>)</span><span>)</span><span>;</span>
   <span>//声明future对象</span>
    <span>Future</span><span><span>&lt;</span><span>String</span><span>></span></span> result <span>=</span> <span>new</span> <span>AsyncResult</span><span><span>&lt;</span><span>String</span><span>></span></span><span>(</span><span>""</span><span>)</span><span>;</span>
    <span>//循环遍历该段旅客集合</span>
   <span>if</span><span>(</span><span>null</span> <span>!=</span> bookList <span>&amp;&amp;</span> bookList<span>.</span><span>size</span><span>(</span><span>)</span> <span>></span><span>0</span><span>)</span><span>{</span>
    <span>for</span><span>(</span><span>BookStatistic</span> book<span>:</span> bookList<span>)</span><span>{</span>
     <span>try</span> <span>{</span>
      <span>//数据入库操作</span>
      
     <span>}</span> <span>catch</span> <span>(</span><span>Exception</span> e<span>)</span> <span>{</span>
      
      <span>//记录出现异常的时间，线程name</span>
      result <span>=</span> <span>new</span> <span>AsyncResult</span><span><span>&lt;</span><span>String</span><span>></span></span><span>(</span><span>"fail,time="</span><span>+</span><span>System</span><span>.</span><span>currentTimeMillis</span><span>(</span><span>)</span><span>+</span><span>",thread id="</span><span>+</span><span>Thread</span><span>.</span><span>currentThread</span><span>(</span><span>)</span><span>.</span><span>getName</span><span>(</span><span>)</span><span>+</span><span>",pageIndex="</span><span>+</span>pageIndex<span>)</span><span>;</span>
      <span>continue</span><span>;</span>
     <span>}</span>
    <span>}</span>
   <span>}</span>
   <span>return</span> result<span>;</span>
  <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>实现过程函数</p>
<div><pre><code> <span>@Autowired</span>
 <span>private</span> <span>SyncBookHandler</span> syncBookHandler<span>;</span>
 
 <span>//核心线程数</span>
 <span>@Value</span><span>(</span><span>"${book.core.poolsize}"</span><span>)</span>
 <span>private</span> <span>int</span> threadSum<span>;</span>
 
<span>public</span> <span>void</span> <span>receiveBookJobRun</span><span>(</span><span>)</span><span>{</span>
  <span>List</span><span><span>&lt;</span><span>BookStatistic</span><span>></span></span> bookList <span>=</span> <span>null</span><span>;</span>
  
 
  bookList  <span>=</span> <span>getPsrList</span><span>(</span><span>)</span><span>;</span>
  <span>//入库开始时间</span>
  <span>Long</span> inserOrUpdateBegin <span>=</span> <span>System</span><span>.</span><span>currentTimeMillis</span><span>(</span><span>)</span><span>;</span>
  LOG<span>.</span><span>info</span><span>(</span><span>"数据更新开始时间:"</span><span>+</span>inserOrUpdateBegin<span>)</span><span>;</span>
  <span>//接收集合各段的 执行的返回结果</span>
  <span>List</span><span><span>&lt;</span><span>Future</span><span>&lt;</span><span>String</span><span>></span><span>></span></span> futureList <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>Future</span><span>&lt;</span><span>String</span><span>></span><span>></span></span><span>(</span><span>)</span><span>;</span>
  <span>//集合总条数</span>
  <span>if</span><span>(</span>psrList <span>!=</span> <span>null</span><span>)</span><span>{</span>
   <span>int</span> listSize <span>=</span> bookList<span>.</span><span>size</span><span>(</span><span>)</span><span>;</span>
   
   <span>int</span> listStart<span>,</span>listEnd<span>;</span>
   <span>//当总条数不足threadSum条时 用总条数 当做线程切分值</span>
   <span>if</span><span>(</span>threadSum <span>></span> listSize<span>)</span><span>{</span>
    threadSum <span>=</span> listSize<span>;</span>
   <span>}</span>
  
   <span>//将list 切分多份 多线程执行</span>
   <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> threadSum<span>;</span> i<span>++</span><span>)</span> <span>{</span>
    <span>//计算切割  开始和结束</span>
    listStart <span>=</span> listSize <span>/</span> threadSum <span>*</span> i <span>;</span>
    listEnd <span>=</span> listSize <span>/</span> threadSum <span>*</span> <span>(</span> i <span>+</span> <span>1</span> <span>)</span><span>;</span>
    <span>//最后一段线程会 出现与其他线程不等的情况</span>
    <span>if</span><span>(</span>i <span>==</span> threadSum <span>-</span> <span>1</span><span>)</span><span>{</span>
     listEnd <span>=</span> listSize<span>;</span>
    <span>}</span>
    <span>//数据切断</span>
    <span>List</span><span><span>&lt;</span><span>BookStatistic</span><span>></span></span> sunList <span>=</span> psrList<span>.</span><span>subList</span><span>(</span>listStart<span>,</span>listEnd<span>)</span><span>;</span> 
 
    <span>//每段数据集合并行入库</span>
    futureList<span>.</span><span>add</span><span>(</span>syncPassengerHandler<span>.</span><span>syncMargePsr</span><span>(</span>sunList<span>,</span>i<span>)</span><span>)</span><span>;</span>
 
   <span>}</span>
   
   <span>//对各个线程段结果进行解析</span>
   <span>for</span><span>(</span><span>Future</span><span><span>&lt;</span><span>String</span><span>></span></span> future <span>:</span> futureList<span>)</span><span>{</span>
    
     <span>String</span> str <span>;</span>
     <span>if</span><span>(</span><span>null</span> <span>!=</span> future <span>)</span><span>{</span>
      <span>try</span> <span>{</span>
       str <span>=</span> future<span>.</span><span>get</span><span>(</span><span>)</span><span>.</span><span>toString</span><span>(</span><span>)</span><span>;</span>
       LOG<span>.</span><span>info</span><span>(</span><span>"current thread id ="</span><span>+</span><span>Thread</span><span>.</span><span>currentThread</span><span>(</span><span>)</span><span>.</span><span>getName</span><span>(</span><span>)</span><span>+</span><span>",result="</span><span>+</span>str<span>)</span><span>;</span>
  
      <span>}</span> <span>catch</span> <span>(</span><span>InterruptedException</span> <span>|</span> <span>ExecutionException</span> e<span>)</span> <span>{</span>
       
       LOG<span>.</span><span>info</span><span>(</span><span>"线程运行异常！"</span><span>)</span><span>;</span>
      <span>}</span>
      
     <span>}</span><span>else</span><span>{</span>
      LOG<span>.</span><span>info</span><span>(</span><span>"线程运行异常！"</span><span>)</span><span>;</span>
     <span>}</span>
    
   <span>}</span>
  <span>}</span>
  
  
  
  <span>Long</span> inserOrUpdateEnd <span>=</span> <span>System</span><span>.</span><span>currentTimeMillis</span><span>(</span><span>)</span><span>;</span>
  LOG<span>.</span><span>info</span><span>(</span><span>"数据更新结束时间:"</span><span>+</span>inserOrUpdateEnd<span>+</span><span>"。此次更新数据花费时间为："</span><span>+</span><span>(</span>inserOrUpdateEnd<span>-</span>inserOrUpdateBegin<span>)</span><span>)</span><span>;</span>
 
 <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>以上思路和代码为简单的实现过程，鄙人能力有限，欢迎各位大神提出建议！！</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-20T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">六十多个 vscode 插件，助你打造最强编辑器</title>
    <id>https://blog.ciberviler.top/dev/%E5%85%AD%E5%8D%81%E5%A4%9A%E4%B8%AAvscode%20%E6%8F%92%E4%BB%B6.html</id>
    <link href="https://blog.ciberviler.top/dev/%E5%85%AD%E5%8D%81%E5%A4%9A%E4%B8%AAvscode%20%E6%8F%92%E4%BB%B6.html"/>
    <updated>2022-05-22T14:19:33.000Z</updated>
    <summary type="html">六十多个 vscode 插件，助你打造最强编辑器</summary>
    <content type="html"><![CDATA[<h1 id="六十多个-vscode-插件-助你打造最强编辑器" tabindex="-1"> 六十多个 vscode 插件，助你打造最强编辑器</h1>
<p>本文不做任何编辑器的比较，只是我本人日常使用 <code>vscode</code> 进行开发，并且比较喜欢折腾 <code>vscode</code> ，会到处找这一些好玩的插件，于是越攒越多，今天给大家推荐一下我收藏的 <strong>60</strong> 多个 <code>vscode</code> 插件，据说插件装太多，编辑器会变卡，可能是我的电脑配置还顶得住，目前并没有感觉到卡卡的。</p>
<p>接下来我会将会以 <strong>优化外观</strong>，<strong>功能扩展</strong>，<strong>提升编码效率</strong>，<strong>代码格式化</strong>，<strong>其它插件</strong> 几个分类来进行介绍。</p>
<p>一是把它们 <strong>分享</strong> 给有需要的小伙伴们，二是通过此文向小伙伴们 <strong>征集</strong> 其它好玩的插件，可以是任何类型的。有想要推荐其它插件的请评论区补充一下，我看到后会添加到文章中并标注出你的 <strong>ID</strong> 。</p>
<p>注：本文只涉及插件的基本使用，也就是让你知道存在这样一种插件，以及大致了解这个插件可以做什么事，部分插件的详细配置过于复杂，有需要的小伙伴请自行冲浪。根据每个人电脑，<code>vscode</code> 配置，以及插件的不同，部分插件可能在你电脑上不会生效。文中提到的快捷键都是 <code>windows</code> 下的，其他操作系统的快捷键请自行了解。</p>
<h1 id="优化外观" tabindex="-1"> 优化外观</h1>
<p>好马用好鞍，好看的编辑器外观，可以提升程序员的编码体验，可以让开发人员的心情变好，让写 <code>bug</code> 更有动力。</p>
<h2 id="better-comments" tabindex="-1"> Better Comments</h2>
<p>一款美化注释的插件，可以根据不同种类的注释，显示不同的颜色，一目了然。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1de9a57c05364ca3a662aed763fcaeec.jpg" alt="image.png" loading="lazy"></p>
<p>安装完以后，插件会默认自带几种颜色的注释，还可以通过 <code>vscode</code> 的配置文件自定义任何颜色，类型的注释。 具体的配置方法我给你们找好了。</p>
<p>👉👉 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.cnblogs.com%2Fsuwanbin%2Fp%2F13263732.html" target="_blank" rel="noopener noreferrer">vscode 插件-better comments-代码注释高亮</a></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/bedb65b8da9a4dc6bfbd87cbc7a38a7d.jpg" alt="image.png" loading="lazy"></p>
<h2 id="bracket-pair-colorizer-bracket-pair-colorizer-2" tabindex="-1"> Bracket Pair Colorizer / Bracket Pair Colorizer 2</h2>
<p>这是一个找对象的插件，不是帮你们找对象啊，是帮你找到括号的另一半。目前有两个版本，<code>Bracket Pair Colorizer 2</code> 是增强版，具体我没有深入研究具体增强了哪些内容。而且它有挺多的设置项，反正安装完默认的配置已经够用了，感兴趣的同学自行发觉更多有趣玩法吧。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/23d7197bd8a44efeaccc433741777367.jpg" alt="image.png" loading="lazy"></p>
<p>大家可以看到配对的括号是相同的颜色，并且当我选中一个括号以后，会出现一条线帮你找到它对应的另一半括号。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/e99c17172ac749bb8eb367c528ef30e7.jpg" alt="33.gif" loading="lazy"></p>
<h2 id="highlight-matching-tag" tabindex="-1"> Highlight Matching Tag</h2>
<p>这也是一个找对象的插件，找的是标签的对象，看我上一个插件的演示图片中，当我点击一下 <code>html</code> 标签，配对的标签就会出现下划线来指示你谁和谁是一对。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1c532cc1810948e4b8e94cfcbe4dd1f1.jpg" alt="image.png" loading="lazy"></p>
<h2 id="chinese" tabindex="-1"> Chinese</h2>
<p>让你的 <code>vscode</code> 变成中文，像我这种英语弱鸡才会用，大佬们略过。为什么要放在优化外观的分类里，因为我觉得中文比英文好看🧐🧐，安装完重启就行了。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/f3467a34bb3845e08683c84cb29a45a0.jpg" alt="image.png" loading="lazy"></p>
<h2 id="color-highlight" tabindex="-1"> Color Highlight</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1eb327c8dea340b6b7888439f2314766.jpg" alt="image.png" loading="lazy"></p>
<p>看名字就知道了，用于给我们代码中的颜色进行高亮展示的插件。可以看到下图中我设置的 <code>css</code> 颜色属性，直观的展示了出来。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/da5b9509149643d19e95d0ebea9a71a1.jpg" alt="image.png" loading="lazy"></p>
<h2 id="community-material-theme-material-theme" tabindex="-1"> Community Material Theme / Material Theme</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/e1718e04f3254d4b94c5381424f457c6.jpg" alt="image.png" loading="lazy"></p>
<p>修改编辑器的主题，内置很多种，我用的是 <code>Material Theme Palenight High Contrast</code> 这一款。安装完了以后点击 <strong>设置颜色主题</strong> 就可以了。</p>
<h2 id="material-theme-icons" tabindex="-1"> Material Theme Icons</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/302e02cda07249d8bd44d115640e1e5a.jpg" alt="image.png" loading="lazy"></p>
<p>设置文件图标的，这个插件的长这个样子，还有很多其它修改文件图标的插件，不喜欢这一款的，大家可以自行找一找。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/ecef44f36f3e483da18c8e4a790e2b7c.jpg" alt="image.png" loading="lazy"></p>
<h2 id="error-gutters" tabindex="-1"> Error Gutters</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/24beb253e8d9420da7b2cf09138432d1.jpg" alt="image.png" loading="lazy"></p>
<p>报错的地方都有大红波浪线提示，可以说是非常的直观了。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/973041a772a64e51839b5d1d96b9c6f8.jpg" alt="image.png" loading="lazy"></p>
<h2 id="image-preview" tabindex="-1"> Image preview</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/8a2f33048d8246e68d0bd227c0a445ba.jpg" alt="image.png" loading="lazy"></p>
<p>预览代码中图片的引用，鼠标移上去就会有小窗展示图片。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/965445fd42494131b6385e305a2dd88e.jpg" alt="20210603225907507.gif" loading="lazy"></p>
<h2 id="indent-rainbow" tabindex="-1"> indent-rainbow</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/b97d9779b05644089c9b152cbb18bff8.jpg" alt="image.png" loading="lazy"></p>
<p>看名字就知道了，彩虹缩进，就是把代码不同的缩进展示不同的颜色。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/89f97650dd6845e38b2295c497d433e5.jpg" alt="image.png" loading="lazy"></p>
<h2 id="indenticator" tabindex="-1"> Indenticator</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/a07a03c5a0764b6f8de38a5e7d9ee14c.jpg" alt="image.png" loading="lazy"></p>
<p>当你点击一个缩进部分的时候，会出现一条白线来告诉你当前处于的缩进层级，可以更方便的查看代码结构。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/fd6668febcb748cc8933183c6d14a8f7.jpg" alt="20180508105328382.gif" loading="lazy"></p>
<h2 id="trailing-spaces" tabindex="-1"> Trailing Spaces</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/89821584ebb34fbd9700c414d9368767.jpg" alt="image.png" loading="lazy"></p>
<p>把尾随空格显示出来。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/e33b2abedec746f785199f5ab430a1ed.jpg" alt="image.png" loading="lazy"></p>
<h2 id="vscode-great-icons" tabindex="-1"> VSCode Great Icons</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/8b56f035f3ff45b3ac38d79b16b8640f.jpg" alt="image.png" loading="lazy"></p>
<p>另一个修改文件图标的插件，我用的就是这个，相对于 <code>Material Theme Icons</code> 我更喜欢这个的风格，萝卜青菜可有所爱，大家各取所需。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/cd5d6327b2134752b41398bd3fe25093.jpg" alt="image.png" loading="lazy"></p>
<h1 id="功能扩展" tabindex="-1"> 功能扩展</h1>
<p>编辑器自身的功能还是有限的，为了应付日常开发，不得不安装很多其他的软件进行辅助，不过也可以通过插件的方式引入一些常用的辅助软件，它们的功能可能没有原生的强大，但是基本上已经够用，并且是真的很方便。</p>
<h2 id="az-al-dev-tools-al-code-outline" tabindex="-1"> AZ AL Dev Tools/AL Code Outline</h2>
<p>用来梳理代码结构的插件，安装完后在文件图标里就会多出一个 <code>AL OUTLINE</code> 的选项。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/96fd9d95f3794ef580966c99296f44b3.jpg" alt="image.png" loading="lazy"></p>
<p>为了演示我找了一个比较长，比较典型的 <code>vue</code> 文件，请忽略我的代码内容，专注于插件的功能🤣🤣， 可以看到展开第一层是极具 <code>vue</code> 单文件组件特点的 <code>template</code>，<code>script</code>，<code>style</code>。逐层展开就可以看到 <code>dom</code> 节点， <code>methods</code> 里面定义的函数等，然后点击就可以快速定位到目标所在位置，妈妈再也不用担心我全局搜啦！</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/8640c0c2a43c41218a74afba51e29bfb.jpg" alt="12.gif" loading="lazy"></p>
<p>注：它这个里面好像是默认展开的，应该是可以设置是否默认展开，但我没研究过，感兴趣的大佬可以深入调查一下。</p>
<h2 id="code-runner" tabindex="-1"> Code Runner</h2>
<p>运行代码，可以在编辑器中查看结果，前端同学可以在控制台看 <code>console.log</code> ，还有很多其他玩法，具体使用参考此篇文章</p>
<p>👉👉 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.sohu.com%2Fa%2F296509369_791833" target="_blank" rel="noopener noreferrer">VSCode插件推荐 | Code Runner: 代码一键运行，支持超过40种语言</a></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/55906fc48cdc4d7d8b3939e3fecc20bb.jpg" alt="image.png" loading="lazy"></p>
<h2 id="codeif" tabindex="-1"> CodeIf</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/6cff11f551bb4547ad97510d24a8dc76.jpg" alt="image.png" loading="lazy"></p>
<p>在网上看到一句话，<strong>在计算机科学中只有两件难事:缓存失效和命名</strong>。哈哈哈，确实如此，当开发项目时，命名一直都是一种让人痛苦的事情。</p>
<p>但是命名又是开发过程中一项非常重要的事情，一个好的函数命名，能够让你瞬间明白它实现的功能，所以，每当开发过程中遇到要命名的变量、函数、类时就要冥思苦想，各种翻译。</p>
<p>但是，<code>CodeIf</code> 的出现让这个问题迎刃而解，它通过搜索 <code>GitHub</code>, <code>Bitbucket</code>, <code>GitLab</code> 来找到真实的使用变量名，为你提供一些高频使用的词汇。</p>
<p>使用时只需要选中变量名，然后 <strong>右键</strong> 选择 <code>CodeIf</code> 就可以跳转到网页，显示候选命名。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/786fcc9aa61740b5b112cadc55901fac.jpg" alt="image.png" loading="lazy"></p>
<h2 id="color-info" tabindex="-1"> Color Info</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/d735fa7441ba41918ac87515eb1b889f.jpg" alt="image.png" loading="lazy"></p>
<p>查看颜色详细信息的插件，可以小窗口显示颜色值，rgb,hsl,cmyk,hex等等，可以在配置项里添加要展示的信息类型。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/5fcf52fdf4d743438ce04dd3abf335bc.jpg" alt="image.png" loading="lazy"></p>
<h2 id="code-spell-checker" tabindex="-1"> Code Spell Checker</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/859f54333d5045d8a2b9ddf7e8c153c0.jpg" alt="image.png" loading="lazy"></p>
<p>检查代码中单词拼写是否正确，当单词不正常的时候，就会在下方出现波浪线进行提示，还可以自定义词典，忽略某个单词的检查等，更多用法参考下面链接。</p>
<p>👉👉 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fblog.csdn.net%2Fqq_42078081%2Farticle%2Fdetails%2F115014474" target="_blank" rel="noopener noreferrer">VSCode中插件Code Spell Checker</a></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/f88a2af524fc4e19967ac6c4625ca171.jpg" alt="image.png" loading="lazy"></p>
<h2 id="debugger-for-chrome" tabindex="-1"> Debugger for Chrome</h2>
<p>这款插件是专门为前端调试开发的，很方便调试，跟谷歌的控制台是一样的功能，安装以后，无需打开浏览器的控制台就能进行断点调试。对应的还有 <code>Debugger for Firefox</code>，<code>Debugger for Microsoft Edge</code>等，其他的我没用过，大家按需安装即可，使用方法应该都大同小异。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/9137ba93ccd74013947fc53b610ac733.jpg" alt="image.png" loading="lazy"></p>
<p>安装完以后，左边会出现一个调试的小图标，打开以后再点击上方小齿轮进行配置。根目录下会自动新建 <code>.vscode</code> 文件夹以及 <code>launch.json</code> 文件，不用管。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/6d50ae57a7da483faddef771b11843e7.jpg" alt="image.png" loading="lazy"></p>
<p>配置文件的具体内容和使用方法可以看这一篇，很详细。</p>
<p>👉👉 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fblog.csdn.net%2Fweixin_40965293%2Farticle%2Fdetails%2F80525317" target="_blank" rel="noopener noreferrer">VSCode配置 Debugger for Chrome插件</a></p>
<h2 id="git-history" tabindex="-1"> Git History</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/3c7f8846e48243b097e9c02ab5bd3af7.jpg" alt="image.png" loading="lazy"></p>
<p>右键单击文件选择 <code>Git：View File History</code> 来以列表的形式查看所有的提交记录。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/e4ee5df43e1c402fa28c8b65fa3c3d2d.jpg" alt="2.gif" loading="lazy"></p>
<h2 id="gitlens-—-git-supercharged" tabindex="-1"> GitLens — Git supercharged</h2>
<p>这个也是跟 <code>git</code> 相关的插件，功能比上一个要强大一些。上一个插件的演示图片中可以看到我的每一行代码都有上一次 <code>git</code> 提交的记录，那就是这个插件的功劳。</p>
<p>还有其他很多的操作，详情查阅下方链接。</p>
<p>👉👉 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2Fa91cb8a2e55d" target="_blank" rel="noopener noreferrer">VsCode中好用的git源代码管理插件GitLens</a></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/555a1cf5377a4e6780a33bae9bf68fc0.jpg" alt="image.png" loading="lazy"></p>
<h2 id="leetcode" tabindex="-1"> LeetCode</h2>
<p>可以在 <code>vscode</code> 中刷算法题的。我自己没用过😣😣</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/049f861a63ab49129b3ad67a42dcb427.jpg" alt="image.png" loading="lazy"></p>
<h2 id="local-history" tabindex="-1"> Local History</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/8e1f22640a8d4c7c8b90815974ffda82.jpg" alt="image.png" loading="lazy"></p>
<p>这个就很强了，本地代码的修改记录。通常我们写错代码了可以撤销，但是撤销完以后再修改，想要取消撤销就难了。 有了这个插件直接看代码的修改记录。还可以跟当前版本进行对比，神器。</p>
<p>安装完以后，项目根目录下会自动生成 <code>.history</code> 的文件夹。代码的修改记录就会放在这里面。记得添加<code>.gitignore</code>，不然每次提交代码的时候就要遭重了。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/74e483fa0e584c829fb025a83f543c7e.jpg" alt="image.png" loading="lazy"></p>
<h2 id="open-in-browser" tabindex="-1"> open in browser</h2>
<p>在浏览器中打开 <code>html</code> 文件。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/15a5a6a15efb4fd9b639f1cdb542bf8a.jpg" alt="image.png" loading="lazy"></p>
<p>安装完以后在目标的 <code>html</code> 文件上右击，选择 <code>open in default browser</code> 即可打开使用浏览器打开文件。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/eae4d8633b6541289ea04152ec8933b3.jpg" alt="image.png" loading="lazy"></p>
<h2 id="partial-diff" tabindex="-1"> Partial Diff</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1cba70a7f5e249bf88c9fe5d182af588.jpg" alt="image.png" loading="lazy"></p>
<p>文件比较界的大拿肯定是 <code>Beyond Compare</code> 了，但是它是收费的！那么 <code>Partial Diff</code> 这款神奇的插件就成为了良好的替代品，选中一代码，右键<code> Select Text for Compare</code> ，选中另外一部分代码，右键<code>Compare Text with Previous Selection</code>即可。我的是中文的，就更明显了🤣🤣</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/0909cd037c894052abfdfd51878eb461.jpg" alt="45.gif" loading="lazy"></p>
<h2 id="postcode" tabindex="-1"> Postcode</h2>
<p><code>Postman</code> 都听说过吧，这个插件就基本上可以理解为，在 <code>vscode</code> 里面使用 <code>postman</code> 。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/fa7ad4637891473a90e001620e1f5f5b.jpg" alt="image.png" loading="lazy"></p>
<p>安装完以后左侧菜单会出现一个 <strong>小盒子</strong> 的图标，点开以后点击 <code>Create Request</code> 就可以正常使用了。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/a50cf3efef7a4b74af9615a61cd031ed.jpg" alt="image.png" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/c1601db79545441393e6bcfbbaebdb94.jpg" alt="120920378-0c83c880-c6dc-11eb-814a-e667563eed95.gif" loading="lazy"></p>
<h2 id="project-manager" tabindex="-1"> Project Manager</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/e47c75cb2798422fa02e2f6fa181f4da.jpg" alt="image.png" loading="lazy"></p>
<p>项目管理器，适用于经常切换项目的大佬，虽然我平时接触的项目也不多，不过自己搞着玩的工程也不少。有了这个插件，就不用新窗口打开项目了。</p>
<p>安装完以后左侧列表会出现一个 <strong>文件夹</strong> 的小图标，点开以后就可以进行项目管理了，通常都是操作<code>projects.json</code> 这个文件，点击项目名字就可以切换了，也可以新窗口打开。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/f60ff11f07404742931de47f63e94b76.jpg" alt="image.png" loading="lazy"></p>
<h2 id="quokka-js" tabindex="-1"> Quokka.js</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/a91b83a4645a45f9acd6d6c80df1898c.jpg" alt="image.png" loading="lazy"></p>
<p>实时显示代码的运行结果，使用方法请跳转链接</p>
<p>👉👉<a href="https://link.juejin.cn/?target=http%3A%2F%2Fwww.duocaichajian.com%2Fplugin%2F43.html" target="_blank" rel="noopener noreferrer"> VS Code插件之Quokka.js</a></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/6544d46e54534e48aca2d0532ab2e94a.jpg" alt="vsc-intro.gif" loading="lazy"></p>
<h1 id="提升编码效率" tabindex="-1"> 提升编码效率</h1>
<p>如何达到极致的编码效率，当然是能不手写则不手写。下面这些插件就是辅助大家进行一些自动化，这样就可以节省下很多的时间用来摸鱼了。</p>
<h2 id="auto-import" tabindex="-1"> Auto Import</h2>
<p><code>Typescript</code> 自动导入，其实现在很多的插件基本都内置了这种功能，已经不是必须品了。可能是因为我装了各种奇奇怪怪的插件，我现在想导入什么东西的时候，一大堆的提示，随便选一个都能导进来😂</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/5ff7742759fa4f2d81603ff4526e8e32.jpg" alt="image.png" loading="lazy"></p>
<h2 id="auto-rename-tag" tabindex="-1"> Auto Rename Tag</h2>
<p>自动修改标签名，重命名一个开始标签时，自动重命名配对的结束标签。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/327e483ced7d4f6cba1dc04b9f1c5e98.jpg" alt="image.png" loading="lazy"></p>
<p>一下子就对应的全修改掉了，是不是很 <code>nice</code>。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/7e310c13e685440f81c4267210acc8f3.jpg" alt="1.gif" loading="lazy"></p>
<h2 id="change-case" tabindex="-1"> change-case</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/b1ee314635a64f85be71d765ae8cd8b8.jpg" alt="image.png" loading="lazy"></p>
<p>快速切换变量格式，什么大坨峰，小驼峰，下划线等等，它里面有很多类型。使用方法按 <code>F1（windows）</code> ，输入对应命令即可。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/a10e7c728fc6483c811340aaa9e78396.jpg" alt="44.gif" loading="lazy"></p>
<h2 id="css-peek" tabindex="-1"> CSS Peek</h2>
<p>可以通过点击类名迅速定位到样式的定义。不知道是不是我自己的原因，有的时候会失效，需要点击 <strong>禁用</strong> ，再点击 <strong>启用</strong> 就好使了。具体使用方法参考链接</p>
<p>👉👉 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fcloud.tencent.com%2Fdeveloper%2Fnews%2F424186" target="_blank" rel="noopener noreferrer">cssPeek插件大大提升你的开发效率</a></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/37758d06d88949b59ac3e3b5f82700f0.jpg" alt="image.png" loading="lazy"></p>
<h2 id="ecmascript-quotes-transformer" tabindex="-1"> ECMAScript Quotes Transformer</h2>
<p>用于 <strong>模板字符串</strong> 和 <strong>普通字符串拼接</strong> 的相互转化，但其实我日常开发基本上都是统一使用模板字符串的，很少有这种互相转化的需求。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/c611b1aedcd74a8eb061acfbf715762e.jpg" alt="image.png" loading="lazy"></p>
<p>用法也是非常简单，选中需要转化的行，按 <code>f1</code> 输入命令即可，一般输入 <code>esq</code> 就出现提示了。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/614c3ed80075493591b45e42bfea472e.jpg" alt="1.gif" loading="lazy"></p>
<h2 id="embrace" tabindex="-1"> embrace</h2>
<p>快速的在选中代码两边添加各种引号、括号，不用来回移动光标，不过好像现在市面上的编辑器大多都内置这功能了吧🤨🤨</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/d1d7aef3a33548a78f6ea5f5a3dfc800.jpg" alt="image.png" loading="lazy"></p>
<h2 id="file-utils" tabindex="-1"> File Utils</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/d67881fd6e5c4296ba2f7c2a4a11e66a.jpg" alt="image.png" loading="lazy"></p>
<p>创建，复制，移动，重命名，删除文件和目录的便捷方法，演示图片来自官网。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/affeab1477024a2d95cea01f00b1f1cd.jpg" alt="demo.gif" loading="lazy"></p>
<h2 id="javascript-console-utils" tabindex="-1"> javascript console utils</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/0e26d0afd5c34c20a5cc7e74b72e4b21.jpg" alt="image.png" loading="lazy"></p>
<p>前端人员的调试少不了 <code>console.log</code> ，那么这就是一款快速生成 <code>console.log</code> 的插件。使用方法非常简单， 选中变量，然后按 <code>ctrl + shift + L</code> 就可以生成了。需要删除的时候按 <code>ctrl + shift + D</code> 即可删除。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/96ce2210bf7140368049e348733d6ab6.jpg" alt="4.gif" loading="lazy"></p>
<h2 id="json2ts" tabindex="-1"> json2ts</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/ba615eb4e6064f9e945dd0f3783b4618.jpg" alt="image.png" loading="lazy"></p>
<p>自动把 <code>json</code> 格式转成 <code>ts</code> 的类型，复制 <code>json</code> 之后按 <code>ctrl + alt + v</code> 即可。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/00250de6c221498288c36c070f48ef7d.jpg" alt="image.png" loading="lazy"></p>
<h2 id="korofileheader" tabindex="-1"> koroFileHeader</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/b6e08a6f3b614244b70bd97dd6e52900.jpg" alt="image.png" loading="lazy"></p>
<p>自动添加 <strong>头部注释</strong> 和 <strong>函数注释</strong> 的插件。支持自定义内容，需要在 <code>settings.json</code> 中进行自定义配置。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/6a36853971284c1a9a7e0d27eedb63f2.jpg" alt="image.png" loading="lazy"></p>
<div><pre><code>  <span>//自动生成注释插件  文件头部注释</span>
  <span>"fileheader.customMade"</span><span>:</span> <span>{</span>
    <span>"Author"</span><span>:</span> <span>"一尾流莺"</span><span>,</span>
    <span>"Description"</span><span>:</span> <span>""</span><span>,</span>
    <span>"Date"</span><span>:</span> <span>"Do not edit"</span><span>,</span>
    <span>"LastEditTime"</span><span>:</span> <span>"Do not edit"</span><span>,</span>
    <span>"FilePath"</span><span>:</span> <span>""</span>
  <span>}</span><span>,</span>
  <span>//自动生成注释插件  函数注释</span>
  <span>"fileheader.cursorMode"</span><span>:</span> <span>{</span>
    <span>"description"</span><span>:</span> <span>""</span><span>,</span>
    <span>"param"</span><span>:</span> <span>""</span><span>,</span>
    <span>"return"</span><span>:</span> <span>""</span>
  <span>}</span><span>,</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="mithril-emmet" tabindex="-1"> Mithril Emmet</h2>
<p>快速生成代码结构，不过好像新版本 <code>vscode</code> 已经内置了。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/4ff310b1ce674d74a0f050807710f63f.jpg" alt="image.png" loading="lazy"></p>
<h2 id="path-intellisense" tabindex="-1"> Path Intellisense</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2f51f75bdce748689a476624928bcd5f.jpg" alt="image.png" loading="lazy"></p>
<p>引入文件的时候，路径自动补全。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/97cd956a9fcd4fbb90ccb9cec6df3cf6.jpg" alt="3333333333.gif" loading="lazy"></p>
<h2 id="npm-intellisense" tabindex="-1"> Npm Intellisense</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/c7115d02a0ab493b8028981dc676868a.jpg" alt="image.png" loading="lazy"></p>
<p>导入 <code>npm</code> 包的时候，智能提示。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/f26e74a7a8fd461ebece7f5fa9cff7b1.jpg" alt="444.gif" loading="lazy"></p>
<h2 id="px-to-rem-rpx-cssrem" tabindex="-1"> px to rem &amp; rpx (cssrem)</h2>
<p>自动换算单位的插件。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/fcc899934cf14d86b5782674c7358027.jpg" alt="image.png" loading="lazy"></p>
<p>很简单，出现提示以后回车即可。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/0014da831a7e4c6694d5ff3ccf95f657.jpg" alt="1.gif" loading="lazy"></p>
<h2 id="turbo-console-log" tabindex="-1"> Turbo Console Log</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/19d04537f19347378bff13e66b52b7ba.jpg" alt="image.png" loading="lazy"></p>
<p>另一个用来生成 <code>console.log</code> 的插件，不同的是，他支持自定义 <code>console.log</code> 的内容，包括文件名，路径，大小等，还可以添加自己喜欢的 <code>emoji</code> 表情，快捷键 <code>ctrl + alt + L</code>。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/86c090e36dcd4c27a89a3430614f964b.jpg" alt="image.png" loading="lazy"></p>
<h2 id="代码片段类插件" tabindex="-1"> 代码片段类插件</h2>
<p>这一类的插件都很多，但功能都是提供代码片段，作用就是使用几个字符的简写，就可以敲出整段代码。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/02cdccca5c1545509972b3f8cf682d28.jpg" alt="image.png" loading="lazy"></p>
<ul>
<li><strong>JavaScript (ES6) code snippets</strong></li>
<li><strong>Jest Snippets</strong></li>
<li><strong>HTML Snippets</strong></li>
<li><strong>Vue VSCode Snippets</strong></li>
<li><strong>Vue 3 Snippets</strong></li>
<li><strong>... ...</strong></li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/a23a2253c32a4c7895a323d06de44f4b.jpg" alt="3.gif" loading="lazy"></p>
<h1 id="代码格式化" tabindex="-1"> 代码格式化</h1>
<h2 id="beautify" tabindex="-1"> Beautify</h2>
<p>用来代码格式化的，但是我好像安装了没怎么用，我一直都是 <code>eslint + prettier</code>，有正在用的小伙伴可以在评论区发表一下看法，感兴趣的请自己搜索使用方法。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/f62dd8d5a1224ca3a5aa40019050a487.jpg" alt="image.png" loading="lazy"></p>
<h2 id="eslint" tabindex="-1"> ESLint</h2>
<p>这个就不用说了吧，代码检查，不符合规范的就会跟你报错，或者警告。具体的规范需要在根目录下新建 <code>.eslintrc.js</code> 文件去配置，也可以用很多大公司现有的规范，太复杂了就不细讲了，贴出教程链接。</p>
<p>👉👉<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2Fad1e46faaea2" target="_blank" rel="noopener noreferrer">Eslint 超简单入门教程</a></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/1bf41fc809054b7d8827ef6587d7a7ea.jpg" alt="image.png" loading="lazy"></p>
<h2 id="prettier-code-formatter" tabindex="-1"> Prettier - Code formatter</h2>
<p>代码格式化插件，这个插件通常搭配 <code>eslint</code> 使用，也可以单独使用。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/c6127a0655564917a884da5265753c66.jpg" alt="image.png" loading="lazy"></p>
<p>在根目录下新建 <code>.prettierrc.json</code> 文件，在里面书写自己想要的格式就行了。更具体的配置内容查看链接</p>
<p>👉👉 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fblog.csdn.net%2Fhbiao68%2Farticle%2Fdetails%2F107176795%2F%3Futm_term%3Dvscode%E7%9A%84prettier%E9%85%8D%E7%BD%AE%26utm_medium%3Ddistribute.pc_aggpage_search_result.none-task-blog-2~all~sobaiduweb~default-1-107176795%26spm%3D3001.4430" target="_blank" rel="noopener noreferrer"># vscode 使用Prettier插件格式化配置使用</a></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/dc1655149c624a9da511d737151e4253.jpg" alt="image.png" loading="lazy"></p>
<h2 id="vetur-volar" tabindex="-1"> vetur / volar</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/ab94d21cf6c540bb851fb3468d996b58.jpg" alt="image.png" loading="lazy"></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/6525229bbd904943af71de3b8900c7d7.jpg" alt="image.png" loading="lazy"></p>
<p>使用 <code>vue</code> 进行开发的小伙伴都少不了跟它们打交道，<code>volar</code> 是跟 <code>vue3</code> 更配的，功能也能多，由于这两个插件功能过于庞大，就不展开讲了，感兴趣的自行搜索使用。</p>
<h1 id="其他好玩的插件" tabindex="-1"> 其他好玩的插件</h1>
<p>除了功能性插件，当然还有很多花里胡哨的玩意。下面给大家介绍几款可能对开发影响不大，但是非常好玩的插件。</p>
<h2 id="小霸王" tabindex="-1"> 小霸王</h2>
<p>还记得小时候玩的手柄游戏吗？大佬已经给我们出了插件了，不过我还是要友情提醒一句：游戏有风险，摸鱼需谨慎！</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/c97425a812534bd8a8ed2561b5023230.jpg" alt="image.png" loading="lazy"></p>
<p>操作非常简单，安装完左侧会出现游戏手柄图标，点击打开就可以下载游戏进行玩耍。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/8f7b86dab1b946418d3041ea77191ea2.jpg" alt="image.png" loading="lazy"></p>
<h2 id="emoji" tabindex="-1"> Emoji</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/9c74a1a3b1e043559cbd7e0174d8c4e2.jpg" alt="image.png" loading="lazy"></p>
<p>在代码中添加 <code>emoji</code> 表情，我自己除了写一些注释，<code>console.log</code> 之外，基本没有别的作用，但是挺好玩的，别人看你的代码中各种小表情，也会觉得你是一个可爱的人吧。</p>
<p>它的官方示例里面还可以把 <code>emoji</code> 设为变量名，我可不建议你们这样做。使用方法也是非常的简单，按 <code>f1（windows）</code> 输入 <code>emoji</code> ，可以看到有三个选项，分别是 <code>emoji</code> 表情，<code>markdown</code> 下的 <code>emoji</code>，还有 <code>unicode</code> 下的 <code>emoji</code>。选中一个模式回车进入列表，再回车就可以输入到代码中了。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/eb1118a1c8b24f53b77f6a64c1d4763d.jpg" alt="2.gif" loading="lazy"></p>
<h2 id="settings-sync" tabindex="-1"> Settings Sync</h2>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/be1a049a68e14a00bdb43990272d045c.jpg" alt="image.png" loading="lazy"></p>
<p>可以同步 <code>vscode</code> 配置的插件，由于我没有换过电脑，所以还没亲测，但是网上用的人还是蛮多的。</p>
<h2 id="彩虹屁插件" tabindex="-1"> 彩虹屁插件</h2>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-21T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">树的定义、树的存储结构</title>
    <id>https://blog.ciberviler.top/dev/%E6%A0%91%E7%9A%84%E5%AE%9A%E4%B9%89%E3%80%81%E6%A0%91%E7%9A%84%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84.html</id>
    <link href="https://blog.ciberviler.top/dev/%E6%A0%91%E7%9A%84%E5%AE%9A%E4%B9%89%E3%80%81%E6%A0%91%E7%9A%84%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84.html"/>
    <updated>2022-05-21T09:35:16.000Z</updated>
    <summary type="html">树的定义、树的存储结构</summary>
    <content type="html"><![CDATA[<h1 id="树的定义、树的存储结构" tabindex="-1"> 树的定义、树的存储结构</h1>
<h2 id="前言" tabindex="-1"> 前言</h2>
<p>提到存储结构，可以很自然的想到<strong>顺序存储结构</strong>和<strong>链式存储结构</strong>两种。</p>
<p>之前介绍的所有的数据结构都是线性存储结构。本章所介绍的树结构是一种<strong>非线性存储结构</strong>，存储的是具有“<strong>一对多</strong>”关系的数据元素的集合。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/cb46133043df4ca6b5588c4dec725e71.png" alt="img" loading="lazy"></p>
<blockquote>
<ul>
<li>图 1(A) 是使用树结构存储的集合 <strong>{A,B,C,D,E,F,G,H,I,J,K,L,M}</strong> 的示意图。对于数据 A 来说，和数据 B、C、D 有关系；对于数据 B 来说，和 E、F 有关系。这就是“<strong>一对多</strong>”的关系。</li>
<li>将具有“一对多”关系的集合中的数据元素按照图 1（A）的形式进行存储，整个存储形状在逻辑结构上看，类似于实际生活中<strong>倒着的树</strong>（图 1（B）倒过来），所以称这种存储结构为**“树型”存储结构。</li>
</ul>
</blockquote>
<p><strong>💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙</strong></p>
<h2 id="🐋树的定义" tabindex="-1"> 🐋树的定义</h2>
<h3 id="🌲树的定义" tabindex="-1"> 🌲树的定义</h3>
<p>​    树（Tree）是 <strong>n（n&gt;=0</strong>）个结点的有限集。n=0时称为空树。在任意一颗非空树中：</p>
<blockquote>
<ol>
<li><strong>有且仅有一个特定的称为</strong>根（root）的结点；****</li>
<li><strong>当n&gt;1时，其余结点可分为m(m&gt;0)个互补交互的有限集T1、T2...Tm，其中每一个集合本身又是一棵树，并称为</strong>根的子树**（SubTree）**。</li>
</ol>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/df38fd9b66bb44cbbc3b801a683fe0b7.png" alt="img" loading="lazy"></p>
</blockquote>
<h3 id="🌲树的特点" tabindex="-1"> 🌲树的特点</h3>
<blockquote>
<ul>
<li><strong>n&gt;0时，根节点是唯一的</strong>，不可能存在多个根节点。数据结构中的树<strong>只有一个根节点</strong>。</li>
<li>m&gt;0时，<strong>子树的个数没有限制，但他们一定是</strong>互不相交<strong>的</strong>。</li>
</ul>
</blockquote>
<h3 id="🌲结点的分类" tabindex="-1"> 🌲结点的分类</h3>
<blockquote>
<ul>
<li><strong>结点：<strong>树的结点包含</strong>一个数据元素</strong>和若干指向其**子树的分支****。</li>
<li><strong>结点的度（Degree）：<strong>结点</strong>拥有的子树</strong>。</li>
<li><strong>叶子结点（Leaf）/终端结点：****度为0</strong>的结点。</li>
<li><strong>分支结点/非终端结点：****度不为0</strong>的结点。</li>
<li>**内部结点：**除根节点以外，分支结点也称为内部结点。</li>
<li><strong>树的度：<strong>树内各结点的度的</strong>最大值</strong>。</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/febfdc26e5fe4082a3f24394ae2a8797.png" alt="img" loading="lazy"></p>
</blockquote>
<h3 id="🌲结点之间的关系" tabindex="-1"> 🌲结点之间的关系</h3>
<ul>
<li><strong>孩子（Child）和双亲（Parent）：<strong>结点的子树的根，相应的，该结点称为孩子的双亲。</strong>（注意是双亲，不是单亲）</strong>*</li>
<li><strong>兄弟（sibling）：****同一个双亲</strong>的孩子之间互称兄弟。</li>
<li><strong>结点的祖先：<strong>从根结点到该结点</strong>所经过分支上的所有结点</strong>。</li>
<li><strong>子孙：<strong>以某结点为根的</strong>子树中的任一结点</strong>都称为该节点的子孙。</li>
<li><strong>无序树和有序树：<strong>如果将树中结点的各子树看成</strong>从左至右</strong>是有次序的，不能互换的，则称该数为有序树，否则为无序树。</li>
<li><strong>森林(fores)</strong>：m(m&gt;=0)棵<strong>互不相较</strong>的树的集合。</li>
</ul>
<p><strong>💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙</strong></p>
<h2 id="🐋树的存储结构" tabindex="-1"> 🐋树的存储结构</h2>
<blockquote>
<h3 id="树的4种链式存放方式" tabindex="-1"> <strong>树的</strong>4种<strong>链式存放方式：</strong></h3>
<ol>
<li>
<h3 id="双亲链表存储结构" tabindex="-1"> <strong>双亲</strong>链表存储结构**</h3>
</li>
<li>
<h3 id="孩子链表存储结构" tabindex="-1"> <strong>孩子</strong>链表存储结构**</h3>
</li>
<li>
<h3 id="双亲孩子链表存储结构" tabindex="-1"> <strong>双亲孩子</strong>链表存储结构**</h3>
</li>
<li>
<h3 id="孩子兄弟链表存储结构" tabindex="-1"> <strong>孩子兄弟</strong>链表存储结构**</h3>
</li>
</ol>
</blockquote>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/b11533763d234947aca101037dec8b41.png" alt="img" loading="lazy"></p>
<h2 id="⚡双亲链表存储结构" tabindex="-1"> ⚡双亲链表存储结构</h2>
<ul>
<li>以一组<strong>地址连续</strong>的存储单元存放树中的各个结点，每个结点有<strong>两个域</strong>：
<ul>
<li><strong>数据域：<strong>用于存放树中该结点的</strong>值</strong>。</li>
<li><strong>指针域：<strong>用于存放该结点的</strong>双亲结点</strong>在存储结构中的位置。</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">data(数据域)</th>
<th style="text-align:center">parent(指针域)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">存储结点的数据信息</td>
<td style="text-align:center">存储该结点的双亲所在数组中的下标</td>
</tr>
</tbody>
</table>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/662ace49b4234d0d87fa981e5ed364b6.png" alt="img" loading="lazy"></p>
<ul>
<li><strong>优点：<strong>查找一个指定结点的</strong>双亲结点</strong>非常容易。</li>
<li><strong>缺点：<strong>查找指定结点的</strong>孩子结点</strong>，需要<strong>扫描整个链表</strong>。</li>
</ul>
<hr>
<h2 id="⚡孩子链表存储结构" tabindex="-1"> ⚡孩子链表存储结构</h2>
<ul>
<li>以一组<strong>地址连续</strong>的存储单元来存放树中的各个结点，每一个结点有两个域。
<ul>
<li><strong>数据域：<strong>存放该结点的</strong>值</strong></li>
<li><strong>指针域：<strong>用于存放该结点的</strong><code>孩子链表</code>的头指针</strong>。</li>
</ul>
</li>
<li>孩子链表的<strong>孩子结点：</strong></li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">child(数据域)</th>
<th style="text-align:left">next(指针域)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">存储某个结点在表头数组中的下标</td>
<td style="text-align:left">存储指向某结点的下一个孩子结点的指针</td>
</tr>
</tbody>
</table>
<ul>
<li>表头数组的<strong>表头结点：</strong></li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">data(数据域)</th>
<th style="text-align:center">firstchild(头指针域)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">存储某个结点的数据信息</td>
<td style="text-align:center">存储该结点的孩子链表的头指针</td>
</tr>
</tbody>
</table>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/bcff713717a24534b4c0b5b674f8acd8.png" alt="img" loading="lazy"></p>
<ul>
<li><strong>优点：<strong>便于实现查找树中指定结点的</strong>孩子结点。</strong></li>
<li><strong>缺点：<strong>不便于查找指定结点的</strong>双亲结点</strong>。</li>
</ul>
<hr>
<h2 id="⚡双亲孩子链表存储结构" tabindex="-1"> ⚡双亲孩子链表存储结构</h2>
<ul>
<li>与孩子链表存储结构类似，以一组<strong>地址连续</strong>的存储单元来存放树中的各个结点，每一个结点有<strong>三个域</strong>
<ul>
<li><strong>数据域：<strong>存放该结点的</strong>值</strong></li>
<li><strong>父指针域：<strong>用于存放</strong>双亲结点</strong>在数组中的位置</li>
<li><strong>子指针域：<strong>用于存放该结点的</strong>孩子链表的头指针</strong>。</li>
</ul>
</li>
</ul>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/e3a1af0b7435472d95278ee052d640d4.png" alt="img" loading="lazy"></p>
<hr>
<h2 id="⚡孩子兄弟链表存储结构" tabindex="-1"> ⚡孩子兄弟链表存储结构</h2>
<ul>
<li>孩子兄弟链表存放，又称为**“左子/右兄”**二叉链式存储结构。
<ul>
<li><strong>左指针：<strong>指向该结点的</strong>第一个孩子</strong></li>
<li><strong>右指针：<strong>指向该结点的</strong>右邻兄弟</strong></li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">data(数据域)</th>
<th style="text-align:center">firstchild(指针域)</th>
<th style="text-align:center">rightsib(指针域)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">存储结点的数据信息</td>
<td style="text-align:center">存储该结点的第一个孩子的存储地址</td>
<td style="text-align:center">存储该结点的右兄弟结点的存储地址</td>
</tr>
</tbody>
</table>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/9b57fb1db8824839b545e1b9ba7744bd.png" alt="img" loading="lazy"></p>
<p><strong>💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙💚❤️💙</strong></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-19T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Java电子书笔记</title>
    <id>https://blog.ciberviler.top/dev/Java%E7%94%B5%E5%AD%90%E4%B9%A6%E7%AC%94%E8%AE%B0.html</id>
    <link href="https://blog.ciberviler.top/dev/Java%E7%94%B5%E5%AD%90%E4%B9%A6%E7%AC%94%E8%AE%B0.html"/>
    <updated>2022-05-20T15:19:55.000Z</updated>
    <summary type="html">Java电子书笔记</summary>
    <content type="html"><![CDATA[<h1 id="java电子书笔记" tabindex="-1"> Java电子书笔记</h1>
<p>如果您觉得对你有帮助，请不要吝啬给一个star，在这里感谢你的每一个star，谢谢！</p>
<h3 id="注意事项-请善于使用-ctrl-f-进行搜索" tabindex="-1"> 注意事项（请善于使用 ctrl + F 进行搜索）</h3>
<h3 id="java基础篇" tabindex="-1"> Java基础篇</h3>
<p>高清电子版-21天学通JAVA.pdf 链接: <a href="https://pan.baidu.com/s/1_9o4iziVgeR8EGwKyy77vA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1_9o4iziVgeR8EGwKyy77vA</a>  密码: esod</p>
<p>高清电子版-Effective Java（中文版第3版）.pdf 链接: <a href="https://pan.baidu.com/s/1Mz5YmtSHqGC6a0EzkgkndA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Mz5YmtSHqGC6a0EzkgkndA</a>  密码: wda7</p>
<p>高清电子版-Effective+Java+中文第二版.pdf 链接: <a href="https://pan.baidu.com/s/1_G-yfWq2A1RFfB576TpVAA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1_G-yfWq2A1RFfB576TpVAA</a>  密码: 4hia</p>
<p>高清电子版-Head First Java 中文高清版.pdf 链接: <a href="https://pan.baidu.com/s/14krd8um4cg8EvvMTyXw01w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/14krd8um4cg8EvvMTyXw01w</a>  密码: oaws</p>
<p>高清电子版-Head First Java第二版涵盖java5.0.pdf 链接: <a href="https://pan.baidu.com/s/1xbUMxoRXH9uUTkEuAgymmA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1xbUMxoRXH9uUTkEuAgymmA</a>  密码: ttg4</p>
<p>高清电子版-Java 8 中的炫酷特性和 Java 9 中的新特性-杨晓峰.pdf 链接: <a href="https://pan.baidu.com/s/1FHPkAaa99Bscr8O4BigPHA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1FHPkAaa99Bscr8O4BigPHA</a>  密码: ru0r</p>
<p>高清电子版-Java8函数式编程.pdf 链接: <a href="https://pan.baidu.com/s/1kyfOpC8WNZqcBuceiU4rsg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1kyfOpC8WNZqcBuceiU4rsg</a>  密码: c1w4</p>
<p>高清电子版-Java编程思想第三版.pdf 链接: <a href="https://pan.baidu.com/s/1AsXIM9p55qylBd1Wo_omiA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1AsXIM9p55qylBd1Wo_omiA</a>  密码: tlmu</p>
<p>高清电子版-Java编辑思想（第四版）.pdf 链接: <a href="https://pan.baidu.com/s/1USTBMxegLM3w0iZLkLtNjw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1USTBMxegLM3w0iZLkLtNjw</a>  密码: hsso</p>
<p>高清电子版-Java从小白到大牛精简版.pdf 链接: <a href="https://pan.baidu.com/s/1-RowepmkxQBdV62rC6LACQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1-RowepmkxQBdV62rC6LACQ</a>  密码: 5jll</p>
<p>高清电子版-Java核心技术卷一基础知识第10版.pdf 链接: <a href="https://pan.baidu.com/s/1HkCbR2hpJ2pLk2dT80S5MQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1HkCbR2hpJ2pLk2dT80S5MQ</a>  密码: ksfg</p>
<p>高清电子版-JAVA核心知识点整理.pdf 链接: <a href="https://pan.baidu.com/s/105cujotAU7EG4SjdcNSVDQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/105cujotAU7EG4SjdcNSVDQ</a> 提取码: s4bs</p>
<p>高清电子版-java基础教程(强烈推荐).pdf 链接: <a href="https://pan.baidu.com/s/12xJ1ecPTqzQJmg18KG8ibA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/12xJ1ecPTqzQJmg18KG8ibA</a>  密码: bj3i</p>
<p>高清电子版-疯狂JAVA讲义.pdf 链接: <a href="https://pan.baidu.com/s/1DP2mG9QUi2RVT3u-Zr4BuA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1DP2mG9QUi2RVT3u-Zr4BuA</a> 提取码: jj1q</p>
<p>高清电子版-面向对象程序设计 图形应用实例.pdf 链接: <a href="https://pan.baidu.com/s/1BF7Dug9FgX2e0BUg06JKTA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1BF7Dug9FgX2e0BUg06JKTA</a>  密码: c9id</p>
<p>高清电子版-面向对象软件工程_12260512.pdf 链接: <a href="https://pan.baidu.com/s/1fMns7fzJ2R5DaTGfCFQNNg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1fMns7fzJ2R5DaTGfCFQNNg</a>  密码: mio9</p>
<p>高清电子版-面向对象与传统软件工程统一过程的理论与实践 （原书第6版）_11526358.pdf 链接: <a href="https://pan.baidu.com/s/1kFQZ0svz0teOXg4riG7Szw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1kFQZ0svz0teOXg4riG7Szw</a>  密码: a8at</p>
<h3 id="java进阶篇" tabindex="-1"> Java进阶篇</h3>
<p>高清电子版-AOP的实现机制.pdf</p>
<p>高清电子版-Apache服务器配置与使用工作笔记.pdf</p>
<p>高清电子版-Java编程的逻辑 马俊昌 2018.1 Pg675.pdf</p>
<p>高清电子版-Java程序性能优化 让你的Java程序更快、更稳定.pdf 链接: <a href="https://pan.baidu.com/s/15FgbewnMiLF028JPpKOa_w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/15FgbewnMiLF028JPpKOa_w</a>  密码: h23h</p>
<p>高清电子版-Java典型模块与项目实战大全.pdf</p>
<p>高清电子版-Java典型应用彻查1000例+：图形与网络游戏开发.pdf</p>
<p>高清电子版-Java特种兵 上.pdf</p>
<p>高清电子版-java性能优化权威指南（带书签）.pdf 链接: <a href="https://pan.baidu.com/s/1u0e6I1dGgW_k2QbktF1yKA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1u0e6I1dGgW_k2QbktF1yKA</a> 提取码: wqip</p>
<p>高清电子版-Java与模式(清晰书签版).pdf</p>
<p>高清电子版-[Java] Java程序员修炼之道.pdf 链接: <a href="https://pan.baidu.com/s/1m_yKVj65BUuoX619OyaxTw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1m_yKVj65BUuoX619OyaxTw</a>  密码: pbrl</p>
<p>高清电子版-[Java] Java开发之道.pdf 链接: <a href="https://pan.baidu.com/s/1dIw7BjIBMO0Kz2XhSaUyCA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1dIw7BjIBMO0Kz2XhSaUyCA</a> 提取码: ni2j</p>
<p>高清电子版-[Java] Java语言程序设计-进阶篇(原书第8版).pdf 链接: <a href="https://pan.baidu.com/s/18-8e4yjtj0jl6QuGdqHqhw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/18-8e4yjtj0jl6QuGdqHqhw</a> 提取码: asr3</p>
<p>高清电子版-[Java] 菜鸟成长之路—Java程序员职场全攻略.pdf 链接: <a href="https://pan.baidu.com/s/1xFM6moTzb1zpB6m3jPdThA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1xFM6moTzb1zpB6m3jPdThA</a>  密码: to7f</p>
<p>高清电子版-[Java典型应用彻查1000例：数据库应用基础].pdf 链接: <a href="https://pan.baidu.com/s/1ifmLZ23Qsg38pj0m5hTYTA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ifmLZ23Qsg38pj0m5hTYTA</a> 提取码: mi6q</p>
<p>高清电子版-[Java典型应用彻查1000例：图形与网络游戏开发].pdf 链接: <a href="https://pan.baidu.com/s/1FIqmYGD-6HkOAI18StZ32A" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1FIqmYGD-6HkOAI18StZ32A</a>  密码: 6agb</p>
<p>高清电子版-[Java典型应用彻查1000例：网络应用开发].pdf 链接: <a href="https://pan.baidu.com/s/1lw6Y8qjKN6yVrvyEhpT6lQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1lw6Y8qjKN6yVrvyEhpT6lQ</a> 提取码: aff0</p>
<p>高清电子版-[Java典型应用彻查1000例：网站数据库设计].pdf 链接: <a href="https://pan.baidu.com/s/1A8gMDljBFrGqioOzuopZxQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1A8gMDljBFrGqioOzuopZxQ</a>  密码: 8k45</p>
<p>高清电子版-[Java语言程序设计-进阶篇(原书第8版)].pdf 链接: <a href="https://pan.baidu.com/s/1G01ww-lh2re0Acg0_kydgA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1G01ww-lh2re0Acg0_kydgA</a>  密码: 6p67</p>
<p>高清电子版-《码出高效：Java开发手册》.pdf 链接: <a href="https://pan.baidu.com/s/1Iq_W1ykLMHcDI3Ia1No4gg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Iq_W1ykLMHcDI3Ia1No4gg</a>  密码: wadh</p>
<p>高清电子版-编程之美-完整版.pdf 链接: <a href="https://pan.baidu.com/s/18-8e4yjtj0jl6QuGdqHqhw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/18-8e4yjtj0jl6QuGdqHqhw</a> 提取码: asr3</p>
<p>高清电子版-编写高效优雅Java程序.pdf 链接: <a href="https://pan.baidu.com/s/1Hwr6xiB9PFEeNcvvjmBMzw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Hwr6xiB9PFEeNcvvjmBMzw</a>  密码: k4b6</p>
<p>高清电子版-代码大全2中文版.pdf 链接: <a href="https://pan.baidu.com/s/1G2jslnm0-cGjQJrXXs_wNg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1G2jslnm0-cGjQJrXXs_wNg</a>  密码: m64k</p>
<p>高清电子版-代码整洁之道.pdf 链接: <a href="https://pan.baidu.com/s/1oGk_hqaJo3-Rce1OLvo8jw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1oGk_hqaJo3-Rce1OLvo8jw</a>  密码: a87r</p>
<p>高清电子版-构建高性能WEB站点.pdf 链接: <a href="https://pan.baidu.com/s/1AQKQRncDTOywZNe0A2CMyg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1AQKQRncDTOywZNe0A2CMyg</a> 提取码: tcm2</p>
<p>高清电子版-计算机程序设计艺术（第二卷）高清中文版.pdf 链接: <a href="https://pan.baidu.com/s/18esBE4qQSC-7FO5DmEM6Rw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/18esBE4qQSC-7FO5DmEM6Rw</a>  密码: qv58</p>
<p>高清电子版-计算机程序设计艺术（第三卷）高清中文版.pdf 链接: <a href="https://pan.baidu.com/s/1KDpTnqFnzQmzZBiEapRpLA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1KDpTnqFnzQmzZBiEapRpLA</a>  密码: qs5o</p>
<p>高清电子版-计算机程序设计艺术（第一卷）高清中文版.pdf 链接: <a href="https://pan.baidu.com/s/1T5u5y-6G-OS5SRsRSgFPbA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1T5u5y-6G-OS5SRsRSgFPbA</a>  密码: ho8j</p>
<p>高清电子版-零成本实现Web性能测试.pdf 链接: <a href="https://pan.baidu.com/s/1lP8ZLPMkLn_-0461cRKr_w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1lP8ZLPMkLn_-0461cRKr_w</a>  密码: amjg</p>
<p>高清电子版-敏捷软件开发：原则、模式与实践.pdf 链接: <a href="https://pan.baidu.com/s/1afXby-1453ELu9YlOchdCg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1afXby-1453ELu9YlOchdCg</a>  密码: 07tv</p>
<p>高清电子版-深入理解Java虚拟机（第二版-带目录）.pdf 链接: <a href="https://pan.baidu.com/s/1c-xGoYvKqkNmyWzt1oSwQw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1c-xGoYvKqkNmyWzt1oSwQw</a>  密码: lns1</p>
<p>高清电子版-实战Java虚拟机.pdf 链接: <a href="https://pan.baidu.com/s/1V-E-m5EmZq6HWYzjoqvzbQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1V-E-m5EmZq6HWYzjoqvzbQ</a> 提取码: 0kfv</p>
<p>高清电子版-重构-改善既有代码的设计.pdf 链接: <a href="https://pan.baidu.com/s/1nRZNmh4mLJWuZkgAQG6FCA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1nRZNmh4mLJWuZkgAQG6FCA</a>  密码: 5evd</p>
<h3 id="javaweb篇" tabindex="-1"> JavaWeb篇</h3>
<p>高清电子版-Head First Servlets and JSP 中文版 第2版.pdf 链接: <a href="https://pan.baidu.com/s/18-_tDYI68m0SFc_sQiDTDA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/18-_tDYI68m0SFc_sQiDTDA</a> 提取码: iw4v</p>
<p>高清电子版-Java RESTful Web Service实战 [韩陆著].pdf 链接: <a href="https://pan.baidu.com/s/1R4tPgNfNgr50zWJ-4_5Fyg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1R4tPgNfNgr50zWJ-4_5Fyg</a> 提取码: iqjj</p>
<p>高清电子版-JAVA web模式设计之道(<a href="http://jb51.net" target="_blank" rel="noopener noreferrer">jb51.net</a>).pdf 链接: <a href="https://pan.baidu.com/s/1rw-hNFvSVIbCZHw44ys64w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1rw-hNFvSVIbCZHw44ys64w</a>  密码: u30e</p>
<p>高清电子版-Java Web企业项目实战.pdf 链接: <a href="https://pan.baidu.com/s/1_Y-byXI8y6hBD8J2rw9SWw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1_Y-byXI8y6hBD8J2rw9SWw</a>  密码: mdc4</p>
<p>高清电子版-Java] 关键技术JSP与JDBC应用详解.pdf 链接: <a href="https://pan.baidu.com/s/1OVgyE18nUxubxCmW9LZcPg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1OVgyE18nUxubxCmW9LZcPg</a>  密码: im8n</p>
<p>高清电子版-RESTful Web Services Cookbook 中文版_12879413.pdf 链接: <a href="https://pan.baidu.com/s/1BMsW31xLOpjXEoxp3BbWHg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1BMsW31xLOpjXEoxp3BbWHg</a>  密码: uplv</p>
<p>高清电子版-servlet-3_0-final-spec.pdf 链接: <a href="https://pan.baidu.com/s/1zE6EfEWJPZsBvlVLJyhX0g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1zE6EfEWJPZsBvlVLJyhX0g</a>  密码: jmd5</p>
<p>高清电子版-SERVLETJSP01_IMAGE.pdf 链接: <a href="https://pan.baidu.com/s/1ckHthX5aUzM6Kkve3tHKhA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ckHthX5aUzM6Kkve3tHKhA</a>  密码: aliu</p>
<p>高清电子版-Struts2轻松入门.pdf 链接: <a href="https://pan.baidu.com/s/1K_Cpmn9ZeRm5EuF82pp_LQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1K_Cpmn9ZeRm5EuF82pp_LQ</a>  密码: sgbb</p>
<p>高清电子版-Web安全开发指南.pdf 链接: <a href="https://pan.baidu.com/s/1MbhX2y7bVzCJiukGbtmjaQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1MbhX2y7bVzCJiukGbtmjaQ</a>  密码: q2jb</p>
<p>高清电子版-Web性能测试实战详解+Web开发典藏大系.pdf 链接: <a href="https://pan.baidu.com/s/161utLObAJtQYIyR0EQEsKA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/161utLObAJtQYIyR0EQEsKA</a>  密码: wqi9</p>
<p>高清电子版-Web应用安全权威指南.pdf 链接: <a href="https://pan.baidu.com/s/1Q-8orrd7pH5gv6frxcxCEg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Q-8orrd7pH5gv6frxcxCEg</a>  密码: 3n39</p>
<p>高清电子版-[JAVA.WEB服务.构建与运行].(Java.Web.ServicesUp.and.Running).Martin.Kalin.扫描版.pdf 链接: <a href="https://pan.baidu.com/s/1LM3s1PWSTzx4AhelmH0LGA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1LM3s1PWSTzx4AhelmH0LGA</a>  密码: de5s</p>
<p>高清电子版-[Java] Java Web整合开发王者归来.pdf 链接: <a href="https://pan.baidu.com/s/1pBMqvM7f2y2WEj8lg9B76g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1pBMqvM7f2y2WEj8lg9B76g</a>  密码: bihb</p>
<p>高清电子版-[Java] 深入浅出Servlets.and.JSP第二版.pdf 链接: <a href="https://pan.baidu.com/s/1t6i3gvfOWJk48pc-80PC6g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1t6i3gvfOWJk48pc-80PC6g</a>  密码: pqqs</p>
<p>高清电子版-[使用Java.Web服务构建SOA].(汉森).成保栋.pdf 链接: <a href="https://pan.baidu.com/s/1oSzJv1mDQwjLwOto5hoETg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1oSzJv1mDQwjLwOto5hoETg</a>  密码: vc0m</p>
<p>高清电子版-《Java+Web开发与实战--Eclipse+Tomcat+Servlet+JSP整合应用》.pdf 链接: <a href="https://pan.baidu.com/s/1fmyXVuVjnXzYEXm32MFqnQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1fmyXVuVjnXzYEXm32MFqnQ</a>  密码: taw3</p>
<p>高清电子版-《servlet和jsp学习指南》.pdf 链接: <a href="https://pan.baidu.com/s/1_skCpLtDJhFOs2FOr3RXcw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1_skCpLtDJhFOs2FOr3RXcw</a>  密码: g5qk</p>
<p>高清电子版-高性能响应式Web开发实战.pdf 链接: <a href="https://pan.baidu.com/s/1JqI-H1TBbtcbwPgmJ5DsOA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1JqI-H1TBbtcbwPgmJ5DsOA</a>  密码: l56f</p>
<p>高清电子版-深入分析Java Web技术内幕 修订版.pdf 链接: <a href="https://pan.baidu.com/s/1kiRo_TphKB9nuLa3IEDTYw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1kiRo_TphKB9nuLa3IEDTYw</a>  密码: rsak</p>
<p>高清电子版-图解HTTP.pdf 链接: <a href="https://pan.baidu.com/s/1Hm1iNZJkmen_jU2xz3OJRQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Hm1iNZJkmen_jU2xz3OJRQ</a>  密码: 91rr</p>
<h3 id="java高并发-多线程-网络编程-jvm" tabindex="-1"> Java高并发-多线程-网络编程-JVM</h3>
<p>高清电子版-Java 7并发编程实战手册.pdf 链接: <a href="https://pan.baidu.com/s/1r2sEjKBZH5EiBSeciAq-IQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1r2sEjKBZH5EiBSeciAq-IQ</a> 提取码: hnl0</p>
<p>高清电子版-Java NIO (中文版).pdf 链接: <a href="https://pan.baidu.com/s/1y2j76KUJKOZijGvzOXEgSg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1y2j76KUJKOZijGvzOXEgSg</a>  密码: 0wqv</p>
<p>高清电子版-Java TCP IP Socket编程(原书第2版).pdf 链接: <a href="https://pan.baidu.com/s/116tj1CYy3JSww7x4O5boig" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/116tj1CYy3JSww7x4O5boig</a>  密码: ofkj</p>
<p>高清电子版-Java+JVM.pdf 链接: <a href="https://pan.baidu.com/s/1gRX1joZtkS1a2487AvL8Ig" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1gRX1joZtkS1a2487AvL8Ig</a>  密码: vafe</p>
<p>高清电子版-JAVA并发编程 核心方法与框架 高洪岩著.pdf 链接: <a href="https://pan.baidu.com/s/1qiadNwj5PxonFpRGT3Hneg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1qiadNwj5PxonFpRGT3Hneg</a> 提取码: w2gj</p>
<p>高清电子版-Java并发编程：设计原则与模式（第二版）.pdf 链接: <a href="https://pan.baidu.com/s/1mevIT3feswPQe1mPQvMM7A" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1mevIT3feswPQe1mPQvMM7A</a>  密码: 7qo5</p>
<p>高清电子版-Java并发编程的艺术.pdf 链接: <a href="https://pan.baidu.com/s/1O6ERIW6FGcEB9EWpkjL18g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1O6ERIW6FGcEB9EWpkjL18g</a>  密码: c0ht</p>
<p>高清电子版-JAVA并发编程实践（中文）.pdf 链接: <a href="https://pan.baidu.com/s/1J6Se3msClb3hp62RywTC6w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1J6Se3msClb3hp62RywTC6w</a> 提取码: mujc</p>
<p>高清电子版-Java并发编程学习笔记.pdf 链接: <a href="https://pan.baidu.com/s/1YSK7T8coqGyZC6XBTIKTvQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1YSK7T8coqGyZC6XBTIKTvQ</a>  密码: qghs</p>
<p>高清电子版-Java多线程编程核心技术_完整版.pdf 链接: <a href="https://pan.baidu.com/s/1aihNDIx_UtvRubE3zSRXAw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1aihNDIx_UtvRubE3zSRXAw</a> 提取码: sf8u</p>
<p>高清电子版-Java多线程编程深入详解.pdf 链接: <a href="https://pan.baidu.com/s/1it36IAy42Lp7oBg8rqbHfQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1it36IAy42Lp7oBg8rqbHfQ</a>  密码: htfo</p>
<p>高清电子版-Java多线程编程实战指南 设计模式篇.pdf 链接: <a href="https://pan.baidu.com/s/1PVTqsxgruCm-1xUAtjRqwQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1PVTqsxgruCm-1xUAtjRqwQ</a>  密码: clpt</p>
<p>高清电子版-java线程.pdf 链接: <a href="https://pan.baidu.com/s/1rH4dhNs3taUUDh1maAyqRg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1rH4dhNs3taUUDh1maAyqRg</a>  密码: hq9l</p>
<p>高清电子版-Java性能优化权威指南.pdf 链接: <a href="https://pan.baidu.com/s/1Ebl_iIdVkNni-zmtCuzOWA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Ebl_iIdVkNni-zmtCuzOWA</a>  密码: j4cq</p>
<p>高清电子版-JVM.Spec.v9.pdf 链接: <a href="https://pan.baidu.com/s/1B7SKKHktpS3T98maEJspmg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1B7SKKHktpS3T98maEJspmg</a>  密码: 7ni3</p>
<p>高清电子版-JVM定制改进 @ 淘宝.pdf 链接: <a href="https://pan.baidu.com/s/1OmfphG_hiXHs8RTHmaBxig" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1OmfphG_hiXHs8RTHmaBxig</a> 提取码: gct4</p>
<p>高清电子版-Netty in Action第五版.pdf 链接: <a href="https://pan.baidu.com/s/1VxzvHqP9ohF2BX1rgOTkdg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1VxzvHqP9ohF2BX1rgOTkdg</a>  密码: uwn6</p>
<p>高清电子版-Netty 实战(精髓).pdf 链接: <a href="https://pan.baidu.com/s/1FNx6RBlrw72gfVk_EUtGig" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1FNx6RBlrw72gfVk_EUtGig</a> 提取码: c0wj</p>
<p>高清电子版-Netty权威指南 PDF电子书下载 带目录书签 完整版.pdf 链接: <a href="https://pan.baidu.com/s/1D2Mtx_n_145nqY8poYzGBw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1D2Mtx_n_145nqY8poYzGBw</a> 提取码: wwiv</p>
<p>高清电子版-TCPIP网络编程技术基础.pdf 链接: <a href="https://pan.baidu.com/s/1Jpek0ONSHLPf2j4HiRxc8g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Jpek0ONSHLPf2j4HiRxc8g</a> 提取码: nfat</p>
<p>高清电子版-TCPIP详解卷1.pdf 链接: <a href="https://pan.baidu.com/s/1cn-wkmgiH02C_XzP95Q0zA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1cn-wkmgiH02C_XzP95Q0zA</a> 提取码: bgii</p>
<p>高清电子版-TCPIP详解卷2.pdf 链接: <a href="https://pan.baidu.com/s/13fzBRkKKpBM72svllUlUEA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/13fzBRkKKpBM72svllUlUEA</a>  密码: 9449</p>
<p>高清电子版-TCPIP详解卷3.pdf 链接: <a href="https://pan.baidu.com/s/1QTZfIVqLpN6_XpjOOYPr5Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1QTZfIVqLpN6_XpjOOYPr5Q</a>  密码: qc9q</p>
<p>高清电子版-Twitter的JVM性能调优经验分享（Attila Szegedi）.pdf 链接: <a href="https://pan.baidu.com/s/1fdaFkmP04WgQqqVatwUTXQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1fdaFkmP04WgQqqVatwUTXQ</a>  密码: 4hu1</p>
<p>高清电子版-UNIX网络编程卷1：套接字联网API（第3版）.pdf 链接: <a href="https://pan.baidu.com/s/1QnWlalxLpKyKq5IBGEWUJQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1QnWlalxLpKyKq5IBGEWUJQ</a>  密码: dp8f</p>
<p>高清电子版-《Java多线程编程核心技术》迷你书.pdf 链接: <a href="https://pan.baidu.com/s/1R_FZJdgR1rwbxm8vRCJ1jA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1R_FZJdgR1rwbxm8vRCJ1jA</a>  密码: cb0q</p>
<p>高清电子版-《Java虚拟机并发编程》.pdf 链接: <a href="https://pan.baidu.com/s/10lkE2iHfBB1cGTQDz3cB0w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/10lkE2iHfBB1cGTQDz3cB0w</a>  密码: o7u8</p>
<p>高清电子版-开源电子书：Netty 4 开发手册.pdf 链接: <a href="https://pan.baidu.com/s/1vLGKBlYFVqoacb5QTUNjhw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1vLGKBlYFVqoacb5QTUNjhw</a>  密码: pcpp</p>
<p>高清电子版-开源电子书：Netty 手册.pdf 链接: <a href="https://pan.baidu.com/s/1uiF2oz7bWAPc3BXcP0YdXA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1uiF2oz7bWAPc3BXcP0YdXA</a>  密码: nb5c</p>
<p>高清电子版-开源电子书：Nginx 开发手册文档.pdf 链接: <a href="https://pan.baidu.com/s/1eCiR6Xi9i7aJQeq9OwACLA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1eCiR6Xi9i7aJQeq9OwACLA</a>  密码: d5q6</p>
<p>高清电子版-七周七并发模型.pdf 链接: <a href="https://pan.baidu.com/s/1viD2DdUMrHksNKImmglhng" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1viD2DdUMrHksNKImmglhng</a>  密码: w61q</p>
<p>高清电子版-深入理解Java虚拟机（第二版-带目录）.pdf 链接: <a href="https://pan.baidu.com/s/1KucmVdIRZ_Iu4aPpqIb5TQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1KucmVdIRZ_Iu4aPpqIb5TQ</a>  密码: 4uet</p>
<p>高清电子版-深入理解Java虚拟机：JVM高级特性与最佳实践（最新第二版）.pdf 链接: <a href="https://pan.baidu.com/s/1lY1LWam6FXsNAuYOK5Vafg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1lY1LWam6FXsNAuYOK5Vafg</a>  密码: rw1o</p>
<p>高清电子版-实战Java高并发程序设计.pdf 链接: <a href="https://pan.baidu.com/s/1Gu_rlO48-nRO3pt7TNAQwg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Gu_rlO48-nRO3pt7TNAQwg</a>  密码: 3wva</p>
<p>高清电子版-实战JAVA虚拟机JVM故障诊断与性能优化.pdf 链接: <a href="https://pan.baidu.com/s/1NR9PTUk5XP-L2XIXnL3H1Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1NR9PTUk5XP-L2XIXnL3H1Q</a>  密码: j31u</p>
<p>高清电子版-图解Java多线程设计模式.pdf 链接: <a href="https://pan.baidu.com/s/1A8mSQGr5ydNdVj2FZ5PDSA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1A8mSQGr5ydNdVj2FZ5PDSA</a>  密码: daaf</p>
<p>高清电子版-虚拟机系统与进程的通用平台_12189999.pdf 链接: <a href="https://pan.baidu.com/s/1bky5lrI9mUdA6yiVnZ1s0g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1bky5lrI9mUdA6yiVnZ1s0g</a>  密码: rj86</p>
<h3 id="spring相关" tabindex="-1"> Spring相关</h3>
<p>高清电子版-Java EE互联网轻量级框架整合开发 SSM框架（Spring MVC+Spring+MyBatis）和Redis实现.pdf 链接: <a href="https://pan.baidu.com/s/13avqcfxFMavqNd3VbM9Gng" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/13avqcfxFMavqNd3VbM9Gng</a>  密码: ia45</p>
<p>高清电子版-Java EE设计模式：Spring企业级开发最佳实践.pdf 链接: <a href="https://pan.baidu.com/s/149UAWadKpIo6FZlkyvghvw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/149UAWadKpIo6FZlkyvghvw</a>  密码: i8c0</p>
<p>高清电子版-Spring 3.0就这么简单》.(陈雄华 林开雄).[PDF].&amp;ckook.pdf 链接: <a href="https://pan.baidu.com/s/1Aa4Z4qkAKwowvnCxUFATcQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Aa4Z4qkAKwowvnCxUFATcQ</a>  密码: a6q4</p>
<p>高清电子版-Spring Batch批处理框架.pdf 链接: <a href="https://pan.baidu.com/s/1XYP4mSPQPWAUGGi1dqDPxA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1XYP4mSPQPWAUGGi1dqDPxA</a>  密码: 94r8</p>
<p>高清电子版-Spring Data实战.pdf 链接: <a href="https://pan.baidu.com/s/1_xDQI-ZcZd653w5xCZoRLw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1_xDQI-ZcZd653w5xCZoRLw</a>  密码: gcs2</p>
<p>高清电子版-Spring in action 中文版（第4版）.pdf 链接: <a href="https://pan.baidu.com/s/1Zra_aQUSqNU5XHKa4WHEHA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Zra_aQUSqNU5XHKa4WHEHA</a>  密码: p582</p>
<p>高清电子版-SPRING 实战（第3版）.pdf 链接: <a href="https://pan.baidu.com/s/1MCiqEJIamA80sycip9It5Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1MCiqEJIamA80sycip9It5Q</a>  密码: j3fk</p>
<p>高清电子版-Spring+MVC+MYBatis企业应用实战.pdf 链接: <a href="https://pan.baidu.com/s/1OBh6-zUU79XQ2WdgCJNlfA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1OBh6-zUU79XQ2WdgCJNlfA</a> 提取码: 95hr</p>
<p>高清电子版-Spring+Security3+张卫滨(译).pdf 链接: <a href="https://pan.baidu.com/s/1BctZSQl_VzA0NzLAi95WlQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1BctZSQl_VzA0NzLAi95WlQ</a>  密码: e6va</p>
<p>高清电子版-spring-framework-reference.pdf 链接: <a href="https://pan.baidu.com/s/1y8HnvevLceqZ-UjYSgqxLQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1y8HnvevLceqZ-UjYSgqxLQ</a>  密码: h7vt</p>
<p>高清电子版-springMvc教学.pdf 链接: <a href="https://pan.baidu.com/s/1ihwA9cbid_BlbJDGNoImvg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ihwA9cbid_BlbJDGNoImvg</a> 提取码: qo98</p>
<p>高清电子版-SPRING技术内幕：深入解析SPRING架构与设计原理.pdf 链接: <a href="https://pan.baidu.com/s/1Uh3SyEAzLQYmA7aBkNTYQw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Uh3SyEAzLQYmA7aBkNTYQw</a>  密码: 1puc</p>
<p>高清电子版-spring揭秘(完整).pdf 链接: <a href="https://pan.baidu.com/s/153aWXlJf3sVi3lCZT8lzHg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/153aWXlJf3sVi3lCZT8lzHg</a>  密码: 6u85</p>
<p>高清电子版-Spring实战(第4版).pdf 链接: <a href="https://pan.baidu.com/s/1BylwqpY1snucSz3MDH3ozw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1BylwqpY1snucSz3MDH3ozw</a>  密码: r8ep</p>
<p>高清电子版-Spring源码深度解析.pdf 链接: <a href="https://pan.baidu.com/s/1XkS_aXNIPguVlVuvtEU2aw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1XkS_aXNIPguVlVuvtEU2aw</a>  密码: na2t</p>
<p>高清电子版-Spring中文开发手册.pdf 链接: <a href="https://pan.baidu.com/s/1KzchmxIUEUU24Uvk2CCwZw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1KzchmxIUEUU24Uvk2CCwZw</a>  密码: uq66</p>
<p>高清电子版-[Spring技术内幕：深入解析Spring架构与设计原理（第2版）].计文柯.扫描版.pdf 链接: <a href="https://pan.baidu.com/s/1Dp0_k5oacnYqyRjh4L8wSg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Dp0_k5oacnYqyRjh4L8wSg</a>  密码: qj3s</p>
<p>高清电子版-《精通Spring4.X企业应用开发实战》.pdf 链接: <a href="https://pan.baidu.com/s/1bBFs1aIt4shnrXadnBv1eQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1bBFs1aIt4shnrXadnBv1eQ</a> 提取码: cg5a</p>
<p>高清电子版-《亿级流量网站架构核心技术-跟开涛学搭建高可用高并发系统》.pdf 链接: <a href="https://pan.baidu.com/s/1im0ml8S7iF0XVEk4xQ3fbQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1im0ml8S7iF0XVEk4xQ3fbQ</a> 提取码: urhn</p>
<p>高清电子版-精通Spring MVC4.pdf 链接: <a href="https://pan.baidu.com/s/1B_usb4l0rZ3LozjYcS7Pww" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1B_usb4l0rZ3LozjYcS7Pww</a>  密码: 8k4p</p>
<p>高清电子版-精通Spring(清晰书签版).pdf 链接: <a href="https://pan.baidu.com/s/1av3FdZnK4x4qan6a11lLzA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1av3FdZnK4x4qan6a11lLzA</a>  密码: 4vve</p>
<p>高清电子版-精通Spring企业应用开发实战.pdf 链接: <a href="https://pan.baidu.com/s/1C5OkDjkytJbaDsVBYJWXrw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1C5OkDjkytJbaDsVBYJWXrw</a>  密码: lgvm</p>
<p>高清电子版-开源电子书：spring mvc 开发手册文档.pdf 链接: <a href="https://pan.baidu.com/s/1HxW4nK5GGBr74zW4W-0jOQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1HxW4nK5GGBr74zW4W-0jOQ</a> 提取码: trfe</p>
<p>高清电子版-看透Spring MVC源代码分析与实践 .pdf 链接: <a href="https://pan.baidu.com/s/1tq1InK1qwBJ6bEssx2qXiQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1tq1InK1qwBJ6bEssx2qXiQ</a>  密码: s30o</p>
<h3 id="springboot相关" tabindex="-1"> SpringBoot相关</h3>
<p>高清电子版-JavaEE开发的颠覆者 Spring Boot实战 完整版.pdf 链接: <a href="https://pan.baidu.com/s/1KXocZK7g0EHHuKzNj66xqQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1KXocZK7g0EHHuKzNj66xqQ</a> 提取码: qcll</p>
<p>高清电子版-Spring Boot 2参考手册中文文档.pdf 链接: <a href="https://pan.baidu.com/s/1cKcj4DcJ0aFnbTeSAMEJUA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1cKcj4DcJ0aFnbTeSAMEJUA</a> 提取码: g120</p>
<p>高清电子版-Spring Boot 2精髓.pdf 链接: <a href="https://pan.baidu.com/s/1fsM75Dacj6oLUk-bzXmJzg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1fsM75Dacj6oLUk-bzXmJzg</a> 提取码: ledw</p>
<p>高清电子版-Spring Boot 2精髓带书签目录高清版.pdf 链接: <a href="https://pan.baidu.com/s/1Y8TMwIIfzjC8WLGAoGrkdA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Y8TMwIIfzjC8WLGAoGrkdA</a> 提取码: u2e1</p>
<p>高清电子版-Spring Boot Cookbook.pdf 链接: <a href="https://pan.baidu.com/s/16CIaeK0FcpNwkMkAvdFPyw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/16CIaeK0FcpNwkMkAvdFPyw</a> 提取码: or9v</p>
<p>高清电子版-Spring Boot 企业级应用开发实战 柳伟卫 2018.3 Pg442.pdf 链接: <a href="https://pan.baidu.com/s/1B-VfptRbzF44tDPdJh7zZQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1B-VfptRbzF44tDPdJh7zZQ</a> 提取码: 1u4o</p>
<p>高清电子版-Spring Boot实战 丁雪丰 (译者) .pdf 链接: <a href="https://pan.baidu.com/s/1Rds1wiIQW_182bLdZWpOpA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Rds1wiIQW_182bLdZWpOpA</a> 提取码: dflu</p>
<p>高清电子版-Spring Cloud微服务实战.pdf 链接: <a href="https://pan.baidu.com/s/1EQcn39UfzKUp9pLMSxIjUA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1EQcn39UfzKUp9pLMSxIjUA</a> 提取码: 3l9v</p>
<p>高清电子版-spring-boot-reference-guide-zh.pdf 链接: <a href="https://pan.baidu.com/s/16GGSG9ZGkREPQ1OAmgrR7w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/16GGSG9ZGkREPQ1OAmgrR7w</a> 提取码: oe2k</p>
<p>高清电子版-Spring.Boot.in.Action.2015.12.pdf</p>
<p>高清电子版-Spring.in.Action_4th.Edition-Spring实战(第4版文字版).pdf 链接: <a href="https://pan.baidu.com/s/1NQThOftvTEL4039E-JyBdw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1NQThOftvTEL4039E-JyBdw</a> 提取码: i0d6</p>
<p>高清电子版-SpringBoot揭秘快速构建微服务体系.pdf 链接: <a href="https://pan.baidu.com/s/1EWIniFsEaePaeZkJx5s-kw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1EWIniFsEaePaeZkJx5s-kw</a> 提取码: 8gw2</p>
<p>高清电子版-SpringBoot实战(第4版).pdf 链接: <a href="https://pan.baidu.com/s/1akKn2hcLMyQ_PJiemQR09Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1akKn2hcLMyQ_PJiemQR09Q</a> 提取码: 6n8e</p>
<p>高清电子版-SpringCloud中文文档.pdf</p>
<p>高清电子版-Spring_Cloud_Data_Flow.pdf 链接: <a href="https://pan.baidu.com/s/1Dozf1TgvYgVC2e_4fK-Lfg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Dozf1TgvYgVC2e_4fK-Lfg</a> 提取码: mco8</p>
<p>高清电子版-Spring微服务 RajeshRV 2018.06 Pg327.pdf 链接: <a href="https://pan.baidu.com/s/19he3izaYc4Qce4jyF5SNDQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/19he3izaYc4Qce4jyF5SNDQ</a> 提取码: t5og</p>
<p>高清电子版-Spring微服务实战 约翰·卡内尔 2018.6 Pg298.pdf 链接: <a href="https://pan.baidu.com/s/1XG_IXomn2CgUg1saXifN-w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1XG_IXomn2CgUg1saXifN-w</a> 提取码: sie3</p>
<p>高清电子版-《SpringBoot揭秘：快速构建微服务体系》.pdf 链接: <a href="https://pan.baidu.com/s/1eLWfK5ATSVSm1F5ztEdifg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1eLWfK5ATSVSm1F5ztEdifg</a> 提取码: 19p4</p>
<p>高清电子版-从零开始学Spring Boot.pdf 链接: <a href="https://pan.baidu.com/s/1ImLEtS9V4lqjYm42pMfjZQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ImLEtS9V4lqjYm42pMfjZQ</a> 提取码: l1fb</p>
<p>高清电子版-开源电子书：spring boot 开发手册文档.pdf 链接: <a href="https://pan.baidu.com/s/1H45UxWwRgszzONW2ek56EA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1H45UxWwRgszzONW2ek56EA</a> 提取码: pb9s</p>
<p>高清电子版-深入浅出Spring Boot 2.x 杨开振 2018.8.pdf 链接: <a href="https://pan.baidu.com/s/1VjwPNtWcLXulz8EyRhj1IQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1VjwPNtWcLXulz8EyRhj1IQ</a> 提取码: oowo</p>
<p>高清电子版-深入实践Spring Boot.陈韶健.pdf 链接: <a href="https://pan.baidu.com/s/1thgxrKX_p-cjmnte5_AIKA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1thgxrKX_p-cjmnte5_AIKA</a> 提取码: igf8</p>
<h3 id="springdata相关" tabindex="-1"> SpringData相关</h3>
<p>高清电子版-Spring Data JPA从入门到精通_张振华(著) 清华大学出版社.pdf 链接: <a href="https://pan.baidu.com/s/1DzHDNGrVgtzFv_QWPQ7wdw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1DzHDNGrVgtzFv_QWPQ7wdw</a> 提取码: qe7r</p>
<p>高清电子版-Spring Data实战.pdf 链接: <a href="https://pan.baidu.com/s/1KZP_GDNZkqDdgK7Zn48UnQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1KZP_GDNZkqDdgK7Zn48UnQ</a> 提取码: hhl2</p>
<h3 id="springcloud相关" tabindex="-1"> SpringCloud相关</h3>
<p>高清电子版-Spring Cloud Dalston中文文档+参考手册+中文版.pdf 链接: <a href="https://pan.baidu.com/s/1oXZlctORrson4dClCgrm3w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1oXZlctORrson4dClCgrm3w</a> 提取码: se1t</p>
<p>高清电子版-Spring Cloud Finchley.RELEASE参考手册 中文文档.pdf 链接: <a href="https://pan.baidu.com/s/1v__DF2uXhUjeDF5nUcrRsA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1v__DF2uXhUjeDF5nUcrRsA</a> 提取码: 7nr0</p>
<p>高清电子版-Spring Cloud微服务架构开发实战.pdf 链接: <a href="https://pan.baidu.com/s/1bSowtsyIHm3eBUdnyTacvQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1bSowtsyIHm3eBUdnyTacvQ</a> 提取码: l9fm</p>
<p>高清电子版-Spring Cloud微服务实战.pdf 链接: <a href="https://pan.baidu.com/s/1kNAnPlDPdozlUowkzgp6RA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1kNAnPlDPdozlUowkzgp6RA</a> 提取码: h0rj</p>
<p>高清电子版-Spring Cloud与Docker微服务架构实战.pdf 链接: <a href="https://pan.baidu.com/s/1GZpoM1LAvfuo8Jn1IpMYyA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1GZpoM1LAvfuo8Jn1IpMYyA</a> 提取码: 6546</p>
<p>高清电子版-《深入理解Spring Cloud与微服务构建》.pdf 链接: <a href="https://pan.baidu.com/s/12j0x_KiHMkTYCxDQmgYhPg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/12j0x_KiHMkTYCxDQmgYhPg</a> 提取码: 5j8d</p>
<p>高清电子版-疯狂Spring Cloud微服务架构实战.pdf 链接: <a href="https://pan.baidu.com/s/1Mtc-LSRPy5Q3U-QFQqrUWA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Mtc-LSRPy5Q3U-QFQqrUWA</a> 提取码: rh3w</p>
<p>高清电子版-微服务分布式构架开发实战 龚鹏 2018.2 Pg202.pdf 链接: <a href="https://pan.baidu.com/s/1_EqR0_pKdDzh2y-PLrqJ9w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1_EqR0_pKdDzh2y-PLrqJ9w</a> 提取码: ka70</p>
<p>高清电子版-微服务架构基础 Spring Boot+Spring Cloud+Docker 黑马程序员 2018.4 Pg180.pdf 链接: <a href="https://pan.baidu.com/s/1F7NIvF4KXJxkelCegnFd9w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1F7NIvF4KXJxkelCegnFd9w</a> 提取码: 34ut</p>
<p>高清电子版-重新定义Spring Cloud实战 许进.pdf 链接: <a href="https://pan.baidu.com/s/12P3FvXD_GmYjPHNmr7H5WQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/12P3FvXD_GmYjPHNmr7H5WQ</a> 提取码: dt2o</p>
<h3 id="mybatis相关" tabindex="-1"> Mybatis相关</h3>
<p>高清电子版-Mybatis.pdf 链接: <a href="https://pan.baidu.com/s/1MlXyNq_9Gp1NHZGYejI5tg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1MlXyNq_9Gp1NHZGYejI5tg</a>  密码: 03bf</p>
<p>高清电子版-MyBatis3用户指南中文版.pdf 链接: <a href="https://pan.baidu.com/s/1H1v9FuwjWk_W-3ZXsjLGQg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1H1v9FuwjWk_W-3ZXsjLGQg</a> 提取码: knwh</p>
<p>高清电子版-Mybatis_3中文用户指南.pdf 链接: <a href="https://pan.baidu.com/s/1eTFLcZHrFyhOlUPirr1sNA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1eTFLcZHrFyhOlUPirr1sNA</a>  密码: gavm</p>
<p>高清电子版-MyBatis从入门到精通__刘增辉(著).pdf 链接: <a href="https://pan.baidu.com/s/1u4UsfH_IYti-AXfYYGZjgQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1u4UsfH_IYti-AXfYYGZjgQ</a>  密码: qjfl</p>
<p>高清电子版-《MyBatis技术内幕》.pdf 链接: <a href="https://pan.baidu.com/s/1tTLpzGY7OEvb8-B6ccubig" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1tTLpzGY7OEvb8-B6ccubig</a>  密码: rsuh</p>
<p>高清电子版-深入浅出MyBatis技术原理与实战.pdf 链接: <a href="https://pan.baidu.com/s/1ZiNmYn4AzscjhEFWBRYCaQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ZiNmYn4AzscjhEFWBRYCaQ</a>  密码: gvr5</p>
<h3 id="dubbo" tabindex="-1"> Dubbo</h3>
<p>高清电子版-马昕曦-Dubbo 的过去、现在以及未来.pdf 链接: <a href="https://pan.baidu.com/s/1LfWb9odYRFbJ1eq5gov7Sw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1LfWb9odYRFbJ1eq5gov7Sw</a> 提取码: n89g</p>
<h3 id="tomcat" tabindex="-1"> Tomcat</h3>
<p>高清电子版-How Tomcat Works中文版.pdf 链接: <a href="https://pan.baidu.com/s/1Hgv0QasbFsz7f07cGlMIwg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Hgv0QasbFsz7f07cGlMIwg</a> 提取码: d4q1</p>
<p>高清电子版-Tomcat架构解析.刘光瑞(详细书签).pdf 链接: <a href="https://pan.baidu.com/s/1nIYACelkzq2Vn1dWK3LWlA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1nIYACelkzq2Vn1dWK3LWlA</a> 提取码: e9bs</p>
<p>高清电子版-Tomcat内核设计剖析.pdf 链接: <a href="https://pan.baidu.com/s/1FOIsilEb_bgVatgpnTJaiA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1FOIsilEb_bgVatgpnTJaiA</a> 提取码: tst3</p>
<p>高清电子版-Tomcat权威指南(第2版).pdf 链接: <a href="https://pan.baidu.com/s/1IYNpPAKtGc9ZvgUNzQuHiw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1IYNpPAKtGc9ZvgUNzQuHiw</a> 提取码: 7rhe</p>
<p>高清电子版-Tomcat源码研究.pdf</p>
<p>高清电子版-基于_Tomcat5.0和_Axis2开发Web_Service应用实例.pdf 链接: <a href="https://pan.baidu.com/s/1pNgZxOCfWROGjFM2WlGZZw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1pNgZxOCfWROGjFM2WlGZZw</a> 提取码: c83n</p>
<p>高清电子版-深入剖析Tomcat（中文版）.pdf 链接: <a href="https://pan.baidu.com/s/1gZ-MTuqyXQ_-hVJoAem2mw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1gZ-MTuqyXQ_-hVJoAem2mw</a> 提取码: ebwj</p>
<h3 id="java爬虫篇" tabindex="-1"> Java爬虫篇</h3>
<p>高清电子版-网络爬虫全解析 技术、原理与实践@.pdf 链接: <a href="https://pan.baidu.com/s/1mH1cK4DaEu4ezpiqMS769A" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1mH1cK4DaEu4ezpiqMS769A</a>  密码: q334</p>
<p>高清电子版-网络爬虫入门到精通.pdf 链接: <a href="https://pan.baidu.com/s/1r1VoFWl5bKza8pfMRrJYHA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1r1VoFWl5bKza8pfMRrJYHA</a>  密码: 7q1i</p>
<h3 id="maven-git-docker等工具篇" tabindex="-1"> Maven-Git-Docker等工具篇</h3>
<p>高清电子版-09-蘑菇街基于Docker的私有云实践.pdf 链接: <a href="https://pan.baidu.com/s/1vKEC1JmMRAapSmVNO_0aSg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1vKEC1JmMRAapSmVNO_0aSg</a>  密码: dqbc</p>
<p>高清电子版-GitHub入门与实践_(日)_.pdf 链接: <a href="https://pan.baidu.com/s/1x5a0iiqbqFHveyD6II2xMw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1x5a0iiqbqFHveyD6II2xMw</a>  密码: umc2</p>
<p>高清电子版-Git权威指南.pdf 链接: <a href="https://pan.baidu.com/s/1FU4ZNioZ9DsncHMpCz0z3A" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1FU4ZNioZ9DsncHMpCz0z3A</a>  密码: dsnj</p>
<p>高清电子版-Maven权威指南_中文完整版清晰.pdf 链接: <a href="https://pan.baidu.com/s/1OJxLTUQSNThr9b7tZgPx1w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1OJxLTUQSNThr9b7tZgPx1w</a> 提取码: 5onm</p>
<p>高清电子版-Maven实战（高清完整带书签）.pdf 链接: <a href="https://pan.baidu.com/s/1q5acN-_jWzDhH8ydlQrBcA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1q5acN-_jWzDhH8ydlQrBcA</a>  密码: lr46</p>
<p>高清电子版-Myeclipse 10 激活详解过程.pdf 链接: <a href="https://pan.baidu.com/s/1XC9NBmyB5kNzXazHIGshOg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1XC9NBmyB5kNzXazHIGshOg</a>  密码: qp7q</p>
<p>高清电子版-PowerDesigner 16系统分析与建模实战 高清 电子书 pdf 下载 李波，孙宪丽，关颖编著清华大学出版社][2014.07][374页]sample.pdf 链接: <a href="https://pan.baidu.com/s/1_qkzK3uUjdRAiSe0UpqAIw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1_qkzK3uUjdRAiSe0UpqAIw</a>  密码: j6tg</p>
<p>高清电子版-Pro Git 中文版本.pdf 链接: <a href="https://pan.baidu.com/s/1q84oMz1Ne2fCv0hTF6QGZw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1q84oMz1Ne2fCv0hTF6QGZw</a>  密码: p6fp</p>
<p>高清电子版-《Git版本控制管理（第2版）》迷你书.pdf 链接: <a href="https://pan.baidu.com/s/1Ada13g5-tXC0nvBcfB-56g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Ada13g5-tXC0nvBcfB-56g</a>  密码: haom</p>
<p>高清电子版-从+0+开始学习+GitHub+系列.pdf 链接: <a href="https://pan.baidu.com/s/173qz3cUVugb6SlkyQ_EUTg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/173qz3cUVugb6SlkyQ_EUTg</a>  密码: plok</p>
<p>高清电子版-开源电子书：Gradle 使用手册.pdf 链接: <a href="https://pan.baidu.com/s/1X_C1rq9T7AInrFE3so7rKw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1X_C1rq9T7AInrFE3so7rKw</a> 提取码: gjdi</p>
<p>高清电子版-完全学会GIT GITHUB GIT SERVER的24堂课.pdf 链接: <a href="https://pan.baidu.com/s/1SAtnahi2dmPrCjBE45XMQw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1SAtnahi2dmPrCjBE45XMQw</a> 提取码: 79bm</p>
<h3 id="mysql篇" tabindex="-1"> Mysql篇</h3>
<p>高清电子版-001-MYSQL 5.5从零开始学.pdf 链接: <a href="https://pan.baidu.com/s/12jN88b1NAyEaBQPQRKBSwQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/12jN88b1NAyEaBQPQRKBSwQ</a>  密码: sre1</p>
<p>高清电子版-002-MySQL从入门到精通.pdf 链接: <a href="https://pan.baidu.com/s/1xNq64HxSPCgoePWmxXr5Nw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1xNq64HxSPCgoePWmxXr5Nw</a>  密码: k2tq</p>
<p>高清电子版-003-MySQL技术内幕.第5版.pdf 链接: <a href="https://pan.baidu.com/s/1KLn70LUZ4HaSMKiksCqfyQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1KLn70LUZ4HaSMKiksCqfyQ</a>  密码: fqk9</p>
<p>高清电子版-004-MySQL 5权威指南中文版第3版.pdf 链接: <a href="https://pan.baidu.com/s/1oGMJf-tmIfzuQA9oueUKHw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1oGMJf-tmIfzuQA9oueUKHw</a>  密码: wseg</p>
<p>高清电子版-005-MySQL入门很简单－学习笔记.pdf 链接: <a href="https://pan.baidu.com/s/1-TUIi6jZtyiUBawZHDYG6w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1-TUIi6jZtyiUBawZHDYG6w</a> 提取码: htk1</p>
<p>高清电子版-006-MySQL开发者SQL权威指南.pdf 链接: <a href="https://pan.baidu.com/s/1Mkhq7mdTugj39tB99JBp9w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Mkhq7mdTugj39tB99JBp9w</a>  密码: rhlk</p>
<p>高清电子版-007-MySQL最佳优化完美攻略.pdf 链接: <a href="https://pan.baidu.com/s/1sorflAH18de3nT_6Qk5V3A" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1sorflAH18de3nT_6Qk5V3A</a> 提取码: t3sr</p>
<p>高清电子版-009-MySQL技术内幕 InnoDB存储引擎 第2版.pdf 链接: <a href="https://pan.baidu.com/s/1Gz7csp5MQpwut6krGHvdWg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Gz7csp5MQpwut6krGHvdWg</a> 提取码: cekc</p>
<p>高清电子版-010-MySQL数据库开发的三十六条规定-石展.pdf 链接: <a href="https://pan.baidu.com/s/1973ttuNgu34BdcmSjSfKyA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1973ttuNgu34BdcmSjSfKyA</a> 提取码: g43a</p>
<p>高清电子版-011-MySQL性能调优与架构设计.pdf 链接: <a href="https://pan.baidu.com/s/1wCo9QY4NATq542D5MoeQYQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1wCo9QY4NATq542D5MoeQYQ</a> 提取码: gv68</p>
<p>高清电子版-012-MySQL管理之道，性能调优，高可用与监控（第二版）.pdf 链接: <a href="https://pan.baidu.com/s/12bK2g054c83i0RD8GAtrlw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/12bK2g054c83i0RD8GAtrlw</a> 提取码: khb8</p>
<p>高清电子版-MySQL高性能书籍_第3版（中文）.pdf 链接: <a href="https://pan.baidu.com/s/1hT7sr4FLZZ5ePZ4jM-WSEQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1hT7sr4FLZZ5ePZ4jM-WSEQ</a>  密码: i4mu</p>
<p>高清电子版-MySQL技术内幕 InnoDB存储引擎 第2版.pdf 链接: <a href="https://pan.baidu.com/s/18JZkbcDz35r9Uh-Iwmy6Uw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/18JZkbcDz35r9Uh-Iwmy6Uw</a>  密码: fwqs</p>
<p>高清电子版-MySQL性能调优与架构设计--全册.pdf 链接: <a href="https://pan.baidu.com/s/1XQCT3U5CJ74hCgDegsRxHA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1XQCT3U5CJ74hCgDegsRxHA</a>  密码: aa5d</p>
<p>高清电子版-Mysql性能优化教程.pdf 链接: <a href="https://pan.baidu.com/s/1V44I1UGbyrRIt2n9Crfn5g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1V44I1UGbyrRIt2n9Crfn5g</a>  密码: 3r0a</p>
<p>高清电子版-Sql Cookbook中文版.pdf 链接: <a href="https://pan.baidu.com/s/1S0Ghzv6JlVYyrGFfFul0kg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1S0Ghzv6JlVYyrGFfFul0kg</a>  密码: fohu</p>
<p>高清电子版-SQL 经典实例.pdf 链接: <a href="https://pan.baidu.com/s/1Xr23v1nza6N8ez_x5hhK-g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Xr23v1nza6N8ez_x5hhK-g</a>  密码: 4i0f</p>
<p>高清电子版-SQLite 权威指南.pdf 链接: <a href="https://pan.baidu.com/s/1jkAKtE6CqCYU7kjhs6Bg8A" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1jkAKtE6CqCYU7kjhs6Bg8A</a> 提取码: eueu</p>
<p>高清电子版-SQL语句大全大全(经典珍藏版).pdf 链接: <a href="https://pan.baidu.com/s/1ZtDVs_ZqxVHMaEHo_WHjBw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ZtDVs_ZqxVHMaEHo_WHjBw</a> 提取码: as28</p>
<p>高清电子版-SQL语言艺术.pdf 链接: <a href="https://pan.baidu.com/s/17mwgiKlM1rA5A7i1Zw0OuQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/17mwgiKlM1rA5A7i1Zw0OuQ</a>  密码: 7d2r</p>
<p>高清电子版-SQL注入攻击与防御 第2版.pdf 链接: <a href="https://pan.baidu.com/s/1fjBYX3HjHgD2m3no3b4n3Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1fjBYX3HjHgD2m3no3b4n3Q</a> 提取码: 901a</p>
<p>高清电子版-SQL注入攻击与防御 原书第2版.pdf 链接: <a href="https://pan.baidu.com/s/19EPr6CTXPVCRsKkwdu8kaw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/19EPr6CTXPVCRsKkwdu8kaw</a>  密码: 65ot</p>
<p>高清电子版-[MySQL技术内幕：SQL编程].姜承尧.扫描版[电子书.pdf 链接: <a href="https://pan.baidu.com/s/195RXvOHhTjMiYHpj5_S3Cw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/195RXvOHhTjMiYHpj5_S3Cw</a> 提取码: 99gr</p>
<p>高清电子版-《SQL查询的艺术》 链接: <a href="https://pan.baidu.com/s/1degAbiX4aYz5Ylk2NdFpfQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1degAbiX4aYz5Ylk2NdFpfQ</a>  密码: c8lc</p>
<p>高清电子版-高可用MySQL_构建健壮的数据中心.pdf 链接: <a href="https://pan.baidu.com/s/1MF9exdZi412761iGGOVr0Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1MF9exdZi412761iGGOVr0Q</a>  密码: s7es</p>
<p>高清电子版-高性能MySQL 第3版 中文 .pdf 链接: <a href="https://pan.baidu.com/s/1rAsQPpgrn-pqb8gnmvf4Qw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1rAsQPpgrn-pqb8gnmvf4Qw</a>  密码: bu7k</p>
<p>高清电子版-高性能MySQL(第2版)中文版.pdf 链接: <a href="https://pan.baidu.com/s/1GRJpsFNnbWJ9nARK0cm5tg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1GRJpsFNnbWJ9nARK0cm5tg</a> 提取码: igg1</p>
<p>高清电子版-高性能MySQL.pdf 链接: <a href="https://pan.baidu.com/s/1csypJjbkqCq8GwjPw8HxVQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1csypJjbkqCq8GwjPw8HxVQ</a>  密码: pg0u</p>
<p>高清电子版-深入浅出MySQL++数据库开发、优化与管理维护+第2版+唐汉明.pdf 链接: <a href="https://pan.baidu.com/s/1hr1fh2G_dXnssf7nm8K_ig" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1hr1fh2G_dXnssf7nm8K_ig</a> 提取码: 3qgc</p>
<p>高清电子版-深入浅出MySQL数据库开发优化与管理维护.pdf 链接: <a href="https://pan.baidu.com/s/1H9AoyIY5gyHidS61c7GAWw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1H9AoyIY5gyHidS61c7GAWw</a> 提取码: 6cou</p>
<p>高清电子版-数据库查询优化器的艺术：原理解析与SQL性能优化.pdf 链接: <a href="https://pan.baidu.com/s/104LCsJ0oDbK6BJm2CqgUWw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/104LCsJ0oDbK6BJm2CqgUWw</a> 提取码: sibr</p>
<h3 id="mongodb" tabindex="-1"> MongoDB</h3>
<p>高清电子版-MongoDB权威指南 第2版 PDF电子书下载 带书签目录 试读版.pdf 链接: <a href="https://pan.baidu.com/s/1qvNLowra5nD3qSG-p5aUWA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1qvNLowra5nD3qSG-p5aUWA</a>  密码: 6pm9</p>
<p>高清电子版-MongoDB权威指南第2版.pdf 链接: <a href="https://pan.baidu.com/s/1Ubq46X3VEhOzUMbPY3QXag" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Ubq46X3VEhOzUMbPY3QXag</a> 提取码: 3aib</p>
<p>高清电子版-MongoDB实战.pdf 链接: <a href="https://pan.baidu.com/s/1na9S-mHgKRJTBhQNMgQ3wQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1na9S-mHgKRJTBhQNMgQ3wQ</a> 提取码: 8nkw</p>
<p>高清电子版-深入学习MongoDb.pdf 链接: <a href="https://pan.baidu.com/s/1d4zzBU6xyqT02IoMQz4_kQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1d4zzBU6xyqT02IoMQz4_kQ</a>  密码: j47m</p>
<h3 id="redis" tabindex="-1"> Redis</h3>
<p>高清电子版-Redis 命令参考.pdf 链接: <a href="https://pan.baidu.com/s/1pyIMCnOg7sKDjpmGpi_mjQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1pyIMCnOg7sKDjpmGpi_mjQ</a> 提取码: dwt0</p>
<p>高清电子版-Redis入门手册（中文）.pdf 链接: <a href="https://pan.baidu.com/s/1O3TiztaAGgVFZMmyAjTPtA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1O3TiztaAGgVFZMmyAjTPtA</a>  密码: 1wqt</p>
<p>高清电子版-Redis入门指南 第2版.pdf 链接: <a href="https://pan.baidu.com/s/1aR_cR7VEJEvSfyX-fxOp_Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1aR_cR7VEJEvSfyX-fxOp_Q</a>  密码: ufgl</p>
<p>高清电子版-Redis入门指南.pdf 链接: <a href="https://pan.baidu.com/s/1nncIk6eaEFNwK4CtBLwFkw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1nncIk6eaEFNwK4CtBLwFkw</a>  密码: k0ej</p>
<p>高清电子版-Redis设计与实现(第二版).pdf 链接: <a href="https://pan.baidu.com/s/1aMC419V6ThIlyUMc4N0ODA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1aMC419V6ThIlyUMc4N0ODA</a>  密码: jp5n</p>
<p>高清电子版-Redis设计与实现.pdf 链接: <a href="https://pan.baidu.com/s/1Ffjd0srx7-Dq988Wy4OqdQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Ffjd0srx7-Dq988Wy4OqdQ</a>  密码: 1kfm</p>
<p>高清电子版-Redis实战.pdf 链接: <a href="https://pan.baidu.com/s/1Ckbq7YnXym-ojZDkC5OsYQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Ckbq7YnXym-ojZDkC5OsYQ</a> 提取码: d53m</p>
<p>高清电子版-Redis小白入门指南.pdf 链接: <a href="https://pan.baidu.com/s/1HhlEzlpQbSCZrSatXH9o3w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1HhlEzlpQbSCZrSatXH9o3w</a>  密码: aijp</p>
<p>高清电子版-Redis学习笔记.pdf 链接: <a href="https://pan.baidu.com/s/1ePCIAMCCjwcTc7EQIhhwfQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ePCIAMCCjwcTc7EQIhhwfQ</a>  密码: qalo</p>
<p>高清电子版-开源电子书：redis 开发手册文档.pdf 链接: <a href="https://pan.baidu.com/s/1TL-PWxm9bamlGiNc6Z1N1w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1TL-PWxm9bamlGiNc6Z1N1w</a>  密码: 7jm4</p>
<h3 id="memcache" tabindex="-1"> Memcache</h3>
<p>高清电子版-memcache+全面剖析.pdf 链接: <a href="https://pan.baidu.com/s/1JXpV2SqlMGET_YJxQnTXZg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1JXpV2SqlMGET_YJxQnTXZg</a>  密码: f3rq</p>
<p>高清电子版-memcache.pdf 链接: <a href="https://pan.baidu.com/s/14lrD4ys0Vm_jRwI5hpQ-hA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/14lrD4ys0Vm_jRwI5hpQ-hA</a>  密码: urhl</p>
<h3 id="postgresql" tabindex="-1"> PostgreSQL</h3>
<p>高清电子版-PostgreSQL从入门到精通.pdf 链接: <a href="https://pan.baidu.com/s/1u1WfH_7R88ofmiWafRU0QA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1u1WfH_7R88ofmiWafRU0QA</a> 提取码: 9tnt</p>
<p>高清电子版-PostgreSQL详解.pdf 链接: <a href="https://pan.baidu.com/s/1XWo7uxh7K38_agWGNoI9RA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1XWo7uxh7K38_agWGNoI9RA</a>  密码: opnr</p>
<h3 id="消息队列" tabindex="-1"> 消息队列</h3>
<p>高清电子版-Kafka权威指南.pdf 链接: <a href="https://pan.baidu.com/s/1_Ht2nzuTIDz_33IJKfipXQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1_Ht2nzuTIDz_33IJKfipXQ</a>  密码: ma7b</p>
<p>高清电子版-ZeroMQ 云时代极速消息通信库.pdf 链接: <a href="https://pan.baidu.com/s/16nvlcxEryzsevgGkDbw5ZQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/16nvlcxEryzsevgGkDbw5ZQ</a>  密码: o901</p>
<p>高清电子版-图文详解Kafka源码设计与实现 高清完整版.pdf 链接: <a href="https://pan.baidu.com/s/1Mo8h6GY3LYSE8U0f6qXTmA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Mo8h6GY3LYSE8U0f6qXTmA</a>  密码: 6vc7</p>
<h3 id="nginx" tabindex="-1"> Nginx</h3>
<p>高清电子版-Nginx高性能Web服务器详解.pdf 链接: <a href="https://pan.baidu.com/s/1JcgF82fB21poR6909H-Q3A" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1JcgF82fB21poR6909H-Q3A</a>  密码: 1k3h</p>
<p>高清电子版-Nginx开发从入门到精通.pdf 链接: <a href="https://pan.baidu.com/s/1OEUdq0P2vdZThTJtk9BAWQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1OEUdq0P2vdZThTJtk9BAWQ</a> 提取码: gdst</p>
<p>高清电子版-精通Nginx第2版.pdf 链接: <a href="https://pan.baidu.com/s/1EtAEvQJ21A8BjqBfbuPeQQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1EtAEvQJ21A8BjqBfbuPeQQ</a>  密码: svj0</p>
<p>高清电子版-决战Nginx 技术卷：高性能Web服务器部署与运维.pdf 链接: <a href="https://pan.baidu.com/s/19Q1nql_yXNZybClyNG6MkQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/19Q1nql_yXNZybClyNG6MkQ</a>  密码: q7im</p>
<p>高清电子版-深入理解Nginx模块开发与架构解析.pdf 链接: <a href="https://pan.baidu.com/s/1IswPVRHDHPgbbDtCEDgO5Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1IswPVRHDHPgbbDtCEDgO5Q</a>  密码: 36g1</p>
<p>高清电子版-深入剖析Nginx.pdf 链接: <a href="https://pan.baidu.com/s/129fBcuIihlNSplM4CNw2fg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/129fBcuIihlNSplM4CNw2fg</a>  密码: wvgs</p>
<p>高清电子版-实战nginx.pdf 链接: <a href="https://pan.baidu.com/s/1ll07UeL0HHRioX3UEKm-5Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ll07UeL0HHRioX3UEKm-5Q</a>  密码: ftig</p>
<p>高清电子版-实战Nginx：取代Apache的高性能Web服务器 张宴.扫描版.pdf 链接: <a href="https://pan.baidu.com/s/16NrsiiJoy4utnaeSxGCqDw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/16NrsiiJoy4utnaeSxGCqDw</a>  密码: h85i</p>
<p>高清电子版-学习Nginx HTTP Server中文版.pdf 链接: <a href="https://pan.baidu.com/s/14lLrlsngAezdW-GCjRn7MA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/14lLrlsngAezdW-GCjRn7MA</a> 提取码: wbg6</p>
<h3 id="设计模式" tabindex="-1"> 设计模式</h3>
<p>高清电子版-23种java设计模式.pdf 链接: <a href="https://pan.baidu.com/s/1W41FuvQEog0t8CnLZ-fQ9g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1W41FuvQEog0t8CnLZ-fQ9g</a>  密码: 6emv</p>
<p>高清电子版-23种设计模式知识要点.pdf 链接: <a href="https://pan.baidu.com/s/1wO0BEczH_klnHdzmF3_U6g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1wO0BEczH_klnHdzmF3_U6g</a>  密码: phvo</p>
<p>高清电子版-24个java代码(Java经典模式设计).pdf 链接: <a href="https://pan.baidu.com/s/1LCdlcnJE9lJCMZ3iwq_l4Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1LCdlcnJE9lJCMZ3iwq_l4Q</a> 提取码: 21jq</p>
<p>高清电子版-Head First设计模式高清版.pdf 链接: <a href="https://pan.baidu.com/s/1ge6w9H3imGxzBgXbVBnElg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ge6w9H3imGxzBgXbVBnElg</a> 提取码: 2v6j</p>
<p>高清电子版-[Java] Head First 设计模式（中文版）.pdf 链接: <a href="https://pan.baidu.com/s/1VkqfgdHi3rOl1bVzquIqKQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1VkqfgdHi3rOl1bVzquIqKQ</a>  密码: 4ov0</p>
<p>高清电子版-[设计模式之禅].秦小波.pdf 链接: <a href="https://pan.baidu.com/s/11IwgpMicdfUJ-lYnPrxydg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/11IwgpMicdfUJ-lYnPrxydg</a>  密码: kmdi</p>
<p>高清电子版-大话设计模式.pdf 链接: <a href="https://pan.baidu.com/s/1LCGvXg74hxYBtNCRoNHuZA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1LCGvXg74hxYBtNCRoNHuZA</a> 提取码: heii</p>
<p>高清电子版-设计模式 - 可复用面向对象软件的基础（高清版）.pdf 链接: <a href="https://pan.baidu.com/s/197_O1htk0oDGnAESuUzUcg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/197_O1htk0oDGnAESuUzUcg</a>  密码: c8kj</p>
<p>高清电子版-设计模式之禅（第2版）.pdf 链接: <a href="https://pan.baidu.com/s/1DeHgacT8O1Awr8J9Bycp4Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1DeHgacT8O1Awr8J9Bycp4Q</a> 提取码: rqkw</p>
<p>高清电子版-设计有效的数据库系统_12511476.pdf 链接: <a href="https://pan.baidu.com/s/1TE_etHMFVbwQ9zkoZNsEnQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1TE_etHMFVbwQ9zkoZNsEnQ</a>  密码: joms</p>
<h3 id="linux" tabindex="-1"> Linux</h3>
<p>高清电子版-03linux内核IO性能优化及块BIO处理.pdf 链接: <a href="https://pan.baidu.com/s/1oKGb739msDho7lmtf2xr9Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1oKGb739msDho7lmtf2xr9Q</a>  密码: ufj8</p>
<p>高清电子版-LINUX SHELL脚本攻略(中文版带书签).pdf 链接: <a href="https://pan.baidu.com/s/1k-RTBoQ_7KrKuaAtRtnVyg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1k-RTBoQ_7KrKuaAtRtnVyg</a>  密码: j00r</p>
<p>高清电子版-Linux宝典.pdf 链接: <a href="https://pan.baidu.com/s/1nQzrHtQZ6bfoK0picgnoJQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1nQzrHtQZ6bfoK0picgnoJQ</a>  密码: ws6w</p>
<p>高清电子版-Linux操作系统下C语言编程入门.pdf 链接: <a href="https://pan.baidu.com/s/1i-xZFAioSBm9oHB2vuAULg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1i-xZFAioSBm9oHB2vuAULg</a>  密码: 2v1f</p>
<p>高清电子版-Linux程序员指南.pdf 链接: <a href="https://pan.baidu.com/s/1qVyPP82d9laWRCOsZLon3w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1qVyPP82d9laWRCOsZLon3w</a> 提取码: 1o7d</p>
<p>高清电子版-Linux初学者入门优秀教程.pdf 链接: <a href="https://pan.baidu.com/s/1hIlUbf2q1H_C4dJ2dIU_Vg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1hIlUbf2q1H_C4dJ2dIU_Vg</a>  密码: d1hc</p>
<p>高清电子版-LINUX防火墙（原书第3版）.pdf 链接: <a href="https://pan.baidu.com/s/1ODhqcuoZwJD0P-PcdM01_g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ODhqcuoZwJD0P-PcdM01_g</a>  密码: jcbp</p>
<p>高清电子版-Linux系统常用命令快速入门.pdf 链接: <a href="https://pan.baidu.com/s/1ySBnawbftX0Nx7liBWnwqA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ySBnawbftX0Nx7liBWnwqA</a>  密码: d2kb</p>
<p>高清电子版-[Linux命令详解词典].施威铭研究室.扫描版.pdf 链接: <a href="https://pan.baidu.com/s/1bUaqt3LN6gr8hFArvlc4qA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1bUaqt3LN6gr8hFArvlc4qA</a>  密码: stnu</p>
<p>高清电子版-[鸟哥的Linux私房菜：服务器架设篇(第二版)].鸟哥.扫描版.pdf 链接: <a href="https://pan.baidu.com/s/1kGm6ljDnz3sYBzdf0cvvgg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1kGm6ljDnz3sYBzdf0cvvgg</a>  密码: 193a</p>
<p>高清电子版-《鸟哥的Linux私房菜-基础篇》第四版.pdf 链接: <a href="https://pan.baidu.com/s/1Ck9HPcuUK4u-Kz2KJ_QYrw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Ck9HPcuUK4u-Kz2KJ_QYrw</a>  密码: wiqi</p>
<p>高清电子版-《鸟哥的Linux私房菜》.pdf 链接: <a href="https://pan.baidu.com/s/1Ue9_zoe-BKjMx4n4xC0TOw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Ue9_zoe-BKjMx4n4xC0TOw</a>  密码: uab1</p>
<p>高清电子版-鸟哥的Linux私房菜-基础学习篇%28第四版%29高清完整书签PDF版（<a href="http://Linuxidc.com" target="_blank" rel="noopener noreferrer">Linuxidc.com</a>）.pdf 链接: <a href="https://pan.baidu.com/s/15LYDfHzi49Snd6wB1J4PQQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/15LYDfHzi49Snd6wB1J4PQQ</a>  密码: q666</p>
<p>高清电子版-鸟哥的Linux私房菜-基础学习篇(第四版)高清完整书签PDF版.pdf 链接: <a href="https://pan.baidu.com/s/19ikmmhXz4aFRAvKk46rS0A" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/19ikmmhXz4aFRAvKk46rS0A</a>  密码: n585</p>
<p>高清电子版-鸟哥的LINUX私房菜_基础学习篇(第三版).pdf 链接: <a href="https://pan.baidu.com/s/1tSDlmgxIaGhqOuyfh3qq4Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1tSDlmgxIaGhqOuyfh3qq4Q</a>  密码: ce6n</p>
<p>高清电子版-鸟哥的LINUX私房菜：服务器架设篇 （第二版）.pdf 链接: <a href="https://pan.baidu.com/s/1m3bRZne78AqMgztTUr6EIQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1m3bRZne78AqMgztTUr6EIQ</a> 提取码: hmqn</p>
<p>高清电子版-鸟哥的Linux私房菜服务器架设篇 第三版 .pdf 链接: <a href="https://pan.baidu.com/s/1m3bRZne78AqMgztTUr6EIQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1m3bRZne78AqMgztTUr6EIQ</a> 提取码: hmqn</p>
<p>高清电子版-鸟哥私房菜（全）.pdf 链接: <a href="https://pan.baidu.com/s/1_jg7ZEx-jhrjUsgrCmhm-g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1_jg7ZEx-jhrjUsgrCmhm-g</a>  密码: lc4c</p>
<p>高清电子版-循序渐进Linux第2版 .pdf 链接: <a href="https://pan.baidu.com/s/1s-3y2XvygLDbd6rgjdF1Tg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1s-3y2XvygLDbd6rgjdF1Tg</a> 提取码: f4sq</p>
<h3 id="数据结构算法" tabindex="-1"> 数据结构算法</h3>
<p>高清电子版-545346 算法图解.pdf 链接: <a href="https://pan.baidu.com/s/10Da5uBl8yr_5zNQAPF5LgQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/10Da5uBl8yr_5zNQAPF5LgQ</a> 提取码: 0d9v</p>
<p>高清电子版-HW12 《数据结构与算法》小论文.pdf 链接: <a href="https://pan.baidu.com/s/1UZARTMZMrqL19tyHT3X9vw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1UZARTMZMrqL19tyHT3X9vw</a>  密码: 2q5v</p>
<p>高清电子版-HW13 高级数据结构.pdf 链接: <a href="https://pan.baidu.com/s/1IOqcr5KbHRbGHp2cfpKkDw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1IOqcr5KbHRbGHp2cfpKkDw</a>  密码: jga5</p>
<p>高清电子版-Java常用算法手册.pdf 链接: <a href="https://pan.baidu.com/s/1xGLUPgQMEZR988m7seSpgw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1xGLUPgQMEZR988m7seSpgw</a> 提取码: eico</p>
<p>高清电子版-Java数据结构和算法.（第二版）.pdf 链接: <a href="https://pan.baidu.com/s/143iZwtjZJKnTiqJuuB4VjQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/143iZwtjZJKnTiqJuuB4VjQ</a>  密码: 2lgi</p>
<p>高清电子版-[Java 数据结构和算法(第二版)].[Robert Lafore].[计晓云 译].扫描版.pdf 链接: <a href="https://pan.baidu.com/s/1kXtnKeAyEj7ziq70t5ShDw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1kXtnKeAyEj7ziq70t5ShDw</a>  密码: q091</p>
<p>高清电子版-《Java常用算法手册 第三版本》.pdf 链接: <a href="https://pan.baidu.com/s/1DJxPOW-tDPAKVOTlnFpBKw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1DJxPOW-tDPAKVOTlnFpBKw</a>  密码: t5ln</p>
<p>高清电子版-《啊哈！算法》.pdf 链接: <a href="https://pan.baidu.com/s/1wAKr0vC8hPzFyVKS8Gvarg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1wAKr0vC8hPzFyVKS8Gvarg</a>  密码: e00p</p>
<p>高清电子版-《数据结构》教程c语言版.pdf 链接: <a href="https://pan.baidu.com/s/13jDXD2qD-OeIFE_YiHGYdQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/13jDXD2qD-OeIFE_YiHGYdQ</a> 提取码: f0jm</p>
<p>高清电子版-《数据结构与算法 Java版》.pdf 链接: <a href="https://pan.baidu.com/s/1o7crizjD9cedC9fULIC0PQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1o7crizjD9cedC9fULIC0PQ</a> 提取码: 9we0</p>
<p>高清电子版-《图解数据结构-使用Java》.pdf 链接: <a href="https://pan.baidu.com/s/1fsWWrvIPH3l-cKHxd_gGDQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1fsWWrvIPH3l-cKHxd_gGDQ</a>  密码: eflg</p>
<p>高清电子版-编程珠玑2.pdf 链接: <a href="https://pan.baidu.com/s/102EGp32dqlxxITaee2Oanw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/102EGp32dqlxxITaee2Oanw</a>  密码: oufi</p>
<p>高清电子版-程序员的数学3+线性代数.pdf 链接: <a href="https://pan.baidu.com/s/1KHeQveYFQGXlObJX9bZZGA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1KHeQveYFQGXlObJX9bZZGA</a>  密码: r14e</p>
<p>高清电子版-大话数据结构.pdf 链接: <a href="https://pan.baidu.com/s/1aqtB81YbJZRiwDT7EyI5fw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1aqtB81YbJZRiwDT7EyI5fw</a>  密码: e25p</p>
<p>高清电子版-计算机算法分析与设计课件.pdf 链接: <a href="https://pan.baidu.com/s/1PxSEiC6Qg7rQHsgjIb-CZw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1PxSEiC6Qg7rQHsgjIb-CZw</a>  密码: 2rsb</p>
<p>高清电子版-经典算法大全.pdf 链接: <a href="https://pan.baidu.com/s/1vUkLx-6CNpEtBXy0_w2WhQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1vUkLx-6CNpEtBXy0_w2WhQ</a>  密码: 1erg</p>
<p>高清电子版-离散数学导学_11332333.pdf 链接: <a href="https://pan.baidu.com/s/1E8iYSfptshMxfgVZcH1vtA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1E8iYSfptshMxfgVZcH1vtA</a> 提取码: in70</p>
<p>高清电子版-数据结构(C_语言版).pdf 链接: <a href="https://pan.baidu.com/s/1Rmp6_H2ffFQToSUaaFBaxg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Rmp6_H2ffFQToSUaaFBaxg</a>  密码: pfmo</p>
<p>高清电子版-数据结构（Java版）.pdf 链接: <a href="https://pan.baidu.com/s/1qG1C-0ZG8I0bKhiFWsFNJg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1qG1C-0ZG8I0bKhiFWsFNJg</a>  密码: he1e</p>
<p>高清电子版-数据结构、算法与应用 C++语言描述 原书和引2版.pdf 链接: <a href="https://pan.baidu.com/s/1yKPvuHwNUo6V3cJJIdadUQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1yKPvuHwNUo6V3cJJIdadUQ</a> 提取码: p94n</p>
<p>高清电子版-数据结构讲义(严蔚敏版).pdf 链接: <a href="https://pan.baidu.com/s/1c6FiJhR6yM0yqzl_v586Aw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1c6FiJhR6yM0yqzl_v586Aw</a> 提取码: t75f</p>
<p>高清电子版-数据结构实例分析.pdf 链接: <a href="https://pan.baidu.com/s/16aFy5avg_y78kCf2bLeRQQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/16aFy5avg_y78kCf2bLeRQQ</a>  密码: js8g</p>
<p>高清电子版-数据结构与STL_11261832.pdf 链接: <a href="https://pan.baidu.com/s/1lkSxhi5_Y4iAdzv5-sqNNA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1lkSxhi5_Y4iAdzv5-sqNNA</a> 提取码: 45dd</p>
<p>高清电子版-数据结构与算法(JAVA语言版解密).pdf 链接: <a href="https://pan.baidu.com/s/1AsQShR62i0zi0dATPzBpYw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1AsQShR62i0zi0dATPzBpYw</a> 提取码: 8aoq</p>
<p>高清电子版-数据结构与算法-JAVA语言.pdf 链接: <a href="https://pan.baidu.com/s/171LN7K9XnsYf4ZXnTnzYFw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/171LN7K9XnsYf4ZXnTnzYFw</a>  密码: 7mrj</p>
<p>高清电子版-算法 第4版-谢路云 译Java描述-完整版.pdf 链接: <a href="https://pan.baidu.com/s/1j9zxdj4dpY6hlWQytIHgXA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1j9zxdj4dpY6hlWQytIHgXA</a>  密码: vkho</p>
<p>高清电子版-算法 第4版-谢路云译完整版.pdf 链接: <a href="https://pan.baidu.com/s/1eQpXS_FNJSOhVb4lxADufA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1eQpXS_FNJSOhVb4lxADufA</a>  密码: gd2c</p>
<p>高清电子版-算法：C语言实现 第1-4部分 基础知识、数据结构、排序及搜索_12384657.pdf 链接: <a href="https://pan.baidu.com/s/1W_aUciwJ4QPwF6xBVrcN6g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1W_aUciwJ4QPwF6xBVrcN6g</a>  密码: 5ccj</p>
<p>高清电子版-算法导论 第三版 中文.pdf 链接: <a href="https://pan.baidu.com/s/1CWFD63-0T89BApjjXvtraA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1CWFD63-0T89BApjjXvtraA</a>  密码: a4rv</p>
<p>高清电子版-算法导论(原书第3版) 中文完整版 高清扫描版.pdf 链接: <a href="https://pan.baidu.com/s/1RuhCJspUsRSOQh9UPNm0Qg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1RuhCJspUsRSOQh9UPNm0Qg</a>  密码: gaql</p>
<p>高清电子版-算法导论（原书第3版）_13234228.pdf 链接: <a href="https://pan.baidu.com/s/1bYe0mPY5FGnSDL_Thw6ccw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1bYe0mPY5FGnSDL_Thw6ccw</a> 提取码: 34mt</p>
<p>高清电子版-算法分析导论_11562998.pdf 链接: <a href="https://pan.baidu.com/s/1lBGZtc_NI2GGLbTVuQ6RhA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1lBGZtc_NI2GGLbTVuQ6RhA</a>  密码: ol69</p>
<p>高清电子版-算法概论.pdf 链接: <a href="https://pan.baidu.com/s/1QRVYUEYxMvEOo3Hlewl8XA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1QRVYUEYxMvEOo3Hlewl8XA</a>  密码: 1i6f</p>
<p>高清电子版-算法基础.打开算法之门.pdf 链接: <a href="https://pan.baidu.com/s/1LaGzCdkCxa2DG8u-el8YRA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1LaGzCdkCxa2DG8u-el8YRA</a>  密码: vn30</p>
<p>高清电子版-算法设计与分析导论_11888784.pdf 链接: <a href="https://pan.baidu.com/s/1d5xtSUDTlpK32hH7wyQNzg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1d5xtSUDTlpK32hH7wyQNzg</a>  密码: 4vcb</p>
<p>高清电子版-算法设计与分析基础.pdf 链接: <a href="https://pan.baidu.com/s/1HXHA3mx07PFlOm6qLSUHTQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1HXHA3mx07PFlOm6qLSUHTQ</a>  密码: 3ji4</p>
<p>高清电子版-算法与数据结构-实用算法基础教程.pdf 链接: <a href="https://pan.baidu.com/s/19Z3pI4LrvzD7PqYc81BVmg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/19Z3pI4LrvzD7PqYc81BVmg</a>  密码: qc7i</p>
<p>高清电子版-自动机理论、语言和计算导论_12026438.pdf 链接: <a href="https://pan.baidu.com/s/1xZEJG2HefASxYB5orH03pw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1xZEJG2HefASxYB5orH03pw</a>  密码: ku3w</p>
<h3 id="架构篇" tabindex="-1"> 架构篇</h3>
<p>高清电子版-O2O实战+他们是如何利用互联网的.pdf 链接: <a href="https://pan.baidu.com/s/1hjnYETG4ZA06GQ2CRFDcyg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1hjnYETG4ZA06GQ2CRFDcyg</a>  密码: jstv</p>
<p>高清电子版-程序员必读之软件架构.pdf 链接: <a href="https://pan.baidu.com/s/1ZKBeC-qpCiz5HXhKUyvWWg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ZKBeC-qpCiz5HXhKUyvWWg</a> 提取码: g69f</p>
<p>高清电子版-大规模分布式存储系统：原理解析与架构实战.杨传辉.pdf 链接: <a href="https://pan.baidu.com/s/161qxqwtLgGlJ0YHiILhHrQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/161qxqwtLgGlJ0YHiILhHrQ</a>  密码: oagg</p>
<p>高清电子版-大规模分布式系统架构与设计实战.完整版.pdf 链接: <a href="https://pan.baidu.com/s/1Z7vTdiZ2d-iK21EUuMb4YA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Z7vTdiZ2d-iK21EUuMb4YA</a> 提取码: 87g7</p>
<p>高清电子版-大型分布式网站架构设计与实践.带目录书签.完整版.pdf 链接: <a href="https://pan.baidu.com/s/1fhPlU7GmA0vnLeCGB_gAjw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1fhPlU7GmA0vnLeCGB_gAjw</a>  密码: 264s</p>
<p>高清电子版-大型网站技术架构：核心原理与案例分析.pdf 链接: <a href="https://pan.baidu.com/s/1N7ncedxoY36BQEj3_i7G6w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1N7ncedxoY36BQEj3_i7G6w</a>  密码: ow49</p>
<p>高清电子版-高并发环境下的数据产品架构设计.pdf 链接: <a href="https://pan.baidu.com/s/1pg2KKejFIUyB57UfCPsYAQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1pg2KKejFIUyB57UfCPsYAQ</a>  密码: 0u28</p>
<p>高清电子版-架构即未来 现代企业可扩展的Web架构流程和组织原书第2版.pdf 链接: <a href="https://pan.baidu.com/s/16Z0kbH0b1aa7wyUWOmuLgQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/16Z0kbH0b1aa7wyUWOmuLgQ</a>  密码: mat1</p>
<p>高清电子版-架构探险 从零开始写javaweb框架.pdf 链接: <a href="https://pan.baidu.com/s/1UM1usjVecZERRdhmwpCemQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1UM1usjVecZERRdhmwpCemQ</a> 提取码: 7046</p>
<p>高清电子版-架构演进：滴滴打车架构演变及应用实践.pdf 链接: <a href="https://pan.baidu.com/s/1F-KRTwulXg_8EUiq_kG7zQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1F-KRTwulXg_8EUiq_kG7zQ</a>  密码: 7pkr</p>
<p>高清电子版-架构演进：豆瓣架构演进.pdf 链接: <a href="https://pan.baidu.com/s/1Y48N5tSmT5DWOzAxEUzdgA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Y48N5tSmT5DWOzAxEUzdgA</a> 提取码: 84tj</p>
<p>高清电子版-架构演进：京东服务框架实践.pdf 链接: <a href="https://pan.baidu.com/s/1DJk5lZG5Dm0m0rchvBqoMA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1DJk5lZG5Dm0m0rchvBqoMA</a> 提取码: r3sp</p>
<p>高清电子版-架构演进：京东应用架构设计.pdf 链接: <a href="https://pan.baidu.com/s/1Kz02mUQa79DGuoJ008outQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Kz02mUQa79DGuoJ008outQ</a>  密码: o9ho</p>
<p>高清电子版-架构演进：汽车之家架构分析.pdf 链接: <a href="https://pan.baidu.com/s/1GvQu-CAXAP_PV_fHmwfauw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1GvQu-CAXAP_PV_fHmwfauw</a>  密码: oo7l</p>
<p>高清电子版-架构演进：人寿系统架构演变.pdf 链接: <a href="https://pan.baidu.com/s/1ylqHZhaTV39axDqbHt2v5A" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ylqHZhaTV39axDqbHt2v5A</a>  密码: qcwf</p>
<p>高清电子版-架构演进：微信之道－至简.pdf 链接: <a href="https://pan.baidu.com/s/1xQoisbm_AxlE9OQqGryHdQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1xQoisbm_AxlE9OQqGryHdQ</a> 提取码: gc8o</p>
<p>高清电子版-架构演进：小米的经验分享.pdf 链接: <a href="https://pan.baidu.com/s/1au08n9vz03LC2jGZ339pNg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1au08n9vz03LC2jGZ339pNg</a>  密码: 6lm4</p>
<p>高清电子版-架构演进：一亿用户增长背后的架构秘密(全文 PPT).pdf 链接: <a href="https://pan.baidu.com/s/1kgX7vDURUYUQO5Wg-_kLNg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1kgX7vDURUYUQO5Wg-_kLNg</a>  密码: o455</p>
<p>高清电子版-架构演进：知乎架构变迁史.pdf 链接: <a href="https://pan.baidu.com/s/1vKWp_rfeV24KUby_71S-hg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1vKWp_rfeV24KUby_71S-hg</a>  密码: aarr</p>
<p>高清电子版-人人都是架构师+分布式系统架构落地与瓶颈突破.pdf 链接: <a href="https://pan.baidu.com/s/1xpb3hm-G90m8OZvbkYEd1Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1xpb3hm-G90m8OZvbkYEd1Q</a>  密码: 39nn</p>
<p>高清电子版-软件构架实践_第二版_林_巴斯等著.pdf 链接: <a href="https://pan.baidu.com/s/1BUQ4JKwDcnUAbCNrx-ufPg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1BUQ4JKwDcnUAbCNrx-ufPg</a>  密码: hf68</p>
<p>高清电子版-推荐系统整体架构和mycat.pdf 链接: <a href="https://pan.baidu.com/s/1iZ8ry_t-X6ma-jo6ksn4FQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1iZ8ry_t-X6ma-jo6ksn4FQ</a> 提取码: dr1o</p>
<p>高清电子版-系统分析与设计 敏捷迭代方法 原书第6版.pdf 链接: <a href="https://pan.baidu.com/s/1dbaLgR66cArc62mSt7Il6w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1dbaLgR66cArc62mSt7Il6w</a> 提取码: c64o</p>
<p>高清电子版-系统分析与设计 原书第7版_12542983.pdf 链接: <a href="https://pan.baidu.com/s/15Prw6LWbzPj61mvfjXaDFA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/15Prw6LWbzPj61mvfjXaDFA</a> 提取码: mfw6</p>
<p>高清电子版-系统分析与设计导论_12908190.pdf 链接: <a href="https://pan.baidu.com/s/1l4AzCCCZrOgGeTbY9Ia63Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1l4AzCCCZrOgGeTbY9Ia63Q</a>  密码: aktr</p>
<p>高清电子版-系统分析与设计教程原书第7版.pdf 链接: <a href="https://pan.baidu.com/s/1ApjrUSBEJknuUabMfFc1Ng" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ApjrUSBEJknuUabMfFc1Ng</a>  密码: 5m9f</p>
<p>高清电子版-系统架构：复杂系统的产品设计与开发.pdf 链接: <a href="https://pan.baidu.com/s/1ltyzSGQ62JdeVV0OU4vaVQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ltyzSGQ62JdeVV0OU4vaVQ</a>  密码: d9k0</p>
<p>高清电子版-云计算架构技术与实践+第2版.pdf 链接: <a href="https://pan.baidu.com/s/1MRd5UCllczQzsYlbF4Cxyg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1MRd5UCllczQzsYlbF4Cxyg</a>  密码: ab97</p>
<h3 id="elasticsearch" tabindex="-1"> Elasticsearch</h3>
<p>高清电子版-Elasticsearch技术解析与实战.pdf 链接: <a href="https://pan.baidu.com/s/18zW1WmnzTgGZRA2CFd382Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/18zW1WmnzTgGZRA2CFd382Q</a>  密码: mak4</p>
<p>高清电子版-ElasticSearch可扩展的开源弹性搜索解决方案.pdf 链接: <a href="https://pan.baidu.com/s/1TX_7fn9sx7ebdrY_x2FWqw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1TX_7fn9sx7ebdrY_x2FWqw</a>  密码: ifwn</p>
<p>高清电子版-Elasticsearch权威指南(中文版).pdf 链接: <a href="https://pan.baidu.com/s/19Ugx6LMyXk3RUvlXKUTSTQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/19Ugx6LMyXk3RUvlXKUTSTQ</a>  密码: 7o9h</p>
<p>高清电子版-深入理解ElasticSearch.pdf 链接: <a href="https://pan.baidu.com/s/1kYyX2OT98lh8aVZl59joBg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1kYyX2OT98lh8aVZl59joBg</a>  密码: qp5c</p>
<p>高清电子版-实战Elasticsearch、Logstash、Kibana++分布式大数据搜索与日志挖掘及可视化解决方案.pdf 链接: <a href="https://pan.baidu.com/s/1ruEJwcoI_uUYVpnJmK29jA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1ruEJwcoI_uUYVpnJmK29jA</a>  密码: wns5</p>
<h3 id="大数据" tabindex="-1"> 大数据</h3>
<p>高清电子版-3 分布式文件系统HDFS，大数据存储实战.pdf 链接: <a href="https://pan.baidu.com/s/1g1tPVHp2eaDs1NPc00aHMg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1g1tPVHp2eaDs1NPc00aHMg</a> 提取码: 8dfb</p>
<p>高清电子版-books 白话大数据与机器学习_章节目录.pdf 链接: <a href="https://pan.baidu.com/s/1xY03Iojwpkt-6-km6HKMAg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1xY03Iojwpkt-6-km6HKMAg</a> 提取码: mt25</p>
<p>高清电子版-Druid实时大数据分析原理与实践.pdf 链接: <a href="https://pan.baidu.com/s/1aiQitIb1cYAW2XrryrhLaw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1aiQitIb1cYAW2XrryrhLaw</a> 提取码: k0g8</p>
<p>高清电子版-Hadoop大数据分析与挖掘实战.pdf 链接: <a href="https://pan.baidu.com/s/1uoArP_40GPcD23I-BH8ReQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1uoArP_40GPcD23I-BH8ReQ</a> 提取码: mghs</p>
<p>高清电子版-Hadoop公平调度器指南.pdf 链接: <a href="https://pan.baidu.com/s/1FlnfMJtv1P_67QnyCQk7oA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1FlnfMJtv1P_67QnyCQk7oA</a> 提取码: dfh8</p>
<p>高清电子版-hadoop简介.pdf 链接: <a href="https://pan.baidu.com/s/16Ds_sHVLPxo8Nm5lMglccQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/16Ds_sHVLPxo8Nm5lMglccQ</a> 提取码: 8q2u</p>
<p>高清电子版-hadoop开发者第三期.pdf 链接: <a href="https://pan.baidu.com/s/17YzJvNwiI1Zb1Bg_e0T96A" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/17YzJvNwiI1Zb1Bg_e0T96A</a> 提取码: 2stk</p>
<p>高清电子版-Hadoop开发者第四期.pdf</p>
<p>高清电子版-Hadoop开发者入门专刊.pdf 链接: <a href="https://pan.baidu.com/s/1CZ8Ox4XABiwlbIrCfpWONw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1CZ8Ox4XABiwlbIrCfpWONw</a> 提取码: e9k1</p>
<p>高清电子版-Hadoop权威指南（中文第2版）.pdf</p>
<p>高清电子版-HBase实战.pdf 链接: <a href="https://pan.baidu.com/s/13Sd9GtEcdrDZ4ALiD1HJjQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/13Sd9GtEcdrDZ4ALiD1HJjQ</a> 提取码: udg5</p>
<p>高清电子版-Hive 简明教程.pdf 链接: <a href="https://pan.baidu.com/s/1tBnfJzAyoSbM8oPA0RlPSg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1tBnfJzAyoSbM8oPA0RlPSg</a> 提取码: or2c</p>
<p>高清电子版-Python机器学习——预测分析核心算法.pdf</p>
<p>高清电子版-scala伴生对象.pdf 链接: <a href="https://pan.baidu.com/s/18vZT0yMPZQr5F2I8KSlSuw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/18vZT0yMPZQr5F2I8KSlSuw</a> 提取码: co1u</p>
<p>高清电子版-scala基础语法.pdf</p>
<p>高清电子版-scala集合.pdf</p>
<p>高清电子版-Scala语言规范.pdf</p>
<p>高清电子版-Solr权威指南(上卷.pdf</p>
<p>高清电子版-Solr权威指南下卷.pdf</p>
<p>高清电子版-SparkContext.pdf 链接: <a href="https://pan.baidu.com/s/18JSnfozHZ7pQLR1RK8XAaw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/18JSnfozHZ7pQLR1RK8XAaw</a> 提取码: 87am</p>
<p>高清电子版-spark初识.pdf</p>
<p>高清电子版-Spark高级数据分析.pdf</p>
<p>高清电子版-Spark快速数据处理.pdf</p>
<p>高清电子版-spark内核.pdf</p>
<p>高清电子版-spark之SQL.pdf</p>
<p>高清电子版-Spark总结.pdf</p>
<p>高清电子版-Tensorflow 实战Google深度学习框架（完整版pdf).pdf</p>
<p>高清电子版-《大数据时代：生活、工作与思维的大变革》.pdf</p>
<p>高清电子版-《大数据之路：阿里巴巴大数据实践》.pdf</p>
<p>高清电子版-白话大数据与机器学习_章节目录.pdf</p>
<p>高清电子版-不错资料_hadoop搭建与eclipse开发环境设置.pdf</p>
<p>高清电子版-大数据：互联网大规模数据挖掘与分布式处理.pdf 链接: <a href="https://pan.baidu.com/s/1GVSWCksBMzlsM37rzS4AcQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1GVSWCksBMzlsM37rzS4AcQ</a> 提取码: i31h</p>
<p>高清电子版-大数据处理hive深入详解.pdf</p>
<p>高清电子版-大数据存储MongoDB实战指南.pdf</p>
<p>高清电子版-大数据架构师指南.pdf</p>
<p>高清电子版-大数据架构详解：从数据获取到深度学习.pdf</p>
<p>高清电子版-大数据搜索与日志挖掘及可视化方案++ELK+Stack++Elasticsearch+Logstash+Kibana++第2版.pdf</p>
<p>高清电子版-大数据算法.pdf 链接: <a href="https://pan.baidu.com/s/1639CnEcA5Tn_fNzrJV8T_g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1639CnEcA5Tn_fNzrJV8T_g</a> 提取码: 1rlv</p>
<p>高清电子版-傅强-当当在大数据挖掘分析与管理—个性化精准营销方面的探索.pdf</p>
<p>高清电子版-基于Hadoop平台的亿贝用户邮件数据分析(苏立).pdf</p>
<p>高清电子版-实战Hadop：开启通向云计算的捷径(刘鹏).pdf</p>
<p>高清电子版-数据算法 Hadoop Spark大数据处理技巧.pdf</p>
<p>高清电子版-搜索引擎优化魔法书+SEO+Magic+Book.pdf</p>
<p>高清电子版-细细品味Hadoop_Hadoop集群（第6期）_WordCount运行详解.pdf</p>
<p>高清电子版-细细品味Hadoop_Hadoop集群（第7期）_Eclipse开发环境设置.pdf</p>
<p>高清电子版-用户网络行为画像 大数据中的用户网络行为画像分析与内容推荐应用.pdf 链接: <a href="https://pan.baidu.com/s/1mqbQBQOOY0q6o7HjQGKjwg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1mqbQBQOOY0q6o7HjQGKjwg</a> 提取码: 8962</p>
<p>高清电子版-云计算大数据10.9日课腾讯邮箱垃圾邮箱解密-机器学习之贝叶斯分类.pdf</p>
<p>高清电子版-云计算和大数据时代网络技术揭秘.pdf</p>
<p>高清电子版-在Windows上安装Hadoop教程.pdf</p>
<p>高清电子版-自己动手做大数据系统.张魁(带书签文字版).pdf</p>
<p>高清电子版-Spark大数据处理 技术、应用与性能优化_PDF电子书下载 带书签目录 高清完整版.pdf</p>
<h3 id="微服务" tabindex="-1"> 微服务</h3>
<p>高清电子版-轻量级微服务架构（上册）.pdf 链接: <a href="https://pan.baidu.com/s/1outMUaP8gKP8rD92cvtctg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1outMUaP8gKP8rD92cvtctg</a>  密码: 0m6t</p>
<p>高清电子版-轻量级微服务架构（下册）.pdf 链接: <a href="https://pan.baidu.com/s/1A6GJK1jkB4738d1QoyR36Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1A6GJK1jkB4738d1QoyR36Q</a>  密码: q0s5</p>
<p>高清电子版-微服设计.pdf 链接: <a href="https://pan.baidu.com/s/1CCKbYk3w2NNiunBRUep_ag" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1CCKbYk3w2NNiunBRUep_ag</a> 提取码: mw52</p>
<h3 id="数据库" tabindex="-1"> 数据库</h3>
<p>高清电子版-数据库.pdf 链接: <a href="https://pan.baidu.com/s/1s2Oo8WHJGELNopJDnZzcag" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1s2Oo8WHJGELNopJDnZzcag</a>  密码: ucqu</p>
<p>高清电子版-数据库管理基础教程_14021810.pdf 链接: <a href="https://pan.baidu.com/s/1WK62548EAL6LnMMcG-Zbkg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1WK62548EAL6LnMMcG-Zbkg</a>  密码: 5he3</p>
<p>高清电子版-数据库设计教程 第2版_11474555.pdf 链接: <a href="https://pan.baidu.com/s/1oUne9RVsslo1e7Ic0xYqDA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1oUne9RVsslo1e7Ic0xYqDA</a>  密码: w8kl</p>
<p>高清电子版-数据库系统 设计 实现与管理 基础篇_14020444.pdf 链接: <a href="https://pan.baidu.com/s/1OvS4EqIlIJdTRXgvloyrbw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1OvS4EqIlIJdTRXgvloyrbw</a> 提取码: sr3t</p>
<p>高清电子版-数据库系统导论. 原书第8版. 11868713.pdf 链接: <a href="https://pan.baidu.com/s/1wTgpTeg8bwqSg8b539cksg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1wTgpTeg8bwqSg8b539cksg</a>  密码: pp2k</p>
<p>高清电子版-数据库系统概念 原书第6版_13013764.pdf 链接: <a href="https://pan.baidu.com/s/1XAuxGe61OnjC7IvmUuqPOw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1XAuxGe61OnjC7IvmUuqPOw</a>  密码: rj67</p>
<p>高清电子版-数据库系统基础教程 原书第3版_13839843.pdf 链接: <a href="https://pan.baidu.com/s/1zB1ZndASBZdTDk_76aHCCQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1zB1ZndASBZdTDk_76aHCCQ</a>  密码: o0v5</p>
<p>高清电子版-数据库系统全书_11134265.pdf 链接: <a href="https://pan.baidu.com/s/1MmQyWdRiwLP_aDwZJkR5Ng" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1MmQyWdRiwLP_aDwZJkR5Ng</a>  密码: avpg</p>
<p>高清电子版-数据库系统实现_12576367.pdf 链接: <a href="https://pan.baidu.com/s/180reFoXNCY0VOhfHCT7siA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/180reFoXNCY0VOhfHCT7siA</a>  密码: 5w67</p>
<p>高清电子版-数据库与事务处理. 11393943.pdf 链接: <a href="https://pan.baidu.com/s/1VzDXsFL_q0V1eB2zYuMH0A" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1VzDXsFL_q0V1eB2zYuMH0A</a> 提取码: 345i</p>
<p>高清电子版-数据库管理系统 （原书第三版）_11718627.pdf 链接: <a href="https://pan.baidu.com/s/1W15FRUzYCn6-L7fvpdCxag" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1W15FRUzYCn6-L7fvpdCxag</a> 提取码: eq80</p>
<h3 id="kotlin" tabindex="-1"> Kotlin</h3>
<p>高清电子版-Kotlin实战.pdf 链接: <a href="https://pan.baidu.com/s/16Dj7Q89OeWmcxBqoogl7Zg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/16Dj7Q89OeWmcxBqoogl7Zg</a> 提取码: 3qjr</p>
<h3 id="分布式" tabindex="-1"> 分布式</h3>
<p>高清电子版-Zookeeper_3.3.5源码分析.pdf 链接: <a href="https://pan.baidu.com/s/1lvmFl9kFQD4h6wV3-tH2Zw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1lvmFl9kFQD4h6wV3-tH2Zw</a>  密码: 5ppv</p>
<p>高清电子版-ZooKeeper原理与实战.pdf 链接: <a href="https://pan.baidu.com/s/1D-HSD88U15NG3j16t0uLfw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1D-HSD88U15NG3j16t0uLfw</a>  密码: aqit</p>
<p>高清电子版-《阿里双11系统管控调度架构与实践+》.pdf 链接: <a href="https://pan.baidu.com/s/19hBlL_XQl6lH9KhtqqPQhg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/19hBlL_XQl6lH9KhtqqPQhg</a>  密码: d6me</p>
<p>高清电子版-从Paxos到Zookeeper 分布式一致性原理与实践（书签版）.pdf 链接: <a href="https://pan.baidu.com/s/1BS_62evYf7JxwlWMvNyWLQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1BS_62evYf7JxwlWMvNyWLQ</a>  密码: f6k3</p>
<p>高清电子版-大型分布式网站架构设计与实践.pdf 链接: <a href="https://pan.baidu.com/s/1T3glz_70gQNHlnWxNerzbA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1T3glz_70gQNHlnWxNerzbA</a>  密码: 3dlh</p>
<p>高清电子版-大型网站技术架构：核心原理与案例分析+李智慧.pdf 链接: <a href="https://pan.baidu.com/s/1t-1MER72Q4hHFou_s9HXXg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1t-1MER72Q4hHFou_s9HXXg</a>  密码: ls4f</p>
<p>高清电子版-大型网站系统与JAVA中间件实践.pdf 链接: <a href="https://pan.baidu.com/s/1wI4_gMoM_uqNUJ8WoJCQQw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1wI4_gMoM_uqNUJ8WoJCQQw</a>  密码: q95g</p>
<p>高清电子版-大型网站系统与JAVA中间件实践（高清版）.pdf 链接: <a href="https://pan.baidu.com/s/1WpLq7_DUivinnDfCFWck1A" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1WpLq7_DUivinnDfCFWck1A</a>  密码: ilac</p>
<p>高清电子版-分布式Java应用基础与实践.pdf 链接: <a href="https://pan.baidu.com/s/1PVH0x4TgxsKWnPzXLxn6Jw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1PVH0x4TgxsKWnPzXLxn6Jw</a>  密码: q25o</p>
<p>高清电子版-解密搜索引擎技术实战Java精华版.pdf 链接: <a href="https://pan.baidu.com/s/1TR0-X4Wy_xNFpHRBRI54Sw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1TR0-X4Wy_xNFpHRBRI54Sw</a>  密码: 1v8o</p>
<p>高清电子版-微服务架构与实践(王磊著)完整版.pdf 链接: <a href="https://pan.baidu.com/s/1fovISbVeJnwhrCghqy4IsA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1fovISbVeJnwhrCghqy4IsA</a>  密码: 1t1n</p>
<h3 id="前端" tabindex="-1"> 前端</h3>
<p>高清电子版-jQuery[1].validate.js+API中文.pdf 链接: <a href="https://pan.baidu.com/s/1SkbUo5AcUlJd2JrMaIGJ0w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1SkbUo5AcUlJd2JrMaIGJ0w</a>  密码: 8w1h</p>
<p>高清电子版-jQuery实战.pdf 链接: <a href="https://pan.baidu.com/s/1fpGGz4gOOdAgiHQSI9qQ-w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1fpGGz4gOOdAgiHQSI9qQ-w</a>  密码: 9q43</p>
<p>高清电子版-Node.js 开发指南.pdf 链接: <a href="https://pan.baidu.com/s/1StBldJvEEdIZI1f2gqHfmg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1StBldJvEEdIZI1f2gqHfmg</a>  密码: sh29</p>
<p>高清电子版-从零开始学微信小程序开发.pdf 链接: <a href="https://pan.baidu.com/s/1f1SmRtR3J6vaEKyNtnjsgA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1f1SmRtR3J6vaEKyNtnjsgA</a>  密码: n87e</p>
<p>高清电子版-了不起的Node js将JavaScript进行到底.pdf 链接: <a href="https://pan.baidu.com/s/1grApZdJmzHa-sMJLUsqGNg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1grApZdJmzHa-sMJLUsqGNg</a>  密码: opa2</p>
<p>高清电子版-微信小程序开发入门与实践.pdf 链接: <a href="https://pan.baidu.com/s/1twZ8b0KBLQuRq7AkKO3eBQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1twZ8b0KBLQuRq7AkKO3eBQ</a>  密码: w5a1</p>
<p>高清电子版-微信小程序入门指南.pdf 链接: <a href="https://pan.baidu.com/s/1rdyioPVLbOMa5BqxjzR7Gw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1rdyioPVLbOMa5BqxjzR7Gw</a>  密码: g6e0</p>
<p>高清电子版-小程序 巧应用-微信小程序开发实战.pdf 链接: <a href="https://pan.baidu.com/s/1zDtL21Jzo9-ZILClfSs_eQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1zDtL21Jzo9-ZILClfSs_eQ</a>  密码: pc66</p>
<h3 id="软件测试等" tabindex="-1"> 软件测试等</h3>
<p>高清电子版-软件安全 从源头开始_14071995.pdf</p>
<p>高清电子版-软件测试 （原书第2版）_11562996.pdf</p>
<p>高清电子版-软件测试基础_12685361.pdf</p>
<p>高清电子版-软件测试基础教程_12848793.pdf</p>
<p>高清电子版-软件测试原理与实践principles and practices_12248342.pdf</p>
<p>高清电子版-软件工程 架构驱动的软件开发_14069604.pdf 链接: <a href="https://pan.baidu.com/s/1TPo3Vk6CU-pKM29JkmiOlg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1TPo3Vk6CU-pKM29JkmiOlg</a> 提取码: 9adg</p>
<p>高清电子版-软件工程 面向对象和传统的方法 原书第8版_12870799.pdf</p>
<p>高清电子版-软件工程 原书第9版_12773590.pdf</p>
<p>高清电子版-软件可靠性方法_12950849.pdf</p>
<h3 id="c语言" tabindex="-1"> C语言</h3>
<p>高清电子版-C 大全 C语言.pdf</p>
<p>高清电子版-COBOL语言(上)谭浩强.pdf</p>
<p>高清电子版-COBOL语言(下)谭浩强.pdf</p>
<p>高清电子版-C_数据结构和算法分析.pdf</p>
<p>高清电子版-C程序设计语言(英文第2版)Prentice Hall.-.The C Programming Language(2nd Edition).pdf</p>
<p>高清电子版-C程序设计语言_第2版新版（高清）.pdf 链接: <a href="https://pan.baidu.com/s/1edKhZqFukjXY1613eb2N6Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1edKhZqFukjXY1613eb2N6Q</a> 提取码: 77kq</p>
<p>高清电子版-C程序设计语言（第2版 新版）.pdf</p>
<p>高清电子版-C程序设计语言（第2版 新版）习题解答.pdf 链接: <a href="https://pan.baidu.com/s/1t-5EChcZcZqkaPlgy47Otg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1t-5EChcZcZqkaPlgy47Otg</a> 提取码: s17m</p>
<p>高清电子版-C程序设计语言（第2版）中文译版.pdf 链接: <a href="https://pan.baidu.com/s/1Euqj1nUawoS1PX5Te3Ebyw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Euqj1nUawoS1PX5Te3Ebyw</a> 提取码: 1pui</p>
<p>高清电子版-C大纲.pdf</p>
<p>高清电子版-C和指针.pdf</p>
<p>高清电子版-C基础班范例代码训练.pdf</p>
<p>高清电子版-C数值算法程序大全.pdf</p>
<p>高清电子版-c与指针.pdf</p>
<p>高清电子版-C语言参考手册第五版.pdf 链接: <a href="https://pan.baidu.com/s/1Euqj1nUawoS1PX5Te3Ebyw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Euqj1nUawoS1PX5Te3Ebyw</a> 提取码: 1pui</p>
<p>高清电子版-C语言程序设计 现代方法 第2版.pdf</p>
<p>高清电子版-C语言大全第4版.pdf</p>
<p>高清电子版-C语言函数大全.pdf</p>
<p>高清电子版-C语言解析教程.pdf</p>
<p>高清电子版-C语言深度解剖.pdf</p>
<p>高清电子版-C语言实现病毒源码演示.pdf</p>
<p>高清电子版-C专家编程.pdf</p>
<p>高清电子版-Linux C函数库参考手册.pdf 链接: <a href="https://pan.baidu.com/s/105KhS-cpZSNiMKAVDRzE_w" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/105KhS-cpZSNiMKAVDRzE_w</a> 提取码: 116g</p>
<p>高清电子版-[数据结构(C语言版)].严蔚敏_吴伟民.扫描版.pdf 链接: <a href="https://pan.baidu.com/s/1tESVcKGX83kOvtDOooNi6A" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1tESVcKGX83kOvtDOooNi6A</a> 提取码: cwln</p>
<p>高清电子版-华为C语言规范.pdf</p>
<p>高清电子版-可变目标C编译器 设计与实现_14136026.pdf</p>
<p>高清电子版-密码学算法协议c实现.pdf</p>
<p>高清电子版-嵌入式系统的描述与设计_11580404.pdf</p>
<p>高清电子版-网络环境下的C语言编程技巧及实例.pdf</p>
<h3 id="python" tabindex="-1"> Python</h3>
<p>高清电子版-Beautiful_Soup中文文档.pdf</p>
<p>高清电子版-Head_First_Python（中文版）.pdf</p>
<p>高清电子版-Intermediate_Python中文译本.pdf</p>
<p>高清电子版-Keras中文手册.pdf</p>
<p>高清电子版-NumPy攻略__Python科学计算与数据分析_.pdf</p>
<p>高清电子版-Phthon编程金典.pdf</p>
<p>高清电子版-python cookbook(第3版)高清中文完整版(###).pdf</p>
<p>高清电子版-PYTHON QT GUI快速编程 PYQT编程指南 马克·萨默菲尔德 P444 2016.08.pdf</p>
<p>高清电子版-Python100经典练习题.pdf</p>
<p>高清电子版-Python3.5从零开始学.pdf</p>
<p>高清电子版-Python3程序开发指南（美）萨默菲尔德.扫描版.pdf</p>
<p>高清电子版-Python3高级教程###.pdf</p>
<p>高清电子版-Python3萌新入门笔记及练习2018.3.30更新.pdf</p>
<p>高清电子版-Python3网络爬虫数据采集.pdf</p>
<p>高清电子版-python_by_Liao.pdf</p>
<p>高清电子版-python_cookbook（第3版）高清中文完整版.pdf</p>
<p>高清电子版-Python_Web开发：测试驱动方法.pdf</p>
<p>高清电子版-Python_Web开发实战.pdf</p>
<p>高清电子版-Python_文本处理指南［经典］.pdf</p>
<p>高清电子版-Python编程：从入门到实践(#).pdf</p>
<p>高清电子版-Python编程导论第2版_2018（#）.pdf</p>
<p>高清电子版-Python编程快速上手—让繁琐工作自动化_PDF中文高清晰完整版.pdf</p>
<p>高清电子版-Python编程入门经典.pdf</p>
<p>高清电子版-Python编程实战__运用设计模式、并发和程序库创建高质量程序_.pdf</p>
<p>高清电子版-python标准库.pdf</p>
<p>高清电子版-Python参考手册(第4版).pdf</p>
<p>高清电子版-Python程序员指南.pdf</p>
<p>高清电子版-Python地理空间分析指南（第2版）.pdf</p>
<p>高清电子版-Python高级编程（清华）.pdf</p>
<p>高清电子版-Python高级编程第2版_张亮 阿信（译）_人民邮电出版社_2017-10_v2_完整版.pdf</p>
<p>高清电子版-Python高性能编程.pdf</p>
<p>高清电子版-Python核心编程第3版中文版.pdf</p>
<p>高清电子版-Python核心编程中文.pdf</p>
<p>高清电子版-Python灰帽子——黑客与逆向工程师的Python编程之道.pdf</p>
<p>高清电子版-Python机器学习基础教程中文版###.pdf</p>
<p>高清电子版-PYTHON机器学习及实践－从零开始通往KAGGLE竞赛之路.pdf</p>
<p>高清电子版-Python基础教程（第3版）（#）.pdf</p>
<p>高清电子版-Python技术参考大全.pdf</p>
<p>高清电子版-Python金融大数据分析.pdf</p>
<p>高清电子版-Python金融实战###.pdf</p>
<p>高清电子版-Python进阶（Intermediate_Python）_中文PDF彩色版.pdf</p>
<p>高清电子版-Python开发技术详解.pdf</p>
<p>高清电子版-Python开发实战(PDF版).pdf</p>
<p>高清电子版-Python开发实战.pdf</p>
<p>高清电子版-Python科学计算(#).pdf</p>
<p>高清电子版-Python科学计算张若愚.pdf</p>
<p>高清电子版-PYTHON面向对象编程指南 （美）STEVEN F.LOTT著；张心韬，兰亮译人民邮电出版.pdf</p>
<p>高清电子版-Python爬虫开发与项目实战.pdf</p>
<p>高清电子版-Python入门经典_以解决计算问题为导向的Python编程.pdf</p>
<p>高清电子版-Python数据处理(###).pdf</p>
<p>高清电子版-Python数据处理.pdf</p>
<p>高清电子版-Python数据分析基础教程：NumPy学习指南（第2版）.pdf</p>
<p>高清电子版-Python数据分析实战_2016版.pdf</p>
<p>高清电子版-Python数据科学手册.pdf</p>
<p>高清电子版-PYTHON数据可视化编程实战.pdf</p>
<p>高清电子版-Python网络编程基础.pdf</p>
<p>高清电子版-Python网络数据采集.pdf</p>
<p>高清电子版-Python学习手册(第4版).pdf</p>
<p>高清电子版-Python学习手册（第3版）.pdf</p>
<p>高清电子版-Python语言及其应用.pdf</p>
<p>高清电子版-Python语言入门.pdf</p>
<p>高清电子版-Python源码剖析-深度探索动态语言核心技术.pdf</p>
<p>高清电子版-Scikit－Learn_教學：Python_與機器學習_（Article）.pdf</p>
<p>高清电子版-Selenium 2自动化测试实战 基于Python语言.pdf</p>
<p>高清电子版-Tensorflow 实战Google深度学习框架.pdf</p>
<p>高清电子版-TensorFlow实践与智能系统.pdf</p>
<p>高清电子版-wxPython实战(中文版）.pdf</p>
<p>高清电子版-白话深度学习与TensorFlow.pdf</p>
<p>高清电子版-贝叶斯思维统计建模的PYTHON学习法.pdf</p>
<p>高清电子版-编程小白的第一本python入门书.pdf</p>
<p>高清电子版-编写高质量代码 改善Python程序的91个建议.pdf</p>
<p>高清电子版-常用数据挖掘算法总结及Python实现.pdf</p>
<p>高清电子版-从Excel到Python——数据分析进阶指南.pdf</p>
<p>高清电子版-从Python开始学编程.pdf</p>
<p>高清电子版-机器学习numpy和pandas基础.pdf</p>
<p>高清电子版-机器学习实战.pdf</p>
<p>高清电子版-基于Python实现的微信好友数据分析.pdf</p>
<p>高清电子版-简明Python教程（#）.pdf</p>
<p>高清电子版-精通 Django(####).pdf</p>
<p>高清电子版-精通Python爬虫框架Scrapy_－_2018.pdf</p>
<p>高清电子版-精通Python设计模式_带索引书签目录.pdf</p>
<p>高清电子版-精通Scrapy网络爬虫(###).pdf</p>
<p>高清电子版-可爱的Python脚本语言入门精品文章.pdf</p>
<p>高清电子版-利用Python进行数据分析(###).pdf</p>
<p>高清电子版-量化投资以Python为工具.pdf</p>
<p>高清电子版-流畅的python.pdf</p>
<p>高清电子版-轻量级Django_，Julia_Elman_，P218_，2016.10.pdf</p>
<p>高清电子版-社交网站的数据挖掘与分析_中文版.pdf</p>
<p>高清电子版-深度学习-无水印-中文版.pdf</p>
<p>高清电子版-深度学习入门：基于Python的理论与实现(###).pdf</p>
<p>高清电子版-深入Python3中文版.pdf</p>
<p>高清电子版-深入理解机器学习－从原理到算法［沙伊.沙莱夫－施瓦茨］.pdf</p>
<p>高清电子版-神经网络和深度学习.pdf</p>
<p>高清电子版-数据结构与算法Python语言描述_裘宗燕编著_北京：机械工业出版社_，_2016.01_P346.pdf</p>
<p>高清电子版-数据科学入门.pdf</p>
<p>高清电子版-网络爬虫－Python和数据分析.pdf</p>
<p>高清电子版-用Python进行自然语言处理(中文翻译NLTK).pdf</p>
<p>高清电子版-用Python写网络爬虫.pdf</p>
<p>高清电子版-与孩子一起学编程（第一版）.pdf</p>
<p>高清电子版-征服PYTHON-语言基础与典型应用.pdf</p>
<p>高清电子版-Python编程初学者指南.pdf</p>
<h3 id="机器学习相关" tabindex="-1"> 机器学习相关</h3>
<p>高清电子版-Spark机器学习.pdf</p>
<p>高清电子版-机器学习.pdf</p>
<p>高清电子版-人工智能 复杂问题求解的结构和策略 原书第6版_12492572.pdf</p>
<p>高清电子版-人工智能 智能系统指南（原书第3版）_13134360.pdf 链接: <a href="https://pan.baidu.com/s/1gBWtMUEv02pA1KxUBKIS_Q" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1gBWtMUEv02pA1KxUBKIS_Q</a> 提取码: lnb7</p>
<p>高清电子版-神经网络与机器学习_12759105.pdf</p>
<p>高清电子版-神经网络原理. 原书第2版. 11133514.pdf</p>
<p>高清电子版-实时系统与编程语言_11261818.pdf</p>
<p>高清电子版-数据通信 基础设施、联网和安全 原书第7版T.pdf</p>
<p>高清电子版-数据通信、计算机网络与开放系统 （原书第4版）.pdf</p>
<p>高清电子版-数据通信与网络 （原书第四版）_11998486.pdf</p>
<p>高清电子版-数据挖掘：实用机器学习技术 （原书第2版）_11562805.pdf</p>
<p>高清电子版-数据挖掘概念与技术_concepts and techniques_13049237.pdf</p>
<p>高清电子版-数据挖掘基础教程_12124868.pdf</p>
<p>高清电子版-数据挖掘实用机器学习工具与技术原书第3版.pdf</p>
<p>高清电子版-数据挖掘原理_11048466.pdf</p>
<p>高清电子版-数字图像处理疑难解析_11371721.pdf</p>
<p>高清电子版-网络 原书第2版_11314270.pdf</p>
<p>高清电子版-网络科学 原理与应用_12938788.pdf</p>
<h3 id="c-net" tabindex="-1"> C# .Net</h3>
<p>高清电子版-1.ASP.NET.2.0.XML.高级编程(第3版).pdf</p>
<p>高清电子版-10.C#程序员参考手册.pdf</p>
<p>高清电子版-12.C#技术内幕.pdf 链接: <a href="https://pan.baidu.com/s/1V3h3adtbnyw1wpPO85trHg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1V3h3adtbnyw1wpPO85trHg</a> 提取码: eam7</p>
<p>高清电子版-13.C#入门经典(第3版).pdf</p>
<p>高清电子版-14.C#软件项目开发全程剖析——全面透视SharpDevelop软件的开发内幕.pdf</p>
<p>高清电子版-15.C#设计模式.pdf</p>
<p>高清电子版-16.C#应用程序开发全程演练——从灵感到实现.pdf</p>
<p>高清电子版-17.C#与.NET技术平台实战演练.pdf</p>
<p>高清电子版-18.C#字符串和正则表达式参考手册.pdf 链接: <a href="https://pan.baidu.com/s/108NEgFhGD2P7SFKW9imwJQ" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/108NEgFhGD2P7SFKW9imwJQ</a> 提取码: ulsw</p>
<p>高清电子版-19.Microsoft.C#.Windows.程序设计(上下册).pdf</p>
<p>高清电子版-2.ASP.NET.2.0.高级编程(第4版).pdf 链接: <a href="https://pan.baidu.com/s/1TAh8USRdqxWDWWETl9rvPA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1TAh8USRdqxWDWWETl9rvPA</a> 提取码: qv3q</p>
<p>高清电子版-20.Microsoft.NET.框架程序设计(修订版).pdf</p>
<p>高清电子版-21.Programming.ASP.NET.中文版(第3版).pdf</p>
<p>高清电子版-22.Programming.C#.中文版(第4版).pdf</p>
<p>高清电子版-26.Visual.C#.NET.网络核心编程.pdf</p>
<p>高清电子版-27.Windows应用高级编程——C#编程篇.pdf</p>
<p>高清电子版-28.你必须知道的.NET.pdf</p>
<p>高清电子版-3.ASP.NET.2.0.入门经典(第4版).pdf</p>
<p>高清电子版-30.数据结构(C#语言版).pdf 链接: <a href="https://pan.baidu.com/s/1gCz9kkfiM_h0VOg--Wt9dA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1gCz9kkfiM_h0VOg--Wt9dA</a> 提取码: wskb</p>
<p>高清电子版-4.ASP.NET.2.0.数据库入门经典(第4版).pdf 链接: <a href="https://pan.baidu.com/s/1gCz9kkfiM_h0VOg--Wt9dA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1gCz9kkfiM_h0VOg--Wt9dA</a> 提取码: wskb</p>
<p>高清电子版-5.ASP.NET.基础教程——C#案例版.pdf</p>
<p>高清电子版-6.ASP.NET技术内幕.pdf</p>
<p>高清电子版-7.C#.COM..编程指南.pdf 链接: <a href="https://pan.baidu.com/s/100tf-zD_53llCEE8keDuEw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/100tf-zD_53llCEE8keDuEw</a> 提取码: p888</p>
<p>高清电子版-8.C#编程思想.pdf</p>
<p>高清电子版-C#.4.0完全参考手册.pdf</p>
<p>高清电子版-C#2008编程参考手册].pdf</p>
<p>高清电子版-C#3.0完全自学宝典.pdf 链接: <a href="https://pan.baidu.com/s/1X9ChdLN-NPibbjSwChjdEA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1X9ChdLN-NPibbjSwChjdEA</a> 提取码: 25h1</p>
<p>高清电子版-C#编程宝典 十年典藏版.pdf</p>
<p>高清电子版-C#程序开发范例宝典（第3版）.pdf</p>
<p>高清电子版-C#项目开发案例全程实录(第2版).pdf</p>
<p>高清电子版-C#学习笔记.pdf</p>
<p>高清电子版-C#字符串和正则表达式参考手册.pdf</p>
<p>高清电子版-Visual C#.NET案例开发集锦.pdf</p>
<p>高清电子版-visual.c#.net.网络核心编程.pdf</p>
<p>高清电子版-VisualC#数据库高级教程.pdf</p>
<p>高清电子版-[C#与.NET4高级程序设计（第5版）].(Pro.C#.2010.and.the.NET.4.Platform.5.edition).张大磊等.扫描版.pdf</p>
<p>高清电子版-[C#与.NET程序员面试宝典].靳华.胡鑫鑫.扫描版.pdf</p>
<p>高清电子版-【名师解惑】传智播客.net培训-名师解惑：.net应该学什么？怎么学？（1）.pdf</p>
<p>高清电子版-【名师解惑】传智播客.net培训-名师解惑：.net应该学什么？怎么学？（2）.pdf</p>
<p>高清电子版-【名师解惑】传智播客.net培训-名师解惑：.net应该学什么？怎么学？（3）.pdf</p>
<p>高清电子版-【名师解惑】传智播客.net培训-名师解惑：.net应该学什么？怎么学？（4）.pdf</p>
<p>高清电子版-【名师解惑】传智播客.net培训-名师解惑：学了.net能做什么开发.pdf</p>
<p>高清电子版-【名师解惑】向前向前向前！向Windows.Phone平台前进.pdf</p>
<p>高清电子版-程序员突击Visual.C#.2008原理与系统开发.pdf</p>
<p>高清电子版-叩响C#之门.pdf</p>
<h3 id="面试篇" tabindex="-1"> 面试篇</h3>
<p><strong>持续更新中......</strong></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-18T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">SpringBoot+WebSocket实时监控异常</title>
    <id>https://blog.ciberviler.top/dev/SpringBoot+WebSocket%E5%AE%9E%E6%97%B6%E7%9B%91%E6%8E%A7%E5%BC%82%E5%B8%B8.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringBoot+WebSocket%E5%AE%9E%E6%97%B6%E7%9B%91%E6%8E%A7%E5%BC%82%E5%B8%B8.html"/>
    <updated>2022-05-21T09:03:15.000Z</updated>
    <summary type="html">SpringBoot+WebSocket实时监控异常</summary>
    <content type="html"><![CDATA[<h1 id="springboot-websocket实时监控异常" tabindex="-1"> SpringBoot+WebSocket实时监控异常</h1>
<h2 id="需求" tabindex="-1"> 需求</h2>
<p>消防的设备巡检，如果巡检发现异常，通过手机端提交，后台的实时监控页面实时获取到该设备的信息及位置，然后安排员工去处理。</p>
<p>因为需要服务端主动向客户端发送消息，所以很容易的就想到了用WebSocket来实现这一功能。</p>
<p>WebSocket就不做介绍了，上链接：<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WebSocket" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/API/WebSocket</a></p>
<p>前端略微复杂，需要在一张位置分布图上进行鼠标描点定位各个设备和根据不同屏幕大小渲染，本文不做介绍，只是简单地用页面样式进行效果呈现。</p>
<p><strong>绿色代表正常，红色代表异常</strong></p>
<p>预期效果，未接收到请求前-----&gt;id为3的提交了异常，id为3的王五变成了红色</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2519868-20211015031414701-272219147.png" alt="img" loading="lazy">　　　　<img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2519868-20211015031659597-188497867.png" alt="img" loading="lazy"></p>
<h2 id="实现-前端" tabindex="-1"> 实现-前端：</h2>
<p>直接贴代码</p>
<div><pre><code><span><span>&lt;!</span><span>DOCTYPE</span> <span>html</span><span>></span></span>
<span><span><span>&lt;</span>html</span><span>></span></span>
    <span><span><span>&lt;</span>head</span><span>></span></span>
        <span><span><span>&lt;</span>meta</span> <span>charset</span><span><span>=</span><span>"</span>utf-8<span>"</span></span> <span>/></span></span>
        <span><span><span>&lt;</span>title</span><span>></span></span>实时监控<span><span><span>&lt;/</span>title</span><span>></span></span>
    <span><span><span>&lt;/</span>head</span><span>></span></span>
    <span><span><span>&lt;</span>style</span><span>></span></span><span><span>
        <span>.item</span> <span>{</span>
            <span>display</span><span>:</span> flex<span>;</span>
            <span>border-bottom</span><span>:</span> 1px solid #000000<span>;</span>
            <span>justify-content</span><span>:</span> space-between<span>;</span>
            <span>width</span><span>:</span> 30%<span>;</span>
            <span>line-height</span><span>:</span> 50px<span>;</span>
            <span>height</span><span>:</span> 50px<span>;</span>
        <span>}</span>

        <span>.item span:nth-child(2)</span><span>{</span>
            <span>margin-right</span><span>:</span> 10px<span>;</span>
            <span>margin-top</span><span>:</span> 15px<span>;</span>
            <span>width</span><span>:</span> 20px<span>;</span>
            <span>height</span><span>:</span> 20px<span>;</span>
            <span>border-radius</span><span>:</span> 50%<span>;</span>
            <span>background</span><span>:</span> #55ff00<span>;</span>
        <span>}</span>
        <span>.nowI</span><span>{</span>
            <span>background</span><span>:</span> #ff0000 <span>!important</span><span>;</span>
        <span>}</span>
    </span></span><span><span><span>&lt;/</span>style</span><span>></span></span>
    <span><span><span>&lt;</span>body</span><span>></span></span>
        <span><span><span>&lt;</span>div</span> <span>id</span><span><span>=</span><span>"</span>app<span>"</span></span><span>></span></span>
            <span><span><span>&lt;</span>div</span> <span>v-for</span><span><span>=</span><span>"</span>item in list<span>"</span></span> <span>class</span><span><span>=</span><span>"</span>item<span>"</span></span><span>></span></span>
                <span><span><span>&lt;</span>span</span><span>></span></span>{{item.id}}.{{item.name}}<span><span><span>&lt;/</span>span</span><span>></span></span>
                <span><span><span>&lt;</span>span</span> <span>:class</span><span><span>=</span><span>'</span>item.state==-1?<span>"</span>nowI<span>"</span>:<span>"</span><span>"</span><span>'</span></span><span>></span></span><span><span><span>&lt;/</span>span</span><span>></span></span>
            <span><span><span>&lt;/</span>div</span><span>></span></span>
        <span><span><span>&lt;/</span>div</span><span>></span></span>
    <span><span><span>&lt;/</span>body</span><span>></span></span>
    <span><span><span>&lt;</span>script</span> <span>src</span><span><span>=</span><span>"</span>./js/vue.min.js<span>"</span></span><span>></span></span><span></span><span><span><span>&lt;/</span>script</span><span>></span></span>
    <span><span><span>&lt;</span>script</span> <span>type</span><span><span>=</span><span>"</span>text/javascript<span>"</span></span><span>></span></span><span><span>
        <span>var</span> vm <span>=</span> <span>new</span> <span>Vue</span><span>(</span><span>{</span>
            <span>el</span><span>:</span> <span>"#app"</span><span>,</span>
            <span>data</span><span>:</span> <span>{</span>
                <span>list</span><span>:</span> <span>[</span><span>{</span>
                        <span>id</span><span>:</span> <span>1</span><span>,</span>
                        <span>name</span><span>:</span> <span>'张三'</span><span>,</span>
                        <span>state</span><span>:</span> <span>1</span>
                    <span>}</span><span>,</span>
                    <span>{</span>
                        <span>id</span><span>:</span> <span>2</span><span>,</span>
                        <span>name</span><span>:</span> <span>'李四'</span><span>,</span>
                        <span>state</span><span>:</span> <span>1</span>
                    <span>}</span><span>,</span>
                    <span>{</span>
                        <span>id</span><span>:</span> <span>3</span><span>,</span>
                        <span>name</span><span>:</span> <span>'王五'</span><span>,</span>
                        <span>state</span><span>:</span> <span>1</span>
                    <span>}</span><span>,</span>
                    <span>{</span>
                        <span>id</span><span>:</span> <span>4</span><span>,</span>
                        <span>name</span><span>:</span> <span>'韩梅梅'</span><span>,</span>
                        <span>state</span><span>:</span> <span>1</span>
                    <span>}</span><span>,</span>
                    <span>{</span>
                        <span>id</span><span>:</span> <span>5</span><span>,</span>
                        <span>name</span><span>:</span> <span>'李磊'</span><span>,</span>
                        <span>state</span><span>:</span> <span>1</span>
                    <span>}</span><span>,</span>
                <span>]</span>
            <span>}</span>
        <span>}</span><span>)</span>

        <span>var</span> webSocket <span>=</span> <span>null</span><span>;</span>
        <span>if</span> <span>(</span><span>'WebSocket'</span> <span>in</span> window<span>)</span> <span>{</span>
            <span>//创建WebSocket对象</span>
            webSocket <span>=</span> <span>new</span> <span>WebSocket</span><span>(</span><span>"ws://localhost:18801/webSocket/"</span> <span>+</span> <span>getUUID</span><span>(</span><span>)</span><span>)</span><span>;</span>

            <span>//连接成功</span>
            webSocket<span>.</span><span>onopen</span> <span>=</span> <span>function</span><span>(</span><span>)</span> <span>{</span>
                console<span>.</span><span>log</span><span>(</span><span>"已连接"</span><span>)</span><span>;</span>
                webSocket<span>.</span><span>send</span><span>(</span><span>"消息发送测试"</span><span>)</span>
            <span>}</span>
            <span>//接收到消息</span>
            webSocket<span>.</span><span>onmessage</span> <span>=</span> <span>function</span><span>(</span><span>msg</span><span>)</span> <span>{</span>
                <span>//处理消息</span>
                <span>var</span> serverMsg <span>=</span> msg<span>.</span>data<span>;</span>
                <span>var</span> t_id <span>=</span> <span>parseInt</span><span>(</span>serverMsg<span>)</span>    <span>//服务端发过来的消息，ID，string需转化为int类型才能比较</span>
                <span>for</span> <span>(</span><span>var</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> vm<span>.</span>list<span>.</span>length<span>;</span> i<span>++</span><span>)</span> <span>{</span>
                    <span>var</span> item <span>=</span> vm<span>.</span>list<span>[</span>i<span>]</span><span>;</span>
                    <span>if</span><span>(</span>item<span>.</span>id <span>==</span> t_id<span>)</span><span>{</span>
                        item<span>.</span>state <span>=</span> <span>-</span><span>1</span><span>;</span>
                        vm<span>.</span>list<span>.</span><span>splice</span><span>(</span>i<span>,</span><span>1</span><span>,</span>item<span>)</span>
                        <span>break</span><span>;</span>
                    <span>}</span>
                <span>}</span>
            <span>}</span><span>;</span>

            <span>//关闭事件</span>
            webSocket<span>.</span><span>onclose</span> <span>=</span> <span>function</span><span>(</span><span>)</span> <span>{</span>
                console<span>.</span><span>log</span><span>(</span><span>"websocket已关闭"</span><span>)</span><span>;</span>
            <span>}</span><span>;</span>
            <span>//发生了错误事件</span>
            webSocket<span>.</span><span>onerror</span> <span>=</span> <span>function</span><span>(</span><span>)</span> <span>{</span>
                console<span>.</span><span>log</span><span>(</span><span>"websocket发生了错误"</span><span>)</span><span>;</span>
            <span>}</span>
        <span>}</span> <span>else</span> <span>{</span>
            <span>alert</span><span>(</span><span>"很遗憾，您的浏览器不支持WebSocket！"</span><span>)</span>
        <span>}</span>

        <span>function</span> <span>getUUID</span><span>(</span><span>)</span> <span>{</span>    <span>//获取唯一的UUID</span>
            <span>return</span> <span>'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'</span><span>.</span><span>replace</span><span>(</span><span><span>/</span><span>[xy]</span><span>/</span><span>g</span></span><span>,</span> <span>function</span><span>(</span><span>c</span><span>)</span> <span>{</span>

                <span>var</span> r <span>=</span> Math<span>.</span><span>random</span><span>(</span><span>)</span> <span>*</span> <span>16</span> <span>|</span> <span>0</span><span>,</span>
                    v <span>=</span> c <span>==</span> <span>'x'</span> <span>?</span> r <span>:</span> <span>(</span>r <span>&amp;</span> <span>0x3</span> <span>|</span> <span>0x8</span><span>)</span><span>;</span>
                <span>return</span> v<span>.</span><span>toString</span><span>(</span><span>16</span><span>)</span><span>;</span>
            <span>}</span><span>)</span><span>;</span>
        <span>}</span>
    </span></span><span><span><span>&lt;/</span>script</span><span>></span></span>
<span><span><span>&lt;/</span>html</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="实现-后端" tabindex="-1"> 实现-后端：</h2>
<p>项目结构是这样子的，后面的代码关键注释都有，就不重复描述了</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2519868-20211015032104670-873058355.png" alt="img" loading="lazy"></p>
<p>1、新建SpringBoot工程，选择web和WebSockt依赖</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2519868-20211015105941687-95294147.png" alt="img" loading="lazy"></p>
<p>2、配置application.yml</p>
<div><pre><code><span>#端口</span>
<span>server</span><span>:</span>
  <span>port</span><span>:</span> <span>18801</span>

<span>#密码，因为接口不需要权限，所以加了个密码做校验</span>
<span>mySocket</span><span>:</span>
  <span>myPwd</span><span>:</span> jae_123
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>3、WebSocketConfig配置类</p>
<div><pre><code><span>@Configuration</span>
<span>public</span> <span>class</span> <span>WebSocketConfig</span> <span>{</span>

    <span>/**
     * 注入一个ServerEndpointExporter,该Bean会自动注册使用@ServerEndpoint注解申明的websocket endpoint
     */</span>
    <span>@Bean</span>
    <span>public</span> <span>ServerEndpointExporter</span> <span>serverEndpointExporter</span><span>(</span><span>)</span><span>{</span>
        <span>return</span> <span>new</span> <span>ServerEndpointExporter</span><span>(</span><span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>4、WebSocketServer类，用来进行服务端和客户端之间的交互</p>
<div><pre><code><span>/**
 * <span>@author</span> jae
 * @ServerEndpoint("/webSocket/<span>{</span>uid<span>}</span>") 前端通过此URI与后端建立链接
 */</span>

<span>@ServerEndpoint</span><span>(</span><span>"/webSocket/{uid}"</span><span>)</span>
<span>@Component</span>
<span>public</span> <span>class</span> <span>WebSocketServer</span> <span>{</span>

    <span>private</span> <span>static</span> <span>Logger</span> log <span>=</span> <span>LoggerFactory</span><span>.</span><span>getLogger</span><span>(</span><span>WebSocketServer</span><span>.</span><span>class</span><span>)</span><span>;</span>

    <span>//静态变量，用来记录当前在线连接数。应该把它设计成线程安全的。</span>
    <span>private</span> <span>static</span> <span>final</span> <span>AtomicInteger</span> onlineNum <span>=</span> <span>new</span> <span>AtomicInteger</span><span>(</span><span>0</span><span>)</span><span>;</span>

    <span>//concurrent包的线程安全Set，用来存放每个客户端对应的WebSocketServer对象。</span>
    <span>private</span> <span>static</span> <span>CopyOnWriteArraySet</span><span><span>&lt;</span><span>Session</span><span>></span></span> sessionPools <span>=</span> <span>new</span> <span>CopyOnWriteArraySet</span><span><span>&lt;</span><span>Session</span><span>></span></span><span>(</span><span>)</span><span>;</span>

    <span>/**
     * 有客户端连接成功
     */</span>
    <span>@OnOpen</span>
    <span>public</span> <span>void</span> <span>onOpen</span><span>(</span><span>Session</span> session<span>,</span> <span>@PathParam</span><span>(</span>value <span>=</span> <span>"uid"</span><span>)</span> <span>String</span> uid<span>)</span><span>{</span>
        sessionPools<span>.</span><span>add</span><span>(</span>session<span>)</span><span>;</span>
        onlineNum<span>.</span><span>incrementAndGet</span><span>(</span><span>)</span><span>;</span>
        log<span>.</span><span>info</span><span>(</span>uid <span>+</span> <span>"加入webSocket！当前人数为"</span> <span>+</span> onlineNum<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 连接关闭调用的方法
     */</span>
    <span>@OnClose</span>
    <span>public</span> <span>void</span> <span>onClose</span><span>(</span><span>Session</span> session<span>)</span> <span>{</span>
        sessionPools<span>.</span><span>remove</span><span>(</span>session<span>)</span><span>;</span>
        <span>int</span> cnt <span>=</span> onlineNum<span>.</span><span>decrementAndGet</span><span>(</span><span>)</span><span>;</span>
        log<span>.</span><span>info</span><span>(</span><span>"有连接关闭，当前连接数为：{}"</span><span>,</span> cnt<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 发送消息
     */</span>
    <span>public</span> <span>void</span> <span>sendMessage</span><span>(</span><span>Session</span> session<span>,</span> <span>String</span> message<span>)</span> <span>throws</span> <span>IOException</span> <span>{</span>
        <span>if</span><span>(</span>session <span>!=</span> <span>null</span><span>)</span><span>{</span>
            <span>synchronized</span> <span>(</span>session<span>)</span> <span>{</span>
                session<span>.</span><span>getBasicRemote</span><span>(</span><span>)</span><span>.</span><span>sendText</span><span>(</span>message<span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>

    <span>/**
     * 群发消息
     */</span>
    <span>public</span> <span>void</span> <span>broadCastInfo</span><span>(</span><span>String</span> message<span>)</span> <span>throws</span> <span>IOException</span> <span>{</span>
        <span>for</span> <span>(</span><span>Session</span> session <span>:</span> sessionPools<span>)</span> <span>{</span>
            <span>if</span><span>(</span>session<span>.</span><span>isOpen</span><span>(</span><span>)</span><span>)</span><span>{</span>
                <span>sendMessage</span><span>(</span>session<span>,</span> message<span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>

    <span>/**
     * 发生错误
     */</span>
    <span>@OnError</span>
    <span>public</span> <span>void</span> <span>onError</span><span>(</span><span>Session</span> session<span>,</span> <span>Throwable</span> throwable<span>)</span><span>{</span>
        log<span>.</span><span>error</span><span>(</span><span>"发生错误"</span><span>)</span><span>;</span>
        throwable<span>.</span><span>printStackTrace</span><span>(</span><span>)</span><span>;</span>
    <span>}</span>

<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>5、WebSocketController类，用于进行接口测试</p>
<div><pre><code><span>@RestController</span>
<span>@RequestMapping</span><span>(</span><span>"/open/socket"</span><span>)</span>
<span>public</span> <span>class</span> <span>WebSocketController</span> <span>{</span>

    <span>@Value</span><span>(</span><span>"${mySocket.myPwd}"</span><span>)</span>
    <span>public</span> <span>String</span> myPwd<span>;</span>

    <span>@Autowired</span>
    <span>private</span> <span>WebSocketServer</span> webSocketServer<span>;</span>

    <span>/**
     * 手机客户端请求接口
     * <span>@param</span> <span>id</span>    发生异常的设备ID
     * <span>@param</span> <span>pwd</span>   密码（实际开发记得加密）
     * <span>@throws</span> <span><span>IOException</span></span>
     */</span>
    <span>@PostMapping</span><span>(</span>value <span>=</span> <span>"/onReceive"</span><span>)</span>
    <span>public</span> <span>void</span> <span>onReceive</span><span>(</span><span>String</span> id<span>,</span><span>String</span> pwd<span>)</span> <span>throws</span> <span>IOException</span> <span>{</span>
        <span>if</span><span>(</span>pwd<span>.</span><span>equals</span><span>(</span>myPwd<span>)</span><span>)</span><span>{</span>  <span>//密码校验一致（这里举例，实际开发还要有个密码加密的校验的），则进行群发</span>
            webSocketServer<span>.</span><span>broadCastInfo</span><span>(</span>id<span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>

<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="测试" tabindex="-1"> 测试</h2>
<p>1、打开前端页面，进行WebSocket连接</p>
<p>控制台输出，连接成功</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2519868-20211015113024421-1327852737.png" alt="img" loading="lazy"></p>
<p>2、因为是模拟数据，所以全部显示正常，没有异常提交时的页面呈现</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2519868-20211015113143733-1496142658.png" alt="img" loading="lazy"></p>
<p>3、接下来，我们用接口测试工具Postman提交一个异常</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2519868-20211015113458808-127776265.png" alt="img" loading="lazy"></p>
<p><strong>注意id为3的这个数据的状态变化</strong></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/2519868-20211015113537561-246899024.png" alt="img" loading="lazy"></p>
<p>我们可以看到，id为3的王五状态已经变成异常的了，实时通讯成功。</p>
<p>参考：<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WebSocket" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/API/WebSocket</a></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-15T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Windows10使用优化方案</title>
    <id>https://blog.ciberviler.top/pc/Windows10%E4%BD%BF%E7%94%A8%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88.html</id>
    <link href="https://blog.ciberviler.top/pc/Windows10%E4%BD%BF%E7%94%A8%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88.html"/>
    <updated>2022-05-15T12:41:37.000Z</updated>
    <summary type="html">Windows10使用优化方案</summary>
    <content type="html"><![CDATA[<h1 id="windows10使用优化方案" tabindex="-1"> Windows10使用优化方案</h1>
<p>【目录】</p>
<p>一、Windows10系统设置</p>
<ol>
<li>
<p>系统初步设置</p>
</li>
<li>
<p>运用Dism++设置</p>
</li>
<li>
<p>运用OOSU10设置</p>
</li>
<li>
<p>禁用win10更新</p>
</li>
<li>
<p>系统启动项管理</p>
</li>
</ol>
<p>二、软件推荐</p>
<ol>
<li>
<p>系统安全</p>
</li>
<li>
<p>浏览器</p>
</li>
<li>
<p>办公学习</p>
</li>
<li>
<p>下载工具</p>
</li>
<li>
<p>卸载工具</p>
</li>
<li>
<p>常用系统工具</p>
</li>
<li>
<p>日常体验优化/美化</p>
</li>
<li>
<p>视频/音频播放</p>
</li>
<li>
<p>其他</p>
</li>
</ol>
<p>【Windows10系统设置】
\1. 系统初步设置
① 显示——缩放与布局
一般来说124％会比较清晰，但还是看个人设备吧
② 存储——存储感知
将自动释放空间打开</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_c5771b75_6312_9773@704x259.png.m.jpg" alt="img" loading="lazy"></p>
<p>存储感知自动释放设置</p>
<p>③ 剪贴板——历史记录
将剪贴板历史记录打开，可以批量复制
④ WLAN——按流量计费
将连接的WiFi改成已流量计费，据说能限制不必要的后台抢网络<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"></p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_1064ef4b_6312_9775@718x418.png.m.jpg" alt="img" loading="lazy"></p>
<p>按流量计费连接设置</p>
<p>⑤ 传递优化——关闭允许从其他电脑下载</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_97bcc8b6_6312_9777@715x540.png.m.jpg" alt="img" loading="lazy"></p>
<p>传递优化设置</p>
<p>⑥ 禁用Win10特效
此电脑→属性→高级系统设置→性能设置</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_9e4436f0_6312_9779@654x960.png.m.jpg" alt="img" loading="lazy"></p>
<p>禁用win10特效</p>
<p>⑦ 禁用计算机更改消息
更改用户账户控制设置→直接拉到底<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"></p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_39a4fc18_6312_9781@1118x824.png.m.jpg" alt="img" loading="lazy"></p>
<p>禁用计算机更改消息</p>
<p>\2. 运用Dism++设置
一般新电脑到手之后，我们都会系统更新一下（这应该是个漫长的过程），同时C盘的剩余空间也会以肉眼可见的速度减少<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy">，所以在更新完后，我们就需要清理下C盘了<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_57_dogehechi.png" alt="doge呵斥" loading="lazy">
这里我们用到的是Dism++的空间回收功能<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_65_coshuaji.png" alt="cos滑稽" loading="lazy">，反正经过一顿操作，C盘又变成了当初的那个少年<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_65_coshuaji.png" alt="cos滑稽" loading="lazy">
除了Dism++的空间回收，用的更多的是它的系统优化，这里的系统优化选项非常的多，例如修改资源管理器的开始界面、右键菜单管理、关闭快速启动和休眠等等<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"><img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"><img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"></p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_295ed067_6312_9783@1478x1031.png.m.jpg" alt="img" loading="lazy"></p>
<p>Dism++界面</p>
<p>\3. 运用OOSU10设置
OOSU10对win10的设置修改，比Dism++更详细、更全面
因为选项太多了，我一般都是直接应用推荐配置，当然修改之前最好做个备份<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"><img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"><img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"></p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_ba508530_6312_9785@977x722.png.m.jpg" alt="img" loading="lazy"></p>
<p>OOSU10界面</p>
<p>（当然，windows10还有个上帝模式，可以对各项设置进行修改。进入上帝模式的方法：在桌面新建一个文件夹，重命名为
.{ED7BA470-8E54-465E-825C-99712043E01C}，打开即可进入上帝模式<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy">）</p>
<p>\4. 禁用Windows更新
众所周知，windows10俗称bug10，为了避免这个问题，同时也避免很多的features更新，防止C盘占满，我们需要滞后一个win10大版本更新<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_37_doge.png" alt="doge" loading="lazy">
我直接用的是一个小exe程序（windows禁用更新）禁用windows更新（在胡萝卜周上找到的<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_57_dogehechi.png" alt="doge呵斥" loading="lazy">）</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_94d47ca7_6312_9787@511x340.png.m.jpg" alt="img" loading="lazy"></p>
<p>Windows禁用更新界面</p>
<p>\5. 系统启动项管理
随着我们安装软件越来越多，系统启动项也就越来越多
我采用的系统启动项管理方案是：联想电脑管家/火绒 + 系统直接修改，主要是因为系统直接修改比较繁杂，而软件管理有时候也不太全面有效<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_56_dogexiaoku.png" alt="doge笑哭" loading="lazy">
联想电脑管家/火绒就不多说了<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_58_dogeyuanliangta.png" alt="doge原谅ta" loading="lazy">（ps：联想电脑管家采用的也是火绒内核）
这里主要说一下系统直接修改启动项<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_58_dogeyuanliangta.png" alt="doge原谅ta" loading="lazy"></p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_52efc272_6312_9788@447x125.png.m.jpg" alt="img" loading="lazy"></p>
<p>任务管理器修改启动项</p>
<p>有时候关闭一些启动项很容易，直接在任务管理器的启动中禁用就可以，但是当我们需要添加一些小程序的启动项，就显得比较麻烦
这里我采用的方法是：在开机启动文件夹中修改，在运行（win+R）中粘贴以下路径打开
%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
然后，我们直接将软件的快捷方式删除或者添加到这个文件夹中即可<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"><img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"><img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"></p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_bc153a4e_6316_6505@1180x913.png.m.jpg" alt="img" loading="lazy"></p>
<p>开机启动文件夹</p>
<p>————————————————————
【软件推荐】
\1. 系统安全
当然是众所周知的火绒和联想电脑管家（ps：联想电脑管家用的就是火绒内核），而联想电脑管家还有个极速模式，不知道是不是图个心里安慰<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"><img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"><img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"></p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_8109645c_6316_6507@1230x810.png.m.jpg" alt="img" loading="lazy"></p>
<p>联想电脑管家极速模式</p>
<p>当然，如果不用这些，windows defender也足够了</p>
<p>\2. 浏览器
当然是Chromium内核的天下了<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy">，这里推荐Chromium内核的edge，以及chrome
由于在chromium内核的edge推出之前，我已经用了很久的chrome，所以不太想从chrome搬到edge，主要还是因为chrome上的账号同步<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"><img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy"><img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy">
当然还有很多其他chromium内核的浏览器，比如360极速、cent等等，用过了这些之后，我还是选择回到原生chrome，但选的是修改版的chrome++（<a href="https://shuax.com/project/chrome/" target="_blank" rel="noopener noreferrer">查看链接</a>）
在这部分，我再推荐一些个人常用的chrome插件<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_57_dogehechi.png" alt="doge呵斥" loading="lazy">：
① Grammarly for Chrome —— 拼写语法检查纠错</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_56a9d2d1_6316_651@754x168.png.m.jpg" alt="img" loading="lazy"></p>
<p>Grammarly for Chrome</p>
<p>② IDM —— 自动抓取浏览器下载，速度没的说
③ infinity —— 新标签启动页，可以账号同步</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_fa25ce09_6316_6512@640x400.png.m.jpg" alt="img" loading="lazy"></p>
<p>infinity标签页</p>
<p>④ SimpleExtManager —— 插件管理，非常简洁</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_cc30910e_6316_6514@640x400.png.m.jpg" alt="img" loading="lazy"></p>
<p>SimpleExtManager</p>
<p>⑤ Vimium —— 浏览器手势操作，个人喜欢用触摸板</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_3e1f49ec_6316_6516@719x170.png.m.jpg" alt="img" loading="lazy"></p>
<p>Vimium</p>
<p>⑥ 书签侧边栏 —— 因为chrome书签在不显示书签栏的情况下，打开书签栏非常繁琐，所以装了这个插件</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_034502e5_6316_6519@640x400.png.m.jpg" alt="img" loading="lazy"></p>
<p>书签侧边栏</p>
<p>⑦ Google Keep —— 做小记录
⑧ Adblock Plus —— 拦截广告，非常强力</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_d64628df_6316_6521@778x197.png.m.jpg" alt="img" loading="lazy"></p>
<p>Adblock Plus</p>
<p>⑨ bilibili哔哩哔哩下载助手</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_5760b70c_6316_6523@722x177.png.m.jpg" alt="img" loading="lazy"></p>
<p>bilibili哔哩哔哩下载助手</p>
<p>⑩ 购物党自动比价工具 —— 省心</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_a319e44c_6320_7498@640x400.png.m.jpg" alt="img" loading="lazy"></p>
<p>购物党自动比价工具</p>
<p>\3. 办公学习
① office
② Adobe —— 我关注的是微博vposy大佬的更新</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_cb3692a9_6320_75@1080x523.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>微博vposy大佬</p>
<p>③ Notion —— 近两年国内外非常火🔥的软件，记笔记类似OneNote，但功能远超OneNote，个人两个都在用<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_58_dogeyuanliangta.png" alt="doge原谅ta" loading="lazy"></p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_195957aa_6320_7502@1920x1200.png.m.jpg" alt="img" loading="lazy"></p>
<p>Notion界面</p>
<p>④ Xmind —— 思维导图，网页端我用的是processon</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_fce20919_6320_7503@2760x1681.png.m.jpg" alt="img" loading="lazy"></p>
<p>Xmind界面</p>
<p>⑤ Mathpix —— 数学公式识别</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_d37f6520_6320_7505@1920x1110.png.m.jpg" alt="img" loading="lazy"></p>
<p>Mathpix</p>
<p>⑥ MathType —— 数学公式编辑</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_e17f8206_6320_7507@1920x1116.png.m.jpg" alt="img" loading="lazy"></p>
<p>MathType</p>
<p>\4. 下载工具
① IDM —— 不多说了，我直接入的正版<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_58_dogeyuanliangta.png" alt="doge原谅ta" loading="lazy"></p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_102da777_6320_7509@1199x668.png.m.jpg" alt="img" loading="lazy"></p>
<p>IDM界面</p>
<p>② 迅雷X —— 主要用于磁力链接</p>
<p>\5. 卸载工具
① IObit Uninstaller —— 卸载后自动删除注册表，已入正<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_58_dogeyuanliangta.png" alt="doge原谅ta" loading="lazy"></p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_a9bbae4d_6320_751@1413x975.png.m.jpg" alt="img" loading="lazy"></p>
<p>IObit Uninstaller界面</p>
<p>② Geek Uninstaller</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_26e3e050_6320_7512@480x600.png.m.jpg" alt="img" loading="lazy"></p>
<p>Geek Uninstaller界面</p>
<p>\6. 常用系统工具
① CCleaner —— 可以清理注册表</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_0eab5881_6324_4217@1920x1220.png.m.jpg" alt="img" loading="lazy"></p>
<p>CCleaner界面</p>
<p>② Dism++
③ IObit Unlocker —— 主要用于解锁那些临时删除或修改不了的文件</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_270c5b49_6324_4219@839x439.png.m.jpg" alt="img" loading="lazy"></p>
<p>IObit Unlocker界面</p>
<p>\7. 日常体验优化/美化
① 鼠标指针外观修改
个人比较喜欢deepin的鼠标指针<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_63_liuhanhuaji.png" alt="流汗滑稽" loading="lazy"></p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_6a7ec53a_6324_4221@725x815.png.m.jpg" alt="img" loading="lazy"></p>
<p>鼠标指针外观修改</p>
<p>② 任务栏外观修改
主要可以采用TranslucentTB和StartlsBack++修改
③ 腾讯桌面Lite版
④ flux —— 在晚上自动开启护眼模式，帮助入眠</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_46b19b64_6324_4223@1436x836.png.m.jpg" alt="img" loading="lazy"></p>
<p>flux界面</p>
<p>⑤ Snipaste —— 比win10自带截图好，我用的最多的是截图置顶，还有截图标注等功能</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_013fb289_6324_4225@1920x1115.png.m.jpg" alt="img" loading="lazy"></p>
<p>Snipaste</p>
<p>⑥ T-Clock —— 自定义任务栏上的日期时间的显示方式</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_049f0e2c_6324_4227@181x60.png.m.jpg" alt="img" loading="lazy"></p>
<p>T-Clock任务栏效果图</p>
<p>⑦ TrafficMonitor —— 实时显示上下载、CPU和内存</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_e304762d_6324_4228@210x60.png.m.jpg" alt="img" loading="lazy"></p>
<p>TrafficMonitor任务栏效果图</p>
<p>⑧ Mem Reduct —— 任务栏上非常简洁的内存释放小程序</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_b8608c40_6324_423@506x576.png.m.jpg" alt="img" loading="lazy"></p>
<p>Mem Reduct界面</p>
<p>⑨ QuickLook —— windows文件快速预览</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_6b156f03_6324_4232@1363x630.png.m.jpg" alt="img" loading="lazy"></p>
<p>QuickLook</p>
<p>\8. 视频/音频播放
① MPC - HC</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_e1840cf2_6327_9864@507x446.png.m.jpg" alt="img" loading="lazy"></p>
<p>MPC - HC界面</p>
<p>② Potplayer</p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_2da0853b_6327_9866@537x404.png.m.jpg" alt="img" loading="lazy"></p>
<p>Potplayer界面</p>
<p>\9. 其他
① 酷安UWP<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_67_mojinghuaji.png" alt="墨镜滑稽" loading="lazy"><img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_67_mojinghuaji.png" alt="墨镜滑稽" loading="lazy"><img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_67_mojinghuaji.png" alt="墨镜滑稽" loading="lazy"></p>
<p><img src="http://image.coolapk.com/feed/2020/0720/17/2936601_9efdabfd_6327_9867@1536x1200.png.m.jpg" alt="img" loading="lazy"></p>
<p>酷安UWP界面</p>
<p>② 欧路词典
③ TeamViewer —— 远程桌面连接</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="pc" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-13T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">win10-11皆可干货分享</title>
    <id>https://blog.ciberviler.top/pc/win10-11%E7%9A%86%E5%8F%AF%E5%B9%B2%E8%B4%A7%E5%88%86%E4%BA%AB.html</id>
    <link href="https://blog.ciberviler.top/pc/win10-11%E7%9A%86%E5%8F%AF%E5%B9%B2%E8%B4%A7%E5%88%86%E4%BA%AB.html"/>
    <updated>2022-05-15T12:40:26.000Z</updated>
    <summary type="html">win10-11皆可干货分享</summary>
    <content type="html"><![CDATA[<h1 id="win10-11皆可干货分享" tabindex="-1"> win10-11皆可干货分享</h1>
<p>Ps.图文可能比较长且有部分软件可能较为难以获得，基本上都会有相关连接陪着一起fly....<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_64_shounuehuaji.png" alt="受虐滑稽" loading="lazy">
🍵建议先收藏.jpg
1-9❄️商城uwp🦉
10-23❄️快乐软🦉
24-30❄️可食用网站以及一些还行的插件🦉
31-32❄️个人收藏项🦉</p>
<p>盯——————————
一、商城uwp<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_32_heiha.png" alt="嘿哈" loading="lazy"></p>
<p>1.Tile Genie (直接在微软商城搜索即可)这是一个美化win10开始菜单的软件₍ᐢ⸝⸝› ̫ ‹⸝⸝ᐢ₎</p>
<p>个人未升11前没有出现相关bug现象（11升后是没有磁贴了)</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_d2070f52_8557_0966@1121x818.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>微软商城内截图</p>
<p>⒉哗哩哗哩漫画UwP(直接在微软商城搜索即可)</p>
<p>可直接B站账号登录，点击头像可每日签到，客户端目前还处于预览阶段，功能尚不完整，但也已满足基本需求（很流畅)</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_90a303eb_8557_0968@1121x818.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>微软商城内截图</p>
<p>3.酷安uwp(商城未上架)
部分内容未完善但是可登陆可查看</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_8b7e9fa8_8557_097@1582x938.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>path↓</p>
<p>[<a href="https://github.com/Tangent-90/Coolapk-uwP/releases/tag/v2.1.38" target="_blank" rel="noopener noreferrer">链接]Release Coolapk UWP...</a></p>
<p>4.Snipaste(直接在微软商城搜索即可)截图＋贴图，提升你的工作效率!</p>
<p>Snipaste提供强大易用的截图、贴图以及图片标注功能，拥有丰富的自定义选项，满足你的各种需求。
(—般你可能记不住win+shift+s这个自带快捷键2333333)</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_69c441b6_8557_0972@1121x818.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>微软商城内截图</p>
<p>5.ModernFlyouts (Preview)(直接在微软商城搜索即可)
评论区已经被快乐基友们霸占了√</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_e81ae5c5_8557_0973@1121x818.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>微软商城内截图</p>
<p>6.NGA玩家社区·第三方（直接在微软商城搜索即可)</p>
<p>NGA玩家社区的第三方UWP，NGA玩家社区是国内知名的游戏论坛，其官方网址为: <a href="https://bbs.nga.cn/" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_dbd15029_8557_0975@1121x818.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>微软商城内截图</p>
<p>7.搜图神器（直接在微软商城搜索即可)</p>
<p>一款装机必备的海量图库应用，支持图片搜索、以图搜图、动态壁纸、自动换壁纸等核心有趣功能。聚合全网主流搜索引擎，提供丰富的各类高清图片...</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_fbc3c138_8557_0977@1121x818.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>微软商城内截图</p>
<p>8.PowerToys(需要在git下载)</p>
<p>Microsoft PowerToys是一组实用程序，以供高级用户调整和优化他们的Windows体验，从而提高工作效率。由Microsoft和PowerToys社区用制作。(这是一款近乎无敌的微软官方推荐的电脑插件，特别对于需要经常更改窗口大小的朋友√)</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_55ec2e76_8557_0979@1180x860.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>应用截图</p>
<p>path：<a href="https://github.com/microsoft/PowerToys" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p>9.OneNote (基本上电脑是自带的)</p>
<p>用过的人都知道one的快乐qwq
office快乐桶</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_1b52ad6d_8557_098@1042x672.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>应用截图</p>
<p>盯——————————</p>
<p>二、快乐软<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_32_heiha.png" alt="嘿哈" loading="lazy"></p>
<p>10.aimp</p>
<p>AIMP(Artem Izmaylov Media Player)是一款来自俄罗斯的免费专业级音频播放器，除了播放器基本的音频播放之外，还提供了音频转换、标签编辑、录制广播等功能。播放器界面相当友好易用，占用系统资源较少且安装包也不是很大。(相关皮肤也很好看)</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_05d04e92_8563_1224@1012x677.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>应用截图</p>
<p>path↓</p>
<p>[<a href="https://www.aimp.ru/" target="_blank" rel="noopener noreferrer">链接]AIMP</a></p>
<p>11.MusicPlayer2 (一款歌词可以在小娜搜索框显示歌词，总之就是很小清新√）
相关文章介绍: <a href="https://zhuanlan.zhihu.com/p/102213463" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_c38b620b_8563_1226@698x565.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>应用截图</p>
<p>path：<a href="https://github.com/zhongyang219/MusicPlayer2/releases" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p>12.Mp3tag(是一款MP3文件ID3-Tag信息修改器)</p>
<p>所谓ID3-Tag信息，就是在MP3文件中加入曲名、演唱者、专集、年月、流派、注释等信息，便于您收集歌曲。</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_ecedf037_8563_1228@1100x750.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>应用截图</p>
<p>path↓</p>
<p>[<a href="https://www.mp3tag.de/" target="_blank" rel="noopener noreferrer">链接]Mp3tag - der univers...</a></p>
<p>13.Migi(可以轻松地记录个人日记、阅读观影笔记、管理个人日常事务等)</p>
<p>界面很简洁非常小清新，移动端也有√</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_86328f38_8563_1229@1142x798.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>应用官网</p>
<p>path↓</p>
<p>[<a href="https://focusapp.ink/" target="_blank" rel="noopener noreferrer">链接]专注笔记(Focus Note) - 精...</a></p>
<p><a href="http://www.coolapk.com/apk/cn.com.focus.migi" target="_blank" rel="noopener noreferrer">【Migi】</a></p>
<p>14.羽雀（语雀，一只能言善语的云雀，伴随大家在「知识的世界里」欢快翱翔)</p>
<p>「语雀」是一个「专业的云端知识库」，孵化自蚂蚁集团，是体验科技理念下的一款创新产品，已是10万阿里员工进行文档编写、知识沉淀的标配。</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_63f0fe8a_8563_1231@911x797.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>官网截图</p>
<p>path↓</p>
<p>[<a href="https://www.yuque.com/" target="_blank" rel="noopener noreferrer">链接]语雀 - 专业的云端知识库 · 语雀</a></p>
<p>15.sublime Text(是一款和vsc一样快乐的编辑器√)
Sublime Text是一款流行的代码编辑器软件，也是HTML和散文先进的文本编辑器，可运行在Linux，Windows和Mac OS X。也是许多程序员喜欢使用的一款文本编辑器软件。</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_8be0abc6_8563_1233@797x652.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>应用截图</p>
<p>path↓</p>
<p>[<a href="http://www.sublimetext.com/" target="_blank" rel="noopener noreferrer">链接]Sublime Text - Text...</a></p>
<p>16.uTools(自由集成丰富插件，和Quicker功能类似)
【这里的部分功能在上面的PowerToys也有，依自己喜好选择——当然要是全下了也没事233就是你的快捷键或者是鼠标会被疯狂占用23333】
uTools path：<a href="https://u.tools/" target="_blank" rel="noopener noreferrer">查看链接</a>
Quicker path：<a href="https://getquicker.net/" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_2dfda1d3_8563_1235@802x602.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>uTools应用截图</p>
<p>17.Directory opus (pro)——布局灵活的文件管理，支持文件预览，强烈推荐!!!</p>
<p>基本上用过的朋友可能都会离不开他（咱也不知道为啥，就两个字:方便)有免费试用30-60天再决定个人是否继续试用(但是过期了莫得用了且卸载有点麻烦√)</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_7790f81c_8563_1236@1010x876.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>官网截图</p>
<p>请多多支持正版↓</p>
<p>[<a href="https://www.gpsoft.com.au/" target="_blank" rel="noopener noreferrer">链接]Directory Opus</a></p>
<p>所以这边是小窗口↓
链接: <a href="https://xn--pan-go6aq760j.baidu.xn--com-ho6aq760j/s/1XVV%E2%9D%84%EF%B8%8FJHYwO4l37gW_n%E2%9D%84%EF%B8%8FGFCpTw" target="_blank" rel="noopener noreferrer">https://❄️pan.baidu.c❄️om/s/1XVV❄️JHYwO4l37gW_n❄️GFCpTw</a> 提取码: oeby
(图中主题也在连接中自行选择，切记一定要按图片中安装√)</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_e54b615b_8563_1238@1309x917.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>个人使用截图</p>
<p>配合Listary最为非常快乐（不管你是否下载Directory opus还是使用原来的资源管理器也同样很快乐)
Listary path: <a href="https://www.listary.com/" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p>原来的资源管理器可配合的QTTabBar：<a href="http://qttabbar.wikidot.com/" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_9099022d_8569_3837@984x665.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>红框为QTTabBar安装后效果</p>
<p>18.everything(总是忘记东西在哪里的小朋友的福音)支持预览功能且查询能力强大，不占内存。
path: <a href="https://www.voidtools.com/zh-cn/" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_753dacf9_8569_3839@880x621.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>应用截图</p>
<p>19.盘姬工具箱（一款大集合软件使用很方便)
path: <a href="https://xn--pan-go6aq760j.baidu.xn--com-go6aq760j/s/1F4icZIZZMis%E2%9D%84%EF%B8%8F8qmuxK6F%E2%9D%84%EF%B8%8Fx7Q" target="_blank" rel="noopener noreferrer">https://❄️pan.baidu.❄️com/s/1F4icZIZZMis❄️8qmuxK6F❄️x7Q</a> 提取码:u6oq</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_0076fd46_8569_3841@746x549.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>应用内截图</p>
<p>20.UninstallTool(强大的电脑清理卸载软件)很直观就是卸载要干哈都写在上面了√
path: <a href="https://crystalidea.com/uninstall-tool/download" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_040f236a_8569_3843@868x593.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>应用内截图</p>
<p>21.腾讯电脑管家-桌面整理
正如其名（但是可能会比较耗内存)
path↓</p>
<p>[<a href="https://guanjia.qq.com/product/zmzl/" target="_blank" rel="noopener noreferrer">链接]桌面整理_桌面整理软件_一键桌面整理工具...</a></p>
<p>22.格式工厂(转换快乐宝)
path: <a href="http://www.pcfreetime.com/formatfactory/CN/index.html" target="_blank" rel="noopener noreferrer">www.pcfreetime.com/formatfactory/CN/index.html</a>
隔壁图片工厂: <a href="http://www.pcfreetime.com/picosmos/index.php?language=zh" target="_blank" rel="noopener noreferrer">www.pcfreetime.com/picosmos/index.php?language=zh</a></p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_91623f4c_8569_3844@1150x716.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>应用内截图</p>
<p>23.TrafficMonitor</p>
<p>Traffic Monitor是一款用于Windows平台的网速监控悬浮窗软件，可以显示当前网速、CPu及内存利用率，支持嵌入到任务栏显示，支持更换皮肤、历史流量统计等功能。</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_b6629f83_8569_3846@728x478.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>path↓</p>
<p>[<a href="https://github.com/zhongyang219/TrafficMonitor" target="_blank" rel="noopener noreferrer">链接]GitHub - zhongyang21...</a></p>
<p>盯——————————
三、可食用网站以及一些还行的插件<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_32_heiha.png" alt="嘿哈" loading="lazy"></p>
<p>24.AdGuard 广告拦截器</p>
<p>基本上所有浏览器都有相关插件，挺香的√
path: <a href="https://adguard.com/zh_cn/welcome.html" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_4392c12b_8569_3848@1144x794.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>官网截图</p>
<p>25.Black Menu for Google™(一款很好的谷歌集成插件√)
edge、火狐、谷歌、opera、星愿都有该插件(直接扩展寻找)</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_d24c4f1a_8569_385@1113x704.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>edge扩展截图</p>
<p>26.iGG谷歌访问助手（浏览器扩展寻找)</p>
<p>永久免费提供访问google搜索，gmail，谷歌学术搜索等谷歌产品新增微软onedrive免费加速。
无需注册打开立即使用。*不包含Youtube谷歌Drive</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_667ac6f6_8569_3851@1110x709.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>edge扩展截图</p>
<p>27.哗哩哗哩助手: bilibili.com综合辅助扩展(微软谷歌扩展中有)非常实用的破站插件√</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_03b24d1a_8574_4748@1072x711.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>官网截图</p>
<p>path↓</p>
<p>[<a href="https://bilibilihelper.com/" target="_blank" rel="noopener noreferrer">链接]哔哩哔哩助手 - 视频下载助手 Bili...</a></p>
<p>28.简约simpread (如杂志般沉浸式阅读体验的扩展)</p>
<p>喜欢在网站看小说或者看一些排版可能不太适合自己的同学可以用这款插件美化√各大浏览器插件扩展中可找到
path: <a href="https://simpread.pro/" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_3bb55027_8574_475@1140x794.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>官网截图</p>
<p>29.saladict沙拉查词（浏览器快乐查词插件)扩展中心寻找。
path: <a href="https://saladict.crimx.com/" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_f917930d_8574_4752@1132x765.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>官网截图</p>
<p>30.Infinity新标签页(Pro)
lnfinity新标签页Pro让你可以自定义你的新标签页(各大浏览器扩展中可寻找)</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_fa7a0a46_8574_4754@952x1021.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>部署界面</p>
<p>盯——————————
有关网站推荐emmmm感觉有趣的<img src="http://static.coolapk.com/emoticons/v9/coolapk_emotion_32_heiha.png" alt="嘿哈" loading="lazy"></p>
<p>31.听一听（很小清新的环境)每次打开都是不一样的氛围忠</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_189c221f_8574_4755@1154x796.jpeg.m.jpg" alt="img" loading="lazy"></p>
<p>网站截图</p>
<p>path↓</p>
<p>[<a href="https://wangpinpin.com/Music" target="_blank" rel="noopener noreferrer">链接]小破站 - 舔狗日记|每日一文|www....</a></p>
<p>32.有关电脑美化的一些网站:
致美化: <a href="https://zhutix.com/" target="_blank" rel="noopener noreferrer">查看链接</a>
萌研社: <a href="http://www.pcmoe.net" target="_blank" rel="noopener noreferrer">www.pcmoe.net</a>
若枫主题社: <a href="https://winmoes.com/index.php" target="_blank" rel="noopener noreferrer">查看链接</a></p>
<p>33.个人收藏项:
eixexal(懂的都懂√)
path: 47.95.218.243/index.html</p>
<p><img src="http://image.coolapk.com/feed/2021/0726/05/1239612_faf7be70_8574_4757@1403x895.jpeg.m.jpg" alt="img" loading="lazy"></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="pc" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-11T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">IDEA 206个快捷键 动图演示</title>
    <id>https://blog.ciberviler.top/dev/IDEA206%E4%B8%AA%E5%BF%AB%E6%8D%B7%E9%94%AE-%E5%8A%A8%E5%9B%BE%E6%BC%94%E7%A4%BA.html</id>
    <link href="https://blog.ciberviler.top/dev/IDEA206%E4%B8%AA%E5%BF%AB%E6%8D%B7%E9%94%AE-%E5%8A%A8%E5%9B%BE%E6%BC%94%E7%A4%BA.html"/>
    <updated>2022-05-13T15:37:31.000Z</updated>
    <summary type="html">IDEA 206个快捷键 动图演示</summary>
    <content type="html"><![CDATA[<h1 id="idea-206个快捷键-动图演示" tabindex="-1"> IDEA 206个快捷键 动图演示</h1>
<p><img src="https://img-blog.csdnimg.cn/img_convert/9e911fdfd9d07a3c026a9c504d1db1f5.png" alt="img" loading="lazy"></p>
<p>本文参考了 IntelliJ IDEA 的官网，列举了IntelliJ IDEA（Windows 版）的所有快捷键。并在此基础上，为 90% 以上的快捷键提供了动图演示，能够直观的看到操作效果。</p>
<p>该快捷键共分 16 种，可以方便的按各类查找自己需要的快捷键~~</p>
<h2 id="part1一、构建-编译" tabindex="-1"> Part1一、构建/编译</h2>
<h4 id="_1ctrl-f9-构建项目" tabindex="-1"> 1<code>Ctrl + F9</code>：构建项目</h4>
<blockquote>
<p>该快捷键，等同于菜单【Build】—&gt;【Build Project】</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/img_convert/346acf6147e22ba519de5957b989903f.png" alt="img" loading="lazy"></p>
<p>执行该命令后，IntelliJ IDEA 会编译项目中所有类，并将编译结果输出到<code>out</code>目录中。IntelliJ IDEA 支持增量构建，会在上次构建的基础上，仅编译修改的类。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/745c1bb01533faf4e4c703484edaa237.gif" alt="img" loading="lazy"></p>
<h4 id="_2ctrl-shift-f9-重新编译当前类" tabindex="-1"> 2<code>Ctrl + Shift + F9</code>：重新编译当前类</h4>
<blockquote>
<p>该快捷键，等同于菜单【Build】—&gt;【Recompile ‘class name’】</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/img_convert/d7290ad52882e3f6effc232ad8003eea.png" alt="img" loading="lazy"></p>
<p>在IntelliJ IDEA 中打开要编译的类，执行该命令会编译当前类。</p>
<h2 id="part2二、文本编辑" tabindex="-1"> Part2二、文本编辑</h2>
<h4 id="_3ctrl-x-剪切" tabindex="-1"> 3<code>Ctrl + X</code>：剪切</h4>
<p>剪切选中文本，若未选中则剪切当前行。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/843d4485c02c08bd306ed102cab663a7.gif" alt="img" loading="lazy"></p>
<h4 id="_4ctrl-c-复制" tabindex="-1"> 4<code>Ctrl + C</code>：复制</h4>
<p>复制选中文本，若未选中则复制当前行。</p>
<h4 id="_5ctrl-v-粘贴" tabindex="-1"> 5<code>Ctrl + V</code>：粘贴</h4>
<h4 id="_6ctrl-alt-shift-v-粘贴为纯文本" tabindex="-1"> 6<code>Ctrl + Alt + Shift + V</code>：粘贴为纯文本</h4>
<h4 id="_7ctrl-shift-v-从历史选择粘贴" tabindex="-1"> 7<code>Ctrl + Shift + V</code>：从历史选择粘贴</h4>
<p>从历史剪粘版中选择要粘贴的内容。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/f8051942a7de52785881838e25e309bd.gif" alt="img" loading="lazy"></p>
<h4 id="_8ctrl-d-复制行" tabindex="-1"> 8<code>Ctrl + D</code>：复制行</h4>
<p>复制光标所在行。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/d4264a2a8ffe436ffc401e0f161d9ade.gif" alt="img" loading="lazy"></p>
<h4 id="_9ctrl-shift-c-复制文件路径" tabindex="-1"> 9<code>Ctrl + Shift + C</code>：复制文件路径</h4>
<p>复制选中文件所在路径。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/2188102f6b93518221bf19786aabdc1a.gif" alt="img" loading="lazy"></p>
<h4 id="_10ctrl-alt-shift-c-复制引用" tabindex="-1"> 10<code>Ctrl + Alt + Shift + C</code>：复制引用</h4>
<p>复制包的路径，或者类的名称。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/44eb712dd6f9c5eb875e6074a04fa42f.gif" alt="img" loading="lazy"></p>
<h4 id="_11ctrl-s-保存全部" tabindex="-1"> 11<code>Ctrl + S</code>：保存全部</h4>
<h4 id="_12ctrl-z-撤销" tabindex="-1"> 12<code>Ctrl + Z</code>：撤销</h4>
<p>撤销上一步操作内容。</p>
<h4 id="_13ctrl-shift-z-重做" tabindex="-1"> 13<code>Ctrl + Shift + Z</code>：重做</h4>
<p>恢复上一步撤销内容。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5e2550a0878bc37add1bd0f325afb445.gif" alt="img" loading="lazy"></p>
<h4 id="_14tab-缩进" tabindex="-1"> 14<code>Tab</code>：缩进</h4>
<h4 id="_15shift-tabl-取消缩进" tabindex="-1"> 15<code>Shift + Tabl</code>：取消缩进</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/db3c423425a1006e3b67ab2cf0866a3c.gif" alt="img" loading="lazy"></p>
<h4 id="_16ctrl-alt-i-自动缩进行" tabindex="-1"> 16<code>Ctrl + Alt + I</code>：自动缩进行</h4>
<p>自动缩进至规范位置。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/74fa2918afa2a29d3c7621c1f061ac6f.gif" alt="img" loading="lazy"></p>
<h4 id="_17shift-enter-开始新行" tabindex="-1"> 17<code>Shift + Enter</code>：开始新行</h4>
<p>无论光标是否在行尾，都开始新的行。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/2fd2993522c2baea25159cb21d70d3b5.gif" alt="img" loading="lazy"></p>
<h4 id="_18ctrl-alt-enter-在当前行之前开始新行" tabindex="-1"> 18<code>Ctrl + Alt + Enter</code>：在当前行之前开始新行</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/63fbbe552744dfde649df43a1e50c4ac.gif" alt="img" loading="lazy"></p>
<h4 id="_19ctrl-y-删除行" tabindex="-1"> 19<code>Ctrl + Y</code>：删除行</h4>
<p>删除当前行。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/3223eb97f4d2ab9b912316399547aed6.gif" alt="img" loading="lazy"></p>
<h4 id="_20ctrl-shift-u-大小写转换" tabindex="-1"> 20<code>Ctrl + Shift + U</code>：大小写转换</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/79f15016de1962b1d49583bc9a39a220.gif" alt="img" loading="lazy"></p>
<h4 id="_21ctrl-alt-shift-insert-创建临时文件" tabindex="-1"> 21<code>Ctrl + Alt + Shift + Insert</code>：创建临时文件</h4>
<p>可以创建各种类型的临时文件，该临时文件不会保存到磁盘中。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/6478b20ba3126fe4ba231377ecbd7df1.gif" alt="img" loading="lazy"></p>
<h4 id="_22shift-f4-在新窗口中打开" tabindex="-1"> 22<code>Shift + F4</code>：在新窗口中打开</h4>
<p>在新窗口打开当前文件。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/3891eaca7497e6363659e52087780dde.gif" alt="img" loading="lazy"></p>
<h2 id="part3三、光标操作" tabindex="-1"> Part3三、光标操作</h2>
<h4 id="_23ctrl-left-左移一个单词" tabindex="-1"> 23<code>Ctrl + Left</code>：左移一个单词</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/4f8b3739300460392434d28a2ab7d5a2.gif" alt="img" loading="lazy"></p>
<h4 id="_24ctrl-right-右移一个单词" tabindex="-1"> 24<code>Ctrl + Right</code>：右移一个单词</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/54a6b814863df5b78225f7b9c7bec8a4.gif" alt="img" loading="lazy"></p>
<h4 id="_25home-移动至行首" tabindex="-1"> 25<code>Home</code>：移动至行首</h4>
<h4 id="_26end-移动至行尾" tabindex="-1"> 26<code>End</code>：移动至行尾</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/7544ec020aed0601b12bff01407203c7.gif" alt="img" loading="lazy"></p>
<h4 id="_27ctrl-shift-m-移动至大括号" tabindex="-1"> 27<code>Ctrl + Shift + M</code>：移动至大括号</h4>
<p>多次按下快捷键，可以在左右两个大括号间切换。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/b26200d3cb503339ec1605c6d59b4565.gif" alt="img" loading="lazy"></p>
<h4 id="_28ctrl-移动至代码块开始" tabindex="-1"> 28<code>Ctrl + [</code>：移动至代码块开始</h4>
<h4 id="_29ctrl-移动至代码块末尾" tabindex="-1"> 29<code>Ctrl + ]</code>：移动至代码块末尾</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/76c4141293796714c5a8e1d8db441b6f.gif" alt="img" loading="lazy"></p>
<h4 id="_30alt-down-下一个方法" tabindex="-1"> 30<code>Alt + Down</code>：下一个方法</h4>
<h4 id="_31alt-up-上一个方法" tabindex="-1"> 31<code>Alt + Up</code>：上一个方法</h4>
<h4 id="_32ctrl-pageup-移动至页面顶部" tabindex="-1"> 32<code>Ctrl + PageUp</code>：移动至页面顶部</h4>
<h4 id="_33ctrl-pagedown-移动至页面底部" tabindex="-1"> 33<code>Ctrl + PageDown</code>：移动至页面底部</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/8ec8f52a924e547a6a3e4d22b6996a0d.gif" alt="img" loading="lazy"></p>
<h4 id="_34pageup-向上翻页" tabindex="-1"> 34<code>PageUp</code>：向上翻页</h4>
<h4 id="_35pagedown-向下翻页" tabindex="-1"> 35<code>PageDown</code>：向下翻页</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/24d6edbe7c5755d24c24b801de04672f.gif" alt="img" loading="lazy"></p>
<h4 id="_36ctrl-home-移动至文件开头" tabindex="-1"> 36<code>Ctrl + Home</code>：移动至文件开头</h4>
<h4 id="_37ctrl-end-移动至文件末尾" tabindex="-1"> 37<code>Ctrl + End</code>：移动至文件末尾</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/328e4be0c2750ac2a1acea7703c2cc59.gif" alt="img" loading="lazy"></p>
<h2 id="part4四、文本选择" tabindex="-1"> Part4四、文本选择</h2>
<h4 id="_38ctrl-a-全选" tabindex="-1"> 38<code>Ctrl + A</code>：全选</h4>
<h4 id="_39shift-left-向左选择" tabindex="-1"> 39<code>Shift + Left</code>：向左选择</h4>
<h4 id="_40shift-right-向右选择" tabindex="-1"> 40<code>Shift + Right</code>：向右选择</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/684fcfcd0c006d302fee39b7c478dec6.gif" alt="img" loading="lazy"></p>
<h4 id="_41ctrl-shift-left-向左选择一个单词" tabindex="-1"> 41<code>Ctrl + Shift + Left</code>：向左选择一个单词</h4>
<h4 id="_42ctrl-shift-right-向右选择一个单词" tabindex="-1"> 42<code>Ctrl + Shift + Right</code>：向右选择一个单词</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/21647c787bca2963e1ad2bb6b4757182.gif" alt="img" loading="lazy"></p>
<h4 id="_43shift-home-向左选择至行头" tabindex="-1"> 43<code>Shift + Home</code>：向左选择至行头</h4>
<h4 id="_44shift-end-向右选择至行尾" tabindex="-1"> 44<code>Shift + End</code>：向右选择至行尾</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/9449d7063c38d9814a1d4629caccd103.gif" alt="img" loading="lazy"></p>
<h4 id="_45shift-up-向上选择" tabindex="-1"> 45<code>Shift + Up</code>：向上选择</h4>
<h4 id="_46shift-down-向下选择" tabindex="-1"> 46<code>Shift + Down</code>：向下选择</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/6a8b14017ac8a76a3d6c71d6d5dde3f9.gif" alt="img" loading="lazy"></p>
<h4 id="_47ctrl-shift-选择至代码块开头" tabindex="-1"> 47<code>Ctrl + Shift + [</code>：选择至代码块开头</h4>
<h4 id="_48ctrl-shift-选择至代码块结尾" tabindex="-1"> 48<code>Ctrl + Shift + ]</code>：选择至代码块结尾</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/f59e177216118277ec51c09e18868489.gif" alt="img" loading="lazy"></p>
<h4 id="_49ctrl-shift-pageup-选择至页面顶部" tabindex="-1"> 49<code>Ctrl + Shift + PageUp</code>：选择至页面顶部</h4>
<h4 id="_50ctrl-shift-pagedown-选择至页面底部" tabindex="-1"> 50<code>Ctrl + Shift + PageDown</code>：选择至页面底部</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/ee8f743d255de133144f0025262a168e.gif" alt="img" loading="lazy"></p>
<h4 id="_51shift-pageup-向上翻页选择" tabindex="-1"> 51<code>Shift + PageUp</code>：向上翻页选择</h4>
<h4 id="_52shift-pagedown-向下翻页选择" tabindex="-1"> 52<code>Shift + PageDown</code>：向下翻页选择</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/7b1ff158c44db229eb22974e39382563.gif" alt="img" loading="lazy"></p>
<h4 id="_53ctrl-shift-home-选择至文件开关" tabindex="-1"> 53<code>Ctrl + Shift + Home</code>：选择至文件开关</h4>
<h4 id="_54ctrl-shift-end-选择至文件结尾" tabindex="-1"> 54<code>Ctrl + Shift + End</code>：选择至文件结尾</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/20e723b49706696276afb5ce74a71199.gif" alt="img" loading="lazy"></p>
<h4 id="_55ctrl-w-扩展选择" tabindex="-1"> 55<code>Ctrl + W</code>：扩展选择</h4>
<h4 id="_56ctrl-shift-w-收缩选择" tabindex="-1"> 56<code>Ctrl + Shift + W</code>：收缩选择</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/567cc3561ef5d6a1d684655f4d3d0ca5.gif" alt="img" loading="lazy"></p>
<h2 id="part5五、代码折叠" tabindex="-1"> Part5五、代码折叠</h2>
<h4 id="_57ctrl-numpad-展开代码块" tabindex="-1"> 57<code>Ctrl + NumPad+</code>：展开代码块</h4>
<h4 id="_58ctrl-numpad-折叠代码块" tabindex="-1"> 58<code>Ctrl + NumPad-</code>：折叠代码块</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/668c74c8c698bf6813aa0513c2a546dd.gif" alt="img" loading="lazy"></p>
<h4 id="_59ctrl-alt-numpad-递归展开" tabindex="-1"> 59<code>Ctrl + Alt + NumPad+</code>：递归展开</h4>
<h4 id="_60ctrl-alt-numpad-递归折叠" tabindex="-1"> 60<code>Ctrl + Alt + NumPad-</code>：递归折叠</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/4d17fefa9d88ed85b51ba9fbe42f4c48.gif" alt="img" loading="lazy"></p>
<h4 id="_61ctrl-shift-numpad-全部展开" tabindex="-1"> 61<code>Ctrl + Shift + NumPad+</code>：全部展开</h4>
<h4 id="_62ctrl-shift-numpad-全部折叠" tabindex="-1"> 62<code>Ctrl + Shift + NumPad-</code>：全部折叠</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5c43083793af2126d6e9092aa2bc36db.gif" alt="img" loading="lazy"></p>
<h4 id="_63ctrl-折叠选择" tabindex="-1"> 63<code>Ctrl + .</code>：折叠选择</h4>
<h2 id="part6六、多个插入符号和范围选择" tabindex="-1"> Part6六、多个插入符号和范围选择</h2>
<h4 id="_64alt-shift-click-添加-删除插入符号" tabindex="-1"> 64<code>Alt + Shift + Click</code>：添加/删除插入符号</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/af9362c349d4e0317ffeaa0e8ce7b9a4.gif" alt="img" loading="lazy"></p>
<h4 id="_65alt-shift-insert-切换列选择模式" tabindex="-1"> 65<code>Alt + Shift + Insert</code>：切换列选择模式</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/d236737b13a6a636c4d8c55cebdedd74.gif" alt="img" loading="lazy"></p>
<h4 id="_66双击ctrl-up-向上克隆插入符号" tabindex="-1"> 66双击<code>Ctrl</code> + <code>Up</code>：向上克隆插入符号</h4>
<p>按<code>Ctrl</code>键两次，然后在不松开的情况下按向上箭头键。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/55034334c6a85169eefe3ff1a1aad788.gif" alt="img" loading="lazy"></p>
<h4 id="_67双击ctrl-down-向下克隆插入符号" tabindex="-1"> 67双击<code>Ctrl</code> + <code>Down</code>：向下克隆插入符号</h4>
<p>按<code>Ctrl</code>键两次，然后在不松开的情况下按向下箭头键。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/dae4bc316b11af041bdfbae752f35f94.gif" alt="img" loading="lazy"></p>
<h4 id="_68alt-shift-g-将插入符号添加到选择中的每一行" tabindex="-1"> 68<code>Alt + Shift + G</code>：将插入符号添加到选择中的每一行</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/a0d8e1041d61a925f1fbf204715004c9.gif" alt="img" loading="lazy"></p>
<h4 id="_69alt-j-选择单位下次出现的位置" tabindex="-1"> 69<code>Alt + J</code>：选择单位下次出现的位置</h4>
<h4 id="_70alt-shift-j-取消最后一次选择" tabindex="-1"> 70<code>Alt + Shift + J</code>：取消最后一次选择</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/2c9dd9eac04e3f97fe5c3ca875f44203.gif" alt="img" loading="lazy"></p>
<h4 id="_71ctrl-alt-shift-j-选择所有出现的位置" tabindex="-1"> 71<code>Ctrl + Alt + Shift + J</code>：选择所有出现的位置</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/1d6ee3277028ff5aaa7edec82a7703c6.gif" alt="img" loading="lazy"></p>
<h4 id="_72alt-shift-middle-click-创建矩形选择" tabindex="-1"> 72<code>Alt + Shift + Middle-Click</code>：创建矩形选择</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/6c04aad317ec7ff3b4e560da8afc5ad8.gif" alt="img" loading="lazy"></p>
<h4 id="_73alt-click-拖拽以创建矩形选择区" tabindex="-1"> 73<code>Alt + Click</code>：拖拽以创建矩形选择区</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/995166ebcc89eea6d4997b712c5b9212.gif" alt="img" loading="lazy"></p>
<h4 id="_74ctrl-alt-shift-click-拖拽以创建多个矩形选择区" tabindex="-1"> 74<code>Ctrl + Alt + Shift + Click</code>：拖拽以创建多个矩形选择区</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/bb12a7c0f3f775c40e669c9878a4ae05.gif" alt="img" loading="lazy"></p>
<h2 id="part7七、辅助编码" tabindex="-1"> Part7七、辅助编码</h2>
<h4 id="_75alt-enter-显示建议操作" tabindex="-1"> 75<code>Alt + Enter</code>：显示建议操作</h4>
<p>该快捷键又称为“万通快捷键”，它会根据不同的语境建议不同的操作。下面这个演示只是其中的一种，还有很多种用法，你可以尝试一下。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/8a6e0b39b137d17cfb691087c390a8f3.gif" alt="img" loading="lazy"></p>
<h4 id="_76ctrl-space-代码补全" tabindex="-1"> 76<code>Ctrl + Space</code>：代码补全</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/92d200fbe7ff443e86b7d5f2ec55bde5.gif" alt="img" loading="lazy"></p>
<h4 id="_77ctrl-shift-space-类型匹配代码补全" tabindex="-1"> 77<code>Ctrl + Shift + Space</code>：类型匹配代码补全</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/773580d3eb124d0c2baa052304fa3cc9.gif" alt="img" loading="lazy"></p>
<h4 id="_78ctrl-alt-space-第二次代码补全" tabindex="-1"> 78<code>Ctrl + Alt + Space</code>：第二次代码补全</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/fc0776cbe5ade6cab71b0a4224ea92c3.gif" alt="img" loading="lazy"></p>
<h4 id="_79ctrl-shift-enter-补全当前语句" tabindex="-1"> 79<code>Ctrl + Shift + Enter</code>：补全当前语句</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/98b075fd12ddf9be2b86005cb9d38e6b.gif" alt="img" loading="lazy"></p>
<h4 id="_80ctrl-alt-l-格式化代码" tabindex="-1"> 80<code>Ctrl + Alt + L</code>：格式化代码</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5955c3e65b0a2ffc16bc56a670e4d763.gif" alt="img" loading="lazy"></p>
<h4 id="_81ctrl-p-参数信息提醒" tabindex="-1"> 81<code>Ctrl + P</code>：参数信息提醒</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/a276c34550157a2256c6320a05c2bd87.gif" alt="img" loading="lazy"></p>
<h4 id="_82ctrl-q-快速文档" tabindex="-1"> 82<code>Ctrl + Q</code>：快速文档</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/196a62ba45964ea5a639b1b14110218c.gif" alt="img" loading="lazy"></p>
<h4 id="_83ctrl-shift-up-向上移动语句" tabindex="-1"> 83<code>Ctrl + Shift + Up</code>：向上移动语句</h4>
<h4 id="_84ctrl-shift-down-向下移动语句" tabindex="-1"> 84<code>Ctrl + Shift + Down</code>：向下移动语句</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/2540c800307919b5e0eb45fd94ee25c2.gif" alt="img" loading="lazy"></p>
<h4 id="_85ctrl-alt-shift-left-向左移动元素" tabindex="-1"> 85<code>Ctrl + Alt + Shift + Left</code>：向左移动元素</h4>
<h4 id="_86ctrl-alt-shift-right-向右移动元素" tabindex="-1"> 86<code>Ctrl + Alt + Shift + Right</code>：向右移动元素</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/be47038a3f8398a8b6ad691901844690.gif" alt="img" loading="lazy"></p>
<h4 id="_87alt-shift-up-向上移动队列" tabindex="-1"> 87<code>Alt + Shift + Up</code>：向上移动队列</h4>
<h4 id="_88alt-shift-down-向下移动队列" tabindex="-1"> 88<code>Alt + Shift + Down</code>：向下移动队列</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/ad55a568c9177bf80415bba5f5de3575.gif" alt="img" loading="lazy"></p>
<h4 id="_89ctrl-添加行注释" tabindex="-1"> 89<code>Ctrl + /</code>：添加行注释</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/fe1de17cd5c85f28277eee6a0f0e4c80.gif" alt="img" loading="lazy"></p>
<h4 id="_90ctrl-shift-添加块注释" tabindex="-1"> 90<code>Ctrl + Shift + /</code>：添加块注释</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/7328b3ec588c6a2b05b18650a11a572b.gif" alt="img" loading="lazy"></p>
<h4 id="_91alt-insert-生产语句" tabindex="-1"> 91<code>Alt + Insert</code>：生产语句</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/0e6cb1c2e8cbde2028761ca549e27837.gif" alt="img" loading="lazy"></p>
<h2 id="part8八、上下文导航" tabindex="-1"> Part8八、上下文导航</h2>
<h4 id="_92alt-down-跳转至下一个方法" tabindex="-1"> 92<code>Alt + Down</code>：跳转至下一个方法</h4>
<h4 id="_93alt-up-跳转至上一个方法" tabindex="-1"> 93<code>Alt + Up</code>：跳转至上一个方法</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5711a9f83337ad847daebd0fa5c51a6e.gif" alt="img" loading="lazy"></p>
<h4 id="_94ctrl-g-跳转到指定行" tabindex="-1"> 94<code>Ctrl + G</code>：跳转到指定行</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/2b183366ec068f549375230906c0b527.gif" alt="img" loading="lazy"></p>
<h4 id="_95ctrl-tab-切换活动文件" tabindex="-1"> 95<code>Ctrl + Tab</code>：切换活动文件</h4>
<p><img src="https://img-blog.csdnimg.cn/c0c2512ab1414f289c4348c86571dc0e.gif" alt="img" loading="lazy"></p>
<h4 id="_96alt-f1-选择文件的定位" tabindex="-1"> 96<code>Alt + F1</code>：选择文件的定位</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/785df70101066e09328d8c15adf5afbf.gif" alt="img" loading="lazy"></p>
<h4 id="_97ctrl-e-最近的文件" tabindex="-1"> 97<code>Ctrl + E</code>：最近的文件</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/2916161df178b424712956b0ff3524a3.gif" alt="img" loading="lazy"></p>
<h4 id="_98ctrl-shift-backspace-返回上次编辑位置" tabindex="-1"> 98<code>Ctrl + Shift + Backspace</code>：返回上次编辑位置</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/49c598d3e638784cf470e9f9bb3a137d.gif" alt="img" loading="lazy"></p>
<h4 id="_99ctrl-alt-left-后退" tabindex="-1"> 99<code>Ctrl + Alt + Left</code>：后退</h4>
<h4 id="_100ctrl-alt-right-前进" tabindex="-1"> 100<code>Ctrl + Alt + Right</code>：前进</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/d190ec32d9a14fade6781cc585c99dcd.gif" alt="img" loading="lazy"></p>
<h4 id="_101ctrl-alt-down-下一事件" tabindex="-1"> 101<code>Ctrl + Alt + Down</code>：下一事件</h4>
<h4 id="_102ctrl-alt-up-上一事件" tabindex="-1"> 102<code>Ctrl + Alt + Up</code>：上一事件</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/bd5456b8080d43073223e0f80b23d14d.gif" alt="img" loading="lazy"></p>
<h4 id="_103alt-right-选择下一个选项卡" tabindex="-1"> 103<code>Alt + Right</code>：选择下一个选项卡</h4>
<h4 id="_104alt-left-选择下一个选项卡" tabindex="-1"> 104<code>Alt + Left</code>：选择下一个选项卡</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/dd6b38a356598fb7660cc04216ea2042.gif" alt="img" loading="lazy"></p>
<h4 id="_105f11-切换匿名书签" tabindex="-1"> 105<code>F11</code>：切换匿名书签</h4>
<p><img src="https://img-blog.csdnimg.cn/0b0f0bfaef634570adf105fc5b9a6ed3.gif" alt="img" loading="lazy"></p>
<h4 id="_106ctrl-shift-digit-用数字切换书签" tabindex="-1"> 106<code>Ctrl + Shift + [digit]</code>：用数字切换书签</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/31d04a3d547f983e4804320d1ed0de6c.gif" alt="img" loading="lazy"></p>
<h4 id="_107ctrl-f11-使用助词符切换书签" tabindex="-1"> 107<code>Ctrl + F11</code>：使用助词符切换书签</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/6ff41b3a1ae24687476c6b8e0ff2653e.gif" alt="img" loading="lazy"></p>
<h4 id="_108shift-f11-显示所有书签" tabindex="-1"> 108<code>Shift + F11</code>：显示所有书签</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/4f384449256d8961830709e301a3ad19.gif" alt="img" loading="lazy"></p>
<h4 id="_109ctrl-digit-用数字跳转到书签" tabindex="-1"> 109<code>Ctrl + [digit]</code>：用数字跳转到书签</h4>
<p><img src="https://img-blog.csdnimg.cn/9904ae44dd6d45b7b874ea9dbf3374a1.gif" alt="img" loading="lazy"></p>
<h4 id="_110alt-7-显示结构窗口" tabindex="-1"> 110<code>Alt + 7</code>：显示结构窗口</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/02aaceebb516074b5d1d93b3f8bf53b9.gif" alt="img" loading="lazy"></p>
<h4 id="_111alt-3-显示查找窗口" tabindex="-1"> 111<code>Alt + 3</code>：显示查找窗口</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/c26d14168c30874f5cf02cad12fc1439.gif" alt="img" loading="lazy"></p>
<h2 id="part9九、查找操作" tabindex="-1"> Part9九、查找操作</h2>
<h4 id="_112双击shift-查找所有" tabindex="-1"> 112双击<code>Shift</code>：查找所有</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/f4af891913492ce0d700e8cc49f8da58.gif" alt="img" loading="lazy"></p>
<h4 id="_113ctrl-f-查找字符-当前文件" tabindex="-1"> 113<code>Ctrl + F</code>：查找字符（当前文件）</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5c7b1e9db84b937c2e48ad40973e8e60.gif" alt="img" loading="lazy"></p>
<h4 id="_114f3-查找下一个" tabindex="-1"> 114<code>F3</code>：查找下一个</h4>
<h4 id="_115shift-f3-查找上一个" tabindex="-1"> 115<code>Shift + F3</code>：查找上一个</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/ded3c9e5d2025d8b2928e2cbfb5d17cf.gif" alt="img" loading="lazy"></p>
<h4 id="_116ctrl-r-替换字符-当前文件" tabindex="-1"> 116<code>Ctrl + R</code>：替换字符（当前文件）</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/0ca79c18ff938ba061a3c00e0b02dd28.gif" alt="img" loading="lazy"></p>
<h4 id="_117ctrl-shift-f-查找字符-所有文件" tabindex="-1"> 117<code>Ctrl + Shift + F</code>：查找字符（所有文件）</h4>
<p><img src="https://img-blog.csdnimg.cn/2ebf8d05a11c4cd089c979cae1bdd958.gif" alt="img" loading="lazy"></p>
<h4 id="_118ctrl-shift-r-替换字符-所有文件" tabindex="-1"> 118<code>Ctrl + Shift + R</code>：替换字符（所有文件）</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/128e40d357e98e00c57f91b25b8d7c70.gif" alt="img" loading="lazy"></p>
<h4 id="_119ctrl-f3-跳转到光标处单词的下一位置" tabindex="-1"> 119<code>Ctrl + F3</code>：跳转到光标处单词的下一位置</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/4a976a1add6bb62f9ce51fef08b16ae7.gif" alt="img" loading="lazy"></p>
<h4 id="_120ctrl-shift-n-查找文件并跳转" tabindex="-1"> 120<code>Ctrl + Shift + N</code>：查找文件并跳转</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/4f3b510238564296a15b17caa0acbbce.gif" alt="img" loading="lazy"></p>
<h4 id="_121ctrl-f12-打开文件结构" tabindex="-1"> 121<code>Ctrl + F12</code>：打开文件结构</h4>
<p><img src="https://img-blog.csdnimg.cn/eef5c5e9d36941dfa96ca33dd766e042.gif" alt="img" loading="lazy"></p>
<h4 id="_122ctrl-alt-shift-n-查找符号-变量、方法等" tabindex="-1"> 122<code>Ctrl + Alt + Shift + N</code>：查找符号（变量、方法等）</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/8581d8bc6db85835b682e6f200178ee4.gif" alt="img" loading="lazy"></p>
<h4 id="_123ctrl-shift-a-查找动作" tabindex="-1"> 123<code>Ctrl + Shift + A</code>：查找动作</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/103a16dbc06845af9fbfba2d240d3f76.gif" alt="img" loading="lazy"></p>
<h2 id="part10十、符号导航" tabindex="-1"> Part10十、符号导航</h2>
<h4 id="_124alt-f7-查找用法" tabindex="-1"> 124<code>Alt + F7</code>：查找用法</h4>
<h4 id="_125ctrl-b-跳转到声明处" tabindex="-1"> 125<code>Ctrl + B</code>：跳转到声明处</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/7772a9d7f1653b3f8dad7510e2009428.gif" alt="img" loading="lazy"></p>
<h4 id="_126ctrl-shift-b-跳转到声明类处" tabindex="-1"> 126<code>Ctrl + Shift + B</code>：跳转到声明类处</h4>
<p><img src="https://img-blog.csdnimg.cn/b38e7c62fe1949aeaf47ee228760a722.gif" alt="img" loading="lazy"></p>
<h4 id="_127ctrl-alt-f7-显示用法" tabindex="-1"> 127<code>Ctrl + Alt + F7</code>：显示用法</h4>
<h4 id="_128ctrl-u-跳转到超级方法" tabindex="-1"> 128<code>Ctrl + U</code>：跳转到超级方法</h4>
<h4 id="_129ctrl-alt-b-跳转到实现方法" tabindex="-1"> 129<code>Ctrl + Alt + B</code>：跳转到实现方法</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/158dccab9b00a4adeddddbe6f265681c.gif" alt="img" loading="lazy"></p>
<h4 id="_130ctrl-shift-f7-突出显示文件中的用法" tabindex="-1"> 130<code>Ctrl + Shift + F7</code>：突出显示文件中的用法</h4>
<h2 id="part11十一、代码分析" tabindex="-1"> Part11十一、代码分析</h2>
<h4 id="_131alt-enter-显示意图操作" tabindex="-1"> 131<code>Alt + Enter</code>：显示意图操作</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/fd6eba304728d567176d09e0395f8711.gif" alt="img" loading="lazy"></p>
<h4 id="_132ctrl-f1-显示错误描述" tabindex="-1"> 132<code>Ctrl + F1</code>：显示错误描述</h4>
<p><img src="https://img-blog.csdnimg.cn/69a3146293cf42869d5d9edcbc361361.gif" alt="img" loading="lazy"></p>
<h4 id="_133f2-下一个突出显示的错误" tabindex="-1"> 133<code>F2</code>：下一个突出显示的错误</h4>
<h4 id="_134shift-f2-上一个突出显示的错误" tabindex="-1"> 134<code>Shift + F2</code>：上一个突出显示的错误</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/95198ccc43a635f672f7de645609bb55.gif" alt="img" loading="lazy"></p>
<h4 id="_135ctrl-alt-shift-i-按名称运行检查" tabindex="-1"> 135<code>Ctrl + Alt + Shift + I</code>：按名称运行检查</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/89a24e9badfedf9c29289724897c9d3f.gif" alt="img" loading="lazy"></p>
<h4 id="_136alt-6-显示问题窗口" tabindex="-1"> 136<code>Alt + 6</code>：显示问题窗口</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5f61eda6c61aac30266b0eca2c2961f3.gif" alt="img" loading="lazy"></p>
<h2 id="part12十二、运行和调试" tabindex="-1"> Part12十二、运行和调试</h2>
<h4 id="_137双击ctrl-运行所有" tabindex="-1"> 137双击<code>Ctrl</code>：运行所有</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/dfd83fcdb2df5c7268711d56ab2068d9.gif" alt="img" loading="lazy"></p>
<h4 id="_138shift-f10-运行上下文配置" tabindex="-1"> 138<code>Shift + F10</code>：运行上下文配置</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/233df80102f449c0870001c464b30598.gif" alt="img" loading="lazy"></p>
<h4 id="_139alt-shift-f10-打开运行窗口" tabindex="-1"> 139<code>Alt + Shift + F10</code>：打开运行窗口</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/b732343565ad83e3d6d0699c290f8b60.gif" alt="img" loading="lazy"></p>
<h4 id="_140shift-f9-调试上下文配置" tabindex="-1"> 140<code>Shift + F9</code>：调试上下文配置</h4>
<p><img src="https://img-blog.csdnimg.cn/3ee855837a6341adb6964af240a7c6f0.gif" alt="img" loading="lazy"></p>
<h4 id="_141alt-shift-f9-打开调试窗口" tabindex="-1"> 141<code>Alt + Shift + F9</code>：打开调试窗口</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/0758624b40a1f92bb471106b37db1a76.gif" alt="img" loading="lazy"></p>
<h4 id="_142ctrl-alt-f5-附加到进程" tabindex="-1"> 142<code>Ctrl + Alt + F5</code>：附加到进程</h4>
<h4 id="_143ctrl-f2-停止" tabindex="-1"> 143<code>Ctrl + F2</code>：停止</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/295175c4d4e24802cb60538c29754cf8.gif" alt="img" loading="lazy"></p>
<h4 id="_144f9-运行至下一断点" tabindex="-1"> 144<code>F9</code>：运行至下一断点</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/52c413733df577e4e3cfb0d832eccf7b.gif" alt="img" loading="lazy"></p>
<h4 id="_145ctrl-shift-f2-停止后台进程" tabindex="-1"> 145<code>Ctrl + Shift + F2</code>：停止后台进程</h4>
<h4 id="_146f8-跨过调用" tabindex="-1"> 146<code>F8</code>：跨过调用</h4>
<p><img src="https://img-blog.csdnimg.cn/e483ed8901a84690ad7659919eb5a7c5.gif" alt="img" loading="lazy"></p>
<h4 id="_147alt-shift-f8-强制跨过调用" tabindex="-1"> 147<code>Alt + Shift + F8</code>：强制跨过调用</h4>
<h4 id="_148f7-进入调用" tabindex="-1"> 148<code>F7</code>：进入调用</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/d80808f5b178735dbda8d9ba4ac169b6.gif" alt="img" loading="lazy"></p>
<h4 id="_149shift-f7-智能进入调用" tabindex="-1"> 149<code>Shift + F7</code>：智能进入调用</h4>
<h4 id="_150alt-shift-f7-强制进入调用" tabindex="-1"> 150<code>Alt + Shift + F7</code>：强制进入调用</h4>
<h4 id="_151shift-f8-跳出调用" tabindex="-1"> 151<code>Shift + F8</code>：跳出调用</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/cc505ba481bc6072aa28fc91b813002e.gif" alt="img" loading="lazy"></p>
<h4 id="_152alt-f9-运行至光标处" tabindex="-1"> 152<code>Alt + F9</code>：运行至光标处</h4>
<p><img src="https://img-blog.csdnimg.cn/5edab35718af4b36b3c884eb2b7cac07.gif" alt="img" loading="lazy"></p>
<h4 id="_153ctrl-alt-f9-强制运行至光标处" tabindex="-1"> 153<code>Ctrl + Alt + F9</code>：强制运行至光标处</h4>
<h4 id="_154alt-f10-显示执行点" tabindex="-1"> 154<code>Alt + F10</code>：显示执行点</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/a0e762c714a46780bc5cf849c70dbb10.gif" alt="img" loading="lazy"></p>
<h4 id="_155alt-f8-评估表达式" tabindex="-1"> 155<code>Alt + F8</code>：评估表达式</h4>
<h4 id="_156ctrl-alt-f8-快速评估表达式" tabindex="-1"> 156<code>Ctrl + Alt + F8</code>：快速评估表达式</h4>
<h4 id="_157ctrl-f8-切换行断点" tabindex="-1"> 157<code>Ctrl + F8</code>：切换行断点</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/83d4d9d6502e9d21b913afde729ad90a.gif" alt="img" loading="lazy"></p>
<h4 id="_158ctrl-alt-shift-f8-切换临时行断点" tabindex="-1"> 158<code>Ctrl + Alt + Shift + F8</code>：切换临时行断点</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/db31e5fa8f315507b972e0ff23b986a0.gif" alt="img" loading="lazy"></p>
<h4 id="_159ctrl-shift-f8-查看断点" tabindex="-1"> 159<code>Ctrl + Shift + F8</code>：查看断点</h4>
<p><img src="https://img-blog.csdnimg.cn/ad39d955f8aa4ea0a7579656a65c73fb.gif" alt="img" loading="lazy"></p>
<h4 id="_160ctrl-shift-f8-编辑断点" tabindex="-1"> 160<code>Ctrl + Shift + F8</code>：编辑断点</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/03c9d1bd33c426460179f2d996808d96.gif" alt="img" loading="lazy"></p>
<h4 id="_161alt-4-显示运行窗口" tabindex="-1"> 161<code>Alt + 4</code>：显示运行窗口</h4>
<h4 id="_162alt-5-显示调试窗口" tabindex="-1"> 162<code>Alt + 5</code>：显示调试窗口</h4>
<h4 id="_163alt-8-显示服务窗口" tabindex="-1"> 163<code>Alt + 8</code>：显示服务窗口</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/d78ce349615dd68ee7447a312ec8ee49.gif" alt="img" loading="lazy"></p>
<h2 id="part13十三、代码重构" tabindex="-1"> Part13十三、代码重构</h2>
<h4 id="_164ctrl-alt-shift-t-打开重构列表" tabindex="-1"> 164<code>Ctrl + Alt + Shift + T</code>：打开重构列表</h4>
<p><img src="https://img-blog.csdnimg.cn/3df9103dfce1400197cc05cd642790ff.gif" alt="img" loading="lazy"></p>
<h4 id="_165shift-f6-修改名称" tabindex="-1"> 165<code>Shift + F6</code>：修改名称</h4>
<h4 id="_166ctrl-f6-修改签名" tabindex="-1"> 166<code>Ctrl + F6</code>：修改签名</h4>
<h4 id="_167ctrl-alt-n-内联" tabindex="-1"> 167<code>Ctrl + Alt + N</code>：内联</h4>
<h4 id="_168f6-移动" tabindex="-1"> 168<code>F6</code>：移动</h4>
<h4 id="_169ctrl-alt-m-提取方法" tabindex="-1"> 169<code>Ctrl + Alt + M</code>：提取方法</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/4e30e743881cb66b9b7f47096bcef032.gif" alt="img" loading="lazy"></p>
<h4 id="_170ctrl-alt-f-引入域" tabindex="-1"> 170<code>Ctrl + Alt + F</code>：引入域</h4>
<h4 id="_171ctrl-alt-p-引入参数" tabindex="-1"> 171<code>Ctrl + Alt + P</code>：引入参数</h4>
<h4 id="_172ctrl-alt-v-引入变量" tabindex="-1"> 172<code>Ctrl + Alt + V</code>：引入变量</h4>
<h4 id="_173alt-delete-安全删除" tabindex="-1"> 173<code>Alt + Delete</code>：安全删除</h4>
<h2 id="part14十四、全局-cvs-操作" tabindex="-1"> Part14十四、全局 CVS 操作</h2>
<h4 id="_174-alt-弹出-cvs-窗口" tabindex="-1"> 174`Alt + `` ：弹出 CVS 窗口</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/923e6c31f7d487cd43718be847be0623.gif" alt="img" loading="lazy"></p>
<h4 id="_175ctrl-k-提交" tabindex="-1"> 175<code>Ctrl + K</code>：提交</h4>
<p><img src="https://img-blog.csdnimg.cn/105bd8a398304cc38567b2d7db9ceb32.gif" alt="img" loading="lazy"></p>
<h4 id="_176ctrl-t-更新项目" tabindex="-1"> 176<code>Ctrl + T</code>：更新项目</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/4fb96fd58bbff5c21b9a64ca147b78e1.gif" alt="img" loading="lazy"></p>
<h4 id="_177ctrl-alt-z-回滚" tabindex="-1"> 177<code>Ctrl + Alt + Z</code>：回滚</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/435e38e7f1adb4a7ea4460a5240b9834.gif" alt="img" loading="lazy"></p>
<h4 id="_178ctrl-shift-k-拉取" tabindex="-1"> 178<code>Ctrl + Shift + K</code>：拉取</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/db44d880f2d9bfbc387c0bafc2b99e04.gif" alt="img" loading="lazy"></p>
<h4 id="_179ctrl-alt-shift-down-下一个修改" tabindex="-1"> 179<code>Ctrl + Alt + Shift + Down</code>：下一个修改</h4>
<h4 id="_180ctrl-alt-shift-up-上一个修改" tabindex="-1"> 180<code>Ctrl + Alt + Shift + Up</code>：上一个修改</h4>
<h4 id="_181alt-9-显示版本控制窗口" tabindex="-1"> 181<code>Alt + 9</code>：显示版本控制窗口</h4>
<h4 id="_182alt-0-显示提交窗口" tabindex="-1"> 182<code>Alt + 0</code>：显示提交窗口</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/865e5aecc673da3fce5cc31559c10f20.gif" alt="img" loading="lazy"></p>
<h2 id="part15十五、差异查看器" tabindex="-1"> Part15十五、差异查看器</h2>
<h4 id="_183f7-下一个差异" tabindex="-1"> 183<code>F7</code>：下一个差异</h4>
<h4 id="_184shift-f7-上一个差异" tabindex="-1"> 184<code>Shift + F7</code>：上一个差异</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/013eccdfa2f989494b43a058eaa166db.gif" alt="img" loading="lazy"></p>
<h4 id="_185ctrl-alt-r-接受左侧" tabindex="-1"> 185<code>Ctrl + Alt + R</code>：接受左侧</h4>
<h4 id="_186ctrl-alt-a-接受右侧" tabindex="-1"> 186<code>Ctrl + Alt + A</code>：接受右侧</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/7df0e99d894fe562902d714714f18b11.gif" alt="img" loading="lazy"></p>
<h4 id="_187ctrl-shift-tab-选择对面的差异窗格" tabindex="-1"> 187<code>Ctrl + Shift + Tab</code>：选择对面的差异窗格</h4>
<p><img src="https://img-blog.csdnimg.cn/a7f6eb649a4246d9ae8474a3d409d62e.gif" alt="img" loading="lazy"></p>
<h4 id="_188ctrl-shift-d-显示差异设置窗口" tabindex="-1"> 188<code>Ctrl + Shift + D</code>：显示差异设置窗口</h4>
<h2 id="part16十六、工具窗口" tabindex="-1"> Part16十六、工具窗口</h2>
<h4 id="_189shift-escape-隐藏活动的工具窗口" tabindex="-1"> 189<code>Shift + Escape</code>：隐藏活动的工具窗口</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/3e3fb7bcc404a3283a7c476c8c9f505e.gif" alt="img" loading="lazy"></p>
<h4 id="_190ctrl-shift-f12-隐藏所有工具窗口" tabindex="-1"> 190<code>Ctrl + Shift + F12</code>：隐藏所有工具窗口</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/0d97948eb8526716addee4c2b5d9123a.gif" alt="img" loading="lazy"></p>
<h4 id="_191f12-跳转到最后一个工具窗口" tabindex="-1"> 191<code>F12</code>：跳转到最后一个工具窗口</h4>
<h4 id="_192ctrl-alt-shift-left-向左延伸窗口大小" tabindex="-1"> 192<code>Ctrl + Alt + Shift + Left</code>：向左延伸窗口大小</h4>
<h4 id="_193ctrl-alt-shift-right-向右延伸窗口大小" tabindex="-1"> 193<code>Ctrl + Alt + Shift + Right</code>：向右延伸窗口大小</h4>
<p><img src="https://img-blog.csdnimg.cn/8f175ae20fe24cad8219bd406998f0ca.gif" alt="img" loading="lazy"></p>
<h4 id="_194ctrl-alt-shift-up-向顶部延伸窗口大小" tabindex="-1"> 194<code>Ctrl + Alt + Shift + Up</code>：向顶部延伸窗口大小</h4>
<h4 id="_195ctrl-alt-shift-down-向底部延伸窗口大小" tabindex="-1"> 195<code>Ctrl + Alt + Shift + Down</code>：向底部延伸窗口大小</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/cfb9491f1747770a189768b907ce41b6.gif" alt="img" loading="lazy"></p>
<h4 id="_196alt-1-显示项目窗口" tabindex="-1"> 196<code>Alt + 1</code>：显示项目窗口</h4>
<h4 id="_197alt-2-显示书签窗口" tabindex="-1"> 197<code>Alt + 2</code>：显示书签窗口</h4>
<h4 id="_198alt-3-显示查找窗口" tabindex="-1"> 198<code>Alt + 3</code>：显示查找窗口</h4>
<h4 id="_199alt-4-显示运行窗口" tabindex="-1"> 199<code>Alt + 4</code>：显示运行窗口</h4>
<h4 id="_200alt-5-显示调试窗口" tabindex="-1"> 200<code>Alt + 5</code>：显示调试窗口</h4>
<h4 id="_201alt-6-显示问题窗口" tabindex="-1"> 201<code>Alt + 6</code>：显示问题窗口</h4>
<h4 id="_202alt-7-显示结构窗口" tabindex="-1"> 202<code>Alt + 7</code>：显示结构窗口</h4>
<h4 id="_203alt-8-显示服务窗口" tabindex="-1"> 203<code>Alt + 8</code>：显示服务窗口</h4>
<h4 id="_204alt-9-显示版本控制窗口" tabindex="-1"> 204<code>Alt + 9</code>：显示版本控制窗口</h4>
<h4 id="_205alt-0-显示提交窗口" tabindex="-1"> 205<code>Alt + 0</code>：显示提交窗口</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/f4b4077ba3038f246422e1deee9a4511.gif" alt="img" loading="lazy"></p>
<h4 id="_206alt-f12-显示终端窗口" tabindex="-1"> 206<code>Alt + F12</code>：显示终端窗口</h4>
<p><img src="https://img-blog.csdnimg.cn/img_convert/282103793f92294a49ef3bd929740153.gif" alt="img" loading="lazy"></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-09T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">IntelliJ IDEA 日常使用介绍</title>
    <id>https://blog.ciberviler.top/dev/IDEA%E6%97%A5%E5%B8%B8%E4%BD%BF%E7%94%A8%E4%BB%8B%E7%BB%8D.html</id>
    <link href="https://blog.ciberviler.top/dev/IDEA%E6%97%A5%E5%B8%B8%E4%BD%BF%E7%94%A8%E4%BB%8B%E7%BB%8D.html"/>
    <updated>2022-05-13T15:30:45.000Z</updated>
    <summary type="html">IntelliJ IDEA 日常使用介绍</summary>
    <content type="html"><![CDATA[<h1 id="intellij-idea-日常使用介绍" tabindex="-1"> IntelliJ IDEA 日常使用介绍</h1>
<h2 id="_1-idea激活" tabindex="-1"> 1. IDEA激活</h2>
<p>不说其他的，先放大招，进行IDEA免费使用</p>
<p>步骤：打开plugins -&gt; 打开Manage Plugin Repositories -&gt; 添加 <a href="https://zhile.io/" target="_blank" rel="noopener noreferrer">https://zhile.io</a> 网址 -&gt; 下载 IDE Eval Reset 插件 -&gt; 安装重启 -&gt; 设置每次打开都重置</p>
<p><img src="https://img-blog.csdnimg.cn/50e1d7b3d80c477ab422b3d02415a778.png" alt="img" loading="lazy"></p>
<p><img src="https://img-blog.csdnimg.cn/e7aacb88b1134a00acbbdbbdb9971d03.png" alt="img" loading="lazy"></p>
<p><img src="https://img-blog.csdnimg.cn/1d714e1009a74b1a9f4fa3e3100dc743.png" alt="img" loading="lazy"></p>
<p><img src="https://img-blog.csdnimg.cn/c34169e9a1cc4745bb83c145c91597fe.png" alt="img" loading="lazy"></p>
<h2 id="_2-字体颜色背景设置" tabindex="-1"> 2. 字体颜色背景设置</h2>
<p><img src="https://img-blog.csdnimg.cn/25e9fcce71d641c49b034b71d2346c98.png" alt="img" loading="lazy"></p>
<h2 id="_3-个人代码模板" tabindex="-1"> 3. 个人代码模板</h2>
<p><img src="https://img-blog.csdnimg.cn/ff29f5d710334eb6848197e0a4410407.png" alt="img" loading="lazy"></p>
<h2 id="_4-上方功能栏添加ssh" tabindex="-1"> 4. 上方功能栏添加<a href="https://so.csdn.net/so/search?q=SSH&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">SSH</a></h2>
<p><img src="https://img-blog.csdnimg.cn/ee0fce3861ee495d89d5e36d48600ca9.png" alt="img" loading="lazy"></p>
<h2 id="_5-idea右侧添加remotehost连接linux的工具" tabindex="-1"> 5. IDEA右侧添加RemoteHost连接Linux的工具</h2>
<p><img src="https://img-blog.csdnimg.cn/d38bc96c81924508b58454f8edaf749f.png" alt="img" loading="lazy"></p>
<h2 id="_6-idea添加文件传输" tabindex="-1"> 6. IDEA添加文件传输</h2>
<p><img src="https://img-blog.csdnimg.cn/bcb6bb7000874e558976c14052b285f7.png" alt="img" loading="lazy"></p>
<h2 id="_7-idea内部翻译" tabindex="-1"> 7. IDEA内部翻译</h2>
<p><img src="https://img-blog.csdnimg.cn/5700b9665d1944239f310545fb2d1871.png" alt="img" loading="lazy"></p>
<h2 id="_8-智能代码补全" tabindex="-1"> 8. 智能代码补全</h2>
<p><img src="https://img-blog.csdnimg.cn/0deb573c65ea428f96180acfff915ae0.png" alt="img" loading="lazy"></p>
<h2 id="_9-括号添加颜色" tabindex="-1"> 9. 括号添加颜色</h2>
<p><img src="https://img-blog.csdnimg.cn/3b1965139a2940cf8bf02c5876508374.png" alt="img" loading="lazy"></p>
<p><img src="https://img-blog.csdnimg.cn/f7018a015ea84aa7a393b64ae051f7c7.png" alt="img" loading="lazy"></p>
<h2 id="_10-右侧代码缩略图" tabindex="-1"> 10. 右侧代码缩略图</h2>
<p><img src="https://img-blog.csdnimg.cn/7f12f052e13540c5a4519870cbaaeb92.png" alt="img" loading="lazy"></p>
<h2 id="_11-scala代码匹配设置" tabindex="-1"> 11. <a href="https://so.csdn.net/so/search?q=Scala&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">Scala</a>代码匹配设置</h2>
<p><img src="https://img-blog.csdnimg.cn/60ea601c33b24ccaa0a102d18c252eaf.png" alt="img" loading="lazy"></p>
<h2 id="_12-代码自动补全设置" tabindex="-1"> 12. 代码<a href="https://so.csdn.net/so/search?q=%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">自动补全</a>设置</h2>
<p><img src="https://img-blog.csdnimg.cn/263e9d7177e249198d3ef15bbf5bdd8d.png" alt="img" loading="lazy"></p>
<h2 id="_13-idea2020版本中scala显示变量类型提示-设置位置" tabindex="-1"> 13. IDEA2020版本中Scala显示变量类型提示 设置位置</h2>
<p><img src="https://img-blog.csdnimg.cn/09262f00ddaf409c8e96a84006f52808.png" alt="img" loading="lazy"></p>
<h2 id="_14-设置scala代码缩进大小" tabindex="-1"> 14. 设置Scala代码缩进大小</h2>
<p>找到file&gt;Settings&gt;Editor&gt;Code Style&gt;Scala</p>
<p><img src="https://img-blog.csdnimg.cn/32cc19ff94ce4a39b24b9b64fa501506.png" alt="img" loading="lazy"></p>
<h2 id="_15-设置scala的隐式转换加粗下划线" tabindex="-1"> 15. 设置Scala的隐式转换加粗下划线</h2>
<p><img src="https://img-blog.csdnimg.cn/0869bc28df204ee7abb5f1cb2009e593.png" alt="img" loading="lazy"></p>
<h2 id="_16-设置项目的打开或关闭" tabindex="-1"> 16. 设置项目的打开或关闭</h2>
<p>File -&gt; Settings -&gt; System Settings</p>
<p><img src="https://img-blog.csdnimg.cn/8d5070aab41a4404870618392adbb065.png" alt="img" loading="lazy"></p>
<h2 id="_17-设置通过鼠标滚动向左或向右移动idea界面" tabindex="-1"> 17. 设置通过鼠标滚动向左或向右移动IDEA界面</h2>
<p><img src="https://img-blog.csdnimg.cn/8330efdcb14042e69deb5d9b19552e02.png" alt="img" loading="lazy"></p>
<h2 id="_18-idea中ctrl-h可以查看该类的继承图" tabindex="-1"> 18. IDEA中ctrl+h可以查看该类的继承图</h2>
<p><img src="https://img-blog.csdnimg.cn/1a5427657bb64c1e8d48427995b5366b.png" alt="img" loading="lazy"></p>
<h2 id="_19-lombok插件使用注解解决常用代码块重写问题" tabindex="-1"> 19. Lombok插件使用注解解决常用代码块重写问题</h2>
<p><img src="https://img-blog.csdnimg.cn/843f948c81aa4a0caee5fcadd0b4cccf.png" alt="img" loading="lazy"></p>
<h2 id="_20-idea上传代码到git时需要忽略的文件" tabindex="-1"> 20. IDEA上传代码到Git时需要忽略的文件</h2>
<p>不需要上传的文件包括 后缀为iml的文件，.idea文件夹里的文件，target打包目录里的文件。</p>
<p><img src="https://img-blog.csdnimg.cn/82474ba762a4463eb5411501c7284d5b.png" alt="img" loading="lazy"></p>
<h2 id="_21-idea中查找当前类的方法、属性、内容的常用快捷键" tabindex="-1"> 21. IDEA中查找当前类的方法、属性、内容的常用快捷键</h2>
<p>Ctrl + F12</p>
<p><a href="https://blog.csdn.net/huangjhai/article/details/104127661" target="_blank" rel="noopener noreferrer">IDEA中查找当前类的方法、属性、内容的常用快捷键_huangjhai的博客-CSDN博客_idea查询类的方法快捷键</a></p>
<h2 id="_22-idea字体颜色设置" tabindex="-1"> 22. IDEA字体颜色设置</h2>
<p>1、单行注释字体颜色：</p>
<p>Settings----&gt;Editor-----&gt;Colors Scheme -----&gt;Language Defaults下设置：</p>
<p><img src="https://img-blog.csdnimg.cn/ec188675ce3a48f7bb9efd4127a8ab16.png" alt="img" loading="lazy"></p>
<p>2、文档注释字体颜色：</p>
<p><img src="https://img-blog.csdnimg.cn/bd2c39d338e04865866252a043b0c1be.png" alt="img" loading="lazy"></p>
<p>3、选中字符 和 类中相同字符的字体颜色：</p>
<p><img src="https://img-blog.csdnimg.cn/d3bdd2fd16d0481a9b25304b31db3543.png" alt="img" loading="lazy"></p>
<p>4、鼠标所在行的背景颜色：</p>
<p><img src="https://img-blog.csdnimg.cn/3d6076e8e0bd41e8b064ef9aea2cdc43.png" alt="img" loading="lazy"></p>
<p>5、选中代码的背景颜色：</p>
<p><img src="https://img-blog.csdnimg.cn/9219cfb1bafc456d991114e4b3f46cf2.png" alt="img" loading="lazy"></p>
<h2 id="_23-maven的依赖冲突检测插件" tabindex="-1"> 23. Maven的依赖冲突检测插件</h2>
<p><img src="https://img-blog.csdnimg.cn/2190b135de374bbcb2afed71ee7047dd.png" alt="img" loading="lazy"></p>
<h2 id="_24-idea切换大小写快捷键" tabindex="-1"> 24. IDEA切换大小写快捷键</h2>
<p>Ctrl+Shift+U</p>
<p><img src="https://img-blog.csdnimg.cn/db9391f1e0454fe4a269fc2e1c10958b.png" alt="img" loading="lazy"></p>
<h2 id="_25-idea中跳转到指定行数" tabindex="-1"> 25. idea中跳转到指定行数</h2>
<p>使用Ctrl + G能跳转到指定行数</p>
<p><img src="https://img-blog.csdnimg.cn/045604c4c498496aacc76cffafc0313e.png" alt="img" loading="lazy"></p>
<h2 id="_26-codota代码智能提示插件" tabindex="-1"> 26. Codota代码智能提示插件</h2>
<p><img src="https://img-blog.csdnimg.cn/943f21a2217a4f809f90c0392cddbae3.png" alt="img" loading="lazy"></p>
<h2 id="_27-codeglance-显示代码缩略图插件" tabindex="-1"> 27. CodeGlance 显示代码缩略图插件</h2>
<p><img src="https://img-blog.csdnimg.cn/5a25d2c7eb2c4d9195382618c5bdb9f4.png" alt="img" loading="lazy"></p>
<h2 id="_28-alibaba-java-coding-guidelines-阿里巴巴代码规范检查插件" tabindex="-1"> 28. <strong>Alibaba Java Coding Guidelines 阿里巴巴代码规范检查插件</strong></h2>
<p>会按照阿里Java开发手册上规范帮我们检查代码，然后对代码做不同颜色展示，鼠标放上去，会看到提示内容，帮助我们写出更规范的代码。</p>
<p><img src="https://img-blog.csdnimg.cn/8f2767d6df9841a0a4ba34e10779678c.png" alt="img" loading="lazy"></p>
<h2 id="_29-camelcase-驼峰命名和下划线命名转换" tabindex="-1"> 29. CamelCase 驼峰命名和下划线命名转换</h2>
<p>这几种风格的命名方式，用快捷键 ⇧ + ⌥ + U / Shift + Alt + U可以进行快速转换，当我们需要修改大量变量名称的时候很方便。</p>
<p><img src="https://img-blog.csdnimg.cn/582f5bb9e2b940089c2aae547e006792.png" alt="img" loading="lazy"></p>
<h2 id="_30-sonarlint-代码质量检查插件" tabindex="-1"> 30. SonarLint 代码质量检查插件</h2>
<p>提示我不要用System.out输出，要用logger输出，诸如此类，帮助我们提升代码质量。</p>
<p><img src="https://img-blog.csdnimg.cn/d3f81a3b546b4dbba99f6647eecd21fa.png" alt="img" loading="lazy"></p>
<h2 id="_31-save-actions-格式化代码插件" tabindex="-1"> 31. Save Actions 格式化代码插件</h2>
<p>可以帮忙我们优化包导入，自动给没有修改的变量添加final修饰符，调用方法的时候自动添加this关键字等，使我们的代码更规范统一。</p>
<p><img src="https://img-blog.csdnimg.cn/8ffb8ec63a5e46239a5e39e4d91c6a55.png" alt="img" loading="lazy"></p>
<h2 id="_32-grep-console-自定义控制台输出格式插件" tabindex="-1"> 32. <strong>Grep Console 自定义控制台输出格式插件</strong></h2>
<p><img src="https://img-blog.csdnimg.cn/2d5b888328ec49bca82d70ba9b5abecc.png" alt="img" loading="lazy"></p>
<h2 id="_33-metricsreloaded-代码复杂度检查插件" tabindex="-1"> 33. MetricsReloaded 代码复杂度检查插件</h2>
<p><img src="https://img-blog.csdnimg.cn/ec2bf1d8d35e4e649685cb6293adf19f.png" alt="img" loading="lazy"></p>
<h2 id="_34-statistic-代码统计插件" tabindex="-1"> 34. <strong>Statistic 代码统计插件</strong></h2>
<p><img src="https://img-blog.csdnimg.cn/b3054d4a5edb4fa1abca7abc9a752f72.png" alt="img" loading="lazy"></p>
<h2 id="_35-translation-翻译插件" tabindex="-1"> 35. Translation 翻译插件</h2>
<p><img src="https://img-blog.csdnimg.cn/8443d9b84f5d41529b401f23861b6d82.png" alt="img" loading="lazy"></p>
<h2 id="_36-rainbow-brackets-彩虹括号插件" tabindex="-1"> 36. Rainbow Brackets 彩虹括号插件</h2>
<p><img src="https://img-blog.csdnimg.cn/90fb39058ba642398f31c79a604c19ac.png" alt="img" loading="lazy"></p>
<h2 id="_37-自定义创建live-template-快速写代码" tabindex="-1"> 37. 自定义创建live template，快速写代码</h2>
<p><img src="https://img-blog.csdnimg.cn/562bcd734622400abaae6ff8ba9f21f9.png" alt="img" loading="lazy"></p>
<p>只要输入apr ，就能自动提示，并且生成Autowired 语句了。可以根据自己的代码习惯，自定义一些代码模板，帮助我们快速写代码。</p>
<p><img src="https://img-blog.csdnimg.cn/5873cfc66dae431592bd040c85b03e97.png" alt="img" loading="lazy"></p>
<h2 id="_38-优化导包配置" tabindex="-1"> 38. 优化导包配置</h2>
<p><img src="https://img-blog.csdnimg.cn/2e53adb6d3444785805f81ad48fde448.png" alt="img" loading="lazy"></p>
<h2 id="_39-取消tab页单行显示" tabindex="-1"> 39. 取消tab页单行显示</h2>
<p>多行显示更多的文件，方便查看。</p>
<p><img src="https://img-blog.csdnimg.cn/4de2999bca1d45549b5e5e76cb4fbd4f.png" alt="img" loading="lazy"></p>
<h2 id="_40-双斜杠注释改成紧跟代码头" tabindex="-1"> 40. 双斜杠注释改成紧跟代码头</h2>
<p><img src="https://img-blog.csdnimg.cn/af616664de7042c988a0e742f0931900.png" alt="img" loading="lazy"></p>
<h2 id="_41-选中复制整行" tabindex="-1"> 41. <strong>选中复制整行</strong></h2>
<p>原本只会复制你选中的代码，改完配置后，就能复制整行，无论你是否完全选中。</p>
<p><img src="https://img-blog.csdnimg.cn/79f64ca4f2e34d90aaeba8bead853234.png" alt="img" loading="lazy"></p>
<h2 id="_42-取消匹配大小写" tabindex="-1"> 42. <strong>取消匹配大小写</strong></h2>
<p>取消勾选后，输入小写 <strong>s</strong> ，也能提示出 <strong>String</strong></p>
<p><img src="https://img-blog.csdnimg.cn/09aadc6a7d1548e297cd40a68f79ae27.png" alt="img" loading="lazy"></p>
<h2 id="_43-优化版本控制的目录颜色展示" tabindex="-1"> 43. 优化版本控制的目录颜色展示</h2>
<p><img src="https://img-blog.csdnimg.cn/8eee46b0408747108bf08af3bbc4a890.png" alt="img" loading="lazy"></p>
<h2 id="_44-创建文件时-自动生成作者和时间信息" tabindex="-1"> 44. 创建文件时，自动生成作者和时间信息</h2>
<p><img src="https://img-blog.csdnimg.cn/0b87614baa5e4dbb8293081f19830d1d.png" alt="img" loading="lazy"></p>
<h2 id="_45-显示行号和方法分割线" tabindex="-1"> 45. 显示行号和方法分割线</h2>
<p><img src="https://img-blog.csdnimg.cn/ff6f17a7479149498a99dfad04014ea7.png" alt="img" loading="lazy"></p>
<h2 id="_46-通过idea自带的profiler查看运行程序消耗的资源" tabindex="-1"> 46. 通过idea自带的profiler查看运行程序消耗的资源</h2>
<p>\1. 点击profiler找到运行的对应的程序</p>
<p><img src="https://img-blog.csdnimg.cn/60b41584efa44dcb8cca04365afb65c0.png" alt="img" loading="lazy"></p>
<p>\2. 右击程序，打开CPU和内存等资源消耗</p>
<p><img src="https://img-blog.csdnimg.cn/4fd6bb7f08a84dfda770b167dd302970.png" alt="img" loading="lazy"></p>
<p>\3. 通过自带的稍微简单的图形化界面查看资源消耗</p>
<p><img src="https://img-blog.csdnimg.cn/7b1404023dd4400aae19a1c9ff5e97f5.png" alt="img" loading="lazy"></p>
<p>\4. 如果想要查看更详细的资源消耗情况，可以在win10上安装JProfiler，并在idea中安装JProfiler插件，可以查看更详细的信息</p>
<p><img src="https://img-blog.csdnimg.cn/f74d6b06a9574bcf97336d8cb5669ac6.png" alt="img" loading="lazy"></p>
<h2 id="_47-个人的idea整体布局" tabindex="-1"> 47. 个人的IDEA整体布局</h2>
<p><img src="https://img-blog.csdnimg.cn/cfb5fd62de70411dbceaae87dfdaad71.png" alt="img" loading="lazy"></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-07T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">36 张图梳理 Intellij IDEA 常用设置</title>
    <id>https://blog.ciberviler.top/dev/36%E5%BC%A0%E5%9B%BE%E6%A2%B3%E7%90%86%20Intellij%20IDEA%E5%B8%B8%E7%94%A8%E8%AE%BE%E7%BD%AE.html</id>
    <link href="https://blog.ciberviler.top/dev/36%E5%BC%A0%E5%9B%BE%E6%A2%B3%E7%90%86%20Intellij%20IDEA%E5%B8%B8%E7%94%A8%E8%AE%BE%E7%BD%AE.html"/>
    <updated>2022-05-13T15:30:37.000Z</updated>
    <summary type="html">36 张图梳理 Intellij IDEA 常用设置</summary>
    <content type="html"><![CDATA[<h1 id="_36-张图梳理-intellij-idea-常用设置" tabindex="-1"> 36 张图梳理 Intellij IDEA 常用设置</h1>
<h2 id="_1-显示工具条" tabindex="-1"> 1. 显示工具条</h2>
<p>（1）效果图
<img src="https://img-blog.csdnimg.cn/20210224203514537.jpg" alt="在这里插入图片描述" loading="lazy">
（2）设置方法</p>
<ul>
<li>标注1：View–&gt;Toolbar</li>
<li>标注2：View–&gt;Tool Buttons</li>
</ul>
<h2 id="_2-设置鼠标悬浮提示" tabindex="-1"> 2.设置鼠标悬浮提示</h2>
<p>（1）效果图
<img src="https://img-blog.csdnimg.cn/20210224203557930.jpg" alt="在这里插入图片描述" loading="lazy">
（2)设置方法</p>
<p>File–&gt;settings–&gt;Editor–&gt;General–&gt;勾选Show quick documentation…
<img src="https://img-blog.csdnimg.cn/20210224203618871.jpg" alt="在这里插入图片描述" loading="lazy"></p>
<h2 id="_3-显示方法分隔符" tabindex="-1"> 3.显示方法分隔符</h2>
<p>（1）效果图
<img src="https://img-blog.csdnimg.cn/20210224203648505.jpg" alt="在这里插入图片描述" loading="lazy">
（2)设置方法</p>
<p>File–&gt;settings–&gt;Editor–&gt;Appearance–&gt;勾选
<img src="https://img-blog.csdnimg.cn/20210224203711703.jpg" alt="q" loading="lazy"></p>
<h2 id="_4-忽略大小写提示" tabindex="-1"> 4.忽略大小写提示</h2>
<p>（1）效果图</p>
<p>备注：idea的默认设置是严格区分大小写提示的，例如输入string不会提示String，不方便编码
<img src="https://img-blog.csdnimg.cn/20210224203811694.jpg" alt="在这里插入图片描述" loading="lazy">
（2）设置方法File–&gt;settings–&gt;Editor–&gt;General --&gt;Code Completion --&gt;
<img src="https://img-blog.csdnimg.cn/20210224203830493.jpg" alt="在这里插入图片描述" loading="lazy"></p>
<h2 id="_5-主题设置" tabindex="-1"> 5.主题设置</h2>
<p>（1）效果图</p>
<p>备注：有黑白两种风格
<img src="https://img-blog.csdnimg.cn/20210224203904545.jpg" alt="在这里插入图片描述" loading="lazy">
<img src="https://img-blog.csdnimg.cn/20210224203916562.jpg" alt="在这里插入图片描述" loading="lazy">
（2)设置方法</p>
<p>File–&gt;settings–&gt;Appearance &amp; Behavior–&gt;Appearance–&gt;
<img src="https://img-blog.csdnimg.cn/20210224203938251.jpg" alt="在这里插入图片描述" loading="lazy"></p>
<h2 id="_6-护眼主题设置" tabindex="-1"> 6.护眼主题设置</h2>
<p>（1）效果图
<img src="https://img-blog.csdnimg.cn/20210224204009507.jpg" alt="在这里插入图片描述" loading="lazy">
（2)设置方法</p>
<p>如果想将编辑页面变换主题，可以去设置里面调节背景颜色
<img src="https://img-blog.csdnimg.cn/20210224204028538.jpg" alt="在这里插入图片描述" loading="lazy">
如果需要很好看的编码风格，这里有很多主题 <a href="http://color-themes.com/?view=index&amp;layout=Generic&amp;order=popular&amp;search=&amp;page=1" target="_blank" rel="noopener noreferrer">http://color-themes.com/?view=index&amp;layout=Generic&amp;order=popular&amp;search=&amp;page=1</a> 点击相应主题，往下滑点击按钮
<img src="https://img-blog.csdnimg.cn/20210224204049458.jpg" alt="在这里插入图片描述" loading="lazy">
下载下来有很多Jar包
<img src="https://img-blog.csdnimg.cn/20210224204104138.jpg" alt="在这里插入图片描述" loading="lazy">
<img src="https://img-blog.csdnimg.cn/20210224204116351.jpg" alt="在这里插入图片描述" loading="lazy">
在上面的位置选择导入jar包，然后重启idea生效，重启之后去设置
<img src="https://img-blog.csdnimg.cn/20210224204138424.jpg" alt="在这里插入图片描述" loading="lazy"></p>
<h2 id="_7-自动导入包" tabindex="-1"> 7. 自动导入包</h2>
<p>(1）效果图
备注：默认情况是需要手动导入包的，比如我们需要导入Map类，那么需要手动导入，如果不需要使用了，删除了Map的实例，导入的包也需要手动删除，设置了这个功能这个就不需要手动了，自动帮你实现自动导入包和去包，不方便截图，效果请亲测~
（2）设置方法</p>
<p>File–&gt;settings–&gt;Editor–&gt;general–&gt;Auto Import–&gt;
<img src="https://img-blog.csdnimg.cn/2021022420421999.jpg" alt="在这里插入图片描述" loading="lazy"></p>
<h2 id="_8-单行显示多个tabs" tabindex="-1"> 8.单行显示多个Tabs</h2>
<p>（1）效果图
<img src="https://img-blog.csdnimg.cn/20210224204304589.jpg" alt="默认是显示单排的Tabs:" loading="lazy"></p>
<p>单行显示多个Tabs:
<img src="https://img-blog.csdnimg.cn/20210224204337379.jpg" alt="在这里插入图片描述" loading="lazy">
（2）设置方法
File–&gt;settings–&gt;Editor–&gt;General --&gt;Editor Tabs–&gt;去掉√
<img src="https://img-blog.csdnimg.cn/20210224204420119.jpg" alt="在这里插入图片描述" loading="lazy"></p>
<h2 id="_9-设置字体" tabindex="-1"> 9.设置字体</h2>
<p>（1）效果图
备注：默认安装启动Idea字体很小，看着不习惯，需要调整字体大小与字体（有需要可以调整）
（2）设置方法
File–&gt;settings–&gt;Editor–&gt;Font–&gt;
<img src="https://img-blog.csdnimg.cn/20210224204505784.jpg" alt="在这里插入图片描述" loading="lazy"></p>
<h2 id="_10-配置类文档注释信息和方法注释模版" tabindex="-1"> 10.配置类文档注释信息和方法注释模版</h2>
<p>（1）效果图
备注：团队开发时方便追究责任与管理查看
<img src="https://img-blog.csdnimg.cn/20210224204545258.jpg" alt="在这里插入图片描述" loading="lazy">
<img src="https://img-blog.csdnimg.cn/20210224204604611.png" alt="在这里插入图片描述" loading="lazy">
（2）设置方法
<a href="https://blog.csdn.net/zeal9s/article/details/83514565" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/zeal9s/article/details/83514565</a></p>
<h2 id="_11-水平或者垂直显示代码" tabindex="-1"> 11.水平或者垂直显示代码</h2>
<p>（1）效果图
备注：Eclipse如果需要对比代码，只需要拖动Tabs即可，但是idea要设置
<img src="https://img-blog.csdnimg.cn/20210224204734417.jpg" alt="在这里插入图片描述" loading="lazy">
（2）设置方法</p>
<p>鼠标右击Tabs
<img src="https://img-blog.csdnimg.cn/20210224204757375.jpg" alt="在这里插入图片描述" loading="lazy"></p>
<h2 id="_12-更换快捷键" tabindex="-1"> 12. 更换快捷键</h2>
<p>（1）效果图</p>
<p>备注：从Eclipse移植到idea编码，好多快捷键不一致，导致编写效率降低，现在我们来更换一下快捷键
（2）设置方法</p>
<ul>
<li>
<p>方法一：
File–&gt;Setting–&gt;
<img src="https://img-blog.csdnimg.cn/20210224204900966.jpg" alt="在这里插入图片描述" loading="lazy">
例如设置成Eclipse的，设置好了之后可以ctrl+d删除单行代码（idea是ctrl+y）</p>
</li>
<li>
<p>方法二：设置模板
File–&gt;Setting–&gt;
<img src="https://img-blog.csdnimg.cn/20210224204938310.jpg" alt="在这里插入图片描述" loading="lazy"></p>
</li>
<li>
<p>方法三：
<img src="https://img-blog.csdnimg.cn/20210224205002231.jpg" alt="在这里插入图片描述" loading="lazy">
以ctrl+o重写方法</p>
</li>
<li>
<p>为例
<img src="https://img-blog.csdnimg.cn/20210224205019981.jpg" alt="在这里插入图片描述" loading="lazy"></p>
</li>
</ul>
<h2 id="_13-注释去掉斜体" tabindex="-1"> 13.注释去掉斜体</h2>
<p>（1）效果图
<img src="https://img-blog.csdnimg.cn/20210224205113664.jpg" alt="在这里插入图片描述" loading="lazy">
（2）设置方法</p>
<p>File–&gt;settings–&gt;Editor–&gt;
<img src="https://img-blog.csdnimg.cn/20210224205131716.jpg" alt="在这里插入图片描述" loading="lazy">
<img src="https://img-blog.csdnimg.cn/202102242051459.jpg" alt="在这里插入图片描述" loading="lazy"></p>
<h2 id="_14-代码检测警告" tabindex="-1"> 14.代码检测警告</h2>
<h2 id="提示等级设置" tabindex="-1"> 提示等级设置</h2>
<p><img src="https://img-blog.csdnimg.cn/20210224205204818.jpg" alt="在这里插入图片描述" loading="lazy">
强烈建议，不要给关掉，不要嫌弃麻烦，他的提示都是对你好，帮助你提高你的代码质量，很有帮助的</p>
<h2 id="_15-项目目录相关–折叠空包" tabindex="-1"> 15.项目目录相关–折叠空包</h2>
<p><img src="https://img-blog.csdnimg.cn/20210224205220446.jpg" alt="在这里插入图片描述" loading="lazy"></p>
<h2 id="_16-窗口复位" tabindex="-1"> 16. 窗口复位</h2>
<p><img src="https://img-blog.csdnimg.cn/20210224205236946.jpg" alt="在这里插入图片描述" loading="lazy">
这个就是当你把窗口忽然间搞得乱七八糟的时候，还可以挽回，就是直接restore一下，就好啦。</p>
<h2 id="_17-查看本地代码历史" tabindex="-1"> 17. 查看本地代码历史</h2>
<p><img src="https://img-blog.csdnimg.cn/2021022420530438.jpg" alt="在这里插入图片描述" loading="lazy"></p>
<h2 id="_18-快速补全分号" tabindex="-1"> 18. 快速补全分号</h2>
<p>CTRL + SHIFT + ENTER 在当前行任何地方可以快速在末尾生成分号</p>
<h2 id="_19-快速找到controller方法" tabindex="-1"> 19. 快速找到Controller方法</h2>
<p>如果你的项目里有非常多的controller，里面有非常多的http或者resful方法。如何快速找到这些方法呢？这个时候，ctrl+alt+shift+n就可以派上用场了。
比如说，你依稀记得入账单相关的接口，都有个bill的url路径，那么使用ctrl+alt+shift+n后，直接输入/bill即可。</p>
<p><img src="https://img-blog.csdnimg.cn/20210224205514795.png" alt="在这里插入图片描述" loading="lazy">
当你在成千上万的Controller里寻找方法时，这一招就可以大大提高效率。</p>
<h2 id="_20-大括号匹配" tabindex="-1"> 20.大括号匹配</h2>
<p>这个也非常有用，因为代码太长，某个for循环，可能已经撑满整个屏幕了。这个时候，找到某个大括号对应的另外一边就很费劲。你可以将光标定位在某个大括号一边，然后使用ctrl+]或者ctrl+[来回定位即可。 <strong>补充</strong>：以上的配置信息都保存在系统盘的
<img src="https://img-blog.csdnimg.cn/20210224205558296.png" alt="在这里插入图片描述" loading="lazy">
默认会有这两个文件
<img src="https://img-blog.csdnimg.cn/20210224205626669.png" alt="在这里插入图片描述" loading="lazy"></p>
<p>config:在初始化安装IntelliJ IDEA时有询问你是否导入以存在的配置信息，这个config就是你的配置信息，方便更换电脑和换系统的时候重新安装，前提是要保存好此文件夹。
system:此文件夹是IntelliJ IDEA发生什么不可预知性的错误时，比如蓝屏，突然断电导致项目不能启动，可以尝试删除此文件，让系统重新生成一个system的文件</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-03T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">7000字+24张图，带你彻底弄懂线程池</title>
    <id>https://blog.ciberviler.top/dev/7000%E5%AD%97+24%E5%BC%A0%E5%9B%BE,%E5%B8%A6%E4%BD%A0%E5%BD%BB%E5%BA%95%E5%BC%84%E6%87%82%E7%BA%BF%E7%A8%8B%E6%B1%A0.html</id>
    <link href="https://blog.ciberviler.top/dev/7000%E5%AD%97+24%E5%BC%A0%E5%9B%BE,%E5%B8%A6%E4%BD%A0%E5%BD%BB%E5%BA%95%E5%BC%84%E6%87%82%E7%BA%BF%E7%A8%8B%E6%B1%A0.html"/>
    <updated>2022-05-21T09:03:15.000Z</updated>
    <summary type="html">7000字+24张图，带你彻底弄懂线程池</summary>
    <content type="html"><![CDATA[<h1 id="_7000字-24张图-带你彻底弄懂线程池" tabindex="-1"> 7000字+24张图，带你彻底弄懂线程池</h1>
<p>图片失效看 ====》7000字+24张图，带你彻底弄懂线程池
<a href="https://kdocs.cn/l/cg3BmyfdA9Ko" target="_blank" rel="noopener noreferrer">https://kdocs.cn/l/cg3BmyfdA9Ko</a></p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/MBJI4AQAPA.png" alt="img" loading="lazy"></p>
<p>今天跟大家聊一聊无论是在工作中常用还是在面试中常问的线程池，通过画图的方式来彻底弄懂线程池的工作原理，以及在实际项目中该如何自定义适合业务的线程池。</p>
<h3 id="一、什么是线程池" tabindex="-1"> 一、什么是线程池</h3>
<p>线程池其实是一种池化的技术的实现，池化技术的核心思想其实就是实现资源的一个复用，避免资源的重复创建和销毁带来的性能开销。在线程池中，线程池可以管理一堆线程，让线程执行完任务之后不会进行销毁，而是继续去处理其它线程已经提交的任务。</p>
<p>使用线程池的好处</p>
<ul>
<li><strong>降低资源消耗。</strong> 通过重复利用已创建的线程降低线程创建和销毁造成的消耗。</li>
<li><strong>提高响应速度。</strong> 当任务到达时，任务可以不需要的等到线程创建就能立即执行。</li>
<li><strong>提高线程的可管理性。</strong> 线程是稀缺资源，如果无限制的创建，不仅会消耗系统资源，还会降低系统 的稳定性，使用线程池可以进行统一的分配，调优和监控。</li>
</ul>
<h3 id="二、线程池的构造" tabindex="-1"> 二、线程池的构造</h3>
<p>Java中主要是通过构建<code>ThreadPoolExecutor</code>来创建线程池的。接下来我们看一下线程池是如何构造出来的</p>
<p>ThreadPoolExecutor的构造方法</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/MBJI4AQA3M.png" alt="img" loading="lazy"></p>
<ul>
<li><code>corePoolSize</code>：线程池中用来工作的核心的线程数量。</li>
<li><code>maximumPoolSize</code>：最大线程数，线程池允许创建的最大线程数。</li>
<li><code>keepAliveTime</code>：超出 corePoolSize 后创建的线程存活时间或者是所有线程最大存活时间，取决于配置。</li>
<li><code>unit</code>：keepAliveTime 的时间单位。</li>
<li><code>workQueue</code>：任务队列，是一个阻塞队列，当线程数已达到核心线程数，会将任务存储在阻塞队列中。</li>
<li><code>threadFactory</code> ：线程池内部创建线程所用的工厂。</li>
<li><code>handler</code>：拒绝策略；当队列已满并且线程数量达到最大线程数量时，会调用该方法处理该任务。</li>
</ul>
<p>线程池的构造其实很简单，就是传入一堆参数，然后进行简单的赋值操作。</p>
<h3 id="三、线程池的运行原理" tabindex="-1"> 三、线程池的运行原理</h3>
<p>说完线程池的核心构造参数的意思，接下来就来画图讲解这些参数在线程池中是如何工作的。</p>
<p>线程池刚创建出来是什么样子呢，如下图</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/DJKI4AQAQI.png" alt="img" loading="lazy"></p>
<p>不错，刚创建出来的线程池中只有一个构造时传入的阻塞队列而已，此时里面并没有的任何线程，但是如果你想要在执行之前已经创建好核心线程数，可以调用<code>prestartAllCoreThreads</code>方法来实现，默认是没有线程的。</p>
<p>当有线程通过execute方法提交了一个任务，会发生什么呢？</p>
<p>提交任务的时候，其实会去进行任务的处理</p>
<p>首先会去判断当前线程池的线程数是否小于核心线程数，也就是线程池构造时传入的参数<code>corePoolSize</code>。</p>
<p>如果小于，那么就直接通过<code>ThreadFactory</code>创建一个线程来执行这个任务，如图</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/CNJY4AQAW4.png" alt="img" loading="lazy"></p>
<p>当任务执行完之后，线程不会退出，而是会去从阻塞队列中获取任务，如下图</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/EFJY4AQALI.png" alt="img" loading="lazy"></p>
<p>接下来如果又提交了一个任务，也会按照上述的步骤，去判断是否小于核心线程数，如果小于，还是会创建线程来执行任务，执行完之后也会从阻塞队列中获取任务。这里有个细节，就是提交任务的时候，就算有线程池里的线程从阻塞队列中获取不到任务，如果线程池里的线程数还是小于核心线程数，那么依然会继续创建线程，而不是复用已有的线程。</p>
<p>如果线程池里的线程数不再小于核心线程数呢？那么此时就会尝试将任务放入阻塞队列中，入队成功之后，如图</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/MJJI4AQAKA.png" alt="img" loading="lazy"></p>
<p>这样在阻塞的线程就可以获取到任务了。</p>
<p>但是，随着任务越来越多，队列已经满了，任务放入失败了，那怎么办呢？</p>
<p>此时就会判断当前线程池里的线程数是否小于最大线程数，也就是入参时的<code>maximumPoolSize</code>参数</p>
<p>如果小于最大线程数，那么也会创建非核心线程来执行提交的任务，如图</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/MJJI4AQA4I.png" alt="img" loading="lazy"></p>
<p>所以，从这里可以发现，就算队列中有任务，新创建的线程还是优先处理这个提交的任务，而不是从队列中获取已有的任务执行，从这可以看出，先提交的任务不一定先执行。</p>
<p>但是不幸的事发生了，线程数已经达到了最大线程数量，那么此时会怎么办呢？</p>
<p>此时就会执行拒绝策略，也就是构造线程池的时候，传入的<code>RejectedExecutionHandler</code>对象，来处理这个任务。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/MNJI4AQA5Y.jpeg" alt="img" loading="lazy"></p>
<p><code>RejectedExecutionHandler</code>的实现JDK自带的默认有4种</p>
<ul>
<li><code>AbortPolicy</code>：丢弃任务，抛出运行时异常</li>
<li><code>CallerRunsPolicy</code>：由提交任务的线程来执行任务</li>
<li><code>DiscardPolicy</code>：丢弃这个任务，但是不抛异常</li>
<li><code>DiscardOldestPolicy</code>：从队列中剔除最先进入队列的任务，然后再次提交任务</li>
</ul>
<p>线程池创建的时候，如果不指定拒绝策略就默认是<code>AbortPolicy</code>策略。当然，你也可以自己实现<code>RejectedExecutionHandler</code>接口，比如将任务存在数据库或者缓存中，这样就数据库或者缓存中获取到被拒绝掉的任务了。</p>
<p>到这里，我们发现，线程池构造的几个参数<code>corePoolSize、maximumPoolSize、workQueue、threadFactory、handler</code>我们都在上述的执行过程中讲到了，那么还差两个参数<code>keepAliveTime</code>和<code>unit</code>(unit是keepAliveTime的时间单位)没讲到，所以<code>keepAliveTime</code>是如何起到作用的呢，这个问题留到后面分析。</p>
<p>说完整个执行的流程，接下来看看execute方法代码是如何实现的。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/HBJY4AQA3M.png" alt="img" loading="lazy"></p>
<ul>
<li><code>workerCountOf(c)&lt;corePoolSize</code>:这行代码就是判断是否小于核心线程数，是的话就通过addWorker方法，addWorker就是添加线程来执行任务。</li>
<li><code>workQueue.offer(command)</code>：这行代码就表示尝试往阻塞队列中添加任务</li>
<li>添加失败之后就会再次调用addWorker方法尝试添加非核心线程来执行任务</li>
<li>如果还是添加非核心线程失败了，那么就会调用<code>reject(command)</code>来拒绝这个任务。</li>
</ul>
<p>最后再来另画一张图总结execute执行流程</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/IJJY4AQADE.png" alt="img" loading="lazy"></p>
<h3 id="四、线程池中线程实现复用的原理" tabindex="-1"> 四、线程池中线程实现复用的原理</h3>
<p>线程池的核心功能就是实现了线程的重复利用，那么线程池是如何实现线程的复用呢？</p>
<p>线程在线程池内部其实是被封装成一个Worker对象</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/K5JY4AQAW4.png" alt="img" loading="lazy"></p>
<p>Worker继承了AQS，也就是有一定锁的特性。</p>
<p>创建线程来执行任务的方法上面提到是通过addWorker方法创建的。在创建Worker对象的时候，会把线程和任务一起封装到Worker内部，然后调用runWorker方法来让线程执行任务，接下来我们就来看一下runWorker方法。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/MRJI4AQA7A.jpeg" alt="img" loading="lazy"></p>
<p>从这张图可以看出线程执行完任务不会退出的原因，runWorker内部使用了while死循环，当第一个任务执行完之后，会不断地通过getTask方法获取任务，只要能获取到任务，就会调用run方法，继续执行任务，这就是线程能够复用的主要原因。</p>
<p>但是如果从getTask获取不到方法的时候，最后就会调用finally中的<code>processWorkerExit</code>方法，来将线程退出。</p>
<p>这里有个一个细节就是，因为Worker继承了AQS，每次在执行任务之前都会调用Worker的lock方法，执行完任务之后，会调用<code>unlock</code>方法，这样做的目的就可以通过<code>Woker</code>的加锁状态就能判断出当前线程是否正在运行任务。</p>
<p>如果想知道线程是否正在运行任务，只需要调用Woker的<code>tryLock</code>方法，根据是否加锁成功就能判断，加锁成功说明当前线程没有加锁，也就没有执行任务了，在调用<code>shutdown</code>方法关闭线程池的时候，就用这种方式来判断线程有没有在执行任务，如果没有的话，来尝试打断没有执行任务的线程。</p>
<h3 id="五、线程是如何获取任务的以及如何实现超时的" tabindex="-1"> 五、线程是如何获取任务的以及如何实现超时的</h3>
<p>上一节我们说到，线程在执行完任务之后，会继续从getTask方法中获取任务，获取不到就会退出。接下来我们就来看一看getTask方法的实现。</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/MVJI4AQARI.jpeg" alt="img" loading="lazy"></p>
<p>getTask方法，前面就是线程池的一些状态的判断，这里有一行代码</p>
<p>boolean timed = allowCoreThreadTimeOut || wc &gt; corePoolSize;</p>
<p>这行代码是判断，当前过来获取任务的线程是否可以超时退出。如果<code>allowCoreThreadTimeOut</code>设置为true或者线程池当前的线程数大于核心线程数，也就是<code>corePoolSize</code>，那么该获取任务的线程就可以超时退出。</p>
<p>那是怎么做到超时退出呢，就是这行核心代码</p>
<p>Runnable r = timed ? workQueue.poll(keepAliveTime, TimeUnit.NANOSECONS) : workQueue.take();</p>
<p>会根据是否允许超时来选择调用阻塞队列<code>workQueue</code>的poll方法或者take方法。如果允许超时，则会调用poll方法，传入<code>keepAliveTime</code>，也就是构造线程池时传入的空闲时间，这个方法的意思就是从队列中阻塞<code>keepAliveTime</code>时间来获取任务，获取不到就会返回null；如果不允许超时，就会调用take方法，这个方法会一直阻塞获取任务，直到从队列中获取到任务位置。从这里可以看到<code>keepAliveTime</code>是如何使用的了。</p>
<p>所以到这里应该就知道线程池中的线程为什么可以做到空闲一定时间就退出了吧。其实最主要的是利用了阻塞队列的poll方法的实现，这个方法可以指定超时时间，一旦线程达到了<code>keepAliveTime</code>还没有获取到任务，那么就会返回null，上一小节提到，<code>getTask</code>方法返回null，线程就会退出。</p>
<p>这里也有一个细节，就是判断当前获取任务的线程是否可以超时退出的时候，如果将<code>allowCoreThreadTimeOut</code>设置为true，那么所有线程走到这个timed都是true，那么所有的线程，包括核心线程都可以做到超时退出。如果你的线程池需要将核心线程超时退出，那么可以通过<code>allowCoreThreadTimeOut</code>方法将<code>allowCoreThreadTimeOut</code>变量设置为true。</p>
<p>整个getTask方法以及线程超时退出的机制如图所示</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/UVJY4AQARI.png" alt="img" loading="lazy"></p>
<h3 id="六、线程池的5种状态" tabindex="-1"> 六、线程池的5种状态</h3>
<p>线程池内部有5个常量来代表线程池的五种状态</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/VRJY4AQAWU.png" alt="img" loading="lazy"></p>
<ul>
<li><strong>RUNNING</strong>：线程池创建时就是这个状态，能够接收新任务，以及对已添加的任务进行处理。</li>
<li><strong>SHUTDOWN</strong>：调用<code>shutdown</code>方法线程池就会转换成<code>SHUTDOWN</code>状态，此时线程池不再接收新任务，但能继续处理已添加的任务到队列中任务。</li>
<li><strong>STOP</strong>：调用<code>shutdownNow</code>方法线程池就会转换成<code>STOP</code>状态，不接收新任务，也不能继续处理已添加的任务到队列中任务，并且会尝试中断正在处理的任务的线程。</li>
<li><strong>TIDYING</strong>：</li>
</ul>
<p><code>SHUTDOWN</code> 状态下，任务数为 0， 其他所有任务已终止，线程池会变为 <code>TIDYING</code> 状态。</p>
<p>线程池在 <code>SHUTDOWN</code> 状态，任务队列为空且执行中任务为空，线程池会变为 <code>TIDYING</code> 状态。</p>
<p>线程池在 <code>STOP</code> 状态，线程池中执行中任务为空时，线程池会变为 <code>TIDYING</code> 状态。</p>
<ul>
<li><strong>TERMINATED</strong>：线程池彻底终止。线程池在 <code>TIDYING</code> 状态执行完 <code>terminated()</code>方法就会转变为 <code>TERMINATED</code> 状态。</li>
</ul>
<p>线程池状态具体是存在ctl成员变量中，ctl中不仅存储了线程池的状态还存储了当前线程池中线程数的大小</p>
<p>private final AtomicInteger ctl = new AtomicInteger(ctlOf(RUNNING, 0));</p>
<p>最后画个图来总结一下这5种状态的流转</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/MZJI4AQA3M.png" alt="img" loading="lazy"></p>
<p>其实，在线程池运行过程中，绝大多数操作执行前都得判断当前线程池处于哪种状态，再来决定是否继续执行该操作。</p>
<h3 id="七、线程池的关闭" tabindex="-1"> 七、线程池的关闭</h3>
<p>线程池提供了<code>shutdown</code>和<code>shutdownNow</code>两个方法来关闭线程池。</p>
<h5 id="shutdown方法" tabindex="-1"> <strong>shutdown方法</strong></h5>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/M5JI4AQA2Q.png" alt="img" loading="lazy"></p>
<p>就是将线程池的状态修改为<code>SHUTDOWN</code>，然后尝试打断空闲的线程（如何判断空闲，上面在说Worker继承AQS的时候说过），也就是在阻塞等待任务的线程。</p>
<h5 id="shutdownnow方法" tabindex="-1"> <strong>shutdownNow方法</strong></h5>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/M5JI4AQA7A.png" alt="img" loading="lazy"></p>
<p>就是将线程池的状态修改为STOP，然后尝试打断所有的线程，从阻塞队列中移除剩余的任务，这也是为什么<code>shutdownNow</code>不能执行剩余任务的原因。</p>
<p>所以也可以看出<code>shutdown</code>方法和<code>shutdownNow</code>方法的主要区别就是，<code>shutdown</code>之后还能处理在队列中的任务，<code>shutdownNow</code>直接就将任务从队列中移除，线程池里的线程就不再处理了。</p>
<h3 id="八、线程池的监控" tabindex="-1"> 八、线程池的监控</h3>
<p>在项目中使用线程池的时候，一般需要对线程池进行监控，方便出问题的时候进行查看。线程池本身提供了一些方法来获取线程池的运行状态。</p>
<ul>
<li>getCompletedTaskCount：已经执行完成的任务数量</li>
<li>getLargestPoolSize：线程池里曾经创建过的最大的线程数量。这个主要是用来判断线程是否满过。</li>
<li>getActiveCount：获取正在执行任务的线程数据</li>
<li>getPoolSize：获取当前线程池中线程数量的大小</li>
</ul>
<p>除了线程池提供的上述已经实现的方法，同时线程池也预留了很对扩展方法。比如在<code>runWorker</code>方法里面，在执行任务之前会回调<code>beforeExecute</code>方法，执行任务之后会回调<code>afterExecute</code>方法，而这些方法默认都是空实现，你可以自己继承<code>ThreadPoolExecutor</code>来扩展重写这些方法，来实现自己想要的功能。</p>
<h3 id="九、executors构建线程池以及问题分析" tabindex="-1"> 九、Executors构建线程池以及问题分析</h3>
<p>JDK内部提供了Executors这个工具类，来快速的创建线程池。</p>
<p>1）固定线程数量的线程池：核心线程数与最大线程数相等</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/NBJI4AQA3M.png" alt="img" loading="lazy"></p>
<p>2）单个线程数量的线程池</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/NBJI4AQA5Y.png" alt="img" loading="lazy"></p>
<p>3）接近无限大线程数量的线程池</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/4FJY4AQA3M.png" alt="img" loading="lazy"></p>
<p>4)带定时调度功能的线程池</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/ZNJY4AQAQI.png" alt="img" loading="lazy"></p>
<p>虽然JDK提供了快速创建线程池的方法，但是其实不推荐使用<code>Executors</code>来创建线程池，因为从上面构造线程池可以看出，<code>newFixedThreadPool</code>线程池，由于使用了<code>LinkedBlockingQueue</code>，队列的容量默认是无限大，实际使用中出现任务过多时会导致内存溢出；<code>newCachedThreadPool</code>线程池由于核心线程数无限大，当任务过多的时候，会导致创建大量的线程，可能机器负载过高，可能会导致服务宕机。</p>
<h3 id="十、线程池的使用场景" tabindex="-1"> 十、线程池的使用场景</h3>
<p>在java程序中，其实经常需要用到多线程来处理一些业务，但是不建议单纯使用继承Thread或者实现Runnable接口的方式来创建线程，那样就会导致频繁创建及销毁线程，同时创建过多的线程也可能引发资源耗尽的风险。所以在这种情况下，使用线程池是一种更合理的选择，方便管理任务，实现了线程的重复利用。所以线程池一般适合那种需要异步或者多线程处理任务的场景。</p>
<h3 id="十一、实际项目中如何合理的自定义线程池" tabindex="-1"> 十一、实际项目中如何合理的自定义线程池</h3>
<p>通过上面分析提到，通过Executors这个工具类来创建的线程池其实都无法满足实际的使用场景，那么在实际的项目中，到底该如何构造线程池呢，该如何合理的设置参数？</p>
<h5 id="_1-线程数" tabindex="-1"> <strong>1）线程数</strong></h5>
<p>线程数的设置主要取决于业务是IO密集型还是CPU密集型。</p>
<p>CPU密集型指的是任务主要使用来进行大量的计算，没有什么导致线程阻塞。一般这种场景的线程数设置为CPU核心数+1。</p>
<p>IO密集型：当执行任务需要大量的io，比如磁盘io，网络io，可能会存在大量的阻塞，所以在IO密集型任务中使用多线程可以大大地加速任务的处理。一般线程数设置为 <code>2*CPU核心数</code></p>
<p>java中用来获取CPU核心数的方法是：<code>Runtime.getRuntime().availableProcessors();</code></p>
<h5 id="_2-线程工厂" tabindex="-1"> <strong>2）线程工厂</strong></h5>
<p>一般建议自定义线程工厂，构建线程的时候设置线程的名称，这样就在查日志的时候就方便知道是哪个线程执行的代码。</p>
<h6 id="_3-有界队列" tabindex="-1"> <strong>3）有界队列</strong></h6>
<p>一般需要设置有界队列的大小，比如<code>LinkedBlockingQueue</code>在构造的时候就可以传入参数，来限制队列中任务数据的大小，这样就不会因为无限往队列中扔任务导致系统的oom。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-08T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">SpringBoot 内置工具类</title>
    <id>https://blog.ciberviler.top/dev/SpringBoot%E5%86%85%E7%BD%AE%E5%B7%A5%E5%85%B7%E7%B1%BB.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringBoot%E5%86%85%E7%BD%AE%E5%B7%A5%E5%85%B7%E7%B1%BB.html"/>
    <updated>2022-05-03T14:10:21.000Z</updated>
    <summary type="html">SpringBoot 内置工具类</summary>
    <content type="html"><![CDATA[<h1 id="springboot-内置工具类" tabindex="-1"> SpringBoot 内置工具类</h1>
<h2 id="断言" tabindex="-1"> 断言</h2>
<ol>
<li>
<p>断言是一个逻辑判断，用于检查不应该发生的情况</p>
</li>
<li>
<p>Assert 关键字在 JDK1.4 中引入，可通过 JVM 参数<code>-enableassertions</code>开启</p>
</li>
<li>
<p>SpringBoot 中提供了 Assert 断言工具类，通常用于数据合法性检查</p>
<div><pre><code><span>// 要求参数 object 必须为非空（Not Null），否则抛出异常，不予放行</span>
<span>// 参数 message 参数用于定制异常信息。</span>
<span>void</span> <span>notNull</span><span>(</span><span>Object</span> object<span>,</span> <span>String</span> message<span>)</span>
<span>// 要求参数必须空（Null），否则抛出异常，不予『放行』。</span>
<span>// 和 notNull() 方法断言规则相反</span>
<span>void</span> <span>isNull</span><span>(</span><span>Object</span> object<span>,</span> <span>String</span> message<span>)</span>
<span>// 要求参数必须为真（True），否则抛出异常，不予『放行』。</span>
<span>void</span> <span>isTrue</span><span>(</span><span>boolean</span> expression<span>,</span> <span>String</span> message<span>)</span>
<span>// 要求参数（List/Set）必须非空（Not Empty），否则抛出异常，不予放行</span>
<span>void</span> <span>notEmpty</span><span>(</span><span>Collection</span> collection<span>,</span> <span>String</span> message<span>)</span>
<span>// 要求参数（String）必须有长度（即，Not Empty），否则抛出异常，不予放行</span>
<span>void</span> <span>hasLength</span><span>(</span><span>String</span> text<span>,</span> <span>String</span> message<span>)</span>
<span>// 要求参数（String）必须有内容（即，Not Blank），否则抛出异常，不予放行</span>
<span>void</span> <span>hasText</span><span>(</span><span>String</span> text<span>,</span> <span>String</span> message<span>)</span>
<span>// 要求参数是指定类型的实例，否则抛出异常，不予放行</span>
<span>void</span> <span>isInstanceOf</span><span>(</span><span>Class</span> type<span>,</span> <span>Object</span> obj<span>,</span> <span>String</span> message<span>)</span>
<span>// 要求参数 `subType` 必须是参数 superType 的子类或实现类，否则抛出异常，不予放行</span>
<span>void</span> <span>isAssignable</span><span>(</span><span>Class</span> superType<span>,</span> <span>Class</span> subType<span>,</span> <span>String</span> message<span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
</ol>
<h2 id="对象、数组、集合" tabindex="-1"> 对象、数组、集合</h2>
<h3 id="objectutils" tabindex="-1"> ObjectUtils</h3>
<ol>
<li>
<p>获取对象的基本信息</p>
<div><pre><code><span>// 获取对象的类名。参数为 null 时，返回字符串："null" </span>
<span>String</span> <span>nullSafeClassName</span><span>(</span><span>Object</span> obj<span>)</span>
<span>// 参数为 null 时，返回 0</span>
<span>int</span> <span>nullSafeHashCode</span><span>(</span><span>Object</span> object<span>)</span>
<span>// 参数为 null 时，返回字符串："null"</span>
<span>String</span> <span>nullSafeToString</span><span>(</span><span>boolean</span><span>[</span><span>]</span> array<span>)</span>
<span>// 获取对象 HashCode（十六进制形式字符串）。参数为 null 时，返回 0 </span>
<span>String</span> <span>getIdentityHexString</span><span>(</span><span>Object</span> obj<span>)</span>
<span>// 获取对象的类名和 HashCode。 参数为 null 时，返回字符串："" </span>
<span>String</span> <span>identityToString</span><span>(</span><span>Object</span> obj<span>)</span>
<span>// 相当于 toString()方法，但参数为 null 时，返回字符串：""</span>
<span>String</span> <span>getDisplayString</span><span>(</span><span>Object</span> obj<span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
<li>
<p>判断工具</p>
<div><pre><code><span>// 判断数组是否为空</span>
<span>boolean</span> <span>isEmpty</span><span>(</span><span>Object</span><span>[</span><span>]</span> array<span>)</span>
<span>// 判断参数对象是否是数组</span>
<span>boolean</span> <span>isArray</span><span>(</span><span>Object</span> obj<span>)</span>
<span>// 判断数组中是否包含指定元素</span>
<span>boolean</span> <span>containsElement</span><span>(</span><span>Object</span><span>[</span><span>]</span> array<span>,</span> <span>Object</span> element<span>)</span>
<span>// 相等，或同为 null时，返回 true</span>
<span>boolean</span> <span>nullSafeEquals</span><span>(</span><span>Object</span> o1<span>,</span> <span>Object</span> o2<span>)</span>
<span>/*
判断参数对象是否为空，判断标准为：
    Optional: Optional.empty()
       Array: length == 0
CharSequence: length == 0
  Collection: Collection.isEmpty()
         Map: Map.isEmpty()
 */</span>
<span>boolean</span> <span>isEmpty</span><span>(</span><span>Object</span> obj<span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
<li>
<p>其他工具方法</p>
<div><pre><code><span>// 向参数数组的末尾追加新元素，并返回一个新数组</span>
<span><span>&lt;</span><span>A</span><span>,</span> <span>O</span> <span>extends</span> <span>A</span><span>></span></span> <span>A</span><span>[</span><span>]</span> <span>addObjectToArray</span><span>(</span><span>A</span><span>[</span><span>]</span> array<span>,</span> <span>O</span> obj<span>)</span>
<span>// 原生基础类型数组 --> 包装类数组</span>
<span>Object</span><span>[</span><span>]</span> <span>toObjectArray</span><span>(</span><span>Object</span> source<span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div></li>
</ol>
<h3 id="stringutils" tabindex="-1"> StringUtils</h3>
<ol>
<li>
<p>字符串判断工具</p>
<div><pre><code><span>// 判断字符串是否为 null，或 ""。注意，包含空白符的字符串为非空</span>
<span>boolean</span> <span>isEmpty</span><span>(</span><span>Object</span> str<span>)</span>
<span>// 判断字符串是否是以指定内容结束。忽略大小写</span>
<span>boolean</span> <span>endsWithIgnoreCase</span><span>(</span><span>String</span> str<span>,</span> <span>String</span> suffix<span>)</span>
<span>// 判断字符串是否已指定内容开头。忽略大小写</span>
<span>boolean</span> <span>startsWithIgnoreCase</span><span>(</span><span>String</span> str<span>,</span> <span>String</span> prefix<span>)</span> 
<span>// 是否包含空白符</span>
<span>boolean</span> <span>containsWhitespace</span><span>(</span><span>String</span> str<span>)</span>
<span>// 判断字符串非空且长度不为 0，即，Not Empty</span>
<span>boolean</span> <span>hasLength</span><span>(</span><span>CharSequence</span> str<span>)</span>
<span>// 判断字符串是否包含实际内容，即非仅包含空白符，也就是 Not Blank</span>
<span>boolean</span> <span>hasText</span><span>(</span><span>CharSequence</span> str<span>)</span>
<span>// 判断字符串指定索引处是否包含一个子串。</span>
<span>boolean</span> <span>substringMatch</span><span>(</span><span>CharSequence</span> str<span>,</span> <span>int</span> index<span>,</span> <span>CharSequence</span> substring<span>)</span>
<span>// 计算一个字符串中指定子串的出现次数</span>
<span>int</span> <span>countOccurrencesOf</span><span>(</span><span>String</span> str<span>,</span> <span>String</span> sub<span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
<li>
<p>字符串操作工具</p>
<div><pre><code><span>// 查找并替换指定子串</span>
<span>String</span> <span>replace</span><span>(</span><span>String</span> inString<span>,</span> <span>String</span> oldPattern<span>,</span> <span>String</span> newPattern<span>)</span>
<span>// 去除尾部的特定字符</span>
<span>String</span> <span>trimTrailingCharacter</span><span>(</span><span>String</span> str<span>,</span> <span>char</span> trailingCharacter<span>)</span> 
<span>// 去除头部的特定字符</span>
<span>String</span> <span>trimLeadingCharacter</span><span>(</span><span>String</span> str<span>,</span> <span>char</span> leadingCharacter<span>)</span>
<span>// 去除头部的空白符</span>
<span>String</span> <span>trimLeadingWhitespace</span><span>(</span><span>String</span> str<span>)</span>
<span>// 去除头部的空白符</span>
<span>String</span> <span>trimTrailingWhitespace</span><span>(</span><span>String</span> str<span>)</span>
<span>// 去除头部和尾部的空白符</span>
<span>String</span> <span>trimWhitespace</span><span>(</span><span>String</span> str<span>)</span>
<span>// 删除开头、结尾和中间的空白符</span>
<span>String</span> <span>trimAllWhitespace</span><span>(</span><span>String</span> str<span>)</span>
<span>// 删除指定子串</span>
<span>String</span> <span>delete</span><span>(</span><span>String</span> inString<span>,</span> <span>String</span> pattern<span>)</span>
<span>// 删除指定字符（可以是多个）</span>
<span>String</span> <span>deleteAny</span><span>(</span><span>String</span> inString<span>,</span> <span>String</span> charsToDelete<span>)</span>
<span>// 对数组的每一项执行 trim() 方法</span>
<span>String</span><span>[</span><span>]</span> <span>trimArrayElements</span><span>(</span><span>String</span><span>[</span><span>]</span> array<span>)</span>
<span>// 将 URL 字符串进行解码</span>
<span>String</span> <span>uriDecode</span><span>(</span><span>String</span> source<span>,</span> <span>Charset</span> charset<span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
<li>
<p>路径相关工具方法</p>
<div><pre><code><span>// 解析路径字符串，优化其中的 “..” </span>
<span>String</span> <span>cleanPath</span><span>(</span><span>String</span> path<span>)</span>
<span>// 解析路径字符串，解析出文件名部分</span>
<span>String</span> <span>getFilename</span><span>(</span><span>String</span> path<span>)</span>
<span>// 解析路径字符串，解析出文件后缀名</span>
<span>String</span> <span>getFilenameExtension</span><span>(</span><span>String</span> path<span>)</span>
<span>// 比较两个两个字符串，判断是否是同一个路径。会自动处理路径中的 “..” </span>
<span>boolean</span> <span>pathEquals</span><span>(</span><span>String</span> path1<span>,</span> <span>String</span> path2<span>)</span>
<span>// 删除文件路径名中的后缀部分</span>
<span>String</span> <span>stripFilenameExtension</span><span>(</span><span>String</span> path<span>)</span> 
<span>// 以 “. 作为分隔符，获取其最后一部分</span>
<span>String</span> <span>unqualify</span><span>(</span><span>String</span> qualifiedName<span>)</span>
<span>// 以指定字符作为分隔符，获取其最后一部分</span>
<span>String</span> <span>unqualify</span><span>(</span><span>String</span> qualifiedName<span>,</span> <span>char</span> separator<span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
</ol>
<h3 id="collectionutils" tabindex="-1"> CollectionUtils</h3>
<ol>
<li>
<p>集合判断工具</p>
<div><pre><code><span>// 判断 List/Set 是否为空</span>
<span>boolean</span> <span>isEmpty</span><span>(</span><span>Collection</span><span><span>&lt;</span><span>?</span><span>></span></span> collection<span>)</span>
<span>// 判断 Map 是否为空</span>
<span>boolean</span> <span>isEmpty</span><span>(</span><span>Map</span><span><span>&lt;</span><span>?</span><span>,</span><span>?</span><span>></span></span> map<span>)</span>
<span>// 判断 List/Set 中是否包含某个对象</span>
<span>boolean</span> <span>containsInstance</span><span>(</span><span>Collection</span><span><span>&lt;</span><span>?</span><span>></span></span> collection<span>,</span> <span>Object</span> element<span>)</span>
<span>// 以迭代器的方式，判断 List/Set 中是否包含某个对象</span>
<span>boolean</span> <span>contains</span><span>(</span><span>Iterator</span><span><span>&lt;</span><span>?</span><span>></span></span> iterator<span>,</span> <span>Object</span> element<span>)</span>
<span>// 判断 List/Set 是否包含某些对象中的任意一个</span>
<span>boolean</span> <span>containsAny</span><span>(</span><span>Collection</span><span><span>&lt;</span><span>?</span><span>></span></span> source<span>,</span> <span>Collection</span><span><span>&lt;</span><span>?</span><span>></span></span> candidates<span>)</span>
<span>// 判断 List/Set 中的每个元素是否唯一。即 List/Set 中不存在重复元素</span>
<span>boolean</span> <span>hasUniqueObject</span><span>(</span><span>Collection</span><span><span>&lt;</span><span>?</span><span>></span></span> collection<span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
<li>
<p>集合操作工具</p>
<div><pre><code><span>// 将 Array 中的元素都添加到 List/Set 中</span>
<span><span>&lt;</span><span>E</span><span>></span></span> <span>void</span> <span>mergeArrayIntoCollection</span><span>(</span><span>Object</span> array<span>,</span> <span>Collection</span><span><span>&lt;</span><span>E</span><span>></span></span> collection<span>)</span>  
<span>// 将 Properties 中的键值对都添加到 Map 中</span>
<span><span>&lt;</span><span>K</span><span>,</span><span>V</span><span>></span></span> <span>void</span> <span>mergePropertiesIntoMap</span><span>(</span><span>Properties</span> props<span>,</span> <span>Map</span><span><span>&lt;</span><span>K</span><span>,</span><span>V</span><span>></span></span> map<span>)</span>
<span>// 返回 List 中最后一个元素</span>
<span><span>&lt;</span><span>T</span><span>></span></span> <span>T</span> <span>lastElement</span><span>(</span><span>List</span><span><span>&lt;</span><span>T</span><span>></span></span> list<span>)</span>  
<span>// 返回 Set 中最后一个元素</span>
<span><span>&lt;</span><span>T</span><span>></span></span> <span>T</span> <span>lastElement</span><span>(</span><span>Set</span><span><span>&lt;</span><span>T</span><span>></span></span> set<span>)</span> 
<span>// 返回参数 candidates 中第一个存在于参数 source 中的元素</span>
<span><span>&lt;</span><span>E</span><span>></span></span> <span>E</span> <span>findFirstMatch</span><span>(</span><span>Collection</span><span><span>&lt;</span><span>?</span><span>></span></span> source<span>,</span> <span>Collection</span><span><span>&lt;</span><span>E</span><span>></span></span> candidates<span>)</span>
<span>// 返回 List/Set 中指定类型的元素。</span>
<span><span>&lt;</span><span>T</span><span>></span></span> <span>T</span> <span>findValueOfType</span><span>(</span><span>Collection</span><span><span>&lt;</span><span>?</span><span>></span></span> collection<span>,</span> <span>Class</span><span><span>&lt;</span><span>T</span><span>></span></span> type<span>)</span>
<span>// 返回 List/Set 中指定类型的元素。如果第一种类型未找到，则查找第二种类型，以此类推</span>
<span>Object</span> <span>findValueOfType</span><span>(</span><span>Collection</span><span><span>&lt;</span><span>?</span><span>></span></span> collection<span>,</span> <span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span><span>[</span><span>]</span> types<span>)</span>
<span>// 返回 List/Set 中元素的类型</span>
<span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> <span>findCommonElementType</span><span>(</span><span>Collection</span><span><span>&lt;</span><span>?</span><span>></span></span> collection<span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
</ol>
<h2 id="文件、资源、io-流" tabindex="-1"> 文件、资源、IO 流</h2>
<h3 id="filecopyutils" tabindex="-1"> FileCopyUtils</h3>
<ol>
<li>
<p>输入</p>
<div><pre><code><span>// 从文件中读入到字节数组中</span>
<span>byte</span><span>[</span><span>]</span> <span>copyToByteArray</span><span>(</span><span>File</span> in<span>)</span>
<span>// 从输入流中读入到字节数组中</span>
<span>byte</span><span>[</span><span>]</span> <span>copyToByteArray</span><span>(</span><span>InputStream</span> in<span>)</span>
<span>// 从输入流中读入到字符串中</span>
<span>String</span> <span>copyToString</span><span>(</span><span>Reader</span> in<span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
<li>
<p>输出</p>
<div><pre><code><span>// 从字节数组到文件</span>
<span>void</span> <span>copy</span><span>(</span><span>byte</span><span>[</span><span>]</span> in<span>,</span> <span>File</span> out<span>)</span>
<span>// 从文件到文件</span>
<span>int</span> <span>copy</span><span>(</span><span>File</span> in<span>,</span> <span>File</span> out<span>)</span>
<span>// 从字节数组到输出流</span>
<span>void</span> <span>copy</span><span>(</span><span>byte</span><span>[</span><span>]</span> in<span>,</span> <span>OutputStream</span> out<span>)</span> 
<span>// 从输入流到输出流</span>
<span>int</span> <span>copy</span><span>(</span><span>InputStream</span> in<span>,</span> <span>OutputStream</span> out<span>)</span> 
<span>// 从输入流到输出流</span>
<span>int</span> <span>copy</span><span>(</span><span>Reader</span> in<span>,</span> <span>Writer</span> out<span>)</span>
<span>// 从字符串到输出流</span>
<span>void</span> <span>copy</span><span>(</span><span>String</span> in<span>,</span> <span>Writer</span> out<span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
</ol>
<h3 id="resourceutils" tabindex="-1"> ResourceUtils</h3>
<ol>
<li>
<p>从资源路径获取文件</p>
<div><pre><code><span>// 判断字符串是否是一个合法的 URL 字符串。</span>
<span>static</span> <span>boolean</span> <span>isUrl</span><span>(</span><span>String</span> resourceLocation<span>)</span>
<span>// 获取 URL</span>
<span>static</span> <span>URL</span> <span>getURL</span><span>(</span><span>String</span> resourceLocation<span>)</span> 
<span>// 获取文件（在 JAR 包内无法正常使用，需要是一个独立的文件）</span>
<span>static</span> <span>File</span>	<span>getFile</span><span>(</span><span>String</span> resourceLocation<span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
<li>
<p>Resource</p>
<div><pre><code><span>// 文件系统资源 D:\...</span>
<span>FileSystemResource</span>
<span>// URL 资源，如 file://... http://...</span>
<span>UrlResource</span>
<span>// 类路径下的资源，classpth:...</span>
<span>ClassPathResource</span>
<span>// Web 容器上下文中的资源（jar 包、war 包）</span>
<span>ServletContextResource</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><div><pre><code><span>// 判断资源是否存在</span>
<span>boolean</span> <span>exists</span><span>(</span><span>)</span>
<span>// 从资源中获得 File 对象</span>
<span>File</span> <span>getFile</span><span>(</span><span>)</span>
<span>// 从资源中获得 URI 对象</span>
<span>URI</span> <span>getURI</span><span>(</span><span>)</span>
<span>// 从资源中获得 URI 对象</span>
<span>URL</span> <span>getURL</span><span>(</span><span>)</span>
<span>// 获得资源的 InputStream</span>
<span>InputStream</span> <span>getInputStream</span><span>(</span><span>)</span>
<span>// 获得资源的描述信息</span>
<span>String</span> <span>getDescription</span><span>(</span><span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
</ol>
<h3 id="streamutils" tabindex="-1"> StreamUtils</h3>
<ol>
<li>
<p>输入</p>
<div><pre><code><span>void</span> <span>copy</span><span>(</span><span>byte</span><span>[</span><span>]</span> in<span>,</span> <span>OutputStream</span> out<span>)</span>
<span>int</span> <span>copy</span><span>(</span><span>InputStream</span> in<span>,</span> <span>OutputStream</span> out<span>)</span>
<span>void</span> <span>copy</span><span>(</span><span>String</span> in<span>,</span> <span>Charset</span> charset<span>,</span> <span>OutputStream</span> out<span>)</span>
<span>long</span> <span>copyRange</span><span>(</span><span>InputStream</span> in<span>,</span> <span>OutputStream</span> out<span>,</span> <span>long</span> start<span>,</span> <span>long</span> end<span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div></li>
<li>
<p>输出</p>
<div><pre><code><span>byte</span><span>[</span><span>]</span> <span>copyToByteArray</span><span>(</span><span>InputStream</span> in<span>)</span>
<span>String</span> <span>copyToString</span><span>(</span><span>InputStream</span> in<span>,</span> <span>Charset</span> charset<span>)</span>
<span>// 舍弃输入流中的内容</span>
<span>int</span> <span>drain</span><span>(</span><span>InputStream</span> in<span>)</span> 
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div></li>
</ol>
<h2 id="反射、aop" tabindex="-1"> 反射、AOP</h2>
<h3 id="reflectionutils" tabindex="-1"> ReflectionUtils</h3>
<ol>
<li>
<p>获取方法</p>
<div><pre><code><span>// 在类中查找指定方法</span>
<span>Method</span> <span>findMethod</span><span>(</span><span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> clazz<span>,</span> <span>String</span> name<span>)</span> 
<span>// 同上，额外提供方法参数类型作查找条件</span>
<span>Method</span> <span>findMethod</span><span>(</span><span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> clazz<span>,</span> <span>String</span> name<span>,</span> <span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span><span>.</span><span>.</span><span>.</span> paramTypes<span>)</span> 
<span>// 获得类中所有方法，包括继承而来的</span>
<span>Method</span><span>[</span><span>]</span> <span>getAllDeclaredMethods</span><span>(</span><span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> leafClass<span>)</span> 
<span>// 在类中查找指定构造方法</span>
<span>Constructor</span><span><span>&lt;</span><span>T</span><span>></span></span> <span>accessibleConstructor</span><span>(</span><span>Class</span><span><span>&lt;</span><span>T</span><span>></span></span> clazz<span>,</span> <span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span><span>.</span><span>.</span><span>.</span> parameterTypes<span>)</span> 
<span>// 是否是 equals() 方法</span>
<span>boolean</span> <span>isEqualsMethod</span><span>(</span><span>Method</span> method<span>)</span> 
<span>// 是否是 hashCode() 方法 </span>
<span>boolean</span> <span>isHashCodeMethod</span><span>(</span><span>Method</span> method<span>)</span> 
<span>// 是否是 toString() 方法</span>
<span>boolean</span> <span>isToStringMethod</span><span>(</span><span>Method</span> method<span>)</span> 
<span>// 是否是从 Object 类继承而来的方法</span>
<span>boolean</span> <span>isObjectMethod</span><span>(</span><span>Method</span> method<span>)</span> 
<span>// 检查一个方法是否声明抛出指定异常</span>
<span>boolean</span> <span>declaresException</span><span>(</span><span>Method</span> method<span>,</span> <span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> exceptionType<span>)</span> 
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
<li>
<p>执行方法</p>
<div><pre><code><span>// 执行方法</span>
<span>Object</span> <span>invokeMethod</span><span>(</span><span>Method</span> method<span>,</span> <span>Object</span> target<span>)</span>  
<span>// 同上，提供方法参数</span>
<span>Object</span> <span>invokeMethod</span><span>(</span><span>Method</span> method<span>,</span> <span>Object</span> target<span>,</span> <span>Object</span><span>.</span><span>.</span><span>.</span> args<span>)</span> 
<span>// 取消 Java 权限检查。以便后续执行该私有方法</span>
<span>void</span> <span>makeAccessible</span><span>(</span><span>Method</span> method<span>)</span> 
<span>// 取消 Java 权限检查。以便后续执行私有构造方法</span>
<span>void</span> <span>makeAccessible</span><span>(</span><span>Constructor</span><span><span>&lt;</span><span>?</span><span>></span></span> ctor<span>)</span> 
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
<li>
<p>获取字段</p>
<div><pre><code><span>// 在类中查找指定属性</span>
<span>Field</span> <span>findField</span><span>(</span><span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> clazz<span>,</span> <span>String</span> name<span>)</span> 
<span>// 同上，多提供了属性的类型</span>
<span>Field</span> <span>findField</span><span>(</span><span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> clazz<span>,</span> <span>String</span> name<span>,</span> <span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> type<span>)</span> 
<span>// 是否为一个 "public static final" 属性</span>
<span>boolean</span> <span>isPublicStaticFinal</span><span>(</span><span>Field</span> field<span>)</span> 
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
<li>
<p>设置字段</p>
<div><pre><code><span>// 获取 target 对象的 field 属性值</span>
<span>Object</span> <span>getField</span><span>(</span><span>Field</span> field<span>,</span> <span>Object</span> target<span>)</span> 
<span>// 设置 target 对象的 field 属性值，值为 value</span>
<span>void</span> <span>setField</span><span>(</span><span>Field</span> field<span>,</span> <span>Object</span> target<span>,</span> <span>Object</span> value<span>)</span> 
<span>// 同类对象属性对等赋值</span>
<span>void</span> <span>shallowCopyFieldState</span><span>(</span><span>Object</span> src<span>,</span> <span>Object</span> dest<span>)</span>
<span>// 取消 Java 的权限控制检查。以便后续读写该私有属性</span>
<span>void</span> <span>makeAccessible</span><span>(</span><span>Field</span> field<span>)</span> 
<span>// 对类的每个属性执行 callback</span>
<span>void</span> <span>doWithFields</span><span>(</span><span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> clazz<span>,</span> <span>ReflectionUtils<span>.</span>FieldCallback</span> fc<span>)</span> 
<span>// 同上，多了个属性过滤功能。</span>
<span>void</span> <span>doWithFields</span><span>(</span><span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> clazz<span>,</span> <span>ReflectionUtils<span>.</span>FieldCallback</span> fc<span>,</span> 
                  <span>ReflectionUtils<span>.</span>FieldFilter</span> ff<span>)</span> 
<span>// 同上，但不包括继承而来的属性</span>
<span>void</span> <span>doWithLocalFields</span><span>(</span><span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> clazz<span>,</span> <span>ReflectionUtils<span>.</span>FieldCallback</span> fc<span>)</span> 
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
</ol>
<h3 id="aoputils" tabindex="-1"> AopUtils</h3>
<ol>
<li>
<p>判断代理类型</p>
<div><pre><code><span>// 判断是不是 Spring 代理对象</span>
<span>boolean</span> <span>isAopProxy</span><span>(</span><span>)</span>
<span>// 判断是不是 jdk 动态代理对象</span>
<span>isJdkDynamicProxy</span><span>(</span><span>)</span>
<span>// 判断是不是 CGLIB 代理对象</span>
<span>boolean</span> <span>isCglibProxy</span><span>(</span><span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
<li>
<p>获取被代理对象的 class</p>
<div><pre><code><span>// 获取被代理的目标 class</span>
<span>Class</span><span><span>&lt;</span><span>?</span><span>></span></span> <span>getTargetClass</span><span>(</span><span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div></li>
</ol>
<h3 id="aopcontext" tabindex="-1"> AopContext</h3>
<ol>
<li>
<p>获取当前对象的代理对象</p>
<div><pre><code><span>Object</span> <span>currentProxy</span><span>(</span><span>)</span>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div></div></div></li>
</ol>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-01T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Java导入导出Excel-POI</title>
    <id>https://blog.ciberviler.top/dev/Java%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BAExcel-POI.html</id>
    <link href="https://blog.ciberviler.top/dev/Java%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BAExcel-POI.html"/>
    <updated>2022-05-21T09:03:15.000Z</updated>
    <summary type="html">Java导入导出Excel-POI</summary>
    <content type="html"><![CDATA[<h1 id="java导入导出excel-poi" tabindex="-1"> Java导入导出Excel-POI</h1>
<h2 id="一、介绍" tabindex="-1"> 一、介绍</h2>
<p>当前B/S模式已成为应用开发的主流，而在企业办公系统中，常常有客户这样子要求：你要把我们的报表直接用Excel打开(电信系统、银行系统)。或者是：我们已经习惯用Excel打印。这样在我们实际的开发中，很多时候需要实现导入、导出Excel的应用。</p>
<p>目前，比较常用的实现Java导入、导出Excel的技术有两种Jakarta POI和Java Excel</p>
<p>下面我就分别讲解一下如何使用这两个技术实现导入、导出Excel</p>
<h2 id="二、使用jakarta-poi导入、导出excel" tabindex="-1"> 二、使用Jakarta POI导入、导出Excel</h2>
<p>Jakarta POI 是一套用于访问微软格式文档的Java API。Jakarta POI有很多组件组成，其中有用于操作Excel格式文件的HSSF和用于操作Word的HWPF，在各种组件中目前只有用于操作Excel的HSSF相对成熟。官方主页<a href="http://poi.apache.org/index.html%EF%BC%8CAPI%E6%96%87%E6%A1%A3http://poi.apache.org/apidocs/index.html" target="_blank" rel="noopener noreferrer">http://poi.apache.org/index.html，API文档http://poi.apache.org/apidocs/index.html</a></p>
<p><strong>例子：</strong></p>
<p>pom文件导入：</p>
<div><pre><code><span><span><span>&lt;</span>dependency</span><span>></span></span>
    <span><span><span>&lt;</span>groupId</span><span>></span></span>org.apache.poi<span><span><span>&lt;/</span>groupId</span><span>></span></span>
    <span><span><span>&lt;</span>artifactId</span><span>></span></span>poi<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
    <span><span><span>&lt;</span>version</span><span>></span></span>5.2.2<span><span><span>&lt;/</span>version</span><span>></span></span>
<span><span><span>&lt;/</span>dependency</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><div><pre><code><span>@Test</span>
<span>void</span> <span>testExport</span><span>(</span><span>)</span><span>{</span>
    <span>//创建HSSFWorkbook对象(excel的文档对象)</span>
    <span>HSSFWorkbook</span> wb <span>=</span> <span>new</span> <span>HSSFWorkbook</span><span>(</span><span>)</span><span>;</span>
    <span>//建立新的sheet对象（excel的表单）</span>
    <span>HSSFSheet</span> sheet<span>=</span>wb<span>.</span><span>createSheet</span><span>(</span><span>"成绩表"</span><span>)</span><span>;</span>
    sheet<span>.</span><span>setDefaultRowHeightInPoints</span><span>(</span><span>20</span><span>)</span><span>;</span><span>//设置缺省列高</span>
    sheet<span>.</span><span>setDefaultColumnWidth</span><span>(</span><span>20</span><span>)</span><span>;</span><span>//设置缺省列宽</span>

    <span>//1、创建HSSFCellStyle</span>
    <span>HSSFCellStyle</span> cellStyle<span>=</span>wb<span>.</span><span>createCellStyle</span><span>(</span><span>)</span><span>;</span>
    <span>//2、设置样式</span>
    <span>// 设置单元格的横向和纵向对齐方式，具体参数就不列了，参考HSSFCellStyle</span>
    cellStyle<span>.</span><span>setAlignment</span><span>(</span><span>HorizontalAlignment</span><span>.</span>CENTER<span>)</span><span>;</span>
    cellStyle<span>.</span><span>setFillBackgroundColor</span><span>(</span><span>(</span><span>short</span><span>)</span> <span>1</span><span>)</span><span>;</span>
    cellStyle<span>.</span><span>setVerticalAlignment</span><span>(</span><span>VerticalAlignment</span><span>.</span>CENTER<span>)</span><span>;</span>
    cellStyle<span>.</span><span>setFillForegroundColor</span><span>(</span><span>IndexedColors</span><span>.</span>GREY_25_PERCENT<span>.</span><span>getIndex</span><span>(</span><span>)</span><span>)</span><span>;</span>
    cellStyle<span>.</span><span>setFillPattern</span><span>(</span><span>FillPatternType</span><span>.</span>SOLID_FOREGROUND<span>)</span><span>;</span>
    <span>//设置填充方式(填充图案)</span>
    <span>//cellStyle.setFillPattern(FillPatternType.DIAMONDS);</span>
    <span>//设置背景颜色</span>
    <span>//cellStyle.setFillBackgroundColor((short) 8);</span>
    <span>//设置日期型数据的显示样式</span>
    cellStyle<span>.</span><span>setDataFormat</span><span>(</span><span>HSSFDataFormat</span><span>.</span><span>getBuiltinFormat</span><span>(</span><span>"yy-mm-dd h:mm"</span><span>)</span><span>)</span><span>;</span>

    <span>//在sheet里创建第一行，参数为行索引(excel的行)，可以是0～65535之间的任何一个</span>
    <span>HSSFRow</span> row1<span>=</span>sheet<span>.</span><span>createRow</span><span>(</span><span>0</span><span>)</span><span>;</span>
    <span>//row1.setHeight((short) 30);</span>
    <span>//创建单元格（excel的单元格，参数为列索引，可以是0～255之间的任何一个</span>
    <span>HSSFCell</span> cell<span>=</span>row1<span>.</span><span>createCell</span><span>(</span><span>0</span><span>)</span><span>;</span>
    cell<span>.</span><span>setCellStyle</span><span>(</span>cellStyle<span>)</span><span>;</span>
    <span>//设置单元格内容</span>
    cell<span>.</span><span>setCellValue</span><span>(</span><span>"学员考试成绩一览表"</span><span>)</span><span>;</span>
    <span>//合并单元格CellRangeAddress构造参数依次表示起始行，截至行，起始列， 截至列</span>
    sheet<span>.</span><span>addMergedRegion</span><span>(</span><span>new</span> <span>CellRangeAddress</span><span>(</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>3</span><span>)</span><span>)</span><span>;</span>
    <span>HSSFCellStyle</span> cellStyle2<span>=</span>wb<span>.</span><span>createCellStyle</span><span>(</span><span>)</span><span>;</span>
    cellStyle2<span>.</span><span>setAlignment</span><span>(</span><span>HorizontalAlignment</span><span>.</span>CENTER<span>)</span><span>;</span>
    cellStyle2<span>.</span><span>setFillForegroundColor</span><span>(</span><span>IndexedColors</span><span>.</span>LIGHT_TURQUOISE1<span>.</span><span>getIndex</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>//在sheet里创建第二行</span>
    <span>HSSFRow</span> row2<span>=</span>sheet<span>.</span><span>createRow</span><span>(</span><span>1</span><span>)</span><span>;</span>
    row2<span>.</span><span>setRowStyle</span><span>(</span>cellStyle2<span>)</span><span>;</span>
    <span>//创建单元格并设置单元格内容</span>
    <span>HSSFCell</span> cell1 <span>=</span> row2<span>.</span><span>createCell</span><span>(</span><span>0</span><span>)</span><span>;</span>
    cell1<span>.</span><span>setCellStyle</span><span>(</span>cellStyle2<span>)</span><span>;</span>
    cell1<span>.</span><span>setCellValue</span><span>(</span><span>"姓名"</span><span>)</span><span>;</span>
    <span>//row2.createCell(0).setCellValue("姓名");</span>
    row2<span>.</span><span>createCell</span><span>(</span><span>1</span><span>)</span><span>.</span><span>setCellValue</span><span>(</span><span>"班级"</span><span>)</span><span>;</span>
    row2<span>.</span><span>createCell</span><span>(</span><span>2</span><span>)</span><span>.</span><span>setCellValue</span><span>(</span><span>"笔试成绩"</span><span>)</span><span>;</span>
    row2<span>.</span><span>createCell</span><span>(</span><span>3</span><span>)</span><span>.</span><span>setCellValue</span><span>(</span><span>"机试成绩"</span><span>)</span><span>;</span>
    <span>//row2.setRowStyle(cellStyle);</span>
    <span>//在sheet里创建第三行</span>
    <span>HSSFRow</span> row3<span>=</span>sheet<span>.</span><span>createRow</span><span>(</span><span>2</span><span>)</span><span>;</span>
    row3<span>.</span><span>createCell</span><span>(</span><span>0</span><span>)</span><span>.</span><span>setCellValue</span><span>(</span><span>"李明"</span><span>)</span><span>;</span>
    row3<span>.</span><span>createCell</span><span>(</span><span>1</span><span>)</span><span>.</span><span>setCellValue</span><span>(</span><span>"As178"</span><span>)</span><span>;</span>
    row3<span>.</span><span>createCell</span><span>(</span><span>2</span><span>)</span><span>.</span><span>setCellValue</span><span>(</span><span>87</span><span>)</span><span>;</span>
    row3<span>.</span><span>createCell</span><span>(</span><span>3</span><span>)</span><span>.</span><span>setCellValue</span><span>(</span><span>78</span><span>)</span><span>;</span>
    <span>//输出Excel文件</span>
    <span>FileOutputStream</span> output<span>=</span> <span>null</span><span>;</span>
    <span>try</span> <span>{</span>
        output <span>=</span> <span>new</span> <span>FileOutputStream</span><span>(</span><span>"e:\\"</span><span>+</span><span>System</span><span>.</span><span>currentTimeMillis</span><span>(</span><span>)</span><span>+</span><span>"workbook.xls"</span><span>)</span><span>;</span>
        wb<span>.</span><span>write</span><span>(</span>output<span>)</span><span>;</span>
        output<span>.</span><span>flush</span><span>(</span><span>)</span><span>;</span>
    <span>}</span> <span>catch</span> <span>(</span><span>IOException</span> e<span>)</span> <span>{</span>
        <span>throw</span> <span>new</span> <span>RuntimeException</span><span>(</span>e<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><blockquote>
<p>以下的一些语法可能是因为版本问题没有该方法</p>
</blockquote>
<h3 id="_2-1-环境配置" tabindex="-1"> 2.1 环境配置</h3>
<h3 id="_2-1-1下载jar" tabindex="-1"> 2.1.1下载jar</h3>
<p>官方下载：<a href="http://poi.apache.org/download.html%E8%BF%99%E9%87%8C%E5%8F%AF%E4%BB%A5%E4%B8%8B%E8%BD%BD%E5%88%B0%E5%AE%83%E7%9A%84%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%E5%92%8C%E6%96%87%E6%A1%A3%EF%BC%8C%E7%9B%AE%E5%89%8D%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%E6%98%AF3.7%EF%BC%8C%E8%BF%99%E9%87%8C%E4%BD%BF%E7%94%A8%E6%AF%94%E8%BE%83%E7%A8%B3%E5%AE%9A%E7%9A%843.6%E7%89%88%E3%80%82" target="_blank" rel="noopener noreferrer">http://poi.apache.org/download.html这里可以下载到它的最新版本和文档，目前最新版本是3.7，这里使用比较稳定的3.6版。</a></p>
<h3 id="_2-1-2加入jar包" tabindex="-1"> 2.1.2加入jar包</h3>
<p>将根目录下的poi-3.6-20091214.jar和Lib目录下三个通用包 commons-logging-1.1.jar junit-3.8.1.jar log4j-1.2.13.jar拷贝到项目的Lib下</p>
<h3 id="_2-2-jakarta-poi-hssf-api组件" tabindex="-1"> 2.2 Jakarta POI HSSF API组件</h3>
<p>HSSF（用于操作Excel的组件）提供给用户使用的对象在rg.apache.poi.hssf.usermodel包中,主要部分包括Excel对象，样式和格式，还有辅助操作。有以下几种对象：</p>
<blockquote>
<p><strong>常用组件：</strong></p>
<p>HSSFWorkbook            excel的文档对象</p>
<p>HSSFSheet             excel的表单</p>
<p>HSSFRow              excel的行</p>
<p>HSSFCell              excel的格子单元</p>
<p>HSSFFont              excel字体</p>
<p>HSSFDataFormat           日期格式</p>
<p>HSSFHeader             sheet头</p>
<p>HSSFFooter             sheet尾（只有打印的时候才能看到效果）</p>
<p><strong>样式：</strong></p>
<p>HSSFCellStyle            cell样式</p>
<p><strong>辅助操作包括：</strong></p>
<p>HSSFDateUtil             日期</p>
<p>HSSFPrintSetup            打印</p>
<p>HSSFErrorConstants          错误信息表</p>
</blockquote>
<h3 id="_2-3-基本操作步骤" tabindex="-1"> 2.3 基本操作步骤</h3>
<p>首先，理解一下一个Excel的文件的组织形式，一个Excel文件对应于一个workbook(HSSFWorkbook)，一个workbook可以有多个sheet（HSSFSheet）组成，一个sheet是由多个row（HSSFRow）组成，一个row是由多个cell（HSSFCell）组成。</p>
<p><strong>基本操作步骤：</strong></p>
<blockquote>
<p>1、用HSSFWorkbook打开或者创建“Excel文件对象”</p>
<p>2、用HSSFWorkbook对象返回或者创建Sheet对象</p>
<p>3、用Sheet对象返回行对象，用行对象得到Cell对象</p>
<p>4、对Cell对象读写。</p>
</blockquote>
<p>下面来看一个动态生成Excel文件的例子：</p>
<div><pre><code>//创建HSSFWorkbook对象
HSSFWorkbook wb = new HSSFWorkbook();
//创建HSSFSheet对象
HSSFSheet sheet = wb.createSheet("sheet0");
//创建HSSFRow对象
HSSFRow row = sheet.createRow(0);
//创建HSSFCell对象
HSSFCell cell=row.createCell(0);
//设置单元格的值
cell.setCellValue("单元格中的中文");
//输出Excel文件
FileOutputStream output=new FileOutputStream("d:\\workbook.xls");
wkb.write(output);
output.flush();
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>HSSF读取文件同样还是使用这几个对象，只是把相应的createXXX方法变成了getXXX方法即可。可见只要理解了其中原理，不管是读还是写亦或是特定格式都可以轻松实现，正所谓知其然更要知其所以然。</p>
<h3 id="_2-4-导出excel应用实例" tabindex="-1"> 2.4 导出Excel应用实例</h3>
<p>在2.3中我们寥寥几行代码实际上就已经就是实现了导出Excel一个简单示例，下面我们在看如何实现导出如图所示的Excel表格？</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/170838550954408.png" alt="img" loading="lazy"></p>
<p>代码如下：（实际开发中应封装到业务层组件中，然后在控制层中调用。这里直接写在控制层组件，如Servlet的doGet/doPost方法或Struts框架的execute方法中）</p>
<div><pre><code>//创建HSSFWorkbook对象(excel的文档对象)
      HSSFWorkbook wb = new HSSFWorkbook();
//建立新的sheet对象（excel的表单）
HSSFSheet sheet=wkb.createSheet("成绩表");
//在sheet里创建第一行，参数为行索引(excel的行)，可以是0～65535之间的任何一个
HSSFRow row1=sheet.createRow(0);
//创建单元格（excel的单元格，参数为列索引，可以是0～255之间的任何一个
HSSFCell cell=row1.createCell(0);
      //设置单元格内容
cell.setCellValue("学员考试成绩一览表");
//合并单元格CellRangeAddress构造参数依次表示起始行，截至行，起始列， 截至列
sheet.addMergedRegion(new CellRangeAddress(0,0,0,3));
//在sheet里创建第二行
HSSFRow row2=sheet.createRow(1);    
      //创建单元格并设置单元格内容
      row2.createCell(0).setCellValue("姓名");
      row2.createCell(1).setCellValue("班级");    
      row2.createCell(2).setCellValue("笔试成绩");
row2.createCell(3).setCellValue("机试成绩");    
      //在sheet里创建第三行
      HSSFRow row3=sheet.createRow(2);
      row3.createCell(0).setCellValue("李明");
      row3.createCell(1).setCellValue("As178");
      row3.createCell(2).setCellValue(87);    
      row3.createCell(3).setCellValue(78);    
  //.....省略部分代码


//输出Excel文件
    OutputStream output=response.getOutputStream();
    response.reset();
    response.setHeader("Content-disposition", "attachment; filename=details.xls");
    response.setContentType("application/msexcel");        
    wkb.write(output);
    output.close();
retrun null;
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>加下划线这部分代码是B/S模式中采用的输出方式，而不是输出到本地指定的磁盘目录。该代码表示将details.xls的Excel文件通过应答实体（response）输出给请求的客户端浏览器，客户端可保存或直接打开。</p>
<h3 id="_2-5-样式设置" tabindex="-1"> 2.5 样式设置</h3>
<p>在实际应用中导出的Excel文件往往需要阅读和打印的，这就需要对输出的Excel文档进行排版和样式的设置，主要操作有合并单元格、设置单元格样式、设置字体样式等。</p>
<h3 id="_2-5-1单元格合并" tabindex="-1"> 2.5.1单元格合并</h3>
<p>使用HSSFSheet的addMergedRegion()方法</p>
<div><pre><code>public int addMergedRegion(CellRangeAddress region)
</code></pre><div aria-hidden="true"><div></div></div></div><p>参数CellRangeAddress 表示合并的区域，构造方法如下：</p>
<div><pre><code>CellRangeAddress(int firstRow, int lastRow, int firstCol, int lastCol)
</code></pre><div aria-hidden="true"><div></div></div></div><p>构造参数依次表示起始行，截至行，起始列， 截至列。示例代码参照2.4部分</p>
<h3 id="_2-5-2设置单元格的行高、列宽" tabindex="-1"> 2.5.2设置单元格的行高、列宽</h3>
<div><pre><code>HSSFSheet sheet=wb.createSheet();

sheet.setDefaultRowHeightInPoints(10);//设置缺省列高sheet.setDefaultColumnWidth(20);//设置缺省列宽

//设置指定列的列宽，256 * 50这种写法是因为width参数单位是单个字符的256分之一

sheet.setColumnWidth(cell.getColumnIndex(), 256 * 50);
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_2-5-2单元格样式" tabindex="-1"> 2.5.2单元格样式</h3>
<p>1、创建HSSFCellStyle</p>
<div><pre><code> HSSFCellStyle cellStyle=wkb.createCellStyle();
</code></pre><div aria-hidden="true"><div></div></div></div><p>2、设置样式</p>
<div><pre><code> // 设置单元格的横向和纵向对齐方式，具体参数就不列了，参考HSSFCellStyle

  cellStyle.setAlignment(HSSFCellStyle.ALIGN_JUSTIFY);

  cellStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);

  /* 设置单元格的填充方式，以及前景颜色和背景颜色

   三点注意：

   1.如果需要前景颜色或背景颜色，一定要指定填充方式，两者顺序无所谓；

   2.如果同时存在前景颜色和背景颜色，前景颜色的设置要写在前面；

   3.前景颜色不是字体颜色。

  */

  //设置填充方式(填充图案)

  cellStyle.setFillPattern(HSSFCellStyle.DIAMONDS);

  //设置前景色

  cellStyle.setFillForegroundColor(HSSFColor.RED.index);

  //设置背景颜色

  cellStyle.setFillBackgroundColor(HSSFColor.LIGHT_YELLOW.index);

  // 设置单元格底部的边框及其样式和颜色

  // 这里仅设置了底边边框，左边框、右边框和顶边框同理可设

  cellStyle.setBorderBottom(HSSFCellStyle.BORDER_SLANTED_DASH_DOT);

  cellStyle.setBottomBorderColor(HSSFColor.DARK_RED.index);

  //设置日期型数据的显示样式

  cellStyle.setDataFormat(HSSFDataFormat.getBuiltinFormat("m/d/yy h:mm"));  
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>3、将样式应用于单元格</p>
<div><pre><code>  cell.setCellStyle(cellStyle);

  //将样式应用到行，但有些样式只对单元格起作用

  row.setRowStyle(cellStyle);
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_2-5-2设置字体样式" tabindex="-1"> 2.5.2设置字体样式</h3>
<p>1、创建HSSFFont对象（调用HSSFWorkbook 的createFont方法）</p>
<div><pre><code>HSSFWorkbook wb=new HSSFWorkbook();

HSSFFont  fontStyle=wb.createFont();

HSSFWorkbook wb=new HSSFWorkbook ();
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>2、设置字体各种样式</p>
<div><pre><code>  //设置字体样式

  fontStyle.setFontName("宋体");  

  //设置字体高度

  fontStyle.setFontHeightInPoints((short)20);  

  //设置字体颜色

  font.setColor(HSSFColor.BLUE.index);

  //设置粗体

  fontStyle.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);

  //设置斜体

font.setItalic(true);

//设置下划线

font.setUnderline(HSSFFont.U_SINGLE);
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>3、将字体设置到单元格样式</p>
<div><pre><code>//字体也是单元格格式的一部分，所以从属于HSSFCellStyle

// 将字体对象赋值给单元格样式对象

cellStyle.setFont(font);

// 将单元格样式应用于单元格

cell.setCellStyle(cellStyle);
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_2-6-导入excel应用实例" tabindex="-1"> 2.6 导入Excel应用实例</h3>
<p>实现将已存在的Excel文件中的数据导入到系统中的基本步骤同导出十分的类似，关键在于要了解要导入Excel文件的结构，比如数据有哪些列、读取数据起始位置（有效数据从第几行几列开始）等。在实际项目中由于这些数据（Excel文件）往往来自于日常办公人员或其他系统平台产生的业务数据，因此这些Excel文件的数据格式要有统一的要求，并提供访问接口（指访问途径），这样在所需数据的系统中就可通过提供这个访问接口调用方法，从而获得数据。解决方案采用Web Service是不错的选择。这里，我们就以导入2..4所产生的excel表为例，重点掌握如何编写导入Excel代码</p>
<div><pre><code>public List&lt;ScoreInfo> loadScoreInfo(String xlsPath) throws IOException{
    List temp = new ArrayList();
FileInputStream fileIn = new FileInputStream(xlsPath);
//根据指定的文件输入流导入Excel从而产生Workbook对象
Workbook wb0 = new HSSFWorkbook(fileIn);
//获取Excel文档中的第一个表单
Sheet sht0 = wb0.getSheetAt(0);
//对Sheet中的每一行进行迭代
        for (Row r : sht0) {
        //如果当前行的行号（从0开始）未达到2（第三行）则从新循环
If(r.getRowNum()&lt;1){
continue;
}
//创建实体类
ScoreInfo info=new ScoreInfo();
//取出当前行第1个单元格数据，并封装在info实体stuName属性上
info.setStuName(r.getCell(0).getStringCellValue());
info.setClassName(r.getCell(1).getStringCellValue());
info.setRscore(r.getCell(2).getNumericCellValue());
            info.setLscore(r.getCell(3).getNumericCellValue());
temp.add(info);
        }
        fileIn.close();    
        return temp;    
    }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><em><strong>*三、使用java Excel操作Excel文件*</strong></em></p>
<p>Java Excel是一开放源码项目，通过它Java开发人员可以读取Excel文件的内容、创建新的Excel文件、更新已经存在的Excel文件。jxl 由于其小巧 易用的特点, 逐渐已经取代了 POI-excel的地位, 成为了越来越多的java开发人员生成excel文件的首选。Java Excel的特征：</p>
<blockquote>
<p>● 支持Excel 95-2000的所有版本
● 生成Excel 2000标准格式
● 支持字体、数字、日期格式化操作
● 支持对单元格加阴影和加色彩；</p>
<p>● 修改存在的工作表；
● 支持图像和图表</p>
<p>● 日志记录可以定制</p>
<p>● 更小更快更省内存</p>
</blockquote>
<p>应该说以上功能已经能够大致满足我们的需要。最关键的是这套API是纯Java的，并不依赖Windows系统，即使运行在Linux下，它同样能够正确 的处理Excel文件。另外需要说明的是，这套API对图形和图表的支持很有限，而且仅仅识别PNG格式。 在线帮助文档<a href="http://jexcelapi.sourceforge.net/resources/javadocs/2_6_10/docs/index.html" target="_blank" rel="noopener noreferrer">http://jexcelapi.sourceforge.net/resources/javadocs/2_6_10/docs/index.html</a></p>
<p>在这里我们将通过一些实例，学习掌握读取、新建、更新，其中也包括常见格式的设置:字体、颜色、背景、合并单元格等操作，有这些其实已经基本足够应付大部分问题了。</p>
<h3 id="_3-1环境配置" tabindex="-1"> 3.1环境配置</h3>
<h3 id="_3-1-1下载" tabindex="-1"> 3.1.1下载</h3>
<p>下载地址  <a href="http://www.andykhan.com/jexcelapi/" target="_blank" rel="noopener noreferrer">http://www.andykhan.com/jexcelapi/</a></p>
<h3 id="_3-1-2-加入jar包" tabindex="-1"> 3.1.2 加入jar包</h3>
<p>将jxl.jar拷贝到项目的Lib下</p>
<h3 id="_3-2-使用java-excel-api-导出-excel文件" tabindex="-1"> 3.2 使用Java Excel Api 导出 Excel文件</h3>
<p>下面我们在看如何使用Java Excel实现导出Excel表格？</p>
<p>代码如下：（实际开发中应封装到业务层组件中，然后在控制层中调用。这里直接写在控制层组件，如Servlet的doGet/doPost方法或Struts框架的execute方法中）</p>
<div><pre><code>//获得输出流，该输出流的输出介质是客户端浏览器

  OutputStream output=response.getOutputStream();

  response.reset();

  response.setHeader("Content-disposition","attachment;           filename=temp.xls");

  response.setContentType("application/msexcel");

  //创建可写入的Excel工作薄，且内容将写入到输出流，并通过输出流输出给客户端浏览
  WritableWorkbook wk=Workbook.createWorkbook(output);


///创建可写入的Excel工作表

    WritableSheet sheet=wk.createSheet("成绩表", 0);

//把单元格（column, row）到单元格（column1, row1）进行合并。

//mergeCells(column, row, column1, row1);

  sheet.mergeCells(0,0, 4,0);//单元格合并方法

//创建WritableFont 字体对象，参数依次表示黑体、字号12、粗体、非斜体、不带下划线、亮蓝色

WritableFont titleFont=new WritableFont(WritableFont.createFont("黑体"),12,WritableFont.BOLD,false,UnderlineStyle.NO_UNDERLINE,Colour.LIGHT_BLUE);

//创建WritableCellFormat对象，将该对象应用于单元格从而设置单元格的样式

WritableCellFormat titleFormat=new WritableCellFormat();

//设置字体格式

titleFormat.setFont(titleFont);

//设置文本水平居中对齐

titleFormat.setAlignment(Alignment.CENTRE);

//设置文本垂直居中对齐

titleFormat.setVerticalAlignment(VerticalAlignment.CENTRE);

//设置背景颜色

titleFormat.setBackground(Colour.GRAY_25);

//设置自动换行

titleFormat.setWrap(true);

//添加Label对象，参数依次表示在第一列，第一行，内容，使用的格式

Label lab_00=new Label(0,0,"学员考试成绩一览表",titleFormat);

//将定义好的Label对象添加到工作表上，这样工作表的第一列第一行的内容为‘学员考试成绩一览表’并应用了titleFormat定义的样式

sheet.addCell(lab_00);

WritableCellFormat cloumnTitleFormat=new WritableCellFormat();

cloumnTitleFormat.setFont(new WritableFont(WritableFont.createFont("宋体"),10,WritableFont.BOLD,false));

cloumnTitleFormat.setAlignment(Alignment.CENTRE);

Label lab_01=new Label(0,1,"姓名",cloumnTitleFormat);

Label lab_11=new Label(1,1,"班级",cloumnTitleFormat);

Label lab_21=new Label(2,1,"笔试成绩",cloumnTitleFormat);
Label lab_31=new Label(3,1,"上机成绩",cloumnTitleFormat);

Label lab_41=new Label(4,1,"考试日期",cloumnTitleFormat);

  sheet.addCell(lab_01);

  sheet.addCell(lab_11);

  sheet.addCell(lab_21);

  sheet.addCell(lab_31);

  sheet.addCell(lab_41);

  sheet.addCell(new Label(0,2,"李明"));

  sheet.addCell(new Label(1,2,"As178"));

//定义数字格式

NumberFormat nf=new NumberFormat("0.00");

WritableCellFormat wcf=new WritableCellFormat(nf);

//类似于Label对象，区别Label表示文本数据，Number表示数值型数据

Number numlab_22=new Number(2,2,78,wcf);

sheet.addCell(numlab_22);

sheet.addCell(newNumber(3,2,87,new WritableCellFormat(new NumberFormat("#.##") )));

//定义日期格式

DateFormat df=new DateFormat("yyyy-MM-dd hh:mm:ss");

//创建WritableCellFormat对象

WritableCellFormat datewcf=new WritableCellFormat(df);

//类似于Label对象，区别Label表示文本数据，DateTime表示日期型数据

DateTime dtLab_42=new DateTime(4,2,new Date(),datewcf);

sheet.addCell(dtLab_42);   

//将定义的工作表输出到之前指定的介质中（这里是客户端浏览器）

wk.write();

//操作完成时，关闭对象，释放占用的内存空间   

wk.close();
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>加下划线这部分代码是B/S模式中采用的输出方式，而不是输出到本地指定的磁盘目录。该代码表示将temp.xls的Excel文件通过应答实体（response）输出给请求的客户端浏览器，下载到客户端本地（保存或直接打开）。若要直接输出到磁盘文件可采用下列代码替换加下划线这部分代码</p>
<div><pre><code>File file=new File("D://temp.xls");
WritableWorkbook wwb = Workbook.createWorkbook(file); 
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><h3 id="_3-3高级操作" tabindex="-1"> 3.3高级操作</h3>
<h3 id="_3-3-1数据格式化" tabindex="-1"> 3.3.1数据格式化</h3>
<p>在Excel中不涉及复杂的数据类型，能够比较好的处理字串、数字和日期已经能够满足一般的应用即可。</p>
<p>数据的格式化涉及到的是字体、粗细、字号等元素，这些功能主要由 WritableFont和WritableCellFormat类来负责。例如：</p>
<blockquote>
<p>① WritableFont font=new WritableFont(WritableFont.createFont(&quot;宋体&quot;),12,WritableFont.NO_BOLD );</p>
<p>② WritableCellFormat format1=new WritableCellFormat(font);</p>
<p>③ Label label=new Label(0,0,”data 4 test”,format1);</p>
</blockquote>
<p>其中</p>
<blockquote>
<p>I.指定了字串格式：字体为宋体，字号16，加粗显示。WritableFont有非常丰富的构造子，供不同情况下使用，jExcelAPI的java-doc中有详细列表，这里不再列出。</p>
<p>II. 处代码使用了WritableCellFormat类，这个类非常重要，通过它可以指定单元格的各种属性，如上例代码所示。</p>
<p>III. 处使用了Label类的构造子，指定了显示的位置，文本内容，字串被赋予的格式。</p>
<p>与Label类似的Number、DateTime，区别Label表示文本数据；Number表示数值数据，可使NumberFormat格式化数据；用DateTime表示日期型数据，可应用DateFormat格式化数据。</p>
</blockquote>
<h3 id="_3-3-2单元格操作" tabindex="-1"> 3.3.2单元格操作</h3>
<p>Excel中很重要的一部分是对单元格的操作，比如行高、列宽、单元格合并等，所幸jExcelAPI提供了这些支持。这些操作相对比较简单，下面只介绍一下相关的API。</p>
<p><strong>1</strong>**、** <strong>合并单元格</strong></p>
<div><pre><code>WritableSheet.mergeCells(int m,int n,int p,int q);

//作用是从(m,n)到(p,q)的单元格全部合并，比如：

WritableSheet sheet=book.createSheet(“第一页”,0);

//合并第一列第一行到第六列第一行的所有单元格

sheet.mergeCells(0,0,5,0);

//合并既可以是横向的，也可以是纵向的。合并后的单元格不能再次进行合并，否则会触发异常。
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>2</strong>**、** <strong>行高和列宽</strong></p>
<div><pre><code> writableSheet.setRowView(int i,int height);

//作用是指定第i+1行的高度，比如：

// 将第一行的高度设为200

sheet.setRowView(0,200);

WritableSheet.setColumnView(int i,int width);

//作用是指定第i+1列的宽度，比如：

//将第一列的宽度设为30

sheet.setColumnView(0,30); 
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_3-4-从excel文件读取数据表" tabindex="-1"> 3.4 　从Excel文件读取数据表</h3>
<p>我们就以导入3.2所产生的excel表为例，掌握如何编写导入Excel代码(该代码封装在业务层方法)</p>
<div><pre><code>public List&lt;ScoreInfo> loadScoreInfo(String xlsPath) throws IOException, BiffException{

//导入已存在的Excel文件，获得只读的工作薄对象
        FileInputStream fis=new FileInputStream(xlsPath);
        Workbook wk=Workbook.getWorkbook(fis);
        //获取第一张Sheet表 
        Sheet sheet=wk.getSheet(0);
        //获取总行数
int rowNum=sheet.getRows();
//从数据行开始迭代每一行
        for(int i=2;i&lt;rowNum;i++){
ScoreInfo info=new ScoreInfo();        
//getCell(column,row)，表示取得指定列指定行的单元格（Cell）
//getContents()获取单元格的内容，返回字符串数据。适用于字符型数据的单元格
//使用实体类封装单元格数据
info.setStuName(sheet.getCell(0, i).getContents());
            info.setClassName(sheet.getCell(1, i).getContents());
            //判断单元格的类型，单元格主要类型LABEL、NUMBER、DATE                    if(sheet.getCell(2,i).getType==CellType.NUMBER){

//转化为数值型单元格
NumberCell numCell=(NumberCell)sheet.getCell(2,i);
//NumberCell的getValue()方法取得单元格的数值型数据
info.setRscore(numCell.getValue());

}
if(sheet.getCell(3,i).getType==CellType.NUMBER){
NumberCell numCell=(NumberCell)sheet.getCell(3,i);
info.setRscore(numCell.getValue);
}

if(sheet.getCell(4,i).getType==CellType.DATE){
DateCell dateCell=(DateCell)sheet.getCell(4,i);
//DateCell的getDate()方法取得单元格的日期型数据
info.setDate(dateCell.getDate());
}
        }
        fis.close();
        wk.close();
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_3-4-更新已存在的excel文件" tabindex="-1"> 3.4 　更新已存在的Excel文件</h3>
<p>将3.2所产生的excel表（temp.xls）的第一条记录（excel文件的指第三行）的班级名称改为As179，代码如下：</p>
<div><pre><code>File file=new File("d://temp.xls");
//导入已存在的Excel文件，获得只读的工作薄对象
Workbook wk=Workbook.getWorkbook(file);
//根据只读的工作薄对象（wk）创建可写入的Excel工作薄对象 
        WritableWorkbook wwb=Workbook.createWorkbook(file, wk);
//读取第一张工作表 
        WritableSheet sheet=wwb.getSheet(0);
///获得要编辑的单元格对象 
        WritableCell cell=sheet.getWritableCell(1, 2);
        //判断单元格的类型, 做出相应的转化 
if(cell.getType()==CellType.LABEL){
            Label lable=(Label)cell;
            //修改单元格的内容
lable.setString("As179");
        }
    wwb.write(); 
    wwb.close(); 
    wk.close(); 
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>对于更新已存在的Excel文件实际上就是获取已有工作薄对象（但是只读的），然后将获取的只读的工作薄对象转化为可写入的Excel工作薄对象（WritableWorkbook ），其他部分就是通过可写入WritableSheet 对象和可写入WritableCell 对象进行编辑。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-29T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">架构师图谱·微服务&amp;消息队列篇</title>
    <id>https://blog.ciberviler.top/dev/%E6%9E%B6%E6%9E%84%E5%B8%88%E5%9B%BE%E8%B0%B1%C2%B7%E5%BE%AE%E6%9C%8D%E5%8A%A1&amp;%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E7%AF%87.html</id>
    <link href="https://blog.ciberviler.top/dev/%E6%9E%B6%E6%9E%84%E5%B8%88%E5%9B%BE%E8%B0%B1%C2%B7%E5%BE%AE%E6%9C%8D%E5%8A%A1&amp;%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E7%AF%87.html"/>
    <updated>2022-04-28T02:37:09.000Z</updated>
    <summary type="html">架构师图谱·微服务&amp;消息队列篇</summary>
    <content type="html"><![CDATA[<h1 id="架构师图谱·微服务-消息队列篇" tabindex="-1"> 架构师图谱·微服务&amp;消息队列篇</h1>
<h2 id="_1-概述" tabindex="-1"> 1. 概述</h2>
<p>“架构师图谱”是一个很宏大的命题，特别是优秀的架构师自身也是“由点到面再到图”，一点点成长积累起来，尝试写这系列文章的目的更多的是结合自身的一些经验和理解，来解读工程师和架构师所应具备的技能模型，这里会更偏向于后端技能，依赖于开源技术、云原生或者其他第三方服务。重点介绍一些技术栈、设计理念和适应场景，这些可以作为我们选型时的依据。所谓“架构即决策”，是在一个有约束的盒子中寻求最优解。这个有约束的盒子是团队经验、成本、资源、进度、业务所处阶段等编织、掺杂在一起的综合体。本质上无优劣，但是存在恰当的架构用在合适的软件系统中，而这些就是决策的结果。</p>
<h3 id="_1-1-序章" tabindex="-1"> 1.1 序章</h3>
<p>一个技术图谱：</p>
<p><a href="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/uTools_1621160730437.png" target="_blank" rel="noopener noreferrer"><img src="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/uTools_1621160730437.png" alt="img" loading="lazy"></a></p>
<p>计划会分三个篇章来介绍：</p>
<ol>
<li>微服务&amp;消息队列篇：重点聚焦在微服务和常用的消息队列，包括相关的选型以及一些理论基础</li>
<li>数据库&amp;分布式篇：主要集中在数据库、分布式（一致性/锁/缓存/发号/任务调度等）</li>
<li>尾篇：分享一些流媒体、Devops、项目管理、团队建设方向的一些经验</li>
</ol>
<p>完整的思维导图：</p>
<p><a href="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/ArchitectMap-2.png" target="_blank" rel="noopener noreferrer"><img src="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/ArchitectMap-2.png" alt="img" loading="lazy"></a></p>
<h2 id="_2-微服务" tabindex="-1"> 2. 微服务</h2>
<p>谈到微服务，通常会和SOA、微内核等架构进行比较，不过SOA粗粒度服务、庞大的ESB，在互联网更注重敏捷交付的场景，落地较少。微内核架构和微服务架构没有本质上的区别，但是更多的面向插件化场景，在一些类似营销、风控、工作流、管线等场景，对应的微服务可以采用微内核架构。</p>
<blockquote>
<p><strong>微服务</strong>（英语：Microservices）是一种<a href="https://zh.wikipedia.org/wiki/%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84" target="_blank" rel="noopener noreferrer">软件架构风格</a>，它是以专注于单一责任与功能的小型功能区块 (Small Building Blocks) 为基础，利用模块化的方式组合出复杂的大型应用程序，各功能区块使用与语言无关 (Language-Independent/Language agnostic）的<a href="https://zh.wikipedia.org/wiki/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%8F%A3" target="_blank" rel="noopener noreferrer">API</a>集相互通信。</p>
</blockquote>
<p>微服务架构有别于更为传统的单体巨石服务，可将应用拆分成多个核心功能。每个功能都被称为一项服务，可以单独构建和部署。这也体现了可扩展的基本思想：将原本大一统的系统拆成多个小部分，扩展时只修改其中一部分，通过这种方式减少改动范围，降低改动风险。</p>
<p>微服务架构涵盖了服务的多个方面，包括理论基础、网关、通信协议以及服务注册/发现、可观察性等基础设施。</p>
<h3 id="_2-1-理论基础" tabindex="-1"> 2.1 理论基础</h3>
<p>微服务的理论基础主要用来指导微服务架构设计、服务拆分，确定合适的服务粒度和边界。在做微服务之前我们首先要想明白我们现有系统面临什么样的问题，为什么需要微服务，随后才是怎么做。</p>
<p>微服务很多核心理念其实在半个世纪前的一篇文章中就被阐述过了，而且这篇文章中的很多论点在软件开发飞速发展的这半个世纪中竟然一再被验证，这就是康威定律（Conway’s Law）。在康威的这篇文章中，最有名的一句话就是：</p>
<blockquote>
<p>Organizations which design systems are constrained to produce designs which are copies of the communication structures of these organizations. – Melvin Conway(1967)</p>
</blockquote>
<p>中文直译大概的意思就是：设计系统的组织，其产生的设计等同于组织之内、组织之间的沟通结构。 最初这篇文章只是描述作者自己的发现和总结，后来“人月神话”中，引用这个观点，并将其“吹捧”成现在熟知的“康威定律”，其中的一些核心观点可以概括如下：</p>
<ul>
<li>组织沟通方式决定系统设计，对于复杂的系统，聊设计就离不开聊人与人的沟通，解决好人与人的沟通问题，才能有一个好的系统设计</li>
<li>时间再多一件事情也不可能做的完美，但总有时间做完一件事情，这与架构设计的“简单、合适、演化”思维不谋而合</li>
<li>线型系统和线型组织架构间有潜在的异质同态特征，更直白的说，你想要什么样的系统，就搭建什么样的团队，定义好系统的边界和接口，团队内应该是自治的，这样将沟通成本维持在系统内部，每个子系统就会更加内聚</li>
<li>大的系统组织总是比小系统更倾向于分解，面对复杂的系统及组织，往往可以采用分而治之</li>
</ul>
<p>“康威定律”更多的阐述了影响微服务实施的一些软性因素，再具体到业务上，我们需要结合业务现状、复杂度、团队现状进行进一步的评估、分析，再采用合适的方式进行拆分。面向业务拆分，我们一般需要考虑：</p>
<ul>
<li>单体到微服务的拆分：从非核心服务到核心服务完成拆分，基础设施按照优先级进行落地。</li>
<li>粗粒度拆分微服务：按照质量（性能、复杂度、可用性）、交付频率拆分，重用现在的基础设施。</li>
<li>服务拆分的粒度：能够维持2-4个人维护一个微服务最佳，过少会导致没有备份，思维局限，过多也会使得每个人无法掌握服务所有细节，以及潜在较高的协作、交付成本。</li>
</ul>
<p>当我们的业务和组织架构复杂度比较高的时候，很多概念只从技术的角度很难去抽象。但是为了达到可复制，足够的抽象是必须的，越高层的抽象越稳定，越细节的东西越容易变化。因此我们需要把思考层次从代码细节、技术架构拉到业务层面。</p>
<p>我们不妨自上而下，建立起通用语言，通过对不同领域的建模，逐步确定领域范围和业务边界，这也就是领域驱动设计（DDD）。 DDD 是一种在面向高度复杂的软件系统时，关于如何去建模的方法论，它的关键点是根据系统的复杂程度建立合适的模型，DDD中的限界上下文也完美匹配了微服务的高内聚、低耦合特性，这也为我们微服务的划分提供了强有力的基础。</p>
<p>除了微服务，在平台和中台的建设上，我们也经常谈及DDD，平台是解决公共能力的复用问题，防止重复造轮子，中台则是“企业级能力的复用”，中台从业务和平台服务中不断抽象和聚合，建立领域模型，形成的一整套可复用的平台级解决方案，这点和DDD战略设计不谋而合。平台和中台建模之后，我们就需要通过DDD的架构设计和微服务完成系统架构，平台、中台和微服务可以说是DDD一个落地的最佳场景，这也是DDD逐渐火热的重要原因。</p>
<p>DDD实施的一般步骤是：</p>
<ul>
<li>进行战略设计，结合数据流向，上下文依赖，通过组合抽象的方式，逐渐形成一个较为完整的领域，这就是确定限界上下文和领域边界的过程</li>
<li>进行战术设计，进一步分析每个上下文内部，识别出哪些是实体，哪些是值对象，哪些是领域事件，对实体、值对象进行关联和聚合，划分出聚合的范畴和聚合根，为聚合根设计仓储，并思考实体或值对象的创建方式</li>
<li>进行架构设计，结合限界上下文拆分微服务，对服务内的代码进行分层、实现，在工程中实践领域模型，并在实践中检验模型的合理性，倒推模型中不足的地方并重构</li>
</ul>
<p>DDD并不是银弹，首先是团队对DDD的掌握程度以及领域专家（可以是研发、产品、测试等）的水平，一定程度上都会影响到DDD的落地，这里有几本关于DDD的书籍，由浅及深，非常推荐去阅读：</p>
<ul>
<li>《<a href="https://item.jd.com/12447082.html" target="_blank" rel="noopener noreferrer">领域设计精粹</a>》</li>
<li>《<a href="https://item.jd.com/13131498.html" target="_blank" rel="noopener noreferrer">实现领域驱动设计</a>》</li>
<li>《<a href="https://item.jd.com/11961038.html" target="_blank" rel="noopener noreferrer">领域驱动设计：软件核心复杂性应对之道</a>》</li>
</ul>
<p>其次，在一些新业务场景，本身就充满了很多的不确定性，一次性把边界划清楚并不是一件很容易的事。大家在一个进程里，调整起来会相对容易，然后让不同的限界上下文各自演化，等到了一定程度之后再考虑微服务也是一个不错的选择。</p>
<h3 id="_2-2-网关" tabindex="-1"> 2.2 网关</h3>
<p>作为微服务的统一入口，也肩负着整个微服务的流量接入、管理、聚合、安全等，从服务分层的角度可以划分为接入网关和业务网关。</p>
<p><strong>接入网关</strong> 接入网关提供最基础的流量接入和安全防护能力，侧重于全局，与业务无关。</p>
<ul>
<li>域名&amp;DNS，作为服务的流量入口，对外通过域名和DNS提供服务，国内域名厂商一般都依托于共有云或被共有云厂商收购，用来完善自由的云生态，像阿里的万网，腾讯的DNSPod等，也有国外的aws，godaddy和neamcheap等，可以用作.me等国内无法托管或备案域名的管理，其次也可以借助DNS（HTTPDNS、EDNS）实现跨地域、运营商网络等负载均衡，实现异地多活、就近访问、容灾等。ENDS的跨地域和运营商网络，大部分DNS厂商也已经支持，可用性有保障，但是会丢失精准性，也要面临Cache、劫持问题，HTTPDNS可以很好的解决这些问题，但是可用性目前并不足够（阿里云4个9）。</li>
<li>负载均衡（LB），主要负责请求的转发代理，按机器负载来分配流量等，对外提供VIP，这里的负载可以宽泛的理解为系统的压力，可以用 CPU 负载来衡量，也可以用连接数、I/O 使用率、网卡吞吐量等来衡量。负载均衡器按服务层级来划分，除了前边提到的DNS，还有集群级别的硬件负载均衡，以及机器级别的软件负载均衡。
<ul>
<li>DNS/硬件负载均衡(F5/A10)主要用来应对海量用户的访问，中小量用户使用无疑会增加更多的维护和采购成本。</li>
<li>软件负载均衡可以选择自研或上云，LVS、Keepalived主要用于四层（IP+端口）的负载均衡，在L4（四层）的基础之上如果要实现应用层（域名/URL/用户会话）等的L7（7层）负载均衡，可以使用Nginx、Keepalived的组合。</li>
</ul>
</li>
<li>除此之外，网关也负责服务整体的安全防护，SSL，IPV6等。
<ul>
<li>安全防护目的是保护服务数据以及可用性，例如防范常见的DDOS/CC网络攻击，反爬虫，自定义访问控制，自研成本往往比较高，可以借助云上一系列的高防、防火墙服务。</li>
<li>SSL（TLS）用来提供外部https访问，https可以防止数据在传输过程中不被窃取、改变，确保数据的完整性，在支付或者用户登录等敏感数据场景，可以起到一定的保护作用，同时https页面对搜索引擎也比较友好。</li>
<li>IPV6，全球43亿IPV4地址已经在2019年年底耗尽，网信办在2018年开始就已经推行各大运营商、CDN厂商、互联网核心产品支持IPV6，我们公司之前也是试点之一。IPV6的支持只需要增加一条“AAAA”DNS记录，将域名解析到自持IPV6的IP/VIP即可。IPV4到IPV6由于存在兼容性等问题，一定是长期共存的，过渡方案可以采用IPV6代理（IPV6代理转发到IPV4服务）或者双栈（同时支持IPV6和IPV4）。</li>
</ul>
</li>
</ul>
<p><strong>业务网关</strong></p>
<p><a href="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_290de30d-bf31-4921-978c-2bd8b8f56be9.png" target="_blank" rel="noopener noreferrer"><img src="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/企业微信截图_290de30d-bf31-4921-978c-2bd8b8f56be9.png" alt="img" loading="lazy"></a></p>
<p>业务网关作为业务的最上层出口，一般承担起业务接入或者BFF的工作，例如基础的路由、鉴权、限流、熔断降级、服务聚合、插件化能力，并可以通过可视化界面管理网关配置。可选框架有基于openrestry的kong、apisix以及其他语言相关的spring cloud gateway、grpc-gateway等等，国内开源的goku、kratos、go-zero go框架，有很多比较有意思的组件实现，我们日常业务上也可以借鉴。</p>
<ul>
<li>鉴权，鉴权的目的是为了验证用户、请求等的有效性，例如用户身份鉴权（jwt/oauth2/cookie），请求鉴权（请求签名、请求加密），鉴权逻辑也花样繁多，大多需要基于业务定制化，通过网关插件能很好的集成进来。</li>
<li>限流，限流是为了做一定的流量控制，防止对系统产生过大压力从而影响整个服务。可以基于单台机器或整个集群限流（固定窗口、Quota预取），常见的方式有限制总量和限制速率，超过的则排队或丢弃，例如令牌桶（弹性）/漏桶（相对匀速）算法/BBR（依据系统吞吐等自适应）。</li>
<li>熔断，熔断作为服务断路器，可以防止应用程序重复尝试执行可能失败的操作，这样也能对整体链路起到保护作用。断路器内部会维护“打开”、“半打开”、“关闭”三种状态，来决定对请求的状态，同时结合降级策略提升服务的鲁棒性。常见的有hystrix/resilience4J/sentinel（hystrix虽然已停止更新，但现有功能已经能满足大多业务场景）。</li>
<li>降级，当限流、熔断、超时或系统故障发生时，通过丢弃一部分请求来减少系统的工作量，本质上是提供一种有损服务，常见的有，模块降级：UI、BFF，一模块挂，用另一模块数据；降级前移：下游服务 -&gt; 当前服务 -&gt; 存储 -&gt; 分布式缓存 -&gt; 本地缓存 -&gt; 网关 -&gt; CND -&gt; APP，在离用户更近、可用性更高的地方降级。</li>
<li>重试，大量网络IO，避免不了会出现因网络抖动，出现连接失败或者超时，重试可以提高请求的最终成功率，削平服务毛刺。但重试也有可能放大故障，以及一些上行接口要考虑接口的幂等性，所以与下游约定可重试的错误，限制单点重试、限制链路重试、异步任务可以结合退避策略（backoff）这些策略进行优雅的重试，同时也可以采用更加激进的“对冲请求”提前（tp99时间未响应时）发起重试请求，降低系统时延。</li>
<li>插件化，各个网关集成插件的方式尽不相同，但是目的都是为了集成技术人员编写的一些业务相关的通用能力，例如前边提到的身份鉴权、请求鉴权等等。另外作为业务网关插件，也可以编写一些基础业务（API鉴权、请求格式化）逻辑，直接透传请求到服务层，省去很多BFF和上下游对接的工作。</li>
<li>BFF，Backend For Frontend，可以按照业务逻辑，以串行、并行和分支等结构编排多个服务API，为服务提供聚合、适配、裁剪（只返回需要的字段）功能，核心是API的动态编排以满足日益增长的业务逻辑，降低前端与微服务之间的对接成本。BFF并不意味着只能由后端实现，也可以在前端通过GraphQL等API查询语言实现。</li>
</ul>
<h3 id="_2-3-协议" tabindex="-1"> 2.3 协议</h3>
<p>服务间的通信方式是在采用微服务架构时需要做出一个最基本的决策，统一的协议标准也能大大降低服务的联调和维护成本。</p>
<ul>
<li>HTTP REST，REST更确切的讲是指的API设计风格，而不是协议标准。通常基于使用HTTP，URL，和JSON这些现有的广泛流行的协议和标准。符合REST设计风格的API称作RESTful API。编解码方式大多数情况下可以依据请求的Content-Type进行自适应。在实际应用中更多的是是伪REST API，例如用POST请求同时实现资源的增删改，或者为了请求的扩展性，资源的增删改查都使用POST JSON。</li>
<li>RPC，RPC协议描绘了客户端与服务端之间的点对点调用流程，包括RPC消息协议、序列化、通信等。可以基于tcp，也可以基于http。在实际应用中，还需要考虑服务的高可用、负载均衡等问题，所以产品级的 RPC 框架除了点对点的 RPC 协议的具体实现外，还应包括服务的发现与注册、提供服务的多台 Server 的负载均衡、服务的高可用等更多的功能。目前的 RPC 框架大致有两种不同的侧重方向，一种偏重于服务治理（Dubbo、Motan），另一种偏重于跨语言调用（Thrift/GRPC）。</li>
</ul>
<p>RPC vs HTTP REST优点</p>
<ul>
<li>更清晰的API定义，例如grpc协议的定义文件proto，自身就可以作为很好的API文档（协议即文档），日常开发中也可以把proto文件独立版本库或者放置在统一的pb管理平台，即方便协议版本、stub管理，也可以和swagger、yapi等api管理工具进行打通，做到一处定义，多处使用。</li>
<li>更好的传输效率，通过序列化和反序列化进一步压缩网络传输数据，不过序列化、反序列化也会有一定的性能损耗，protobuf可以说很好的兼顾了这两点。</li>
<li>更合适的容错机制，可以基于实际的业务场景，实现更合适的超时控制与异常重试机制，以应对网络抖动等对服务造成的影响。</li>
</ul>
<p>在一些特定场景，例如：OpenApi、BFF等，HTTP REST可以更大程度上降低外部团队的接入成本。并且RPC也有调试不便、多语言互通需要对应的SDK支持这些问题，各有利弊。综合考虑来看，除了一些特定场景，如果我们已经有相对完善的基础设施支撑（RPC框架、服务治理），RPC可以为一个更合适的选择。</p>
<h3 id="_2-4-服务注册-发现" tabindex="-1"> 2.4 服务注册/发现</h3>
<p>服务注册主要是通过将微服务的后端机器IP、端口、地域等信息注册起来，并结合一定的发现机制使客户端的请求能够直连具体的后端机器。从实现方式上可以分为服务端模式与客户端模式：</p>
<ul>
<li>
<p>服务端模式，也可以说是传统模式，通过借助负载均衡器和DNS实现，负载均衡器负责健康检查（探活检查、就绪检查）、负载均衡策略，DNS负责实现访问域名到负载均衡器IP/VIP的映射。通过直接暴露域名和端口的方式提供客户端访问。 <a href="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/Richardson-microservices-part4-3_server-side-pattern.png" target="_blank" rel="noopener noreferrer"><img src="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/Richardson-microservices-part4-3_server-side-pattern.png" alt="img" loading="lazy"></a></p>
</li>
<li>
<p>客户端模式，可以借助注册中心实现，注册中心负责服务的注册与健康检查，客户端通过监听配置变更的方式及时把配置中心维护的配置同步到本地，通过客户端负载均衡策略直接向后端机器发起请求。 <a href="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/Richardson-microservices-part4-2_client-side-pattern.png" target="_blank" rel="noopener noreferrer"><img src="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/Richardson-microservices-part4-2_client-side-pattern.png" alt="img" loading="lazy"></a> 从两种模式的实现方式上可以看出</p>
</li>
<li>
<p>服务端模式注册与发现都由服务端完成，这样可以使客户端专注在自身的业务实现，但是由于依赖负载均衡器，也就是集中式的proxy，proxy需要维护双向连接，也很容易使自己成为系统瓶颈，可用性的高低直接决定了服务质量，并且DNS缓存机制也会导致故障发生时，迁移并不能及时完成。当然在服务量少，且负载均衡器有VIP的情况下，我们也可以不使用DNS。</p>
</li>
<li>
<p>客户端模式注册与发现由配置中心和客户端共同完成，客户端先通过服务发现获取到真实的后端节点，再与后端节点直接通信，通过去中心化的方式，可以避免出现双向链接等proxy模式的性能问题，但是可靠性很容易出现在配置中心上，并且客户端的也需要一定的接入成本。好在开源的已经有很成熟的架构方案与丰富的客户端SDK，例如etcd/zookeeper/consul，consul提供开箱即用的功能，etcd社区和接入易用性方面更优一些，他们之间的一些具体区别：</p>
<table>
<thead>
<tr>
<th style="text-align:left">FEATURE</th>
<th style="text-align:left">ETCD</th>
<th style="text-align:left">ZOOKEEPER</th>
<th style="text-align:left">CONSUL</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">服务健康检查</td>
<td style="text-align:left">连接心跳</td>
<td style="text-align:left">连接心跳</td>
<td style="text-align:left">心跳、内存、硬盘等</td>
</tr>
<tr>
<td style="text-align:left">一致性</td>
<td style="text-align:left">raft</td>
<td style="text-align:left">paxos</td>
<td style="text-align:left">raft</td>
</tr>
<tr>
<td style="text-align:left">接口</td>
<td style="text-align:left">http/grpc</td>
<td style="text-align:left">客户端sdk（依赖较重）</td>
<td style="text-align:left">http/dns</td>
</tr>
<tr>
<td style="text-align:left">metrics</td>
<td style="text-align:left">支持</td>
<td style="text-align:left">不支持</td>
<td style="text-align:left">支持</td>
</tr>
<tr>
<td style="text-align:left">安全</td>
<td style="text-align:left">https</td>
<td style="text-align:left">acl</td>
<td style="text-align:left">acl/https</td>
</tr>
<tr>
<td style="text-align:left">kv存储</td>
<td style="text-align:left">支持</td>
<td style="text-align:left">支持</td>
<td style="text-align:left">支持</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h3 id="_2-5-配置中心" tabindex="-1"> 2.5 配置中心</h3>
<p>配置中心从使用场景来讲，一类是前边讲到的服务注册、发现和KV存储，例如etcd/zk/consul，在k8s场景下也可以通过configmap/secret将配置写入本地文件、环境变量或者共享的volume中，这样没有了中心服务的依赖和客户端的接入，可以实现一些老旧服务的无侵入式改造。但是作为配置中心，除了基础的配置数据，一些情况下还要开放给非开发人员（测试、运维、产品）使用，完善的控制台、权限管理、dashbord的支持，也非常重要，这类可以参考nacos（阿里开源）/apollo（携程开源）。nacos在读写性能上优于apollo，但是功能特性（例如权限管理）稍逊于apollo。</p>
<h3 id="_2-6-可观测性" tabindex="-1"> 2.6 可观测性</h3>
<blockquote>
<p>在控制论中，可观测性是用系统输出到外部的信息来推断系统内部运运行状态的一种度量方式</p>
</blockquote>
<p>可观测性三大支柱围绕Tracing（链路追踪）、Logging（日志）和Metrics（度量）展开，这三个维度几乎涵盖了应用程序的各种表征行为，开发人员通过收集并查看这三个维度的数据时刻掌握应用程序的运行情况。很长一段时间，这三者是独立存在的，随着时间的推移，这三者已经相互关联，相辅相成。
可观测性，乍一看好像是在卖弄概念，微服务出现之前也有日志、指标、链路追踪这些，其实不然，而是随着微服务、云原生、容器这些技术的出现，服务间的调用链路变的越来越复杂，所以相比于微服务出现之前，会更强调服务的观测性，目标是能准确快速的度量当前服务的状态，当出现问题时能快速定位修复，要达到这些，就要去构建强大的观测系统，能够实现像统一观测协议，三合一平台，推出配套的工具，迁移接入等等。</p>
<p><a href="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/observability.jpg" target="_blank" rel="noopener noreferrer"><img src="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/observability.jpg" alt="img" loading="lazy"></a></p>
<h4 id="_2-6-1-链路追踪" tabindex="-1"> 2.6.1 链路追踪</h4>
<p>链路追踪为分布式应用的开发者提供了完整的调用链路还原、调用请求量统计、链路拓扑、应用依赖分析等工具，可以帮助开发者快速分析和诊断分布式应用架构下的性能瓶颈，提高微服务时代下的开发诊断效率以及系统的可观察性。 为了解决不同的分布式系统API不兼容的问题，诞生了OpenTracing规范，OpenTracing中的Trace可以被认为是由多个Spacn组成的DAG图。</p>
<div><pre><code>[Span A]  ←←←(the root span)
            |
     +------+------+
     |             |
 [Span B]      [Span C] ←←←(Span C 是 Span A 的孩子节点, ChildOf)
     |             |
 [Span D]      +---+-------+
               |           |
           [Span E]    [Span F] >>> [Span G] >>> [Span H]
                                       ↑
                                       ↑
                                       ↑
                         (Span G 在 Span F 后被调用, FollowsFrom)


––|–––––––|–––––––|–––––––|–––––––|–––––––|–––––––|–––––––|–> time

 [Span A···················································]
   [Span B··············································]
      [Span D··········································]
    [Span C········································]
         [Span E·······]        [Span F··] [Span G··] [Span H··]
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>OpenTracing专注在tracing，除此之外还有包含了metrics的OpenCensus标准，以及由CNCF推出，融合OpenTracing和OpenCensus的OpenTelemetry。OpenTelemetry旨在实现云原生时代可观察性指标（Tracing、Logging、Metrics）的统一收集和处理，同时提供推动这些标准实施的组件和工具。 OpenTracing中的佼佼者当属Jaeger、Zipkin、Skywalking。他们之间的一些对比： <a href="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/uTools_1624193379569.png" target="_blank" rel="noopener noreferrer"><img src="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/uTools_1624193379569.png" alt="img" loading="lazy"></a></p>
<p>Zipkin开源时间长，社区相对丰富，Jaeger更加轻量，也是Istio推荐方案，Skywalking支持部分语言（Java、PHP、Python等）的无侵入式接入。另外APM（应用性能）监控的支持也会影响到我们的选型。 除此之外，这几种默认支持的都是头部连贯策略，在入口处决定是否采样，面对线上海量请求，也通常需要借助一些尾部连贯采样的策略，把我们关心的，例如链路中发生了错误、部分请求耗时过高等请求，都采集下来，可以通过结合opentelemetry-collector以及开箱即用的<a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/tailsamplingprocessor" target="_blank" rel="noopener noreferrer">tailsamplingprocessor</a>构建pipeline插件实现。</p>
<h4 id="_2-6-2-日志" tabindex="-1"> 2.6.2 日志</h4>
<p>服务间的链路日志能否帮助我们判断错误发生的具体位置，这类业务日志主要集中在访问日志/打点日志等等。随着大数据的兴起，我们对数据的分析解读能力越来越强，日志作为原始数据则体现出了更大的价值，例如用户的行为分析，反垃圾，舆情分析等等。</p>
<ul>
<li>业务日志：这类日志重点在于通过不同级别的日志，及时发现分析系统存在的异常，RFC 5424定义的8中日志级别:
<ul>
<li>Emergency: system is unusable</li>
<li>Alert: action must be taken immediately</li>
<li>Critical: critical conditions</li>
<li>Error: error conditions</li>
<li>Warning: warning conditions</li>
<li>Notice: normal but significant condition</li>
<li>Informational: informational messages</li>
<li>Debug: debug-level messages</li>
</ul>
</li>
</ul>
<p>在实际使用过程中可能会对日志级别进行简化和调整，一般来讲Warning及以上的日志是需要重点关注的，需要做好及时的监控告警，Warning以下的日志也可以辅助问题的定位。 日志写入可以选择写入消息队列，也可以选择落地磁盘，将关心的结构化或非结构化日志、业务模块信息（如果是细粒度的微服务，可以选择将日志放同一模块收集），以及级别、时间（who、when、where、how、what）等要素正确的写入正确写入后再收集到日志服务。写入消息队列需要考虑消息队列的选型以及做好可用性和积压监控，写入磁盘需要考虑写入性能以及日志的切割清理，例如golang的zap+rotatelogs组合。日志收集的话，由于Logstash资源消耗相对比较大，虚拟机环境中可以使用filebeat来替代，更严苛的线上或容器环境，可以使用Fluentd/Fluentd Bit。日志最终汇总到ES和Kibana做展示，通过esalert定制告警策略。</p>
<p>在业务记录一些错误日志时，通常可以选择，在错误发生处附带堆栈信息；将error抛给调用者，在顶层打印日志，而非层层打印；错误降级时，选择性打印日志。</p>
<ul>
<li>大数据日志：大数据日志本质上也对应着我们一定的业务场景，但大多是海量日志、高吞吐量场景，所以对海量日志的收集和存储是较大的挑战。实现方案我们可以采用高吞吐量的流式中间件，例如kafka/plusar等，在结合流式处理(flink)或者批处理(spark)系统，将数据汇总到hadoop进行分析，这里涉及到的中间件和数据库可参考后续章节。</li>
</ul>
<h4 id="_2-6-3-指标" tabindex="-1"> 2.6.3 指标</h4>
<p>指标是有关系统的离散的数据点，这些指标通常表示为计数或度量，并且通常在一段时间内进行汇总或计算，一般用来做基础的资源监控和业务监控：</p>
<ul>
<li>资源监控：CPU、内存、IO、fd、GC等</li>
<li>业务监控：QPS、模调、耗时分布等</li>
</ul>
<p>Zabbix作为老牌的监控系统，适合更复杂的物理机、虚拟机、数据库等更复杂的场景，同时也拥有更丰富的图形化界面，但是Prometheus作为云原生的代表作，与k8s、容器等能更好的结合，协同grafana实现可定制化的界面，另外存储基于TSDB，相比于关系型数据库也有更好的扩展性。以Prometheus为例，支持的数据类型有：</p>
<ul>
<li>Counter 只增不减的计数器，例如请求数（http_requests_total）。基于此数据模型，使用Prometheus提供的强大PromQL表达式能够拓展出更加适合开发观察的指标数据。 分钟增量请求：increase(http_requests_total[1m]) 分钟QPS：rate(http_requests_total[1m])</li>
<li>Gauge 可增可减的时刻量，例如Go语言协程数（go_goroutines）、消息队列积压量 波动量：delta(go_goroutines[10m])</li>
<li>Histogram 直方图，不同区间内样本的个数。例如，耗时50ms-100ms每分钟请求量，100ms-150ms每分钟请求量。</li>
<li>Summary 概要，反应百分位值。例如，某RPC接口，95%的请求耗时低于150ms，99%的请求耗时低于200ms。</li>
</ul>
<p>Prometheus指标支持pull和push模式：</p>
<ul>
<li>Pull：服务暴露metrics接口，指标内存更新，Prometheus server定时拉取，性能更好，但要考虑易失性</li>
<li>Push：指标推送push-gateway，Promethus server从gateway拉取，适用瞬时业务场景（定时任务）</li>
</ul>
<h3 id="_2-7-service-mesh" tabindex="-1"> 2.7 Service Mesh</h3>
<p>我们前边讲的服务发现、熔断降级、安全、流量控制、可观察性等能力。这些通用能力在Service Mesh出现之前，由Lib/Framework通过一些切面的方式完成，这样就可以在开发层面上很容易地集成到我们的应用服务中。但是并没有办法实现跨语言编程，有什么改动后，也需要重新编译重新发布服务。理论上应该有一个专门的层来干这事，于是出现了 Sidecar，
第一代Service Mesh，像Linkerd，后边又出现了第二代Service Mesh，Istio，职责分明，分离出处数据面和控制面。但是Sidecar作为代理层，避免不了性能损耗（CPU序列化反序列化 UDS），所以proxyless service mesh重新被提起，和之前的 「RPC + 服务发现治理」区别是啥？感觉这个名词营销味道略重。其实不能简单的 “Proxyless Service Mesh” 理解为 “一个简单的RPC框架，暴露了几个超时参数到配置中心来控制”，它重在统一协议、API，这样就便于基于统一的协议实现proxyless mesh和proxy mesh的互通，可以同时满足性能敏感型和快速迭代型的业务场景。</p>
<p><a href="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/uTools_1645590568142.png" target="_blank" rel="noopener noreferrer"><img src="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/uTools_1645590568142.png" alt="img" loading="lazy"></a></p>
<p>他们相辅相成，丰富了service mesh的形态。
<a href="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/baidu_proxyless_service_mesh.png" target="_blank" rel="noopener noreferrer"><img src="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/baidu_proxyless_service_mesh.png" alt="img" loading="lazy"></a></p>
<p>servicemesh对于微服务基础设施的一种演进，但不代表他已经非常成熟了，相反像迁移成本高，甚至一些可用性设计还不如业务自己做那么灵活，这些现实的问题还摆在面前，我觉得这也是属于技术进化的一种趋势，当一项技术足够成熟的时候，又回衍生出新的复杂度问题，从而又需要发展出新技术解决。</p>
<h2 id="_3-消息队列" tabindex="-1"> 3. 消息队列</h2>
<blockquote>
<p>在计算机科学中，消息队列（英语：Message queue）是一种进程间通信或同一进程的不同线程间的通信方式，软件的贮列用来处理一系列的输入，通常是来自用户。消息队列提供了异步的通信协议，每一个贮列中的纪录包含详细说明的数据，包含发生的时间，输入设备的种类，以及特定的输入参数，也就是说：消息的发送者和接收者不需要同时与消息队列交互。消息会保存在队列中，直到接收者取回它。</p>
</blockquote>
<p><a href="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/Screen-Shot-2017-05-22-at-09.05.54.png" target="_blank" rel="noopener noreferrer"><img src="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/Screen-Shot-2017-05-22-at-09.05.54.png" alt="img" loading="lazy"></a></p>
<p>实际应用场景中，消息队列也经常作为中间件，用于服务解耦、削峰填谷、数据广播、错峰与流控、最终一致性等，在一些核心的大数据分析、交易支付等场景也经常扮演重要角色。</p>
<p>关于服务解耦，会有很多人质疑，消息队列是否能真正解耦，我的理解是：数据要发生流转，系统之间要有依赖关系，例如上游服务直接读写下游存储、中间件进行数据交互，解耦则更侧重于将易于变化的复杂度转移，对下游存储、中间件的依赖，通过消息队列转化为双方的弱接口（消息payload）依赖。但如果上游是本身是依赖的下游API，这种方式就需要考虑有多个下游时，自身复杂度和可用性的变化。</p>
<p>消息队列的选型主要侧重以下几点：</p>
<ul>
<li>HA：自身的高可用性保障，避免消息队列的引入而影响整体服务的可用性</li>
<li>高吞吐：在面对海量数据写入能否保持一个相对稳定、高效的数据处理能力</li>
<li>功能丰富性：是否支持延迟消息、事务消息、死信队列、优先级队列等</li>
<li>消息广播：是否支持将消息广播给消费者组或者一组消费者</li>
<li>消息堆积能力：在数据量过大时，是否允许一定消息堆积到broker</li>
<li>数据持久性：数据持久化策略的采用，也决定着数据在宕机恢复后是否会丢失数据</li>
<li>重复消费：是否支持ack机制，在消费者未正确处理消息时，支持重新消费</li>
<li>消息顺序性：针对顺序消费的场景保证数据按写入时间的顺序性</li>
</ul>
<p>这里着重对比一下Redis、Rabbitmq/Rocketmq、Kafka、Plusar</p>
<h3 id="_3-1-redis" tabindex="-1"> 3.1 Redis</h3>
<p>redis实现消息队列可以通过List&amp;Zset类型、Pub/Sub、Stream（redis 5.0）类型来实现，HA使用多副本或者集群的方式。作为消息队列使用起来非常方便，但是也有很多的弊端：</p>
<ul>
<li>功能丰富性：只支持普通的消息类型和延迟消息（Zset时间戳轮询）</li>
<li>数据持久性：Pub/Sub只提供缓冲区广播能力，不进行持久化，List&amp;Zset/Stream即使基于aof和rdb持久化策略，但是并没有事务性保障，在宕机恢复后还是存在丢失数据的可能性</li>
<li>消息堆积能力：List&amp;Zset随数据增多，内存不断增长；Pub/Sub只在缓冲区内堆积，缓冲区满消费者强制下线；Stream创建时可以指定队列最大长度，写满后剔除旧消息</li>
</ul>
<p>除此之外，List&amp;Zset类型无法支持消息广播，和Pub/Sub一样也不支持重复消费。结合整体来看redis作为消息队列大多数只应用在数据量小，对丢失数据不敏感的业务场景，适用范围较小，复杂业务并且有一定运维支撑的情况下，可以直接考虑企业级消息中间件。</p>
<h3 id="_3-2-rabbitmq-vs-kafka-vs-rocketmq" tabindex="-1"> 3.2 Rabbitmq vs Kafka vs Rocketmq</h3>
<p>这几个可以作为企业级消息中间件的代表，Rabbitmq和kafka的一些详细对比，可以参考之前写的这篇文章《<a href="https://blog.xstudio.mobi/a/60.html" target="_blank" rel="noopener noreferrer">消息队列Rabbitmq与Kafka对比分析</a>》。而Rocketmq在设计之初就借鉴了很多Rabbitmq、Kafka的设计理念，例如：Routing、多副本、顺序写（IO），也广泛应用在淘宝双十一等场景。</p>
<p><strong>HA</strong> 在HA方面他们都是通过副本的方式，区别是Rabbitmq是集群级别的副本，Kafka是多partiton和ISR、选举机制，而Rocketmq通过多（master/slave）副本同时保障NameServer和Broker。</p>
<p><strong>高吞吐</strong> Kafka和Rocketmq通过直接操作文件系统，相比于Rabbitmq，顺序写能大幅度提升数据的处理速度。Kafka为了进一步提升消息的吞吐量，可以采用客户端缓冲队列的方式批量发送，但也会存在宕机丢失数据的可能性，可以通过设置 batch.size 与 <a href="http://linger.ms" target="_blank" rel="noopener noreferrer">linger.ms</a> 来动态调整，相比于Rocketmq更加灵活。Kafka的partition机制的确会带来性能的提升，但是在Topic不断增多的情况下，众多的partition及副本也将顺序写逐步退化为随机写，并且扩容时，由于hash值的变化，也会涉及到大量partiton数据的迁移。Rocketmq采用commitlog的方式实现全局写，所以能支持更多的Topic，扩容也不涉及大量数据的迁移。除此之外Kafka和Rocketmq都有zero-copy的应用，通过sendfile和mmap，减少内核态到用户态的CPU拷贝。以及pagecache的应用，大幅度提升消费者生产者速度较为匹配场景的IO效率。</p>
<p><strong>功能丰富性</strong> Kafka只有基础的消息类型，Rabbitmq支持优先级队列，通过TTL和死信队列可以实现消息的延迟和重试，但是需要提前创建好对应队列，例如：1s延迟队列，10s延迟队列（rabbitmq3.5.7以上可以集成rabbitmq-delayed-message-exchange），阿里云版Rocketmq可以直接设置秒级的延迟时间实现延迟投递，以及针对有序消息阻塞重试，无序消息内置16个重试频率“10s 30s 1m 2m…”供集群（同一消费组）的消费者重试，另外Rocketmq也具有独有的2PL事务消息，很好的保障业务逻辑与消息发送的最终一致性。</p>
<p><strong>重复消费</strong> 他们三者都采用Ack机制保障了单条消息重复消费的能力，Kafka通过offset和partition特殊的ttl机制（segment过期，按文件名顺序清理），能支持通过重置offset来回溯历史数据。</p>
<p><strong>消息顺序性</strong> Rabbitmq和Rocketmq可以保证写入同一topic的顺序性，但是在多个消费者同时消费的情况下还是会出现乱序的情况，在数据量较大的时候，我们也可以通过单个消费者消费，再按照一定的分发策略分配给多个消费者执行，只不过会提升整体复杂度，同时会带来更多的HA、维护成本考量。Kafka可以保障单个partition的顺序性，并且每个partiton只允许一个消费者来消费（N：1），这就从策略上避免了多消费者的情况，在数据量较大的情况下，可以通过划分更多的partition提升数据的并行处理能力。</p>
<p>综合来讲，Rabbitmq、Rocketmq使用Queue模型，丰富的消息队列功能，更多的应用在业务场景，Kafka基于Streaming模型，结合批处理、流式处理，更多的应用在大数据分析场景。</p>
<h3 id="_3-3-pulsar" tabindex="-1"> 3.3 Pulsar</h3>
<p>Pulsar作为Apache开源、云原生的消息中间件，诞生之初就引发了很大的关注。设计上避免了kafka遇到的功能丰富性、扩容等方面的问题，采用计算、存储分离的架构，broker层只作为“API接口层”，存储交给更专业的bookeeper，由于broker层的无状态性，结合k8s等非常方便的进行扩容。并且Pulsar支持多个消费模型提升消费者处理能力，例如：exclusive、failover、shared、key-shared等，可以说综合了kafka和其他消息中间件的众多优点。</p>
<p><a href="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/WechatIMG45.jpeg" target="_blank" rel="noopener noreferrer"><img src="http://yueqian-wordpress.stor.sinaapp.com/uploads/2021/05/WechatIMG45.jpeg" alt="img" loading="lazy"></a></p>
<ul>
<li>HA、高吞吐：和kafka类似，通过多partition和选举机制功，除此之外，还支持丰富的跨地域复制能力</li>
<li>功能丰富性：可以支持秒级的延迟消息，以及独特的重试队列和私信队列</li>
<li>消息顺序性：为了实现partition消息的顺序性，和kafka一样，都需要将消息写入到同一broker，区别是kafka会同时存储消息在该broker，broker和partiton绑定在一起，而pulsar可以将消息分块（segment）后，更加均匀的分散到bookeeper节点上，broker只需要记录映射关系即可，这样在资源扩容时，可以更加快速便捷</li>
</ul>
<p>像能量守恒定律一样，系统的复杂度往往也是守恒的，实现即高性能又高可用的消息中间件需要的技术复杂性，不会凭空消失，只会从一个地方转移到另一个地方，消息队列本质上可以理解为feature+fs，只不过存储、计算分离架构，将各层间的职责分离，使每一层都能专注在自身领域，以应对海量数据和更加复杂多变的环境，这也是现在新技术发展的一个趋势。 作为后起之秀，的确可以站在巨人的肩膀上，避免很多设计上的不足，同时引入一些新的架构理念，但是要成功的在其中分一杯羹，同样也要面临用户学习成本高、缺少杀手级应用、如何迁移等等这些现实性的问题，不过依靠良好的社区和技术先驱，随着时间的变迁，这些短板也会逐步补齐，真正适应当前时代的技术一定会脱颖而出。ps：腾讯云最近开源<a href="https://github.com/streamnative/rop" target="_blank" rel="noopener noreferrer">Rop</a>，支持Rocketmq相对平滑的迁移至Pulsar。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-27T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">IntelliJ IDEA 快捷键大全 + 动图演示</title>
    <id>https://blog.ciberviler.top/dev/IntelliJIDEA%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%A4%A7%E5%85%A8+%E5%8A%A8%E5%9B%BE%E6%BC%94%E7%A4%BA.html</id>
    <link href="https://blog.ciberviler.top/dev/IntelliJIDEA%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%A4%A7%E5%85%A8+%E5%8A%A8%E5%9B%BE%E6%BC%94%E7%A4%BA.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">IntelliJ IDEA 快捷键大全 + 动图演示</summary>
    <content type="html"><![CDATA[<h1 id="intellij-idea-快捷键大全-动图演示" tabindex="-1"> IntelliJ IDEA 快捷键大全 + 动图演示</h1>
<p>一、构建/编译
<code>Ctrl + F9</code>：构建项目
<code>Ctrl + Shift + F9</code>：重新编译当前类
二、文本编辑
<code>Ctrl + X</code>：剪切
<code>Ctrl + C</code>：复制
<code>Ctrl + V</code>：粘贴
<code>Ctrl + Alt + Shift + V</code>：粘贴为纯文本
<code>Ctrl + Shift + V</code>：从历史选择粘贴
<code>Ctrl + D</code>：复制行
<code>Ctrl + Shift + C</code>：复制文件路径
<code>Ctrl + Alt + Shift + C</code>：复制引用
<code>Ctrl + S</code>：保存全部
<code>Ctrl + Z</code>：撤销
<code>Ctrl + Shift + Z</code>：重做
<code>Tab</code>：缩进
<code>Shift + Tabl</code>：取消缩进
<code>Ctrl + Alt + I</code>：自动缩进行
<code>Shift + Enter</code>：开始新行
<code>Ctrl + Alt + Enter</code>：在当前行之前开始新行
<code>Ctrl + Y</code>：删除行
<code>Ctrl + Shift + U</code>：大小写转换
<code>Ctrl + Alt + Shift + Insert</code>：创建临时文件
<code>Shift + F4</code>：在新窗口中打开
三、光标操作
<code>Ctrl + Left</code>：左移一个单词
<code>Ctrl + Right</code>：右移一个单词
<code>Home</code>：移动至行首
<code>End</code>：移动至行尾
<code>Ctrl + Shift + M</code>：移动至大括号
<code>Ctrl + [</code>：移动至代码块开始
<code>Ctrl + ]</code>：移动至代码块末尾
<code>Alt + Down</code>：下一个方法
<code>Alt + Up</code>：上一个方法
<code>Ctrl + PageUp</code>：移动至页面顶部
<code>Ctrl + PageDown</code>：移动至页面底部
<code>PageUp</code>：向上翻页
<code>PageDown</code>：向下翻页
<code>Ctrl + Home</code>：移动至文件开头
<code>Ctrl + End</code>：移动至文件末尾
四、文本选择
<code>Ctrl + A</code>：全选
<code>Shift + Left</code>：向左选择
<code>Shift + Right</code>：向右选择
<code>Ctrl + Shift + Left</code>：向左选择一个单词
<code>Ctrl + Shift + Right</code>：向右选择一个单词
<code>Shift + Home</code>：向左选择至行头
<code>Shift + End</code>：向右选择至行尾
<code>Shift + Up</code>：向上选择
<code>Shift + Down</code>：向下选择
<code>Ctrl + Shift + [</code>：选择至代码块开头
<code>Ctrl + Shift + ]</code>：选择至代码块结尾
<code>Ctrl + Shift + PageUp</code>：选择至页面顶部
<code>Ctrl + Shift + PageDown</code>：选择至页面底部
<code>Shift + PageUp</code>：向上翻页选择
<code>Shift + PageDown</code>：向下翻页选择
<code>Ctrl + Shift + Home</code>：选择至文件开关
<code>Ctrl + Shift + End</code>：选择至文件结尾
<code>Ctrl + W</code>：扩展选择
<code>Ctrl + Shift + W</code>：收缩选择
五、代码折叠
<code>Ctrl + NumPad+</code>：展开代码块
<code>Ctrl + NumPad-</code>：折叠代码块
<code>Ctrl + Alt + NumPad+</code>：递归展开
<code>Ctrl + Alt + NumPad-</code>：递归折叠
<code>Ctrl + Shift + NumPad+</code>：全部展开
<code>Ctrl + Shift + NumPad-</code>：全部折叠
<code>Ctrl + .</code>：折叠选择
六、多个插入符号和范围选择
<code>Alt + Shift + Click</code>：添加/删除插入符号
<code>Alt + Shift + Insert</code>：切换列选择模式
双击<code>Ctrl</code> + <code>Up</code>：向上克隆插入符号
双击<code>Ctrl</code> + <code>Down</code>：向下克隆插入符号
<code>Alt + Shift + G</code>：将插入符号添加到选择中的每一行
<code>Alt + J</code>：选择单位下次出现的位置
<code>Alt + Shift + J</code>：取消最后一次选择
<code>Ctrl + Alt + Shift + J</code>：选择所有出现的位置
<code>Alt + Shift + Middle-Click</code>：创建矩形选择
<code>Alt + Click</code>：拖拽以创建矩形选择区
<code>Ctrl + Alt + Shift + Click</code>：拖拽以创建多个矩形选择区
七、辅助编码
<code>Alt + Enter</code>：显示建议操作
<code>Ctrl + Space</code>：代码补全
<code>Ctrl + Shift + Space</code>：类型匹配代码补全
<code>Ctrl + Alt + Space</code>：第二次代码补全
<code>Ctrl + Shift + Enter</code>：补全当前语句
<code>Ctrl + Alt + L</code>：格式化代码
<code>Ctrl + P</code>：参数信息提醒
<code>Ctrl + Q</code>：快速文档
<code>Ctrl + Shift + Up</code>：向上移动语句
<code>Ctrl + Shift + Down</code>：向下移动语句
<code>Ctrl + Alt + Shift + Left</code>：向左移动元素
<code>Ctrl + Alt + Shift + Right</code>：向右移动元素
<code>Alt + Shift + Up</code>：向上移动队列
<code>Alt + Shift + Down</code>：向下移动队列
<code>Ctrl + /</code>：添加行注释
<code>Ctrl + Shift + /</code>：添加块注释
<code>Alt + Insert</code>：生产语句
八、上下文导航
<code>Alt + Down</code>：跳转至下一个方法
<code>Alt + Up</code>：跳转至上一个方法
<code>Ctrl + G</code>：跳转到指定行
<code>Ctrl + Tab</code>：切换活动文件
<code>Alt + F1</code>：选择文件的定位
<code>Ctrl + E</code>：最近的文件
<code>Ctrl + Shift + Backspace</code>：返回上次编辑位置
<code>Ctrl + Alt + Left</code>：后退
<code>Ctrl + Alt + Right</code>：前进
<code>Ctrl + Alt + Down</code>：下一事件
<code>Ctrl + Alt + Up</code>：上一事件
<code>Alt + Right</code>：选择下一个选项卡
<code>Alt + Left</code>：选择下一个选项卡
<code>F11</code>：切换匿名书签
<code>Ctrl + Shift + [digit]</code>：用数字切换书签
<code>Ctrl + F11</code>：使用助词符切换书签
<code>Shift + F11</code>：显示所有书签
<code>Ctrl + [digit]</code>：用数字跳转到书签
<code>Alt + 7</code>：显示结构窗口
<code>Alt + 3</code>：显示查找窗口
九、查找操作
双击<code>Shift</code>：查找所有
<code>Ctrl + F</code>：查找字符（当前文件）
<code>F3</code>：查找下一个
<code>Shift + F3</code>：查找上一个
<code>Ctrl + R</code>：替换字符（当前文件）
<code>Ctrl + Shift + F</code>：查找字符（所有文件）
<code>Ctrl + Shift + R</code>：替换字符（所有文件）
<code>Ctrl + F3</code>：跳转到光标处单词的下一位置
<code>Ctrl + Shift + N</code>：查找文件并跳转
<code>Ctrl + F12</code>：打开文件结构
<code>Ctrl + Alt + Shift + N</code>：查找符号（变量、方法等）
<code>Ctrl + Shift + A</code>：查找动作
十、符号导航
<code>Alt + F7</code>：查找用法
<code>Ctrl + B</code>：跳转到声明处
<code>Ctrl + Shift + B</code>：跳转到声明类处
<code>Ctrl + Alt + F7</code>：显示用法
<code>Ctrl + U</code>：跳转到超级方法
<code>Ctrl + Alt + B</code>：跳转到实现方法
<code>Ctrl + Shift + F7</code>：突出显示文件中的用法
十一、代码分析
<code>Alt + Enter</code>：显示意图操作
<code>Ctrl + F1</code>：显示错误描述
<code>F2</code>：下一个突出显示的错误
<code>Shift + F2</code>：上一个突出显示的错误
<code>Ctrl + Alt + Shift + I</code>：按名称运行检查
<code>Alt + 6</code>：显示问题窗口
十二、运行和调试
双击<code>Ctrl</code>：运行所有
<code>Shift + F10</code>：运行上下文配置
<code>Alt + Shift + F10</code>：打开运行窗口
<code>Shift + F9</code>：调试上下文配置
<code>Alt + Shift + F9</code>：打开调试窗口
<code>Ctrl + Alt + F5</code>：附加到进程
<code>Ctrl + F2</code>：停止
<code>F9</code>：运行至下一断点
<code>Ctrl + Shift + F2</code>：停止后台进程
<code>F8</code>：跨过调用
<code>Alt + Shift + F8</code>：强制跨过调用
<code>F7</code>：进入调用
<code>Shift + F7</code>：智能进入调用
<code>Alt + Shift + F7</code>：强制进入调用
<code>Shift + F8</code>：跳出调用
<code>Alt + F9</code>：运行至光标处
<code>Ctrl + Alt + F9</code>：强制运行至光标处
<code>Alt + F10</code>：显示执行点
<code>Alt + F8</code>：评估表达式
<code>Ctrl + Alt + F8</code>：快速评估表达式
<code>Ctrl + F8</code>：切换行断点
<code>Ctrl + Alt + Shift + F8</code>：切换临时行断点
<code>Ctrl + Shift + F8</code>：查看断点
<code>Ctrl + Shift + F8</code>：编辑断点
<code>Alt + 4</code>：显示运行窗口
<code>Alt + 5</code>：显示调试窗口
<code>Alt + 8</code>：显示服务窗口
十三、代码重构
<code>Ctrl + Alt + Shift + T</code>：打开重构列表
<code>Shift + F6</code>：修改名称
<code>Ctrl + F6</code>：修改签名
<code>Ctrl + Alt + N</code>：内联
<code>F6</code>：移动
<code>Ctrl + Alt + M</code>：提取方法
<code>Ctrl + Alt + F</code>：引入域
<code>Ctrl + Alt + P</code>：引入参数
<code>Ctrl + Alt + V</code>：引入变量
<code>Alt + Delete</code>：安全删除
十四、全局 CVS 操作
<code>Alt + `` ：弹出 CVS 窗口 </code>Ctrl + K<code>：提交 </code>Ctrl + T<code>：更新项目 </code>Ctrl + Alt + Z<code>：回滚 </code>Ctrl + Shift + K<code>：拉取 </code>Ctrl + Alt + Shift + Down<code>：下一个修改 </code>Ctrl + Alt + Shift + Up<code>：上一个修改 </code>Alt + 9<code>：显示版本控制窗口 </code>Alt + 0<code>：显示提交窗口 十五、差异查看器 </code>F7<code>：下一个差异 </code>Shift + F7<code>：上一个差异 </code>Ctrl + Alt + R<code>：接受左侧 </code>Ctrl + Alt + A<code>：接受右侧 </code>Ctrl + Shift + Tab<code>：选择对面的差异窗格 </code>Ctrl + Shift + D<code>：显示差异设置窗口 十六、工具窗口 </code>Shift + Escape<code>：隐藏活动的工具窗口 </code>Ctrl + Shift + F12<code>：隐藏所有工具窗口 </code>F12<code>：跳转到最后一个工具窗口 </code>Ctrl + Alt + Shift + Left<code>：向左延伸窗口大小 </code>Ctrl + Alt + Shift + Right<code>：向右延伸窗口大小 </code>Ctrl + Alt + Shift + Up<code>：向顶部延伸窗口大小 </code>Ctrl + Alt + Shift + Down<code>：向底部延伸窗口大小 </code>Alt + 1<code>：显示项目窗口 </code>Alt + 2<code>：显示书签窗口 </code>Alt + 3<code>：显示查找窗口 </code>Alt + 4<code>：显示运行窗口 </code>Alt + 5<code>：显示调试窗口 </code>Alt + 6<code>：显示问题窗口 </code>Alt + 7<code>：显示结构窗口 </code>Alt + 8<code>：显示服务窗口 </code>Alt + 9<code>：显示版本控制窗口 </code>Alt + 0<code>：显示提交窗口 </code>Alt + F12`：显示终端窗口</p>
<h1><a id="_18"></a>一、构建/编译</h1> 
<h3><a id="Ctrl__F9_20"></a><code>Ctrl &#43; F9</code>&#xff1a;构建项目</h3> 
<blockquote> 
 <p>该快捷键&#xff0c;等同于菜单【Build】—&gt;【Build Project】</p> 
</blockquote> 
<p><img src="https://img-blog.csdnimg.cn/2d3dadd172a746f4a073f3e53005471a.png" alt="在这里插入图片描述" /></p> 
<p>执行该命令后&#xff0c;IntelliJ IDEA 会编译项目中所有类&#xff0c;并将编译结果输出到<code>out</code>目录中。IntelliJ IDEA 支持增量构建&#xff0c;会在上次构建的基础上&#xff0c;仅编译修改的类。<br /> <img src="https://img-blog.csdnimg.cn/0a9576b4bc66493c99476c52bdaaa7e2.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__F9_31"></a><code>Ctrl &#43; Shift &#43; F9</code>&#xff1a;重新编译当前类</h3> 
<blockquote> 
 <p>该快捷键&#xff0c;等同于菜单【Build】—&gt;【Recompile ‘class name’】</p> 
</blockquote> 
<p><img src="https://img-blog.csdnimg.cn/04881e4092d9412c8f71d5dc32e01884.png" alt="在这里插入图片描述" /><br /> 在IntelliJ IDEA 中打开要编译的类&#xff0c;执行该命令会编译当前类。<br /> <img src="https://img-blog.csdnimg.cn/0c0da1f7a8184340b0498e56fb0d96ca.gif" alt="在这里插入图片描述" /></p> 
<h1><a id="_42"></a>二、文本编辑</h1> 
<h3><a id="Ctrl__X_46"></a><code>Ctrl &#43; X</code>&#xff1a;剪切</h3> 
<p>剪切选中文本&#xff0c;若未选中则剪切当前行。</p> 
<p><img src="https://img-blog.csdnimg.cn/ba963adf5f194fbebc077f0895a9ed6d.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__C_53"></a><code>Ctrl &#43; C</code>&#xff1a;复制</h3> 
<p>复制选中文本&#xff0c;若未选中则复制当前行。</p> 
<h3><a id="Ctrl__V_57"></a><code>Ctrl &#43; V</code>&#xff1a;粘贴</h3> 
<h3><a id="Ctrl__Alt__Shift__V_59"></a><code>Ctrl &#43; Alt &#43; Shift &#43; V</code>&#xff1a;粘贴为纯文本</h3> 
<h3><a id="Ctrl__Shift__V_61"></a><code>Ctrl &#43; Shift &#43; V</code>&#xff1a;从历史选择粘贴</h3> 
<p>从历史剪粘版中选择要粘贴的内容。</p> 
<p><img src="https://img-blog.csdnimg.cn/ef65ef617a464a10a9a439ff869b9f67.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__D_68"></a><code>Ctrl &#43; D</code>&#xff1a;复制行</h3> 
<p>复制光标所在行。</p> 
<p><img src="https://img-blog.csdnimg.cn/9dbba27a7f9f4d0695a8fb408194b04b.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__C_75"></a><code>Ctrl &#43; Shift &#43; C</code>&#xff1a;复制文件路径</h3> 
<p>复制选中文件所在路径。</p> 
<p><img src="https://img-blog.csdnimg.cn/9c340c5cdea6486ca3c04256e56b900f.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Shift__C_82"></a><code>Ctrl &#43; Alt &#43; Shift &#43; C</code>&#xff1a;复制引用</h3> 
<p>复制包的路径&#xff0c;或者类的名称。</p> 
<p><img src="https://img-blog.csdnimg.cn/c1ed398d88ce45a091ef7f5cc2703fd8.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__S_89"></a><code>Ctrl &#43; S</code>&#xff1a;保存全部</h3> 
<h3><a id="Ctrl__Z_91"></a><code>Ctrl &#43; Z</code>&#xff1a;撤销</h3> 
<p>撤销上一步操作内容。</p> 
<h3><a id="Ctrl__Shift__Z_95"></a><code>Ctrl &#43; Shift &#43; Z</code>&#xff1a;重做</h3> 
<p>恢复上一步撤销内容。</p> 
<p><img src="https://img-blog.csdnimg.cn/be1180ed1fc649e982f83f87d16992f6.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Tab_102"></a><code>Tab</code>&#xff1a;缩进</h3> 
<h3><a id="Shift__Tabl_104"></a><code>Shift &#43; Tabl</code>&#xff1a;取消缩进</h3> 
<p><img src="https://img-blog.csdnimg.cn/46ff0ec9f69e485ab327ad17885a0001.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__I_109"></a><code>Ctrl &#43; Alt &#43; I</code>&#xff1a;自动缩进行</h3> 
<p>自动缩进至规范位置。</p> 
<p><img src="https://img-blog.csdnimg.cn/714beeb6e5eb463fa44e7b186d38fd75.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Shift__Enter_116"></a><code>Shift &#43; Enter</code>&#xff1a;开始新行</h3> 
<p>无论光标是否在行尾&#xff0c;都开始新的行。</p> 
<p><img src="https://img-blog.csdnimg.cn/d0a7000e605e41788fe44586a2fd0fc3.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Enter_123"></a><code>Ctrl &#43; Alt &#43; Enter</code>&#xff1a;在当前行之前开始新行</h3> 
<p><img src="https://img-blog.csdnimg.cn/079fc9c5db2b4bdbb3ca292d9990e26e.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Y_128"></a><code>Ctrl &#43; Y</code>&#xff1a;删除行</h3> 
<p>删除当前行。</p> 
<p><img src="https://img-blog.csdnimg.cn/35f2220922dc4a48983f6bbf3a39e3ed.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__U_135"></a><code>Ctrl &#43; Shift &#43; U</code>&#xff1a;大小写转换</h3> 
<p><img src="https://img-blog.csdnimg.cn/ff5acc373e2140bdb7069f60d8129925.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Shift__Insert_140"></a><code>Ctrl &#43; Alt &#43; Shift &#43; Insert</code>&#xff1a;创建临时文件</h3> 
<p>可以创建各种类型的临时文件&#xff0c;该临时文件不会保存到磁盘中。</p> 
<p><img src="https://img-blog.csdnimg.cn/1943548ff7704491bc29bde1a1f22ae3.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Shift__F4_147"></a><code>Shift &#43; F4</code>&#xff1a;在新窗口中打开</h3> 
<p>在新窗口打开当前文件。</p> 
<p><img src="https://img-blog.csdnimg.cn/4e16c45d0ed0460082e80e4ba945be58.gif" alt="在这里插入图片描述" /></p> 
<h1><a id="_154"></a>三、光标操作</h1> 
<h3><a id="Ctrl__Left_158"></a><code>Ctrl &#43; Left</code>&#xff1a;左移一个单词</h3> 
<p><img src="https://img-blog.csdnimg.cn/b80a3360066e47b18ea84e44d026c774.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Right_163"></a><code>Ctrl &#43; Right</code>&#xff1a;右移一个单词</h3> 
<p><img src="https://img-blog.csdnimg.cn/8818f1dc9d4c47a69e3e7d4f80c7db49.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Home_168"></a><code>Home</code>&#xff1a;移动至行首</h3> 
<h3><a id="End_170"></a><code>End</code>&#xff1a;移动至行尾</h3> 
<p><img src="https://img-blog.csdnimg.cn/8c68a8020d514a59bb8b759160c9a913.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__M_175"></a><code>Ctrl &#43; Shift &#43; M</code>&#xff1a;移动至大括号</h3> 
<p>多次按下快捷键&#xff0c;可以在左右两个大括号间切换。</p> 
<p><img src="https://img-blog.csdnimg.cn/5a6a33db89c9474c899601d38c311a97.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl___182"></a><code>Ctrl &#43; [</code>&#xff1a;移动至代码块开始</h3> 
<h3><a id="Ctrl___184"></a><code>Ctrl &#43; ]</code>&#xff1a;移动至代码块末尾</h3> 
<p><img src="https://img-blog.csdnimg.cn/551938c94cda45839acce8c3d2e141d5.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__Down_189"></a><code>Alt &#43; Down</code>&#xff1a;下一个方法</h3> 
<h3><a id="Alt__Up_191"></a><code>Alt &#43; Up</code>&#xff1a;上一个方法</h3> 
<p><img src="https://img-blog.csdnimg.cn/65e33174dc8b4900901bfd116aa8790f.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__PageUp_196"></a><code>Ctrl &#43; PageUp</code>&#xff1a;移动至页面顶部</h3> 
<h3><a id="Ctrl__PageDown_198"></a><code>Ctrl &#43; PageDown</code>&#xff1a;移动至页面底部</h3> 
<p><img src="https://img-blog.csdnimg.cn/2faf5fe547f24a278eb0aa7adfaa209d.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="PageUp_203"></a><code>PageUp</code>&#xff1a;向上翻页</h3> 
<h3><a id="PageDown_205"></a><code>PageDown</code>&#xff1a;向下翻页</h3> 
<p><img src="https://img-blog.csdnimg.cn/ad92de13292148379d5c0fb66cff5926.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Home_210"></a><code>Ctrl &#43; Home</code>&#xff1a;移动至文件开头</h3> 
<h3><a id="Ctrl__End_212"></a><code>Ctrl &#43; End</code>&#xff1a;移动至文件末尾</h3> 
<p><img src="https://img-blog.csdnimg.cn/2974c4677ebc49dbb381a4f9e14c09f6.gif" alt="在这里插入图片描述" /></p> 
<h1><a id="_217"></a>四、文本选择</h1> 
<h3><a id="Ctrl__A_221"></a><code>Ctrl &#43; A</code>&#xff1a;全选</h3> 
<h3><a id="Shift__Left_223"></a><code>Shift &#43; Left</code>&#xff1a;向左选择</h3> 
<h3><a id="Shift__Right_225"></a><code>Shift &#43; Right</code>&#xff1a;向右选择</h3> 
<p><img src="https://img-blog.csdnimg.cn/4d21a18d8dfc4700abe399df9fcad5ec.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__Left_230"></a><code>Ctrl &#43; Shift &#43; Left</code>&#xff1a;向左选择一个单词</h3> 
<h3><a id="Ctrl__Shift__Right_232"></a><code>Ctrl &#43; Shift &#43; Right</code>&#xff1a;向右选择一个单词</h3> 
<p><img src="https://img-blog.csdnimg.cn/39b5ce84c32949c292fed2673f195b51.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Shift__Home_237"></a><code>Shift &#43; Home</code>&#xff1a;向左选择至行头</h3> 
<h3><a id="Shift__End_239"></a><code>Shift &#43; End</code>&#xff1a;向右选择至行尾</h3> 
<p><img src="https://img-blog.csdnimg.cn/c6c8be7bd0f4409a98992883af8572ea.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Shift__Up_243"></a><code>Shift &#43; Up</code>&#xff1a;向上选择</h3> 
<h3><a id="Shift__Down_245"></a><code>Shift &#43; Down</code>&#xff1a;向下选择</h3> 
<p><img src="https://img-blog.csdnimg.cn/f7c3fb94d07d460aba83fe6dfbcab441.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift___250"></a><code>Ctrl &#43; Shift &#43; [</code>&#xff1a;选择至代码块开头</h3> 
<h3><a id="Ctrl__Shift___252"></a><code>Ctrl &#43; Shift &#43; ]</code>&#xff1a;选择至代码块结尾</h3> 
<p><img src="https://img-blog.csdnimg.cn/66a2ec10cd3d415791654062ac897e1c.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__PageUp_257"></a><code>Ctrl &#43; Shift &#43; PageUp</code>&#xff1a;选择至页面顶部</h3> 
<h3><a id="Ctrl__Shift__PageDown_259"></a><code>Ctrl &#43; Shift &#43; PageDown</code>&#xff1a;选择至页面底部</h3> 
<p><img src="https://img-blog.csdnimg.cn/94a2859aa5024ba597661cb0c6feabbb.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Shift__PageUp_264"></a><code>Shift &#43; PageUp</code>&#xff1a;向上翻页选择</h3> 
<h3><a id="Shift__PageDown_266"></a><code>Shift &#43; PageDown</code>&#xff1a;向下翻页选择</h3> 
<p><img src="https://img-blog.csdnimg.cn/8202de635dc34a779a4d2d2e7bee678a.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__Home_271"></a><code>Ctrl &#43; Shift &#43; Home</code>&#xff1a;选择至文件开关</h3> 
<h3><a id="Ctrl__Shift__End_273"></a><code>Ctrl &#43; Shift &#43; End</code>&#xff1a;选择至文件结尾</h3> 
<p><img src="https://img-blog.csdnimg.cn/a04f5b2937f84c9aa6ab98ac5ca831c2.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__W_278"></a><code>Ctrl &#43; W</code>&#xff1a;扩展选择</h3> 
<h3><a id="Ctrl__Shift__W_280"></a><code>Ctrl &#43; Shift &#43; W</code>&#xff1a;收缩选择</h3> 
<p><img src="https://img-blog.csdnimg.cn/ed03a89010b849d792d3d14cbbfa2575.gif" alt="在这里插入图片描述" /></p> 
<h1><a id="_285"></a>五、代码折叠</h1> 
<h3><a id="Ctrl__NumPad_289"></a><code>Ctrl &#43; NumPad&#43;</code>&#xff1a;展开代码块</h3> 
<h3><a id="Ctrl__NumPad_291"></a><code>Ctrl &#43; NumPad-</code>&#xff1a;折叠代码块</h3> 
<p><img src="https://img-blog.csdnimg.cn/3fe550a3ee6b47d59e227a734e6683c2.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__NumPad_296"></a><code>Ctrl &#43; Alt &#43; NumPad&#43;</code>&#xff1a;递归展开</h3> 
<h3><a id="Ctrl__Alt__NumPad_298"></a><code>Ctrl &#43; Alt &#43; NumPad-</code>&#xff1a;递归折叠</h3> 
<p><img src="https://img-blog.csdnimg.cn/49968c30ec584504a0f8dc24e2cf769d.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__NumPad_303"></a><code>Ctrl &#43; Shift &#43; NumPad&#43;</code>&#xff1a;全部展开</h3> 
<h3><a id="Ctrl__Shift__NumPad_305"></a><code>Ctrl &#43; Shift &#43; NumPad-</code>&#xff1a;全部折叠</h3> 
<p><img src="https://img-blog.csdnimg.cn/4d1afb9746d84893abc59af64783ee30.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl___309"></a><code>Ctrl &#43; .</code>&#xff1a;折叠选择</h3> 
<h1><a id="_311"></a>六、多个插入符号和范围选择</h1> 
<h3><a id="Alt__Shift__Click_313"></a><code>Alt &#43; Shift &#43; Click</code>&#xff1a;添加/删除插入符号</h3> 
<p><img src="https://img-blog.csdnimg.cn/cc1980f2dacd4e7aa310fa8ace0bb995.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__Shift__Insert_318"></a><code>Alt &#43; Shift &#43; Insert</code>&#xff1a;切换列选择模式</h3> 
<p><img src="https://img-blog.csdnimg.cn/ed6d6e2d9b644debac59e9eb097ba198.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Up_322"></a>双击<code>Ctrl</code> &#43; <code>Up</code>&#xff1a;向上克隆插入符号</h3> 
<p>按<code>Ctrl</code>键两次&#xff0c;然后在不松开的情况下按向上箭头键。</p> 
<p><img src="https://img-blog.csdnimg.cn/42077a8085d24aaab78224d034138624.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Down_329"></a>双击<code>Ctrl</code> &#43; <code>Down</code>&#xff1a;向下克隆插入符号</h3> 
<p>按<code>Ctrl</code>键两次&#xff0c;然后在不松开的情况下按向下箭头键。</p> 
<p><img src="https://img-blog.csdnimg.cn/e567d8d965654a9caf7281eefd4443b5.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__Shift__G_336"></a><code>Alt &#43; Shift &#43; G</code>&#xff1a;将插入符号添加到选择中的每一行</h3> 
<p><img src="https://img-blog.csdnimg.cn/e87a0ad15e884a259d6d97a7e064a933.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__J_341"></a><code>Alt &#43; J</code>&#xff1a;选择单位下次出现的位置</h3> 
<h3><a id="Alt__Shift__J_343"></a><code>Alt &#43; Shift &#43; J</code>&#xff1a;取消最后一次选择</h3> 
<p><img src="https://img-blog.csdnimg.cn/fbe0d9f5fc1249b794de7b7ee3e4ca4d.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Shift__J_347"></a><code>Ctrl &#43; Alt &#43; Shift &#43; J</code>&#xff1a;选择所有出现的位置</h3> 
<p><img src="https://img-blog.csdnimg.cn/7574314a8c1242069f5c7b5d885bd982.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__Shift__MiddleClick_352"></a><code>Alt &#43; Shift &#43; Middle-Click</code>&#xff1a;创建矩形选择</h3> 
<p><img src="https://img-blog.csdnimg.cn/6b6f6b9f460848c9af8e1a9be5816516.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__Click_357"></a><code>Alt &#43; Click</code>&#xff1a;拖拽以创建矩形选择区</h3> 
<p><img src="https://img-blog.csdnimg.cn/d3548110c7ba43cd98212482d9c61bbb.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Shift__Click_362"></a><code>Ctrl &#43; Alt &#43; Shift &#43; Click</code>&#xff1a;拖拽以创建多个矩形选择区</h3> 
<p><img src="https://img-blog.csdnimg.cn/a852227b2fa948db96fd952a7b78f99d.gif" alt="在这里插入图片描述" /></p> 
<h1><a id="_367"></a>七、辅助编码</h1> 
<h3><a id="Alt__Enter_371"></a><code>Alt &#43; Enter</code>&#xff1a;显示建议操作</h3> 
<p>该快捷键又称为“万通快捷键”&#xff0c;它会根据不同的语境建议不同的操作。下面这个演示只是其中的一种&#xff0c;还有很多种用法&#xff0c;你可以尝试一下。</p> 
<p><img src="https://img-blog.csdnimg.cn/371fa9207ae1460795a8a2c2f5521ec6.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Space_378"></a><code>Ctrl &#43; Space</code>&#xff1a;代码补全</h3> 
<p><img src="https://img-blog.csdnimg.cn/c89503e3b08741d0bc860399ffb6c016.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__Space_383"></a><code>Ctrl &#43; Shift &#43; Space</code>&#xff1a;类型匹配代码补全</h3> 
<p><img src="https://img-blog.csdnimg.cn/0892dac19ec843049b6005a8eee27d05.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Space_388"></a><code>Ctrl &#43; Alt &#43; Space</code>&#xff1a;第二次代码补全</h3> 
<p><img src="https://img-blog.csdnimg.cn/7090a150a8da43dda25597709823ea70.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__Enter_393"></a><code>Ctrl &#43; Shift &#43; Enter</code>&#xff1a;补全当前语句</h3> 
<p><img src="https://img-blog.csdnimg.cn/493e2c73788f43fca9cd7bd9e61e2ee4.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__L_398"></a><code>Ctrl &#43; Alt &#43; L</code>&#xff1a;格式化代码</h3> 
<p><img src="https://img-blog.csdnimg.cn/f04e3f89999047bd819115947ac47bfd.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__P_403"></a><code>Ctrl &#43; P</code>&#xff1a;参数信息提醒</h3> 
<p><img src="https://img-blog.csdnimg.cn/f3d987b1cbee4f23a44d86ca5ef8819d.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Q_408"></a><code>Ctrl &#43; Q</code>&#xff1a;快速文档</h3> 
<p><img src="https://img-blog.csdnimg.cn/54ec5a385a7944e98958338b30da985c.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__Up_413"></a><code>Ctrl &#43; Shift &#43; Up</code>&#xff1a;向上移动语句</h3> 
<h3><a id="Ctrl__Shift__Down_415"></a><code>Ctrl &#43; Shift &#43; Down</code>&#xff1a;向下移动语句</h3> 
<p><img src="https://img-blog.csdnimg.cn/d915a7e024c543a6aaa5936b205a0ec8.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Shift__Left_420"></a><code>Ctrl &#43; Alt &#43; Shift &#43; Left</code>&#xff1a;向左移动元素</h3> 
<h3><a id="Ctrl__Alt__Shift__Right_422"></a><code>Ctrl &#43; Alt &#43; Shift &#43; Right</code>&#xff1a;向右移动元素</h3> 
<p><img src="https://img-blog.csdnimg.cn/3ce61ba21e234683b03d73387b057ed8.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__Shift__Up_427"></a><code>Alt &#43; Shift &#43; Up</code>&#xff1a;向上移动队列</h3> 
<h3><a id="Alt__Shift__Down_429"></a><code>Alt &#43; Shift &#43; Down</code>&#xff1a;向下移动队列</h3> 
<p><img src="https://img-blog.csdnimg.cn/74e0ac26186d476b89243a6be8d96fb1.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl___434"></a><code>Ctrl &#43; /</code>&#xff1a;添加行注释</h3> 
<p><img src="https://img-blog.csdnimg.cn/e2ce7eb41c0045e8931de8ae777436eb.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift___439"></a><code>Ctrl &#43; Shift &#43; /</code>&#xff1a;添加块注释</h3> 
<p><img src="https://img-blog.csdnimg.cn/4c70509e6b964ca994093f3e3b175444.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__Insert_444"></a><code>Alt &#43; Insert</code>&#xff1a;生产语句</h3> 
<p><img src="https://img-blog.csdnimg.cn/7b086520fc0c4bb8977058994358df1a.gif" alt="在这里插入图片描述" /></p> 
<h1><a id="_449"></a>八、上下文导航</h1> 
<h3><a id="Alt__Down_453"></a><code>Alt &#43; Down</code>&#xff1a;跳转至下一个方法</h3> 
<h3><a id="Alt__Up_455"></a><code>Alt &#43; Up</code>&#xff1a;跳转至上一个方法</h3> 
<p><img src="https://img-blog.csdnimg.cn/0c846696b7724613bc64087457f84166.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__G_460"></a><code>Ctrl &#43; G</code>&#xff1a;跳转到指定行</h3> 
<p><img src="https://img-blog.csdnimg.cn/494e2f1d1fa641e8a6077189e75fd9f6.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Tab_465"></a><code>Ctrl &#43; Tab</code>&#xff1a;切换活动文件</h3> 
<p><img src="https://img-blog.csdnimg.cn/085bbf77056542a2b5b4a14fac825a10.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__F1_470"></a><code>Alt &#43; F1</code>&#xff1a;选择文件的定位</h3> 
<p><img src="https://img-blog.csdnimg.cn/b7b3a3e4c22a458e9ac013795339d5a5.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__E_475"></a><code>Ctrl &#43; E</code>&#xff1a;最近的文件</h3> 
<p><img src="https://img-blog.csdnimg.cn/d6875a50b6e34837bb94172d28847094.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__Backspace_480"></a><code>Ctrl &#43; Shift &#43; Backspace</code>&#xff1a;返回上次编辑位置</h3> 
<p><img src="https://img-blog.csdnimg.cn/6998a799f030469690e556e36e7ce008.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Left_485"></a><code>Ctrl &#43; Alt &#43; Left</code>&#xff1a;后退</h3> 
<h3><a id="Ctrl__Alt__Right_487"></a><code>Ctrl &#43; Alt &#43; Right</code>&#xff1a;前进</h3> 
<p><img src="https://img-blog.csdnimg.cn/6ebc1ad4eee64583ae0ee245c5d0702a.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Down_492"></a><code>Ctrl &#43; Alt &#43; Down</code>&#xff1a;下一事件</h3> 
<h3><a id="Ctrl__Alt__Up_494"></a><code>Ctrl &#43; Alt &#43; Up</code>&#xff1a;上一事件</h3> 
<p><img src="https://img-blog.csdnimg.cn/85bcc3b78b88469089a58d77c4366e74.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__Right_501"></a><code>Alt &#43; Right</code>&#xff1a;选择下一个选项卡</h3> 
<h3><a id="Alt__Left_503"></a><code>Alt &#43; Left</code>&#xff1a;选择下一个选项卡</h3> 
<p><img src="https://img-blog.csdnimg.cn/89c87b36451b486c82a5726e9efccf44.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="F11_508"></a><code>F11</code>&#xff1a;切换匿名书签</h3> 
<p><img src="https://img-blog.csdnimg.cn/f34f42766d6c422f9ccab5137d2144f6.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__digit_513"></a><code>Ctrl &#43; Shift &#43; [digit]</code>&#xff1a;用数字切换书签</h3> 
<p><img src="https://img-blog.csdnimg.cn/6e06898844164a859b25ef8f8a57f356.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__F11_518"></a><code>Ctrl &#43; F11</code>&#xff1a;使用助词符切换书签</h3> 
<p><img src="https://img-blog.csdnimg.cn/ea468949076c4de1803209483cb562b8.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Shift__F11_523"></a><code>Shift &#43; F11</code>&#xff1a;显示所有书签</h3> 
<p><img src="https://img-blog.csdnimg.cn/0ea69e74fafe4990bec2ef8f469c9b9e.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__digit_527"></a><code>Ctrl &#43; [digit]</code>&#xff1a;用数字跳转到书签</h3> 
<p><img src="https://img-blog.csdnimg.cn/e1d7c4b05101473590f602bd1c942fb1.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__7_532"></a><code>Alt &#43; 7</code>&#xff1a;显示结构窗口</h3> 
<p><img src="https://img-blog.csdnimg.cn/87a56697a2aa4c23ac5c4ff104ed2fcc.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__3_537"></a><code>Alt &#43; 3</code>&#xff1a;显示查找窗口</h3> 
<p><img src="https://img-blog.csdnimg.cn/97af9e1d176b4afcad4c42b8f80438f6.gif" alt="在这里插入图片描述" /></p> 
<h1><a id="_542"></a>九、查找操作</h1> 
<h3><a id="Shift_546"></a>双击<code>Shift</code>&#xff1a;查找所有</h3> 
<p><img src="https://img-blog.csdnimg.cn/5d19e3e8345d4fe5babbb8d3548d5ca6.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__F_551"></a><code>Ctrl &#43; F</code>&#xff1a;查找字符&#xff08;当前文件&#xff09;</h3> 
<p><img src="https://img-blog.csdnimg.cn/f7097b553dbf4746a852f37eb33b82a5.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="F3_556"></a><code>F3</code>&#xff1a;查找下一个</h3> 
<h3><a id="Shift__F3_558"></a><code>Shift &#43; F3</code>&#xff1a;查找上一个</h3> 
<p><img src="https://img-blog.csdnimg.cn/e1a0d8c99c264698a97f919ecc7dc075.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__R_563"></a><code>Ctrl &#43; R</code>&#xff1a;替换字符&#xff08;当前文件&#xff09;</h3> 
<p><img src="https://img-blog.csdnimg.cn/0a5f84b14a14462bbf87dcddb6081a69.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__F_568"></a><code>Ctrl &#43; Shift &#43; F</code>&#xff1a;查找字符&#xff08;所有文件&#xff09;</h3> 
<p><img src="https://img-blog.csdnimg.cn/ddc4beeb20b94ff7a0c09fc14c102469.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__R_573"></a><code>Ctrl &#43; Shift &#43; R</code>&#xff1a;替换字符&#xff08;所有文件&#xff09;</h3> 
<p><img src="https://img-blog.csdnimg.cn/692c58fc5bc542dcb8e2a3bdc711d043.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__F3_578"></a><code>Ctrl &#43; F3</code>&#xff1a;跳转到光标处单词的下一位置</h3> 
<p><img src="https://img-blog.csdnimg.cn/c06cf22bc8c842a182852402f22b82e1.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__N_583"></a><code>Ctrl &#43; Shift &#43; N</code>&#xff1a;查找文件并跳转</h3> 
<p><img src="https://img-blog.csdnimg.cn/e50515c71410498dbf21b0789da24641.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__F12_588"></a><code>Ctrl &#43; F12</code>&#xff1a;打开文件结构</h3> 
<p><img src="https://img-blog.csdnimg.cn/cf2c4c5a32ad405289d5f446103fd44f.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Shift__N_593"></a><code>Ctrl &#43; Alt &#43; Shift &#43; N</code>&#xff1a;查找符号&#xff08;变量、方法等&#xff09;</h3> 
<p><img src="https://img-blog.csdnimg.cn/1fbfd2d7706f479a974d6356c737ef39.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__A_598"></a><code>Ctrl &#43; Shift &#43; A</code>&#xff1a;查找动作</h3> 
<p><img src="https://img-blog.csdnimg.cn/06e627eb36f74566b73cb7347d6bf0a7.gif" alt="在这里插入图片描述" /></p> 
<h1><a id="_603"></a>十、符号导航</h1> 
<h3><a id="Alt__F7_605"></a><code>Alt &#43; F7</code>&#xff1a;查找用法</h3> 
<h3><a id="Ctrl__B_607"></a><code>Ctrl &#43; B</code>&#xff1a;跳转到声明处</h3> 
<p><img src="https://img-blog.csdnimg.cn/b1ed908240f444f58bafa2f469a09a66.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__B_612"></a><code>Ctrl &#43; Shift &#43; B</code>&#xff1a;跳转到声明类处</h3> 
<p><img src="https://img-blog.csdnimg.cn/6c0478efac1e4ac3ab4386a0eaa19487.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__F7_617"></a><code>Ctrl &#43; Alt &#43; F7</code>&#xff1a;显示用法</h3> 
<h3><a id="Ctrl__U_619"></a><code>Ctrl &#43; U</code>&#xff1a;跳转到超级方法</h3> 
<h3><a id="Ctrl__Alt__B_621"></a><code>Ctrl &#43; Alt &#43; B</code>&#xff1a;跳转到实现方法</h3> 
<p><img src="https://img-blog.csdnimg.cn/2025bcf65b7d41ce8c324798158ecdab.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__F7_626"></a><code>Ctrl &#43; Shift &#43; F7</code>&#xff1a;突出显示文件中的用法</h3> 
<h1><a id="_630"></a>十一、代码分析</h1> 
<h3><a id="Alt__Enter_632"></a><code>Alt &#43; Enter</code>&#xff1a;显示意图操作</h3> 
<p><img src="https://img-blog.csdnimg.cn/6510a1ef14ca43c598840cdb6af73eb1.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__F1_637"></a><code>Ctrl &#43; F1</code>&#xff1a;显示错误描述</h3> 
<p><img src="https://img-blog.csdnimg.cn/791b5ed976654efe8250a7b9006def16.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="F2_642"></a><code>F2</code>&#xff1a;下一个突出显示的错误</h3> 
<h3><a id="Shift__F2_644"></a><code>Shift &#43; F2</code>&#xff1a;上一个突出显示的错误</h3> 
<p><img src="https://img-blog.csdnimg.cn/159e9c8f850749cca21f1e8c58c7a949.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Shift__I_649"></a><code>Ctrl &#43; Alt &#43; Shift &#43; I</code>&#xff1a;按名称运行检查</h3> 
<p><img src="https://img-blog.csdnimg.cn/43f2263b1a324184acaff8a80021246e.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__6_654"></a><code>Alt &#43; 6</code>&#xff1a;显示问题窗口</h3> 
<p><img src="https://img-blog.csdnimg.cn/3654780a8ebf4c85abd0f4c2814a2ef3.gif" alt="在这里插入图片描述" /></p> 
<h1><a id="_659"></a>十二、运行和调试</h1> 
<h3><a id="Ctrl_663"></a>双击<code>Ctrl</code>&#xff1a;运行所有</h3> 
<p><img src="https://img-blog.csdnimg.cn/794c69a78c4542ba8a56240064a12cb7.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Shift__F10_670"></a><code>Shift &#43; F10</code>&#xff1a;运行上下文配置</h3> 
<p><img src="https://img-blog.csdnimg.cn/609833479f1047f29365249344860abe.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__Shift__F10_675"></a><code>Alt &#43; Shift &#43; F10</code>&#xff1a;打开运行窗口</h3> 
<p><img src="https://img-blog.csdnimg.cn/02bf116033724e46aff7df5d649407ea.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Shift__F9_680"></a><code>Shift &#43; F9</code>&#xff1a;调试上下文配置</h3> 
<p><img src="https://img-blog.csdnimg.cn/2f2196226f8f4225ac9ac03dece7e90a.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__Shift__F9_685"></a><code>Alt &#43; Shift &#43; F9</code>&#xff1a;打开调试窗口</h3> 
<p><img src="https://img-blog.csdnimg.cn/07e4994fda7b4ede90c3913fc6dac78a.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__F5_690"></a><code>Ctrl &#43; Alt &#43; F5</code>&#xff1a;附加到进程</h3> 
<h3><a id="Ctrl__F2_692"></a><code>Ctrl &#43; F2</code>&#xff1a;停止</h3> 
<p><img src="https://img-blog.csdnimg.cn/69b16b0010354e85a4d40d2ef38b3bea.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="F9_697"></a><code>F9</code>&#xff1a;运行至下一断点</h3> 
<p><img src="https://img-blog.csdnimg.cn/a9134a8b348647b6aa862473d2a12abf.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__F2_702"></a><code>Ctrl &#43; Shift &#43; F2</code>&#xff1a;停止后台进程</h3> 
<h3><a id="F8_704"></a><code>F8</code>&#xff1a;跨过调用</h3> 
<p><img src="https://img-blog.csdnimg.cn/7d4fd6818efd44eca3de5aa38fe964ea.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__Shift__F8_709"></a><code>Alt &#43; Shift &#43; F8</code>&#xff1a;强制跨过调用</h3> 
<h3><a id="F7_711"></a><code>F7</code>&#xff1a;进入调用</h3> 
<p><img src="https://img-blog.csdnimg.cn/54e822901ca24ff4abd342591d0413d3.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Shift__F7_716"></a><code>Shift &#43; F7</code>&#xff1a;智能进入调用</h3> 
<h3><a id="Alt__Shift__F7_718"></a><code>Alt &#43; Shift &#43; F7</code>&#xff1a;强制进入调用</h3> 
<h3><a id="Shift__F8_720"></a><code>Shift &#43; F8</code>&#xff1a;跳出调用</h3> 
<p><img src="https://img-blog.csdnimg.cn/3560263d26da4f73a41120d0c1f08c87.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__F9_725"></a><code>Alt &#43; F9</code>&#xff1a;运行至光标处</h3> 
<p><img src="https://img-blog.csdnimg.cn/4eebb9f8d51b45f4b1536946ca6d4269.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__F9_730"></a><code>Ctrl &#43; Alt &#43; F9</code>&#xff1a;强制运行至光标处</h3> 
<h3><a id="Alt__F10_732"></a><code>Alt &#43; F10</code>&#xff1a;显示执行点</h3> 
<p><img src="https://img-blog.csdnimg.cn/431760f3b33f419bbe80e83552ef100d.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__F8_737"></a><code>Alt &#43; F8</code>&#xff1a;评估表达式</h3> 
<h3><a id="Ctrl__Alt__F8_739"></a><code>Ctrl &#43; Alt &#43; F8</code>&#xff1a;快速评估表达式</h3> 
<h3><a id="Ctrl__F8_741"></a><code>Ctrl &#43; F8</code>&#xff1a;切换行断点</h3> 
<p><img src="https://img-blog.csdnimg.cn/da5ce3f846aa4e7db8e04ebb2ce6bd02.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Shift__F8_746"></a><code>Ctrl &#43; Alt &#43; Shift &#43; F8</code>&#xff1a;切换临时行断点</h3> 
<p><img src="https://img-blog.csdnimg.cn/e79eaee370b04993bce84b4187ef2988.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__F8_751"></a><code>Ctrl &#43; Shift &#43; F8</code>&#xff1a;查看断点</h3> 
<p><img src="https://img-blog.csdnimg.cn/395a662231db460fb0252dcc8329be72.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__F8_756"></a><code>Ctrl &#43; Shift &#43; F8</code>&#xff1a;编辑断点</h3> 
<p><img src="https://img-blog.csdnimg.cn/c4fc107f9fbd4883ba94e9c50b058213.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__4_761"></a><code>Alt &#43; 4</code>&#xff1a;显示运行窗口</h3> 
<h3><a id="Alt__5_763"></a><code>Alt &#43; 5</code>&#xff1a;显示调试窗口</h3> 
<h3><a id="Alt__8_765"></a><code>Alt &#43; 8</code>&#xff1a;显示服务窗口</h3> 
<p><img src="https://img-blog.csdnimg.cn/37143ac358174cdfa5ef2de10778e0eb.gif" alt="在这里插入图片描述" /></p> 
<h1><a id="_770"></a>十三、代码重构</h1> 
<h3><a id="Ctrl__Alt__Shift__T_774"></a><code>Ctrl &#43; Alt &#43; Shift &#43; T</code>&#xff1a;打开重构列表</h3> 
<p><img src="https://img-blog.csdnimg.cn/635111af2ea548b386b87e004e61aaec.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Shift__F6_779"></a><code>Shift &#43; F6</code>&#xff1a;修改名称</h3> 
<h3><a id="Ctrl__F6_781"></a><code>Ctrl &#43; F6</code>&#xff1a;修改签名</h3> 
<h3><a id="Ctrl__Alt__N_783"></a><code>Ctrl &#43; Alt &#43; N</code>&#xff1a;内联</h3> 
<h3><a id="F6_785"></a><code>F6</code>&#xff1a;移动</h3> 
<h3><a id="Ctrl__Alt__M_787"></a><code>Ctrl &#43; Alt &#43; M</code>&#xff1a;提取方法</h3> 
<p><img src="https://img-blog.csdnimg.cn/bb58bb4a0e18434b87aa6ca6cc2cd8bc.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__F_792"></a><code>Ctrl &#43; Alt &#43; F</code>&#xff1a;引入域</h3> 
<h3><a id="Ctrl__Alt__P_794"></a><code>Ctrl &#43; Alt &#43; P</code>&#xff1a;引入参数</h3> 
<h3><a id="Ctrl__Alt__V_796"></a><code>Ctrl &#43; Alt &#43; V</code>&#xff1a;引入变量</h3> 
<h3><a id="Alt__Delete_798"></a><code>Alt &#43; Delete</code>&#xff1a;安全删除</h3> 
<h1><a id="_CVS__802"></a>十四、全局 CVS 操作</h1> 
<h3><a id="Alt____CVS__804"></a>&#96;Alt &#43; &#96;&#96; &#xff1a;弹出 CVS 窗口</h3> 
<p><img src="https://img-blog.csdnimg.cn/22c1629f938640258189513e11577ddb.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__K_809"></a><code>Ctrl &#43; K</code>&#xff1a;提交</h3> 
<p><img src="https://img-blog.csdnimg.cn/e50075acdd52481b803eb35ee1bf8179.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__T_814"></a><code>Ctrl &#43; T</code>&#xff1a;更新项目</h3> 
<p><img src="https://img-blog.csdnimg.cn/db6203efd97543e6a72fa3640b3e2db1.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Z_819"></a><code>Ctrl &#43; Alt &#43; Z</code>&#xff1a;回滚</h3> 
<p><img src="https://img-blog.csdnimg.cn/9af90d76bf304638ba59f263fbe38c72.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__K_824"></a><code>Ctrl &#43; Shift &#43; K</code>&#xff1a;拉取</h3> 
<p><img src="https://img-blog.csdnimg.cn/69976af115ae497291d54b22e58b54e9.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Shift__Down_829"></a><code>Ctrl &#43; Alt &#43; Shift &#43; Down</code>&#xff1a;下一个修改</h3> 
<h3><a id="Ctrl__Alt__Shift__Up_831"></a><code>Ctrl &#43; Alt &#43; Shift &#43; Up</code>&#xff1a;上一个修改</h3> 
<h3><a id="Alt__9_833"></a><code>Alt &#43; 9</code>&#xff1a;显示版本控制窗口</h3> 
<h3><a id="Alt__0_835"></a><code>Alt &#43; 0</code>&#xff1a;显示提交窗口</h3> 
<p><img src="https://img-blog.csdnimg.cn/7b3acb389b89427c93db5fdbf95b2556.gif" alt="在这里插入图片描述" /></p> 
<h1><a id="_840"></a>十五、差异查看器</h1> 
<h3><a id="F7_842"></a><code>F7</code>&#xff1a;下一个差异</h3> 
<h3><a id="Shift__F7_844"></a><code>Shift &#43; F7</code>&#xff1a;上一个差异</h3> 
<p><img src="https://img-blog.csdnimg.cn/53a52397a3be4dce855b079d7a4834d5.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__R_848"></a><code>Ctrl &#43; Alt &#43; R</code>&#xff1a;接受左侧</h3> 
<h3><a id="Ctrl__Alt__A_850"></a><code>Ctrl &#43; Alt &#43; A</code>&#xff1a;接受右侧</h3> 
<p><img src="https://img-blog.csdnimg.cn/0b2e3e6766464d0aaa4b7e96ac9f1620.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__Tab_855"></a><code>Ctrl &#43; Shift &#43; Tab</code>&#xff1a;选择对面的差异窗格</h3> 
<p><img src="https://img-blog.csdnimg.cn/0ef49971918f4d929c569d0f0599ce45.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__D_859"></a><code>Ctrl &#43; Shift &#43; D</code>&#xff1a;显示差异设置窗口</h3> 
<h1><a id="_861"></a>十六、工具窗口</h1> 
<h3><a id="Shift__Escape_865"></a><code>Shift &#43; Escape</code>&#xff1a;隐藏活动的工具窗口</h3> 
<p><img src="https://img-blog.csdnimg.cn/1cb7303d6dc5458982c2bec5835c0c38.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Shift__F12_869"></a><code>Ctrl &#43; Shift &#43; F12</code>&#xff1a;隐藏所有工具窗口</h3> 
<p><img src="https://img-blog.csdnimg.cn/42b9da936e264c3d8ec5d20a27860404.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="F12_874"></a><code>F12</code>&#xff1a;跳转到最后一个工具窗口</h3> 
<h3><a id="Ctrl__Alt__Shift__Left_876"></a><code>Ctrl &#43; Alt &#43; Shift &#43; Left</code>&#xff1a;向左延伸窗口大小</h3> 
<h3><a id="Ctrl__Alt__Shift__Right_878"></a><code>Ctrl &#43; Alt &#43; Shift &#43; Right</code>&#xff1a;向右延伸窗口大小</h3> 
<p><img src="https://img-blog.csdnimg.cn/bf8bd51e33e946019ae8ee3206284a30.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Ctrl__Alt__Shift__Up_882"></a><code>Ctrl &#43; Alt &#43; Shift &#43; Up</code>&#xff1a;向顶部延伸窗口大小</h3> 
<h3><a id="Ctrl__Alt__Shift__Down_884"></a><code>Ctrl &#43; Alt &#43; Shift &#43; Down</code>&#xff1a;向底部延伸窗口大小</h3> 
<p><img src="https://img-blog.csdnimg.cn/29496cdc3b1544de9970eb558f2fda0a.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__1_889"></a><code>Alt &#43; 1</code>&#xff1a;显示项目窗口</h3> 
<h3><a id="Alt__2_891"></a><code>Alt &#43; 2</code>&#xff1a;显示书签窗口</h3> 
<h3><a id="Alt__3_893"></a><code>Alt &#43; 3</code>&#xff1a;显示查找窗口</h3> 
<h3><a id="Alt__4_895"></a><code>Alt &#43; 4</code>&#xff1a;显示运行窗口</h3> 
<h3><a id="Alt__5_897"></a><code>Alt &#43; 5</code>&#xff1a;显示调试窗口</h3> 
<h3><a id="Alt__6_899"></a><code>Alt &#43; 6</code>&#xff1a;显示问题窗口</h3> 
<h3><a id="Alt__7_901"></a><code>Alt &#43; 7</code>&#xff1a;显示结构窗口</h3> 
<h3><a id="Alt__8_903"></a><code>Alt &#43; 8</code>&#xff1a;显示服务窗口</h3> 
<h3><a id="Alt__9_905"></a><code>Alt &#43; 9</code>&#xff1a;显示版本控制窗口</h3> 
<h3><a id="Alt__0_907"></a><code>Alt &#43; 0</code>&#xff1a;显示提交窗口</h3> 
<p><img src="https://img-blog.csdnimg.cn/e7d7e453bc2047978a3c939814425694.gif" alt="在这里插入图片描述" /></p> 
<h3><a id="Alt__F12_911"></a><code>Alt &#43; F12</code>&#xff1a;显示终端窗口</h3> 
<p><img src="https://img-blog.csdnimg.cn/bc679af9f0d4439880309430c1234471.gif" alt="在这里插入图片描述" /></p> 
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-18T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">JApiDocs教程</title>
    <id>https://blog.ciberviler.top/dev/JApiDocs%E6%95%99%E7%A8%8B.html</id>
    <link href="https://blog.ciberviler.top/dev/JApiDocs%E6%95%99%E7%A8%8B.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">JApiDocs教程</summary>
    <content type="html"><![CDATA[<h1 id="japidocs教程" tabindex="-1"> JApiDocs教程</h1>
<p>一、Maven依赖</p>
<div><pre><code>&lt;!--  JApiDocs  -->
&lt;dependency>
   &lt;groupId>io.github.yedaxia&lt;/groupId>
   &lt;artifactId>japidocs&lt;/artifactId>
   &lt;version>1.4.3&lt;/version>
&lt;/dependency>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="二、代码规范" tabindex="-1"> 二、代码规范</h2>
<h3 id="_1-分组名称-description" tabindex="-1"> 1. 分组名称 @description</h3>
<p><em>注：官方文档中注明分组名称@description，但是实际应用中不需要加入注解，像下例所示，直接写注释即可。（类上写不写都行，方法上如果加上@description反而不显示）</em>
例：</p>
<div><pre><code>/**
 * 用户接口
 */
/*注意：这里不能空行，否则注释名无法显示*/
@RequestMapping("test")
@Controller
public class testInterface {

    @Autowired
    private RoleService roleService;
    /**
     * 保存用户
     */
    @PostMapping("advice")
    public RoleInfo getAdviceList(String docId){
        return roleService.FindRoleBydocId(docId);
    }

}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_2-接口参数-japidocs-会通过-param-来寻找接口参数和进一步解析参数的内容" tabindex="-1"> 2. 接口参数（JApiDocs 会通过 @param 来寻找接口参数和进一步解析参数的内容）</h3>
<p><em>注：注释一定要放在@注解的上面，否则参数会不显示</em></p>
<h4 id="_1-格式-接口参数-param-字段-字段解释" tabindex="-1"> （1）格式：接口参数 @param 字段 字段解释</h4>
<p>例：</p>
<div><pre><code>/**
     * @description 保存用户
     * @param docId  医生id
    */
@PostMapping("advice")
public RoleInfo getAdviceList(String docId){
    return roleService.FindRoleBydocId(docId);
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_2-在相应的bean对象里添加注释" tabindex="-1"> （2）在相应的bean对象里添加注释</h4>
<p>例：</p>
<div><pre><code>public class RemindInfo implements Serializable {
  private long remindId;  //提醒id
  private String remindContent;  //提醒信息
  private java.sql.Timestamp remindTime;  //提醒时间
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_3-返回对象" tabindex="-1"> 3. 返回对象</h3>
<h4 id="_1-restcontroller-或-responsebody" tabindex="-1"> （1）@RestController 或 @ResponseBody</h4>
<p>返回json数据类型
例：</p>
<div><pre><code>/**
 * 用户接口
 */
@RequestMapping("/test")
@RestController
public class testInterface {

    @Autowired
    private RoleService roleService;
    /**
     * 保存用户
     * @param docId  医生id
     */
    @ApiDoc
    @PostMapping("advice")
    public RoleInfo getAdviceList(String docId){
        return roleService.FindRoleBydocId(docId);
    }

}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_2-请求类型" tabindex="-1"> （2）请求类型</h4>
<div><pre><code>@PostMapping("advice")/@GetMapping("advice")
    public RoleInfo getAdviceList(String docId){
        return roleService.FindRoleBydocId(docId);
    }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><h3 id="_4、高级配置" tabindex="-1"> 4、高级配置</h3>
<h4 id="_1-apidoc" tabindex="-1"> （1）@ApiDoc</h4>
<h5 id="a-实现" tabindex="-1"> a.实现</h5>
<p>JApiDocs 默认只导出声明了@ApiDoc的接口，我们前面通过设置config.setAutoGenerate(Boolean.TRUE) 来解除了这个限制。如果你不希望把所有的接口都导出，你可以把autoGenerate设置关闭，在相关Controller类或者接口方法上通过添加@ApiDoc来确定哪些接口需要导出。</p>
<h5 id="b-其他设置" tabindex="-1"> b.其他设置</h5>
<p>result: 这个可以直接声明返回的对象类型，如果你声明了，将会覆盖SpringBoot的返回对象
stringResult：返回字符串，在返回结果比较简单，而不想创建一个专门的返回类，则可以考虑使用这个属性。
url: 请求URL，扩展字段，用于支持非SpringBoot项目
method: 请求方法，扩展字段，用于支持非SpringBoot项目</p>
<p>例：</p>
<div><pre><code>@ApiDoc(result = AdminVO.class, url = "/api/v1/admin/login2", method = "post")
stringResult 实例，在文档中将会自动格式化json字符串：
@ApiDoc(stringResult = "{code: 0, data: 'success'}")
@GetMapping(value = "custom-json")
public Map customJsonResult(){}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_2-ignore-忽略controller-接口-字段" tabindex="-1"> (2)@Ignore (忽略Controller，接口，字段)</h3>
<p>例：忽略Controller</p>
<div><pre><code>@Ignore
public class UserController { 

}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><h2 id="三、配置参数" tabindex="-1"> 三、配置参数</h2>
<p>在任意一个main入口执行下面的代码：</p>
<div><pre><code>DocsConfig config = new DocsConfig();
config.setProjectPath("your springboot project path"); // 项目根目录
config.setProjectName("ProjectName"); // 项目名称
config.setApiVersion("V1.0");       // 声明该API的版本
config.setDocsPath("your api docs path"); // 生成API 文档所在目录
config.setAutoGenerate(Boolean.TRUE);  // 配置自动生成
Docs.buildHtmlDocs(config); // 执行生成文档
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="四、导出格式" tabindex="-1"> 四、导出格式</h2>
<h3 id="_1-markdown" tabindex="-1"> （1）Markdown</h3>
<div><pre><code>  config.addPlugin(new MarkdownDocPlugin());
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="_2-导出-pdf-或者-word" tabindex="-1"> （2）导出 pdf 或者 word</h3>
<p>可以通过 <a href="https://pandoc.org/" target="_blank" rel="noopener noreferrer">pandoc</a> 把 markdown 格式转成 pdf 或者 word 格式。</p>
<h2 id="五、自定义代码模板" tabindex="-1"> 五、自定义代码模板</h2>
<p>JApiDocs 除了支持文档导出，目前也支持生成了 Android 和 iOS 的返回对象代码，对应 Java 和 Object-C 语言， 如果你想修改代码模板，可以通过以下的方法：</p>
<h3 id="_1-定义代码模板" tabindex="-1"> （1）定义代码模板</h3>
<p>把源码中library项目resources目录下的代码模板拷贝一份，其中，IOS_表示 Object-C 代码模板，JAVA_开头表示 Java代码， 模板中类似${CLASS_NAME}的符号是替换变量，具体含义你可以结合生成的代码进行理解，然后按照你想要的代码模板进行修改即可。</p>
<h3 id="_2-选择新的模板" tabindex="-1"> （2）选择新的模板</h3>
<p>通过DocsConfig配置模板路径替换成新的模板：</p>
<div><pre><code>docsConfig.setResourcePath("模板路径");
</code></pre><div aria-hidden="true"><div></div></div></div><h2 id="六、添加更多功能" tabindex="-1"> 六、添加更多功能</h2>
<p>JApiDocs 提供了插件接口，你可以通过插件接口来实现更多丰富的功能，下面介绍如何添加插件：</p>
<h3 id="_1-实现-ipluginsupport-接口" tabindex="-1"> （1）实现 IPluginSupport 接口</h3>
<div><pre><code>public class CustomPlugin implements IPluginSupport{
      @Override
      public void execute(List&lt;ControllerNode> controllerNodeList){
         // 实现你自己的功能需求
      }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_2-添加插件" tabindex="-1"> （2）添加插件</h3>
<div><pre><code> config.addPlugin(new CustomPlugin());
</code></pre><div aria-hidden="true"><div></div></div></div><h2 id="七、问题的解决" tabindex="-1"> 七、问题的解决</h2>
<h3 id="_1、如何排查错误" tabindex="-1"> 1、如何排查错误？</h3>
<p>关闭自动生成config.setAutoGenerate(Boolean.FALSE)，使用@ApiDoc 来一个个接口导出排查问题。</p>
<h3 id="_2、多模块找不到相关类源码" tabindex="-1"> 2、多模块找不到相关类源码？</h3>
<p>如果源码路径没有全部识别出来，可以通过config.addJavaSrcPath来添加模块的源码路径，注意要添加到src/main/java这一级。</p>
<h2 id="八、自定义注释模板" tabindex="-1"> 八、自定义注释模板</h2>
<p>这是我针对JApiDocs，对我的模板进行了一定的调整，以方便对JApiDocs的使用，大家可以参考一下。</p>
<h3 id="_1-live-templates" tabindex="-1"> （1）Live Templates</h3>
<div><pre><code>  /**
 * TODO
 * @create_by: 作者名字
 * @create_time: $date$ $time$
 * $params$
 * @return $return$
 */
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_2-file-header" tabindex="-1"> （2）File Header</h3>
<div><pre><code>/**
 * @Author 作者名字
 * @Date ${DATE} ${TIME}
 * @description  ${description}
 * @Version 1.0
 */
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>具体如何实现自定义方法注释，类注释。可以参考下面的文章：</p>
<blockquote>
<p><a href="https://blog.csdn.net/qq_38675373/article/details/105886922" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_38675373/article/details/105886922</a></p>
</blockquote>
<p>JApiDocs官方文档地址：</p>
<blockquote>
<p><a href="https://japidocs.agilestudio.cn/#/" target="_blank" rel="noopener noreferrer">https://japidocs.agilestudio.cn/#/</a></p>
</blockquote>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-02-12T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Java</title>
    <id>https://blog.ciberviler.top/dev/</id>
    <link href="https://blog.ciberviler.top/dev/"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">Java</summary>
    <content type="html"><![CDATA[<p align="center"> 
  <img src="https://metrics.lecoq.io/xlc520?template=classic&isocalendar=1&languages=1&people=1&activity=1&achievements=1&lines=1&repositories=1&notable=1&introduction=1&pagespeed=1&repositories=100&repositories.batch=100&repositories.forks=false&repositories.affiliations=owner&isocalendar.duration=full-year&languages.limit=8&languages.threshold=0%&languages.colors=github&languages.sections=most-used&languages.indepth=false&languages.analysis.timeout=15&languages.categories=markup%2C programming&languages.recent.categories=markup%2C programming&languages.recent.load=300&languages.recent.days=14&people.limit=24&people.identicons=false&people.identicons.hide=false&people.size=28&people.types=followers%2C following&people.shuffle=false&activity.limit=5&activity.load=300&activity.days=14&activity.visibility=all&activity.timestamps=false&activity.filter=all&achievements.threshold=C&achievements.secrets=true&achievements.display=detailed&achievements.limit=0&notable.from=organization&notable.repositories=false&notable.indepth=false&notable.types=commit&repositories.featured= xlc520%2Fxlc520.github.io&introduction.title=true&pagespeed.url=xlc520.github.io&pagespeed.detailed=false&pagespeed.screenshot=false&config.timezone=Asia%2FShanghai" /> 
</p>
<p align="center"> 
  您是第  <img src="https://profile-counter.glitch.me/xlc520/count.svg" />  位访问者
</p>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-01-05T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Redis总结：缓存雪崩、缓存击穿、缓存穿透与缓存预热、缓存降级</title>
    <id>https://blog.ciberviler.top/dev/Redis%E6%80%BB%E7%BB%93%EF%BC%9A%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E3%80%81%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F.html</id>
    <link href="https://blog.ciberviler.top/dev/Redis%E6%80%BB%E7%BB%93%EF%BC%9A%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E3%80%81%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">Redis总结：缓存雪崩、缓存击穿、缓存穿透与缓存预热、缓存降级</summary>
    <content type="html"><![CDATA[<h1 id="redis总结-缓存雪崩、缓存击穿、缓存穿透与缓存预热、缓存降级" tabindex="-1"> Redis总结：缓存雪崩、缓存击穿、缓存穿透与缓存预热、缓存降级</h1>
<h2 id="_01-缓存雪崩" tabindex="-1"> 01 缓存雪崩</h2>
<h3 id="_1-1-什么是缓存雪崩" tabindex="-1"> 1.1 什么是缓存雪崩？</h3>
<p>如果缓在某一个时刻出现大规模的key失效，那么就会导致大量的请求打在了数据库上面，导致数据库压力巨大，如果在高并发的情况下，可能瞬间就会导致数据库宕机。这时候如果运维马上又重启数据库，马上又会有新的流量把数据库打死。这就是缓存雪崩。</p>
<h3 id="_1-2-缓存雪崩问题分析" tabindex="-1"> 1.2 缓存雪崩问题分析</h3>
<p>造成缓存雪崩的关键在于同一时间的大规模的key失效，为什么会出现这个问题，主要有两种可能：第一种是Redis宕机，第二种可能就是采用了相同的过期时间。搞清楚原因之后，那么有什么解决方案呢？</p>
<h3 id="_1-3-缓存雪崩解决方案" tabindex="-1"> 1.3 缓存雪崩解决方案</h3>
<p><strong>（1）事前</strong></p>
<p>① 均匀过期：设置不同的过期时间，让缓存失效的时间尽量均匀，避免相同的过期时间导致缓存雪崩，造成大量数据库的访问。</p>
<p>② 分级缓存：第一级缓存失效的基础上，访问二级缓存，每一级缓存的失效时间都不同。</p>
<p>③ 热点数据缓存永远不过期。</p>
<blockquote>
<p>永不过期实际包含两层意思：</p>
<p>物理不过期，针对热点key不设置过期时间</p>
<p>逻辑过期，把过期时间存在key对应的value里，如果发现要过期了，通过一个后台的异步线程进行缓存的构建</p>
</blockquote>
<p>④ 保证Redis缓存的高可用，防止Redis宕机导致缓存雪崩的问题。可以使用 主从+ 哨兵，Redis集群来避免 Redis 全盘崩溃的情况。</p>
<p><strong>（2）事中</strong></p>
<p>① 互斥锁：在缓存失效后，通过互斥锁或者队列来控制读数据写缓存的线程数量，比如某个key只允许一个线程查询数据和写缓存，其他线程等待。这种方式会阻塞其他的线程，此时系统的吞吐量会下降</p>
<p>② 使用熔断机制，限流降级。当流量达到一定的阈值，直接返回“系统拥挤”之类的提示，防止过多的请求打在数据库上将数据库击垮，至少能保证一部分用户是可以正常使用，其他用户多刷新几次也能得到结果。</p>
<p><strong>（3）事后</strong></p>
<p>① 开启Redis持久化机制，尽快恢复缓存数据，一旦重启，就能从磁盘上自动加载数据恢复内存中的数据。</p>
<h2 id="_02-缓存击穿" tabindex="-1"> 02 缓存击穿</h2>
<h3 id="_2-1-什么是缓存击穿" tabindex="-1"> 2.1 什么是缓存击穿？</h3>
<p>缓存击穿跟缓存雪崩有点类似，缓存雪崩是大规模的key失效，而缓存击穿是某个热点的key失效，大并发集中对其进行请求，就会造成大量请求读缓存没读到数据，从而导致高并发访问数据库，引起数据库压力剧增。这种现象就叫做缓存击穿。</p>
<h3 id="_2-2-缓存击穿问题分析" tabindex="-1"> 2.2 缓存击穿问题分析</h3>
<p>关键在于某个热点的key失效了，导致大并发集中打在数据库上。所以要从两个方面解决，第一是否可以考虑热点key不设置过期时间，第二是否可以考虑降低打在数据库上的请求数量。</p>
<h3 id="_2-3-缓存击穿解决方案" tabindex="-1"> 2.3 缓存击穿解决方案</h3>
<p>（1）在缓存失效后，通过互斥锁或者队列来控制读数据写缓存的线程数量，比如某个key只允许一个线程查询数据和写缓存，其他线程等待。这种方式会阻塞其他的线程，此时系统的吞吐量会下降</p>
<p>（2）热点数据缓存永远不过期。</p>
<p>永不过期实际包含两层意思：</p>
<ul>
<li>物理不过期，针对热点key不设置过期时间</li>
<li>逻辑过期，把过期时间存在key对应的value里，如果发现要过期了，通过一个后台的异步线程进行缓存的构建</li>
</ul>
<h2 id="_03-缓存穿透" tabindex="-1"> 03 缓存穿透</h2>
<h3 id="_3-1-什么是缓存穿透" tabindex="-1"> 3.1 什么是缓存穿透？</h3>
<p>缓存穿透是指用户请求的数据在缓存中不存在即没有命中，同时在数据库中也不存在，导致用户每次请求该数据都要去数据库中查询一遍。如果有恶意攻击者不断请求系统中不存在的数据，会导致短时间大量请求落在数据库上，造成数据库压力过大，甚至导致数据库承受不住而宕机崩溃。</p>
<h3 id="_3-2-问题分析" tabindex="-1"> 3.2 问题分析</h3>
<p>缓存穿透的关键在于在Redis中查不到key值，它和缓存击穿的根本区别在于传进来的key在Redis中是不存在的。假如有黑客传进大量的不存在的key，那么大量的请求打在数据库上是很致命的问题，所以在日常开发中要对参数做好校验，一些非法的参数，不可能存在的key就直接返回错误提示。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/AFfPBZXiba0uKqFLRUWolShSoZm90t6hpGhIAZ3Oyr03gBqibZSxpAxO5dqjxEqSiatuSl3OnIP3xpksH36xVl9WA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<h3 id="_3-3-解决方法" tabindex="-1"> 3.3 解决方法</h3>
<p><strong>（1）将无效的key存放进Redis中：</strong></p>
<p>当出现Redis查不到数据，数据库也查不到数据的情况，我们就把这个key保存到Redis中，设置value=&quot;null&quot;，并设置其过期时间极短，后面再出现查询这个key的请求的时候，直接返回null，就不需要再查询数据库了。但这种处理方式是有问题的，假如传进来的这个不存在的Key值每次都是随机的，那存进Redis也没有意义。</p>
<p><strong>（2）使用布隆过滤器：</strong></p>
<p>如果布隆过滤器判定某个 key 不存在布隆过滤器中，那么就一定不存在，如果判定某个 key 存在，那么很大可能是存在(存在一定的误判率)。于是我们可以在缓存之前再加一个布隆过滤器，将数据库中的所有key都存储在布隆过滤器中，在查询Redis前先去布隆过滤器查询 key 是否存在，如果不存在就直接返回，不让其访问数据库，从而避免了对底层存储系统的查询压力。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/AFfPBZXiba0uKqFLRUWolShSoZm90t6hp9j7iaVR2e454IH23wwWK51ejJic0DCxPvkkvpQVtu1vNE756WITnoPkA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<blockquote>
<p>如何选择：针对一些恶意攻击，攻击带过来的大量key是随机，那么我们采用第一种方案就会缓存大量不存在key的数据。那么这种方案就不合适了，我们可以先对使用布隆过滤器方案进行过滤掉这些key。所以，针对这种key异常多、请求重复率比较低的数据，优先使用第二种方案直接过滤掉。而对于空数据的key有限的，重复率比较高的，则可优先采用第一种方式进行缓存。</p>
</blockquote>
<h2 id="_04-缓存预热" tabindex="-1"> 04 缓存预热</h2>
<h3 id="_4-1-什么是缓存预热" tabindex="-1"> 4.1 什么是缓存预热？</h3>
<p>缓存预热是指系统上线后，提前将相关的缓存数据加载到缓存系统。避免在用户请求的时候，先查询数据库，然后再将数据缓存的问题，用户直接查询事先被预热的缓存数据。</p>
<p>如果不进行预热，那么Redis初始状态数据为空，系统上线初期，对于高并发的流量，都会访问到数据库中， 对数据库造成流量的压力。</p>
<h3 id="_4-2-缓存预热解决方案" tabindex="-1"> 4.2 缓存预热解决方案</h3>
<p>（1）数据量不大的时候，工程启动的时候进行加载缓存动作；</p>
<p>（2）数据量大的时候，设置一个定时任务脚本，进行缓存的刷新；</p>
<p>（3）数据量太大的时候，优先保证热点数据进行提前加载到缓存。</p>
<h2 id="_05-缓存降级" tabindex="-1"> 05 缓存降级</h2>
<p>缓存降级是指缓存失效或缓存服务器挂掉的情况下，不去访问数据库，直接返回默认数据或访问服务的内存数据。降级一般是有损的操作，所以尽量减少降级对于业务的影响程度。</p>
<p>在项目实战中通常会将部分热点数据缓存到服务的内存中，这样一旦缓存出现异常，可以直接使用服务的内存数据，从而避免数据库遭受巨大压力。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-25T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Spring 面试63问</title>
    <id>https://blog.ciberviler.top/dev/Spring%20%E9%9D%A2%E8%AF%9563%E9%97%AE.html</id>
    <link href="https://blog.ciberviler.top/dev/Spring%20%E9%9D%A2%E8%AF%9563%E9%97%AE.html"/>
    <updated>2022-05-29T06:21:00.000Z</updated>
    <summary type="html">Spring 面试63问</summary>
    <content type="html"><![CDATA[<h1 id="spring-面试63问" tabindex="-1"> Spring 面试63问</h1>
<ul>
<li>
<p>Sping原理</p>
<p>Spring是一个轻量级Java开发框架，最早有Rod Johnson创建，目的是为了解决企业级应用开发的业务逻辑层和其他各层的耦合问题。它是一个分层的JavaSE/JavaEE full-stack（一站式）轻量级开源框架，为开发Java应用程序提供全面的基础架构支持。Spring负责基础架构，因此Java开发者可以专注于应用程序的开发。</p>
<p>Spring是一个全面的、企业应用开发一站式的解决方案，贯穿表现层、业务层、持久层。但是它仍然可以和其他的框架无缝整合。</p>
<h3 id="spring-特点" tabindex="-1"> Spring 特点</h3>
<p><strong>轻量级：</strong> 组件大小与开销两方面而言Spring都是轻量的。完整的Spring框架可以在一个大小只有1M多的JAR文件中发布，并且Spring所需的处理开销也是微不足道的。此外，Spring是非侵入式，典型案例，Spring应用中的对象不依赖于Spring特定的类</p>
<p><strong>控制反转：</strong> Spring通过控制反转（IOC）技术实现解耦。一个对象依赖的其他对象会通过被动的方式传递进来，而不需要对象自己创建或者查找依赖。</p>
<p><strong>面向切面：</strong> 支持切面（AOP）编程，并且吧应用业务逻辑和系统服务区分开。</p>
<p><strong>容器：</strong> Spring包含并管理应用对象的配置和生命周期，在这个意义上它是一种容器。可以配置每个bean如何被创建、销毁，bean的作用范围是单例还是每次都生成一个新的实例，以及他们是如何相互关联。</p>
<p><strong>框架集合：</strong> 将简单的组件配置，组合成为复杂的框架；应用对象被申明式组合；提供许多基础功能（事务管理、持久化框架继承），提供应用逻辑开发接口</p>
<h3 id="spring-框架优缺点" tabindex="-1"> Spring 框架优缺点</h3>
<h4 id="优点" tabindex="-1"> 优点</h4>
<ul>
<li>方便解耦，简化开发：Spring就是一个大工厂，可以将所有对象的创建和依赖关系的维护，交给Spring管理。</li>
<li>AOP编程的支持：Spring提供面向切面编程，可以方便的实现对程序进行权限拦截、运行监控等功能。</li>
<li>声明式事务的支持：只需要通过配置就可以完成对事务的管理，而无需手动编程。</li>
<li>方便程序的测试：Spring对Junit4支持，可以通过注解方便的测试Spring程序。</li>
<li>方便集成各种优秀框架：Spring不排斥各种优秀的开源框架，其内部提供了对各种优秀框架的直接支持（如：Struts、Hibernate、MyBatis等）。</li>
<li>降低JavaEE API的使用难度：Spring对JavaEE开发中非常难用的一些API（JDBC、JavaMail、远程调用等），都提供了封装，使这些API应用难度大大降低。</li>
</ul>
<h4 id="缺点" tabindex="-1"> 缺点</h4>
<ul>
<li>Spring依赖反射，反射影响性能</li>
<li>使用门槛升高，入门Spring需要较长时间</li>
</ul>
<h3 id="spring-框架中都用到了哪些设计模式" tabindex="-1"> Spring 框架中都用到了哪些设计模式</h3>
<p>Spring 框架中使用到了大量的设计模式，下面列举了比较有代表性的：</p>
<ul>
<li><code>代理模式</code>—在 AOP 和 remoting 中被用的比较多。</li>
<li><a href="https://blog.csdn.net/sufu1065/article/details/122872239" target="_blank" rel="noopener noreferrer"><code>单例模式</code></a>—在 spring 配置文件中定义的 bean 默认为单例模式。</li>
<li><code>模板方法</code>—用来解决代码重复的问题。比如. RestTemplate, JmsTemplate, JpaTempl ate。</li>
<li><code>前端控制器</code>—Spring 提供了 DispatcherServlet 来对请求进行分发。</li>
<li><code>视图帮助(View Helper )</code>—Spring 提供了一系列的 JSP 标签，高效宏来辅助将分散的代码整合在视图里。</li>
<li><code>依赖注入</code>—贯穿于 BeanFactory / ApplicationContext 接口的核心理念。</li>
<li><code>工厂模式</code>—BeanFactory 用来创建对象的实例</li>
</ul>
<h3 id="spring核心组件" tabindex="-1"> Spring核心组件</h3>
<p>Spring 总共大约有 20 个模块， 由 1300 多个不同的文件构成。而这些组件被分别整合在核心容器（Core Container） 、 AOP（Aspect Oriented Programming）和设备支持（Instrmentation） 、数据访问与集成（Data Access/Integeration） 、 Web、 消息（Messaging） 、 Test等 6 个模块中。以下是 Spring 5 的模块结构图：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/893a32f9ecd60a71e72fd247e0d7bc1c.png" alt="893a32f9ecd60a71e72fd247e0d7bc1c.png" loading="lazy"></p>
<ul>
<li><code>spring core</code>：提供了框架的基本组成部分，包括控制反转（Inversion of Control，IOC）和依赖注入（Dependency Injection，DI）功能。</li>
<li><code>spring beans</code>：提供了BeanFactory，是工厂模式的一个经典实现，Spring将管理对象称为Bean。</li>
<li><code>spring context</code>：构建于 core 封装包基础上的 context 封装包，提供了一种框架式的对象访问方法。</li>
<li><code>spring jdbc</code>：提供了一个JDBC的抽象层，消除了烦琐的JDBC编码和数据库厂商特有的错误代码解析， 用于简化JDBC。</li>
<li><code>spring aop</code>：提供了面向切面的编程实现，让你可以自定义拦截器、切点等。</li>
<li><code>spring Web</code>：提供了针对 Web 开发的集成特性，例如文件上传，利用 servlet listeners 进行 ioc 容器初始化和针对 Web 的 ApplicationContext。</li>
<li><code>spring test</code>：主要为测试提供支持的，支持使用JUnit或TestNG对Spring组件进行单元测试和集成测试。</li>
</ul>
<h3 id="spring-控制反转-ioc" tabindex="-1"> Spring 控制反转（IOC）</h3>
<h4 id="控制反转-ioc-概念" tabindex="-1"> 控制反转（IOC）概念</h4>
<p>控制反转即IOC (Inversion of Control)，它把传统上由程序代码直接操控的对象的调用权交给容器，通过容器来实现对象组件的装配和管理。</p>
<p>Spring 通过一个配置文件描述 Bean 及 Bean 之间的依赖关系，利用 Java 语言的反射功能(依赖注入DI)实例化 Bean 并建立 Bean 之间的依赖关系。Spring 的 IoC 容器在完成这些底层工作的基础上，还提供 了 Bean 实例缓存、生命周期管理、 Bean 实例代理、事件发布、资源装载等高级服务。</p>
<h4 id="spring-容器高层视图" tabindex="-1"> Spring 容器高层视图</h4>
<p>Spring 启动时读取应用程序提供的 Bean 配置信息，并在 Spring 容器中生成一份相应的 Bean 配</p>
<p>置注册表，然后根据这张注册表实例化 Bean，装配好 Bean 之间的依赖关系，为上层应用提供准</p>
<p>备就绪的运行环境。其中 Bean 缓存池为 HashMap 实现</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/355d105ac37a91dee72b8a4195844e0d.png" alt="355d105ac37a91dee72b8a4195844e0d.png" loading="lazy"></p>
<h3 id="ioc-容器实现" tabindex="-1"> IOC 容器实现</h3>
<h4 id="beanfactory-框架基础设施" tabindex="-1"> BeanFactory-框架基础设施</h4>
<p>BeanFactory 是 Spring 框架的基础设施，面向 Spring 本身；</p>
<p>ApplicationContext 面向使用Spring 框架的开发者，几乎所有的应用场合我们都直接使用 ApplicationContext 而非底层的 BeanFactory。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/ca21e934e8b5c9738300fa4c8003c789.png" alt="ca21e934e8b5c9738300fa4c8003c789.png" loading="lazy"></p>
<ul>
<li><strong>BeanDefinitionRegistry 注册表</strong>：Spring 配置文件中每一个节点元素在 Spring 容器里都通过一个 BeanDefinition 对象表示，它描述了 Bean 的配置信息。而 BeanDefinitionRegistry 接口提供了向容器手工注册BeanDefinition 对象的方法。</li>
<li><strong>BeanFactory 顶层接口</strong>：位于类结构树的顶端 ，它最主要的方法就是 getBean(String beanName)，该方法从容器中返回特定名称的 Bean，BeanFactory 的功能通过其他的接口得到不断扩展：</li>
<li><strong>ListableBeanFactory</strong>：该接口定义了访问容器中 Bean 基本信息的若干方法，如查看 Bean 的个数、获取某一类型Bean 的配置名、查看容器中是否包括某一 Bean 等方法；</li>
<li><strong>HierarchicalBeanFactory 父子级</strong>：父子级联 IoC 容器的接口，子容器可以通过接口方法访问父容器；通过HierarchicalBeanFactory 接口， Spring 的 IoC 容器可以建立父子层级关联的容器体系，子容器可以访问父容器中的 Bean，但父容器不能访问子容器的 Bean。Spring 使用父子容器实现了很多功能，比如在 Spring MVC 中，展现层 Bean 位于一个子容器中，而业务层和持久层的 Bean 位于父容器中。这样，展现层 Bean 就可以引用业务层和持久层的 Bean，而业务层和持久层的 Bean 则看不到展现层的 Bean。</li>
<li><strong>ConfigurableBeanFactory</strong>：是一个重要的接口，增强了 IoC 容器的可定制性，它定义了设置类装载器、属性编辑器、容器初始化后置处理器等方法；</li>
<li><strong>AutowireCapableBeanFactory 自动装配</strong>：定义了将容器中的 Bean 按某种规则（如按名字匹配、按类型匹配等）进行自动装配的方法；</li>
<li><strong>SingletonBeanRegistry 运行期间注册单例 Bean</strong>：定义了允许在运行期间向容器注册单实例 Bean 的方法；对于单实例（ singleton）的 Bean 来说，BeanFactory 会缓存 Bean 实例，所以第二次使用 getBean() 获取 Bean 时将直接从IoC 容器的缓存中获取 Bean 实例。Spring 在 DefaultSingletonBeanRegistry 类中提供了一个用于缓存单实例 Bean 的缓存器，它是一个用 HashMap 实现的缓存器，单实例的 Bean 以beanName 为键保存在这个 HashMap 中。</li>
<li><strong>依赖日志框架</strong>：在初始化 BeanFactory 时，必须为其提供一种日志框架，比如使用 Log4J， 即在类路径下提供 Log4J 配置文件，这样启动 Spring 容器才不会报错。</li>
</ul>
<h3 id="applicationcontext-面向开发应用" tabindex="-1"> ApplicationContext 面向开发应用</h3>
<p>ApplicationContext 由 BeanFactory 派生而来，提供了更多面向实际应用的功能。</p>
<p>ApplicationContext 继承了 HierarchicalBeanFactory 和 ListableBeanFactory 接口，在此基础</p>
<p>上，还通过多个其他的接口扩展了 BeanFactory 的功能：</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/9c9a78edbc6b9d2f3f849cbcfd3917ae.png" alt="9c9a78edbc6b9d2f3f849cbcfd3917ae.png" loading="lazy"></p>
<ul>
<li>ClassPathXmlApplicationContext：默认从类路径加载配置文件</li>
<li>FileSystemXmlApplicationContext：默认从文件系统中装载配置文件</li>
<li>ApplicationEventPublisher：让容器拥有发布应用上下文事件的功能，包括容器启动事件、关闭事件等。</li>
<li>MessageSource：为应用提供 i18n 国际化消息访问的功能；</li>
<li>ResourcePatternResolver ：所有 ApplicationContext 实现类都实现了类似于</li>
<li>PathMatchingResourcePatternResolver：通过带前缀的 Ant 风格的资源文件路径装载 Spring 的配置文件。</li>
<li>LifeCycle：该接口是 Spring 2.0 加入的，该接口提供了 start()和 stop()两个方法，主要用于控制异步处理过程。在具体使用时，该接口同时被 ApplicationContext 实现及具体Bean 实现， ApplicationContext 会将 start/stop 的信息传递给容器中所有实现了该接口的 Bean，以达到管理和控制 JMX、任务调度等目的。</li>
<li>ConfigurableApplicationContext ：扩展于 ApplicationContext，它新增加了两个主要的方法：refresh()和 close()，让 ApplicationContext 具有启动、刷新和关闭应用上下文的能力。在应用上下文关闭的情况下调用 refresh()即可启动应用上下文，在已经启动的状态下，调用 refresh()则清除缓存并重新装载配置信息，而调用 close()则可关闭应用上下文。</li>
</ul>
<h3 id="beanfactory-和-applicationcontext有什么区别" tabindex="-1"> BeanFactory 和 ApplicationContext有什么区别？</h3>
<p>BeanFactory和ApplicationContext是Spring的两大核心接口，都可以当做Spring的容器。其中ApplicationContext是BeanFactory的子接口。</p>
<h4 id="依赖关系" tabindex="-1"> 依赖关系</h4>
<p>BeanFactory：是Spring里面最底层的接口，包含了各种Bean的定义，读取bean配置文档，管理bean的加载、实例化，控制bean的生命周期，维护bean之间的依赖关系。</p>
<p>ApplicationContext：接口作为BeanFactory的派生，除了提供BeanFactory所具有的功能外，还提供了更完整的框架功能：</p>
<ul>
<li>继承MessageSource，因此支持国际化。</li>
<li>统一的资源文件访问方式。</li>
<li>提供在监听器中注册bean的事件。</li>
<li>同时加载多个配置文件。</li>
<li>载入多个（有继承关系）上下文 ，使得每一个上下文都专注于一个特定的层次，比如应用的web层。</li>
</ul>
<h4 id="加载方式" tabindex="-1"> 加载方式</h4>
<p>BeanFactroy：采用的是延迟加载形式来注入Bean的，即只有在使用到某个Bean时(调getBean())，才对该Bean进行加载实例化。这样，我们就不能发现一些存在的Spring的配置问题。如果Bean的某一个属性没有注入，BeanFacotry加载后，直至第一次使用调用getBean方法才会抛出异常。</p>
<p>ApplicationContext：它是在容器启动时，一次性创建了所有的Bean。这样，在容器启动时，我们就可以发现Spring中存在的配置错误，这样有利于检查所依赖属性是否注入。ApplicationContext启动后预载入所有的单实例Bean，通过预载入单实例bean ,确保当你需要的时候，你就不用等待，因为它们已经创建好了。</p>
<p>相对于基本的BeanFactory，ApplicationContext 唯一的不足是占用内存空间。当应用程序配置Bean较多时，程序启动较慢。</p>
<h4 id="创建方式" tabindex="-1"> 创建方式</h4>
<p>BeanFactory通常以编程的方式被创建，ApplicationContext还能以声明的方式创建，如使用ContextLoader。</p>
<h4 id="注册方式" tabindex="-1"> 注册方式</h4>
<p>BeanFactory和ApplicationContext都支持BeanPostProcessor、BeanFactoryPostProcessor的使用，但两者之间的区别是：BeanFactory需要手动注册，而ApplicationContext则是自动注册。</p>
<h4 id="applicationcontext通常的实现" tabindex="-1"> ApplicationContext通常的实现</h4>
<ul>
<li>FileSystemXmlApplicationContext ：此容器从一个XML文件中加载beans的定义，XML Bean 配置文件的全路径名必须提供给它的构造函数。</li>
<li>ClassPathXmlApplicationContext：此容器也从一个XML文件中加载beans的定义，这里，你需要正确设置classpath因为这个容器将在classpath里找bean配置。</li>
<li>WebXmlApplicationContext：此容器加载一个XML文件，此文件定义了一个WEB应用的所有bean。</li>
</ul>
<h3 id="spring的依赖注入" tabindex="-1"> Spring的依赖注入</h3>
<p>其主要实现方式有两种：依赖注入和依赖查找。</p>
<p><strong>依赖注入：</strong> 相对于IoC而言，依赖注入(DI)更加准确地描述了IoC的设计理念。所谓依赖注入（Dependency Injection），即组件之间的依赖关系由容器在应用系统运行期来决定，也就是由容器动态地将某种依赖关系的目标对象实例注入到应用系统中的各个关联的组件之中。组件不做定位查询，只提供普通的Java方法让容器去决定依赖关系。</p>
<h4 id="依赖注入的基本原则" tabindex="-1"> 依赖注入的基本原则</h4>
<p>应用组件不应该负责查找资源或者其他依赖的协作对象。配置对象的工作应该由IoC容器负责，“查找资源”的逻辑应该从应用组件的代码中抽取出来，交给IoC容器负责。容器全权负责组件的装配，它会把符合依赖关系的对象通过属性（JavaBean中的setter）或者是构造器传递给需要的对象。</p>
<p><strong>依赖注入优势</strong></p>
<p>依赖注入之所以更流行是因为它是一种更可取的方式：让容器全权负责依赖查询，受管组件只需要暴露JavaBean的setter方法或者带参数的构造器或者接口，使容器可以在初始化时组装对象的依赖关系。其与依赖查找方式相比，主要优势为：</p>
<ul>
<li>查找定位操作与应用代码完全无关</li>
<li>不依赖于容器的API，可以很容易地在任何容器以外使用应用对象</li>
<li>不需要特殊的接口，绝大多数对象可以做到完全不必依赖容器</li>
</ul>
<p><strong>依赖注入实现方式</strong></p>
<p>依赖注入是时下最流行的IoC实现方式，依赖注入分为接口注入（Interface Injection），Setter方法注入（Setter Injection）和构造器注入（Constructor Injection）三种方式。其中接口注入由于在灵活性和易用性比较差，现在从Spring4开始已被废弃。</p>
<ul>
<li>构造器依赖注入：构造器依赖注入通过容器触发一个类的构造器来实现的，该类有一系列参数，每个参数代表一个对其他类的依赖</li>
<li>Setter方法注入：Setter方法注入是容器通过调用无参构造器或无参static工厂 方法实例化bean之后，调用该bean的setter方法，即实现了基于setter的依赖注入</li>
</ul>
<h3 id="构造器依赖注入和-setter方法注入的区别" tabindex="-1"> 构造器依赖注入和 Setter方法注入的区别</h3>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/59c181416a4997b4f05d2446e3ff6f08.png" alt="59c181416a4997b4f05d2446e3ff6f08.png" loading="lazy"></p>
<p>两种依赖方式都可以使用，构造器注入和Setter方法注入。最好的解决方案是用构造器参数实现强制依赖，setter方法实现可选依赖。</p>
<h3 id="webapplication-体系架构" tabindex="-1"> WebApplication 体系架构</h3>
<p>WebApplicationContext 是专门为 Web 应用准备的，它允许从相对于 Web 根目录的路径中装载配置文件完成初始化工作。从 WebApplicationContext 中可以获得ServletContext 的引用，整个 Web 应用上下文对象将作为属性放置到 ServletContext 中，以便 Web 应用环境可以访问 Spring 应用上下文。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/0d58667ed73f47e65be170d3a114d94c.png" alt="0d58667ed73f47e65be170d3a114d94c.png" loading="lazy"></p>
<h3 id="spring-bean-定义" tabindex="-1"> Spring Bean 定义</h3>
<p>一个Spring Bean 的定义包含容器必知的所有配置元数据，包括如何创建一个bean，它的生命周期详情及它的依赖。</p>
<ul>
<li>Spring元数据配置方式</li>
<li>XML配置文件</li>
<li>基于注解的配置</li>
<li>基于java的配置</li>
</ul>
<h3 id="spring-bean-作用域" tabindex="-1"> Spring Bean 作用域</h3>
<p>Spring 3 中为 Bean 定义了 5 中作用域，分别为 singleton（单例）、prototype（原型）、request、session 和 global session，5 种作用域说明如下：</p>
<ul>
<li><strong>singleton</strong>：单例模式（多线程下不安全）。Spring IoC 容器中只会存在一个共享的 Bean 实例，无论有多少个Bean 引用它，始终指向同一对象。该模式在多线程下是不安全的。Singleton 作用域是Spring 中的缺省作用域，也可以显示的将 Bean 定义为 singleton 模式，配置为：</li>
<li><strong>prototype</strong>:原型模式每次使用时创建。每次通过 Spring 容器获取 prototype 定义的 bean 时，容器都将创建一个新的 Bean 实例，每个 Bean 实例都有自己的属性和状态，而 singleton 全局只有一个对象。根据经验，对有状态的bean使用prototype作用域，而对无状态的bean使用singleton 作用域。</li>
<li><strong>Request</strong>：一次 request 一个实例。在一次 Http 请求中，容器会返回该 Bean 的同一实例。而对不同的 Http 请求则会产生新的 Bean，而且该 bean 仅在当前 Http Request 内有效,当前 Http 请求结束，该 bean实例也将会被销毁。</li>
<li><strong>session</strong>：在一次 Http Session 中，容器会返回该 Bean 的同一实例。而对不同的 Session 请求则会创建新的实例，该 bean 实例仅在当前 Session 内有效。同 Http 请求相同，每一次session 请求创建新的实例，而不同的实例之间不共享属性，且实例仅在自己的 session 请求内有效，请求结束，则实例将被销毁。</li>
<li><strong>global Session</strong>：在一个全局的 Http Session 中，容器会返回该 Bean 的同一个实例，仅在使用 portlet context 时有效。</li>
</ul>
<h3 id="spring处理线程并发问题" tabindex="-1"> Spring处理线程并发问题</h3>
<p>在一般情况下，只有无状态的Bean才可以在多线程环境下共享，在Spring中，绝大部分Bean都可以声明为singleton作用域，因为Spring对一些Bean中非线程安全状态采用ThreadLocal进行处理，解决线程安全问题。</p>
<p>ThreadLocal和线程同步机制都是为了解决多线程中相同变量的访问冲突问题。同步机制采用了“时间换空间”的方式，仅提供一份变量，不同的线程在访问前需要获取锁，没获得锁的线程则需要排队。而ThreadLocal采用了“空间换时间”的方式。</p>
<p>ThreadLocal会为每一个线程提供一个独立的变量副本，从而隔离了多个线程对数据的访问冲突。因为每一个线程都拥有自己的变量副本，从而也就没有必要对该变量进行同步了。ThreadLocal提供了线程安全的共享对象，在编写多线程代码时，可以把不安全的变量封装进ThreadLocal。</p>
<h3 id="spring-bean-生命周期" tabindex="-1"> Spring Bean 生命周期</h3>
<p><img src="https://img-blog.csdnimg.cn/img_convert/63a7c3663fa56e9acf085898f0266cd1.png" alt="63a7c3663fa56e9acf085898f0266cd1.png" loading="lazy"></p>
<p><strong>实例化</strong></p>
<ol>
<li>实例化一个 Bean，也就是我们常说的 new。</li>
</ol>
<p><strong>IOC 依赖注入</strong></p>
<ol>
<li>按照 Spring 上下文对实例化的 Bean 进行配置，也就是 IOC 注入。</li>
</ol>
<p><strong>setBeanName 实现</strong></p>
<ol>
<li>如果这个 Bean 已经实现了 BeanNameAware 接口，会调用它实现的 <code>setBeanName(String)</code>方法，此处传递的就是 Spring 配置文件中 Bean 的 id 值</li>
</ol>
<p><strong>BeanFactoryAware 实现</strong></p>
<ol>
<li>如果这个 Bean 已经实现了 BeanFactoryAware 接口，会调用它实现的 setBeanFactory，</li>
</ol>
<p><code>setBeanFactory(BeanFactory)</code>传递的是 Spring 工厂自身（可以用这个方式来获取其它 Bean，只需在 Spring 配置文件中配置一个普通的 Bean 就可以）。</p>
<p><strong>ApplicationContextAware 实现</strong></p>
<ol>
<li>如果这个 Bean 已经实现了 ApplicationContextAware 接口，会调用<code>setApplicationContext(ApplicationContext)</code>方法，传入 Spring 上下文（同样这个方式也可以实现步骤 4 的内容，但比 4 更好，因为 ApplicationContext 是 BeanFactory 的子接口，有更多的实现方法）</li>
</ol>
<p><strong>postProcessBeforeInitialization 接口实现-初始化预处理</strong></p>
<ol>
<li>如果这个 Bean 关联了 BeanPostProcessor 接口，将会调用<code>postProcessBeforeInitialization(Object obj, String s)</code>方法，BeanPostProcessor 经常被用作是 Bean 内容的更改，并且由于这个是在 Bean 初始化结束时调用那个的方法，也可以被应用于内存或缓存技术。</li>
</ol>
<p><strong>init-method</strong></p>
<ol>
<li>如果 Bean 在 Spring 配置文件中配置了 init-method 属性会自动调用其配置的初始化方法。</li>
</ol>
<p><strong>postProcessAfterInitialization</strong></p>
<ol>
<li>如果这个 Bean 关联了 BeanPostProcessor 接口，将会调用<code>postProcessAfterInitialization(Object obj, String s)</code>方法。</li>
</ol>
<blockquote>
<p>注：以上工作完成以后就可以应用这个 Bean 了，那这个 Bean 是一个 Singleton 的，所以一般情况下我们调用同一个 id 的 Bean 会是在内容地址相同的实例，当然在 Spring 配置文件中也可以配置非 Singleton。</p>
</blockquote>
<p><strong>Destroy 过期自动清理阶段</strong></p>
<ol>
<li>当 Bean 不再需要时，会经过清理阶段，如果 Bean 实现了 DisposableBean 这个接口，会调用那个其实现的 destroy()方法；</li>
</ol>
<p><strong>destroy-method 自配置清理</strong></p>
<ol>
<li>最后，如果这个 Bean 的 Spring 配置中配置了 <code>destroy-method</code> 属性，会自动调用其配置的销毁方法。</li>
</ol>
<h3 id="bean生命周期方法" tabindex="-1"> bean生命周期方法</h3>
<p>bean 标签有两个重要的属性（<code>init-method</code> 和 <code>destroy-method</code>）。用它们你可以自己定制</p>
<p>初始化和注销方法。它们也有相应的注解（<code>@PostConstruct</code> 和<code>@PreDestroy</code>）。</p>
<div><pre><code><span>&lt;</span>bean id<span>=</span><span>""</span> class<span>=</span><span>""</span> init<span>-</span>method<span>=</span><span>"初始化方法"</span> destroy<span>-</span>method<span>=</span><span>"销毁方法"</span><span>></span>
</code></pre><div aria-hidden="true"><div></div></div></div><h3 id="什么是spring的内部bean-什么是spring-inner-beans" tabindex="-1"> 什么是Spring的内部bean？什么是Spring inner beans？</h3>
<p>在Spring框架中，当一个bean仅被用作另一个bean的属性时，它能被声明为一个内部bean。</p>
<p>内部bean可以用setter注入“属性”和构造方法注入“构造参数”的方式来实现，内部bean通常是匿名的，它们的Scope一般是prototype。</p>
<p>Spring 依赖注入四种方式构造器注入</p>
<div><pre><code><span>/*带参数，方便利用构造器进行注入*/</span>



 



 public <span>CatDaoImpl</span><span>(</span>String message<span>)</span><span>{</span>



 



 this<span>.</span> message <span>=</span> message<span>;</span>



 



 <span>}</span>
<span>&lt;</span>bean id<span>=</span><span>"CatDaoImpl"</span> class<span>=</span><span>"com.CatDaoImpl"</span><span>></span>



 



<span>&lt;</span>constructor<span>-</span>arg value<span>=</span><span>" message "</span><span>></span><span>&lt;</span><span>/</span>constructor<span>-</span>arg<span>></span>



 



<span>&lt;</span><span>/</span>bean<span>></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>setter 方法注入</p>
<div><pre><code>public class Id <span>{</span>



 



 private <span>int</span> id<span>;</span>



 



 public <span>int</span> <span>getId</span><span>(</span><span>)</span> <span>{</span> <span>return</span> id<span>;</span> <span>}</span>



 



 public void <span>setId</span><span>(</span><span>int</span> id<span>)</span> <span>{</span> this<span>.</span>id <span>=</span> id<span>;</span> <span>}</span>



 



<span>}</span>
<span>&lt;</span>bean id<span>=</span><span>"id"</span> class<span>=</span><span>"com.id "</span><span>></span> <span>&lt;</span>property name<span>=</span><span>"id"</span> value<span>=</span><span>"123"</span><span>></span><span>&lt;</span><span>/</span>property<span>></span> <span>&lt;</span><span>/</span>bean<span>></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>静态工厂注入</p>
<p>静态工厂顾名思义，就是通过调用静态工厂的方法来获取自己需要的对象，为了让 spring 管理所有对象，我们不能直接通过&quot;工程类.静态方法()&quot;来获取对象，而是依然通过 spring 注入的形式获取：</p>
<div><pre><code>public class DaoFactory <span>{</span> <span>//静态工厂</span>



 



 public static final FactoryDao <span>getStaticFactoryDaoImpl</span><span>(</span><span>)</span><span>{</span>



 



 <span>return</span> <span>new</span> <span>StaticFacotryDaoImpl</span><span>(</span><span>)</span><span>;</span>



 



 <span>}</span>



 



<span>}</span>



 



public class SpringAction <span>{</span>



 



 private FactoryDao staticFactoryDao<span>;</span> <span>//注入对象</span>



 



 <span>//注入对象的 set 方法</span>



 



 public void <span>setStaticFactoryDao</span><span>(</span>FactoryDao staticFactoryDao<span>)</span> <span>{</span>



 



 this<span>.</span>staticFactoryDao <span>=</span> staticFactoryDao<span>;</span>



 



 <span>}</span>



 



<span>}</span>
<span>&lt;</span><span>!</span><span>--</span>factory<span>-</span>method<span>=</span><span>"getStaticFactoryDaoImpl"</span>指定调用哪个工厂方法<span>--</span><span>></span>



 



 <span>&lt;</span>bean name<span>=</span><span>"springAction"</span> class<span>=</span><span>" SpringAction"</span> <span>></span>



 



 <span>&lt;</span><span>!</span><span>--</span>使用静态工厂的方法注入对象<span>,</span>对应下面的配置文件<span>--</span><span>></span>



 



 <span>&lt;</span>property name<span>=</span><span>"staticFactoryDao"</span> ref<span>=</span><span>"staticFactoryDao"</span><span>></span><span>&lt;</span><span>/</span>property<span>></span>



 



 <span>&lt;</span><span>/</span>bean<span>></span>



 



 <span>&lt;</span><span>!</span><span>--</span>此处获取对象的方式是从工厂类中获取静态方法<span>--</span><span>></span>



 



<span>&lt;</span>bean name<span>=</span><span>"staticFactoryDao"</span> class<span>=</span><span>"DaoFactory"</span>



 



factory<span>-</span>method<span>=</span><span>"getStaticFactoryDaoImpl"</span><span>></span><span>&lt;</span><span>/</span>bean<span>></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>实例工厂</p>
<p>实例工厂的意思是获取对象实例的方法不是静态的，所以你需要首先 new 工厂类，再调用普通的实例方法：</p>
<div><pre><code>public class DaoFactory <span>{</span> <span>//实例工厂</span>



 



 public FactoryDao <span>getFactoryDaoImpl</span><span>(</span><span>)</span><span>{</span>



 



 <span>return</span> <span>new</span> <span>FactoryDaoImpl</span><span>(</span><span>)</span><span>;</span>



 



 



 <span>}</span>



 



<span>}</span>



 



public class SpringAction <span>{</span>



 



 private FactoryDao factoryDao<span>;</span> <span>//注入对象</span>



 



 public void <span>setFactoryDao</span><span>(</span>FactoryDao factoryDao<span>)</span> <span>{</span>



 



 this<span>.</span>factoryDao <span>=</span> factoryDao<span>;</span>



 



 <span>}</span>



 



<span>}</span>
<span>&lt;</span>bean name<span>=</span><span>"springAction"</span> class<span>=</span><span>"SpringAction"</span><span>></span>



 



 <span>&lt;</span><span>!</span><span>--</span>使用实例工厂的方法注入对象<span>,</span>对应下面的配置文件<span>--</span><span>></span>



 



 <span>&lt;</span>property name<span>=</span><span>"factoryDao"</span> ref<span>=</span><span>"factoryDao"</span><span>></span><span>&lt;</span><span>/</span>property<span>></span>



 



 <span>&lt;</span><span>/</span>bean<span>></span>



 



 <span>&lt;</span><span>!</span><span>--</span>此处获取对象的方式是从工厂类中获取实例方法<span>--</span><span>></span>



 



<span>&lt;</span>bean name<span>=</span><span>"daoFactory"</span> class<span>=</span><span>"com.DaoFactory"</span><span>></span><span>&lt;</span><span>/</span>bean<span>></span>



 



<span>&lt;</span>bean name<span>=</span><span>"factoryDao"</span> factory<span>-</span>bean<span>=</span><span>"daoFactory"</span>



 



factory<span>-</span>method<span>=</span><span>"getFactoryDaoImpl"</span><span>></span><span>&lt;</span><span>/</span>bean<span>></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_5-种不同方式的自动装配" tabindex="-1"> 5 种不同方式的自动装配</h3>
<p>Spring 装配包括手动装配和自动装配，手动装配是有基于 xml 装配、构造方法、setter 方法等自动装配有五种自动装配的方式，可以用来指导 Spring 容器用自动装配方式来进行依赖注入。</p>
<ul>
<li><code>no</code>：默认的方式是不进行自动装配，通过显式设置 ref 属性来进行装配。</li>
<li><code>byName</code>：通过参数名 自动装配，Spring 容器在配置文件中发现 bean 的 autowire 属性被设置成 byName，之后容器试图匹配、装配和该 bean 的属性具有相同名字的 bean。</li>
<li><code>byType</code>：通过参数类型自动装配，Spring 容器在配置文件中发现 bean 的 autowire 属性被设置成 byType，之后容器试图匹配、装配和该 bean 的属性具有相同类型的 bean。如果有多个 bean 符合条件，则抛出错误。</li>
<li><code>constructor</code>：这个方式类似于 byType， 但是要提供给构造器参数，如果没有确定的带参数的构造器参数类型，将会抛出异常。</li>
<li><code>autodetect</code>：首先尝试使用 constructor 来自动装配，如果无法工作，则使用 byType 方式。</li>
</ul>
<h3 id="spring-中注入一个-java-collection" tabindex="-1"> Spring 中注入一个 Java Collection</h3>
<p>Spring 提供了以下四种集合类的配置元素：</p>
<ul>
<li><code>&lt;list&gt;</code> : 该标签用来装配可重复的 list 值。</li>
<li><code>&lt;set&gt;</code> : 该标签用来装配没有重复的 set 值。</li>
<li><code>&lt;map&gt;</code>: 该标签可用来注入键和值可以为任何类型的键值对。</li>
<li><code>&lt;props&gt;</code> : 该标签支持注入键和值都是字符串类型的键值对。</li>
</ul>
<div><pre><code><span>&lt;</span>beans<span>></span> 



 <span>&lt;</span><span>!</span><span>--</span> Definition <span>for</span> javaCollection <span>--</span><span>></span> 



 <span>&lt;</span>bean id<span>=</span><span>"javaCollection"</span> class<span>=</span><span>"com.howtodoinjava.JavaCollection"</span><span>></span> 



 <span>&lt;</span><span>!</span><span>--</span> java<span>.</span>util<span>.</span>List <span>--</span><span>></span> 



 <span>&lt;</span>property name<span>=</span><span>"customList"</span><span>></span> 



 <span>&lt;</span>list<span>></span> 



 <span>&lt;</span>value<span>></span>INDIA<span>&lt;</span><span>/</span>value<span>></span> 



 <span>&lt;</span>value<span>></span>Pakistan<span>&lt;</span><span>/</span>value<span>></span> 



 <span>&lt;</span>value<span>></span>USA<span>&lt;</span><span>/</span>value<span>></span> 



 <span>&lt;</span>value<span>></span>UK<span>&lt;</span><span>/</span>value<span>></span> 



 <span>&lt;</span><span>/</span>list<span>></span> 



 <span>&lt;</span><span>/</span>property<span>></span> 



 



 <span>&lt;</span><span>!</span><span>--</span> java<span>.</span>util<span>.</span>Set <span>--</span><span>></span> 



 <span>&lt;</span>property name<span>=</span><span>"customSet"</span><span>></span> 



 <span>&lt;</span>set<span>></span> 



 <span>&lt;</span>value<span>></span>INDIA<span>&lt;</span><span>/</span>value<span>></span> 



 <span>&lt;</span>value<span>></span>Pakistan<span>&lt;</span><span>/</span>value<span>></span> 



 <span>&lt;</span>value<span>></span>USA<span>&lt;</span><span>/</span>value<span>></span> 



 <span>&lt;</span>value<span>></span>UK<span>&lt;</span><span>/</span>value<span>></span> 



 <span>&lt;</span><span>/</span>set<span>></span> 



 <span>&lt;</span><span>/</span>property<span>></span> 



 



 <span>&lt;</span><span>!</span><span>--</span> java<span>.</span>util<span>.</span>Map <span>--</span><span>></span> 



 <span>&lt;</span>property name<span>=</span><span>"customMap"</span><span>></span> 



 <span>&lt;</span><span>map</span><span>></span> 



 <span>&lt;</span>entry key<span>=</span><span>"1"</span> value<span>=</span><span>"INDIA"</span><span>/</span><span>></span> 



 <span>&lt;</span>entry key<span>=</span><span>"2"</span> value<span>=</span><span>"Pakistan"</span><span>/</span><span>></span> 



 <span>&lt;</span>entry key<span>=</span><span>"3"</span> value<span>=</span><span>"USA"</span><span>/</span><span>></span> 



 <span>&lt;</span>entry key<span>=</span><span>"4"</span> value<span>=</span><span>"UK"</span><span>/</span><span>></span> 



 <span>&lt;</span><span>/</span><span>map</span><span>></span> 



 <span>&lt;</span><span>/</span>property<span>></span> 



 



 <span>&lt;</span><span>!</span><span>--</span> java<span>.</span>util<span>.</span>Properties <span>--</span><span>></span> 



 <span>&lt;</span>property name<span>=</span><span>"customProperies"</span><span>></span> 



 <span>&lt;</span>props<span>></span> 



 <span>&lt;</span>prop key<span>=</span><span>"admin"</span><span>></span>admin@nospam<span>.</span>com<span>&lt;</span><span>/</span>prop<span>></span> 



 <span>&lt;</span>prop key<span>=</span><span>"support"</span><span>></span>support@nospam<span>.</span>com<span>&lt;</span><span>/</span>prop<span>></span> 



 <span>&lt;</span><span>/</span>props<span>></span> 



 <span>&lt;</span><span>/</span>property<span>></span> 



 



 <span>&lt;</span><span>/</span>bean<span>></span> 



<span>&lt;</span><span>/</span>beans<span>></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="使用-autowired注解自动装配的过程" tabindex="-1"> 使用@Autowired注解自动装配的过程</h3>
<p>在使用@Autowired注解之前需要在Spring配置文件进行配置，<code>&lt;context:annotation-config /&gt;</code>。</p>
<p>在启动spring IoC时，容器自动装载了一个<code>AutowiredAnnotationBeanPostProcessor</code>后置处理器，当容器扫描到<code>@Autowied</code>、<code>@Resource</code>或<code>@Inject</code>时，就会在IoC容器自动查找需要的bean，并装配给该对象的属性。在使用<code>@Autowired</code>时，首先在容器中查询对应类型的bean：</p>
<ul>
<li>如果查询结果刚好为一个，就将该bean装配给<code>@Autowired</code>指定的数据；</li>
<li>如果查询的结果不止一个，那么<code>@Autowired</code>会根据名称来查找；</li>
<li>如果上述查找的结果为空，那么会抛出异常。解决方法时，使用<code>required=false</code>。</li>
</ul>
<h2 id="spring-aop" tabindex="-1"> Spring AOP</h2>
<h3 id="aop原理" tabindex="-1"> AOP原理</h3>
<p>OOP(Object-Oriented Programming)面向对象编程，允许开发者定义纵向的关系，但并适用于定义横向的关系，导致了大量代码的重复，而不利于各个模块的重用。</p>
<p>AOP(Aspect-Oriented Programming)，一般称为面向切面编程，作为面向对象的一种补充，用于将那些与业务无关，但却对多个对象产生影响的公共行为和逻辑，抽取并封装为一个可重用的模块，这个模块被命名为“切面”（Aspect），减少系统中的重复代码，降低了模块间的耦合度，同时提高了系统的可维护性。</p>
<p>AOP 主要应用场景有</p>
<ul>
<li>Authentication 权限</li>
<li>Caching 缓存</li>
<li>Context passing 内容传递</li>
<li>Error handling 错误处理</li>
<li>Lazy loading 懒加载</li>
<li>Debugging 调试</li>
<li>logging, tracing, profiling and monitoring 记录跟踪 优化 校准</li>
<li>Performance optimization 性能优化</li>
<li>Persistence 持久化</li>
<li>Resource pooling 资源池</li>
<li>Synchronization 同步</li>
<li>Transactions 事务</li>
</ul>
<h3 id="aop-核心概念" tabindex="-1"> AOP 核心概念</h3>
<ul>
<li>切面（aspect）：类是对物体特征的抽象，切面就是对横切关注点的抽象</li>
<li>横切关注点：对哪些方法进行拦截，拦截后怎么处理，这些关注点称之为横切关注点</li>
<li>连接点（joinpoint）：被拦截到的点，因为 Spring 只支持方法类型的连接点，所以在 Spring中连接点指的就是被拦截到的方法，实际上连接点还可以是字段或者构造器</li>
<li>切入点（pointcut）：对连接点进行拦截的定义</li>
<li>通知（advice）：所谓通知指的就是指拦截到连接点之后要执行的代码，通知分为前置、后置、异常、最终、环绕通知五类</li>
<li>目标对象：代理的目标对象</li>
<li>织入（weave）：将切面应用到目标对象并导致代理对象创建的过程
<ul>
<li>编译期：切面在目标类编译时被织入。AspectJ的织入编译器是以这种方式织入切面的；</li>
<li>类加载期：切面在目标类加载到JVM时被织入。需要特殊的类加载器，它可以在目标类被引入应用之前增强该目标类的字节码。AspectJ5的加载时织入就支持以这种方式织入切面；</li>
<li>运行期：切面在应用运行的某个时刻被织入。一般情况下，在织入切面时，AOP容器会为目标对象动态地创建一个代理对象。SpringAOP就是以这种方式织入切面。</li>
</ul>
</li>
<li>引入（introduction）：在不修改代码的前提下，引入可以在运行期为类动态地添加一些方法或字段</li>
</ul>
<h3 id="spring-中的代理" tabindex="-1"> Spring 中的代理</h3>
<p>将 Advice 应用于目标对象后创建的对象称为代理。在客户端对象的情况下，目标对象和代理对象是相同的。</p>
<blockquote>
<p>Advice + Target Object = Proxy</p>
</blockquote>
<h3 id="aop-实现方式" tabindex="-1"> AOP 实现方式</h3>
<p>AOP实现的关键在于代理模式，AOP代理主要分为静态代理和动态代理。</p>
<ul>
<li>AspectJ 静态代理的增强，所谓静态代理，就是AOP框架会在编译阶段生成AOP代理类，因此也称为编译时增强，他会在编译阶段将AspectJ(切面)织入到Java字节码中，运行的时候就是增强之后的AOP对象。</li>
<li>Spring AOP使用的动态代理，所谓的动态代理就是说AOP框架不会去修改字节码，而是每次运行时在内存中临时为方法生成一个AOP对象，这个AOP对象包含了目标对象的全部方法，并且在特定的切点做了增强处理，并回调原对象的方法。</li>
</ul>
<h3 id="aop-两种代理方式" tabindex="-1"> AOP 两种代理方式</h3>
<p>Spring 提供了两种方式来生成代理对象: JDK Proxy 和 Cglib，具体使用哪种方式生成由AopProxyFactory 根据 AdvisedSupport 对象的配置来决定。默认的策略是如果目标类是接口，则使用 JDK 动态代理技术，否则使用 Cglib 来生成代理。</p>
<h3 id="jdk-动态接口代理" tabindex="-1"> JDK 动态接口代理</h3>
<p>JDK 动态代理主要涉及到 java.lang.reflect 包中的两个类：Proxy 和 InvocationHandler。</p>
<p>InvocationHandler是一个接口，通过实现该接口定义横切逻辑，并通过反射机制调用目标类的代码，动态将横切逻辑和业务逻辑编制在一起。</p>
<p>Proxy 利用 InvocationHandler 动态创建一个符合某一接口的实例，生成目标类的代理对象。</p>
<h3 id="cglib-动态代理" tabindex="-1"> CGLib 动态代理</h3>
<p>CGLib 全称为 Code Generation Library，是一个强大的高性能，高质量的代码生成类库，可以在运行期扩展 Java 类与实现 Java 接口，CGLib 封装了 asm，可以再运行期动态生成新的 class。和 JDK 动态代理相比较：JDK 创建代理有一个限制，就是只能为接口创建代理实例，而对于没有通过接口定义业务方法的类，则可以通过 CGLib 创建动态代理。</p>
<p>实现原理</p>
<div><pre><code>@Aspect

public class TransactionDemo <span>{</span>



 



 @<span>Pointcut</span><span>(</span>value<span>=</span><span>"execution(* com.yangxin.core.service.*.*.*(..))"</span><span>)</span>



 



 public void <span>point</span><span>(</span><span>)</span><span>{</span>



 



 <span>}</span>



 



 @<span>Before</span><span>(</span>value<span>=</span><span>"point()"</span><span>)</span>



 



 public void <span>before</span><span>(</span><span>)</span><span>{</span>



 



 System<span>.</span>out<span>.</span><span>println</span><span>(</span><span>"transaction begin"</span><span>)</span><span>;</span>



 



 <span>}</span>



 



 @<span>AfterReturning</span><span>(</span>value <span>=</span> <span>"point()"</span><span>)</span>



 



 public void <span>after</span><span>(</span><span>)</span><span>{</span>



 



 System<span>.</span>out<span>.</span><span>println</span><span>(</span><span>"transaction commit"</span><span>)</span><span>;</span>



 



 <span>}</span>



 



 @<span>Around</span><span>(</span><span>"point()"</span><span>)</span>



 



 public void <span>around</span><span>(</span>ProceedingJoinPoint joinPoint<span>)</span> throws Throwable<span>{</span>



 



 System<span>.</span>out<span>.</span><span>println</span><span>(</span><span>"transaction begin"</span><span>)</span><span>;</span>



 



 joinPoint<span>.</span><span>proceed</span><span>(</span><span>)</span><span>;</span>



 



 System<span>.</span>out<span>.</span><span>println</span><span>(</span><span>"transaction commit"</span><span>)</span><span>;</span>



 



 <span>}</span> <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="spring在运行时通知对象" tabindex="-1"> Spring在运行时通知对象</h3>
<p>通过在代理类中包裹切面，Spring在运行期把切面织入到Spring管理的bean中。代理封装了目标类，并拦截被通知方法的调用，再把调用转发给真正的目标bean。当代理拦截到方法调用时，在调用目标bean方法之前，会执行切面逻辑。</p>
<p>直到应用需要被代理的bean时，Spring才创建代理对象。如果使用的是ApplicationContext的话，在ApplicationContext从BeanFactory中加载所有bean的时候，Spring才会创建被代理的对象。因为Spring运行时才创建代理对象，所以我们不需要特殊的编译器来织入SpringAOP的切面。</p>
<h3 id="spring只支持方法级别的连接点" tabindex="-1"> Spring只支持方法级别的连接点</h3>
<p>因为Spring基于动态代理，所以Spring只支持方法连接点。Spring缺少对字段连接点的支持，而且它不支持构造器连接点。方法之外的连接点拦截功能，我们可以利用Aspect来补充。</p>
<p>在Spring AOP 中，关注点和横切关注的区别是什么？在 spring aop 中 concern 和 cross-cutting concern 的不同之处</p>
<p>关注点（concern）是应用中一个模块的行为，一个关注点可能会被定义成一个我们想实现的一个功能。</p>
<p>横切关注点（cross-cutting concern）是一个关注点，此关注点是整个应用都会使用的功能，并影响整个应用，比如日志，安全和数据传输，几乎应用的每个模块都需要的功能。因此这些都属于横切关注点。</p>
<h3 id="spring通知类型" tabindex="-1"> Spring通知类型</h3>
<p>在AOP术语中，切面的工作被称为通知，实际上是程序执行时要通过SpringAOP框架触发的代码段。Spring切面可以应用5种类型的通知：</p>
<ul>
<li>前置通知（Before）：在目标方法被调用之前调用通知功能；</li>
<li>后置通知（After）：在目标方法完成之后调用通知，此时不会关心方法的输出是什么；</li>
<li>返回通知（After-returning ）：在目标方法成功执行之后调用通知；</li>
<li>异常通知（After-throwing）：在目标方法抛出异常后调用通知；</li>
<li>环绕通知（Around）：通知包裹了被通知的方法，在被通知的方法调用之前和调用之后执行自定义的行为。</li>
</ul>
<h4 id="同一个aspect-不同advice的执行顺序" tabindex="-1"> 同一个aspect，不同advice的执行顺序：</h4>
<p>没有异常情况下的执行顺序：</p>
<ul>
<li>around before advice</li>
<li>before advice</li>
<li>target method 执行</li>
<li>around after advice</li>
<li>after advice</li>
<li>afterReturning</li>
</ul>
<p>有异常情况下的执行顺序：</p>
<ul>
<li>around before advice</li>
<li>before advice</li>
<li>target method 执行</li>
<li>around after advice</li>
<li>after advice</li>
<li>afterThrowing:异常发生</li>
<li>java.lang.RuntimeException: 异常发生</li>
</ul>
<h2 id="spring-mvc" tabindex="-1"> Spring MVC</h2>
<h3 id="spring-mvc-原理" tabindex="-1"> Spring MVC 原理</h3>
<p>Spring 的模型-视图-控制器（MVC）框架是围绕一个 DispatcherServlet 来设计的，这个 Servlet会把请求分发给各个处理器，并支持可配置的处理器映射、视图渲染、本地化、时区与主题渲染等，甚至还能支持文件上传。</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/73ee5a65e7e6e8a0733e3730a486a6e8.png" alt="73ee5a65e7e6e8a0733e3730a486a6e8.png" loading="lazy"></p>
<p><strong>Http 请求到 DispatcherServlet</strong></p>
<p>(1) 客户端请求提交到 DispatcherServlet。</p>
<p><strong>HandlerMapping 寻找处理器</strong></p>
<p>(2) 由 DispatcherServlet 控制器查询一个或多个 HandlerMapping，找到处理请求的Controller。</p>
<p><strong>调用处理器 Controller</strong></p>
<p>(3) DispatcherServlet 将请求提交到 Controller。</p>
<p><strong>Controller 调用业务逻辑处理后，返回 ModelAndView</strong></p>
<p>(4)(5)调用业务处理和返回结果：Controller 调用业务逻辑处理后，返回 ModelAndView。</p>
<p><strong>DispatcherServlet 查询 ModelAndView</strong></p>
<p>(6)(7)处理视图映射并返回模型：DispatcherServlet 查询一个或多个 ViewResoler 视图解析器，找到 ModelAndView 指定的视图。</p>
<p><strong>ModelAndView 反馈浏览器 HTTP</strong></p>
<p>(8) Http 响应：视图负责将结果显示到客户端。</p>
<h2 id="spring-data" tabindex="-1"> Spring DATA</h2>
<h3 id="spring-orm理解" tabindex="-1"> Spring ORM理解</h3>
<p>Spring 通过提供ORM模块，支持我们在直接JDBC之上使用一个对象/关系映射映射(ORM)工具，Spring 支持集成主流的ORM框架，如Hiberate，JDO和 iBATIS，JPA，TopLink，JDO，OJB 。Spring的事务管理同样支持以上所有ORM框架及JDBC。</p>
<p><strong>解释JDBC抽象和DAO模块</strong></p>
<p>通过使用JDBC抽象和DAO模块，保证数据库代码的简洁，并能避免数据库资源错误关闭导致的问题，它在各种不同的数据库的错误信息之上，提供了一个统一的异常访问层。它还利用Spring的AOP 模块给Spring应用中的对象提供事务管理服务。</p>
<h3 id="spring-dao-的支持" tabindex="-1"> Spring DAO 的支持</h3>
<p>Spring DAO（数据访问对象） 使得 JDBC，Hibernate 或 JDO 这样的数据访问技术更容易以一种统一的方式工作。这使得用户容易在持久性技术之间切换。它还允许您在编写代码时，无需考虑捕获每种技术不同的异常。</p>
<h3 id="spring-jdbc-api" tabindex="-1"> Spring JDBC API</h3>
<ul>
<li>JdbcTemplate</li>
<li>SimpleJdbcTemplate</li>
<li>NamedParameterJdbcTemplate</li>
<li>SimpleJdbcInsert</li>
<li>SimpleJdbcCall</li>
</ul>
<h3 id="jdbctemplate是什么" tabindex="-1"> JdbcTemplate是什么</h3>
<p>JdbcTemplate 类提供了很多便利的方法解决诸如把数据库数据转变成基本数据类型或对象，执行写好的或可调用的数据库操作语句，提供自定义的数据错误处理。</p>
<h3 id="使用spring通过什么方式访问hibernate" tabindex="-1"> 使用Spring通过什么方式访问Hibernate？</h3>
<p>有两种方式访问Hibernate：</p>
<ul>
<li>使用 Hibernate 模板和回调进行控制反转</li>
<li>扩展 HibernateDAOSupport 并应用 AOP 拦截器节点</li>
</ul>
<h3 id="spring-支持的-orm" tabindex="-1"> Spring 支持的 ORM</h3>
<p>Spring 支持以下 ORM：</p>
<ul>
<li>Hibernate</li>
<li>iBatis</li>
<li>JPA (Java Persistence API)</li>
<li>TopLink</li>
<li>JDO (Java Data Objects)</li>
<li>OJB</li>
</ul>
<p><strong>如何通过 HibernateDaoSupport 将 Spring 和 Hibernate 结合起来？</strong></p>
<p>用 Spring 的 SessionFactory 调用 LocalSessionFactory。集成过程分三步：</p>
<ul>
<li>配置 the Hibernate SessionFactory</li>
<li>继承 HibernateDaoSupport</li>
<li>实现一个 DAO 在 AOP 支持的事务中装配</li>
</ul>
<h3 id="spring-支持的事务管理类型" tabindex="-1"> Spring 支持的事务管理类型</h3>
<p>Spring 支持两种类型的事务管理：</p>
<ul>
<li>编程式事务管理：这意味你通过编程的方式管理事务，给你带来极大的灵活性，但是 难维护。</li>
<li>声明式事务管理：这意味着你可以将业务代码和事务管理分离，你只需用注解和 XML 配置来管理事务。</li>
</ul>
<h3 id="spring-框架的事务管理有哪些优点" tabindex="-1"> Spring 框架的事务管理有哪些优点？</h3>
<p>它为不同的事务 API 如 JTA，JDBC，Hibernate，JPA 和 JDO，提供一个不变 的编程模式。</p>
<p>它为编程式事务管理提供了一套简单的 API 而不是一些复杂的事务 API 如 它支持声明式事务管理。它和 Spring 各种数据访问抽象层很好得集成。</p>
<h3 id="你更倾向用那种事务管理类型" tabindex="-1"> 你更倾向用那种事务管理类型？</h3>
<p>大多数 Spring 框架的用户选择声明式事务管理，因为它对应用代码的影响最小，因 此更符合一个无侵入的<a href="https://blog.csdn.net/sufu1065/article/details/122872239" target="_blank" rel="noopener noreferrer">轻量级容器</a>的思想。声明式事务管理要优于编程式事务管理， 虽然比编程式事务管理（这种方式允许你通过代码控制事务）少了一点灵活性。</p>
<h3 id="spring常用注解" tabindex="-1"> Spring常用注解</h3>
<h4 id="声明bean的注解" tabindex="-1"> 声明bean的注解</h4>
<ul>
<li><code>@Component</code> ：组件，没有明确的角色</li>
<li><code>@Service</code> ：在业务逻辑层使用</li>
<li><code>@Repository</code> ：在数据访问层使用</li>
<li><code>@Controller</code> ：在展现层使用，控制层的声明</li>
<li><code>@RestController</code> ：<code>@Controller</code>和<code>@ResponseBody</code>组合，，控制层的声明</li>
</ul>
<h4 id="注入bean的注解" tabindex="-1"> 注入bean的注解</h4>
<ul>
<li><code>@Autowired</code>：</li>
</ul>
<p>Spring自带的注解，通过<code>AutowiredAnnotationBeanPostProcessor</code> 类实现的依赖注入，作用在CONSTRUCTOR、METHOD、PARAMETER、FIELD、ANNOTATION_TYPE。默认是根据类型（byType ）进行自动装配的。如果有多个类型一样的Bean候选者，需要指定按照名称（byName ）进行装配，则需要配合@Qualifier。</p>
<p>指定名称后，如果Spring IOC容器中没有对应的组件bean抛出NoSuchBeanDefinitionException。也可以将@Autowired中required配置为false，如果配置为false之后，当没有找到相应bean的时候，系统不会抛异常</p>
<ul>
<li><code>@Inject</code>：</li>
</ul>
<p>JSR330 (Dependency Injection for Java)中的规范，需要导入javax.inject.Inject jar包 ，才能实现注入 作用CONSTRUCTOR、METHOD、FIELD上</p>
<p>根据类型进行自动装配的，如果需要按名称进行装配，则需要配合@Named</p>
<ul>
<li><code>@Resource</code>：</li>
</ul>
<p>JSR250规范的实现，在javax.annotation包下，作用TYPE、FIELD、METHOD上。</p>
<p>默认根据属性名称进行自动装配的，如果有多个类型一样的Bean候选者，则可以通过name进行指定进行注入</p>
<h4 id="java配置类相关注解" tabindex="-1"> java配置类相关注解</h4>
<ul>
<li><code>@Configuration</code> ：声明当前类为配置类，相当于xml形式的Spring配置（类上），声明当前类为配置类，其中内部组合了@Component注解，表明这个类是一个bean（类上）</li>
<li><code>@Bean</code> ：注解在方法上，声明当前方法的返回值为一个bean，替代xml中的方式（方法上）</li>
<li><code>@ComponentScan</code> ：用于对Component进行扫描，相当于xml中的（类上）</li>
<li><code>@WishlyConfiguration</code> ：为@Configuration与@ComponentScan的组合注解，可以替代这两个注解</li>
</ul>
<h4 id="切面-aop-相关注解" tabindex="-1"> 切面（AOP）相关注解</h4>
<p>Spring支持AspectJ的注解式切面编程</p>
<ul>
<li><code>@Aspect</code>：声明一个切面（类上），使用@After、@Before、@Around定义建言（advice），可直接将拦截规则（切点）作为参数。</li>
<li><code>@After</code> ：在方法执行之后执行（方法上）</li>
<li><code>@Before</code> ：在方法执行之前执行（方法上）</li>
<li><code>@Around</code> ：在方法执行之前与之后执行（方法上）</li>
<li><code>@PointCut</code> ：声明切点在java配置类中使用@EnableAspectJAutoProxy注解开启Spring对AspectJ代理的支持（类上）</li>
</ul>
<h3 id="bean的属性支持" tabindex="-1"> @Bean的属性支持</h3>
<p>@Scope 设置Spring容器如何新建Bean实例（方法上，得有@Bean），其设置类型包括：</p>
<ul>
<li><code>Singleton</code>：单例,一个Spring容器中只有一个bean实例，默认模式</li>
<li><code>Protetype</code>：每次调用新建一个bean</li>
<li><code>Request</code>：web项目中，给每个http request新建一个bean</li>
<li><code>Session</code> ：web项目中，给每个http session新建一个bean</li>
<li><code>Global</code>：Session给每一个 global http session新建一个Bean实例</li>
<li><code>@StepScope</code>：在Spring Batch中还有涉及(Spring Batch 之 背景框架简介_vincent-CSDN博客)</li>
<li><code>@PostConstruct</code> ：由JSR-250提供，在构造函数执行完之后执行，等价于xml配置文件中bean的initMethod</li>
<li><code>@PreDestory</code> ：由JSR-250提供，在Bean销毁之前执行，等价于xml配置文件中bean的destroyMethod</li>
</ul>
<h3 id="value注解" tabindex="-1"> @Value注解</h3>
<p>为属性注入值,支持如下方式的注入：</p>
<p>注入普通字符</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/37a5272847ff6ca86690a2e1d3f4dfaa.png" alt="37a5272847ff6ca86690a2e1d3f4dfaa.png" loading="lazy"></p>
<p>注入操作系统属性</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/e4803c07763e1811c00d4c7e602ce0a5.png" alt="e4803c07763e1811c00d4c7e602ce0a5.png" loading="lazy"></p>
<p>注入表达式结果</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/0a1da82128f379c30ad8a617633e8dbe.png" alt="0a1da82128f379c30ad8a617633e8dbe.png" loading="lazy"></p>
<p>注入其它bean属性</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/73e51190ca79d307501ca874efee2e3b.png" alt="73e51190ca79d307501ca874efee2e3b.png" loading="lazy"></p>
<p>注入文件资源</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/9bd391199c575bbc9d4f158a881c7d18.png" alt="9bd391199c575bbc9d4f158a881c7d18.png" loading="lazy"></p>
<p>注入网站资源</p>
<p><img src="https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/cdaf29b32bdc7f7835aec018fecc3f50.png" alt="cdaf29b32bdc7f7835aec018fecc3f50.png" loading="lazy"></p>
<p>注入配置文件</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/08a820d9676736e45563568e57f708da.png" alt="08a820d9676736e45563568e57f708da.png" loading="lazy"></p>
<p><code>@PropertySource</code> 加载配置文件(类上)，还需配置一个<code>PropertySourcesPlaceholderConfigurer</code>的bean。</p>
<h3 id="环境切换" tabindex="-1"> 环境切换</h3>
<ul>
<li><code>@Profile</code> ：通过设定Environment的ActiveProfiles来设定当前context需要使用的配置环境。（类或方法上）</li>
<li><code>@Conditional</code>：Spring4中可以使用此注解定义条件话的bean，通过实现Condition接口，并重写matches方法，从而决定该bean是否被实例化。（方法上）</li>
</ul>
<h3 id="异步相关" tabindex="-1"> 异步相关</h3>
<ul>
<li><code>@EnableAsync</code>：配置类中，通过此注解开启对异步任务的支持，叙事性AsyncConfigurer接口（类上）</li>
<li><code>@Async</code>：在实际执行的bean方法使用该注解来申明其是一个异步任务（方法上或类上所有的方法都将异步，需要@EnableAsync开启异步任务）</li>
</ul>
<h3 id="定时任务相关" tabindex="-1"> 定时任务相关</h3>
<ul>
<li><code>@EnableScheduling</code> ：在配置类上使用，开启计划任务的支持（类上）</li>
<li><code>@Scheduled</code> ：来申明这是一个任务，包括cron,fixDelay,fixRate等类型（方法上，需先开启计划任务的支持）</li>
</ul>
<h3 id="enable-注解说明" tabindex="-1"> @Enable 注解说明</h3>
<p>这些注解主要用来开启对xxx的支持。</p>
<ul>
<li><code>@EnableAspectJAutoProxy</code> ：开启对AspectJ自动代理的支持</li>
<li><code>@EnableAsync</code> ：开启异步方法的支持</li>
<li><code>@EnableScheduling</code> ：开启计划任务的支持</li>
<li><code>@EnableWebMvc</code> ：开启Web MVC的配置支持</li>
<li><code>@EnableConfigurationProperties</code> ：开启对@ConfigurationProperties注解配置Bean的支持</li>
<li><code>@EnableJpaRepositories</code> ：开启对SpringData JPA Repository的支持</li>
<li><code>@EnableTransactionManagement</code> ：开启注解式事务的支持</li>
<li><code>@EnableCaching</code> ：开启注解式的缓存支持</li>
</ul>
<h3 id="测试相关注解" tabindex="-1"> 测试相关注解</h3>
<ul>
<li><code>@RunWith</code> ：运行器，Spring中通常用于对JUnit的支持</li>
<li><code>@ContextConfiguration</code>：用来加载配置ApplicationContext，其中classes属性用来加载配置类</li>
</ul>
<h3 id="springmvc部分" tabindex="-1"> SpringMVC部分</h3>
<ul>
<li><code>@EnableWebMvc</code> ：在配置类中开启Web MVC的配置支持，如一些ViewResolver或者MessageConverter等，若无此句，重写WebMvcConfigurerAdapter方法（用于对SpringMVC的配置）。</li>
<li><code>@Controller</code> ：声明该类为SpringMVC中的Controller</li>
<li><code>@RequestMapping</code> ：用于映射Web请求，包括访问路径和参数（类或方法上）</li>
<li><code>@ResponseBody</code> ：支持将返回值放在response内，而不是一个页面，通常用户返回json数据（返回值旁或方法上）</li>
<li><code>@RequestBody</code> ：允许request的参数在request体中，而不是在直接连接在地址后面。（放在参数前）</li>
<li><code>@PathVariable</code> ：用于接收路径参数，比如@RequestMapping(“/hello/{name}”)申明的路径，将注解放在参数中前，即可获取该值，通常作为Restful的接口实现方法。</li>
<li><code>@RestController</code> ：该注解为一个组合注解，相当于@Controller和@ResponseBody的组合，注解在类上，意味着，该Controller的所有方法都默认加上了@ResponseBody。</li>
<li><code>@ControllerAdvice</code> ：通过该注解，我们可以将对于控制器的全局配置放置在同一个位置，注解了@Controller的类的方法可使用@ExceptionHandler、@InitBinder、@ModelAttribute注解到方法上，这对所有注解了 @RequestMapping的控制器内的方法有效。</li>
<li><code>@ExceptionHandler</code> ：用于全局处理控制器里的异常</li>
<li><code>@InitBinder</code> ：用来设置WebDataBinder，WebDataBinder用来自动绑定前台请求参数到Model中。</li>
<li><code>@ModelAttribute</code> ：本来的作用是绑定键值对到Model里，在@ControllerAdvice中是让全局的@RequestMapping：都能获得在此处设置的键值对。</li>
</ul>
</li>
</ul>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-02-13T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">SpringBoot+SpringSecurity前后端分离+Jwt的权限认证</title>
    <id>https://blog.ciberviler.top/dev/SpringBoot+SpringSecurity%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB+Jwt%E7%9A%84%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringBoot+SpringSecurity%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB+Jwt%E7%9A%84%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">SpringBoot+SpringSecurity前后端分离+Jwt的权限认证</summary>
    <content type="html"><![CDATA[<h1 id="springboot-springsecurity前后端分离-jwt的权限认证" tabindex="-1"> SpringBoot+SpringSecurity前后端分离+Jwt的权限认证</h1>
<h2 id="前言" tabindex="-1"> 前言</h2>
<p>一般来说，我们用SpringSecurity默认的话是前后端整在一起的，比如<a href="https://so.csdn.net/so/search?q=thymeleaf&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">thymeleaf</a>或者Freemarker，SpringSecurity还自带login登录页,还让你配置登出页,错误页。
但是现在前后端分离才是正道，前后端分离的话，那就需要将返回的页面换成Json格式交给前端处理了</p>
<p>SpringSecurity默认的是采用<a href="https://so.csdn.net/so/search?q=Session&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">Session</a>来判断请求的用户是否登录的，但是不方便分布式的扩展，虽然SpringSecurity也支持采用SpringSession来管理分布式下的用户状态，不过现在分布式的还是无状态的Jwt比较主流。 所以下面说下怎么让SpringSecurity变成前后端分离，采用Jwt来做认证的</p>
<h2 id="一、五个handler一个filter两个user" tabindex="-1"> 一、五个handler一个filter两个User</h2>
<p>5个handler，分别是</p>
<ul>
<li>实现AuthenticationEntryPoint接口,当匿名请求需要登录的接口时,拦截处理</li>
<li>实现AuthenticationSuccessHandler接口,当登录成功后,该处理类的方法被调用</li>
<li>实现AuthenticationFailureHandler接口,当登录失败后,该处理类的方法被调用</li>
<li>实现AccessDeniedHandler接口,当登录后,访问接口没有权限的时候,该处理类的方法被调用</li>
<li>实现LogoutSuccessHandler接口,注销的时候调用</li>
</ul>
<h3 id="_1-1-authenticationentrypoint" tabindex="-1"> 1.1 AuthenticationEntryPoint</h3>
<p>匿名未登录的时候访问，遇到需要登录认证的时候被调用</p>
<div><pre><code><span>/**
 * 匿名未登录的时候访问,需要登录的资源的调用类
 * <span>@author</span> zzzgd
 */</span>
<span>@Component</span>
<span>public</span> <span>class</span> <span>CustomerAuthenticationEntryPoint</span> <span>implements</span> <span>AuthenticationEntryPoint</span> <span>{</span>
    <span>@Override</span>
    <span>public</span> <span>void</span> <span>commence</span><span>(</span><span>HttpServletRequest</span> httpServletRequest<span>,</span> <span>HttpServletResponse</span> httpServletResponse<span>,</span> <span>AuthenticationException</span> e<span>)</span> <span>throws</span> <span>IOException</span><span>,</span> <span>ServletException</span> <span>{</span>
	    <span>//设置response状态码，返回错误信息等</span>
	    <span>.</span><span>.</span><span>.</span>
        <span>ResponseUtil</span><span>.</span><span>out</span><span>(</span><span>401</span><span>,</span> <span>ResultUtil</span><span>.</span><span>failure</span><span>(</span><span>ErrorCodeConstants</span><span>.</span>REQUIRED_LOGIN_ERROR<span>)</span><span>)</span><span>;</span>
    <span>}</span>
<span>}</span>

<span>1234567891011121314</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-2-authenticationsuccesshandler" tabindex="-1"> 1.2 AuthenticationSuccessHandler</h3>
<p>这里是我们输入的用户名和密码登录成功后，调用的方法
简单的说就是获取用户信息，使用JWT生成token，然后返回token</p>
<div><pre><code><span>/**
 * 登录成功处理类,登录成功后会调用里面的方法
 * <span>@author</span> Exrickx
 */</span>
<span>@Slf4j</span>
<span>@Component</span>
<span>public</span> <span>class</span> <span>CustomerAuthenticationSuccessHandler</span> <span>implements</span> <span>AuthenticationSuccessHandler</span> <span>{</span>


    <span>@Override</span>
    <span>public</span> <span>void</span> <span>onAuthenticationSuccess</span><span>(</span><span>HttpServletRequest</span> request<span>,</span> <span>HttpServletResponse</span> response<span>,</span> <span>Authentication</span> authentication<span>)</span> <span>throws</span> <span>IOException</span><span>,</span> <span>ServletException</span> <span>{</span>
    	<span>//简单的说就是获取当前用户，拿到用户名或者userId，创建token，返回</span>
        log<span>.</span><span>info</span><span>(</span><span>"登陆成功..."</span><span>)</span><span>;</span>
        <span>CustomerUserDetails</span> principal <span>=</span> <span>(</span><span>CustomerUserDetails</span><span>)</span> authentication<span>.</span><span>getPrincipal</span><span>(</span><span>)</span><span>;</span>
        <span>//颁发token</span>
        <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span><span>Object</span><span>></span></span> emptyMap <span>=</span> <span>new</span> <span>HashMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>4</span><span>)</span><span>;</span>
        emptyMap<span>.</span><span>put</span><span>(</span><span>UserConstants</span><span>.</span>USER_ID<span>,</span>principal<span>.</span><span>getId</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>String</span> token <span>=</span> <span>JwtTokenUtil</span><span>.</span><span>generateToken</span><span>(</span>principal<span>.</span><span>getUsername</span><span>(</span><span>)</span><span>,</span> emptyMap<span>)</span><span>;</span>
        <span>ResponseUtil</span><span>.</span><span>out</span><span>(</span><span>ResultUtil</span><span>.</span><span>success</span><span>(</span>token<span>)</span><span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
<span>12345678910111213141516171819202122</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-3-authenticationfailurehandler" tabindex="-1"> 1.3 AuthenticationFailureHandler</h3>
<p>有登陆成功就有登录失败
登录失败的时候调用这个方法，可以在其中做登录错误限制或者其他操作，我这里直接就是设置响应头的状态码为401，返回</p>
<div><pre><code><span>/**
 * 登录账号密码错误等情况下,会调用的处理类
 * <span>@author</span> Exrickx
 */</span>
<span>@Slf4j</span>
<span>@Component</span>
<span>public</span> <span>class</span> <span>CustomerAuthenticationFailHandler</span> <span>implements</span> <span>AuthenticationFailureHandler</span> <span>{</span>


    <span>@Override</span>
    <span>public</span> <span>void</span> <span>onAuthenticationFailure</span><span>(</span><span>HttpServletRequest</span> request<span>,</span> <span>HttpServletResponse</span> response<span>,</span> <span>AuthenticationException</span> e<span>)</span> <span>throws</span> <span>IOException</span><span>,</span> <span>ServletException</span> <span>{</span>
    <span>//设置response状态码，返回错误信息等</span>
    	<span>.</span><span>.</span><span>.</span><span>.</span>
        <span>ResponseUtil</span><span>.</span><span>out</span><span>(</span><span>401</span><span>,</span> <span>ResultUtil</span><span>.</span><span>failure</span><span>(</span><span>ErrorCodeConstants</span><span>.</span>LOGIN_UNMATCH_ERROR<span>)</span><span>)</span><span>;</span>
    <span>}</span>

<span>}</span>

<span>12345678910111213141516171819</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-4-logoutsuccesshandler" tabindex="-1"> 1.4 LogoutSuccessHandler</h3>
<p>登出注销的时候调用，Jwt有个缺点就是无法主动控制失效，可以采用Jwt+session的方式，比如删除存储在Redis的token</p>
<p>这里需要注意，如果将SpringSecurity的session配置为无状态，或者不保存session，这里authentication为null！！ ，注意空指针问题。（详情见下面的配置WebSecurityConfigurerAdapter）</p>
<div><pre><code><span>/**
 * 登出成功的调用类
 * <span>@author</span> zzzgd
 */</span>
<span>@Component</span>
<span>public</span> <span>class</span> <span>CustomerLogoutSuccessHandler</span> <span>implements</span> <span>LogoutSuccessHandler</span> <span>{</span>
    <span>@Override</span>
    <span>public</span> <span>void</span> <span>onLogoutSuccess</span><span>(</span><span>HttpServletRequest</span> request<span>,</span> <span>HttpServletResponse</span> response<span>,</span> <span>Authentication</span> authentication<span>)</span> <span>throws</span> <span>IOException</span><span>,</span> <span>ServletException</span> <span>{</span>
        <span>ResponseUtil</span><span>.</span><span>out</span><span>(</span><span>ResultUtil</span><span>.</span><span>success</span><span>(</span><span>"Logout Success!"</span><span>)</span><span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
<span>1234567891011</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-5-accessdeniedhandler" tabindex="-1"> 1.5 AccessDeniedHandler</h3>
<p>登录后，访问缺失权限的资源会调用。</p>
<div><pre><code><span>/**
 * 没有权限,被拒绝访问时的调用类
 * <span>@author</span> Exrickx
 */</span>
<span>@Component</span>
<span>@Slf4j</span>
<span>public</span> <span>class</span> <span>CustomerRestAccessDeniedHandler</span> <span>implements</span> <span>AccessDeniedHandler</span> <span>{</span>

    <span>@Override</span>
    <span>public</span> <span>void</span> <span>handle</span><span>(</span><span>HttpServletRequest</span> request<span>,</span> <span>HttpServletResponse</span> response<span>,</span> <span>AccessDeniedException</span> accessDeniedException<span>)</span> <span>{</span>
        <span>ResponseUtil</span><span>.</span><span>out</span><span>(</span><span>403</span><span>,</span> <span>ResultUtil</span><span>.</span><span>failure</span><span>(</span><span>ErrorCodeConstants</span><span>.</span>PERMISSION_DENY<span>)</span><span>)</span><span>;</span>
    <span>}</span>

<span>}</span>
<span>1234567891011121314</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-6-一个过滤器onceperrequestfilter" tabindex="-1"> 1.6 一个过滤器OncePerRequestFilter</h3>
<p>这里算是一个小重点。
上面我们在登录成功后，返回了一个token，那怎么使用这个token呢？</p>
<p>前端发起请求的时候将token放在请求头中，在过滤器中对请求头进行解析。</p>
<ol>
<li>如果有accessToken的请求头（可以自已定义名字），取出token，解析token，解析成功说明token正确，将解析出来的用户信息放到SpringSecurity的上下文中</li>
<li>如果有accessToken的请求头，解析token失败（无效token，或者过期失效），取不到用户信息，放行</li>
<li>没有accessToken的请求头，放行</li>
</ol>
<p>这里可能有人会疑惑，为什么token失效都要放行呢？
这是因为SpringSecurity会自己去做登录的认证和权限的校验，靠的就是我们放在SpringSecurity上下文中的<code>SecurityContextHolder.getContext().setAuthentication(authentication);</code>，没有拿到<code>authentication</code>，放行了，SpringSecurity还是会走到认证和校验，这个时候就会发现没有登录没有权限。</p>
<blockquote>
<p>旧版本, 最新在底部</p>
</blockquote>
<div><pre><code><span>package</span> <span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>config<span>.</span>auth<span>.</span>filter</span><span>;</span>

<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>common<span>.</span>constants<span>.</span></span><span>SecurityConstants</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>common<span>.</span>util<span>.</span>jwt<span>.</span></span><span>JwtTokenUtil</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>config<span>.</span>auth<span>.</span>user<span>.</span></span><span>CustomerUserDetailService</span></span><span>;</span>
<span>import</span> <span><span>lombok<span>.</span>extern<span>.</span>slf4j<span>.</span></span><span>Slf4j</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>beans<span>.</span>factory<span>.</span>annotation<span>.</span></span><span>Autowired</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>authentication<span>.</span></span><span>UsernamePasswordAuthenticationToken</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>core<span>.</span>context<span>.</span></span><span>SecurityContextHolder</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>core<span>.</span>userdetails<span>.</span></span><span>UserDetails</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>web<span>.</span>authentication<span>.</span></span><span>WebAuthenticationDetailsSource</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>stereotype<span>.</span></span><span>Component</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>filter<span>.</span></span><span>OncePerRequestFilter</span></span><span>;</span>

<span>import</span> <span><span>javax<span>.</span>servlet<span>.</span></span><span>FilterChain</span></span><span>;</span>
<span>import</span> <span><span>javax<span>.</span>servlet<span>.</span></span><span>ServletException</span></span><span>;</span>
<span>import</span> <span><span>javax<span>.</span>servlet<span>.</span>http<span>.</span></span><span>HttpServletRequest</span></span><span>;</span>
<span>import</span> <span><span>javax<span>.</span>servlet<span>.</span>http<span>.</span></span><span>HttpServletResponse</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>IOException</span></span><span>;</span>

<span>/**
 * 过滤器,在请求过来的时候,解析请求头中的token,再解析token得到用户信息,再存到SecurityContextHolder中
 * <span>@author</span> zzzgd
 */</span>
<span>@Component</span>
<span>@Slf4j</span>
<span>public</span> <span>class</span> <span>CustomerJwtAuthenticationTokenFilter</span> <span>extends</span> <span>OncePerRequestFilter</span> <span>{</span>

    <span>@Autowired</span>
    <span>CustomerUserDetailService</span> customerUserDetailService<span>;</span>

    <span>@Override</span>
    <span>protected</span> <span>void</span> <span>doFilterInternal</span><span>(</span><span>HttpServletRequest</span> request<span>,</span> <span>HttpServletResponse</span> response<span>,</span> <span>FilterChain</span> chain<span>)</span> <span>throws</span> <span>ServletException</span><span>,</span> <span>IOException</span> <span>{</span>
        
    	<span>//请求头为 accessToken</span>
    	<span>//请求体为 Bearer token</span>

    	<span>String</span> authHeader <span>=</span> request<span>.</span><span>getHeader</span><span>(</span><span>SecurityConstants</span><span>.</span>HEADER<span>)</span><span>;</span>

        <span>if</span> <span>(</span>authHeader <span>!=</span> <span>null</span> <span>&amp;&amp;</span> authHeader<span>.</span><span>startsWith</span><span>(</span><span>SecurityConstants</span><span>.</span>TOKEN_SPLIT<span>)</span><span>)</span> <span>{</span>

            <span>final</span> <span>String</span> authToken <span>=</span> authHeader<span>.</span><span>substring</span><span>(</span><span>SecurityConstants</span><span>.</span>TOKEN_SPLIT<span>.</span><span>length</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>String</span> username <span>=</span> <span>JwtTokenUtil</span><span>.</span><span>parseTokenGetUsername</span><span>(</span>authToken<span>)</span><span>;</span>
            <span>if</span> <span>(</span>username <span>!=</span> <span>null</span> <span>&amp;&amp;</span> <span>SecurityContextHolder</span><span>.</span><span>getContext</span><span>(</span><span>)</span><span>.</span><span>getAuthentication</span><span>(</span><span>)</span> <span>==</span> <span>null</span><span>)</span> <span>{</span>
                <span>UserDetails</span> userDetails <span>=</span> customerUserDetailService<span>.</span><span>loadUserByUsername</span><span>(</span>username<span>)</span><span>;</span>
                <span>if</span> <span>(</span>userDetails <span>!=</span> <span>null</span><span>)</span> <span>{</span>
                    <span>UsernamePasswordAuthenticationToken</span> authentication <span>=</span>
                            <span>new</span> <span>UsernamePasswordAuthenticationToken</span><span>(</span>userDetails<span>,</span> userDetails<span>.</span><span>getPassword</span><span>(</span><span>)</span><span>,</span> userDetails<span>.</span><span>getAuthorities</span><span>(</span><span>)</span><span>)</span><span>;</span>
                    authentication<span>.</span><span>setDetails</span><span>(</span><span>new</span> <span>WebAuthenticationDetailsSource</span><span>(</span><span>)</span><span>.</span><span>buildDetails</span><span>(</span>request<span>)</span><span>)</span><span>;</span>
                    <span>SecurityContextHolder</span><span>.</span><span>getContext</span><span>(</span><span>)</span><span>.</span><span>setAuthentication</span><span>(</span>authentication<span>)</span><span>;</span>
                <span>}</span>
            <span>}</span>
        <span>}</span>
        chain<span>.</span><span>doFilter</span><span>(</span>request<span>,</span> response<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
<span>1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-7-实现userdetails扩充字段" tabindex="-1"> 1.7 实现UserDetails扩充字段</h3>
<p>这个接口表示的用户信息，SpringSecurity默认实现了一个User，不过字段寥寥无几，只有username，password这些，而且后面获取用户信息的时候也是获取的UserDetail。</p>
<p>于是我们将自己的数据库的User作为拓展，自己实现这个接口。<strong>继承的是数据库对应的User，而不是SpringSecurity的User</strong></p>
<div><pre><code><span>package</span> <span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>config<span>.</span>auth<span>.</span>user</span><span>;</span>

<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>common<span>.</span>constants<span>.</span></span><span>UserConstants</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>dao<span>.</span>entity<span>.</span>model<span>.</span></span><span>User</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>core<span>.</span></span><span>GrantedAuthority</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>core<span>.</span>userdetails<span>.</span></span><span>UserDetails</span></span><span>;</span>

<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Collection</span></span><span>;</span>

<span>/**
 * CustomerUserDetails
 *
 * <span>@author</span> zgd
 * <span>@date</span> 2019/7/17 15:29
 */</span>
<span>public</span> <span>class</span> <span>CustomerUserDetails</span> <span>extends</span> <span>User</span> <span>implements</span> <span>UserDetails</span> <span>{</span>

  <span>private</span> <span>Collection</span><span><span>&lt;</span><span>?</span> <span>extends</span> <span>GrantedAuthority</span><span>></span></span> authorities<span>;</span>

  <span>public</span> <span>CustomerUserDetails</span><span>(</span><span>User</span> user<span>)</span><span>{</span>
    <span>this</span><span>.</span><span>setId</span><span>(</span>user<span>.</span><span>getId</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>this</span><span>.</span><span>setUsername</span><span>(</span>user<span>.</span><span>getUsername</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>this</span><span>.</span><span>setPassword</span><span>(</span>user<span>.</span><span>getPassword</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>this</span><span>.</span><span>setRoles</span><span>(</span>user<span>.</span><span>getRoles</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>this</span><span>.</span><span>setStatus</span><span>(</span>user<span>.</span><span>getStatus</span><span>(</span><span>)</span><span>)</span><span>;</span>
  <span>}</span>

  <span>public</span> <span>void</span> <span>setAuthorities</span><span>(</span><span>Collection</span><span><span>&lt;</span><span>?</span> <span>extends</span> <span>GrantedAuthority</span><span>></span></span> authorities<span>)</span> <span>{</span>
    <span>this</span><span>.</span>authorities <span>=</span> authorities<span>;</span>
  <span>}</span>

  <span>/**
   * 添加用户拥有的权限和角色
   * <span>@return</span>
   */</span>
  <span>@Override</span>
  <span>public</span> <span>Collection</span><span><span>&lt;</span><span>?</span> <span>extends</span> <span>GrantedAuthority</span><span>></span></span> <span>getAuthorities</span><span>(</span><span>)</span> <span>{</span>
    <span>return</span> <span>this</span><span>.</span>authorities<span>;</span>
  <span>}</span>

  <span>/**
   * 账户是否过期
   * <span>@return</span>
   */</span>
  <span>@Override</span>
  <span>public</span> <span>boolean</span> <span>isAccountNonExpired</span><span>(</span><span>)</span> <span>{</span>
    <span>return</span> <span>true</span><span>;</span>
  <span>}</span>

  <span>/**
   * 是否禁用
   * <span>@return</span>
   */</span>
  <span>@Override</span>
  <span>public</span> <span>boolean</span> <span>isAccountNonLocked</span><span>(</span><span>)</span> <span>{</span>
    <span>return</span>  <span>true</span><span>;</span>
  <span>}</span>

  <span>/**
   * 密码是否过期
   * <span>@return</span>
   */</span>
  <span>@Override</span>
  <span>public</span> <span>boolean</span> <span>isCredentialsNonExpired</span><span>(</span><span>)</span> <span>{</span>
    <span>return</span> <span>true</span><span>;</span>
  <span>}</span>

  <span>/**
   * 是否启用
   * <span>@return</span>
   */</span>
  <span>@Override</span>
  <span>public</span> <span>boolean</span> <span>isEnabled</span><span>(</span><span>)</span> <span>{</span>
    <span>return</span> <span>UserConstants</span><span>.</span>USER_STATUS_NORMAL<span>.</span><span>equals</span><span>(</span><span>this</span><span>.</span><span>getStatus</span><span>(</span><span>)</span><span>)</span><span>;</span>
  <span>}</span>
<span>}</span>

<span>1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-8-实现userdetailsservice" tabindex="-1"> 1.8 实现UserDetailsService</h3>
<p>SpringSecurity在登录的时候，回去数据库（或其他来源），根据username获取正确的user信息，就会根据这个service类，拿到用户的信息和权限。我们自己实现</p>
<div><pre><code><span>import</span> <span><span>com<span>.</span>alibaba<span>.</span>fastjson<span>.</span></span><span>JSON</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>dao<span>.</span>entity<span>.</span>model<span>.</span></span><span>User</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>service<span>.</span></span><span>IUserService</span></span><span>;</span>
<span>import</span> <span><span>lombok<span>.</span>extern<span>.</span>slf4j<span>.</span></span><span>Slf4j</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>apache<span>.</span>commons<span>.</span>collections<span>.</span></span><span>CollectionUtils</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>beans<span>.</span>factory<span>.</span>annotation<span>.</span></span><span>Autowired</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>core<span>.</span>authority<span>.</span></span><span>SimpleGrantedAuthority</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>core<span>.</span>userdetails<span>.</span></span><span>UserDetails</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>core<span>.</span>userdetails<span>.</span></span><span>UserDetailsService</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>core<span>.</span>userdetails<span>.</span></span><span>UsernameNotFoundException</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>stereotype<span>.</span></span><span>Service</span></span><span>;</span>

<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>ArrayList</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>List</span></span><span>;</span>

<span>/**
 * <span>@author</span> zgd
 * <span>@date</span> 2019/1/16 16:27
 * <span>@description</span> 自己实现UserDetailService,用与SpringSecurity获取用户信息
 */</span>
<span>@Service</span>
<span>@Slf4j</span>
<span>public</span> <span>class</span> <span>CustomerUserDetailService</span> <span>implements</span> <span>UserDetailsService</span> <span>{</span>

  <span>@Autowired</span>
  <span>private</span> <span>IUserService</span> userService<span>;</span>

  <span>/**
   * 获取用户信息,然后交给spring去校验权限
   * <span>@param</span> <span>username</span>
   * <span>@return</span>
   * <span>@throws</span> <span><span>UsernameNotFoundException</span></span>
   */</span>
  <span>@Override</span>
  <span>public</span> <span>UserDetails</span> <span>loadUserByUsername</span><span>(</span><span>String</span> username<span>)</span> <span>throws</span> <span>UsernameNotFoundException</span> <span>{</span>
    <span>//获取用户信息</span>
    <span>User</span> user <span>=</span> userService<span>.</span><span>getUserRoleByUserName</span><span>(</span>username<span>)</span><span>;</span>
    <span>if</span><span>(</span>user <span>==</span> <span>null</span><span>)</span><span>{</span>
      <span>throw</span> <span>new</span> <span>UsernameNotFoundException</span><span>(</span><span>"用户名不存在"</span><span>)</span><span>;</span>
    <span>}</span>
    <span>CustomerUserDetails</span> customerUserDetails <span>=</span> <span>new</span> <span>CustomerUserDetails</span><span>(</span>user<span>)</span><span>;</span>

    <span>List</span><span><span>&lt;</span><span>SimpleGrantedAuthority</span><span>></span></span> authorities <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
    <span>//用于添加用户的权限。只要把用户权限添加到authorities 就万事大吉。</span>
    <span>if</span> <span>(</span><span>CollectionUtils</span><span>.</span><span>isNotEmpty</span><span>(</span>user<span>.</span><span>getRoles</span><span>(</span><span>)</span><span>)</span><span>)</span><span>{</span>
      user<span>.</span><span>getRoles</span><span>(</span><span>)</span><span>.</span><span>forEach</span><span>(</span>r <span>-></span> authorities<span>.</span><span>add</span><span>(</span><span>new</span> <span>SimpleGrantedAuthority</span><span>(</span><span>"ROLE_"</span><span>+</span>r<span>.</span><span>getRoleName</span><span>(</span><span>)</span><span>)</span><span>)</span><span>)</span><span>;</span>
    <span>}</span>
    customerUserDetails<span>.</span><span>setAuthorities</span><span>(</span>authorities<span>)</span><span>;</span>
    log<span>.</span><span>info</span><span>(</span><span>"authorities:{}"</span><span>,</span> JSON<span>.</span><span>toJSONString</span><span>(</span>authorities<span>)</span><span>)</span><span>;</span>
    
    <span>//这里返回的是我们自己定义的UserDetail</span>
    <span>return</span> customerUserDetails<span>;</span>
  <span>}</span>
<span>}</span>

<span>12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-9-usersessionservice" tabindex="-1"> 1.9 userSessionService</h3>
<div><pre><code><span>package</span> <span>com<span>.</span>zgd<span>.</span>springboot<span>.</span>web<span>.</span>common<span>.</span>user</span><span>;</span>


<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>springboot<span>.</span>web<span>.</span>auth<span>.</span>user<span>.</span></span><span>CustomerUserDetails</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>springboot<span>.</span>web<span>.</span>manager<span>.</span></span><span>RedisManager</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>beans<span>.</span>factory<span>.</span>annotation<span>.</span></span><span>Autowired</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>stereotype<span>.</span></span><span>Service</span></span><span>;</span>

<span>/**
 * CacheUserSessionServiceImpl
 * 使用redis实现的，存储用户会话session
 * <span>@author</span> zgd
 * <span>@date</span> 2019/7/19 14:29
 */</span>
<span>@Service</span>
<span>public</span> <span>class</span> <span>UserCacheSessionServiceImpl</span> <span>implements</span> <span>UserSessionService</span>  <span>{</span>

  <span>@Autowired</span>
  <span>private</span> <span>RedisManager</span> redisManager<span>;</span>

  <span>private</span> <span>static</span> <span>final</span> <span>String</span> USER_SESSION_PREFIX <span>=</span> <span>"USER-SESSION:"</span><span>;</span>
  <span>private</span> <span>static</span> <span>final</span> <span>String</span> USER_TOKEN_TIMESTAMP_PREFIX <span>=</span> <span>"USER-TOKEN-TIMESTAMP:"</span><span>;</span>


  <span>@Override</span>
  <span>public</span> <span>void</span> <span>saveSession</span><span>(</span><span>CustomerUserDetails</span> userDetails<span>,</span> <span>int</span> second<span>)</span> <span>{</span>
    <span>String</span> username <span>=</span> userDetails<span>.</span><span>getUsername</span><span>(</span><span>)</span><span>;</span>
    <span>String</span> key <span>=</span> USER_SESSION_PREFIX <span>+</span> username<span>;</span>
    redisManager<span>.</span><span>setexToJson</span><span>(</span>key<span>,</span>second<span>,</span>userDetails<span>)</span><span>;</span>
  <span>}</span>

  <span>@Override</span>
  <span>public</span> <span>CustomerUserDetails</span> <span>getSessionByUsername</span><span>(</span><span>String</span> username<span>)</span> <span>{</span>
    <span>String</span> key <span>=</span> USER_SESSION_PREFIX <span>+</span> username<span>;</span>
    <span>return</span> redisManager<span>.</span><span>getFromJson</span><span>(</span>key<span>,</span><span>CustomerUserDetails</span><span>.</span><span>class</span><span>)</span><span>;</span>
  <span>}</span>

  <span>@Override</span>
  <span>public</span> <span>void</span> <span>destroySession</span><span>(</span><span>String</span> username<span>)</span> <span>{</span>
    <span>String</span> key <span>=</span> USER_SESSION_PREFIX <span>+</span> username<span>;</span>
    <span>String</span> key1 <span>=</span> USER_TOKEN_TIMESTAMP_PREFIX <span>+</span> username<span>;</span>
    redisManager<span>.</span><span>del</span><span>(</span>key<span>,</span>key1<span>)</span><span>;</span>
  <span>}</span>


  <span>@Override</span>
  <span>public</span> <span>void</span> <span>saveTokenTimestamp</span><span>(</span><span>String</span> username<span>,</span> <span>long</span> mills<span>)</span> <span>{</span>
    <span>String</span> key <span>=</span> USER_TOKEN_TIMESTAMP_PREFIX <span>+</span> username<span>;</span>
    redisManager<span>.</span><span>set</span><span>(</span>key<span>,</span> <span>String</span><span>.</span><span>valueOf</span><span>(</span>mills<span>)</span><span>)</span><span>;</span>
  <span>}</span>

  <span>@Override</span>
  <span>public</span> <span>Long</span> <span>getTokenTimestamp</span><span>(</span><span>String</span> username<span>)</span> <span>{</span>
    <span>String</span> key <span>=</span> USER_TOKEN_TIMESTAMP_PREFIX <span>+</span> username<span>;</span>
    <span>return</span> <span>Long</span><span>.</span><span>valueOf</span><span>(</span>redisManager<span>.</span><span>get</span><span>(</span>key<span>)</span><span>)</span><span>;</span>
  <span>}</span>
<span>}</span>

<span>12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_1-10-resonseutil" tabindex="-1"> 1.10 ResonseUtil</h3>
<div><pre><code><span>import</span> <span><span>com<span>.</span>alibaba<span>.</span>fastjson<span>.</span></span><span>JSON</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>IOException</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Map</span></span><span>;</span>
<span>import</span> <span><span>javax<span>.</span>servlet<span>.</span></span><span>ServletOutputStream</span></span><span>;</span>
<span>import</span> <span><span>javax<span>.</span>servlet<span>.</span>http<span>.</span></span><span>HttpServletResponse</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>apache<span>.</span>commons<span>.</span>collections4<span>.</span></span><span>MapUtils</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>slf4j<span>.</span></span><span>Logger</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>slf4j<span>.</span></span><span>LoggerFactory</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>context<span>.</span>request<span>.</span></span><span>RequestContextHolder</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>context<span>.</span>request<span>.</span></span><span>ServletRequestAttributes</span></span><span>;</span>

<span>public</span> <span>class</span> <span>ResponseUtil</span> <span>{</span>
  <span>private</span> <span>static</span> <span>final</span> <span>Logger</span> log <span>=</span> <span>LoggerFactory</span><span>.</span><span>getLogger</span><span>(</span><span>ResponseUtil</span><span>.</span><span>class</span><span>)</span><span>;</span>

  <span>public</span> <span>ResponseUtil</span><span>(</span><span>)</span> <span>{</span>
  <span>}</span>

  <span>public</span> <span>static</span> <span>void</span> <span>out</span><span>(</span><span>Result</span> result<span>)</span> <span>{</span>
    <span>out</span><span>(</span><span>200</span><span>,</span> result<span>,</span> <span>(</span><span>Map</span><span>)</span><span>null</span><span>)</span><span>;</span>
  <span>}</span>

  <span>public</span> <span>static</span> <span>void</span> <span>out</span><span>(</span><span>int</span> statusCode<span>,</span> <span>Result</span> result<span>)</span> <span>{</span>
    <span>out</span><span>(</span>statusCode<span>,</span> result<span>,</span> <span>(</span><span>Map</span><span>)</span><span>null</span><span>)</span><span>;</span>
  <span>}</span>

  <span>public</span> <span>static</span> <span>void</span> <span>outWithHeader</span><span>(</span><span>int</span> statusCode<span>,</span> <span>Result</span> result<span>,</span> <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>String</span><span>></span></span> map<span>)</span> <span>{</span>
    <span>out</span><span>(</span>statusCode<span>,</span> result<span>,</span> map<span>)</span><span>;</span>
  <span>}</span>

  <span>public</span> <span>static</span> <span>void</span> <span>out</span><span>(</span><span>int</span> statusCode<span>,</span> <span>Result</span> result<span>,</span> <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>String</span><span>></span></span> header<span>)</span> <span>{</span>
    <span>ServletOutputStream</span> out <span>=</span> <span>null</span><span>;</span>

    <span>try</span> <span>{</span>
      <span>ServletRequestAttributes</span> servletRequestAttributes <span>=</span> <span>(</span><span>ServletRequestAttributes</span><span>)</span><span>RequestContextHolder</span><span>.</span><span>getRequestAttributes</span><span>(</span><span>)</span><span>;</span>
      <span>if</span> <span>(</span>servletRequestAttributes <span>!=</span> <span>null</span><span>)</span> <span>{</span>
        <span>HttpServletResponse</span> response <span>=</span> servletRequestAttributes<span>.</span><span>getResponse</span><span>(</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span>response <span>!=</span> <span>null</span> <span>&amp;&amp;</span> <span>!</span>response<span>.</span><span>isCommitted</span><span>(</span><span>)</span><span>)</span> <span>{</span>
        <span>//如果发现乱码,这里注释</span>
          response<span>.</span><span>setCharacterEncoding</span><span>(</span><span>"UTF-8"</span><span>)</span><span>;</span>
          response<span>.</span><span>setContentType</span><span>(</span><span>"application/json;charset=UTF-8"</span><span>)</span><span>;</span>
          response<span>.</span><span>setStatus</span><span>(</span>statusCode<span>)</span><span>;</span>
          <span>if</span> <span>(</span><span>MapUtils</span><span>.</span><span>isNotEmpty</span><span>(</span>header<span>)</span><span>)</span> <span>{</span>
            header<span>.</span><span>forEach</span><span>(</span>response<span>::</span><span>setHeader</span><span>)</span><span>;</span>
          <span>}</span>

          out <span>=</span> response<span>.</span><span>getOutputStream</span><span>(</span><span>)</span><span>;</span>
          out<span>.</span><span>write</span><span>(</span>JSON<span>.</span><span>toJSONString</span><span>(</span>result<span>)</span><span>.</span><span>getBytes</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>}</span>
      <span>}</span>
    <span>}</span> <span>catch</span> <span>(</span><span>Exception</span> var14<span>)</span> <span>{</span>
      log<span>.</span><span>error</span><span>(</span><span>"[ResponseUtil] 响应出错 "</span><span>,</span> var14<span>)</span><span>;</span>
    <span>}</span> <span>finally</span> <span>{</span>
      <span>if</span> <span>(</span>out <span>!=</span> <span>null</span><span>)</span> <span>{</span>
        <span>try</span> <span>{</span>
          out<span>.</span><span>flush</span><span>(</span><span>)</span><span>;</span>
          out<span>.</span><span>close</span><span>(</span><span>)</span><span>;</span>
        <span>}</span> <span>catch</span> <span>(</span><span>IOException</span> var13<span>)</span> <span>{</span>
          log<span>.</span><span>error</span><span>(</span><span>"关闭流出错 "</span><span>,</span> var13<span>)</span><span>;</span>
        <span>}</span>
      <span>}</span>

    <span>}</span>

  <span>}</span>
<span>}</span>

<span>1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="二、配置websecurityconfigureradapter" tabindex="-1"> 二、配置WebSecurityConfigurerAdapter</h2>
<p>我们需要将上面定义的handler和filter，注册到SpringSecurity。同时配置一些放行的url</p>
<p><strong>这里有一点需要注意：如果配置了下面的SessionCreationPolicy.STATELESS</strong>，则SpringSecurity不会保存session会话，在<code>/logout</code>登出的时候会拿不到用户实体对象。</p>
<div><pre><code>http.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS);
</code></pre><div aria-hidden="true"><div></div></div></div><p>如果登出注销不依赖SpringSecurity，并且session交给redis的token来管理的话，可以按上面的配置。</p>
<div><pre><code><span>package</span> <span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>config</span><span>;</span>

<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>config<span>.</span>auth<span>.</span>encoder<span>.</span></span><span>MyAesPasswordEncoder</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>config<span>.</span>auth<span>.</span>encoder<span>.</span></span><span>MyEmptyPasswordEncoder</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>config<span>.</span>auth<span>.</span>handler<span>.</span></span><span>*</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>config<span>.</span>auth<span>.</span>filter<span>.</span></span><span>CustomerJwtAuthenticationTokenFilter</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>config<span>.</span>auth<span>.</span>user<span>.</span></span><span>CustomerUserDetailService</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>beans<span>.</span>factory<span>.</span>annotation<span>.</span></span><span>Autowired</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>context<span>.</span>annotation<span>.</span></span><span>Bean</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>context<span>.</span>annotation<span>.</span></span><span>Configuration</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>config<span>.</span>annotation<span>.</span>authentication<span>.</span>builders<span>.</span></span><span>AuthenticationManagerBuilder</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>config<span>.</span>annotation<span>.</span>method<span>.</span>configuration<span>.</span></span><span>EnableGlobalMethodSecurity</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>config<span>.</span>annotation<span>.</span>web<span>.</span>builders<span>.</span></span><span>HttpSecurity</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>config<span>.</span>annotation<span>.</span>web<span>.</span>builders<span>.</span></span><span>WebSecurity</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>config<span>.</span>annotation<span>.</span>web<span>.</span>configuration<span>.</span></span><span>EnableWebSecurity</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>config<span>.</span>annotation<span>.</span>web<span>.</span>configuration<span>.</span></span><span>WebSecurityConfigurerAdapter</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>config<span>.</span>http<span>.</span></span><span>SessionCreationPolicy</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>crypto<span>.</span>bcrypt<span>.</span></span><span>BCryptPasswordEncoder</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>crypto<span>.</span>password<span>.</span></span><span>PasswordEncoder</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>web<span>.</span>authentication<span>.</span></span><span>UsernamePasswordAuthenticationFilter</span></span><span>;</span>

<span>/**
 * @Author: zgd
 * @Date: 2019/1/15 17:42
 * @Description:
 */</span>
<span>@Configuration</span>
<span>@EnableWebSecurity</span>
<span>@EnableGlobalMethodSecurity</span><span>(</span>securedEnabled <span>=</span> <span>true</span><span>,</span> prePostEnabled <span>=</span> <span>true</span><span>)</span><span>// 控制@Secured权限注解</span>
<span>public</span> <span>class</span> <span>WebSecurityConfig</span> <span>extends</span> <span>WebSecurityConfigurerAdapter</span> <span>{</span>

  <span>/**
   * 这里需要交给spring注入,而不是直接new
   */</span>
  <span>@Autowired</span>
  <span>private</span> <span>PasswordEncoder</span> passwordEncoder<span>;</span>
  <span>@Autowired</span>
  <span>private</span> <span>CustomerUserDetailService</span> customerUserDetailService<span>;</span>
  <span>@Autowired</span>
  <span>private</span> <span>CustomerAuthenticationFailHandler</span> customerAuthenticationFailHandler<span>;</span>
  <span>@Autowired</span>
  <span>private</span> <span>CustomerAuthenticationSuccessHandler</span> customerAuthenticationSuccessHandler<span>;</span>
  <span>@Autowired</span>
  <span>private</span> <span>CustomerJwtAuthenticationTokenFilter</span> customerJwtAuthenticationTokenFilter<span>;</span>
  <span>@Autowired</span>
  <span>private</span> <span>CustomerRestAccessDeniedHandler</span> customerRestAccessDeniedHandler<span>;</span>
  <span>@Autowired</span>
  <span>private</span> <span>CustomerLogoutSuccessHandler</span> customerLogoutSuccessHandler<span>;</span>
  <span>@Autowired</span>
  <span>private</span> <span>CustomerAuthenticationEntryPoint</span> customerAuthenticationEntryPoint<span>;</span>


 
  <span>/**
   * 该方法定义认证用户信息获取的来源、密码校验的规则
   *
   * <span>@param</span> <span>auth</span>
   * <span>@throws</span> <span><span>Exception</span></span>
   */</span>
  <span>@Override</span>
  <span>protected</span> <span>void</span> <span>configure</span><span>(</span><span>AuthenticationManagerBuilder</span> auth<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
    <span>//auth.authenticationProvider(myauthenticationProvider)  自定义密码校验的规则</span>

    <span>//如果需要改变认证的用户信息来源，我们可以实现UserDetailsService</span>
    auth<span>.</span><span>userDetailsService</span><span>(</span>customerUserDetailService<span>)</span><span>.</span><span>passwordEncoder</span><span>(</span>passwordEncoder<span>)</span><span>;</span>
  <span>}</span>


  <span>@Override</span>
  <span>protected</span> <span>void</span> <span>configure</span><span>(</span><span>HttpSecurity</span> http<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
    <span>/**
     * antMatchers: ant的通配符规则
     * ?	匹配任何单字符
     * *	匹配0或者任意数量的字符，不包含"/"
     * **	匹配0或者更多的目录，包含"/"
     */</span>
    http
            <span>.</span><span>headers</span><span>(</span><span>)</span>
            <span>.</span><span>frameOptions</span><span>(</span><span>)</span><span>.</span><span>disable</span><span>(</span><span>)</span><span>;</span>

    http
            <span>//登录后,访问没有权限处理类</span>
            <span>.</span><span>exceptionHandling</span><span>(</span><span>)</span><span>.</span><span>accessDeniedHandler</span><span>(</span>customerRestAccessDeniedHandler<span>)</span>
            <span>//匿名访问,没有权限的处理类</span>
            <span>.</span><span>authenticationEntryPoint</span><span>(</span>customerAuthenticationEntryPoint<span>)</span>
    <span>;</span>

    <span>//使用jwt的Authentication,来解析过来的请求是否有token</span>
    http
            <span>.</span><span>addFilterBefore</span><span>(</span>customerJwtAuthenticationTokenFilter<span>,</span> <span>UsernamePasswordAuthenticationFilter</span><span>.</span><span>class</span><span>)</span><span>;</span>


    http
            <span>.</span><span>authorizeRequests</span><span>(</span><span>)</span>
            <span>//这里表示"/any"和"/ignore"不需要权限校验</span>
            <span>.</span><span>antMatchers</span><span>(</span><span>"/ignore/**"</span><span>,</span> <span>"/login"</span><span>,</span> <span>"/**/register/**"</span><span>)</span><span>.</span><span>permitAll</span><span>(</span><span>)</span>
            <span>.</span><span>anyRequest</span><span>(</span><span>)</span><span>.</span><span>authenticated</span><span>(</span><span>)</span>
            <span>// 这里表示任何请求都需要校验认证(上面配置的放行)</span>


            <span>.</span><span>and</span><span>(</span><span>)</span>
            <span>//配置登录,检测到用户未登录时跳转的url地址,登录放行</span>
            <span>.</span><span>formLogin</span><span>(</span><span>)</span>
            <span>//需要跟前端表单的action地址一致</span>
            <span>.</span><span>loginProcessingUrl</span><span>(</span><span>"/login"</span><span>)</span>
            <span>.</span><span>successHandler</span><span>(</span>customerAuthenticationSuccessHandler<span>)</span>
            <span>.</span><span>failureHandler</span><span>(</span>customerAuthenticationFailHandler<span>)</span>
            <span>.</span><span>permitAll</span><span>(</span><span>)</span>

            <span>//配置取消session管理,又Jwt来获取用户状态,否则即使token无效,也会有session信息,依旧判断用户为登录状态</span>
            <span>.</span><span>and</span><span>(</span><span>)</span>
            <span>.</span><span>sessionManagement</span><span>(</span><span>)</span><span>.</span><span>sessionCreationPolicy</span><span>(</span><span>SessionCreationPolicy</span><span>.</span>STATELESS<span>)</span>

            <span>//配置登出,登出放行</span>
            <span>.</span><span>and</span><span>(</span><span>)</span>
            <span>.</span><span>logout</span><span>(</span><span>)</span>
            <span>.</span><span>logoutSuccessHandler</span><span>(</span>customerLogoutSuccessHandler<span>)</span>
            <span>.</span><span>permitAll</span><span>(</span><span>)</span>
            
            <span>.</span><span>and</span><span>(</span><span>)</span>
            <span>.</span><span>csrf</span><span>(</span><span>)</span><span>.</span><span>disable</span><span>(</span><span>)</span>
    <span>;</span>
  <span>}</span>


<span>}</span>

<span>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="三、其他" tabindex="-1"> 三、其他</h2>
<p>大概到这就差不多了，启动，localhost:8080/login，使用postman，采用form-data，post提交，参数是username和password，调用，返回token。</p>
<p>将token放在header中，请求接口。ok</p>
<h3 id="_3-1-不足之处" tabindex="-1"> 3.1 不足之处</h3>
<p>上面是最简单的处理，还有很多优化的地方。比如</p>
<ol>
<li>控制token销毁？
使用redis+token组合，不仅解析token，还判断redis是否有这个token。注销和主动失效token：删除redis的key</li>
<li>控制token过期时间？如果用户在token过期前1秒还在操作，下1秒就需要重新登录，肯定不好
1、考虑加入refreshToken，过期时间比token长，前端在拿到token的同时获取过期时间，在过期前一分钟用refreshToken调用refresh接口，重新获取新的token。
2、 将返回的jwtToken设置短一点的过期时间，redis再存这个token，过期时间设置长一点。如果请求过来token过期，查询redis，如果redis还存在，返回新的token。（为什么redis的过期时间大于token的？因为redis的过期是可控的，手动可删除，以redis的为准）</li>
<li>每次请求都会被<code>OncePerRequestFilter</code> 拦截，每次都会被<code>UserDetailService</code>中的获取用户数据请求数据库，可以考虑做缓存，还是用redis或者直接保存内存中</li>
</ol>
<h3 id="_3-2-解决" tabindex="-1"> 3.2 解决</h3>
<blockquote>
<p>更新 2019-07-19</p>
</blockquote>
<p>这是针对上面的2.2说的，也就是redis时间久一点，jwt过期后如果redis没过期，颁发新的jwt。
不过更推荐的是<strong>前端判断过期时间，在过期之前调用refresh接口拿到新的jwt</strong>。</p>
<p>为什么这样？
如果redis过期时间是一周，jwt是一个小时，那么一个小时后，拿着这个过期的jwt去调，就可以想创建多少个新的jwt就创建，只要没过redis的过期时间。 当然这是在没对过期的jwt做限制的情况下，如果要考虑做限制，比如对redis的value加一个字段，保存当前jwt，刷新后就用新的jwt覆盖，refresh接口判断当前的过期jwt是不是和redis这个一样。</p>
<p>总之还需要判断刷新token的时候，过期jwt是否合法的问题。总不能去年的过期token也拿来刷新吧。
而在过期前去刷新token的话，至少不会发生这种事情</p>
<p>不过我这里自己写demo，采用的还是2.2的方式，也就是过期后给个新的，思路如下：</p>
<ol>
<li>登录后颁发token，token有个时间戳，同时以username拼装作为key，保存这个时间戳到缓存（redis，cache）</li>
<li>请求来了，过滤器解析token，没过期的话，还需要比较缓存中的时间戳和token的时间戳是不是一样 ，如果时间戳不一样，说明该token不能刷新。无视</li>
<li>注销，清除缓存数据</li>
</ol>
<p>这样就可以避免token过期后，我还能拿到这个token无限制的refresh。</p>
<p>不过这个还是有细节方面问题，并发下同时刷新token这些并没有考虑，部分代码如下</p>
<blockquote>
<p>旧版本, 最新在底部</p>
</blockquote>
<div><pre><code><span>package</span> <span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>auth<span>.</span>filter</span><span>;</span>

<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>common<span>.</span>constants<span>.</span></span><span>SecurityConstants</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>common<span>.</span>util<span>.</span>jwt<span>.</span></span><span>JwtTokenUtil</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>auth<span>.</span>user<span>.</span></span><span>CustomerUserDetailService</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>auth<span>.</span>user<span>.</span></span><span>CustomerUserDetails</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>auth<span>.</span>user<span>.</span></span><span>UserSessionService</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>auth<span>.</span>user<span>.</span></span><span>UserTokenManager</span></span><span>;</span>
<span>import</span> <span><span>io<span>.</span>jsonwebtoken<span>.</span></span><span>Claims</span></span><span>;</span>
<span>import</span> <span><span>io<span>.</span>jsonwebtoken<span>.</span></span><span>ExpiredJwtException</span></span><span>;</span>
<span>import</span> <span><span>lombok<span>.</span>extern<span>.</span>slf4j<span>.</span></span><span>Slf4j</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>beans<span>.</span>factory<span>.</span>annotation<span>.</span></span><span>Autowired</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>authentication<span>.</span></span><span>UsernamePasswordAuthenticationToken</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>core<span>.</span>context<span>.</span></span><span>SecurityContextHolder</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>web<span>.</span>authentication<span>.</span></span><span>WebAuthenticationDetailsSource</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>stereotype<span>.</span></span><span>Component</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>filter<span>.</span></span><span>OncePerRequestFilter</span></span><span>;</span>

<span>import</span> <span><span>javax<span>.</span>servlet<span>.</span></span><span>FilterChain</span></span><span>;</span>
<span>import</span> <span><span>javax<span>.</span>servlet<span>.</span></span><span>ServletException</span></span><span>;</span>
<span>import</span> <span><span>javax<span>.</span>servlet<span>.</span>http<span>.</span></span><span>HttpServletRequest</span></span><span>;</span>
<span>import</span> <span><span>javax<span>.</span>servlet<span>.</span>http<span>.</span></span><span>HttpServletResponse</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>IOException</span></span><span>;</span>

<span>/**
 * 过滤器,在请求过来的时候,解析请求头中的token,再解析token得到用户信息,再存到SecurityContextHolder中
 * <span>@author</span> zzzgd
 */</span>
<span>@Component</span>
<span>@Slf4j</span>
<span>public</span> <span>class</span> <span>CustomerJwtAuthenticationTokenFilter</span> <span>extends</span> <span>OncePerRequestFilter</span> <span>{</span>

    <span>@Autowired</span>
    <span>CustomerUserDetailService</span> customerUserDetailService<span>;</span>
    <span>@Autowired</span>
    <span>UserSessionService</span> userSessionService<span>;</span>
    <span>@Autowired</span>
    <span>UserTokenManager</span> userTokenManager<span>;</span>

    <span>@Override</span>
    <span>protected</span> <span>void</span> <span>doFilterInternal</span><span>(</span><span>HttpServletRequest</span> request<span>,</span> <span>HttpServletResponse</span> response<span>,</span> <span>FilterChain</span> chain<span>)</span> <span>throws</span> <span>ServletException</span><span>,</span> <span>IOException</span> <span>{</span>
        
    	<span>//请求头为 accessToken</span>
    	<span>//请求体为 Bearer token</span>

    	<span>String</span> authHeader <span>=</span> request<span>.</span><span>getHeader</span><span>(</span><span>SecurityConstants</span><span>.</span>HEADER<span>)</span><span>;</span>

        <span>if</span> <span>(</span>authHeader <span>!=</span> <span>null</span> <span>&amp;&amp;</span> authHeader<span>.</span><span>startsWith</span><span>(</span><span>SecurityConstants</span><span>.</span>TOKEN_SPLIT<span>)</span><span>)</span> <span>{</span>

            <span>final</span> <span>String</span> authToken <span>=</span> authHeader<span>.</span><span>substring</span><span>(</span><span>SecurityConstants</span><span>.</span>TOKEN_SPLIT<span>.</span><span>length</span><span>(</span><span>)</span><span>)</span><span>;</span>

            <span>String</span> username<span>;</span>
            <span>Claims</span> claims<span>;</span>
            <span>try</span> <span>{</span>
                claims <span>=</span> <span>JwtTokenUtil</span><span>.</span><span>parseToken</span><span>(</span>authToken<span>)</span><span>;</span>
                username <span>=</span> claims<span>.</span><span>getSubject</span><span>(</span><span>)</span><span>;</span>
            <span>}</span> <span>catch</span> <span>(</span><span>ExpiredJwtException</span> e<span>)</span> <span>{</span>
                <span>//token过期</span>
                claims <span>=</span> e<span>.</span><span>getClaims</span><span>(</span><span>)</span><span>;</span>
                username <span>=</span> claims<span>.</span><span>getSubject</span><span>(</span><span>)</span><span>;</span>
                <span>CustomerUserDetails</span> userDetails <span>=</span> userSessionService<span>.</span><span>getSessionByUsername</span><span>(</span>username<span>)</span><span>;</span>
                <span>if</span> <span>(</span>userDetails <span>!=</span> <span>null</span><span>)</span><span>{</span>
                    <span>//session未过期，比对时间戳是否一致，是则重新颁发token</span>
                    <span>if</span> <span>(</span><span>isSameTimestampToken</span><span>(</span>username<span>,</span>e<span>.</span><span>getClaims</span><span>(</span><span>)</span><span>)</span><span>)</span><span>{</span>
                        userTokenManager<span>.</span><span>awardAccessToken</span><span>(</span>userDetails<span>,</span><span>true</span><span>)</span><span>;</span>
                    <span>}</span>
                <span>}</span>
            <span>}</span>
            <span>//避免每次请求都请求数据库查询用户信息，从缓存中查询</span>
            <span>CustomerUserDetails</span> userDetails <span>=</span> userSessionService<span>.</span><span>getSessionByUsername</span><span>(</span>username<span>)</span><span>;</span>
            <span>if</span> <span>(</span>username <span>!=</span> <span>null</span> <span>&amp;&amp;</span> <span>SecurityContextHolder</span><span>.</span><span>getContext</span><span>(</span><span>)</span><span>.</span><span>getAuthentication</span><span>(</span><span>)</span> <span>==</span> <span>null</span><span>)</span> <span>{</span>
<span>//                UserDetails userDetails = customerUserDetailService.loadUserByUsername(username);</span>
                <span>if</span> <span>(</span>userDetails <span>!=</span> <span>null</span><span>)</span> <span>{</span>
                    <span>if</span><span>(</span><span>isSameTimestampToken</span><span>(</span>username<span>,</span>claims<span>)</span><span>)</span><span>{</span>
                        <span>//必须token解析的时间戳和session保存的一致</span>
                        <span>UsernamePasswordAuthenticationToken</span> authentication <span>=</span>
                                <span>new</span> <span>UsernamePasswordAuthenticationToken</span><span>(</span>userDetails<span>,</span> userDetails<span>.</span><span>getPassword</span><span>(</span><span>)</span><span>,</span> userDetails<span>.</span><span>getAuthorities</span><span>(</span><span>)</span><span>)</span><span>;</span>
                        authentication<span>.</span><span>setDetails</span><span>(</span><span>new</span> <span>WebAuthenticationDetailsSource</span><span>(</span><span>)</span><span>.</span><span>buildDetails</span><span>(</span>request<span>)</span><span>)</span><span>;</span>
                        <span>SecurityContextHolder</span><span>.</span><span>getContext</span><span>(</span><span>)</span><span>.</span><span>setAuthentication</span><span>(</span>authentication<span>)</span><span>;</span>
                    <span>}</span>
                <span>}</span>
            <span>}</span>
        <span>}</span>
        chain<span>.</span><span>doFilter</span><span>(</span>request<span>,</span> response<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 判断是否同一个时间戳
     * <span>@param</span> <span>username</span> 
     * <span>@param</span> <span>claims</span>
     * <span>@return</span>
     */</span>
    <span>private</span> <span>boolean</span> <span>isSameTimestampToken</span><span>(</span><span>String</span> username<span>,</span> <span>Claims</span> claims<span>)</span><span>{</span>
        <span>Long</span> timestamp <span>=</span> userSessionService<span>.</span><span>getTokenTimestamp</span><span>(</span>username<span>)</span><span>;</span>
        <span>Long</span> jwtTimestamp <span>=</span> <span>(</span><span>Long</span><span>)</span> claims<span>.</span><span>get</span><span>(</span><span>SecurityConstants</span><span>.</span>TIME_STAMP<span>)</span><span>;</span>
        <span>return</span> timestamp<span>.</span><span>equals</span><span>(</span>jwtTimestamp<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
<span>1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798</span>
<span>package</span> <span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>auth<span>.</span>user</span><span>;</span>

<span>import</span> <span><span>com<span>.</span>google<span>.</span>common<span>.</span>collect<span>.</span></span><span>Maps</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>common<span>.</span>constants<span>.</span></span><span>SecurityConstants</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>common<span>.</span>constants<span>.</span></span><span>UserConstants</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>common<span>.</span>util<span>.</span></span><span>ResponseUtil</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>common<span>.</span>util<span>.</span>jwt<span>.</span></span><span>JwtTokenUtil</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>core<span>.</span>result<span>.</span></span><span>ResultUtil</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>config<span>.</span>auth<span>.</span></span><span>UserAuthProperties</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>apache<span>.</span>commons<span>.</span>collections<span>.</span></span><span>MapUtils</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>checkerframework<span>.</span>checker<span>.</span>units<span>.</span>qual<span>.</span></span><span>A</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>beans<span>.</span>factory<span>.</span>annotation<span>.</span></span><span>Autowired</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>http<span>.</span></span><span>HttpStatus</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>stereotype<span>.</span></span><span>Component</span></span><span>;</span>

<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>HashMap</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>util<span>.</span></span><span>Map</span></span><span>;</span>

<span>/**
 * UserTokenManager
 * token管理
 *
 * <span>@author</span> zgd
 * <span>@date</span> 2019/7/19 15:25
 */</span>
<span>@Component</span>
<span>public</span> <span>class</span> <span>UserTokenManager</span> <span>{</span>

  <span>@Autowired</span>
  <span>private</span> <span>UserAuthProperties</span> userAuthProperties<span>;</span>
  <span>@Autowired</span>
  <span>private</span> <span>UserSessionService</span> userSessionService<span>;</span>

  <span>/**
   * 颁发token
   * <span>@param</span> <span>principal</span>
   * <span>@author</span> zgd
   * <span>@date</span> 2019/7/19 15:34
   * <span>@return</span> void
   */</span>
  <span>public</span> <span>void</span> <span>awardAccessToken</span><span>(</span><span>CustomerUserDetails</span> principal<span>,</span><span>boolean</span> isRefresh<span>)</span> <span>{</span>
    <span>//颁发token 确定时间戳，保存在session中和token中</span>
    <span>long</span> mill <span>=</span> <span>System</span><span>.</span><span>currentTimeMillis</span><span>(</span><span>)</span><span>;</span>
    userSessionService<span>.</span><span>saveSession</span><span>(</span>principal<span>)</span><span>;</span>
    userSessionService<span>.</span><span>saveTokenTimestamp</span><span>(</span>principal<span>.</span><span>getUsername</span><span>(</span><span>)</span><span>,</span>mill<span>)</span><span>;</span>

    <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span><span>Object</span><span>></span></span> param <span>=</span> <span>new</span> <span>HashMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>4</span><span>)</span><span>;</span>
    param<span>.</span><span>put</span><span>(</span><span>UserConstants</span><span>.</span>USER_ID<span>,</span>principal<span>.</span><span>getId</span><span>(</span><span>)</span><span>)</span><span>;</span>
    param<span>.</span><span>put</span><span>(</span><span>SecurityConstants</span><span>.</span>TIME_STAMP<span>,</span>mill<span>)</span><span>;</span>

    <span>String</span> token <span>=</span> <span>JwtTokenUtil</span><span>.</span><span>generateToken</span><span>(</span>principal<span>.</span><span>getUsername</span><span>(</span><span>)</span><span>,</span> param<span>,</span>userAuthProperties<span>.</span><span>getJwtExpirationTime</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>HashMap</span><span><span>&lt;</span><span>String</span><span>,</span> <span>String</span><span>></span></span> map <span>=</span> <span>Maps</span><span>.</span><span>newHashMapWithExpectedSize</span><span>(</span><span>1</span><span>)</span><span>;</span>
    map<span>.</span><span>put</span><span>(</span><span>SecurityConstants</span><span>.</span>HEADER<span>,</span>token<span>)</span><span>;</span>
    <span>int</span> code <span>=</span> isRefresh <span>?</span> <span>201</span> <span>:</span> <span>200</span><span>;</span>
    <span>ResponseUtil</span><span>.</span><span>outWithHeader</span><span>(</span>code<span>,</span><span>ResultUtil</span><span>.</span><span>success</span><span>(</span><span>)</span><span>,</span>map<span>)</span><span>;</span>
  <span>}</span>
<span>}</span>

<span>12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h5 id="更新" tabindex="-1"> 更新</h5>
<blockquote>
<p>2019-09-30</p>
</blockquote>
<p>针对token解析的过滤器做了优化:</p>
<ol>
<li>如果redis的session没过期, 但是请求头的token过期了, 判断时间戳一致后, 颁发新token并返回</li>
<li>如果redis的session没过期, 但是请求头的token过期了, 时间戳不一致, 说明当前请求的token无法刷新token, 设置响应码为401返回</li>
<li>如果请求头的token过期了, 但是redis的session失效或未找到, 直接放行, 交给后面的权限校验处理(也就是没有给上下文<code>SecurityContextHolder</code>设置登录信息, 后面如果判断这个请求缺少权限会自行处理)</li>
</ol>
<div><pre><code><span>package</span> <span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>auth<span>.</span>filter</span><span>;</span>

<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>common<span>.</span>constants<span>.</span></span><span>SecurityConstants</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>common<span>.</span>util<span>.</span></span><span>ResponseUtil</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>common<span>.</span>util<span>.</span>jwt<span>.</span></span><span>JwtTokenUtil</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>core<span>.</span>error<span>.</span></span><span>ErrorCodeConstants</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>core<span>.</span>result<span>.</span></span><span>ResultUtil</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>auth<span>.</span>user<span>.</span></span><span>CustomerUserDetailService</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>auth<span>.</span>user<span>.</span></span><span>CustomerUserDetails</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>auth<span>.</span>user<span>.</span></span><span>UserSessionService</span></span><span>;</span>
<span>import</span> <span><span>com<span>.</span>zgd<span>.</span>shop<span>.</span>web<span>.</span>auth<span>.</span>user<span>.</span></span><span>UserTokenManager</span></span><span>;</span>
<span>import</span> <span><span>io<span>.</span>jsonwebtoken<span>.</span></span><span>Claims</span></span><span>;</span>
<span>import</span> <span><span>io<span>.</span>jsonwebtoken<span>.</span></span><span>ExpiredJwtException</span></span><span>;</span>
<span>import</span> <span><span>lombok<span>.</span>extern<span>.</span>slf4j<span>.</span></span><span>Slf4j</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>beans<span>.</span>factory<span>.</span>annotation<span>.</span></span><span>Autowired</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>http<span>.</span></span><span>HttpStatus</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>authentication<span>.</span></span><span>UsernamePasswordAuthenticationToken</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>core<span>.</span>context<span>.</span></span><span>SecurityContextHolder</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>security<span>.</span>web<span>.</span>authentication<span>.</span></span><span>WebAuthenticationDetailsSource</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>stereotype<span>.</span></span><span>Component</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>web<span>.</span>filter<span>.</span></span><span>OncePerRequestFilter</span></span><span>;</span>

<span>import</span> <span><span>javax<span>.</span>servlet<span>.</span></span><span>FilterChain</span></span><span>;</span>
<span>import</span> <span><span>javax<span>.</span>servlet<span>.</span></span><span>ServletException</span></span><span>;</span>
<span>import</span> <span><span>javax<span>.</span>servlet<span>.</span>http<span>.</span></span><span>HttpServletRequest</span></span><span>;</span>
<span>import</span> <span><span>javax<span>.</span>servlet<span>.</span>http<span>.</span></span><span>HttpServletResponse</span></span><span>;</span>
<span>import</span> <span><span>java<span>.</span>io<span>.</span></span><span>IOException</span></span><span>;</span>

<span>/**
 * 过滤器,在请求过来的时候,解析请求头中的token,再解析token得到用户信息,再存到SecurityContextHolder中
 * <span>@author</span> zzzgd
 */</span>
<span>@Component</span>
<span>@Slf4j</span>
<span>public</span> <span>class</span> <span>CustomerJwtAuthenticationTokenFilter</span> <span>extends</span> <span>OncePerRequestFilter</span> <span>{</span>

    <span>@Autowired</span>
    <span>CustomerUserDetailService</span> customerUserDetailService<span>;</span>
    <span>@Autowired</span>
    <span>UserSessionService</span> userSessionService<span>;</span>
    <span>@Autowired</span>
    <span>UserTokenManager</span> userTokenManager<span>;</span>

    <span>@Override</span>
    <span>protected</span> <span>void</span> <span>doFilterInternal</span><span>(</span><span>HttpServletRequest</span> request<span>,</span> <span>HttpServletResponse</span> response<span>,</span> <span>FilterChain</span> chain<span>)</span> <span>throws</span> <span>ServletException</span><span>,</span> <span>IOException</span> <span>{</span>
        
    	<span>//请求头为 accessToken</span>
    	<span>//请求体为 Bearer token</span>

    	<span>String</span> authHeader <span>=</span> request<span>.</span><span>getHeader</span><span>(</span><span>SecurityConstants</span><span>.</span>HEADER<span>)</span><span>;</span>

        <span>if</span> <span>(</span>authHeader <span>!=</span> <span>null</span> <span>&amp;&amp;</span> authHeader<span>.</span><span>startsWith</span><span>(</span><span>SecurityConstants</span><span>.</span>TOKEN_SPLIT<span>)</span><span>)</span> <span>{</span>
            <span>//请求头有token</span>
            <span>final</span> <span>String</span> authToken <span>=</span> authHeader<span>.</span><span>substring</span><span>(</span><span>SecurityConstants</span><span>.</span>TOKEN_SPLIT<span>.</span><span>length</span><span>(</span><span>)</span><span>)</span><span>;</span>

            <span>String</span> username<span>;</span>
            <span>Claims</span> claims<span>;</span>
            <span>try</span> <span>{</span>
                claims <span>=</span> <span>JwtTokenUtil</span><span>.</span><span>parseToken</span><span>(</span>authToken<span>)</span><span>;</span>
                username <span>=</span> claims<span>.</span><span>getSubject</span><span>(</span><span>)</span><span>;</span>
            <span>}</span> <span>catch</span> <span>(</span><span>ExpiredJwtException</span> e<span>)</span> <span>{</span>
                <span>//token过期</span>
                claims <span>=</span> e<span>.</span><span>getClaims</span><span>(</span><span>)</span><span>;</span>
                username <span>=</span> claims<span>.</span><span>getSubject</span><span>(</span><span>)</span><span>;</span>
                <span>CustomerUserDetails</span> userDetails <span>=</span> userSessionService<span>.</span><span>getSessionByUsername</span><span>(</span>username<span>)</span><span>;</span>
                <span>if</span> <span>(</span>userDetails <span>!=</span> <span>null</span><span>)</span><span>{</span>
                    <span>//session未过期，比对时间戳是否一致，是则重新颁发token</span>
                    <span>if</span> <span>(</span><span>isSameTimestampToken</span><span>(</span>username<span>,</span>e<span>.</span><span>getClaims</span><span>(</span><span>)</span><span>)</span><span>)</span><span>{</span>
                        userTokenManager<span>.</span><span>awardAccessToken</span><span>(</span>userDetails<span>,</span><span>true</span><span>)</span><span>;</span>
                        <span>//直接设置响应码为201,直接返回</span>
                        <span>return</span><span>;</span>
                    <span>}</span><span>else</span><span>{</span>
                        <span>//时间戳不一致.无效token,无法刷新token,响应码401,前端跳转登录页</span>
                        <span>ResponseUtil</span><span>.</span><span>out</span><span>(</span><span>HttpStatus</span><span>.</span>UNAUTHORIZED<span>.</span><span>value</span><span>(</span><span>)</span><span>,</span><span>ResultUtil</span><span>.</span><span>failure</span><span>(</span><span>ErrorCodeConstants</span><span>.</span>REQUIRED_LOGIN_ERROR<span>)</span><span>)</span><span>;</span>
                        <span>return</span><span>;</span>
                    <span>}</span>
                <span>}</span><span>else</span><span>{</span>
                    <span>//直接放行,交给后面的handler处理,如果当前请求是需要访问权限,则会由CustomerRestAccessDeniedHandler处理</span>
                    chain<span>.</span><span>doFilter</span><span>(</span>request<span>,</span> response<span>)</span><span>;</span>
                    <span>return</span><span>;</span>
                <span>}</span>
            <span>}</span>

            <span>//避免每次请求都请求数据库查询用户信息，从缓存中查询</span>
            <span>CustomerUserDetails</span> userDetails <span>=</span> userSessionService<span>.</span><span>getSessionByUsername</span><span>(</span>username<span>)</span><span>;</span>
            <span>if</span> <span>(</span>username <span>!=</span> <span>null</span> <span>&amp;&amp;</span> <span>SecurityContextHolder</span><span>.</span><span>getContext</span><span>(</span><span>)</span><span>.</span><span>getAuthentication</span><span>(</span><span>)</span> <span>==</span> <span>null</span><span>)</span> <span>{</span>
<span>//                UserDetails userDetails = customerUserDetailService.loadUserByUsername(username);</span>
                <span>if</span> <span>(</span>userDetails <span>!=</span> <span>null</span><span>)</span> <span>{</span>
                    <span>if</span><span>(</span><span>isSameTimestampToken</span><span>(</span>username<span>,</span>claims<span>)</span><span>)</span><span>{</span>
                        <span>//必须token解析的时间戳和session保存的一致</span>
                        <span>UsernamePasswordAuthenticationToken</span> authentication <span>=</span>
                                <span>new</span> <span>UsernamePasswordAuthenticationToken</span><span>(</span>userDetails<span>,</span> userDetails<span>.</span><span>getPassword</span><span>(</span><span>)</span><span>,</span> userDetails<span>.</span><span>getAuthorities</span><span>(</span><span>)</span><span>)</span><span>;</span>
                        authentication<span>.</span><span>setDetails</span><span>(</span><span>new</span> <span>WebAuthenticationDetailsSource</span><span>(</span><span>)</span><span>.</span><span>buildDetails</span><span>(</span>request<span>)</span><span>)</span><span>;</span>

                        <span>SecurityContextHolder</span><span>.</span><span>getContext</span><span>(</span><span>)</span><span>.</span><span>setAuthentication</span><span>(</span>authentication<span>)</span><span>;</span>
                    <span>}</span>
                <span>}</span>
            <span>}</span>
        <span>}</span>
        chain<span>.</span><span>doFilter</span><span>(</span>request<span>,</span> response<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 判断是否同一个时间戳
     * <span>@param</span> <span>username</span>
     * <span>@param</span> <span>claims</span>
     * <span>@return</span>
     */</span>
    <span>private</span> <span>boolean</span> <span>isSameTimestampToken</span><span>(</span><span>String</span> username<span>,</span> <span>Claims</span> claims<span>)</span><span>{</span>
        <span>Long</span> timestamp <span>=</span> userSessionService<span>.</span><span>getTokenTimestamp</span><span>(</span>username<span>)</span><span>;</span>
        <span>Long</span> jwtTimestamp <span>=</span> <span>(</span><span>Long</span><span>)</span> claims<span>.</span><span>get</span><span>(</span><span>SecurityConstants</span><span>.</span>TIME_STAMP<span>)</span><span>;</span>
        <span>return</span> timestamp<span>.</span><span>equals</span><span>(</span>jwtTimestamp<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-02-13T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">SpringBoot中如何解决CORS跨域问题</title>
    <id>https://blog.ciberviler.top/dev/SpringBoot%E4%B8%AD%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3CORS%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringBoot%E4%B8%AD%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3CORS%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">SpringBoot中如何解决CORS跨域问题</summary>
    <content type="html"><![CDATA[<h1 id="springboot中如何解决cors跨域问题" tabindex="-1"> SpringBoot中如何解决CORS跨域问题</h1>
<p>CORS（Cross-Origin Resource Sharing）&quot;跨域资源共享&quot;，是一个W3C标准，它允许浏览器向跨域服务器发送Ajax请求，打破了Ajax只能访问本站内的资源限制。</p>
<p>在前后分离的架构下，我们经常会遇到跨域CORS问题，在浏览器上的表现就是出现如下一段错误提示：<code>No 'Access-Control-Allow-Origin' header is present on the requested resource.</code></p>
<p>下面看一下如何让你的SpringBoot项目支持CORS跨域。</p>
<h2 id="springboot处理跨域" tabindex="-1"> SpringBoot处理跨域</h2>
<p>在SpringBoot后端处理跨域比较简单，只需要在项目中添加如下一个配置类即可：</p>
<div><pre><code><span>/**
 * Spring Boot 2.0 解决跨域问题
 * @Author javadaily
 */</span>
<span>@Configuration</span>
<span>public</span> <span>class</span> <span>WebMvcConfiguration</span> <span>implements</span> <span>WebMvcConfigurer</span> <span>{</span>


 <span>@Bean</span>
 <span>public</span> <span>CorsFilter</span> <span>corsFilter</span><span>(</span><span>)</span> <span>{</span>
  <span>final</span> <span>UrlBasedCorsConfigurationSource</span> urlBasedCorsConfigurationSource <span>=</span> <span>new</span> <span>UrlBasedCorsConfigurationSource</span><span>(</span><span>)</span><span>;</span>
  <span>final</span> <span>CorsConfiguration</span> corsConfiguration <span>=</span> <span>new</span> <span>CorsConfiguration</span><span>(</span><span>)</span><span>;</span>
  <span>/* 是否允许请求带有验证信息 */</span>
  corsConfiguration<span>.</span><span>setAllowCredentials</span><span>(</span><span>true</span><span>)</span><span>;</span>
  <span>/* 允许访问的客户端域名 */</span>
  corsConfiguration<span>.</span><span>addAllowedOrigin</span><span>(</span><span>"*"</span><span>)</span><span>;</span>
  <span>/* 允许服务端访问的客户端请求头 */</span>
  corsConfiguration<span>.</span><span>addAllowedHeader</span><span>(</span><span>"*"</span><span>)</span><span>;</span>
  <span>/* 允许访问的方法名,GET POST等 */</span>
  corsConfiguration<span>.</span><span>addAllowedMethod</span><span>(</span><span>"*"</span><span>)</span><span>;</span>
  urlBasedCorsConfigurationSource<span>.</span><span>registerCorsConfiguration</span><span>(</span><span>"/**"</span><span>,</span> corsConfiguration<span>)</span><span>;</span>
  <span>return</span> <span>new</span> <span>CorsFilter</span><span>(</span>urlBasedCorsConfigurationSource<span>)</span><span>;</span>
 <span>}</span>

<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>这里我们在配置类中注入了 <code>CorsFilter</code>并重写了相关配置，大家可以根据自己的业务需求请里面的 * 改成具体的属性值。</p>
<p>通过上面的配置我们基本可以解决后端跨域问题，但是在一些特定情况下还是还出现跨域。</p>
<h2 id="特殊情况" tabindex="-1"> 特殊情况</h2>
<p>当项目中还有一个自定义过滤器，并且在过滤器中通过 <code>response.getWriter().print()</code>直接向客户端输出返回信息：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/PxMzT0Oibf4gmJSRJWiaelpqwkHDCNfzDh0mdnXvU2EXbqAibZtQFQCbE7GialfnN79o7o15eMgrwXXtkoKLg974NQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p>在这种情况下是不会继续执行后面的过滤器链的。</p>
<p><strong>而在SpringBoot中自定义过滤器的优先级高于WebMvcConfigurer中定义的过滤器</strong>，所以此时由于未经过CORS过滤器的处理还是会出现跨域现象。</p>
<p>这种时候我们就需要改写CorsFilter的写法，让其在自定义过滤器之前执行。</p>
<h3 id="解决方法" tabindex="-1"> 解决方法</h3>
<ul>
<li>自定义Cors过滤器</li>
</ul>
<div><pre><code><span>public</span> <span>class</span> <span>CustomerCorsFilter</span> <span>extends</span> <span>CorsFilter</span> <span>{</span>

    <span>public</span> <span>CustomerCorsFilter</span><span>(</span><span>)</span> <span>{</span>
        <span>super</span><span>(</span><span>configurationSource</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>}</span>

    <span>private</span> <span>static</span> <span>UrlBasedCorsConfigurationSource</span> <span>configurationSource</span><span>(</span><span>)</span> <span>{</span>
        <span>// CORS授权</span>
        <span>CorsConfiguration</span> config <span>=</span> <span>new</span> <span>CorsConfiguration</span><span>(</span><span>)</span><span>;</span>
        config<span>.</span><span>setAllowCredentials</span><span>(</span><span>true</span><span>)</span><span>;</span>
        config<span>.</span><span>addAllowedOrigin</span><span>(</span><span>"*"</span><span>)</span><span>;</span>
        config<span>.</span><span>addAllowedHeader</span><span>(</span><span>"*"</span><span>)</span><span>;</span>
        config<span>.</span><span>addAllowedMethod</span><span>(</span><span>"*"</span><span>)</span><span>;</span>
        config<span>.</span><span>addExposedHeader</span><span>(</span><span>HttpHeaders</span><span>.</span>SET_COOKIE<span>)</span><span>;</span>
        config<span>.</span><span>setMaxAge</span><span>(</span><span>3600L</span><span>)</span><span>;</span>
        <span>UrlBasedCorsConfigurationSource</span> source <span>=</span> <span>new</span> <span>UrlBasedCorsConfigurationSource</span><span>(</span><span>)</span><span>;</span>
        source<span>.</span><span>registerCorsConfiguration</span><span>(</span><span>"/**"</span><span>,</span> config<span>)</span><span>;</span>
                <span>return</span> source<span>;</span>
    <span>}</span>

<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>通过配置类指定过滤器的优先级</li>
</ul>
<div><pre><code><span>@Configuration</span>
<span>public</span> <span>class</span> <span>FilterConfig</span> <span>{</span>

    <span>@Bean</span>
    <span>public</span> <span>Filter</span> <span>authFilter</span><span>(</span><span>)</span><span>{</span>
        <span>return</span> <span>new</span> <span>AuthFilter</span><span>(</span><span>)</span><span>;</span>
    <span>}</span>


    <span>/**
     * WARNING ：跨域过滤器，注意执行顺序，必须要在AuthFilter过滤器之后
     * <span>@return</span>
     */</span>
    <span>@Bean</span>
    <span>public</span> <span>FilterRegistrationBean</span> <span>corsFilterRegistration</span><span>(</span><span>)</span> <span>{</span>

        <span>FilterRegistrationBean</span> registration <span>=</span> <span>new</span> <span>FilterRegistrationBean</span><span>(</span><span>)</span><span>;</span>
        <span>//添加过滤器</span>
        registration<span>.</span><span>setFilter</span><span>(</span><span>new</span> <span>CustomerCorsFilter</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> urlList <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
        urlList<span>.</span><span>add</span><span>(</span><span>"/*"</span><span>)</span><span>;</span>
        <span>//设置过滤路径，/*所有路径</span>
        registration<span>.</span><span>setUrlPatterns</span><span>(</span>urlList<span>)</span><span>;</span>
        <span>//添加默认参数</span>
        registration<span>.</span><span>setName</span><span>(</span><span>"CorsFilter"</span><span>)</span><span>;</span>
        <span>//设置优先级</span>
        registration<span>.</span><span>setOrder</span><span>(</span><span>-</span><span>1</span><span>)</span><span>;</span>
        <span>return</span> registration<span>;</span>
    <span>}</span>


    <span>@Bean</span>
    <span>public</span> <span>FilterRegistrationBean</span> <span>authFilterRegistration</span><span>(</span><span>)</span> <span>{</span>

        <span>FilterRegistrationBean</span> registration <span>=</span> <span>new</span> <span>FilterRegistrationBean</span><span>(</span><span>)</span><span>;</span>
        <span>//添加过滤器</span>
        registration<span>.</span><span>setFilter</span><span>(</span><span>authFilter</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> urlList <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
        urlList<span>.</span><span>add</span><span>(</span><span>"/*"</span><span>)</span><span>;</span>
        <span>//设置过滤路径，/*所有路径</span>
        registration<span>.</span><span>setUrlPatterns</span><span>(</span>urlList<span>)</span><span>;</span>
        <span>//添加默认参数</span>
        registration<span>.</span><span>setName</span><span>(</span><span>"authFilter"</span><span>)</span><span>;</span>
        <span>//设置优先级</span>
        registration<span>.</span><span>setOrder</span><span>(</span><span>1</span><span>)</span><span>;</span>
        <span>return</span> registration<span>;</span>
    <span>}</span>

<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>通过setOrder()方法指定过滤器的执行顺序，用以保证CORS过滤器先入自定义过滤器执行。<strong>注意：order的顺序越小优先级越高。</strong></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-07T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Spring Boot启动的时候默认的banner</title>
    <id>https://blog.ciberviler.top/dev/SpringBoot%E5%90%AF%E5%8A%A8banner.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringBoot%E5%90%AF%E5%8A%A8banner.html"/>
    <updated>2022-05-21T09:03:15.000Z</updated>
    <summary type="html">Spring Boot启动的时候默认的banner是spring的字样</summary>
    <content type="html"><![CDATA[<h1 id="spring-boot启动默认的banner" tabindex="-1"> Spring Boot启动默认的banner</h1>
<p>自定义banner只需要在resource下新建一个<code>banner.txt</code>文件，将我们需要的banner字样放进去，启动的时候就会去读取使用这个文本文件中的banner。</p>
<p><a href="./banner.txt">banner.txt</a></p>
<div><pre><code>                   _ooOoo_
                  o8888888o
                  88" . "88
                  (| -_- |)
                  O\  =  /O
               ____/`---'\____
             .'  \\|     |//  `.
            /  \\|||  :  |||//  \
           /  _||||| -:- |||||-  \
           |   | \\\  -  /// |   |
           | \_|  ''\---/''  |   |
           \  .-\__  `-`  ___/-. /
         ___`. .'  /--.--\  `. . __
      ."" '&lt;  `.___\_&lt;|>_/___.'  >'"".
     | | :  `- \`.;`\ _ /`;.`/ - ` : | |
     \  \ `-.   \_ __\ /__ _/   .-` /  /
======`-.____`-.___\_____/___.-`____.-'======
                   `=---='
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
         	佛祖保佑       永无BUG
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="控制banner样式" tabindex="-1"> 控制banner样式</h2>
<p>Spring提供了三个枚举类来设定字符的颜色，分别是：</p>
<p>AnsiColor： 用来设定字符的前景色</p>
<p>AnsiBackground： 用来设定字符的背景色</p>
<p>AnsiStyle： 用来控制加粗、斜体、下划线等等。</p>
<p>使用${AnsiFoo.Bar}来指定样式，当指定样式的时候会有提示的：</p>
<p><a href="http://alist.ciberviler.top/d/ecloud180/images/blogImage/784924-20170831000838452-507152231.png" target="_blank" rel="noopener noreferrer">image</a></p>
<p>指定一种试一下，比如下面这种：</p>
<div><pre><code>${AnsiColor.BRIGHT_YELLOW}
                   _ooOoo_
                  o8888888o
                  88" . "88
                  (| -_- |)
                  O\  =  /O
               ____/`---'\____
             .'  \\|     |//  `.
            /  \\|||  :  |||//  \
           /  _||||| -:- |||||-  \
           |   | \\\  -  /// |   |
           | \_|  ''\---/''  |   |
           \  .-\__  `-`  ___/-. /
         ___`. .'  /--.--\  `. . __
      ."" '&lt;  `.___\_&lt;|>_/___.'  >'"".
     | | :  `- \`.;`\ _ /`;.`/ - ` : | |
     \  \ `-.   \_ __\ /__ _/   .-` /  /
======`-.____`-.___\_____/___.-`____.-'======
                   `=---='
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
         佛祖保佑       永无BUG
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="显示应用信息" tabindex="-1"> 显示应用信息</h2>
<p>除了上面的指定样式之外，还可以显示一些与应用相关的版本信息：</p>
<p>${application.version}  与MANIFEST.MF文件中相同的版本号，比如1.5.4.RELEASE</p>
<p>${application.formatted-version}  格式化过的版本号就是加个v然后用括号包起来，比如(v1.5.4.RELEASE)</p>
<p>${application.title}</p>
<p>${spring-boot.version} Spring Boot的版本</p>
<p>${spring-boot.formatted-version} 格式化过的版本</p>
<h2 id="控制banner是否开启-输出位置" tabindex="-1"> 控制banner是否开启，输出位置</h2>
<p>设置banner mode为OFF关闭banner：</p>
<div><pre><code><span>package</span> <span>org<span>.</span>cc11001100</span><span>;</span>
 
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>boot<span>.</span></span><span>Banner</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>boot<span>.</span></span><span>SpringApplication</span></span><span>;</span>
<span>import</span> <span><span>org<span>.</span>springframework<span>.</span>boot<span>.</span>autoconfigure<span>.</span></span><span>SpringBootApplication</span></span><span>;</span>
 
<span>@SpringBootApplication</span>
<span>public</span> <span>class</span> <span>SpringBootStudy002Application</span> <span>{</span>
 
    <span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>
        <span>SpringApplication</span> springApplication <span>=</span> <span>new</span> <span>SpringApplication</span><span>(</span><span>SpringBootStudy002Application</span><span>.</span><span>class</span><span>)</span><span>;</span>
        springApplication<span>.</span><span>setBannerMode</span><span>(</span><span>Banner<span>.</span>Mode</span><span>.</span>OFF<span>)</span><span>;</span>
        springApplication<span>.</span><span>run</span><span>(</span>args<span>)</span><span>;</span>
    <span>}</span>
 
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="几个常用的字符画生成网站" tabindex="-1"> 几个常用的字符画生成网站</h2>
<p>介绍几个常用的字符画生成网站：</p>
<p><a href="https://www.bootschool.net/ascii" target="_blank" rel="noopener noreferrer">https://www.bootschool.net/ascii</a></p>
<p><a href="http://patorjk.com/software/taag/" target="_blank" rel="noopener noreferrer">http://patorjk.com/software/taag/</a></p>
<p><a href="https://spring-boot-banner-gen.cfapps.io/" target="_blank" rel="noopener noreferrer">https://spring-boot-banner-gen.cfapps.io/</a> 可以将上传图片转为文本形式的字符画，只是感觉风格比较鬼畜</p>
<p><a href="http://www.degraeve.com/img2txt.php" target="_blank" rel="noopener noreferrer">http://www.degraeve.com/img2txt.php</a> 可以根据在线的图片网址生成字符画，比如可以直接将公司logo的地址粘贴进去生成字符画</p>
<h2 id="补充" tabindex="-1"> 补充</h2>
<p>通过将 banner.txt 文件添加到类路径或将 spring.banner.location 属性设置为此类文件的位置，可以更改启动时打印的横幅。如果文件的编码不是UTF-8，则可以设置 spring.banner.charset 。除了文本文件，您还可以将 banner.gif ， banner.jpg 或 banner.png 图像文件添加到类路径或设置 spring.banner.image.location 属性。图像将转换为ASCII艺术表示，并打印在任何文本横幅上方。在 banner.txt 文件中，您可以使用以下任何占位符：</p>
<p>表23.1。横幅变量</p>
<p>变量 描述</p>
<p>${application.version} 应用程序的版本号，如 MANIFEST.MF 中声明的那样。例</p>
<p>如， Implementation-Version: 1.0 打印为 1.0 。</p>
<p>${application.formatted-version} 应用程序的版本号，在 MANIFEST.MF 中声明并格式化以显示（用括号括起来并以 v 为前缀）。例如 (v1.0) 。</p>
<p>${spring-boot.version} 您正在使用的Spring Boot版本。例如 2.1.1.RELEASE 。</p>
<p>如果要以编程方式生成横幅，可以使用 SpringApplication.setBanner(… ) 方法。使用 org.springframework.boot.Banner</p>
<p>接口并实现您自己的 printBanner() 方法。</p>
<p>您还可以使用 spring.main.banner-mode 属性来确定是否必须在 System.out （ console ）上打印横幅，发送到配置的记录器（ log ），或者根本不产生横幅（ off ）。</p>
<p>打印的横幅以下列名称注册为单身bean：springBootBanner 。</p>
<p>YAML将 off 映射到 false ，因此如果要在应用程序中禁用横幅，请务必添加引号，如以下示例所示：</p>
<p>spring:</p>
<p>main:</p>
<p>banner-mode: &quot;off&quot;</p>
<p>23.3自定义SpringApplication</p>
<p>如果 SpringApplication 默认值不符合您的口味，您可以改为创建本地实例并对其进行自定义。例如，要关闭横幅，您可以写：</p>
<div><pre><code><span>public</span> <span>static</span> <span>void</span> <span>main</span><span>(</span><span>String</span><span>[</span><span>]</span> args<span>)</span> <span>{</span>

<span>SpringApplication</span> app <span>=</span> <span>new</span> <span>SpringApplication</span><span>(</span><span>MySpringConfiguration</span><span>.</span><span>class</span><span>)</span><span>;</span>

app<span>.</span><span>setBannerMode</span><span>(</span><span>Banner<span>.</span>Mode</span><span>.</span>OFF<span>)</span><span>;</span>

app<span>.</span><span>run</span><span>(</span>args<span>)</span><span>;</span>

<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>传递给 SpringApplication 的构造函数参数是Spring beans的配置源。在大多数情况下，这些是对 @Configuration 类的引用，</p>
<p>但它们也可以是对XML配置或应扫描的包的引用。</p>
<p>也可以使用 application.properties 文件配置 SpringApplication 。有关详细信息，请参见第24章，外部化配置。</p>
<p>有关配置选项的完整列表，请参阅 SpringApplication Javadoc。</p>
<p>23.4 Fluent Builder API</p>
<p>如果您需要构建 ApplicationContext 层次结构（具有父/子关系的多个上下文）或者您更喜欢使用“流畅”构建器API，则可以使用 SpringApplicationBuilder 。</p>
<p>SpringApplicationBuilder 允许您将多个方法调用链接在一起，并包含允许您创建层次结构的 parent 和 child 方法，如以下示例所示：</p>
<div><pre><code><span>new</span> <span>SpringApplicationBuilder</span><span>(</span><span>)</span>

<span>.</span><span>sources</span><span>(</span><span>Parent</span><span>.</span><span>class</span><span>)</span>

<span>.</span><span>child</span><span>(</span><span>Application</span><span>.</span><span>class</span><span>)</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>创建 ApplicationContext 层次结构时存在一些限制。例如，Web组件必须包含在子上下文中，并且父/子上下文使用相同</p>
<p>的 Environment 。有关详细信息，请参阅 SpringApplicationBuilder Javadoc。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-03-02T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">SpringBoot定时任务动态管理</title>
    <id>https://blog.ciberviler.top/dev/SpringBoot%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%8A%A8%E6%80%81%E7%AE%A1%E7%90%86.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringBoot%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%8A%A8%E6%80%81%E7%AE%A1%E7%90%86.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">SpringBoot定时任务动态管理</summary>
    <content type="html"><![CDATA[<h1 id="springboot定时任务动态管理" tabindex="-1"> SpringBoot定时任务动态管理</h1>
<h2 id="一、功能说明" tabindex="-1"> <strong>一、功能说明</strong></h2>
<p>SpringBoot的定时任务的加强工具，实现对SpringBoot原生的定时任务进行动态管理,完全兼容原生@Scheduled注解,无需对原本的定时任务进行修改</p>
<h2 id="二、快速使用" tabindex="-1"> <strong>二、快速使用</strong></h2>
<p>具体的功能已经封装成SpringBoot-starter即插即用</p>
<div><pre><code>&lt;dependency>
    &lt;groupId>com.github.guoyixing&lt;/groupId>
    &lt;artifactId>spring-boot-starter-super-scheduled&lt;/artifactId>
    &lt;version>0.3.1&lt;/version>
&lt;/dependency>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>使用方法和源码：</p>
<blockquote>
<p>**码云：**<a href="https://gitee.com/qiaodaimadewangcai/super-scheduled" target="_blank" rel="noopener noreferrer">https://gitee.com/qiaodaimadewangcai/super-scheduled</a></p>
<p>**github：**<a href="https://github.com/guoyixing/super-scheduled" target="_blank" rel="noopener noreferrer">https://github.com/guoyixing/super-scheduled</a></p>
</blockquote>
<h2 id="三、实现原理" tabindex="-1"> <strong>三、实现原理</strong></h2>
<h4 id="_1、动态管理实现" tabindex="-1"> <strong>1、动态管理实现</strong></h4>
<p>(1) 配置管理介绍</p>
<div><pre><code>@Component("superScheduledConfig")
public class SuperScheduledConfig {
    /**
     * 执行定时任务的线程池
     */
    private ThreadPoolTaskScheduler taskScheduler;

    /**
     * 定时任务名称与定时任务回调钩子  的关联关系容器
     */
    private Map&lt;String, ScheduledFuture> nameToScheduledFuture = new ConcurrentHashMap&lt;>();

    /**
     * 定时任务名称与定时任务需要执行的逻辑  的关联关系容器
     */
    private Map&lt;String, Runnable> nameToRunnable = new ConcurrentHashMap&lt;>();

    /**
     * 定时任务名称与定时任务的源信息  的关联关系容器
     */
    private Map&lt;String, ScheduledSource> nameToScheduledSource = new ConcurrentHashMap&lt;>();
 /* 普通的get/sets省略 */
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>(2) 使用后处理器拦截SpringBoot原本的定时任务</p>
<ul>
<li>
<p>实现ApplicationContextAware接口拿到SpringBoot的上下文</p>
</li>
<li>
<p>实现BeanPostProcessor接口，将这个类标记为后处理器，后处理器会在每个bean实例化之后执行</p>
</li>
<li>
<p>使用@DependsOn注解强制依赖SuperScheduledConfig类，让SpringBoot实例化SuperScheduledPostProcessor类之前先实例化SuperScheduledConfig类</p>
</li>
<li>
<p>主要实现逻辑在postProcessAfterInitialization()方法中</p>
</li>
</ul>
<p><img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="图片" loading="lazy"></p>
<div><pre><code>@DependsOn({"superScheduledConfig"})
@Component
@Order
public class SuperScheduledPostProcessor implements BeanPostProcessor, ApplicationContextAware {
    protected final Log logger = LogFactory.getLog(getClass());

    private ApplicationContext applicationContext;

    /**
     * 实例化bean之前的操作
     * @param bean bean实例
     * @param beanName bean的Name
     */
    @Override
    public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {
        return bean;
    }

    /**
     * 实例化bean之后的操作
     * @param bean bean实例
     * @param beanName bean的Name
     */
    @Override
    public Object postProcessAfterInitialization(Object bean,
                                                 String beanName) throws BeansException {
        //1.获取配置管理器
        SuperScheduledConfig superScheduledConfig = applicationContext.getBean(SuperScheduledConfig.class);

        //2.获取当前实例化完成的bean的所有方法
        Method[] methods = bean.getClass().getDeclaredMethods();
        //循环处理对每个方法逐一处理
        if (methods.length > 0) {
            for (Method method : methods) {
             //3.尝试在该方法上获取@Scheduled注解（SpringBoot的定时任务注解）
                Scheduled annotation = method.getAnnotation(Scheduled.class);
                //如果无法获取到@Scheduled注解，就跳过这个方法
                if (annotation == null) {
                    continue;
                }
                //4.创建定时任务的源属性
                //创建定时任务的源属性（用来记录定时任务的配置，初始化的时候记录的是注解上原本的属性）
                ScheduledSource scheduledSource = new ScheduledSource(annotation, method, bean);
                //对注解上获取到源属性中的属性进行检测
                if (!scheduledSource.check()) {
                    throw new SuperScheduledException("在" + beanName + "Bean中" + method.getName() + "方法的注解参数错误");
                }
                //生成定时任务的名称（id），使用beanName+“.”+方法名
                String name = beanName + "." + method.getName();
                //将以key-value的形式，将源数据存入配置管理器中，key：定时任务的名称 value：源数据
                superScheduledConfig.addScheduledSource(name, scheduledSource);
                try {
                 //5.将原本SpringBoot的定时任务取消掉
                    clearOriginalScheduled(annotation);
                } catch (Exception e) {
                    throw new SuperScheduledException("在关闭原始方法" + beanName + method.getName() + "时出现错误");
                }
            }
        }
        //最后bean保持原有返回
        return bean;
    }

    /**
     * 修改注解原先的属性
     * @param annotation 注解实例对象
     * @throws Exception
     */
    private void clearOriginalScheduled(Scheduled annotation) throws Exception {
        changeAnnotationValue(annotation, "cron", Scheduled.CRON_DISABLED);
        changeAnnotationValue(annotation, "fixedDelay", -1L);
        changeAnnotationValue(annotation, "fixedDelayString", "");
        changeAnnotationValue(annotation, "fixedRate", -1L);
        changeAnnotationValue(annotation, "fixedRateString", "");
        changeAnnotationValue(annotation, "initialDelay", -1L);
        changeAnnotationValue(annotation, "initialDelayString", "");
    }


    /**
     * 获取SpringBoot的上下文
     * @param applicationContext SpringBoot的上下文
     */
    @Override
    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {
        this.applicationContext = applicationContext;
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>(3) 使用ApplicationRunner初始化自定义的定时任务运行器</p>
<ul>
<li>实现ApplicationContextAware接口拿到SpringBoot的上下文</li>
<li>使用@DependsOn注解强制依赖threadPoolTaskScheduler类</li>
<li>实现ApplicationRunner接口，在所有bean初始化结束之后，运行自定义逻辑</li>
<li>主要实现逻辑在run()方法中</li>
</ul>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/odp4zTVAogpHicXEISlz2It1lVzibw1E0jeh9cuzvwdIz5iaJvW8WJg4wvWVdIxxJuEYiaksjATDEFZKBlftCMMEXw/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<div><pre><code>@DependsOn("threadPoolTaskScheduler")
@Component
public class SuperScheduledApplicationRunner implements ApplicationRunner, ApplicationContextAware {
    protected final Log logger = LogFactory.getLog(getClass());
    private DateTimeFormatter df = DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss");
    private ApplicationContext applicationContext;
 
 /**
     * 定时任务配置管理器
     */
    @Autowired
    private SuperScheduledConfig superScheduledConfig;
    /**
     * 定时任务执行线程
     */
    @Autowired
    private ThreadPoolTaskScheduler threadPoolTaskScheduler;

    @Override
    public void run(ApplicationArguments args) {
     //1.定时任务配置管理器中缓存  定时任务执行线程
        superScheduledConfig.setTaskScheduler(threadPoolTaskScheduler);
        //2.获取所有定时任务源数据
        Map&lt;String, ScheduledSource> nameToScheduledSource = superScheduledConfig.getNameToScheduledSource();
        //逐一处理定时任务
        for (String name : nameToScheduledSource.keySet()) {
            //3.获取定时任务源数据
            ScheduledSource scheduledSource = nameToScheduledSource.get(name);
            //4.获取所有增强类
            String[] baseStrengthenBeanNames = applicationContext.getBeanNamesForType(BaseStrengthen.class);
            //5.创建执行控制器
            SuperScheduledRunnable runnable = new SuperScheduledRunnable();
            //配置执行控制器
            runnable.setMethod(scheduledSource.getMethod());
            runnable.setBean(scheduledSource.getBean());
            //6.逐一处理增强类（增强器实现原理后面具体分析）
            List&lt;Point> points = new ArrayList&lt;>(baseStrengthenBeanNames.length);
            for (String baseStrengthenBeanName : baseStrengthenBeanNames) {
             //7.将增强器代理成point
                Object baseStrengthenBean = applicationContext.getBean(baseStrengthenBeanName);
                //创建代理
                Point proxy = ProxyUtils.getInstance(Point.class, new RunnableBaseInterceptor(baseStrengthenBean, runnable));
                proxy.setSuperScheduledName(name);
                //8.所有的points连成起来
                points.add(proxy);
            }
   //将point形成调用链
            runnable.setChain(new Chain(points));
            //将执行逻辑封装并缓存到定时任务配置管理器中
            superScheduledConfig.addRunnable(name, runnable::invoke);
            try {
             //8.启动定时任务
                ScheduledFuture&lt;?> schedule = ScheduledFutureFactory.create(threadPoolTaskScheduler
                        , scheduledSource, runnable::invoke);
                //将线程回调钩子存到任务配置管理器中
                superScheduledConfig.addScheduledFuture(name, schedule);
                logger.info(df.format(LocalDateTime.now()) + "任务" + name + "已经启动...");

            } catch (Exception e) {
                throw new SuperScheduledException("任务" + name + "启动失败，错误信息：" + e.getLocalizedMessage());
            }
        }
    }

    @Override
    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {
        this.applicationContext = applicationContext;
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>(4) 进行动态管理</p>
<div><pre><code>@Component
public class SuperScheduledManager {
    protected final Log logger = LogFactory.getLog(getClass());
    private DateTimeFormatter df = DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss");

    @Autowired
    private SuperScheduledConfig superScheduledConfig;

    /**
     * 修改Scheduled的执行周期
     *
     * @param name scheduled的名称
     * @param cron cron表达式
     */
    public void setScheduledCron(String name, String cron) {
        //终止原先的任务
        cancelScheduled(name);
        //创建新的任务
        ScheduledSource scheduledSource = superScheduledConfig.getScheduledSource(name);
        scheduledSource.clear();
        scheduledSource.setCron(cron);
        addScheduled(name, scheduledSource);
    }

    /**
     * 修改Scheduled的fixedDelay
     *
     * @param name       scheduled的名称
     * @param fixedDelay 上一次执行完毕时间点之后多长时间再执行
     */
    public void setScheduledFixedDelay(String name, Long fixedDelay) {
        //终止原先的任务
        cancelScheduled(name);
        //创建新的任务
        ScheduledSource scheduledSource = superScheduledConfig.getScheduledSource(name);
        scheduledSource.clear();
        scheduledSource.setFixedDelay(fixedDelay);
        addScheduled(name, scheduledSource);
    }

    /**
     * 修改Scheduled的fixedRate
     *
     * @param name      scheduled的名称
     * @param fixedRate 上一次开始执行之后多长时间再执行
     */
    public void setScheduledFixedRate(String name, Long fixedRate) {
        //终止原先的任务
        cancelScheduled(name);
        //创建新的任务
        ScheduledSource scheduledSource = superScheduledConfig.getScheduledSource(name);
        scheduledSource.clear();
        scheduledSource.setFixedRate(fixedRate);
        addScheduled(name, scheduledSource);
    }

    /**
     * 查询所有启动的Scheduled
     */
    public List&lt;String> getRunScheduledName() {
        Set&lt;String> names = superScheduledConfig.getNameToScheduledFuture().keySet();
        return new ArrayList&lt;>(names);
    }

    /**
     * 查询所有的Scheduled
     */
    public List&lt;String> getAllSuperScheduledName() {
        Set&lt;String> names = superScheduledConfig.getNameToRunnable().keySet();
        return new ArrayList&lt;>(names);
    }

    /**
     * 终止Scheduled
     *
     * @param name scheduled的名称
     */
    public void cancelScheduled(String name) {
        ScheduledFuture scheduledFuture = superScheduledConfig.getScheduledFuture(name);
        scheduledFuture.cancel(true);
        superScheduledConfig.removeScheduledFuture(name);
        logger.info(df.format(LocalDateTime.now()) + "任务" + name + "已经终止...");
    }

    /**
     * 启动Scheduled
     *
     * @param name            scheduled的名称
     * @param scheduledSource 定时任务的源信息
     */
    public void addScheduled(String name, ScheduledSource scheduledSource) {
        if (getRunScheduledName().contains(name)) {
            throw new SuperScheduledException("定时任务" + name + "已经被启动过了");
        }
        if (!scheduledSource.check()) {
            throw new SuperScheduledException("定时任务" + name + "源数据内容错误");
        }

        scheduledSource.refreshType();

        Runnable runnable = superScheduledConfig.getRunnable(name);
        ThreadPoolTaskScheduler taskScheduler = superScheduledConfig.getTaskScheduler();


        ScheduledFuture&lt;?> schedule = ScheduledFutureFactory.create(taskScheduler, scheduledSource, runnable);
        logger.info(df.format(LocalDateTime.now()) + "任务" + name + "已经启动...");

        superScheduledConfig.addScheduledSource(name, scheduledSource);
        superScheduledConfig.addScheduledFuture(name, schedule);
    }

    /**
     * 以cron类型启动Scheduled
     *
     * @param name scheduled的名称
     * @param cron cron表达式
     */
    public void addCronScheduled(String name, String cron) {
        ScheduledSource scheduledSource = new ScheduledSource();
        scheduledSource.setCron(cron);

        addScheduled(name, scheduledSource);
    }

    /**
     * 以fixedDelay类型启动Scheduled
     *
     * @param name         scheduled的名称
     * @param fixedDelay   上一次执行完毕时间点之后多长时间再执行
     * @param initialDelay 第一次执行的延迟时间
     */
    public void addFixedDelayScheduled(String name, Long fixedDelay, Long... initialDelay) {
        ScheduledSource scheduledSource = new ScheduledSource();
        scheduledSource.setFixedDelay(fixedDelay);
        if (initialDelay != null &amp;&amp; initialDelay.length == 1) {
            scheduledSource.setInitialDelay(initialDelay[0]);
        } else if (initialDelay != null &amp;&amp; initialDelay.length > 1) {
            throw new SuperScheduledException("第一次执行的延迟时间只能传入一个参数");
        }

        addScheduled(name, scheduledSource);
    }

    /**
     * 以fixedRate类型启动Scheduled
     *
     * @param name         scheduled的名称
     * @param fixedRate    上一次开始执行之后多长时间再执行
     * @param initialDelay 第一次执行的延迟时间
     */
    public void addFixedRateScheduled(String name, Long fixedRate, Long... initialDelay) {
        ScheduledSource scheduledSource = new ScheduledSource();
        scheduledSource.setFixedRate(fixedRate);
        if (initialDelay != null &amp;&amp; initialDelay.length == 1) {
            scheduledSource.setInitialDelay(initialDelay[0]);
        } else if (initialDelay != null &amp;&amp; initialDelay.length > 1) {
            throw new SuperScheduledException("第一次执行的延迟时间只能传入一个参数");
        }

        addScheduled(name, scheduledSource);
    }

    /**
     * 手动执行一次任务
     *
     * @param name scheduled的名称
     */
    public void runScheduled(String name) {
        Runnable runnable = superScheduledConfig.getRunnable(name);
        runnable.run();
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_2、增强接口实现" tabindex="-1"> <strong>2、增强接口实现</strong></h4>
<p>增强器实现的整体思路与SpringAop的思路一致，实现没有Aop复杂</p>
<p>(1) 增强接口</p>
<div><pre><code>@Order(Ordered.HIGHEST_PRECEDENCE)
public interface BaseStrengthen {
    /**
     * 前置强化方法
     *
     * @param bean   bean实例（或者是被代理的bean）
     * @param method 执行的方法对象
     * @param args   方法参数
     */
    void before(Object bean, Method method, Object[] args);

    /**
     * 后置强化方法
     * 出现异常不会执行
     * 如果未出现异常，在afterFinally方法之后执行
     *
     * @param bean   bean实例（或者是被代理的bean）
     * @param method 执行的方法对象
     * @param args   方法参数
     */
    void after(Object bean, Method method, Object[] args);

    /**
     * 异常强化方法
     *
     * @param bean   bean实例（或者是被代理的bean）
     * @param method 执行的方法对象
     * @param args   方法参数
     */
    void exception(Object bean, Method method, Object[] args);

    /**
     * Finally强化方法，出现异常也会执行
     *
     * @param bean   bean实例（或者是被代理的bean）
     * @param method 执行的方法对象
     * @param args   方法参数
     */
    void afterFinally(Object bean, Method method, Object[] args);
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>(2) 代理抽象类</p>
<div><pre><code>public abstract class Point {
    /**
     * 定时任务名
     */
    private String superScheduledName;

    /**
     * 抽象的执行方法，使用代理实现
     * @param runnable 定时任务执行器
     */
    public abstract Object invoke(SuperScheduledRunnable runnable);
    
    /* 普通的get/sets省略 */
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>(3) 调用链类</p>
<div><pre><code>public class Chain {
    private List&lt;Point> list;
    private int index = -1;
    /**
     * 索引自增1
     */
    public int incIndex() {
        return ++index;
    }

    /**
     * 索引还原
     */
    public void resetIndex() {
        this.index = -1;
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>(4) cglib动态代理实现</p>
<p>使用cglib代理增强器，将增强器全部代理成调用链节点Point</p>
<div><pre><code>public class RunnableBaseInterceptor implements MethodInterceptor {
    /**
     * 定时任务执行器
     */
    private SuperScheduledRunnable runnable;
    /**
     * 定时任务增强类
     */
    private BaseStrengthen strengthen;

    @Override
    public Object intercept(Object obj, Method method, Object[] args, MethodProxy methodProxy) throws Throwable {
        Object result;
        //如果执行的是invoke()方法
        if ("invoke".equals(method.getName())) {
         //前置强化方法
            strengthen.before(obj, method, args);
            try {
             //调用执行器中的invoke()方法
                result = runnable.invoke();
            } catch (Exception e) {
             //异常强化方法
                strengthen.exception(obj, method, args);
                throw new SuperScheduledException(strengthen.getClass() + "中强化执行时发生错误", e);
            } finally {
             //Finally强化方法，出现异常也会执行
                strengthen.afterFinally(obj, method, args);
            }
            //后置强化方法
            strengthen.after(obj, method, args);

        } else {
         //直接执行方法
            result = methodProxy.invokeSuper(obj, args);
        }
        return result;
    }

    public RunnableBaseInterceptor(Object object, SuperScheduledRunnable runnable) {
        this.runnable = runnable;
        if (BaseStrengthen.class.isAssignableFrom(object.getClass())) {
            this.strengthen = (BaseStrengthen) object;
        } else {
            throw new SuperScheduledException(object.getClass() + "对象不是BaseStrengthen类型");
        }
    }

    public RunnableBaseInterceptor() {

    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>(5) 定时任务执行器实现</p>
<div><pre><code>public class SuperScheduledRunnable {
    /**
     * 原始的方法
     */
    private Method method;
    /**
     * 方法所在的bean
     */
    private Object bean;
    /**
     * 增强器的调用链
     */
    private Chain chain;


    public Object invoke() {
        Object result;
        //索引自增1
        if (chain.incIndex() == chain.getList().size()) {
            //调用链中的增强方法已经全部执行结束
            try {
                //调用链索引初始化
                chain.resetIndex();
                //增强器全部执行完毕，执行原本的方法
                result = method.invoke(bean);
            } catch (IllegalAccessException | InvocationTargetException e) {
                throw new SuperScheduledException(e.getLocalizedMessage());
            }
        } else {
            //获取被代理后的方法增强器
            Point point = chain.getList().get(chain.getIndex());
            //执行增强器代理
            //增强器代理中，会回调方法执行器，形成调用链，逐一运行调用链中的增强器
            result = point.invoke(this);
        }
        return result;
    }
    
    /* 普通的get/sets省略 */
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>(6) 增强器代理逻辑</p>
<p><code>com.gyx.superscheduled.core.SuperScheduledApplicationRunner</code>类中的代码片段</p>
<div><pre><code>//创建执行控制器
SuperScheduledRunnable runnable = new SuperScheduledRunnable();
runnable.setMethod(scheduledSource.getMethod());
runnable.setBean(scheduledSource.getBean());
//用来存放 增强器的代理对象
List&lt;Point> points = new ArrayList&lt;>(baseStrengthenBeanNames.length);
//循环所有的增强器的beanName
for (String baseStrengthenBeanName : baseStrengthenBeanNames) {
 //获取增强器的bean对象
    Object baseStrengthenBean = applicationContext.getBean(baseStrengthenBeanName);
    //将增强器代理成Point节点
    Point proxy = ProxyUtils.getInstance(Point.class, new RunnableBaseInterceptor(baseStrengthenBean, runnable));
    proxy.setSuperScheduledName(name);
    //增强器的代理对象缓存到list中
    points.add(proxy);
}
//将增强器代理实例的集合生成调用链
//执行控制器中设置调用链
runnable.setChain(new Chain(points));

</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-03-26T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">SpringBoot定时任务动态管理通用解决方案</title>
    <id>https://blog.ciberviler.top/dev/SpringBoot%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%8A%A8%E6%80%81%E7%AE%A1%E7%90%86%E9%80%9A%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringBoot%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%8A%A8%E6%80%81%E7%AE%A1%E7%90%86%E9%80%9A%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.html"/>
    <updated>2022-05-24T14:53:38.000Z</updated>
    <content type="html"><![CDATA[<h1 id="springboot定时任务动态管理通用解决方案" tabindex="-1"> SpringBoot定时任务动态管理通用解决方案</h1>
<h2 id="一、功能说明" tabindex="-1"> 一、功能说明</h2>
<p>SpringBoot的定时任务的加强工具，实现对SpringBoot原生的定时任务进行动态管理,完全兼容原生@Scheduled注解,无需对原本的定时任务进行修改</p>
<h2 id="二、快速使用" tabindex="-1"> 二、快速使用</h2>
<p>具体的功能已经封装成SpringBoot-starter即插即用</p>
<div><pre><code><span><span><span>&lt;</span>dependency</span><span>></span></span>
    <span><span><span>&lt;</span>groupId</span><span>></span></span>com.github.guoyixing<span><span><span>&lt;/</span>groupId</span><span>></span></span>
    <span><span><span>&lt;</span>artifactId</span><span>></span></span>spring-boot-starter-super-scheduled<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
    <span><span><span>&lt;</span>version</span><span>></span></span>0.3.1<span><span><span>&lt;/</span>version</span><span>></span></span>
<span><span><span>&lt;/</span>dependency</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>使用方法和源码：
码云：<a href="https://gitee.com/qiaodaimadewangcai/super-scheduled" target="_blank" rel="noopener noreferrer">https://gitee.com/qiaodaimadewangcai/super-scheduled</a>
github：<a href="https://github.com/guoyixing/super-scheduled/" target="_blank" rel="noopener noreferrer">https://github.com/guoyixing/super-scheduled</a></p>
<h2 id="三、实现原理" tabindex="-1"> 三、实现原理</h2>
<h3 id="_1、动态管理实现" tabindex="-1"> 1、动态管理实现</h3>
<h4 id="_1-配置管理介绍" tabindex="-1"> (1) 配置管理介绍</h4>
<div><pre><code><span>@Component</span><span>(</span><span>"superScheduledConfig"</span><span>)</span>
<span>public</span> <span>class</span> <span>SuperScheduledConfig</span> <span>{</span>
    <span>/**
     * 执行定时任务的线程池
     */</span>
    <span>private</span> <span>ThreadPoolTaskScheduler</span> taskScheduler<span>;</span>

    <span>/**
     * 定时任务名称与定时任务回调钩子  的关联关系容器
     */</span>
    <span>private</span> <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>ScheduledFuture</span><span>></span></span> nameToScheduledFuture <span>=</span> <span>new</span> <span>ConcurrentHashMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>

    <span>/**
     * 定时任务名称与定时任务需要执行的逻辑  的关联关系容器
     */</span>
    <span>private</span> <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Runnable</span><span>></span></span> nameToRunnable <span>=</span> <span>new</span> <span>ConcurrentHashMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>

    <span>/**
     * 定时任务名称与定时任务的源信息  的关联关系容器
     */</span>
    <span>private</span> <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>ScheduledSource</span><span>></span></span> nameToScheduledSource <span>=</span> <span>new</span> <span>ConcurrentHashMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
	<span>/* 普通的get/sets省略 */</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_2-使用后处理器拦截springboot原本的定时任务" tabindex="-1"> (2) 使用后处理器拦截SpringBoot原本的定时任务</h4>
<p>1、实现ApplicationContextAware接口拿到SpringBoot的上下文
2、实现BeanPostProcessor接口，将这个类标记为后处理器，后处理器会在每个bean实例化之后执行
3、使用@DependsOn注解强制依赖SuperScheduledConfig类，让SpringBoot实例化SuperScheduledPostProcessor类之前先实例化SuperScheduledConfig类
4、主要实现逻辑在postProcessAfterInitialization()方法中</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220524212320260.png" alt="image-20220524212320260" loading="lazy"></p>
<div><pre><code><span>@DependsOn</span><span>(</span><span>{</span><span>"superScheduledConfig"</span><span>}</span><span>)</span>
<span>@Component</span>
<span>@Order</span>
<span>public</span> <span>class</span> <span>SuperScheduledPostProcessor</span> <span>implements</span> <span>BeanPostProcessor</span><span>,</span> <span>ApplicationContextAware</span> <span>{</span>
    <span>protected</span> <span>final</span> <span>Log</span> logger <span>=</span> <span>LogFactory</span><span>.</span><span>getLog</span><span>(</span><span>getClass</span><span>(</span><span>)</span><span>)</span><span>;</span>

    <span>private</span> <span>ApplicationContext</span> applicationContext<span>;</span>

    <span>/**
     * 实例化bean之前的操作
     * <span>@param</span> <span>bean</span> bean实例
     * <span>@param</span> <span>beanName</span> bean的Name
     */</span>
    <span>@Override</span>
    <span>public</span> <span>Object</span> <span>postProcessBeforeInitialization</span><span>(</span><span>Object</span> bean<span>,</span> <span>String</span> beanName<span>)</span> <span>throws</span> <span>BeansException</span> <span>{</span>
        <span>return</span> bean<span>;</span>
    <span>}</span>

    <span>/**
     * 实例化bean之后的操作
     * <span>@param</span> <span>bean</span> bean实例
     * <span>@param</span> <span>beanName</span> bean的Name
     */</span>
    <span>@Override</span>
    <span>public</span> <span>Object</span> <span>postProcessAfterInitialization</span><span>(</span><span>Object</span> bean<span>,</span>
                                                 <span>String</span> beanName<span>)</span> <span>throws</span> <span>BeansException</span> <span>{</span>
        <span>//1.获取配置管理器</span>
        <span>SuperScheduledConfig</span> superScheduledConfig <span>=</span> applicationContext<span>.</span><span>getBean</span><span>(</span><span>SuperScheduledConfig</span><span>.</span><span>class</span><span>)</span><span>;</span>

        <span>//2.获取当前实例化完成的bean的所有方法</span>
        <span>Method</span><span>[</span><span>]</span> methods <span>=</span> bean<span>.</span><span>getClass</span><span>(</span><span>)</span><span>.</span><span>getDeclaredMethods</span><span>(</span><span>)</span><span>;</span>
        <span>//循环处理对每个方法逐一处理</span>
        <span>if</span> <span>(</span>methods<span>.</span>length <span>></span> <span>0</span><span>)</span> <span>{</span>
            <span>for</span> <span>(</span><span>Method</span> method <span>:</span> methods<span>)</span> <span>{</span>
            	<span>//3.尝试在该方法上获取@Scheduled注解（SpringBoot的定时任务注解）</span>
                <span>Scheduled</span> annotation <span>=</span> method<span>.</span><span>getAnnotation</span><span>(</span><span>Scheduled</span><span>.</span><span>class</span><span>)</span><span>;</span>
                <span>//如果无法获取到@Scheduled注解，就跳过这个方法</span>
                <span>if</span> <span>(</span>annotation <span>==</span> <span>null</span><span>)</span> <span>{</span>
                    <span>continue</span><span>;</span>
                <span>}</span>
                <span>//4.创建定时任务的源属性</span>
                <span>//创建定时任务的源属性（用来记录定时任务的配置，初始化的时候记录的是注解上原本的属性）</span>
                <span>ScheduledSource</span> scheduledSource <span>=</span> <span>new</span> <span>ScheduledSource</span><span>(</span>annotation<span>,</span> method<span>,</span> bean<span>)</span><span>;</span>
                <span>//对注解上获取到源属性中的属性进行检测</span>
                <span>if</span> <span>(</span><span>!</span>scheduledSource<span>.</span><span>check</span><span>(</span><span>)</span><span>)</span> <span>{</span>
                    <span>throw</span> <span>new</span> <span>SuperScheduledException</span><span>(</span><span>"在"</span> <span>+</span> beanName <span>+</span> <span>"Bean中"</span> <span>+</span> method<span>.</span><span>getName</span><span>(</span><span>)</span> <span>+</span> <span>"方法的注解参数错误"</span><span>)</span><span>;</span>
                <span>}</span>
                <span>//生成定时任务的名称（id），使用beanName+“.”+方法名</span>
                <span>String</span> name <span>=</span> beanName <span>+</span> <span>"."</span> <span>+</span> method<span>.</span><span>getName</span><span>(</span><span>)</span><span>;</span>
                <span>//将以key-value的形式，将源数据存入配置管理器中，key：定时任务的名称 value：源数据</span>
                superScheduledConfig<span>.</span><span>addScheduledSource</span><span>(</span>name<span>,</span> scheduledSource<span>)</span><span>;</span>
                <span>try</span> <span>{</span>
                	<span>//5.将原本SpringBoot的定时任务取消掉</span>
                    <span>clearOriginalScheduled</span><span>(</span>annotation<span>)</span><span>;</span>
                <span>}</span> <span>catch</span> <span>(</span><span>Exception</span> e<span>)</span> <span>{</span>
                    <span>throw</span> <span>new</span> <span>SuperScheduledException</span><span>(</span><span>"在关闭原始方法"</span> <span>+</span> beanName <span>+</span> method<span>.</span><span>getName</span><span>(</span><span>)</span> <span>+</span> <span>"时出现错误"</span><span>)</span><span>;</span>
                <span>}</span>
            <span>}</span>
        <span>}</span>
        <span>//最后bean保持原有返回</span>
        <span>return</span> bean<span>;</span>
    <span>}</span>

    <span>/**
     * 修改注解原先的属性
     * <span>@param</span> <span>annotation</span> 注解实例对象
     * <span>@throws</span> <span><span>Exception</span></span>
     */</span>
    <span>private</span> <span>void</span> <span>clearOriginalScheduled</span><span>(</span><span>Scheduled</span> annotation<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
        <span>changeAnnotationValue</span><span>(</span>annotation<span>,</span> <span>"cron"</span><span>,</span> <span>Scheduled</span><span>.</span>CRON_DISABLED<span>)</span><span>;</span>
        <span>changeAnnotationValue</span><span>(</span>annotation<span>,</span> <span>"fixedDelay"</span><span>,</span> <span>-</span><span>1L</span><span>)</span><span>;</span>
        <span>changeAnnotationValue</span><span>(</span>annotation<span>,</span> <span>"fixedDelayString"</span><span>,</span> <span>""</span><span>)</span><span>;</span>
        <span>changeAnnotationValue</span><span>(</span>annotation<span>,</span> <span>"fixedRate"</span><span>,</span> <span>-</span><span>1L</span><span>)</span><span>;</span>
        <span>changeAnnotationValue</span><span>(</span>annotation<span>,</span> <span>"fixedRateString"</span><span>,</span> <span>""</span><span>)</span><span>;</span>
        <span>changeAnnotationValue</span><span>(</span>annotation<span>,</span> <span>"initialDelay"</span><span>,</span> <span>-</span><span>1L</span><span>)</span><span>;</span>
        <span>changeAnnotationValue</span><span>(</span>annotation<span>,</span> <span>"initialDelayString"</span><span>,</span> <span>""</span><span>)</span><span>;</span>
    <span>}</span>


    <span>/**
     * 获取SpringBoot的上下文
     * <span>@param</span> <span>applicationContext</span> SpringBoot的上下文
     */</span>
    <span>@Override</span>
    <span>public</span> <span>void</span> <span>setApplicationContext</span><span>(</span><span>ApplicationContext</span> applicationContext<span>)</span> <span>throws</span> <span>BeansException</span> <span>{</span>
        <span>this</span><span>.</span>applicationContext <span>=</span> applicationContext<span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_3-使用applicationrunner初始化自定义的定时任务运行器" tabindex="-1"> (3) 使用ApplicationRunner初始化自定义的定时任务运行器</h4>
<p>1、实现ApplicationContextAware接口拿到SpringBoot的上下文
2、使用@DependsOn注解强制依赖threadPoolTaskScheduler类
3、实现ApplicationRunner接口，在所有bean初始化结束之后，运行自定义逻辑
4、主要实现逻辑在run()方法中</p>
<p><img src="http://alist.ciberviler.top/d/ecloud180/images/blogImage/image-20220524212339560.png" alt="image-20220524212339560" loading="lazy"></p>
<div><pre><code><span>@DependsOn</span><span>(</span><span>"threadPoolTaskScheduler"</span><span>)</span>
<span>@Component</span>
<span>public</span> <span>class</span> <span>SuperScheduledApplicationRunner</span> <span>implements</span> <span>ApplicationRunner</span><span>,</span> <span>ApplicationContextAware</span> <span>{</span>
    <span>protected</span> <span>final</span> <span>Log</span> logger <span>=</span> <span>LogFactory</span><span>.</span><span>getLog</span><span>(</span><span>getClass</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>private</span> <span>DateTimeFormatter</span> df <span>=</span> <span>DateTimeFormatter</span><span>.</span><span>ofPattern</span><span>(</span><span>"yyyy-MM-dd HH:mm:ss"</span><span>)</span><span>;</span>
    <span>private</span> <span>ApplicationContext</span> applicationContext<span>;</span>
	
	<span>/**
     * 定时任务配置管理器
     */</span>
    <span>@Autowired</span>
    <span>private</span> <span>SuperScheduledConfig</span> superScheduledConfig<span>;</span>
    <span>/**
     * 定时任务执行线程
     */</span>
    <span>@Autowired</span>
    <span>private</span> <span>ThreadPoolTaskScheduler</span> threadPoolTaskScheduler<span>;</span>

    <span>@Override</span>
    <span>public</span> <span>void</span> <span>run</span><span>(</span><span>ApplicationArguments</span> args<span>)</span> <span>{</span>
    	<span>//1.定时任务配置管理器中缓存  定时任务执行线程</span>
        superScheduledConfig<span>.</span><span>setTaskScheduler</span><span>(</span>threadPoolTaskScheduler<span>)</span><span>;</span>
        <span>//2.获取所有定时任务源数据</span>
        <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>ScheduledSource</span><span>></span></span> nameToScheduledSource <span>=</span> superScheduledConfig<span>.</span><span>getNameToScheduledSource</span><span>(</span><span>)</span><span>;</span>
        <span>//逐一处理定时任务</span>
        <span>for</span> <span>(</span><span>String</span> name <span>:</span> nameToScheduledSource<span>.</span><span>keySet</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>//3.获取定时任务源数据</span>
            <span>ScheduledSource</span> scheduledSource <span>=</span> nameToScheduledSource<span>.</span><span>get</span><span>(</span>name<span>)</span><span>;</span>
            <span>//4.获取所有增强类</span>
            <span>String</span><span>[</span><span>]</span> baseStrengthenBeanNames <span>=</span> applicationContext<span>.</span><span>getBeanNamesForType</span><span>(</span><span>BaseStrengthen</span><span>.</span><span>class</span><span>)</span><span>;</span>
            <span>//5.创建执行控制器</span>
            <span>SuperScheduledRunnable</span> runnable <span>=</span> <span>new</span> <span>SuperScheduledRunnable</span><span>(</span><span>)</span><span>;</span>
            <span>//配置执行控制器</span>
            runnable<span>.</span><span>setMethod</span><span>(</span>scheduledSource<span>.</span><span>getMethod</span><span>(</span><span>)</span><span>)</span><span>;</span>
            runnable<span>.</span><span>setBean</span><span>(</span>scheduledSource<span>.</span><span>getBean</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>//6.逐一处理增强类（增强器实现原理后面具体分析）</span>
            <span>List</span><span><span>&lt;</span><span>Point</span><span>></span></span> points <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span>baseStrengthenBeanNames<span>.</span>length<span>)</span><span>;</span>
            <span>for</span> <span>(</span><span>String</span> baseStrengthenBeanName <span>:</span> baseStrengthenBeanNames<span>)</span> <span>{</span>
            	<span>//7.将增强器代理成point</span>
                <span>Object</span> baseStrengthenBean <span>=</span> applicationContext<span>.</span><span>getBean</span><span>(</span>baseStrengthenBeanName<span>)</span><span>;</span>
                <span>//创建代理</span>
                <span>Point</span> proxy <span>=</span> <span>ProxyUtils</span><span>.</span><span>getInstance</span><span>(</span><span>Point</span><span>.</span><span>class</span><span>,</span> <span>new</span> <span>RunnableBaseInterceptor</span><span>(</span>baseStrengthenBean<span>,</span> runnable<span>)</span><span>)</span><span>;</span>
                proxy<span>.</span><span>setSuperScheduledName</span><span>(</span>name<span>)</span><span>;</span>
                <span>//8.所有的points连成起来</span>
                points<span>.</span><span>add</span><span>(</span>proxy<span>)</span><span>;</span>
            <span>}</span>
			<span>//将point形成调用链</span>
            runnable<span>.</span><span>setChain</span><span>(</span><span>new</span> <span>Chain</span><span>(</span>points<span>)</span><span>)</span><span>;</span>
            <span>//将执行逻辑封装并缓存到定时任务配置管理器中</span>
            superScheduledConfig<span>.</span><span>addRunnable</span><span>(</span>name<span>,</span> runnable<span>::</span><span>invoke</span><span>)</span><span>;</span>
            <span>try</span> <span>{</span>
            	<span>//8.启动定时任务</span>
                <span>ScheduledFuture</span><span><span>&lt;</span><span>?</span><span>></span></span> schedule <span>=</span> <span>ScheduledFutureFactory</span><span>.</span><span>create</span><span>(</span>threadPoolTaskScheduler
                        <span>,</span> scheduledSource<span>,</span> runnable<span>::</span><span>invoke</span><span>)</span><span>;</span>
                <span>//将线程回调钩子存到任务配置管理器中</span>
                superScheduledConfig<span>.</span><span>addScheduledFuture</span><span>(</span>name<span>,</span> schedule<span>)</span><span>;</span>
                logger<span>.</span><span>info</span><span>(</span>df<span>.</span><span>format</span><span>(</span><span>LocalDateTime</span><span>.</span><span>now</span><span>(</span><span>)</span><span>)</span> <span>+</span> <span>"任务"</span> <span>+</span> name <span>+</span> <span>"已经启动..."</span><span>)</span><span>;</span>

            <span>}</span> <span>catch</span> <span>(</span><span>Exception</span> e<span>)</span> <span>{</span>
                <span>throw</span> <span>new</span> <span>SuperScheduledException</span><span>(</span><span>"任务"</span> <span>+</span> name <span>+</span> <span>"启动失败，错误信息："</span> <span>+</span> e<span>.</span><span>getLocalizedMessage</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>

    <span>@Override</span>
    <span>public</span> <span>void</span> <span>setApplicationContext</span><span>(</span><span>ApplicationContext</span> applicationContext<span>)</span> <span>throws</span> <span>BeansException</span> <span>{</span>
        <span>this</span><span>.</span>applicationContext <span>=</span> applicationContext<span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_4-进行动态管理" tabindex="-1"> (4) 进行动态管理</h4>
<div><pre><code><span>@Component</span>
<span>public</span> <span>class</span> <span>SuperScheduledManager</span> <span>{</span>
    <span>protected</span> <span>final</span> <span>Log</span> logger <span>=</span> <span>LogFactory</span><span>.</span><span>getLog</span><span>(</span><span>getClass</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>private</span> <span>DateTimeFormatter</span> df <span>=</span> <span>DateTimeFormatter</span><span>.</span><span>ofPattern</span><span>(</span><span>"yyyy-MM-dd HH:mm:ss"</span><span>)</span><span>;</span>

    <span>@Autowired</span>
    <span>private</span> <span>SuperScheduledConfig</span> superScheduledConfig<span>;</span>

    <span>/**
     * 修改Scheduled的执行周期
     *
     * <span>@param</span> <span>name</span> scheduled的名称
     * <span>@param</span> <span>cron</span> cron表达式
     */</span>
    <span>public</span> <span>void</span> <span>setScheduledCron</span><span>(</span><span>String</span> name<span>,</span> <span>String</span> cron<span>)</span> <span>{</span>
        <span>//终止原先的任务</span>
        <span>cancelScheduled</span><span>(</span>name<span>)</span><span>;</span>
        <span>//创建新的任务</span>
        <span>ScheduledSource</span> scheduledSource <span>=</span> superScheduledConfig<span>.</span><span>getScheduledSource</span><span>(</span>name<span>)</span><span>;</span>
        scheduledSource<span>.</span><span>clear</span><span>(</span><span>)</span><span>;</span>
        scheduledSource<span>.</span><span>setCron</span><span>(</span>cron<span>)</span><span>;</span>
        <span>addScheduled</span><span>(</span>name<span>,</span> scheduledSource<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 修改Scheduled的fixedDelay
     *
     * <span>@param</span> <span>name</span>       scheduled的名称
     * <span>@param</span> <span>fixedDelay</span> 上一次执行完毕时间点之后多长时间再执行
     */</span>
    <span>public</span> <span>void</span> <span>setScheduledFixedDelay</span><span>(</span><span>String</span> name<span>,</span> <span>Long</span> fixedDelay<span>)</span> <span>{</span>
        <span>//终止原先的任务</span>
        <span>cancelScheduled</span><span>(</span>name<span>)</span><span>;</span>
        <span>//创建新的任务</span>
        <span>ScheduledSource</span> scheduledSource <span>=</span> superScheduledConfig<span>.</span><span>getScheduledSource</span><span>(</span>name<span>)</span><span>;</span>
        scheduledSource<span>.</span><span>clear</span><span>(</span><span>)</span><span>;</span>
        scheduledSource<span>.</span><span>setFixedDelay</span><span>(</span>fixedDelay<span>)</span><span>;</span>
        <span>addScheduled</span><span>(</span>name<span>,</span> scheduledSource<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 修改Scheduled的fixedRate
     *
     * <span>@param</span> <span>name</span>      scheduled的名称
     * <span>@param</span> <span>fixedRate</span> 上一次开始执行之后多长时间再执行
     */</span>
    <span>public</span> <span>void</span> <span>setScheduledFixedRate</span><span>(</span><span>String</span> name<span>,</span> <span>Long</span> fixedRate<span>)</span> <span>{</span>
        <span>//终止原先的任务</span>
        <span>cancelScheduled</span><span>(</span>name<span>)</span><span>;</span>
        <span>//创建新的任务</span>
        <span>ScheduledSource</span> scheduledSource <span>=</span> superScheduledConfig<span>.</span><span>getScheduledSource</span><span>(</span>name<span>)</span><span>;</span>
        scheduledSource<span>.</span><span>clear</span><span>(</span><span>)</span><span>;</span>
        scheduledSource<span>.</span><span>setFixedRate</span><span>(</span>fixedRate<span>)</span><span>;</span>
        <span>addScheduled</span><span>(</span>name<span>,</span> scheduledSource<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 查询所有启动的Scheduled
     */</span>
    <span>public</span> <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> <span>getRunScheduledName</span><span>(</span><span>)</span> <span>{</span>
        <span>Set</span><span><span>&lt;</span><span>String</span><span>></span></span> names <span>=</span> superScheduledConfig<span>.</span><span>getNameToScheduledFuture</span><span>(</span><span>)</span><span>.</span><span>keySet</span><span>(</span><span>)</span><span>;</span>
        <span>return</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span>names<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 查询所有的Scheduled
     */</span>
    <span>public</span> <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> <span>getAllSuperScheduledName</span><span>(</span><span>)</span> <span>{</span>
        <span>Set</span><span><span>&lt;</span><span>String</span><span>></span></span> names <span>=</span> superScheduledConfig<span>.</span><span>getNameToRunnable</span><span>(</span><span>)</span><span>.</span><span>keySet</span><span>(</span><span>)</span><span>;</span>
        <span>return</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span>names<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 终止Scheduled
     *
     * <span>@param</span> <span>name</span> scheduled的名称
     */</span>
    <span>public</span> <span>void</span> <span>cancelScheduled</span><span>(</span><span>String</span> name<span>)</span> <span>{</span>
        <span>ScheduledFuture</span> scheduledFuture <span>=</span> superScheduledConfig<span>.</span><span>getScheduledFuture</span><span>(</span>name<span>)</span><span>;</span>
        scheduledFuture<span>.</span><span>cancel</span><span>(</span><span>true</span><span>)</span><span>;</span>
        superScheduledConfig<span>.</span><span>removeScheduledFuture</span><span>(</span>name<span>)</span><span>;</span>
        logger<span>.</span><span>info</span><span>(</span>df<span>.</span><span>format</span><span>(</span><span>LocalDateTime</span><span>.</span><span>now</span><span>(</span><span>)</span><span>)</span> <span>+</span> <span>"任务"</span> <span>+</span> name <span>+</span> <span>"已经终止..."</span><span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 启动Scheduled
     *
     * <span>@param</span> <span>name</span>            scheduled的名称
     * <span>@param</span> <span>scheduledSource</span> 定时任务的源信息
     */</span>
    <span>public</span> <span>void</span> <span>addScheduled</span><span>(</span><span>String</span> name<span>,</span> <span>ScheduledSource</span> scheduledSource<span>)</span> <span>{</span>
        <span>if</span> <span>(</span><span>getRunScheduledName</span><span>(</span><span>)</span><span>.</span><span>contains</span><span>(</span>name<span>)</span><span>)</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>SuperScheduledException</span><span>(</span><span>"定时任务"</span> <span>+</span> name <span>+</span> <span>"已经被启动过了"</span><span>)</span><span>;</span>
        <span>}</span>
        <span>if</span> <span>(</span><span>!</span>scheduledSource<span>.</span><span>check</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>SuperScheduledException</span><span>(</span><span>"定时任务"</span> <span>+</span> name <span>+</span> <span>"源数据内容错误"</span><span>)</span><span>;</span>
        <span>}</span>

        scheduledSource<span>.</span><span>refreshType</span><span>(</span><span>)</span><span>;</span>

        <span>Runnable</span> runnable <span>=</span> superScheduledConfig<span>.</span><span>getRunnable</span><span>(</span>name<span>)</span><span>;</span>
        <span>ThreadPoolTaskScheduler</span> taskScheduler <span>=</span> superScheduledConfig<span>.</span><span>getTaskScheduler</span><span>(</span><span>)</span><span>;</span>


        <span>ScheduledFuture</span><span><span>&lt;</span><span>?</span><span>></span></span> schedule <span>=</span> <span>ScheduledFutureFactory</span><span>.</span><span>create</span><span>(</span>taskScheduler<span>,</span> scheduledSource<span>,</span> runnable<span>)</span><span>;</span>
        logger<span>.</span><span>info</span><span>(</span>df<span>.</span><span>format</span><span>(</span><span>LocalDateTime</span><span>.</span><span>now</span><span>(</span><span>)</span><span>)</span> <span>+</span> <span>"任务"</span> <span>+</span> name <span>+</span> <span>"已经启动..."</span><span>)</span><span>;</span>

        superScheduledConfig<span>.</span><span>addScheduledSource</span><span>(</span>name<span>,</span> scheduledSource<span>)</span><span>;</span>
        superScheduledConfig<span>.</span><span>addScheduledFuture</span><span>(</span>name<span>,</span> schedule<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 以cron类型启动Scheduled
     *
     * <span>@param</span> <span>name</span> scheduled的名称
     * <span>@param</span> <span>cron</span> cron表达式
     */</span>
    <span>public</span> <span>void</span> <span>addCronScheduled</span><span>(</span><span>String</span> name<span>,</span> <span>String</span> cron<span>)</span> <span>{</span>
        <span>ScheduledSource</span> scheduledSource <span>=</span> <span>new</span> <span>ScheduledSource</span><span>(</span><span>)</span><span>;</span>
        scheduledSource<span>.</span><span>setCron</span><span>(</span>cron<span>)</span><span>;</span>

        <span>addScheduled</span><span>(</span>name<span>,</span> scheduledSource<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 以fixedDelay类型启动Scheduled
     *
     * <span>@param</span> <span>name</span>         scheduled的名称
     * <span>@param</span> <span>fixedDelay</span>   上一次执行完毕时间点之后多长时间再执行
     * <span>@param</span> <span>initialDelay</span> 第一次执行的延迟时间
     */</span>
    <span>public</span> <span>void</span> <span>addFixedDelayScheduled</span><span>(</span><span>String</span> name<span>,</span> <span>Long</span> fixedDelay<span>,</span> <span>Long</span><span>.</span><span>.</span><span>.</span> initialDelay<span>)</span> <span>{</span>
        <span>ScheduledSource</span> scheduledSource <span>=</span> <span>new</span> <span>ScheduledSource</span><span>(</span><span>)</span><span>;</span>
        scheduledSource<span>.</span><span>setFixedDelay</span><span>(</span>fixedDelay<span>)</span><span>;</span>
        <span>if</span> <span>(</span>initialDelay <span>!=</span> <span>null</span> <span>&amp;&amp;</span> initialDelay<span>.</span>length <span>==</span> <span>1</span><span>)</span> <span>{</span>
            scheduledSource<span>.</span><span>setInitialDelay</span><span>(</span>initialDelay<span>[</span><span>0</span><span>]</span><span>)</span><span>;</span>
        <span>}</span> <span>else</span> <span>if</span> <span>(</span>initialDelay <span>!=</span> <span>null</span> <span>&amp;&amp;</span> initialDelay<span>.</span>length <span>></span> <span>1</span><span>)</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>SuperScheduledException</span><span>(</span><span>"第一次执行的延迟时间只能传入一个参数"</span><span>)</span><span>;</span>
        <span>}</span>

        <span>addScheduled</span><span>(</span>name<span>,</span> scheduledSource<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 以fixedRate类型启动Scheduled
     *
     * <span>@param</span> <span>name</span>         scheduled的名称
     * <span>@param</span> <span>fixedRate</span>    上一次开始执行之后多长时间再执行
     * <span>@param</span> <span>initialDelay</span> 第一次执行的延迟时间
     */</span>
    <span>public</span> <span>void</span> <span>addFixedRateScheduled</span><span>(</span><span>String</span> name<span>,</span> <span>Long</span> fixedRate<span>,</span> <span>Long</span><span>.</span><span>.</span><span>.</span> initialDelay<span>)</span> <span>{</span>
        <span>ScheduledSource</span> scheduledSource <span>=</span> <span>new</span> <span>ScheduledSource</span><span>(</span><span>)</span><span>;</span>
        scheduledSource<span>.</span><span>setFixedRate</span><span>(</span>fixedRate<span>)</span><span>;</span>
        <span>if</span> <span>(</span>initialDelay <span>!=</span> <span>null</span> <span>&amp;&amp;</span> initialDelay<span>.</span>length <span>==</span> <span>1</span><span>)</span> <span>{</span>
            scheduledSource<span>.</span><span>setInitialDelay</span><span>(</span>initialDelay<span>[</span><span>0</span><span>]</span><span>)</span><span>;</span>
        <span>}</span> <span>else</span> <span>if</span> <span>(</span>initialDelay <span>!=</span> <span>null</span> <span>&amp;&amp;</span> initialDelay<span>.</span>length <span>></span> <span>1</span><span>)</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>SuperScheduledException</span><span>(</span><span>"第一次执行的延迟时间只能传入一个参数"</span><span>)</span><span>;</span>
        <span>}</span>

        <span>addScheduled</span><span>(</span>name<span>,</span> scheduledSource<span>)</span><span>;</span>
    <span>}</span>

    <span>/**
     * 手动执行一次任务
     *
     * <span>@param</span> <span>name</span> scheduled的名称
     */</span>
    <span>public</span> <span>void</span> <span>runScheduled</span><span>(</span><span>String</span> name<span>)</span> <span>{</span>
        <span>Runnable</span> runnable <span>=</span> superScheduledConfig<span>.</span><span>getRunnable</span><span>(</span>name<span>)</span><span>;</span>
        runnable<span>.</span><span>run</span><span>(</span><span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_2、增强接口实现" tabindex="-1"> 2、增强接口实现</h3>
<p>增强器实现的整体思路与SpringAop的思路一致，实现没有Aop复杂</p>
<h4 id="_1-增强接口" tabindex="-1"> (1) 增强接口</h4>
<div><pre><code><span>@Order</span><span>(</span><span>Ordered</span><span>.</span>HIGHEST_PRECEDENCE<span>)</span>
<span>public</span> <span>interface</span> <span>BaseStrengthen</span> <span>{</span>
    <span>/**
     * 前置强化方法
     *
     * <span>@param</span> <span>bean</span>   bean实例（或者是被代理的bean）
     * <span>@param</span> <span>method</span> 执行的方法对象
     * <span>@param</span> <span>args</span>   方法参数
     */</span>
    <span>void</span> <span>before</span><span>(</span><span>Object</span> bean<span>,</span> <span>Method</span> method<span>,</span> <span>Object</span><span>[</span><span>]</span> args<span>)</span><span>;</span>

    <span>/**
     * 后置强化方法
     * 出现异常不会执行
     * 如果未出现异常，在afterFinally方法之后执行
     *
     * <span>@param</span> <span>bean</span>   bean实例（或者是被代理的bean）
     * <span>@param</span> <span>method</span> 执行的方法对象
     * <span>@param</span> <span>args</span>   方法参数
     */</span>
    <span>void</span> <span>after</span><span>(</span><span>Object</span> bean<span>,</span> <span>Method</span> method<span>,</span> <span>Object</span><span>[</span><span>]</span> args<span>)</span><span>;</span>

    <span>/**
     * 异常强化方法
     *
     * <span>@param</span> <span>bean</span>   bean实例（或者是被代理的bean）
     * <span>@param</span> <span>method</span> 执行的方法对象
     * <span>@param</span> <span>args</span>   方法参数
     */</span>
    <span>void</span> <span>exception</span><span>(</span><span>Object</span> bean<span>,</span> <span>Method</span> method<span>,</span> <span>Object</span><span>[</span><span>]</span> args<span>)</span><span>;</span>

    <span>/**
     * Finally强化方法，出现异常也会执行
     *
     * <span>@param</span> <span>bean</span>   bean实例（或者是被代理的bean）
     * <span>@param</span> <span>method</span> 执行的方法对象
     * <span>@param</span> <span>args</span>   方法参数
     */</span>
    <span>void</span> <span>afterFinally</span><span>(</span><span>Object</span> bean<span>,</span> <span>Method</span> method<span>,</span> <span>Object</span><span>[</span><span>]</span> args<span>)</span><span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_2-代理抽象类" tabindex="-1"> (2) 代理<a href="https://so.csdn.net/so/search?q=%E6%8A%BD%E8%B1%A1%E7%B1%BB&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">抽象类</a></h4>
<div><pre><code><span>public</span> <span>abstract</span> <span>class</span> <span>Point</span> <span>{</span>
    <span>/**
     * 定时任务名
     */</span>
    <span>private</span> <span>String</span> superScheduledName<span>;</span>

    <span>/**
     * 抽象的执行方法，使用代理实现
     * <span>@param</span> <span>runnable</span> 定时任务执行器
     */</span>
    <span>public</span> <span>abstract</span> <span>Object</span> <span>invoke</span><span>(</span><span>SuperScheduledRunnable</span> runnable<span>)</span><span>;</span>
    
    <span>/* 普通的get/sets省略 */</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_3-调用链类" tabindex="-1"> (3) 调用链类</h4>
<div><pre><code><span>public</span> <span>class</span> <span>Chain</span> <span>{</span>
    <span>private</span> <span>List</span><span><span>&lt;</span><span>Point</span><span>></span></span> list<span>;</span>
    <span>private</span> <span>int</span> index <span>=</span> <span>-</span><span>1</span><span>;</span>
    <span>/**
     * 索引自增1
     */</span>
    <span>public</span> <span>int</span> <span>incIndex</span><span>(</span><span>)</span> <span>{</span>
        <span>return</span> <span>++</span>index<span>;</span>
    <span>}</span>

    <span>/**
     * 索引还原
     */</span>
    <span>public</span> <span>void</span> <span>resetIndex</span><span>(</span><span>)</span> <span>{</span>
        <span>this</span><span>.</span>index <span>=</span> <span>-</span><span>1</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_4-cglib动态代理实现" tabindex="-1"> (4) <a href="https://so.csdn.net/so/search?q=cglib&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">cglib</a>动态代理实现</h4>
<p>使用cglib代理增强器，将增强器全部代理成调用链节点Point</p>
<div><pre><code><span>public</span> <span>class</span> <span>RunnableBaseInterceptor</span> <span>implements</span> <span>MethodInterceptor</span> <span>{</span>
    <span>/**
     * 定时任务执行器
     */</span>
    <span>private</span> <span>SuperScheduledRunnable</span> runnable<span>;</span>
    <span>/**
     * 定时任务增强类
     */</span>
    <span>private</span> <span>BaseStrengthen</span> strengthen<span>;</span>

    <span>@Override</span>
    <span>public</span> <span>Object</span> <span>intercept</span><span>(</span><span>Object</span> obj<span>,</span> <span>Method</span> method<span>,</span> <span>Object</span><span>[</span><span>]</span> args<span>,</span> <span>MethodProxy</span> methodProxy<span>)</span> <span>throws</span> <span>Throwable</span> <span>{</span>
        <span>Object</span> result<span>;</span>
        <span>//如果执行的是invoke()方法</span>
        <span>if</span> <span>(</span><span>"invoke"</span><span>.</span><span>equals</span><span>(</span>method<span>.</span><span>getName</span><span>(</span><span>)</span><span>)</span><span>)</span> <span>{</span>
        	<span>//前置强化方法</span>
            strengthen<span>.</span><span>before</span><span>(</span>obj<span>,</span> method<span>,</span> args<span>)</span><span>;</span>
            <span>try</span> <span>{</span>
            	<span>//调用执行器中的invoke()方法</span>
                result <span>=</span> runnable<span>.</span><span>invoke</span><span>(</span><span>)</span><span>;</span>
            <span>}</span> <span>catch</span> <span>(</span><span>Exception</span> e<span>)</span> <span>{</span>
            	<span>//异常强化方法</span>
                strengthen<span>.</span><span>exception</span><span>(</span>obj<span>,</span> method<span>,</span> args<span>)</span><span>;</span>
                <span>throw</span> <span>new</span> <span>SuperScheduledException</span><span>(</span>strengthen<span>.</span><span>getClass</span><span>(</span><span>)</span> <span>+</span> <span>"中强化执行时发生错误"</span><span>,</span> e<span>)</span><span>;</span>
            <span>}</span> <span>finally</span> <span>{</span>
            	<span>//Finally强化方法，出现异常也会执行</span>
                strengthen<span>.</span><span>afterFinally</span><span>(</span>obj<span>,</span> method<span>,</span> args<span>)</span><span>;</span>
            <span>}</span>
            <span>//后置强化方法</span>
            strengthen<span>.</span><span>after</span><span>(</span>obj<span>,</span> method<span>,</span> args<span>)</span><span>;</span>

        <span>}</span> <span>else</span> <span>{</span>
        	<span>//直接执行方法</span>
            result <span>=</span> methodProxy<span>.</span><span>invokeSuper</span><span>(</span>obj<span>,</span> args<span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> result<span>;</span>
    <span>}</span>

    <span>public</span> <span>RunnableBaseInterceptor</span><span>(</span><span>Object</span> object<span>,</span> <span>SuperScheduledRunnable</span> runnable<span>)</span> <span>{</span>
        <span>this</span><span>.</span>runnable <span>=</span> runnable<span>;</span>
        <span>if</span> <span>(</span><span>BaseStrengthen</span><span>.</span><span>class</span><span>.</span><span>isAssignableFrom</span><span>(</span>object<span>.</span><span>getClass</span><span>(</span><span>)</span><span>)</span><span>)</span> <span>{</span>
            <span>this</span><span>.</span>strengthen <span>=</span> <span>(</span><span>BaseStrengthen</span><span>)</span> object<span>;</span>
        <span>}</span> <span>else</span> <span>{</span>
            <span>throw</span> <span>new</span> <span>SuperScheduledException</span><span>(</span>object<span>.</span><span>getClass</span><span>(</span><span>)</span> <span>+</span> <span>"对象不是BaseStrengthen类型"</span><span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>

    <span>public</span> <span>RunnableBaseInterceptor</span><span>(</span><span>)</span> <span>{</span>

    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_5-定时任务执行器实现" tabindex="-1"> (5) 定时任务执行器实现</h4>
<div><pre><code><span>public</span> <span>class</span> <span>SuperScheduledRunnable</span> <span>{</span>
    <span>/**
     * 原始的方法
     */</span>
    <span>private</span> <span>Method</span> method<span>;</span>
    <span>/**
     * 方法所在的bean
     */</span>
    <span>private</span> <span>Object</span> bean<span>;</span>
    <span>/**
     * 增强器的调用链
     */</span>
    <span>private</span> <span>Chain</span> chain<span>;</span>


    <span>public</span> <span>Object</span> <span>invoke</span><span>(</span><span>)</span> <span>{</span>
        <span>Object</span> result<span>;</span>
        <span>//索引自增1</span>
        <span>if</span> <span>(</span>chain<span>.</span><span>incIndex</span><span>(</span><span>)</span> <span>==</span> chain<span>.</span><span>getList</span><span>(</span><span>)</span><span>.</span><span>size</span><span>(</span><span>)</span><span>)</span> <span>{</span>
            <span>//调用链中的增强方法已经全部执行结束</span>
            <span>try</span> <span>{</span>
                <span>//调用链索引初始化</span>
                chain<span>.</span><span>resetIndex</span><span>(</span><span>)</span><span>;</span>
                <span>//增强器全部执行完毕，执行原本的方法</span>
                result <span>=</span> method<span>.</span><span>invoke</span><span>(</span>bean<span>)</span><span>;</span>
            <span>}</span> <span>catch</span> <span>(</span><span>IllegalAccessException</span> <span>|</span> <span>InvocationTargetException</span> e<span>)</span> <span>{</span>
                <span>throw</span> <span>new</span> <span>SuperScheduledException</span><span>(</span>e<span>.</span><span>getLocalizedMessage</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>}</span>
        <span>}</span> <span>else</span> <span>{</span>
            <span>//获取被代理后的方法增强器</span>
            <span>Point</span> point <span>=</span> chain<span>.</span><span>getList</span><span>(</span><span>)</span><span>.</span><span>get</span><span>(</span>chain<span>.</span><span>getIndex</span><span>(</span><span>)</span><span>)</span><span>;</span>
            <span>//执行增强器代理</span>
            <span>//增强器代理中，会回调方法执行器，形成调用链，逐一运行调用链中的增强器</span>
            result <span>=</span> point<span>.</span><span>invoke</span><span>(</span><span>this</span><span>)</span><span>;</span>
        <span>}</span>
        <span>return</span> result<span>;</span>
    <span>}</span>
    
    <span>/* 普通的get/sets省略 */</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h4 id="_6-增强器代理逻辑" tabindex="-1"> (6) 增强器代理逻辑</h4>
<p>com.gyx.superscheduled.core.SuperScheduledApplicationRunner类中的代码片段</p>
<div><pre><code><span>//创建执行控制器</span>
<span>SuperScheduledRunnable</span> runnable <span>=</span> <span>new</span> <span>SuperScheduledRunnable</span><span>(</span><span>)</span><span>;</span>
runnable<span>.</span><span>setMethod</span><span>(</span>scheduledSource<span>.</span><span>getMethod</span><span>(</span><span>)</span><span>)</span><span>;</span>
runnable<span>.</span><span>setBean</span><span>(</span>scheduledSource<span>.</span><span>getBean</span><span>(</span><span>)</span><span>)</span><span>;</span>
<span>//用来存放 增强器的代理对象</span>
<span>List</span><span><span>&lt;</span><span>Point</span><span>></span></span> points <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span>baseStrengthenBeanNames<span>.</span>length<span>)</span><span>;</span>
<span>//循环所有的增强器的beanName</span>
<span>for</span> <span>(</span><span>String</span> baseStrengthenBeanName <span>:</span> baseStrengthenBeanNames<span>)</span> <span>{</span>
	<span>//获取增强器的bean对象</span>
    <span>Object</span> baseStrengthenBean <span>=</span> applicationContext<span>.</span><span>getBean</span><span>(</span>baseStrengthenBeanName<span>)</span><span>;</span>
    <span>//将增强器代理成Point节点</span>
    <span>Point</span> proxy <span>=</span> <span>ProxyUtils</span><span>.</span><span>getInstance</span><span>(</span><span>Point</span><span>.</span><span>class</span><span>,</span> <span>new</span> <span>RunnableBaseInterceptor</span><span>(</span>baseStrengthenBean<span>,</span> runnable<span>)</span><span>)</span><span>;</span>
    proxy<span>.</span><span>setSuperScheduledName</span><span>(</span>name<span>)</span><span>;</span>
    <span>//增强器的代理对象缓存到list中</span>
    points<span>.</span><span>add</span><span>(</span>proxy<span>)</span><span>;</span>
<span>}</span>
<span>//将增强器代理实例的集合生成调用链</span>
<span>//执行控制器中设置调用链</span>
runnable<span>.</span><span>setChain</span><span>(</span><span>new</span> <span>Chain</span><span>(</span>points<span>)</span><span>)</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-05-25T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Spring Boot 项目鉴权的 4 种方式</title>
    <id>https://blog.ciberviler.top/dev/SpringBoot%E9%A1%B9%E7%9B%AE%E9%89%B4%E6%9D%83%E7%9A%84%204%20%E7%A7%8D%E6%96%B9%E5%BC%8F.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringBoot%E9%A1%B9%E7%9B%AE%E9%89%B4%E6%9D%83%E7%9A%84%204%20%E7%A7%8D%E6%96%B9%E5%BC%8F.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">Spring Boot 项目鉴权的 4 种方式</summary>
    <content type="html"><![CDATA[<h1 id="spring-boot-项目鉴权的-4-种方式" tabindex="-1"> Spring Boot 项目鉴权的 4 种方式</h1>
<h2 id="传统aop" tabindex="-1"> <strong>传统AOP</strong></h2>
<p>对于这种需求，首先想到的当然是 Spring-boot 提供的 AOP 接口，只需要在 Controller 方法前添加切点，然后再对切点进行处理即可。</p>
<h3 id="实现" tabindex="-1"> <strong>实现</strong></h3>
<p>其使用步骤如下：</p>
<ol>
<li>使用 <code>@Aspect</code> 声明一下切面类 <code>WhitelistAspect</code>；</li>
<li>在切面类内添加一个切点 <code>whitelistPointcut()</code>，为了实现此切点灵活可装配的能力，这里不使用 <code>execution</code> 全部拦截，而是添加一个注解 <code>@Whitelist</code>，被注解的方法才会校验白名单。</li>
<li>在切面类中使用 spring 的 AOP 注解 <code>@Before</code> 声明一个通知方法 <code>checkWhitelist()</code> 在 Controller 方法被执行之前校验白名单。</li>
</ol>
<p>切面类伪代码如下：</p>
<div><pre><code><span>@Aspect</span>
<span>public</span> <span>class</span> <span>WhitelistAspect</span> <span>{</span>
   
 <span>@Before</span><span>(</span>value <span>=</span> <span>"whitelistPointcut() &amp;&amp; @annotation(whitelist)"</span><span>)</span>
 <span>public</span> <span>void</span> <span>checkAppkeyWhitelist</span><span>(</span><span>JoinPoint</span> joinPoint<span>,</span> <span>Whitelist</span> whitelist<span>)</span> <span>{</span>
     <span>checkWhitelist</span><span>(</span><span>)</span><span>;</span>
     <span>// 可使用 joinPoint.getArgs() 获取Controller方法的参数</span>
     <span>// 可以使用 whitelist 变量获取注解参数</span>
 <span>}</span>
   
   
 <span>@Pointcut</span><span>(</span><span>"@annotation(com.zhenbianshu.Whitelist)"</span><span>)</span>
 <span>public</span> <span>void</span> <span>whitelistPointCut</span><span>(</span><span>)</span> <span>{</span>
 <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><a href="https://mp.weixin.qq.com/s?__biz=MzI4OTA3NDQ0Nw==&amp;mid=2455548310&amp;idx=2&amp;sn=28559512311234ab380c18f124ac5246&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">在Controller方法上添加</a> <code>@Whitelist</code> 注解实现功能。</p>
<h3 id="扩展" tabindex="-1"> <strong>扩展</strong></h3>
<p>本例中使用了 注解 来声明切点，并且我实现了通过注解参数来声明要校验的白名单，如果之后还需要添加其他白名单的话，如通过 UID 来校验，则可以为此注解添加 <code>uid()</code> 等方法，实现自定义校验。此外，spring 的 AOP 还支持 <code>execution（执行方法） 、bean（匹配特定名称的 Bean 对象的执行方法）</code>等切点声明方法和 <code>@Around（在目标函数执行中执行） 、@After（方法执行后）</code> 等通知方法。如此，功能已经实现了，但领导并不满意=_=，原因是项目中 AOP 用得太多了，都用滥了，建议我换一种方式。嗯，只好搞起。</p>
<h2 id="interceptor" tabindex="-1"> <strong>Interceptor</strong></h2>
<p>Spring 的 拦截器(Interceptor) 实现这个功能也非常合适。顾名思义，拦截器用于在 Controller 内 Action 被执行前通过一些参数判断是否要执行此方法，要实现一个拦截器，可以实现 Spring 的 <code>HandlerInterceptor</code> 接口。</p>
<h3 id="实现-1" tabindex="-1"> <strong>实现</strong></h3>
<p>实现步骤如下：</p>
<ol>
<li>定义拦截器类 <code>AppkeyInterceptor</code> 类并实现 HandlerInterceptor 接口。</li>
<li>实现其 <code>preHandle()</code> 方法；</li>
<li>在 preHandle 方法内通过注解和参数判断是否需要拦截请求，拦截请求时接口返回 <code>false</code>；</li>
<li>在自定义的 <code>WebMvcConfigurerAdapter</code> 类内注册此拦截器；</li>
</ol>
<p><code>AppkeyInterceptor</code> 类如下：</p>
<div><pre><code><span>@Component</span>
<span>public</span> <span>class</span> <span>WhitelistInterceptor</span> <span>implements</span> <span>HandlerInterceptor</span> <span>{</span>

    <span>@Override</span>
    <span>public</span> <span>boolean</span> <span>preHandle</span><span>(</span><span>HttpServletRequest</span> request<span>,</span> <span>HttpServletResponse</span> response<span>,</span> <span>Object</span> handler<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
        <span>Whitelist</span> whitelist <span>=</span> <span>(</span><span>(</span><span>HandlerMethod</span><span>)</span> handler<span>)</span><span>.</span><span>getMethodAnnotation</span><span>(</span><span>Whitelist</span><span>.</span><span>class</span><span>)</span><span>;</span>
        <span>// whitelist.values(); 通过 request 获取请求参数，通过 whitelist 变量获取注解参数</span>
        <span>return</span> <span>true</span><span>;</span>
    <span>}</span>

    <span>@Override</span>
    <span>public</span> <span>void</span> <span>postHandle</span><span>(</span><span>HttpServletRequest</span> request<span>,</span> <span>HttpServletResponse</span> response<span>,</span> <span>Object</span> handler<span>,</span> <span>ModelAndView</span> modelAndView<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
  <span>// 方法在Controller方法执行结束后执行</span>
    <span>}</span>

    <span>@Override</span>
    <span>public</span> <span>void</span> <span>afterCompletion</span><span>(</span><span>HttpServletRequest</span> request<span>,</span> <span>HttpServletResponse</span> response<span>,</span> <span>Object</span> handler<span>,</span> <span>Exception</span> ex<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
  <span>// 在view视图渲染完成后执行</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="扩展-1" tabindex="-1"> <strong>扩展</strong></h3>
<p>要启用 拦截器还要显式配置它启用，这里我们使用 <code>WebMvcConfigurerAdapter</code> 对它进行配置。需要注意，继承它的的 <code>MvcConfiguration</code> 需要在 ComponentScan 路径下。</p>
<div><pre><code><span>@Configuration</span>
<span>public</span> <span>class</span> <span>MvcConfiguration</span> <span>extends</span> <span>WebMvcConfigurerAdapter</span> <span>{</span>
    <span>@Override</span>
    <span>public</span> <span>void</span> <span>addInterceptors</span><span>(</span><span>InterceptorRegistry</span> registry<span>)</span> <span>{</span>
        registry<span>.</span><span>addInterceptor</span><span>(</span><span>new</span> <span>WhitelistInterceptor</span><span>(</span><span>)</span><span>)</span><span>.</span><span>addPathPatterns</span><span>(</span><span>"/*"</span><span>)</span><span>.</span><span>order</span><span>(</span><span>1</span><span>)</span><span>;</span>
        <span>// 这里可以配置拦截器启用的 path 的顺序，在有多个拦截器存在时，任一拦截器返回 false 都会使后续的请求方法不再执行</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>还需要注意，拦截器执行成功后响应码为 <code>200</code>，但响应数据为空。Spring Boot 基础教程和示例源码在这里学习：<a href="https://github.com/javastacks/javastack%EF%BC%8C%E9%9D%9E%E5%B8%B8%E5%85%A8%E4%BA%86%E3%80%82%E5%BD%93%E4%BD%BF%E7%94%A8%E6%8B%A6%E6%88%AA%E5%99%A8%E5%AE%9E%E7%8E%B0%E5%8A%9F%E8%83%BD%E5%90%8E%EF%BC%8C%E9%A2%86%E5%AF%BC%E7%BB%88%E4%BA%8E%E7%A5%AD%E5%87%BA%E5%A4%A7%E6%8B%9B%E4%BA%86%EF%BC%9A%E6%88%91%E4%BB%AC%E5%B7%B2%E7%BB%8F%E6%9C%89%E4%B8%80%E4%B8%AA" target="_blank" rel="noopener noreferrer">https://github.com/javastacks/javastack，非常全了。当使用拦截器实现功能后，领导终于祭出大招了：我们已经有一个</a> Auth 参数了，appkey 可以从 Auth 参数里取到，可以把在不在白名单作为 Auth 的一种方式，为什么不在 Auth 时校验？emmm… 吐血中。</p>
<p>搜索公纵号：<a href="https://mp.weixin.qq.com/s?__biz=MzI4OTA3NDQ0Nw==&amp;mid=2455548310&amp;idx=2&amp;sn=28559512311234ab380c18f124ac5246&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">MarkerHub</a>，关注回复[ <strong>vue</strong> ]获取前后端入门教程！</p>
<h2 id="argumentresolver" tabindex="-1"> <strong>ArgumentResolver</strong></h2>
<p>参数解析器是 Spring 提供的用于解析自定义参数的工具，我们常用的 <code>@RequestParam</code> 注解就有它的影子，使用它，我们可以将参数在进入Controller Action之前就组合成我们想要的样子。Spring 会维护一个 <code>ResolverList</code>， 在请求到达时，Spring 发现有自定义类型参数（非基本类型）， 会依次尝试这些 Resolver，直到有一个 Resolver 能解析需要的参数。要实现一个参数解析器，需要实现 <code>HandlerMethodArgumentResolver</code> 接口。</p>
<h3 id="实现-2" tabindex="-1"> <strong>实现</strong></h3>
<ol>
<li>定义自定义参数类型 <code>AuthParam</code>，类内有 appkey 相关字段；</li>
<li>定义 <code>AuthParamResolver</code> 并实现 HandlerMethodArgumentResolver 接口；</li>
<li>实现 <code>supportsParameter()</code> 接口方法将 AuthParam 与 AuthParamResolver 适配起来；</li>
<li>实现 <code>resolveArgument()</code> 接口方法解析 reqest 对象生成 AuthParam 对象，并在此校验 AuthParam ，确认 appkey 是否在白名单内；</li>
<li>在 Controller Action 方法上签名内添加 AuthParam 参数以启用此 Resolver;</li>
</ol>
<p>实现的 AuthParamResolver 类如下：</p>
<div><pre><code><span>@Component</span>
<span>public</span> <span>class</span> <span>AuthParamResolver</span> <span>implements</span> <span>HandlerMethodArgumentResolver</span> <span>{</span>

    <span>@Override</span>
    <span>public</span> <span>boolean</span> <span>supportsParameter</span><span>(</span><span>MethodParameter</span> parameter<span>)</span> <span>{</span>
        <span>return</span> parameter<span>.</span><span>getParameterType</span><span>(</span><span>)</span><span>.</span><span>equals</span><span>(</span><span>AuthParam</span><span>.</span><span>class</span><span>)</span><span>;</span>
    <span>}</span>

    <span>@Override</span>
    <span>public</span> <span>Object</span> <span>resolveArgument</span><span>(</span><span>MethodParameter</span> parameter<span>,</span> <span>ModelAndViewContainer</span> mavContainer<span>,</span> <span>NativeWebRequest</span> webRequest<span>,</span> <span>WebDataBinderFactory</span> binderFactory<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
        <span>Whitelist</span> whitelist <span>=</span> parameter<span>.</span><span>getMethodAnnotation</span><span>(</span><span>Whitelist</span><span>.</span><span>class</span><span>)</span><span>;</span>
        <span>// 通过 webRequest 和 whitelist 校验白名单</span>
        <span>return</span> <span>new</span> <span>AuthParam</span><span>(</span><span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="扩展-2" tabindex="-1"> <strong>扩展</strong></h3>
<p>当然，使用参数解析器也需要单独配置，我们同样在 <code>WebMvcConfigurerAdapter</code>内配置：</p>
<div><pre><code><span>@Configuration</span>
<span>public</span> <span>class</span> <span>MvcConfiguration</span> <span>extends</span> <span>WebMvcConfigurerAdapter</span> <span>{</span>

    <span>@Override</span>
    <span>public</span> <span>void</span> <span>addArgumentResolvers</span><span>(</span><span>List</span><span><span>&lt;</span><span>HandlerMethodArgumentResolver</span><span>></span></span> argumentResolvers<span>)</span> <span>{</span>
        argumentResolvers<span>.</span><span>add</span><span>(</span><span>new</span> <span>AuthParamResolver</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>这次实现完了，我还有些不放心，于是在网上查找是否还有其他方式可以实现此功能，发现常见的还有 <code>Filter</code>。</p>
<h2 id="filter" tabindex="-1"> <strong>Filter</strong></h2>
<p>Filter 并不是 Spring 提供的，它是在 Servlet 规范中定义的，是 Servlet 容器支持的。被 Filter 过滤的请求，不会派发到 Spring 容器中。它的实现也比较简单，实现 <code>javax.servlet.Filter</code>接口即可。由于不在 Spring 容器中，Filter 获取不到 Spring 容器的资源，只能使用原生 Java 的 ServletRequest 和 ServletResponse 来获取请求参数。另外，在一个 Filter 中要显示调用 FilterChain 的 doFilter 方法，不然认为请求被拦截。实现类似：</p>
<div><pre><code><span>public</span> <span>class</span> <span>WhitelistFilter</span> <span>implements</span> <span><span>javax<span>.</span>servlet<span>.</span></span>Filter</span> <span>{</span>

    <span>@Override</span>
    <span>public</span> <span>void</span> <span>init</span><span>(</span><span>FilterConfig</span> filterConfig<span>)</span> <span>throws</span> <span>ServletException</span> <span>{</span>
  <span>// 初始化后被调用一次</span>
    <span>}</span>

    <span>@Override</span>
    <span>public</span> <span>void</span> <span>doFilter</span><span>(</span><span>ServletRequest</span> request<span>,</span> <span>ServletResponse</span> response<span>,</span> <span>FilterChain</span> chain<span>)</span> <span>throws</span> <span>IOException</span><span>,</span> <span>ServletException</span> <span>{</span>
     <span>// 判断是否需要拦截</span>
       chain<span>.</span><span>doFilter</span><span>(</span>request<span>,</span> response<span>)</span><span>;</span> <span>// 请求通过要显示调用</span>
    <span>}</span>

    <span>@Override</span>
    <span>public</span> <span>void</span> <span>destroy</span><span>(</span><span>)</span> <span>{</span>
     <span>// 被销毁时调用一次</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="扩展-3" tabindex="-1"> <strong>扩展</strong></h3>
<p>Filter 也需要显示配置：</p>
<div><pre><code><span>@Configuration</span>
<span>public</span> <span>class</span> <span>FilterConfiguration</span> <span>{</span>

    <span>@Bean</span>
    <span>public</span> <span>FilterRegistrationBean</span> <span>someFilterRegistration</span><span>(</span><span>)</span> <span>{</span>
        <span>FilterRegistrationBean</span> registration <span>=</span> <span>new</span> <span>FilterRegistrationBean</span><span>(</span><span>)</span><span>;</span>
        registration<span>.</span><span>setFilter</span><span>(</span><span>new</span> <span>WhitelistFilter</span><span>(</span><span>)</span><span>)</span><span>;</span>
        registration<span>.</span><span>addUrlPatterns</span><span>(</span><span>"/*"</span><span>)</span><span>;</span>
        registration<span>.</span><span>setName</span><span>(</span><span>"whitelistFilter"</span><span>)</span><span>;</span>
        registration<span>.</span><span>setOrder</span><span>(</span><span>1</span><span>)</span><span>;</span> <span>// 设置过滤器被调用的顺序</span>
        <span>return</span> registration<span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="小结" tabindex="-1"> <strong>小结</strong></h2>
<p>四种实现方式都有其适合的场 景，那么它们之间的调用顺序如何呢？Filter 是 Servlet 实现的，自然是最先被调用，后续被调用的是 Interceptor 被拦截了自然不需要后续再进行处理，然后是 参数解析器，最后才是切面的切点。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-03-01T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Spring Cloud Alibaba</title>
    <id>https://blog.ciberviler.top/dev/SpringCloudAlibaba.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringCloudAlibaba.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">Spring Cloud Alibaba</summary>
    <content type="html"><![CDATA[<h1 id="spring-cloud-alibaba" tabindex="-1"> Spring Cloud Alibaba</h1>
<p>互联网时代，面对复杂业务，讲究 <strong>分而治之</strong> 。将一个大的单体系统拆分为若干个微服务，保证每个系统的职责单一，可以垂直深度扩展。</p>
<p>但是一个个独立的微服务像一座座孤岛，如何将他们串联起来，才能发挥最大价值。</p>
<p>这时，我们就要提微服务的生态圈。</p>
<p>那么微服务生态圈都有哪些模块？他们的作用分别是什么？</p>
<ul>
<li><strong>服务的注册、发现</strong> 。生产者启动时，会将自己的信息注册上报，这样调用方只需连接注册中心，根据一定的负载算法，就可以与服务提供方建立连接，从而实现应用间的解耦。</li>
<li><strong>服务调用</strong> 。通过多种协议（如：HTTP等）实现目标服务的真正调用。</li>
<li><strong>负载均衡</strong> 。主要是提供多种负载算法，满足不同业务场景下的集群多实例的选择机制</li>
<li><strong>服务的稳定性</strong> 。提供了服务熔断、限流、降级</li>
<li><strong>分布式配置中心</strong> 。应用的配置项统一管理，修改后能动态生效</li>
<li><strong>消息队列</strong> 。非核心逻辑从同步流程抽离，解耦，异步化处理，缩短RT时间</li>
<li><strong>网关</strong> 。将一些通用的处理逻辑，如：限流、鉴权、黑白名单、灰度等抽取到一个单独的、前置化系统统一处理。</li>
<li><strong>监控</strong> 。监控系统的健康状况</li>
<li><strong>分布式链路追踪</strong> 。查看接口的调用链路，为性能优化、排查问题提供输入</li>
<li><strong>自动化部署</strong> 。持续集成，快速部署应用。</li>
</ul>
<p>围绕这些功能模块，<code>Spring Cloud Alibaba</code> 为我们提供了微服务化开发的一站式解决方案，我们只需要少量的<code>Spring 注解</code> 和 <code>yaml配置</code>，便可以快速构建出一套微服务系统。真的是创业者的福音。</p>
<p><strong>那么这套生态规范都提供了哪些技术框架呢？</strong></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfcnIibRHg3zekuCwaBZ682Ed569me3GrnFXKSzwtXrK5TYty5wbJawc6gTicYYf4ru6tyOiaRjo0atyA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></a></p>
<h2 id="一、spring-boot-服务基座" tabindex="-1"> 一、Spring Boot（服务基座）</h2>
<p>Spring Boot 是Spring框架的扩展，提供更加 <code>丰富的注解</code>，根据 <strong>约定胜于配置</strong> 原则，与市场主流的开源框架打通， 设计了 <code>Starter</code> 和 <code>AutoConfiguration</code> 机制，简化配置流程，通过简单的jar包引入，快速具备组件集成能力。大大提高了程序员的开发效率。</p>
<p><strong>特点：</strong></p>
<ul>
<li>提供了丰富的注解，不要在XML文件中定义各种繁琐的bean配置</li>
<li>内嵌 Web容器，如：Tomcat（默认）、Jetty、Undertow</li>
<li>集成了主流开源框架，根据项目依赖自动配置</li>
</ul>
<h2 id="二、nacos-注册中心、分布式配置中心" tabindex="-1"> 二、Nacos（注册中心、分布式配置中心）</h2>
<p>Nacos 是阿里巴巴的开源的项目，全称 Naming Configuration Service ，专注于服务发现和配置管理领域。</p>
<p>Nacos 致力于帮助您发现、配置和管理微服务。Nacos 提供了一组简单易用的特性集，帮助您快速实现动态服务发现、服务配置、服务元数据及流量管理。功能齐全，可以替换之前的 <code>Spring Cloud Netflix Eureka</code>、<code>Spring Cloud Config</code>、<code>Spring Cloud Bus</code>，野心巨大。</p>
<p>客户端语言方面目前支持 Java，go 、python、 C# 和 C++等主流语言</p>
<blockquote>
<p>开源地址：<a href="https://github.com/alibaba/nacos" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/nacos</a></p>
</blockquote>
<p>Nacos 有一个控制台，可以帮助用户管理服务，监控服务状态、应用的配置管理。</p>
<p><strong>集群化部署：</strong></p>
<p>由于 <code>Nacos</code> 是单节点，无论做为<code>注册中心</code>还是<code>分布式配置中心</code>，一旦服务器挂了，作为底层服务引发的麻烦还是非常大的。如何保证其高可用？</p>
<p>Nacos 官方提供的集群部署架构图：</p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://mmbiz.qpic.cn/mmbiz_jpg/JdLkEI9sZfcNjELl9JONS1pzqOYUYGk20h88dyic0yWNBCTViaHHpGoTZPU81NzZtkjllGSia4GKJo3HlN3cOpLBg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></a></p>
<blockquote>
<p><a href="https://nacos.io/zh-cn/docs/cluster-mode-quick-start.html" target="_blank" rel="noopener noreferrer">https://nacos.io/zh-cn/docs/cluster-mode-quick-start.html</a></p>
</blockquote>
<p>在nacos的解压目录<code>nacos/conf</code>目录下，有配置文件<code>cluster.conf</code>，每行配置成 ip:port。（一般配置3个或3个以上节点）</p>
<div><pre><code>> 基于微服务的思想，构建在 B2C 电商场景下的项目实战。核心技术栈，是 Spring Boot + Dubbo 。未来，会重构成 Spring Cloud Alibaba 。
>
> 项目地址：&lt;https://github.com/YunaiV/onemall>

# ip:port
200.8.9.16:8848
200.8.9.17:8848
200.8.9.18:8848
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>这样保证客户端只需要写一次，由 Leader节点将数据同步到其他节点，保证各个节点的数据一致性</strong></p>
<p>对于上层的SLB，我们可以采用 <code>Nginx</code> 或者 <code>OpenResty</code>，在 upstream 模块里配置 Nacos 的集群IP 地址列表，实现负载均衡功能。</p>
<p>另外，借助Nginx的心跳检测，当某台 Nacos 服务挂掉后，SLB 会自动屏蔽，将流量切换到其他 Nacos 实例。</p>
<p>当然 <code>OpenResty</code> 也可能成为单点故障，为了保证高可用，我们需要借助 <code>Keepalived</code></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://mmbiz.qpic.cn/mmbiz_jpg/JdLkEI9sZfcNjELl9JONS1pzqOYUYGk2DtUicibtvDVlkz8N7EhaqdpBMjvjLESPg7XWdEyJKFHiaIiavcaSX3lGicg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></a></p>
<p>客户端请求 VIP，然后请求打到了 OpenResty，由 OpenResty 转发给具体的某个 Nacos 节点。</p>
<blockquote>
<p>OpenResty 只有一个节点提供服务，另一个暂停状态，如果 master 节点宕机，那 backup 接替继续工作。从而解决了单点故障问题。</p>
</blockquote>
<p>Keepalived 作为一种高性能的服务器高可用或热备解决方案，用来防止服务器单点故障的发生。市面资料很多，下文链接是《Keepalived+Nginx部署方案》具体操作步骤</p>
<blockquote>
<p><a href="https://help.fanruan.com/finereport/doc-view-2905.html" target="_blank" rel="noopener noreferrer">https://help.fanruan.com/finereport/doc-view-2905.html</a></p>
</blockquote>
<h2 id="三、resttemplate-ribbon-远程调用" tabindex="-1"> 三、RestTemplate + Ribbon （远程调用）</h2>
<p>Spring Cloud Ribbon 基于 Netflix Ribbon 封装的负载均衡框架。内部集成了多种负载算法，如：随机、轮询等。</p>
<p>与注册中心打通，能自动获取服务提供者的地址列表。结合自身的负载算法，选择一个目标实例发起服务调用。</p>
<blockquote>
<p>Ribbon 也提供了扩展接口，支持自定义负载均衡算法。</p>
</blockquote>
<div><pre><code>public class CustomRule extends AbstractLoadBalancerRule {
    private AtomicInteger count = new AtomicInteger(0);
    @Override
    public Server choose(Object key) { 
        return choose(getLoadBalancer(), key);
    }

    private Server choose(ILoadBalancer loadBalancer, Object key) {
        List&lt;Server> allServers = loadBalancer.getAllServers(); 
        int requestNumber = count.incrementAndGet(); 
        if (requestNumber >= Integer.MAX_VALUE) { 
            count = new AtomicInteger(0); 
        }
        if (null != allServers) {
            int size = allServers.size();
            if (size > 0) {
                int index = requestNumber % size;                 
                Server server = allServers.get(index);
                if (null == server || !server.isAlive()) { 
                    return null;
                }
                return server;
            }
        }
        return null;
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>缺点：</strong></p>
<p>调用方每次发起远程服务调用时，都需要填写<code>远程目标地址</code>，还要配置各种参数，非常麻烦，不是很方便</p>
<div><pre><code>// 注册到Nacos的应用名称
private final String SERVER_URL = "http://nacos-provider-demo"; 
@Resource
private RestTemplate restTemplate;

@RequestMapping("/hello") 
public String hello() {
 // 远程服务调用
   return restTemplate.getForObject(SERVER_URL + "/hello", String.class);
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="四、openfeign-远程调用" tabindex="-1"> 四、OpenFeign（远程调用）</h2>
<p>RestTemplate + Ribbon 每次发起远程服务调用时，都需要填写<code>远程目标地址</code>，还要配置各种参数，非常麻烦。</p>
<p>Feign 是一个轻量级的 Restful HTTP 客户端，<strong>内嵌了 Ribbon 作为客户端的负载均衡</strong> 。面向接口编程，使用时只需要定义一个接口并加上<code>@FeignClient</code>注解，非常方便。</p>
<p>OpenFeign 是 <code>Feign</code> 的增强版。对 Feign 进一步封装，支持 Spring MVC 的标准注解和HttpMessageConverts</p>
<p><strong>依赖包：</strong></p>
<div><pre><code>&lt;dependency>
    &lt;groupId>org.springframework.cloud&lt;/groupId>
    &lt;artifactId>spring-cloud-starter-openfeign&lt;/artifactId>
&lt;/dependency>
@FeignClient(value = "${provider.name}") 
public interface OrderService {

 // 调用服务提供者的 /create_order 接口
 @RequestMapping(value = "/create_order",method = RequestMethod.GET) 
 public String createOrder();
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>其中，<code>@FeignClient(value = &quot;${provider.name}&quot;)</code> 定义了服务提供方的工程名，底层自动打通了注册中心，会拿到 <code>artifactId</code> 对应的IP列表，根据一定的负载均衡算法，可以将请求打到目标服务器上。</p>
<p>OpenFeign 默认等待接口返回数据的时间是 1 秒，超过这个时间就会报错。如果想调整这个时间，可以修改配置项 <code>feign.client.config.default.readTimeout</code></p>
<h2 id="五、dubbo-spring-cloud-远程调用" tabindex="-1"> 五、Dubbo Spring Cloud（远程调用）</h2>
<p><code>RestTemplate + Ribbon</code> 和 <code>OpenFeign</code> 都是基于HTTP协议调用远程接口。而 <code>Dubbo Spring Cloud</code> 是基于 TCP 协议来调用远程接口。相比 HTTP 的大量的请求头，TCP 更轻量级。</p>
<p>Dubbo Spring Cloud = Spring Cloud  + Dubbo</p>
<p><strong>特性：</strong></p>
<ul>
<li>支持多种注册中心，用于服务的注册、发现</li>
<li>内置多种负载均衡策略</li>
<li>服务粒度是<code>面向接口</code>，支持 TCP 轻量级协议</li>
<li>容易扩展，采用 微内核 + 插件 的设计原则，扩展点更强</li>
</ul>
<p><strong>依赖包：</strong></p>
<div><pre><code>&lt;dependency>
    &lt;groupId>com.alibaba.cloud&lt;/groupId>
    &lt;artifactId>spring-cloud-starter-dubbo&lt;/artifactId>
&lt;/dependency>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p>注意：虽然是将 Dubbo 集成到了 Spring Cloud，增加了一些 <code>注解</code> 和 <code>yaml</code> 配置项，开发更方便，但大部分调用玩法还是遵守 Dubbo 框架那一套。</p>
<p><strong>几个重要的配置项：</strong></p>
<ul>
<li>dubbo.scan.base-packages  # dubbo 服务扫描基准包，上报注册服务</li>
<li><a href="http://dubbo.protocol.name" target="_blank" rel="noopener noreferrer">dubbo.protocol.name</a>: dubbo  # 支持的协议</li>
<li>dubbo.protocol.port: -1  # dubbo 协议端口（ -1 表示自增端口，从 20880 开始）</li>
<li>dubbo.registry.address  # 注册中心地址</li>
</ul>
<h2 id="六、spring-cloud-gateway-网关" tabindex="-1"> 六、Spring Cloud Gateway（网关）</h2>
<p>分布式时代，一个复杂的系统被拆分为若干个微服务系统，每个系统都配置独立的域名肯定不合适。为了解决这个问题，网关便诞生了。</p>
<p>网关充当反向代理的角色，作为流量的第一入口，承载了很多基础的、公共的模块功能，如：流控、鉴权、监控、路由转发等。</p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://mmbiz.qpic.cn/mmbiz_jpg/JdLkEI9sZfcNjELl9JONS1pzqOYUYGk2e23rADQPAAvyk2mfvzoA2hcuU61S1n1ict2Yb64JQ0Mp6oT1MxJUI7Q/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></a></p>
<p>Spring Cloud 生态早期的网关是 Netflix 公司的Zuul，后来Zuul社区停止了维护。官方后来推出了 Spring Cloud Gateway，<strong>其底层是基于 WebFlux 框架</strong> ，而WebFlux框架的底层采用高性能通讯框架 Netty，性能是 Zuul 的 1.6 倍。</p>
<p><strong>核心组件：</strong></p>
<p>1、路由。</p>
<p>内部主要是负责转发规则。</p>
<p>2、断言（Predicate）</p>
<p>如果返回为true，当前路由才有效，才会路由到具体的服务。官方提供了很多<code>内置路由断言</code>，如果满足不了你的诉求，也可以<code>自定义路由断言工厂</code>。</p>
<p>所有的路由断言工厂都是继承自 <code>AbstractRoutePredicateFactory</code>，自定义类的命名也有固定规则，<code>“配置名”+RoutePredicateFactory</code>。这样，在yaml配置时，只需要写<code>前面定义的配置名</code>即可。</p>
<p>3、过滤器（Filter）</p>
<p>主要是请求、响应之间增加一些自定义的逻辑。按作用范围分为：全局和局部。全局是作用于所有的路由；而局部只是作用于某一个路由。</p>
<p>跟上面的断言类似，除了官方提供的过滤器，也支持自定义。</p>
<p><strong>局部过滤器</strong> ：继承自 <code>AbstractGatewayFilterFactory</code>，自定义类的命名也有固定规则，<code>“配置名”+GatewayFilterFactory</code>。这样，在yaml配置时，只需要写<code>前面定义的配置名</code>即可。</p>
<p><strong>全局过滤器</strong> ：实现<code>GlobalFilter</code>,<code>Ordered</code> 两个接口，实现逻辑跟上面的局部过滤器类似。这里就不展开了。其中的 <code>Ordered</code> 接口主要是负责优先级，数值越小，优先级越高。</p>
<p><strong>依赖包：</strong></p>
<div><pre><code>&lt;dependency>
 &lt;groupId>org.springframework.cloud&lt;/groupId>
 &lt;artifactId>spring-cloud-starter-gateway&lt;/artifactId>
&lt;/dependency>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p><strong>yaml 的配置示例：</strong></p>
<div><pre><code>spring:
  cloud:
    gateway:
      routes:  #路由，可配置多个
        - id: user_route  # 路由id 唯一即可，默认是UUID
          uri: lb://user-server-sample # 匹配成功后提供的服务的地址
          order: 1 # 路由优先级，数值越小优先级越高，默认0
          predicates:
            - Path=/user/**  # 断言，路径匹配进行路由
         #  - User=0, 1000   # 自定义路由断言工厂  只允许查询id为0 - 1000之间的用户
         #  - Method=POST    # 表示需要POST方式请求
         #  - Query=id, \d+  # 参数名id，正则表达式为\d+（一个或多个数字）
          filters:
            - AddRequestHeader=X-Request-token, 12345678  #为原始请求加上请求头及值
           
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>当然，服务提供方的地址可能经常变化，为了动态感知，我们引入 Nacos 注册中心，用于服务的注册、发现，统一管理服务的IP地址。网关路由转发时，只需从 Nacos 动态获取即可。</p>
<h2 id="七、sentinel-熔断、限流、降级" tabindex="-1"> 七、Sentinel（熔断、限流、降级）</h2>
<p>Sentinel 是阿里开源的流控框架，提供了简单易用的控制台，比 <code>Hystrix</code>支持的范围更广。</p>
<p>集成简单，只需要少量配置，即可快速接入，支持如：gRPC、Dubbo、Spring Cloud 等</p>
<p><strong>同类竞品框架：</strong></p>
<ul>
<li>Hystrix 框架已经停止维护；</li>
<li>Resilience4j 一种轻量级容错库，专为 Java 8 和函数式编程而设计。通过装饰器的方式，以使用断路器，速率限制器，重试或隔板来增强任何功能接口，lambda 表达式或方法引用。</li>
</ul>
<p><strong>流控规则：</strong></p>
<p>页面元素介绍：</p>
<ul>
<li>
<p>资源名：唯一即可</p>
</li>
<li>
<p>针对来源：对调用者限流，填写应用名称（Spring.application.name的值），只针对某个服务限流</p>
</li>
<li>
<p>阈值类型</p>
</li>
<li>
<ul>
<li>QPS：每秒接收的请求数</li>
<li>线程数：能使用的业务线程数</li>
</ul>
</li>
<li>
<p>流控模式</p>
</li>
<li>
<ul>
<li>直接：达到条件后，直接执行某个流控效果</li>
<li>关联：如果访问关联接口B达到了阈值，则让接口A返回失败</li>
<li>链路：记录从入口资源的流量，达到条件也只限流入口资源</li>
</ul>
</li>
<li>
<p>流控效果</p>
</li>
<li>
<ul>
<li>快速失败：直接返回失败结果</li>
<li>Warm Up：预热，开始有一个缓冲期，初始值 = 阈值/ codeFactor(默认 3)，然后慢慢达到设置的阈值</li>
<li>排队等待：让请求以均匀的速度通过，如果请求超过阈值就等待，如果等待超时则返回失败</li>
</ul>
</li>
</ul>
<p><strong>降级规则：</strong></p>
<ul>
<li>RT</li>
<li>异常数</li>
<li>异常比例</li>
</ul>
<p><strong>系统规则：</strong></p>
<p>流控规则和降级规则是针对某个资源来说的，而系统规则是针对整个应用的，粒度更大，当前所有的接口服务都会应用这个系统规则。</p>
<p><strong>授权规则：</strong></p>
<p>根据调用方判断调用的接口资源是否被允许，如：黑名单、白名单机制</p>
<p><strong>热点规则：</strong></p>
<p>将粒度进一步细化，可以针对方法的参数做规则控制，为每个参数设置单独的阈值，也可以多个参数组合。从而实现单个方法的热点流量，按业务需求进一步控制。</p>
<p><strong>@SentinelResource注解</strong></p>
<p><code>@SentinelResource</code> 注解可以根据实际情况定制化功能，跟 <code>Hystrix</code> 的 <code>@HystrixCommand</code> 注解功能类似。达到阈值后，系统的默认提示是一段英文，很不友好，所以我们要<code>自定义兜底方法</code>。</p>
<div><pre><code>// 资源名称为handle1 
@RequestMapping("/handle1")
@SentinelResource(value = "handle1", blockHandler = "blockHandlerTestHandler")
public String handle1(String params) { 
    // 业务逻辑处理
    return "success";
}

// 接口方法 handle1 的 兜底方法
public String blockHandlerTestHandler(String params, BlockException blockException) {
    return "兜底返回";
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>注意：<code>@SentinelResource</code>注解中，除了<code>blockHandler</code>字段外，还有<code>fallback</code>字段</p>
<ul>
<li><code>blockHandler</code>：主观层面，如果被限流，则调用该方法，进行兜底处理</li>
<li><code>fallback</code>：对业务的异常兜底，比如，执行过程中抛了各种<code>Exception</code>，则调用该方法，进行兜底处理</li>
</ul>
<p>通过上面两层兜底，可以让<code>Sentinel</code> 框架更加人性化，体验更好。</p>
<p><strong>集群流控：</strong></p>
<p>单机限流很容易做，但是互联网很多应用都是集群部署，毕竟其下游还挂载着 mysql、或者其他微服务，为了防止对下游的大流量冲击，采用集群流控。防止单机的流量不均匀， 理想下 QPS = 单机阈值 * 节点数</p>
<h2 id="八、seata-分布式事务" tabindex="-1"> 八、Seata（分布式事务）</h2>
<p>事务的原子性和持久性可以确保在一个事务内，更新多条数据，要么都成功，要么都失败。在一个系统内部，我们可以使用数据库事务来保证数据一致性。那如果一笔交易，涉及到跨多个系统、多个数据库的时候，用单一的数据库事务就没办法解决了，此时需要引入分布式事务</p>
<p>Seata 是一款开源的分布式事务解决方案，致力于提供高性能和简单易用的分布式事务服务。Seata 将为用户提供了 AT、TCC、SAGA 和 XA 事务模式，默认 AT 模式 ，为用户打造一站式的分布式解决方案。</p>
<p><strong>优点：</strong></p>
<ul>
<li>对业务无侵入：即减少技术架构上的微服务化所带来的分布式事务问题对业务的侵入</li>
<li>高性能：减少分布式事务解决方案所带来的性能消耗</li>
</ul>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://mmbiz.qpic.cn/mmbiz_jpg/JdLkEI9sZfcNjELl9JONS1pzqOYUYGk2oRMj65VXYd9WwlWjKgaCpMxcymONrY9FRhHPrHdLGdMiczvFk0kSW3g/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></a></p>
<p><strong>Seata有3个基本组成部分</strong> ：</p>
<ul>
<li>事务管理器（TM）：定义全局事务的范围：开始全局事务，提交或回滚全局事务。</li>
<li>事务协调器（TC）：维护全局事务和分支事务的状态，驱动全局提交或回滚。</li>
<li>资源管理器（RM）：管理正在处理的分支事务的资源，与TC对话以注册分支事务并报告分支事务的状态，并驱动分支事务的提交或回滚。</li>
</ul>
<p><strong>运行流程</strong> ：</p>
<ul>
<li>TM 向 TC 申请开启一个全局事务，全局事务创建成功并生成一个全局唯一的 XID</li>
<li>XID 在微服务调用链路的上下文中传播</li>
<li>RM 向 TC 注册分支事务，TC 返回分支事务ID ，并将其纳入 XID 对应全局事务的管辖</li>
<li>RM 执行本地业务表操作，并记录 <code>undo_log</code> 日志，提交本地事务</li>
<li>当所有的 RM 都执行完后，TM 向 TC 发起针对 XID 的全局提交或回滚决议</li>
<li>TC 调度 XID 下管辖的全部分支事务完成提交或回滚请求。如果提交，删除 <code>undo_log</code> 日志就可以了。如果是回滚，根据 <code>undo_log</code> 表记录逆向回滚本地事务，把数据还原，最后再删除 <code>undo_log</code> 日志。</li>
</ul>
<p><strong>关于 Seata 之前写过很多文章，这里就不展开了，感兴趣可以看看</strong></p>
<ul>
<li>业务无侵入框架Seata， 解决分布式事务问题</li>
<li>深度剖析 Seata TCC 模式【图解 + 源码分析】</li>
<li>七种分布式事务的解决方案，一次讲给你听</li>
</ul>
<h2 id="九、spring-cloud-stream-异步消息" tabindex="-1"> 九、Spring Cloud Stream （异步消息）</h2>
<p>Spring Cloud Stream 是统一消息中间件编程模型的框架，屏蔽了底层消息中间件的差异。支持的MQ 框架有 <code>RabbitMQ</code>、<code>Kafka</code>、<code>RocketMQ</code> 等</p>
<p><strong>常用注解：</strong></p>
<ul>
<li>@Input：标记为输入信道，消费消息</li>
<li>@Output：标记为输出信道，生产消息</li>
<li>@StreamListener：监听某个队列，接收消息，处理自身的业务逻辑</li>
<li>@EnableBinding：绑定通道</li>
</ul>
<p><strong>依赖包：</strong></p>
<div><pre><code>&lt;dependency>
 &lt;groupId>com.alibaba.cloud&lt;/groupId>
 &lt;artifactId>spring-cloud-starter-stream-rocketmq&lt;/artifactId>
&lt;/dependency>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p><strong>绑定通道：</strong></p>
<div><pre><code>@SpringBootApplication
@EnableBinding({CustomSource.class})
public class StreamProduceApplication {
 public static void main(String[] args) {
  SpringApplication.run(StreamProduceApplication.class, args);
 }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>定义输出信道：</strong></p>
<div><pre><code>public interface CustomSource {
    @Output("output1")
    MessageChannel output1();
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p><strong>yaml 配置：</strong></p>
<div><pre><code>spring:
  cloud:
    stream:
      rocketmq:
        binder:
          name-server: 127.0.0.1:9876 # rocketMq服务地址
        bindings:
          output1:
            producer:
              transactional: true    # 事务
              group: myTxProducerGroup    # 事务分组
      bindings:
        output1:
          destination: test-transaction-topic # 主题
          content-type: application/json # 数据类型
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>发送消息：</strong></p>
<div><pre><code>@Service
public class SendMessageService {
    @Resource
    private CustomSource customSource;

    public String sendMessage() { //发送简单字符串消息的方法
        String message = "字符串测试消息";
        // 发送消息
  customSource.output1().send(MessageBuilder.withPayload(message).build());         
  return "发送成功！";
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="十、skywalking-分布式链路追踪" tabindex="-1"> 十、SkyWalking（分布式链路追踪）</h2>
<p>SkyWalking 是 一款 APM（应用性能监控）系统，专为微服务、云原生架构、容器（Docker、k8s、Mesos）而设计。通过探针收集应用的指标，进行分布式链路追踪，<strong>感知服务间的调用链路关系</strong> 。</p>
<p><strong>特性：</strong></p>
<ul>
<li>支持告警</li>
<li>采用探针技术，<strong>代码零侵入</strong></li>
<li>轻量高效，不需要大数据平台</li>
<li>多个语言自动探针。包括 Java，.NET Core 和 Node.JS。</li>
<li>强大的可视化后台</li>
</ul>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&amp;mid=2247487551&amp;idx=1&amp;sn=18f64ba49f3f0f9d8be9d1fdef8857d9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer"><img src="https://mmbiz.qpic.cn/mmbiz_jpg/JdLkEI9sZfcNjELl9JONS1pzqOYUYGk2GjvyxMk3ppK66BNu1YwicfKe1g7M8wZ752KjvJiaY3ybyXAe779qicwxA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></a></p>
<ul>
<li>上部分 Agent ：负责从应用中，收集链路信息，发送给 SkyWalking OAP 服务器。目前支持 SkyWalking、Zikpin、Jaeger 等提供的 Tracing 数据信息。而我们目前采用的是，SkyWalking Agent 收集 SkyWalking Tracing 数据，传递给服务器。</li>
<li>下部分 SkyWalking OAP ：负责接收 Agent 发送的 Tracing 数据信息，然后进行分析(Analysis Core) ，存储到外部存储器( Storage )，最终提供查询( Query )功能。</li>
<li>右部分 Storage ：Tracing 数据存储。目前支持 ES、MySQL、Sharding Sphere、TiDB、H2 多种存储器。<strong>而我们目前采用的是 ES</strong> ，主要考虑是 SkyWalking 开发团队自己的生产环境采用 ES 为主。</li>
<li>左部分 SkyWalking UI ：负责提供控台，查看链路等等。</li>
</ul>
<p>SkyWalking 部署起来还是很简单的，apache官网直接下载并解压即可。</p>
<blockquote>
<p><a href="https://skywalking.apache.org/" target="_blank" rel="noopener noreferrer">https://skywalking.apache.org/</a></p>
</blockquote>
<p>SkyWalking 快速入门手册：</p>
<blockquote>
<p><a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/" target="_blank" rel="noopener noreferrer">https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/</a></p>
</blockquote>
<h2 id="十一、xxl-job-分布式任务调度" tabindex="-1"> 十一、XXL-JOB（分布式任务调度）</h2>
<p>关于定时任务，相信大家都不陌生。但是单节点的定时任务有很多不足：</p>
<ul>
<li>不支持集群，如果同时部署多个节点，会竞争数据，造成数据重复</li>
<li>如果是单节点，宕机后，任务无法自动感知、重启</li>
<li>不支持任务失败重试</li>
<li>不支持执行时间的动态调整</li>
<li>无报警机制</li>
<li>无任务数据统计功能</li>
<li>不支持数据分片</li>
</ul>
<p>无论是集群化，还是周边的生态建设，都不完备。而 XXL-JOB，可以完美解决这些问题。</p>
<p>XXL-JOB 是一款分布式任务调度框架，依赖的组件少（仅依赖 Java 和 MySQL），开箱即用。并提供了可视化界面，统计任务数据，动态修改任务执行时间，内置邮件报警，支持任务分片和任务失败重试。</p>
<p><strong>核心模块：</strong></p>
<p>1、调度中心</p>
<p>本身不执行业务逻辑，只负责向执行器发送调度命令。</p>
<p>2、执行器</p>
<p>接收调度中心的请求，并执行业务逻辑。</p>
<p><strong>依赖包：</strong></p>
<div><pre><code>&lt;dependency>
 &lt;groupId>com.xuxueli&lt;/groupId>
 &lt;artifactId>xxl-job-core&lt;/artifactId>
 &lt;version>2.2.0&lt;/version>
&lt;/dependency>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>yaml 配置：</strong></p>
<div><pre><code>server:
  port: 8082  #程序端口
xxl:
  job:
    admin:
      addresses: http://127.0.0.1:8002/xxl-job-admin  # 调度中心地址，多个用逗号分开
    accessToken:  # 调度中心和执行器通信的token，如果设置，两边要一样
    executor:
      appname: xxl-job-executor-sample  #执行器名称
      address:   # 执行器地址，默认使用xxl.job.executor.address配置项，如果为空，则使用xxl.job.executor.ip + xxl.job.executor.port
      ip:   # 执行器IP
      port: 9989  #执行器端口，与调度中心通信的端口
      logpath: D:/work/Spring-Cloud-Alibaba/sample/logs # 日志保存路径
      logretentiondays: 30 # 日志保留天数
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>XxlJobSpringExecutor 初始化：</strong></p>
<div><pre><code>@Bean
public XxlJobSpringExecutor xxlJobExecutor() { // XXL-JOB执行器初始化
    XxlJobSpringExecutor xxlJobSpringExecutor = new XxlJobSpringExecutor();
    xxlJobSpringExecutor.setAdminAddresses(adminAddresses);
    xxlJobSpringExecutor.setAppname(appname);
    xxlJobSpringExecutor.setAddress(address);
    xxlJobSpringExecutor.setIp(ip);
    xxlJobSpringExecutor.setPort(port);
    xxlJobSpringExecutor.setAccessToken(accessToken);
    xxlJobSpringExecutor.setLogPath(logPath);
    xxlJobSpringExecutor.setLogRetentionDays(logRetentionDays);
    return xxlJobSpringExecutor;
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>我们可以采用 <code>BEAN</code> 模式， 使用 <code>@XxlJob</code> 注解描述代码。优点：适用于一些复杂的业务场景。</p>
<p>也可以采用 <code>GLUE</code> 模式，将 <code>执行代码</code> 托管到调度中心在线维护。优点：简单快捷，不需要单独的业务工程。</p>
<p>如果要处理的数据量较大时，我们可以采用<code>分片</code>处理机制，将任务均摊到每个节点，从而减轻单个节点的压力。</p>
<div><pre><code>shardingVO.getIndex() # 当前执行器的分片序号（从0开始）
shardingVO.getTotal() # 总分片数，执行器集群的数量

# dataSource 待处理的所有原始数据
for (Integer val : dataSource) { // 遍历代理
    if (val % shardingVO.getTotal() == shardingVO.getIndex()) { // 取余
        //TODO 归属于当前分片处理
    } 
}  
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>XXL-JOB 快速入门手册：</p>
<blockquote>
<p><a href="https://www.xuxueli.com/xxl-job/" target="_blank" rel="noopener noreferrer">https://www.xuxueli.com/xxl-job/</a></p>
</blockquote>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-03-23T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Spring Cloud Gateway + Oauth2 实现统一认证和鉴权</title>
    <id>https://blog.ciberviler.top/dev/SpringCloudGateway+Oauth2%E5%AE%9E%E7%8E%B0%E7%BB%9F%E4%B8%80%E8%AE%A4%E8%AF%81%E5%92%8C%E9%89%B4%E6%9D%83.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringCloudGateway+Oauth2%E5%AE%9E%E7%8E%B0%E7%BB%9F%E4%B8%80%E8%AE%A4%E8%AF%81%E5%92%8C%E9%89%B4%E6%9D%83.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">微服务权限终极解决方案，Spring Cloud Gateway + Oauth2 实现统一认证和鉴权</summary>
    <content type="html"><![CDATA[<h1 id="spring-cloud-gateway-oauth2-实现统一认证和鉴权" tabindex="-1"> Spring Cloud Gateway + Oauth2 实现统一认证和鉴权</h1>
<h2 id="摘要" tabindex="-1"> 摘要</h2>
<p>最近发现了一个很好的微服务权限解决方案，可以通过认证服务进行统一认证，然后通过网关来统一校验认证和鉴权。此方案为目前最新方案，仅支持Spring Boot 2.2.0、Spring Cloud Hoxton 以上版本，本文将详细介绍该方案的实现，希望对大家有所帮助！</p>
<h2 id="前置知识" tabindex="-1"> 前置知识</h2>
<blockquote>
<p>我们将采用Nacos作为注册中心，Gateway作为网关，使用<code>nimbus-jose-jwt</code>JWT库操作JWT令牌</p>
</blockquote>
<h2 id="应用架构" tabindex="-1"> 应用架构</h2>
<blockquote>
<p>我们理想的解决方案应该是这样的，认证服务负责认证，网关负责校验认证和鉴权，其他API服务负责处理自己的业务逻辑。安全相关的逻辑只存在于认证服务和网关服务中，其他服务只是单纯地提供服务而没有任何安全相关逻辑。</p>
</blockquote>
<p>相关服务划分：</p>
<ul>
<li>micro-oauth2-gateway：网关服务，负责请求转发和鉴权功能，整合Spring Security+Oauth2；</li>
<li>micro-oauth2-auth：Oauth2认证服务，负责对登录用户进行认证，整合Spring Security+Oauth2；</li>
<li>micro-oauth2-api：受保护的API服务，用户鉴权通过后可以访问该服务，不整合Spring Security+Oauth2。</li>
</ul>
<h2 id="方案实现" tabindex="-1"> 方案实现</h2>
<blockquote>
<p>下面介绍下这套解决方案的具体实现，依次搭建认证服务、网关服务和API服务。</p>
</blockquote>
<h3 id="micro-oauth2-auth" tabindex="-1"> micro-oauth2-auth</h3>
<blockquote>
<p>我们首先来搭建认证服务，它将作为Oauth2的认证服务使用，并且网关服务的鉴权功能也需要依赖它。</p>
</blockquote>
<ul>
<li>在<code>pom.xml</code>中添加相关依赖，主要是Spring Security、Oauth2、JWT、Redis相关依赖；</li>
</ul>
<div><pre><code>&lt;dependencies>
    &lt;dependency>
        &lt;groupId>org.springframework.boot&lt;/groupId>
        &lt;artifactId>spring-boot-starter-web&lt;/artifactId>
    &lt;/dependency>
    &lt;dependency>
        &lt;groupId>org.springframework.boot&lt;/groupId>
        &lt;artifactId>spring-boot-starter-security&lt;/artifactId>
    &lt;/dependency>
    &lt;dependency>
        &lt;groupId>org.springframework.cloud&lt;/groupId>
        &lt;artifactId>spring-cloud-starter-oauth2&lt;/artifactId>
    &lt;/dependency>
    &lt;dependency>
        &lt;groupId>com.nimbusds&lt;/groupId>
        &lt;artifactId>nimbus-jose-jwt&lt;/artifactId>
        &lt;version>8.16&lt;/version>
    &lt;/dependency>
    &lt;!-- redis -->
    &lt;dependency>
        &lt;groupId>org.springframework.boot&lt;/groupId>
        &lt;artifactId>spring-boot-starter-data-redis&lt;/artifactId>
    &lt;/dependency>
&lt;/dependencies>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>在<code>application.yml</code>中添加相关配置，主要是Nacos和Redis相关配置；</li>
</ul>
<div><pre><code>server:
  port: 9401
spring:
  profiles:
    active: dev
  application:
    name: micro-oauth2-auth
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
  jackson:
    date-format: yyyy-MM-dd HH:mm:ss
  redis:
    database: 0
    port: 6379
    host: localhost
    password: 
management:
  endpoints:
    web:
      exposure:
        include: "*"
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>使用<code>keytool</code>生成RSA证书<code>jwt.jks</code>，复制到<code>resource</code>目录下，在JDK的<code>bin</code>目录下使用如下命令即可；</li>
</ul>
<div><pre><code>keytool -genkey -alias jwt -keyalg RSA -keystore jwt.jks
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><ul>
<li>创建<code>UserServiceImpl</code>类实现Spring Security的<code>UserDetailsService</code>接口，用于加载用户信息；</li>
</ul>
<div><pre><code>/**
 * 用户管理业务类
 * Created by macro on 2020/6/19.
 */
@Service
public class UserServiceImpl implements UserDetailsService {

    private List&lt;UserDTO> userList;
    @Autowired
    private PasswordEncoder passwordEncoder;

    @PostConstruct
    public void initData() {
        String password = passwordEncoder.encode("123456");
        userList = new ArrayList&lt;>();
        userList.add(new UserDTO(1L,"macro", password,1, CollUtil.toList("ADMIN")));
        userList.add(new UserDTO(2L,"andy", password,1, CollUtil.toList("TEST")));
    }

    @Override
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
        List&lt;UserDTO> findUserList = userList.stream().filter(item -> item.getUsername().equals(username)).collect(Collectors.toList());
        if (CollUtil.isEmpty(findUserList)) {
            throw new UsernameNotFoundException(MessageConstant.USERNAME_PASSWORD_ERROR);
        }
        SecurityUser securityUser = new SecurityUser(findUserList.get(0));
        if (!securityUser.isEnabled()) {
            throw new DisabledException(MessageConstant.ACCOUNT_DISABLED);
        } else if (!securityUser.isAccountNonLocked()) {
            throw new LockedException(MessageConstant.ACCOUNT_LOCKED);
        } else if (!securityUser.isAccountNonExpired()) {
            throw new AccountExpiredException(MessageConstant.ACCOUNT_EXPIRED);
        } else if (!securityUser.isCredentialsNonExpired()) {
            throw new CredentialsExpiredException(MessageConstant.CREDENTIALS_EXPIRED);
        }
        return securityUser;
    }

}
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>添加认证服务相关配置<code>Oauth2ServerConfig</code>，需要配置加载用户信息的服务<code>UserServiceImpl</code>及RSA的钥匙对<code>KeyPair</code>；</li>
</ul>
<div><pre><code>/**
 * 认证服务器配置
 * Created by macro on 2020/6/19.
 */
@AllArgsConstructor
@Configuration
@EnableAuthorizationServer
public class Oauth2ServerConfig extends AuthorizationServerConfigurerAdapter {

    private final PasswordEncoder passwordEncoder;
    private final UserServiceImpl userDetailsService;
    private final AuthenticationManager authenticationManager;
    private final JwtTokenEnhancer jwtTokenEnhancer;

    @Override
    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {
        clients.inMemory()
                .withClient("client-app")
                .secret(passwordEncoder.encode("123456"))
                .scopes("all")
                .authorizedGrantTypes("password", "refresh_token")
                .accessTokenValiditySeconds(3600)
                .refreshTokenValiditySeconds(86400);
    }

    @Override
    public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {
        TokenEnhancerChain enhancerChain = new TokenEnhancerChain();
        List&lt;TokenEnhancer> delegates = new ArrayList&lt;>();
        delegates.add(jwtTokenEnhancer); 
        delegates.add(accessTokenConverter());
        enhancerChain.setTokenEnhancers(delegates); //配置JWT的内容增强器
        endpoints.authenticationManager(authenticationManager)
                .userDetailsService(userDetailsService) //配置加载用户信息的服务
                .accessTokenConverter(accessTokenConverter())
                .tokenEnhancer(enhancerChain);
    }

    @Override
    public void configure(AuthorizationServerSecurityConfigurer security) throws Exception {
        security.allowFormAuthenticationForClients();
    }

    @Bean
    public JwtAccessTokenConverter accessTokenConverter() {
        JwtAccessTokenConverter jwtAccessTokenConverter = new JwtAccessTokenConverter();
        jwtAccessTokenConverter.setKeyPair(keyPair());
        return jwtAccessTokenConverter;
    }

    @Bean
    public KeyPair keyPair() {
        //从classpath下的证书中获取秘钥对
        KeyStoreKeyFactory keyStoreKeyFactory = new KeyStoreKeyFactory(new ClassPathResource("jwt.jks"), "123456".toCharArray());
        return keyStoreKeyFactory.getKeyPair("jwt", "123456".toCharArray());
    }

}
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>如果你想往JWT中添加自定义信息的话，比如说<code>登录用户的ID</code>，可以自己实现<code>TokenEnhancer</code>接口；</li>
</ul>
<div><pre><code>/**
 * JWT内容增强器
 * Created by macro on 2020/6/19.
 */
@Component
public class JwtTokenEnhancer implements TokenEnhancer {
    @Override
    public OAuth2AccessToken enhance(OAuth2AccessToken accessToken, OAuth2Authentication authentication) {
        SecurityUser securityUser = (SecurityUser) authentication.getPrincipal();
        Map&lt;String, Object> info = new HashMap&lt;>();
        //把用户ID设置到JWT中
        info.put("id", securityUser.getId());
        ((DefaultOAuth2AccessToken) accessToken).setAdditionalInformation(info);
        return accessToken;
    }
}
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>由于我们的网关服务需要RSA的公钥来验证签名是否合法，所以认证服务需要有个接口把公钥暴露出来；</li>
</ul>
<div><pre><code>/**
 * 获取RSA公钥接口
 * Created by macro on 2020/6/19.
 */
@RestController
public class KeyPairController {

    @Autowired
    private KeyPair keyPair;

    @GetMapping("/rsa/publicKey")
    public Map&lt;String, Object> getKey() {
        RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic();
        RSAKey key = new RSAKey.Builder(publicKey).build();
        return new JWKSet(key).toJSONObject();
    }

}
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>不要忘了还需要配置Spring Security，允许获取公钥接口的访问；</li>
</ul>
<div><pre><code>/**
 * SpringSecurity配置
 * Created by macro on 2020/6/19.
 */
@Configuration
@EnableWebSecurity
public class WebSecurityConfig extends WebSecurityConfigurerAdapter {

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.authorizeRequests()
                .requestMatchers(EndpointRequest.toAnyEndpoint()).permitAll()
                .antMatchers("/rsa/publicKey").permitAll()
                .anyRequest().authenticated();
    }

    @Bean
    @Override
    public AuthenticationManager authenticationManagerBean() throws Exception {
        return super.authenticationManagerBean();
    }

    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }

}
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>创建一个资源服务<code>ResourceServiceImpl</code>，初始化的时候把资源与角色匹配关系缓存到Redis中，方便网关服务进行鉴权的时候获取。</li>
</ul>
<div><pre><code>/**
 * 资源与角色匹配关系管理业务类
 * Created by macro on 2020/6/19.
 */
@Service
public class ResourceServiceImpl {

    private Map&lt;String, List&lt;String>> resourceRolesMap;
    @Autowired
    private RedisTemplate&lt;String,Object> redisTemplate;

    @PostConstruct
    public void initData() {
        resourceRolesMap = new TreeMap&lt;>();
        resourceRolesMap.put("/api/hello", CollUtil.toList("ADMIN"));
        resourceRolesMap.put("/api/user/currentUser", CollUtil.toList("ADMIN", "TEST"));
        redisTemplate.opsForHash().putAll(RedisConstant.RESOURCE_ROLES_MAP, resourceRolesMap);
    }
}
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="micro-oauth2-gateway" tabindex="-1"> micro-oauth2-gateway</h3>
<blockquote>
<p>接下来我们就可以搭建网关服务了，它将作为Oauth2的资源服务、客户端服务使用，对访问微服务的请求进行统一的校验认证和鉴权操作。</p>
</blockquote>
<ul>
<li>在<code>pom.xml</code>中添加相关依赖，主要是Gateway、Oauth2和JWT相关依赖；</li>
</ul>
<div><pre><code>&lt;dependencies>
    &lt;dependency>
        &lt;groupId>org.springframework.boot&lt;/groupId>
        &lt;artifactId>spring-boot-starter-webflux&lt;/artifactId>
    &lt;/dependency>
    &lt;dependency>
        &lt;groupId>org.springframework.cloud&lt;/groupId>
        &lt;artifactId>spring-cloud-starter-gateway&lt;/artifactId>
    &lt;/dependency>
    &lt;dependency>
        &lt;groupId>org.springframework.security&lt;/groupId>
        &lt;artifactId>spring-security-config&lt;/artifactId>
    &lt;/dependency>
    &lt;dependency>
        &lt;groupId>org.springframework.security&lt;/groupId>
        &lt;artifactId>spring-security-oauth2-resource-server&lt;/artifactId>
    &lt;/dependency>
    &lt;dependency>
        &lt;groupId>org.springframework.security&lt;/groupId>
        &lt;artifactId>spring-security-oauth2-client&lt;/artifactId>
    &lt;/dependency>
    &lt;dependency>
        &lt;groupId>org.springframework.security&lt;/groupId>
        &lt;artifactId>spring-security-oauth2-jose&lt;/artifactId>
    &lt;/dependency>
    &lt;dependency>
        &lt;groupId>com.nimbusds&lt;/groupId>
        &lt;artifactId>nimbus-jose-jwt&lt;/artifactId>
        &lt;version>8.16&lt;/version>
    &lt;/dependency>
&lt;/dependencies>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>在<code>application.yml</code>中添加相关配置，主要是路由规则的配置、Oauth2中RSA公钥的配置及路由白名单的配置；</li>
</ul>
<div><pre><code>server:
  port: 9201
spring:
  profiles:
    active: dev
  application:
    name: micro-oauth2-gateway
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
    gateway:
      routes: #配置路由规则
        - id: oauth2-api-route
          uri: lb://micro-oauth2-api
          predicates:
            - Path=/api/**
          filters:
            - StripPrefix=1
        - id: oauth2-auth-route
          uri: lb://micro-oauth2-auth
          predicates:
            - Path=/auth/**
          filters:
            - StripPrefix=1
      discovery:
        locator:
          enabled: true #开启从注册中心动态创建路由的功能
          lower-case-service-id: true #使用小写服务名，默认是大写
  security:
    oauth2:
      resourceserver:
        jwt:
          jwk-set-uri: 'http://localhost:9401/rsa/publicKey' #配置RSA的公钥访问地址
  redis:
    database: 0
    port: 6379
    host: localhost
    password: 
secure:
  ignore:
    urls: #配置白名单路径
      - "/actuator/**"
      - "/auth/oauth/token"
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>对网关服务进行配置安全配置，由于Gateway使用的是<code>WebFlux</code>，所以需要使用<code>@EnableWebFluxSecurity</code>注解开启；</li>
</ul>
<div><pre><code>/**
 * 资源服务器配置
 * Created by macro on 2020/6/19.
 */
@AllArgsConstructor
@Configuration
@EnableWebFluxSecurity
public class ResourceServerConfig {
    private final AuthorizationManager authorizationManager;
    private final IgnoreUrlsConfig ignoreUrlsConfig;
    private final RestfulAccessDeniedHandler restfulAccessDeniedHandler;
    private final RestAuthenticationEntryPoint restAuthenticationEntryPoint;

    @Bean
    public SecurityWebFilterChain springSecurityFilterChain(ServerHttpSecurity http) {
        http.oauth2ResourceServer().jwt()
                .jwtAuthenticationConverter(jwtAuthenticationConverter());
        http.authorizeExchange()
                .pathMatchers(ArrayUtil.toArray(ignoreUrlsConfig.getUrls(),String.class)).permitAll()//白名单配置
                .anyExchange().access(authorizationManager)//鉴权管理器配置
                .and().exceptionHandling()
                .accessDeniedHandler(restfulAccessDeniedHandler)//处理未授权
                .authenticationEntryPoint(restAuthenticationEntryPoint)//处理未认证
                .and().csrf().disable();
        return http.build();
    }

    @Bean
    public Converter&lt;Jwt, ? extends Mono&lt;? extends AbstractAuthenticationToken>> jwtAuthenticationConverter() {
        JwtGrantedAuthoritiesConverter jwtGrantedAuthoritiesConverter = new JwtGrantedAuthoritiesConverter();
        jwtGrantedAuthoritiesConverter.setAuthorityPrefix(AuthConstant.AUTHORITY_PREFIX);
        jwtGrantedAuthoritiesConverter.setAuthoritiesClaimName(AuthConstant.AUTHORITY_CLAIM_NAME);
        JwtAuthenticationConverter jwtAuthenticationConverter = new JwtAuthenticationConverter();
        jwtAuthenticationConverter.setJwtGrantedAuthoritiesConverter(jwtGrantedAuthoritiesConverter);
        return new ReactiveJwtAuthenticationConverterAdapter(jwtAuthenticationConverter);
    }

}
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>在<code>WebFluxSecurity</code>中自定义鉴权操作需要实现<code>ReactiveAuthorizationManager</code>接口；</li>
</ul>
<div><pre><code>/**
 * 鉴权管理器，用于判断是否有资源的访问权限
 * Created by macro on 2020/6/19.
 */
@Component
public class AuthorizationManager implements ReactiveAuthorizationManager&lt;AuthorizationContext> {
    @Autowired
    private RedisTemplate&lt;String,Object> redisTemplate;

    @Override
    public Mono&lt;AuthorizationDecision> check(Mono&lt;Authentication> mono, AuthorizationContext authorizationContext) {
        //从Redis中获取当前路径可访问角色列表
        URI uri = authorizationContext.getExchange().getRequest().getURI();
        Object obj = redisTemplate.opsForHash().get(RedisConstant.RESOURCE_ROLES_MAP, uri.getPath());
        List&lt;String> authorities = Convert.toList(String.class,obj);
        authorities = authorities.stream().map(i -> i = AuthConstant.AUTHORITY_PREFIX + i).collect(Collectors.toList());
        //认证通过且角色匹配的用户可访问当前路径
        return mono
                .filter(Authentication::isAuthenticated)
                .flatMapIterable(Authentication::getAuthorities)
                .map(GrantedAuthority::getAuthority)
                .any(authorities::contains)
                .map(AuthorizationDecision::new)
                .defaultIfEmpty(new AuthorizationDecision(false));
    }

}
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>这里我们还需要实现一个全局过滤器<code>AuthGlobalFilter</code>，当鉴权通过后将JWT令牌中的用户信息解析出来，然后存入请求的Header中，这样后续服务就不需要解析JWT令牌了，可以直接从请求的Header中获取到用户信息。</li>
</ul>
<div><pre><code>/**
 * 将登录用户的JWT转化成用户信息的全局过滤器
 * Created by macro on 2020/6/17.
 */
@Component
public class AuthGlobalFilter implements GlobalFilter, Ordered {

    private static Logger LOGGER = LoggerFactory.getLogger(AuthGlobalFilter.class);

    @Override
    public Mono&lt;Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        String token = exchange.getRequest().getHeaders().getFirst("Authorization");
        if (StrUtil.isEmpty(token)) {
            return chain.filter(exchange);
        }
        try {
            //从token中解析用户信息并设置到Header中去
            String realToken = token.replace("Bearer ", "");
            JWSObject jwsObject = JWSObject.parse(realToken);
            String userStr = jwsObject.getPayload().toString();
            LOGGER.info("AuthGlobalFilter.filter() user:{}",userStr);
            ServerHttpRequest request = exchange.getRequest().mutate().header("user", userStr).build();
            exchange = exchange.mutate().request(request).build();
        } catch (ParseException e) {
            e.printStackTrace();
        }
        return chain.filter(exchange);
    }

    @Override
    public int getOrder() {
        return 0;
    }
}

复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="micro-oauth2-api" tabindex="-1"> micro-oauth2-api</h3>
<blockquote>
<p>最后我们搭建一个API服务，它不会集成和实现任何安全相关逻辑，全靠网关来保护它。</p>
</blockquote>
<ul>
<li>在<code>pom.xml</code>中添加相关依赖，就添加了一个web依赖；</li>
</ul>
<div><pre><code>&lt;dependencies>
    &lt;dependency>
        &lt;groupId>org.springframework.boot&lt;/groupId>
        &lt;artifactId>spring-boot-starter-web&lt;/artifactId>
    &lt;/dependency>
&lt;/dependencies>
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>在<code>application.yml</code>添加相关配置，很常规的配置；</li>
</ul>
<div><pre><code>server:
  port: 9501
spring:
  profiles:
    active: dev
  application:
    name: micro-oauth2-api
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
management:
  endpoints:
    web:
      exposure:
        include: "*"
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>创建一个测试接口，网关验证通过即可访问；</li>
</ul>
<div><pre><code>/**
 * 测试接口
 * Created by macro on 2020/6/19.
 */
@RestController
public class HelloController {

    @GetMapping("/hello")
    public String hello() {
        return "Hello World.";
    }

}
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>创建一个<code>LoginUserHolder</code>组件，用于从请求的Header中直接获取登录用户信息；</li>
</ul>
<div><pre><code>/**
 * 获取登录用户信息
 * Created by macro on 2020/6/17.
 */
@Component
public class LoginUserHolder {

    public UserDTO getCurrentUser(){
        //从Header中获取用户信息
        ServletRequestAttributes servletRequestAttributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
        HttpServletRequest request = servletRequestAttributes.getRequest();
        String userStr = request.getHeader("user");
        JSONObject userJsonObject = new JSONObject(userStr);
        UserDTO userDTO = new UserDTO();
        userDTO.setUsername(userJsonObject.getStr("user_name"));
        userDTO.setId(Convert.toLong(userJsonObject.get("id")));
        userDTO.setRoles(Convert.toList(String.class,userJsonObject.get("authorities")));
        return userDTO;
    }
}
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>创建一个获取当前用户信息的接口。</li>
</ul>
<div><pre><code>/**
 * 获取登录用户信息接口
 * Created by macro on 2020/6/19.
 */
@RestController
@RequestMapping("/user")
public class UserController{

    @Autowired
    private LoginUserHolder loginUserHolder;

    @GetMapping("/currentUser")
    public UserDTO currentUser() {
        return loginUserHolder.getCurrentUser();
    }

}
复制代码
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="功能演示" tabindex="-1"> 功能演示</h2>
<blockquote>
<p>接下来我们来演示下微服务系统中的统一认证鉴权功能，所有请求均通过网关访问。</p>
</blockquote>
<ul>
<li>在此之前先启动我们的Nacos和Redis服务，然后依次启动<code>micro-oauth2-auth</code>、<code>micro-oauth2-gateway</code>及<code>micro-oauth2-api</code>服务；</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/7/12/17342f6da5ee93bd~tplv-t2oaga2asx-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"></p>
<ul>
<li>使用密码模式获取JWT令牌，访问地址：<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A9201%2Fauth%2Foauth%2Ftoken" target="_blank" rel="noopener noreferrer">http://localhost:9201/auth/oauth/token</a></li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/7/12/17342f6da61f640e~tplv-t2oaga2asx-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"></p>
<ul>
<li>使用获取到的JWT令牌访问需要权限的接口，访问地址：<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A9201%2Fapi%2Fhello" target="_blank" rel="noopener noreferrer">http://localhost:9201/api/hello</a></li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/7/12/17342f6da5591caf~tplv-t2oaga2asx-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"></p>
<ul>
<li>使用获取到的JWT令牌访问获取当前登录用户信息的接口，访问地址：<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A9201%2Fapi%2Fuser%2FcurrentUser" target="_blank" rel="noopener noreferrer">http://localhost:9201/api/user/currentUser</a></li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/7/12/17342f6da6c59fd8~tplv-t2oaga2asx-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"></p>
<ul>
<li>当JWT令牌过期时，使用refresh_token获取新的JWT令牌，访问地址：<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A9201%2Fauth%2Foauth%2Ftoken" target="_blank" rel="noopener noreferrer">http://localhost:9201/auth/oauth/token</a></li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/7/12/17342f6da69ef4c1~tplv-t2oaga2asx-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"></p>
<ul>
<li>使用没有访问权限的<code>andy</code>账号登录，访问接口时会返回如下信息，访问地址：<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A9201%2Fapi%2Fhello" target="_blank" rel="noopener noreferrer">http://localhost:9201/api/hello</a></li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/7/12/17342f6da665d734~tplv-t2oaga2asx-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-09T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Spring Cloud 优雅下线以及灰度发布</title>
    <id>https://blog.ciberviler.top/dev/SpringCloud%E4%BC%98%E9%9B%85%E4%B8%8B%E7%BA%BF%E4%BB%A5%E5%8F%8A%E7%81%B0%E5%BA%A6%E5%8F%91%E5%B8%83.html</id>
    <link href="https://blog.ciberviler.top/dev/SpringCloud%E4%BC%98%E9%9B%85%E4%B8%8B%E7%BA%BF%E4%BB%A5%E5%8F%8A%E7%81%B0%E5%BA%A6%E5%8F%91%E5%B8%83.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">Spring Cloud 优雅下线以及灰度发布</summary>
    <content type="html"><![CDATA[<h1 id="spring-cloud-优雅下线以及灰度发布" tabindex="-1"> Spring Cloud 优雅下线以及灰度发布</h1>
<h2 id="前言" tabindex="-1"> 前言</h2>
<p>在生产环境中，如何保证在服务升级的时候，不影响用户的体验，这个是一个非常重要的问题。如果在我们升级服务的时候，会造成一段时间内的服务不可用，这就是不够优雅的。那什么是优雅的呢？主要就是指在服务升级的时候，不中断整个服务，让用户无感知，进而不会影响用户的体验，这就是优雅的。</p>
<p>实际上，优雅下线是目标，而不是手段，它是一个相对的概念，例如<code>kill PID</code>和<code>kill -9 PID</code>都是暴力杀死服务，相对于<code>kill -9 PID</code>来说，<code>kill PID</code>就是优雅的。但如果单独拿<code>kill PID</code>出来说，我们能说它是优雅的下线策略吗？肯定不是啊，就是这个道理。</p>
<p>因此，本文讲述的优雅下线仅能称之为“相对的优雅下线”，但相对于暴力的杀死服务，已经足够优雅了。常见的优雅解决方案，主要包括优雅下线和灰度发布。而实际上，灰度发布的范围就已经包含优雅下线了。</p>
<p>最后，在本文中，我们主要讲述基于 Spring Cloud 和 Euraka 的优雅下线以及灰度发布。</p>
<h2 id="优雅下线" tabindex="-1"> 优雅下线</h2>
<h3 id="常见的下线方式" tabindex="-1"> 常见的下线方式</h3>
<h5 id="方式一-kill-pid" tabindex="-1"> 方式一：kill PID</h5>
<p>使用方式：kill java进程ID</p>
<p>该方式借助的是 Spring Boot 应用的 <code>Shutdown hook</code>，应用本身的下线也是优雅的，但如果你的服务发现组件使用的是 Eureka，那么默认最长会有 90 秒的延迟，其他应用才会感知到该服务下线，这意味着：该实例下线后的 90 秒内，其他服务仍然可能调用到这个已下线的实例。因此，该方式是不够优雅的 。</p>
<h5 id="方式二-shutdown端点" tabindex="-1"> 方式二：/shutdown端点</h5>
<p>Spring Boot 提供了<code>/shutdown</code>端点，可以借助它实现优雅停机。</p>
<p>使用方式：在想下线应用的application.yml中添加如下配置，从而启用并暴露<code>/shutdown</code>端点：</p>
<div><pre><code><span>management</span><span>:</span>
  <span>endpoint</span><span>:</span>
    <span>shutdown</span><span>:</span>
      <span>enabled</span><span>:</span> <span>true</span>
  <span>endpoints</span><span>:</span>
    <span>web</span><span>:</span>
      <span>exposure</span><span>:</span>
        <span>include</span><span>:</span> shutdown
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>发送 POST 请求到/shutdown端点</p>
<div><pre><code><span>curl</span> -X POST http://你想停止的服务地址/actuator/shutdown
</code></pre><div aria-hidden="true"><div></div></div></div><p>该方式本质和方式一是一样的，也是借助 Spring Boot 应用的 Shutdown hook 去实现的。</p>
<h5 id="方式三-pause端点" tabindex="-1"> 方式三：/pause端点</h5>
<p>Spring Boot 应用提供了<code>/pause</code>端点，利用该端点可实现优雅下线。</p>
<p>使用方式：在想下线应用的application.yml中添加配置，从而启用并暴露<code>/pause</code>端点：</p>
<div><pre><code><span>management</span><span>:</span>
  <span>endpoint</span><span>:</span>
    <span># 启用pause端点</span>
    <span>pause</span><span>:</span>
      <span>enabled</span><span>:</span> <span>true</span>
    <span># 启用restart端点，之所以要启用restart端点，是因为pause端点的启用依赖restart端点的启用</span>
    <span>restart</span><span>:</span>
      <span>enabled</span><span>:</span> <span>true</span>
  <span>endpoints</span><span>:</span>
    <span>web</span><span>:</span>
      <span>exposure</span><span>:</span>
        <span>include</span><span>:</span> pause<span>,</span>restart
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>发送 POST 请求到<code>/actuator/pause</code>端点：</p>
<div><pre><code><span>curl</span> -X POST http://你想停止的服务实例地址/actuator/pause
</code></pre><div aria-hidden="true"><div></div></div></div><p>执行后的效果类似下图：</p>
<p><img src="https://img-blog.csdnimg.cn/20201019194250166.png" alt="image-20220411090258141" loading="lazy"></p>
<p>如图所示，该应用在 Eureka Server 上的状已被标记为DOWN，但是应用本身其实依然是可以正常对外服务的。在 Spring Cloud 中，Ribbon 做负载均衡时，只会负载到标记为UP的实例上。</p>
<p>利用这两点，你可以：先用<code>/pause</code>端点，将要下线的应用标记为DOWN，但不去真正停止应用；然后过一定的时间（例如 90 秒，或者自己做个监控，看当前实例的流量变成 0 后）再去停止应用，例如<code>kill</code>应用。</p>
<p><strong>缺点 &amp; 局限</strong></p>
<table>
<thead>
<tr>
<th>缺点</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>不同的版本配置不大一样</td>
<td>早期的 Spring Cloud 版本中，pause端点是不依赖restart端点的</td>
</tr>
<tr>
<td>无法和 Eureka 的健康检查配合使用</td>
<td>如果你的服务发现组件用的是 Eureka，并且你的应用开启了健康检查eureka.client.healthcheck.enabled = true，那么/pause端点无效</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="方式四-service-registry端点" tabindex="-1"> 方式四：/service-registry端点</h5>
<p>使用方式：在想下线应用的application.yml中添加配置，从而暴露<code>/service-registry</code>端点：</p>
<div><pre><code><span>management</span><span>:</span>
  <span>endpoints</span><span>:</span>
    <span>web</span><span>:</span>
      <span>exposure</span><span>:</span>
        <span>include</span><span>:</span> service<span>-</span>registry
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>发送 POST 请求到<code>/actuator/service-registry</code>端点：</p>
<div><pre><code><span>curl</span> -X <span>"POST"</span> <span>"http://localhost:8000/actuator/service-registry?status=DOWN"</span> <span>\</span>
   -H <span>"Content-Type: application/vnd.spring-boot.actuator.v2+json;charset=UTF-8"</span>
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><p>实行后的效果类似如下图：</p>
<p><img src="https://img-blog.csdnimg.cn/20201019194250166.png" alt="图片" loading="lazy"></p>
<h3 id="优雅的下线方式" tabindex="-1"> 优雅的下线方式</h3>
<p>在上文中，我们讲述了四种常见的下线方式，对比来看，方式四 是一种比较优雅的下线方式。</p>
<p>在实际项目中，我们可以先使用<code>/service-registry</code>端点，将服务标记为DOWN，然后监控服务的流量，当流量为 0 时，即可升级该服务。当然，这里假设我们部署了多个服务实例，当一个服务实例DOWN掉之后，其他服务实例仍然是可以提供服务的，如果就部署一台服务的话，那么讨论优不优雅就没那么重要了。</p>
<p>除了上述的下线方式之外，还有一种利用<code>EurekaAutoServiceRegistration</code>对象达到优雅下线的目标。</p>
<ul>
<li>执行<code>eurekaAutoServiceRegistration.start()</code>方法时，当前服务向 Eureka 注册中心注册服务；</li>
<li>执行<code>eurekaAutoServiceRegistration.stop()</code>方法时，当前服务会向 Eureka 注册中心进行反注册，<a href="http://mp.weixin.qq.com/s?__biz=MzI4Njc5NjM1NQ==&amp;mid=2247501632&amp;idx=2&amp;sn=ddf7d315f391456b7f8327f64babe1c6&amp;chksm=ebd5f86cdca2717a93a3582480771f03ba97e1a0e161e40ab8e2933e9fe21458d9d5c30dc572&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">注册中心</a>收到请求后，会将此服务从注册列表中删除。</li>
</ul>
<p>示例代码如下：</p>
<div><pre><code><span>@RestController</span>
<span>@RequestMapping</span><span>(</span>value <span>=</span> <span>"/graceful/registry-service"</span><span>)</span>
<span>public</span> <span>class</span> <span>GracefulOffline</span> <span>{</span>

    <span>@Autowired</span>
    <span>private</span> <span>EurekaAutoServiceRegistration</span> eurekaAutoServiceRegistration<span>;</span>

    <span>@RequestMapping</span><span>(</span><span>"/online"</span><span>)</span>
    <span>public</span> <span>String</span> <span>online</span><span>(</span><span>)</span> <span>{</span>
        <span>this</span><span>.</span>eurekaAutoServiceRegistration<span>.</span><span>start</span><span>(</span><span>)</span><span>;</span>
        <span>return</span> <span>"execute online method, online success."</span><span>;</span>
    <span>}</span>

    <span>@RequestMapping</span><span>(</span><span>"/offline"</span><span>)</span>
    <span>public</span> <span>String</span> <span>offline</span><span>(</span><span>)</span> <span>{</span>
        <span>this</span><span>.</span>eurekaAutoServiceRegistration<span>.</span><span>stop</span><span>(</span><span>)</span><span>;</span>
        <span>return</span> <span>"execute offline method, offline success."</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>到这里，我们已经介绍了两种相对优雅的下线方式了。具体如何操作，我们可以根据实际上情况进行包装，或者利用自动化的脚本来实现更加优雅的下线方式。</p>
<h2 id="灰度发布" tabindex="-1"> 灰度发布</h2>
<h3 id="蓝绿部署" tabindex="-1"> 蓝绿部署</h3>
<p>蓝绿部署，英文名为 Blue Green Deployment，<strong>是一种可以保证系统在不间断提供服务的情况下上线的部署方式。</strong></p>
<p>如何保证系统不间断提供服务呢？那就是同时部署两个集群，但仅对外提供一个集群的服务，当需要升级时，切换集群进行升级。蓝绿部署无需停机，并且风险较小。其大致步骤为：</p>
<ul>
<li>部署集群 1 的应用（初始状态），将所有外部请求的流量都打到这个集群上</li>
<li>部署集群 2 的应用，集群 2 的代码与集群 1 不同，如新功能或者 Bug 修复等</li>
<li>将流量从集群 1 切换到集群 2</li>
<li>如集群 2 测试正常，就删除集群 1 正在使用的资源（例如实例），使用集群 2 对外提供服务</li>
</ul>
<p>因为在使用蓝绿部署的方式时，我们需要控制流量，所以我们需要借助路由服务，如 Nginx 等。</p>
<h3 id="滚动部署" tabindex="-1"> 滚动部署</h3>
<p>滚动部署，英文名为 Rolling Update，同样是一种可以保证系统在不间断提供服务的情况下上线的部署方式。和蓝绿部署不同的是，滚动部署对外提供服务的版本并不是非此即彼，而是在更细的粒度下平滑完成版本的升级。</p>
<p>如何做到细粒度平滑升级版本呢？滚动部署只需要一个<a href="http://mp.weixin.qq.com/s?__biz=MzI4Njc5NjM1NQ==&amp;mid=2247504258&amp;idx=1&amp;sn=ae3c5ef6591a48dcab42f45ebc25f448&amp;chksm=ebd5eeaedca267b8544c595845e230ec710a9fd108cc70caeed13c496290740ffcbb7708d6d6&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">集群</a>，集群下的不同节点可以独立进行版本升级。比如在一个 12 节点的集群中，我们每次升级 4 个节点，并将升级后的节点重新投入使用，周而复始，直到集群中所有的节点都更新为新版本。</p>
<p>**这种部署方式相对于蓝绿部署，更加节约资源，因为它不需要运行两个集群。**但这种方式也有很多缺点，例如：</p>
<ul>
<li>**没有一个确定 OK 的环境。**使用蓝绿部署，我们能够清晰地知道老版本是 OK 的，而使用滚动发布，我们无法确定。</li>
<li><strong>修改了现有的环境。</strong></li>
<li>**如果需要回滚，很困难。**举个例子，在某一次发布中，我们需要更新 100 个实例，每次更新 10 个实例，每次部署需要 5 分钟。当滚动发布到第 80 个实例时，发现了问题，需要回滚。这时，我们估计就要疯了。</li>
<li>有的时候，我们还可能对系统进行动态伸缩，如果部署期间，**系统自动扩容/缩容了，我们还需判断到底哪个节点使用的是哪个代码。**尽管有一些自动化的运维工具，但是依然令人心惊胆战。</li>
</ul>
<p>并不是说滚动发布不好，滚动发布也有它非常合适的场景。</p>
<h3 id="金丝雀部署" tabindex="-1"> 金丝雀部署</h3>
<p>金丝雀部署又称灰度部署（或者，灰度发布），英文名为 Canary Deployment，<strong>是指在黑与白之间，能够平滑过渡的一种发布方式</strong>。</p>
<p>金丝雀的名称来源于「矿井中的金丝雀」，早在 17 世纪，英国矿井工人发现，金丝雀对瓦斯这种气体十分敏感，空气中哪怕有极其微量的瓦斯，金丝雀也会停止歌唱；而当瓦斯含量超过一定限度时，虽然鲁钝的人类毫无察觉，金丝雀却早已毒发身亡。当时在采矿设备相对简陋的条件下，工人们每次下井都会带上一只金丝雀作为“瓦斯检测指标”，以便在危险状况下紧急撤离。</p>
<p>我们来看一下金丝雀部署的步骤：</p>
<ul>
<li>准备好部署各个阶段的工件，包括：<strong>构建工件，测试脚本，配置文件和部署清单文件</strong></li>
<li>从负载均衡列表中移除掉“金丝雀”服务器</li>
<li>升级“金丝雀”应用（切断原有流量并进行部署）</li>
<li>对应用进行自动化测试</li>
<li>将“金丝雀”服务器重新添加到负载均衡列表中（连通性和健康检查）</li>
<li>如果“金丝雀”在线使用测试成功，升级剩余的其他服务器（否则就回滚）</li>
</ul>
<p>在金丝雀部署中，常常按照用户量设置路由权重，例如 90% 的用户维持使用老版本，10% 的用户尝鲜新版本。不同版本应用共存，经常与 A/B 测试一起使用，用于测试选择多种方案。</p>
<p>金丝雀部署比较典型的例子，就是我们在使用某个应用的时候，该应用邀请我们进行“内测”或者“新版本体验”，如果我们同意了，那么我们就成了金丝雀。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-10T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">fastjson 中JSONObject的常用使用方法</title>
    <id>https://blog.ciberviler.top/dev/fastjson%E4%B8%ADJSONObject%E7%9A%84%E5%B8%B8%E7%94%A8%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95.html</id>
    <link href="https://blog.ciberviler.top/dev/fastjson%E4%B8%ADJSONObject%E7%9A%84%E5%B8%B8%E7%94%A8%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">fastjson 中JSONObject的常用使用方法</summary>
    <content type="html"><![CDATA[<h1 id="fastjson-中jsonobject的常用使用方法" tabindex="-1"> fastjson 中JSONObject的常用使用方法</h1>
<h3 id="_1、导入需要的jar包" tabindex="-1"> 1、导入需要的jar包</h3>
<div><pre><code>		<span><span><span>&lt;</span>dependency</span><span>></span></span>
            <span><span><span>&lt;</span>groupId</span><span>></span></span>net.oschina.zcx7878<span><span><span>&lt;/</span>groupId</span><span>></span></span>
            <span><span><span>&lt;</span>artifactId</span><span>></span></span>fastdfs-client-java<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
            <span><span><span>&lt;</span>version</span><span>></span></span>1.27.0.0<span><span><span>&lt;/</span>version</span><span>></span></span>
        <span><span><span>&lt;/</span>dependency</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>2、常用的方法如下：</p>
<div><pre><code><span>public</span> <span>class</span> <span>Test</span> <span>{</span>
    <span>@org.junit.jupiter.api.Test</span>
    <span>void</span> <span>test</span><span>(</span><span>)</span>  <span>{</span>
        <span>JSONObject</span> jsonObject <span>=</span> <span>new</span> <span>JSONObject</span><span>(</span><span>)</span><span>;</span>
        jsonObject<span>.</span><span>put</span><span>(</span><span>"name"</span><span>,</span><span>"yangjuan"</span><span>)</span><span>;</span>
        jsonObject<span>.</span><span>put</span><span>(</span><span>"age"</span><span>,</span><span>23</span><span>)</span><span>;</span>
        jsonObject<span>.</span><span>put</span><span>(</span><span>"gender"</span><span>,</span><span>"女"</span><span>)</span><span>;</span>
        jsonObject<span>.</span><span>put</span><span>(</span><span>"score"</span><span>,</span><span>false</span><span>)</span><span>;</span>

        <span>//1 get()获取值</span>
        <span>final</span> <span>Object</span> age <span>=</span> jsonObject<span>.</span><span>get</span><span>(</span><span>"age"</span><span>)</span><span>;</span>
        <span>final</span> <span>String</span> age1 <span>=</span> jsonObject<span>.</span><span>getString</span><span>(</span><span>"age"</span><span>)</span>
        <span>//2 containsKey()判断jsonObject 是否含有key</span>
        <span>final</span> <span>boolean</span> name <span>=</span> jsonObject<span>.</span><span>containsKey</span><span>(</span><span>"name"</span><span>)</span><span>;</span>
        <span>//3 isEmpty()判断jsonObject是否为空</span>
        <span>final</span> <span>boolean</span> name1 <span>=</span> jsonObject<span>.</span><span>isEmpty</span><span>(</span><span>)</span><span>;</span>
        <span>//4 remove() 移除对应的key 和value</span>
        <span>final</span> <span>Object</span> score <span>=</span> jsonObject<span>.</span><span>remove</span><span>(</span><span>"score"</span><span>)</span><span>;</span>
        <span>//5 containsValue()判断是否含有该值</span>
        <span>final</span> <span>boolean</span> b <span>=</span> jsonObject<span>.</span><span>containsValue</span><span>(</span><span>23</span><span>)</span><span>;</span>
        <span>//6 size() 判断键值对得数量</span>
        <span>final</span> <span>int</span> size <span>=</span> jsonObject<span>.</span><span>size</span><span>(</span><span>)</span><span>;</span>
        <span>//7 移除一个键值对</span>
        <span>final</span> <span>Object</span> age2 <span>=</span> jsonObject<span>.</span><span>remove</span><span>(</span><span>"age"</span><span>)</span><span>;</span>
        <span>//由于JSONObject是一个map，它还具有map特有的两个方法：</span>
        <span>//.8  Set&lt;String> keySet() ：获取JSONObject中的key，并将其放入Set集合中</span>
        <span>final</span> <span>Set</span><span><span>&lt;</span><span>String</span><span>></span></span> keySet <span>=</span> jsonObject<span>.</span><span>keySet</span><span>(</span><span>)</span><span>;</span>
        <span>for</span> <span>(</span><span>String</span> s1 <span>:</span> keySet<span>)</span> <span>{</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>s1<span>)</span><span>;</span>
        <span>}</span>
        <span>//9.Set&lt;Map.Entry&lt;String, Object>> entrySet()：在循环遍历时使用，取得是键和值的映射关系，Entry就是Map接口中的内部接口</span>
        <span>final</span> <span>Set</span><span><span>&lt;</span><span>Map<span>.</span>Entry</span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span><span>></span></span> entries <span>=</span> jsonObject<span>.</span><span>entrySet</span><span>(</span><span>)</span><span>;</span>
        <span>for</span> <span>(</span><span>Map<span>.</span>Entry</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span></span> entry <span>:</span> entries<span>)</span> <span>{</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>entry<span>.</span><span>getKey</span><span>(</span><span>)</span><span>+</span><span>"==="</span><span>+</span>entry<span>.</span><span>getValue</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>}</span>
        <span>//10 JsonObject转string  toString()  toJSONString()</span>
        <span>final</span> <span>String</span> s1 <span>=</span> jsonObject<span>.</span><span>toString</span><span>(</span><span>)</span><span>;</span>
        <span>final</span> <span>String</span> s3 <span>=</span> jsonObject<span>.</span><span>toJSONString</span><span>(</span><span>)</span><span>;</span>
        <span>//11 JsonObject 转Map</span>
        <span>final</span> <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span><span>Object</span><span>></span></span> parse <span>=</span> <span>(</span><span>Map</span><span>)</span> <span>JSONObject</span><span>.</span><span>parse</span><span>(</span>s1<span>)</span><span>;</span>
        parse<span>.</span><span>entrySet</span><span>(</span><span>)</span><span>;</span>
        <span>for</span> <span>(</span><span>Map<span>.</span>Entry</span> m <span>:</span>parse<span>.</span><span>entrySet</span><span>(</span><span>)</span><span>)</span><span>{</span>
            <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>m<span>.</span><span>getKey</span><span>(</span><span>)</span><span>+</span><span>"===="</span><span>+</span>m<span>.</span><span>getValue</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>}</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>s3<span>)</span><span>;</span>
        <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span>s1<span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-10T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Intellij idea高效使用教程</title>
    <id>https://blog.ciberviler.top/dev/idea-tips.html</id>
    <link href="https://blog.ciberviler.top/dev/idea-tips.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <content type="html"><![CDATA[<h1 id="intellij-idea高效使用教程" tabindex="-1"> Intellij idea高效使用教程</h1>
<h2 id="一-安装插件" tabindex="-1"> 一. 安装插件</h2>
<p><strong>1. Codota 代码智能提示插件</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/14502291ea3f4cafa4dbbf7bd4ffbf55?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p>只要打出首字母就能联想出一整条语句，这也太智能了，还显示了每条语句使用频率。</p>
<p>原因是它学习了我的项目代码，总结出了我的代码偏好。</p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/5354d75dcd344f4abe2117323e245b82?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p><strong>如果让它再加上机器学习，人工智能写代码的时代还会远吗？</strong></p>
<p><strong>2. Key Promoter X 快捷键提示插件</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/c0b8ae097f8241c98c8c883854ef1d7b?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p>每次都会在右下角弹窗提示，帮助我们快速熟悉快捷键。</p>
<p><strong>3. CodeGlance 显示代码缩略图插件</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/8a693ad0e1e544cf91bcd25bf8217e72?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p>当代码很多的时候，方便查看，很有用。</p>
<p><strong>4. Lombok 简化臃肿代码插件</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/7cb0a353d5fa439f8c4ff49fb53d5b0b?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p>实体类中的get/set/构造/toString/hashCode等方法，都不需要我们再手动写了</p>
<p><strong>5. Alibaba Java Coding Guidelines 阿里巴巴代码规范检查插件</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/4cbd3d17c85e4140b6ea2392974ecaf6?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p>会按照阿里Java开发手册上规范帮我们检查代码，然后对代码做不同颜色展示，鼠标放上去，会看到提示内容，帮助我们写出更规范的代码。</p>
<p><strong>6. CamelCase 驼峰命名和下划线命名转换</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/bb6a30de074641a38d8289af714123e7?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p>这几种风格的命名方式，用快捷键 ⇧ + ⌥ + U / Shift + Alt + U可以进行快速转换，当我们需要修改大量变量名称的时候很方便。</p>
<p><strong>7. MybatisX 高效操作Mybatis插件</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/14bf2f1911224f8d9d20350e968221e0?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p><strong>8. SonarLint 代码质量检查插件</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/8f18920331484d05b2996c6551fb19ae?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p>提示我不要用System.out输出，要用logger输出，诸如此类，帮助我们提升代码质量。</p>
<p><strong>9. Save Actions 格式化代码插件</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/bb840418a8294bec9ecbb62e413cc76e?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p>可以帮忙我们优化包导入，自动给没有修改的变量添加final修饰符，调用方法的时候自动添加this关键字等，使我们的代码更规范统一。</p>
<p><strong>10. CheckStyle 代码风格检查插件</strong></p>
<p>功能跟Alibaba Java Coding Guidelines类似</p>
<p><strong>11. Grep Console 自定义控制台输出格式插件</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/6ad33ab81cc7487c88e25d8b7fc8d8a2?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p><strong>12. MetricsReloaded 代码复杂度检查插件</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/71cd828d24e3452db4f3294adeea57cf?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p><strong>13. Statistic 代码统计插件</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/b1079d0eb9d344a88b825b158a27a3b6?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p><strong>14. Translation 翻译插件</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/9f0f1abfd35f430e979a1d755e883f68?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p><strong>15. Rainbow Brackets 彩虹括号插件</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/1c110caa286045a88484e408cf4c390c?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p>成对儿的括号显示相同的颜色，有了这个插件，我的近视都好了。</p>
<h2 id="二-自定义创建live-template-快速写代码" tabindex="-1"> 二. 自定义创建live template，快速写代码</h2>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/ca34ebf0555e4167a6a1b22df79521c5?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p>只要输入<strong>apr</strong>，就能自动提示，并且生成<strong>Autowired</strong>语句了。可以根据自己的代码习惯，自定义一些代码模板，帮助我们快速写代码。</p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/dbdf776104314095b737a7de041dd17f?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<h2 id="三-修改全局配置-提升工作效率" tabindex="-1"> 三. 修改全局配置，提升工作效率</h2>
<p><strong>1. 优化导包配置</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/f49864dd31814de885c68910fdef6c01?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p><strong>2. 取消tab页单行显示</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/98ee419d6c7041308bbabe701acbfbe8?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/5ca9b27a61054b18835cef4a1b8a43b2?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p>多行显示更多的文件，方便查看。</p>
<p><strong>3. 双斜杠注释改成紧跟代码头</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/47220322c3b140528fdc3e1aa9f4eb4b?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/46278e2e7eeb45278e8780143687a5d1?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p><strong>4. 选中复制整行</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/216d2ea622b54612abc9be4e4fd9546c?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/ec7fe392117c4b33952ad37ffd27229c?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p>原本只会复制你选中的代码，改完配置后，就能复制整行，无论你是否完全选中。</p>
<p><strong>5. 取消匹配大小写</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/d0251cc8baae4b3f8e7fa2f0aac37b39?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p>取消勾选后，输入小写 <strong>s</strong>，也能提示出 <strong>String</strong></p>
<p><strong>6. 优化版本控制的目录颜色展示</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/70c159e0ad25498aaaee36474acfa3cb?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p><strong>7. 创建文件时，自动生成作者和时间信息</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/6f8a411ee60046d1b09a7705131c97c3?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p><strong>8 . 显示行号和方法分割线</strong></p>
<p><img src="https://p3.toutiaoimg.com/origin/pgc-image/a050ad86c09e4195aa49759185ce5be2?from=pc" alt="Intellij idea高效使用教程" loading="lazy"></p>
<p><strong>你还知道哪些关于Intelij idea高效操作或插件，一起在评论区分享吧！</strong></p>
<h2 id="idea必备20款插件" tabindex="-1"> IDEA必备20款插件</h2>
<p>以下插件已经为大家下载打包了，如果IDEA版本不一致的话，部分插件可能无法安装，可以根据我提供的地址自行下载相应插件：
插件打包下载地址：<a href="https://www.lanzouw.com/iV3XKwvq2de" target="_blank" rel="noopener noreferrer">https://www.lanzouw.com/iV3XKwvq2de</a></p>
<h3 id="leetcode-editor" tabindex="-1"> Leetcode Editor</h3>
<p>这是一个上班摸鱼神器，也是一个可以在IDEA中刷算法题目的插件，有很多题目供我们学习，
表面在写代码，其实是在刷题。每道题都有很详细的解题思路
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/12132-leetcode-editor" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/12132-leetcode-editor</a></p>
<h3 id="jrebel" tabindex="-1"> Jrebel</h3>
<p>这个插件真的是强烈推荐，有时候改一点点代码都要重启才能生效，很浪费时间。
有了这个插件，修改代码之后不需要重启也能生效。尤其跟别的同事联调的时候特别爽！
热部署插件，这个插件是收费的，但是可以免费激活，
访问这个<a href="https://www.guidgen.xn--comGUID-7t3kgmi98e7f1a111cny1a" target="_blank" rel="noopener noreferrer">https://www.guidgen.com网址生成一个GUID</a>,然后将生成的ID，拼接到下面的URL中，粘贴到激活界面就可以啦
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/4441-jrebel-and-xrebel-for-intellij" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/4441-jrebel-and-xrebel-for-intellij</a>
<a href="https://jrebel.qekang.com/%E4%BD%A0%E7%94%9F%E6%88%90%E7%9A%84ID" target="_blank" rel="noopener noreferrer">https://jrebel.qekang.com/你生成的ID</a></p>
<h3 id="background-image-plus" tabindex="-1"> Background Image Plus</h3>
<p>一个设置背景图片的插件，有时候纯黑或者纯白看腻的话，可以使用这个插件自定义背景图片。
也支持动态的更换壁纸
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/8502-background-image-plus" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/8502-background-image-plus</a></p>
<h3 id="codota" tabindex="-1"> Codota</h3>
<p>IDEA的自动补全功能已经很强大了，但是这个插件的自动补全功能更加强大，这是一个基于AI技术，学习了大量的开源项目，智能提示更加的可靠
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/7638-codota-ai-autocomplete-for-java-and-javascript" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/7638-codota-ai-autocomplete-for-java-and-javascript</a>
有绿色图标的就是codota自动提示的代码</p>
<p>还有个更强的功能是，它可以从github、stackoverflow上快速的找到你想要的相关代码</p>
<h3 id="easycode" tabindex="-1"> EasyCode</h3>
<p>这个插件真的特别强大，它可以通过数据库表自动的生成实体类、Controller、Dao、Service、mapper，简单而且强大。
通过IDEA内置的数据库，在对应的表中右键选择easy code- generate Code，然后选择路径，勾选想要生成的代码就可以啦
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/10954-easy-code" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/10954-easy-code</a></p>
<h3 id="translation" tabindex="-1"> Translation</h3>
<p>这是翻译插件，阅读源码有不认识的英文，或者编写变量时，不知道英文怎么写的时候可以直接进行翻译
在菜单栏上也可以直接进行翻译，不用再去打开一些在线翻译网站了
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/8579-translation" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/8579-translation</a></p>
<h3 id="key-promoter-x" tabindex="-1"> Key Promoter X</h3>
<p>一个可以让你慢慢脱离鼠标操作的插件，在IDEA中操作时，他会将对应的快捷键，进行提示。
并且右侧会有一个列表，将你近期使用的功能进行展示，对于高频操作我们可以使用快捷键，这样可以提升效率
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/9792-key-promoter-x" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/9792-key-promoter-x</a></p>
<h3 id="maven-helper" tabindex="-1"> Maven Helper</h3>
<p>插件下载地址：<a href="https://plugins.jetbrains.com/plugin/7179-maven-helper" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/7179-maven-helper</a>
安装之后，在pom文件中会多出一个Dependcy Analyzer选项卡</p>
<p>Conflicts：显示冲突依赖
All Dependencies as List：以列表形式显示依赖
All Dependencies as Tree：以树的形式显示依赖
遇到冲突的依赖，可以点击右键，跳到源文件或者直接选择Exclude 排除这个依赖</p>
<h3 id="alibaba-java-coding-guidelines" tabindex="-1"> Alibaba Java Coding Guidelines</h3>
<p>阿里巴巴开发的一款插件，可以扫描代码中可能存在的问题
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/10046-alibaba-java-coding-guidelines" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/10046-alibaba-java-coding-guidelines</a></p>
<p>将不符合规约的代码按 Blocker/Critical/Major(崩溃/严重/重要 ) 三个等级显示在下方，双击可以定位至代码处，右侧窗口还有针对代码的批量修复功能。</p>
<h3 id="codeglance" tabindex="-1"> CodeGlance</h3>
<p>用过sublime的同学对这个功能一定很熟悉，它是一个迷你缩放图插件
当代码过长的时候可以使用这个插件，相比如下拉框，这个插件更加的直观和方便
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/7275-codeglance" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/7275-codeglance</a></p>
<h3 id="gsonformat" tabindex="-1"> GsonFormat</h3>
<p>这是一个将Json字符串自动转换成实体类的插件
安装完插件之后，在实体类中使用快捷键 'alt+insert'，mac是‘control + 回车’选择GsonFormat
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/7654-gsonformat" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/7654-gsonformat</a></p>
<h3 id="javadoc" tabindex="-1"> JavaDoc</h3>
<p>这是一个快速生成文档注释的插件
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/7157-javadoc" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/7157-javadoc</a>
windows上可以通过alt + insert 快捷键，mac是control+回车
可以快速生成注释模板</p>
<h3 id="ignore" tabindex="-1"> ignore</h3>
<p>我们在使用git提交项目的时候，有时候会把 .idea 文件提交上去，
这个文件只是一些历史记录，版本信息。完全不用提交。
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/7495--ignore" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/7495--ignore</a>
这个时候可以使用ignore这个插件，去配置
在 File- new - .ignore File· 中选择 gitignore File(Git)
选择Example user template，右侧面板表示要忽略的文件，点击Generate</p>
<h3 id="rainbow-brackets" tabindex="-1"> Rainbow Brackets</h3>
<p>这个插件主要是让我们代码中的括号变成彩虹颜色的括号，除了好看还可以帮我们分清括号，防止错乱
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/10080-rainbow-brackets" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/10080-rainbow-brackets</a></p>
<h3 id="acejump" tabindex="-1"> AceJump</h3>
<p>插件下载地址：<a href="https://plugins.jetbrains.com/plugin/7086-acejump" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/7086-acejump</a>
这是一个快速光标跳转的插件，可以很大的减少我们使用鼠标的频率
可以查看他的激活快捷键 比如我的是ctrl + 分号，</p>
<p>激活之后，输入你想跳转的字符，比如O键，那么当前界面的O都会打上标签，再输入相应的字母跳转到对应的位置</p>
<p>按向上的键，可以行选定，方法跟上面的一致。
按左右键，是选择开头和结尾
RestfulTool
这是一个接口测试工具，
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/14280-restfultool" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/14280-restfultool</a>
安装成功之后在右侧会有一个RestfulTool的选项卡，点击之后会显示出当前项目的所有请求地址
并且支持各种各样的请求类型</p>
<h3 id="material-theme-ui" tabindex="-1"> Material Theme UI</h3>
<p>插件下载地址：<a href="https://plugins.jetbrains.com/plugin/8006-material-theme-ui" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/8006-material-theme-ui</a>
这是一款不错的主题插件，颜值非常的高，安装之后重启即可生效
可以在设置中，对一些细节，比如调整字体、大小、行间距等</p>
<h3 id="generateallsetter" tabindex="-1"> GenerateAllSetter</h3>
<p>插件下载地址：<a href="https://plugins.jetbrains.com/plugin/9360-generateallsetter/versions" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/9360-generateallsetter/versions</a>
这个插件可以快速的对实体类生成set代码，这样就不用我们一个一个的去手动set了
使用方法也非常简单，当我们new一个对象的时候，在对象上使用快简介&quot;alt + 回车&quot;
选择Generate all setter with default value就可以自动生成所有set方法啦</p>
<h3 id="statistic" tabindex="-1"> Statistic</h3>
<p>一款分析项目代码的工具，按照扩展名列出清单，统计代码数量和行数
点击具体的类别，比如Java，可以统计总行数，有效代码行数，注释行数，以及有效代码比重
插件下载地址：<a href="https://plugins.jetbrains.com/plugin/4509-statistic" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/4509-statistic</a></p>
<h3 id="free-mybatis-plugin" tabindex="-1"> Free MyBatis plugin</h3>
<p>插件下载地址：<a href="https://plugins.jetbrains.com/plugin/8321-free-mybatis-plugin" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/8321-free-mybatis-plugin</a>
在使用mybatis时，它可以通过mapper接口中的方法，直接跳转到mapper.xml文件中，
同样也可以从mapper.xml跳转到mapper接口中
非常实用！</p>
<h3 id="stop-coding" tabindex="-1"> Stop Coding</h3>
<p>插件下载地址：<a href="https://plugins.jetbrains.com/plugin/15740-stopcoding" target="_blank" rel="noopener noreferrer">https://plugins.jetbrains.com/plugin/15740-stopcoding</a>
最后推荐大家一下防沉迷代码的插件，如果你也经常沉迷于写代码,忘了起身休息喝水,那么试试这个插件吧</p>
<p>当写代码到设定的时间时,它会弹出下框进行提醒,当然,这个框是关不掉的.只有你休息了足够的时间它才会自动关闭.</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="IDEA" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-03-17T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">Mybatis 建表、删表、查表语句(mysql数据库)</title>
    <id>https://blog.ciberviler.top/dev/mybatis%20%E5%BB%BA%E8%A1%A8%E3%80%81%E5%88%A0%E8%A1%A8%E3%80%81%E6%9F%A5%E8%A1%A8%E8%AF%AD%E5%8F%A5(mysql%E6%95%B0%E6%8D%AE%E5%BA%93).html</id>
    <link href="https://blog.ciberviler.top/dev/mybatis%20%E5%BB%BA%E8%A1%A8%E3%80%81%E5%88%A0%E8%A1%A8%E3%80%81%E6%9F%A5%E8%A1%A8%E8%AF%AD%E5%8F%A5(mysql%E6%95%B0%E6%8D%AE%E5%BA%93).html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">Mybatis 建表、删表、查表语句(mysql数据库)</summary>
    <content type="html"><![CDATA[<h1 id="mybatis-建表、删表、查表语句-mysql数据库" tabindex="-1"> Mybatis 建表、删表、查表语句(mysql数据库)</h1>
<div><pre><code><span>&lt;?xml version="1.0" encoding="UTF-8" ?></span>
<span><span>&lt;!</span><span>DOCTYPE</span> <span>mapper</span> <span>PUBLIC</span> <span>"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span>"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span> <span>></span></span>
<span><span><span>&lt;</span>mapper</span> <span>namespace</span><span><span>=</span><span>"</span>com.crsc.sys.rabbitmq.dao.mysql.DBTableInitMapper<span>"</span></span> <span>></span></span>
 
  <span><span><span>&lt;</span>update</span> <span>id</span><span><span>=</span><span>"</span>createTodomessageTable<span>"</span></span> <span>parameterType</span><span><span>=</span><span>"</span>String<span>"</span></span><span>></span></span>  
	  CREATE TABLE todomessage (
		  id int(11) NOT NULL AUTO_INCREMENT COMMENT 'id',
		  moduleID varchar(255) DEFAULT NULL COMMENT '模块ID',
		  authCode varchar(255) DEFAULT NULL COMMENT '授权码',
		  itemid varchar(100) DEFAULT NULL COMMENT '待办事项ID',
		  statecode varchar(255) DEFAULT '0' COMMENT '任务状态  0待办  1 已办',
		  statePush varchar(4) DEFAULT '0' COMMENT '推送状态 0 未推送  1 已推送',
		  ssolink varchar(255) DEFAULT NULL COMMENT '明细链接',
		  userno varchar(200) DEFAULT NULL COMMENT '所属人员ID',
		  level varchar(255) DEFAULT NULL COMMENT '重要等级',
		  content varchar(255) DEFAULT NULL COMMENT '待办事项内容',
		  datetime datetime DEFAULT NULL COMMENT '生成时间',
		  nodename varchar(255) DEFAULT NULL COMMENT '审批节点',
		  extParameters varchar(500) DEFAULT NULL COMMENT '扩展参数',
		  updatetime datetime DEFAULT NULL COMMENT '修改时间',
		  uid varchar(64) DEFAULT NULL COMMENT 'UUID',
		  taskid varchar(255) DEFAULT NULL,
		  pushtime datetime DEFAULT NULL COMMENT '推送时间',
		  PROC_INST_ID varchar(64) DEFAULT NULL COMMENT '运行实例id',
		  PROC_DEF_ID varchar(64) DEFAULT NULL COMMENT '流程定义id',
		  version int(11) NOT NULL DEFAULT '0' COMMENT '乐观锁',
		  systemKey varchar(255) NOT NULL COMMENT '数据所属系统的key标识',
		  sourcebacaklog varchar(2000) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '发送oa代办数据',
		  sourcefinished varchar(2000) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '发送oa已办数据',
		  backlogtime datetime DEFAULT NULL COMMENT '代办时间',
		  finishedtime datetime DEFAULT NULL COMMENT '已办时间',
		  backlogflag varchar(255) DEFAULT NULL COMMENT '代办标识',
		  finishedflag varchar(255) DEFAULT NULL COMMENT '已办标识',
		  sourcedel varchar(2000) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '发送删除oa代办数据',
		  delbacklogtime datetime DEFAULT NULL COMMENT '删除代办发送oa时间',
		  delflag varchar(255) DEFAULT NULL COMMENT '删除代办标识',
		  formName varchar(255) DEFAULT NULL COMMENT '流程名称',
		  PRIMARY KEY (id) USING BTREE
	) ENGINE=InnoDB AUTO_INCREMENT=1637 DEFAULT CHARSET=utf8                 
  <span><span><span>&lt;/</span>update</span><span>></span></span> 
  
  <span><span><span>&lt;</span>update</span> <span>id</span><span><span>=</span><span>"</span>dropTodomessageTable<span>"</span></span><span>></span></span>  
    drop table todomessage     
  <span><span><span>&lt;/</span>update</span><span>></span></span>
  
  <span><span><span>&lt;</span>select</span> <span>id</span><span><span>=</span><span>"</span>selectTodoMessage<span>"</span></span> <span>resultType</span><span><span>=</span><span>"</span>java.lang.Integer<span>"</span></span><span>></span></span>
  	SELECT COUNT(1) FROM information_schema.tables where table_name ='todomessage'
  <span><span><span>&lt;/</span>select</span><span>></span></span>
  
<span><span><span>&lt;/</span>mapper</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-03T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">使用docker快速安装oracle</title>
    <id>https://blog.ciberviler.top/dev/%E4%BD%BF%E7%94%A8docker%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85oracle.html</id>
    <link href="https://blog.ciberviler.top/dev/%E4%BD%BF%E7%94%A8docker%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85oracle.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">使用docker快速安装oracle</summary>
    <content type="html"><![CDATA[<h1 id="使用docker快速安装oracle" tabindex="-1"> 使用docker快速安装oracle</h1>
<p>1.拉取镜像:</p>
<div><pre><code><span>docker</span> pull registry.cn-hangzhou.aliyuncs.com/helowin/oracle_11g
</code></pre><div aria-hidden="true"><div></div></div></div><p>2.创建容器</p>
<div><pre><code><span>docker</span> run -d -p <span>1521</span>:1521 --name oracle11g registry.cn-hangzhou.aliyuncs.com/helowin/oracle_11g
</code></pre><div aria-hidden="true"><div></div></div></div><p>3.进入镜像配置</p>
<div><pre><code><span>docker</span> <span>exec</span> -it oracle11g <span>bash</span>

<span>su</span> root<span>;</span>

密码:helowin
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><p>编辑环境变量:</p>
<div><pre><code><span>vi</span> /etc/profile
<span>export</span> <span>ORACLE_HOME</span><span>=</span>/home/oracle/app/oracle/product/11.2.0/dbhome_2
<span>export</span> <span>ORACLE_SID</span><span>=</span>helowin
<span>export</span> <span><span>PATH</span></span><span>=</span><span>$ORACLE_HOME</span>/bin:<span>$PATH</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><p>创建软连接</p>
<div><pre><code><span>ln</span> -s <span>$ORACLE_HOME</span>/bin/sqlplus /usr/bin

<span>source</span> /etc/profile
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>切换到oracle 用户</p>
<p><code>su - oracle</code></p>
<p>登录sqlplus并修改sys、system用户密码</p>
<ul>
<li>登录sqlplus</li>
</ul>
<div><pre><code>sqlplus <span>/</span>nolog

conn <span>/</span><span>as</span> sysdba
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><ul>
<li>接着更改用户密码</li>
</ul>
<div><pre><code><span>alter</span> <span>user</span> system identified <span>by</span> system<span>;</span>

<span>alter</span> <span>user</span> sys identified <span>by</span> sys<span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><ul>
<li>设置密码永不过期</li>
</ul>
<div><pre><code><span>ALTER</span> PROFILE <span>DEFAULT</span> <span>LIMIT</span> PASSWORD_LIFE_TIME UNLIMITED<span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div><ul>
<li>
<p>scott用户的开启</p>
<p>SCOTT 是 ORACLE 内部的一个实例用户，下面有 emp、dept 等实例表，这些表和表间的关系演示了关系型数据库的一些基本原理。</p>
</li>
</ul>
<div><pre><code><span>alter</span> <span>user</span> scott account <span>unlock</span><span>;</span>
<span>alter</span> <span>user</span> scott identified <span>by</span> abc<span>;</span>
<span>commit</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>4.重启容器后就可以直接用了</p>
<div><pre><code><span>docker</span> restart oracle11g
</code></pre><div aria-hidden="true"><div></div></div></div><p>现在可以用<code>system</code>用户连接,密码:<code>system</code></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-03-02T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">使用 easypoi 导出 excel 实现动态列</title>
    <id>https://blog.ciberviler.top/dev/%E4%BD%BF%E7%94%A8easypoi%E5%AF%BC%E5%87%BAexcel%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%88%97.html</id>
    <link href="https://blog.ciberviler.top/dev/%E4%BD%BF%E7%94%A8easypoi%E5%AF%BC%E5%87%BAexcel%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%88%97.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">使用 easypoi 导出 excel 实现动态列</summary>
    <content type="html"><![CDATA[<h1 id="使用-easypoi-导出-excel-实现动态列" tabindex="-1"> 使用 easypoi 导出 excel 实现动态列</h1>
<h3 id="说明" tabindex="-1"> 说明</h3>
<ul>
<li>使用的是easypoi进行导出</li>
<li>行头是动态生成</li>
<li>依据key进行列匹配，进行数据填充</li>
<li>第一列进行纵向动态合并</li>
</ul>
<h3 id="工具依赖" tabindex="-1"> 工具依赖</h3>
<div><pre><code><span><span><span>&lt;</span>dependency</span><span>></span></span>
    <span><span><span>&lt;</span>groupId</span><span>></span></span>cn.afterturn<span><span><span>&lt;/</span>groupId</span><span>></span></span>
   <span><span><span>&lt;</span>artifactId</span><span>></span></span>easypoi-base<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
   <span><span><span>&lt;</span>version</span><span>></span></span>3.2.0<span><span><span>&lt;/</span>version</span><span>></span></span>
<span><span><span>&lt;/</span>dependency</span><span>></span></span>
<span><span><span>&lt;</span>dependency</span><span>></span></span>
    <span><span><span>&lt;</span>groupId</span><span>></span></span>cn.afterturn<span><span><span>&lt;/</span>groupId</span><span>></span></span>
   <span><span><span>&lt;</span>artifactId</span><span>></span></span>easypoi-annotation<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
   <span><span><span>&lt;</span>version</span><span>></span></span>3.2.0<span><span><span>&lt;/</span>version</span><span>></span></span>
<span><span><span>&lt;/</span>dependency</span><span>></span></span>
<span><span><span>&lt;</span>dependency</span><span>></span></span>
    <span><span><span>&lt;</span>groupId</span><span>></span></span>cn.afterturn<span><span><span>&lt;/</span>groupId</span><span>></span></span>
   <span><span><span>&lt;</span>artifactId</span><span>></span></span>easypoi-web<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
   <span><span><span>&lt;</span>version</span><span>></span></span>3.2.0<span><span><span>&lt;/</span>version</span><span>></span></span>
<span><span><span>&lt;/</span>dependency</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="实现效果" tabindex="-1"> 实现效果</h3>
<p>变更前样式</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/JfTPiahTHJhqian47myMbgAAXib3tTubM4csic7r2ZwEQBWEnsC0k4Aaq6alNV28H5Gl7iaAo7NIxRn5liayjQTxCyuA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p>变更后样式</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/JfTPiahTHJhqian47myMbgAAXib3tTubM4cAUvrUmnGPYnulOgLpRflnhMsedEKSolpnsNMZicckf5ne7WITAIOZsA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<h3 id="代码解析" tabindex="-1"> 代码解析</h3>
<h5 id="动态生成列头" tabindex="-1"> 动态生成列头</h5>
<div><pre><code>  <span>private</span> <span>List</span><span><span>&lt;</span><span>ExcelExportEntity</span><span>></span></span> <span>dynamicNewAddExcel</span><span>(</span><span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>PlatformStatisParamRespData</span><span>></span></span> paramInfo<span>)</span> <span>{</span>
   <span>//表头的集合，用于添加表头</span>
    <span>List</span><span><span>&lt;</span><span>ExcelExportEntity</span><span>></span></span> entityList <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>

 <span>//ExcelExportEntity构造参数【第一个是列名头的统计字段,第二个是需要指定的一个key在填充数据的时候是需要根据这个key进行填充值,第三个参数是列宽】</span>
    <span>ExcelExportEntity</span> platformXh <span>=</span> <span>new</span> <span>ExcelExportEntity</span><span>(</span><span>"统计字段1"</span><span>,</span> <span>"statisKey1"</span><span>,</span> <span>30</span><span>)</span><span>;</span>
    <span>//列的合并(纵向列的同名称会进行合并,效果见上图的平台名称的变化)</span>
    platformXh<span>.</span><span>setMergeVertical</span><span>(</span><span>true</span><span>)</span><span>;</span>
    entityList<span>.</span><span>add</span><span>(</span>platformXh<span>)</span><span>;</span>

    <span>ExcelExportEntity</span> statisDateXh <span>=</span> <span>new</span> <span>ExcelExportEntity</span><span>(</span><span>"统计字段2"</span><span>,</span> <span>"statisKey2"</span><span>,</span> <span>30</span><span>)</span><span>;</span>
    entityList<span>.</span><span>add</span><span>(</span>statisDateXh<span>)</span><span>;</span>

    <span>//参数信息--[用于动态拼接列头]</span>
    <span>final</span> <span>Iterator</span><span><span>&lt;</span><span>String</span><span>></span></span> iterator <span>=</span> paramInfo<span>.</span><span>keySet</span><span>(</span><span>)</span><span>.</span><span>iterator</span><span>(</span><span>)</span><span>;</span>
    <span>while</span> <span>(</span>iterator<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span> <span>{</span>
      <span>final</span> <span>String</span> paramKeyStr <span>=</span> iterator<span>.</span><span>next</span><span>(</span><span>)</span><span>;</span>
      <span>final</span> <span>String</span> paramNameStr <span>=</span> paramInfo<span>.</span><span>get</span><span>(</span>paramKeyStr<span>)</span><span>.</span><span>getDataName</span><span>(</span><span>)</span><span>;</span>
      <span>//列头由参数汉字名称,参数key为列key</span>
      entityList<span>.</span><span>add</span><span>(</span><span>new</span> <span>ExcelExportEntity</span><span>(</span>paramNameStr<span>,</span> paramKeyStr<span>,</span> <span>30</span><span>)</span><span>)</span><span>;</span>
    <span>}</span>
    <span>return</span> entityList<span>;</span>
  <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h5 id="动态填充数据" tabindex="-1"> 动态填充数据</h5>
<div><pre><code><span>private</span> <span>List</span><span><span>&lt;</span><span>Map</span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span><span>></span></span> <span>dynamicListDataByKey</span><span>(</span><span>List</span><span><span>&lt;</span><span>PlatformIncomeRespDTO</span><span>></span></span> statisData<span>)</span> <span>{</span>
    <span>//参数类型</span>
    <span>final</span> <span>Set</span><span><span>&lt;</span><span>String</span><span>></span></span> statisParamKey <span>=</span> statisData<span>.</span><span>get</span><span>(</span><span>0</span><span>)</span><span>.</span><span>getParamInfo</span><span>(</span><span>)</span><span>.</span><span>keySet</span><span>(</span><span>)</span><span>;</span>
    <span>final</span> <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> statisDate <span>=</span> statisData<span>.</span><span>get</span><span>(</span><span>0</span><span>)</span><span>.</span><span>getStatisDate</span><span>(</span><span>)</span><span>;</span>
    <span>final</span> <span>int</span> platformNum <span>=</span> statisData<span>.</span><span>size</span><span>(</span><span>)</span><span>;</span>

    <span>//最终的数据</span>
    <span>List</span><span><span>&lt;</span><span>Map</span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span><span>></span></span> datas <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
    <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> platformNum<span>;</span> i<span>++</span><span>)</span> <span>{</span>
      <span>for</span> <span>(</span><span>int</span> j <span>=</span> <span>0</span><span>;</span> j <span>&lt;</span> statisDate<span>.</span><span>size</span><span>(</span><span>)</span><span>;</span> j<span>++</span><span>)</span> <span>{</span>
        <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span></span> hashMap <span>=</span> <span>new</span> <span>LinkedHashMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>10</span><span>)</span><span>;</span>
        <span>//这个是依据key进行数据的填充,(根据前面填写的statisKey1进行填充数据)</span>
        hashMap<span>.</span><span>put</span><span>(</span><span>"statisKey1"</span><span>,</span> statisData<span>.</span><span>get</span><span>(</span>i<span>)</span><span>.</span><span>getPlatformNickName</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>String</span> statisDateStr <span>=</span> statisDate<span>.</span><span>get</span><span>(</span>j<span>)</span><span>;</span>
         <span>//这个是依据key进行数据的填充,(根据前面填写的statisKey2进行填充数据)</span>
        hashMap<span>.</span><span>put</span><span>(</span><span>"statisKey2"</span><span>,</span> statisDateStr<span>)</span><span>;</span>
        <span>//参数的验证</span>
        <span>for</span> <span>(</span><span>String</span> paramKey <span>:</span> statisParamKey<span>)</span> <span>{</span>
          <span>for</span> <span>(</span><span>BiPlatformStatisRespDTO</span> paramData <span>:</span> statisData<span>.</span><span>get</span><span>(</span>i<span>)</span><span>.</span><span>getStatisData</span><span>(</span><span>)</span><span>.</span><span>get</span><span>(</span>j<span>)</span><span>)</span> <span>{</span>
            <span>if</span> <span>(</span>paramKey<span>.</span><span>equals</span><span>(</span>paramData<span>.</span><span>getParamKey</span><span>(</span><span>)</span><span>)</span><span>)</span> <span>{</span>
              hashMap<span>.</span><span>put</span><span>(</span>paramData<span>.</span><span>getParamKey</span><span>(</span><span>)</span><span>,</span> paramData<span>.</span><span>getValue</span><span>(</span><span>)</span> <span>+</span> <span>"("</span> <span>+</span> paramData<span>.</span><span>getRateValue</span><span>(</span><span>)</span> <span>+</span> <span>")"</span><span>)</span><span>;</span>
            <span>}</span>
          <span>}</span>
        <span>}</span>
        datas<span>.</span><span>add</span><span>(</span>hashMap<span>)</span><span>;</span>
      <span>}</span>
    <span>}</span>
    <span>return</span> datas<span>;</span>
  <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h5 id="excel的导出" tabindex="-1"> excel的导出</h5>
<div><pre><code><span>//statisData就是我们查询出来的数据</span>
<span>public</span> <span>void</span> <span>downloadPlatformIncomeContrast</span><span>(</span><span>List</span><span><span>&lt;</span><span>PlatformIncomeRespDTO</span><span>></span></span> statisData<span>,</span> <span>HttpServletResponse</span> response<span>)</span> <span>{</span>
    <span>if</span> <span>(</span><span>CollectionUtils</span><span>.</span><span>isEmpty</span><span>(</span>statisData<span>)</span><span>)</span> <span>{</span>
      <span>return</span><span>;</span>
    <span>}</span>
    <span>//获取参数信息</span>
    <span>final</span> <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>PlatformStatisParamRespData</span><span>></span></span> paramInfo <span>=</span> statisData<span>.</span><span>get</span><span>(</span><span>0</span><span>)</span><span>.</span><span>getParamInfo</span><span>(</span><span>)</span><span>;</span>

    <span>//拼装列头</span>
    <span>List</span><span><span>&lt;</span><span>ExcelExportEntity</span><span>></span></span> colList <span>=</span> <span>this</span><span>.</span><span>dynamicNewAddExcel</span><span>(</span>paramInfo<span>)</span><span>;</span>

    <span>//数据拼装</span>
    <span>List</span><span><span>&lt;</span><span>Map</span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span><span>></span></span> list <span>=</span> <span>this</span><span>.</span><span>dynamicListDataByKey</span><span>(</span>statisData<span>)</span><span>;</span>
    <span>final</span> <span>String</span> xlsFileName <span>=</span> <span>DateHelper</span><span>.</span><span>getNowString</span><span>(</span><span>FormatUnit</span><span>.</span>yyyyMMddHHmmss<span>,</span> <span>true</span><span>)</span> <span>+</span> <span>".xls"</span><span>;</span>
    <span>final</span> <span>Workbook</span> workbook <span>=</span> <span>ExcelExportUtil</span><span>.</span><span>exportExcel</span><span>(</span><span>new</span> <span>ExportParams</span><span>(</span><span>)</span><span>,</span> colList<span>,</span> list<span>)</span><span>;</span>

    <span>//动态合并纵列[mergeMap key列索引(从0开始),value依赖的列,没有传空,startRow 开始行(从零开始)]</span>
    <span>//Map&lt;Integer, int[]> mer = new HashMap&lt;>();</span>
    <span>//mer.put(0, new int[]{});</span>
    <span>//PoiMergeCellUtil.mergeCells(workbook.getSheetAt(0), mer, 1);</span>
    <span>EasypoiUtil</span><span>.</span><span>downLoadExcel</span><span>(</span>xlsFileName<span>,</span> response<span>,</span> workbook<span>)</span><span>;</span>
  <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>EasypoiUtil工具类</p>
<div><pre><code><span>public</span> <span>static</span> <span>void</span> <span>downLoadExcel</span><span>(</span><span>String</span> fileName<span>,</span> <span>HttpServletResponse</span> response<span>,</span> <span>Workbook</span> workbook<span>)</span> <span>{</span>
    <span>try</span> <span>{</span>
      response<span>.</span><span>setCharacterEncoding</span><span>(</span><span>"UTF-8"</span><span>)</span><span>;</span>
      response<span>.</span><span>setHeader</span><span>(</span><span>"content-Type"</span><span>,</span> <span>"application/vnd.ms-excel"</span><span>)</span><span>;</span>
      response<span>.</span><span>setHeader</span><span>(</span><span>"Content-Disposition"</span><span>,</span>
          <span>"attachment;filename="</span> <span>+</span> <span>URLEncoder</span><span>.</span><span>encode</span><span>(</span>fileName<span>,</span> <span>"UTF-8"</span><span>)</span><span>)</span><span>;</span>
      workbook<span>.</span><span>write</span><span>(</span>response<span>.</span><span>getOutputStream</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>}</span> <span>catch</span> <span>(</span><span>IOException</span> e<span>)</span> <span>{</span>
      <span>throw</span> <span>new</span> <span>RuntimeException</span><span>(</span>e<span>.</span><span>getMessage</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>}</span>
  <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>PlatformIncomeRespDTO</p>
<div><pre><code><span>@Data</span>
<span>@NoArgsConstructor</span>
<span>@AllArgsConstructor</span>
<span>public</span> <span>class</span> <span>PlatformIncomeRespDTO</span> <span>implements</span> <span>Serializable</span> <span>{</span>

  <span>private</span> <span>static</span> <span>final</span> <span>long</span> serialVersionUID <span>=</span> <span>1100499105160261425L</span><span>;</span>


  <span>/**
   * 平台别名
   */</span>
  <span>private</span> <span>String</span> platformNickName<span>;</span>

  <span>/*统计时间*/</span>
  <span>private</span> <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> statisDate<span>;</span>

  <span>/*查询参数信息--[用户收入来源统计导出使用]*/</span>
  <span>private</span> <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>PlatformStatisParamRespData</span><span>></span></span> paramInfo<span>;</span>


  <span>/*统计数据*/</span>
  <span>private</span> <span>List</span><span><span>&lt;</span><span>List</span><span>&lt;</span><span>BiPlatformStatisRespDTO</span><span>></span><span>></span></span> statisData<span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>PlatformStatisParamRespData</p>
<div><pre><code><span>@Data</span>
<span>@NoArgsConstructor</span>
<span>@AllArgsConstructor</span>
<span>public</span> <span>class</span> <span>PlatformStatisParamRespData</span> <span>implements</span> <span>Serializable</span> <span>{</span>

  <span>private</span> <span>static</span> <span>final</span> <span>long</span> serialVersionUID <span>=</span> <span>4263523446154995471L</span><span>;</span>

  <span>/**
   * 参数名称
   */</span>
  <span>private</span> <span>String</span> dataName<span>;</span>

  <span>/**
   * 参数key
   */</span>
  <span>private</span> <span>String</span> dateKey<span>;</span>

  <span>/**
   * 参数描述
   */</span>
  <span>private</span> <span>String</span> dateDesc<span>;</span>

<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>BiPlatformStatisRespDTO</p>
<div><pre><code><span>@Data</span>
<span>@AllArgsConstructor</span>
<span>public</span> <span>class</span> <span>BiPlatformStatisRespDTO</span> <span>implements</span> <span>Serializable</span> <span>{</span>

  <span>private</span> <span>static</span> <span>final</span> <span>long</span> serialVersionUID <span>=</span> <span>6070471415344415351L</span><span>;</span>

  <span>@Excel</span><span>(</span>name <span>=</span> <span>"统计字段"</span><span>,</span> orderNum <span>=</span> <span>"1"</span><span>)</span>
  <span>private</span> <span>String</span> param<span>;</span>

  <span>/**
   * 参数的key
   */</span>
  <span>private</span> <span>String</span> paramKey<span>;</span>

  <span>/**
   * 参数描述
   */</span>
  <span>private</span> <span>String</span> paramDesc<span>;</span>

  <span>private</span> <span>String</span> startDate<span>;</span>

  <span>private</span> <span>String</span> endDate<span>;</span>

  <span>@Excel</span><span>(</span>name <span>=</span> <span>"统计数据"</span><span>,</span> orderNum <span>=</span> <span>"2"</span><span>)</span>
  <span>private</span> <span>String</span> value<span>;</span>

  <span>private</span> <span>String</span> rateValue<span>;</span>

  <span>private</span> <span>Long</span> id<span>;</span>

  <span>private</span> <span>Integer</span> riseOrFall<span>;</span>

  <span>public</span> <span>BiPlatformStatisRespDTO</span><span>(</span><span>String</span> startDate<span>,</span> <span>String</span> paramKey<span>,</span> <span>String</span> value<span>)</span> <span>{</span>
    <span>this</span><span>.</span>paramKey <span>=</span> paramKey<span>;</span>
    <span>this</span><span>.</span>startDate <span>=</span> startDate<span>;</span>
    <span>this</span><span>.</span>value <span>=</span> value<span>;</span>
  <span>}</span>

  <span>public</span> <span>BiPlatformStatisRespDTO</span><span>(</span><span>)</span> <span>{</span>
  <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="测试用例" tabindex="-1"> 测试用例</h3>
<h5 id="测试特殊说明" tabindex="-1"> 测试特殊说明</h5>
<p>导出的结果有个控制,是在拼装的时候没有填充此数据,不影响整体效果。</p>
<h5 id="测试结果示例" tabindex="-1"> 测试结果示例</h5>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/JfTPiahTHJhqian47myMbgAAXib3tTubM4cOoQzAXu4ZIlniaJ4ustt2RUfYS3yu0MCGtgeCBicX0StNMH5x36MXnDQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<h5 id="测试数据json示例" tabindex="-1"> 测试数据json示例</h5>
<div><pre><code><span>[</span>
    <span>{</span>
        <span>"paramInfo"</span><span>:</span> <span>{</span>
            <span>"userCount"</span><span>:</span> <span>{</span>
                <span>"dataName"</span><span>:</span> <span>"用户数"</span><span>,</span> 
                <span>"dateDesc"</span><span>:</span> <span>"用户信息"</span><span>,</span> 
                <span>"dateKey"</span><span>:</span> <span>"userCount"</span>
            <span>}</span><span>,</span> 
            <span>"friendsCount"</span><span>:</span> <span>{</span>
                <span>"dataName"</span><span>:</span> <span>"好友数"</span><span>,</span> 
                <span>"dateDesc"</span><span>:</span> <span>"好友信息"</span><span>,</span> 
                <span>"dateKey"</span><span>:</span> <span>"friendsCount"</span>
            <span>}</span>
        <span>}</span><span>,</span> 
        <span>"platformNickName"</span><span>:</span> <span>"aaa"</span><span>,</span> 
        <span>"statisData"</span><span>:</span> <span>[</span>
            <span>[</span>
                <span>{</span>
                    <span>"paramKey"</span><span>:</span> <span>"userCount"</span><span>,</span> 
                    <span>"startDate"</span><span>:</span> <span>"2019-12-26"</span><span>,</span> 
                    <span>"value"</span><span>:</span> <span>"100"</span>
                <span>}</span><span>,</span> 
                <span>{</span>
                    <span>"paramKey"</span><span>:</span> <span>"friendsCount"</span><span>,</span> 
                    <span>"startDate"</span><span>:</span> <span>"2019-12-26"</span><span>,</span> 
                    <span>"value"</span><span>:</span> <span>"200"</span>
                <span>}</span>
            <span>]</span><span>,</span> 
            <span>[</span>
                <span>{</span>
                    <span>"paramKey"</span><span>:</span> <span>"userCount"</span><span>,</span> 
                    <span>"startDate"</span><span>:</span> <span>"2019-12-27"</span><span>,</span> 
                    <span>"value"</span><span>:</span> <span>"300"</span>
                <span>}</span><span>,</span> 
                <span>{</span>
                    <span>"paramKey"</span><span>:</span> <span>"friendsCount"</span><span>,</span> 
                    <span>"startDate"</span><span>:</span> <span>"2019-12-27"</span><span>,</span> 
                    <span>"value"</span><span>:</span> <span>"400"</span>
                <span>}</span>
            <span>]</span>
        <span>]</span><span>,</span> 
        <span>"statisDate"</span><span>:</span> <span>[</span>
            <span>"2019-12-26"</span><span>,</span> 
            <span>"2019-12-27"</span>
        <span>]</span>
    <span>}</span><span>,</span> 
    <span>{</span>
        <span>"paramInfo"</span><span>:</span> <span>{</span>
            <span>"userCount"</span><span>:</span> <span>{</span>
                <span>"dataName"</span><span>:</span> <span>"用户数"</span><span>,</span> 
                <span>"dateDesc"</span><span>:</span> <span>"用户信息"</span><span>,</span> 
                <span>"dateKey"</span><span>:</span> <span>"userCount"</span>
            <span>}</span><span>,</span> 
            <span>"friendsCount"</span><span>:</span> <span>{</span>
                <span>"dataName"</span><span>:</span> <span>"好友数"</span><span>,</span> 
                <span>"dateDesc"</span><span>:</span> <span>"好友信息"</span><span>,</span> 
                <span>"dateKey"</span><span>:</span> <span>"friendsCount"</span>
            <span>}</span>
        <span>}</span><span>,</span> 
        <span>"platformNickName"</span><span>:</span> <span>"bbb"</span><span>,</span> 
        <span>"statisData"</span><span>:</span> <span>[</span>
            <span>[</span>
                <span>{</span>
                    <span>"paramKey"</span><span>:</span> <span>"userCount"</span><span>,</span> 
                    <span>"startDate"</span><span>:</span> <span>"2019-12-26"</span><span>,</span> 
                    <span>"value"</span><span>:</span> <span>"500"</span>
                <span>}</span><span>,</span> 
                <span>{</span>
                    <span>"paramKey"</span><span>:</span> <span>"friendsCount"</span><span>,</span> 
                    <span>"startDate"</span><span>:</span> <span>"2019-12-26"</span><span>,</span> 
                    <span>"value"</span><span>:</span> <span>"600"</span>
                <span>}</span>
            <span>]</span><span>,</span> 
            <span>[</span>
                <span>{</span>
                    <span>"paramKey"</span><span>:</span> <span>"userCount"</span><span>,</span> 
                    <span>"startDate"</span><span>:</span> <span>"2019-12-27"</span><span>,</span> 
                    <span>"value"</span><span>:</span> <span>"700"</span>
                <span>}</span><span>,</span> 
                <span>{</span>
                    <span>"paramKey"</span><span>:</span> <span>"friendsCount"</span><span>,</span> 
                    <span>"startDate"</span><span>:</span> <span>"2019-12-27"</span><span>,</span> 
                    <span>"value"</span><span>:</span> <span>"800"</span>
                <span>}</span>
            <span>]</span>
        <span>]</span><span>,</span> 
        <span>"statisDate"</span><span>:</span> <span>[</span>
            <span>"2019-12-26"</span><span>,</span> 
            <span>"2019-12-27"</span>
        <span>]</span>
    <span>}</span>
<span>]</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h5 id="测试用例代码" tabindex="-1"> 测试用例代码</h5>
<div><pre><code><span>public</span> <span>class</span> <span>Simple</span> <span>{</span>

  <span>/**
   * @Description: 拼接表头
   * @Param: paramInfo :表头信息
   * <span>@return</span>: java.util.List<span><span><span>&lt;</span>cn.afterturn.easypoi.excel.entity.params.ExcelExportEntity</span><span>></span></span>
   * @Author: peikunkun
   * @Date: 2019/12/26 0026 上午 10:42
   */</span>
  <span>private</span> <span>static</span> <span>List</span><span><span>&lt;</span><span>ExcelExportEntity</span><span>></span></span> <span>dynamicNewAddExcel</span><span>(</span><span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>PlatformStatisParamRespData</span><span>></span></span> paramInfo<span>)</span> <span>{</span>
    <span>//表头的集合，用于添加表头</span>
    <span>List</span><span><span>&lt;</span><span>ExcelExportEntity</span><span>></span></span> entityList <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>

    <span>//ExcelExportEntity构造参数【第一个是列名头的统计字段,第二个是需要指定的一个key在填充数据的时候是需要根据这个key进行填充值,第三个参数是列宽】</span>
    <span>ExcelExportEntity</span> platformXh <span>=</span> <span>new</span> <span>ExcelExportEntity</span><span>(</span><span>"统计字段1"</span><span>,</span> <span>"statisKey1"</span><span>,</span> <span>30</span><span>)</span><span>;</span>
    <span>//列的合并(纵向列的同名称会进行合并,效果见上图的平台名称的变化)</span>
    platformXh<span>.</span><span>setMergeVertical</span><span>(</span><span>true</span><span>)</span><span>;</span>
    entityList<span>.</span><span>add</span><span>(</span>platformXh<span>)</span><span>;</span>

    <span>ExcelExportEntity</span> statisDateXh <span>=</span> <span>new</span> <span>ExcelExportEntity</span><span>(</span><span>"统计字段2"</span><span>,</span> <span>"statisKey2"</span><span>,</span> <span>30</span><span>)</span><span>;</span>
    entityList<span>.</span><span>add</span><span>(</span>statisDateXh<span>)</span><span>;</span>

    <span>//参数信息--[用于动态拼接列头]</span>
    <span>final</span> <span>Iterator</span><span><span>&lt;</span><span>String</span><span>></span></span> iterator <span>=</span> paramInfo<span>.</span><span>keySet</span><span>(</span><span>)</span><span>.</span><span>iterator</span><span>(</span><span>)</span><span>;</span>
    <span>while</span> <span>(</span>iterator<span>.</span><span>hasNext</span><span>(</span><span>)</span><span>)</span> <span>{</span>
      <span>final</span> <span>String</span> paramKeyStr <span>=</span> iterator<span>.</span><span>next</span><span>(</span><span>)</span><span>;</span>
      <span>final</span> <span>String</span> paramNameStr <span>=</span> paramInfo<span>.</span><span>get</span><span>(</span>paramKeyStr<span>)</span><span>.</span><span>getDataName</span><span>(</span><span>)</span><span>;</span>
      <span>//列头由参数汉字名称,参数key为列key</span>
      entityList<span>.</span><span>add</span><span>(</span><span>new</span> <span>ExcelExportEntity</span><span>(</span>paramNameStr<span>,</span> paramKeyStr<span>,</span> <span>30</span><span>)</span><span>)</span><span>;</span>
    <span>}</span>
    <span>return</span> entityList<span>;</span>
  <span>}</span>


  <span>/**
   * @Description: 拼接数据
   * @Param: statisData :拼接数据
   * @Author: peikunkun
   * @Date: 2019/12/26 0026 上午 10:42
   */</span>
  <span>private</span> <span>static</span> <span>List</span><span><span>&lt;</span><span>Map</span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span><span>></span></span> <span>dynamicListDataByKey</span><span>(</span><span>List</span><span><span>&lt;</span><span>PlatformIncomeRespDTO</span><span>></span></span> statisData<span>)</span> <span>{</span>
    <span>//参数类型</span>
    <span>final</span> <span>Set</span><span><span>&lt;</span><span>String</span><span>></span></span> statisParamKey <span>=</span> statisData<span>.</span><span>get</span><span>(</span><span>0</span><span>)</span><span>.</span><span>getParamInfo</span><span>(</span><span>)</span><span>.</span><span>keySet</span><span>(</span><span>)</span><span>;</span>
    <span>final</span> <span>List</span><span><span>&lt;</span><span>String</span><span>></span></span> statisDate <span>=</span> statisData<span>.</span><span>get</span><span>(</span><span>0</span><span>)</span><span>.</span><span>getStatisDate</span><span>(</span><span>)</span><span>;</span>
    <span>final</span> <span>int</span> platformNum <span>=</span> statisData<span>.</span><span>size</span><span>(</span><span>)</span><span>;</span>

    <span>//最终的数据</span>
    <span>List</span><span><span>&lt;</span><span>Map</span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span><span>></span></span> datas <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
    <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> platformNum<span>;</span> i<span>++</span><span>)</span> <span>{</span>
      <span>for</span> <span>(</span><span>int</span> j <span>=</span> <span>0</span><span>;</span> j <span>&lt;</span> statisDate<span>.</span><span>size</span><span>(</span><span>)</span><span>;</span> j<span>++</span><span>)</span> <span>{</span>
        <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span></span> hashMap <span>=</span> <span>new</span> <span>LinkedHashMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>10</span><span>)</span><span>;</span>
        <span>//这个是依据key进行数据的填充,(根据前面填写的statisKey1进行填充数据)</span>
        hashMap<span>.</span><span>put</span><span>(</span><span>"statisKey1"</span><span>,</span> statisData<span>.</span><span>get</span><span>(</span>i<span>)</span><span>.</span><span>getPlatformNickName</span><span>(</span><span>)</span><span>)</span><span>;</span>
        <span>String</span> statisDateStr <span>=</span> statisDate<span>.</span><span>get</span><span>(</span>j<span>)</span><span>;</span>
        <span>//这个是依据key进行数据的填充,(根据前面填写的statisKey2进行填充  数据)</span>
        hashMap<span>.</span><span>put</span><span>(</span><span>"statisKey2"</span><span>,</span> statisDateStr<span>)</span><span>;</span>
        <span>//参数的验证</span>
        <span>for</span> <span>(</span><span>String</span> paramKey <span>:</span> statisParamKey<span>)</span> <span>{</span>
          <span>for</span> <span>(</span><span>BiPlatformStatisRespDTO</span> paramData <span>:</span> statisData<span>.</span><span>get</span><span>(</span>i<span>)</span><span>.</span><span>getStatisData</span><span>(</span><span>)</span><span>.</span><span>get</span><span>(</span>j<span>)</span><span>)</span> <span>{</span>
            <span>if</span> <span>(</span>paramKey<span>.</span><span>equals</span><span>(</span>paramData<span>.</span><span>getParamKey</span><span>(</span><span>)</span><span>)</span><span>)</span> <span>{</span>
              hashMap<span>.</span><span>put</span><span>(</span>paramData<span>.</span><span>getParamKey</span><span>(</span><span>)</span><span>,</span> paramData<span>.</span><span>getValue</span><span>(</span><span>)</span> <span>+</span> <span>"("</span> <span>+</span> paramData<span>.</span><span>getRateValue</span><span>(</span><span>)</span> <span>+</span> <span>")"</span><span>)</span><span>;</span>
            <span>}</span>
          <span>}</span>
        <span>}</span>
        datas<span>.</span><span>add</span><span>(</span>hashMap<span>)</span><span>;</span>
      <span>}</span>
    <span>}</span>
    <span>return</span> datas<span>;</span>
  <span>}</span>


  <span>@Test</span>
  <span>public</span> <span>void</span> <span>Administrator_84_20191226095523</span><span>(</span><span>)</span> <span>throws</span> <span>IOException</span> <span>{</span>
    <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"欢迎使用单元测试方法【Administrator_84()_20191226095523】"</span><span>)</span><span>;</span>
    <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>"此方法测试描述：【】"</span><span>)</span><span>;</span>
    <span>//拼装第一个数据---------------------------------------------------------------------</span>
    <span>final</span> <span>PlatformIncomeRespDTO</span> platformIncomeRespDTO1 <span>=</span> <span>new</span> <span>PlatformIncomeRespDTO</span><span>(</span><span>)</span><span>;</span>
    platformIncomeRespDTO1<span>.</span><span>setPlatformNickName</span><span>(</span><span>"aaa"</span><span>)</span><span>;</span>
    <span>//拼装时间维度</span>
    platformIncomeRespDTO1<span>.</span><span>setStatisDate</span><span>(</span><span>Lists</span><span>.</span><span>newArrayList</span><span>(</span><span>"2019-12-26"</span><span>,</span><span>"2019-12-27"</span><span>)</span><span>)</span><span>;</span>
    <span>//拼装头信息</span>
    <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>PlatformStatisParamRespData</span><span>></span></span> paramInfo1<span>=</span><span>new</span> <span>HashMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
    paramInfo1<span>.</span><span>put</span><span>(</span><span>"userCount"</span><span>,</span> <span>new</span> <span>PlatformStatisParamRespData</span><span>(</span><span>"用户数"</span><span>,</span><span>"userCount"</span><span>,</span><span>"用户信息"</span><span>)</span><span>)</span><span>;</span>
    paramInfo1<span>.</span><span>put</span><span>(</span><span>"friendsCount"</span><span>,</span> <span>new</span> <span>PlatformStatisParamRespData</span><span>(</span><span>"好友数"</span><span>,</span><span>"friendsCount"</span><span>,</span><span>"好友信息"</span><span>)</span><span>)</span><span>;</span>
    platformIncomeRespDTO1<span>.</span><span>setParamInfo</span><span>(</span>paramInfo1<span>)</span><span>;</span>
    <span>//拼装数据</span>
    <span>final</span> <span>ArrayList</span><span><span>&lt;</span><span>List</span><span>&lt;</span><span>BiPlatformStatisRespDTO</span><span>></span><span>></span></span> data1 <span>=</span> <span>Lists</span><span>.</span><span>newArrayList</span><span>(</span><span>)</span><span>;</span>
    data1<span>.</span><span>add</span><span>(</span><span>Lists</span><span>.</span><span>newArrayList</span><span>(</span><span>new</span> <span>BiPlatformStatisRespDTO</span><span>(</span><span>"2019-12-26"</span><span>,</span><span>"userCount"</span><span>,</span><span>"100"</span><span>)</span><span>,</span><span>new</span> <span>BiPlatformStatisRespDTO</span><span>(</span><span>"2019-12-26"</span><span>,</span><span>"friendsCount"</span><span>,</span><span>"200"</span><span>)</span><span>)</span><span>)</span><span>;</span>
    data1<span>.</span><span>add</span><span>(</span><span>Lists</span><span>.</span><span>newArrayList</span><span>(</span><span>new</span> <span>BiPlatformStatisRespDTO</span><span>(</span><span>"2019-12-27"</span><span>,</span><span>"userCount"</span><span>,</span><span>"300"</span><span>)</span><span>,</span><span>new</span> <span>BiPlatformStatisRespDTO</span><span>(</span><span>"2019-12-27"</span><span>,</span><span>"friendsCount"</span><span>,</span><span>"400"</span><span>)</span><span>)</span><span>)</span><span>;</span>
    platformIncomeRespDTO1<span>.</span><span>setStatisData</span><span>(</span>data1<span>)</span><span>;</span>


    <span>//拼装第二个数据---------------------------------------------------------------------</span>
    <span>final</span> <span>PlatformIncomeRespDTO</span> platformIncomeRespDTO2 <span>=</span> <span>new</span> <span>PlatformIncomeRespDTO</span><span>(</span><span>)</span><span>;</span>
    platformIncomeRespDTO2<span>.</span><span>setPlatformNickName</span><span>(</span><span>"bbb"</span><span>)</span><span>;</span>
    <span>//拼装时间维度</span>
    platformIncomeRespDTO2<span>.</span><span>setStatisDate</span><span>(</span><span>Lists</span><span>.</span><span>newArrayList</span><span>(</span><span>"2019-12-26"</span><span>,</span><span>"2019-12-27"</span><span>)</span><span>)</span><span>;</span>
    <span>//拼装头信息</span>
    <span>Map</span><span><span>&lt;</span><span>String</span><span>,</span> <span>PlatformStatisParamRespData</span><span>></span></span> paramInfo2<span>=</span><span>new</span> <span>HashMap</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
    paramInfo2<span>.</span><span>put</span><span>(</span><span>"userCount"</span><span>,</span> <span>new</span> <span>PlatformStatisParamRespData</span><span>(</span><span>"用户数"</span><span>,</span><span>"userCount"</span><span>,</span><span>"用户信息"</span><span>)</span><span>)</span><span>;</span>
    paramInfo2<span>.</span><span>put</span><span>(</span><span>"friendsCount"</span><span>,</span> <span>new</span> <span>PlatformStatisParamRespData</span><span>(</span><span>"好友数"</span><span>,</span><span>"friendsCount"</span><span>,</span><span>"好友信息"</span><span>)</span><span>)</span><span>;</span>
    platformIncomeRespDTO2<span>.</span><span>setParamInfo</span><span>(</span>paramInfo2<span>)</span><span>;</span>

    <span>//拼装数据</span>
    <span>final</span> <span>ArrayList</span><span><span>&lt;</span><span>List</span><span>&lt;</span><span>BiPlatformStatisRespDTO</span><span>></span><span>></span></span> data2 <span>=</span> <span>Lists</span><span>.</span><span>newArrayList</span><span>(</span><span>)</span><span>;</span>
    data2<span>.</span><span>add</span><span>(</span><span>Lists</span><span>.</span><span>newArrayList</span><span>(</span><span>new</span> <span>BiPlatformStatisRespDTO</span><span>(</span><span>"2019-12-26"</span><span>,</span><span>"userCount"</span><span>,</span><span>"500"</span><span>)</span><span>,</span><span>new</span> <span>BiPlatformStatisRespDTO</span><span>(</span><span>"2019-12-26"</span><span>,</span><span>"friendsCount"</span><span>,</span><span>"600"</span><span>)</span><span>)</span><span>)</span><span>;</span>
    data2<span>.</span><span>add</span><span>(</span><span>Lists</span><span>.</span><span>newArrayList</span><span>(</span><span>new</span> <span>BiPlatformStatisRespDTO</span><span>(</span><span>"2019-12-27"</span><span>,</span><span>"userCount"</span><span>,</span><span>"700"</span><span>)</span><span>,</span><span>new</span> <span>BiPlatformStatisRespDTO</span><span>(</span><span>"2019-12-27"</span><span>,</span><span>"friendsCount"</span><span>,</span><span>"800"</span><span>)</span><span>)</span><span>)</span><span>;</span>
    platformIncomeRespDTO2<span>.</span><span>setStatisData</span><span>(</span>data2<span>)</span><span>;</span>

    <span>final</span> <span>ArrayList</span><span><span>&lt;</span><span>PlatformIncomeRespDTO</span><span>></span></span> platformIncomeRespDTOS <span>=</span> <span>Lists</span><span>.</span><span>newArrayList</span><span>(</span>platformIncomeRespDTO1<span>,</span> platformIncomeRespDTO2<span>)</span><span>;</span>
    <span>System</span><span>.</span>out<span>.</span><span>println</span><span>(</span><span>JSONObject</span><span>.</span><span>toJSONString</span><span>(</span>platformIncomeRespDTOS<span>)</span><span>)</span><span>;</span>

    <span>//拼装列头</span>
    <span>List</span><span><span>&lt;</span><span>ExcelExportEntity</span><span>></span></span> colList <span>=</span> <span>dynamicNewAddExcel</span><span>(</span>paramInfo2<span>)</span><span>;</span>

    <span>//数据拼装</span>
    <span>List</span><span><span>&lt;</span><span>Map</span><span>&lt;</span><span>String</span><span>,</span> <span>Object</span><span>></span><span>></span></span> list <span>=</span> <span>dynamicListDataByKey</span><span>(</span>platformIncomeRespDTOS<span>)</span><span>;</span>

    <span>//文件名称</span>
    <span>final</span> <span>Workbook</span> workbook <span>=</span> <span>ExcelExportUtil</span><span>.</span><span>exportExcel</span><span>(</span><span>new</span> <span>ExportParams</span><span>(</span><span>)</span><span>,</span> colList<span>,</span> list<span>)</span><span>;</span>

    <span>//此功能与【拼装列头】中的 platformXh.setMergeVertical(true);功能效果一样,可直接使用 platformXh.setMergeVertical(true);进行纵向合并</span>
    <span>//动态合并纵列[mergeMap key列索引(从0开始),value依赖的列,没有传空,startRow 开始行(从零开始)]</span>
    <span>//Map&lt;Integer, int[]> mer = new HashMap&lt;>();</span>
    <span>//mer.put(0, new int[]{});</span>
    <span>//PoiMergeCellUtil.mergeCells(workbook.getSheetAt(0), mer, 1);</span>

    <span>final</span> <span>FileOutputStream</span> fileOutputStream <span>=</span> <span>new</span> <span>FileOutputStream</span><span>(</span><span>"C:\\Users\\Administrator\\Desktop\\1.xls"</span><span>)</span><span>;</span>
    <span>//导出excel</span>
    <span>downLoadExcel</span><span>(</span><span>null</span><span>,</span> fileOutputStream<span>,</span> workbook<span>)</span><span>;</span>
  <span>}</span>




  <span>/**
   * @Description: 下载文件
   * @Param: fileName
   * @Param outputStream
   * @Param workbook
   * <span>@return</span>: void
   * @Author: peikunkun
   * @Date: 2019/12/26 0026 上午 10:44
   */</span>
  <span>public</span> <span>static</span> <span>void</span> <span>downLoadExcel</span><span>(</span><span>String</span> fileName<span>,</span> <span>FileOutputStream</span> outputStream<span>,</span> <span>Workbook</span> workbook<span>)</span>
      <span>throws</span> <span>IOException</span> <span>{</span>
    <span>try</span> <span>{</span>
      workbook<span>.</span><span>write</span><span>(</span>outputStream<span>)</span><span>;</span>
    <span>}</span> <span>catch</span> <span>(</span><span>IOException</span> e<span>)</span> <span>{</span>
      <span>throw</span> <span>new</span> <span>RuntimeException</span><span>(</span>e<span>.</span><span>getMessage</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>}</span> <span>finally</span> <span>{</span>
      outputStream<span>.</span><span>close</span><span>(</span><span>)</span><span>;</span>
    <span>}</span>
  <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-26T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">实用前端网站工具</title>
    <id>https://blog.ciberviler.top/dev/%E5%AE%9E%E7%94%A8%E5%89%8D%E7%AB%AF%E7%BD%91%E7%AB%99%E5%B7%A5%E5%85%B7.html</id>
    <link href="https://blog.ciberviler.top/dev/%E5%AE%9E%E7%94%A8%E5%89%8D%E7%AB%AF%E7%BD%91%E7%AB%99%E5%B7%A5%E5%85%B7.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">实用前端网站工具</summary>
    <content type="html"><![CDATA[<h1 id="实用前端网站工具" tabindex="-1"> 实用前端网站工具</h1>
<p>网站汇总：</p>
<ol>
<li>CSS battle : <a href="https://cssbattle.dev" target="_blank" rel="noopener noreferrer">https://cssbattle.dev</a></li>
<li>Learn CSS layout：<a href="http://learnlayout.com" target="_blank" rel="noopener noreferrer">http://learnlayout.com</a></li>
<li>Flexbox Froggy：<a href="http://flexboxfroggy.com" target="_blank" rel="noopener noreferrer">http://flexboxfroggy.com</a></li>
<li>EnjoyCSS：<a href="https://enjoycss.com" target="_blank" rel="noopener noreferrer">https://enjoycss.com</a></li>
<li>CSS-Tricks ：<a href="https://css-tricks.com" target="_blank" rel="noopener noreferrer">https://css-tricks.com</a></li>
<li>Neumorphism：<a href="https://neumorphism.io" target="_blank" rel="noopener noreferrer">https://neumorphism.io</a></li>
<li>uiGradients：<a href="https://uigradients.com" target="_blank" rel="noopener noreferrer">https://uigradients.com</a></li>
<li>JavaScript：<a href="https://bonsaiden.github.io/JavaScript-Garden/zh/" target="_blank" rel="noopener noreferrer">https://bonsaiden.github.io/JavaScript-Garden/zh/</a></li>
<li>JS Tips：<a href="https://www.jstips.co" target="_blank" rel="noopener noreferrer">https://www.jstips.co</a></li>
<li>JSweekly：<a href="https://javascriptweekly.com" target="_blank" rel="noopener noreferrer">https://javascriptweekly.com</a></li>
<li>CDNJS：<a href="https://cdnjs.com/libraries" target="_blank" rel="noopener noreferrer">https://cdnjs.com/libraries</a></li>
<li>Beautiful Open ：<a href="https://beautifulopen.com" target="_blank" rel="noopener noreferrer">https://beautifulopen.com</a></li>
<li>JavaScript Fun：<a href="https://www.javascript.fun" target="_blank" rel="noopener noreferrer">https://www.javascript.fun</a></li>
<li>Stack Overflow：<a href="https://stackoverflow.com" target="_blank" rel="noopener noreferrer">https://stackoverflow.com</a></li>
<li>掘金：<a href="https://juejin.im" target="_blank" rel="noopener noreferrer">https://juejin.im</a></li>
<li>Codrops：<a href="https://tympanus.net" target="_blank" rel="noopener noreferrer">https://tympanus.net</a></li>
<li>CodePen：<a href="https://codepen.io" target="_blank" rel="noopener noreferrer">https://codepen.io</a></li>
<li>CodeSandBox：<a href="https://codesandbox.io" target="_blank" rel="noopener noreferrer">https://codesandbox.io</a></li>
<li>JS Bin：<a href="https://jsbin.com" target="_blank" rel="noopener noreferrer">https://jsbin.com</a></li>
<li>ICONSVG：<a href="https://iconsvg.xyz" target="_blank" rel="noopener noreferrer">https://iconsvg.xyz</a></li>
<li>OpenMoji：<a href="https://www.openmoji.org" target="_blank" rel="noopener noreferrer">https://www.openmoji.org</a></li>
<li>Share Icon ：<a href="https://www.shareicon.net" target="_blank" rel="noopener noreferrer">https://www.shareicon.net</a></li>
<li>tableconvert ：<a href="https://tableconvert.com" target="_blank" rel="noopener noreferrer">https://tableconvert.com</a></li>
<li>Feathericons：<a href="https://feathericons.com" target="_blank" rel="noopener noreferrer">https://feathericons.com</a></li>
<li>HTML5UP ：<a href="https://html5up.net/" target="_blank" rel="noopener noreferrer">https://html5up.net/</a></li>
</ol>
<p><strong>▍CSS 相关</strong></p>
<p><strong>CSS Battle - 在线比拼 CSS</strong></p>
<p><a href="https://cssbattle.dev" target="_blank" rel="noopener noreferrer">https://cssbattle.dev</a></p>
<p>在线比拼 CSS ，一个挺有趣的竞争性游戏，一共有12个级别，需要你用 HTML和 CSS 100%还原它给出的页面，然后再尽量减少代码，你也可以查看全球的排行榜，看解决方案。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgby1RibvKfjTaMmqMo758Hpeic7nkkN5lnfHKVHP7Tey09DNicZ3NC3uIg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p>2</p>
<p><strong>Learn CSS layout - 学习 CSS 布局</strong></p>
<p><a href="http://learnlayout.com" target="_blank" rel="noopener noreferrer">http://learnlayout.com</a></p>
<p>在线CSS布局学习，它会一步一步引导初学者学习 CSS 基础知识，在实践中帮助初学者掌握好 CSS 的布局知识，改善初学者对 CSS 的编写习惯和正确方法。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgCa8pqeSLp2DTMM3LGqvRQm1UpTRC7jn5nuDmznw9cCwtvSkj2jHLYw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p>● 3</p>
<p><strong>Flexbox Froggy - 学习 Flex 布局的小游戏</strong></p>
<p><a href="http://flexboxfroggy.com" target="_blank" rel="noopener noreferrer">http://flexboxfroggy.com</a></p>
<p>一个引导式的学习 Flex 布局的游戏，用 flex 布局让青蛙跳到荷叶上就算完成，游戏里面几乎包含了所有常用的属性，这样学习起来很有趣嘞，形象好记忆，谁要是 Flex 布局还不熟的话，在这多练练。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgzUGhuHoKHPbxB9tRpJvsMArute19EMqicjiazzZBw9IjBY6ulgKdhTJw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<hr>
<p><em><em><em>*</em>****● 4****</em>*</em>**</p>
<hr>
<p><strong>EnjoyCSS-在线CSS代码可视化工具</strong></p>
<hr>
<p><a href="https://enjoycss.com" target="_blank" rel="noopener noreferrer">https://enjoycss.com</a></p>
<p>在线版的 CSS3 代码生成工具，基于可视化操作，能快速无编码的环境下调整网页效果和图形样式。就像是在本地使用 PS 或 AI 软件一样。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgGAo6sUAtZzkpBDjTnice74styoE9XKMS6AknWChWQaGgqsE2W4oOibXg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 5****</em>*</em>**</p>
<hr>
<p><strong>CSS-Tricks - CSS 技巧</strong></p>
<hr>
<p><a href="https://css-tricks.com" target="_blank" rel="noopener noreferrer">https://css-tricks.com</a></p>
<p>这个网站不断的在更新一些关于 CSS 的技巧优秀的教程和技巧，每天都会更新文章。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQg12PNSelSSNHcKOqx1St3MeribKU9sibTs1DFdByFUpnDZBMAMgsh4glw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 6****</em>*</em>**</p>
<hr>
<p><strong>Neumorphism-实现新拟态效果</strong></p>
<hr>
<p><a href="https://neumorphism.io" target="_blank" rel="noopener noreferrer">https://neumorphism.io</a></p>
<p>可以轻松实现新拟态效果，不仅可以修改颜色或填写色值，也可以修改尺寸、半径、距离、强度、模糊效果以及形状等参数，同时提供了CSS代码可以直接Copy。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgCTZvZkDlejUdLVD4iaRD89GBvicTib6tA5jdz47jZEiaLbQ7KlxvtwDm8w/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 7****</em>*</em>**</p>
<hr>
<p><strong>uiGradients - 分享渐变色</strong></p>
<hr>
<p><a href="https://uigradients.com" target="_blank" rel="noopener noreferrer">https://uigradients.com</a></p>
<p>提供渐变色效果的站点，里面接近上百种渐变配色方案，可根据自己风格来选择搭配，能直接获得对应渐变配色的 CSS 代码。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgonOgJOfBCmKRFsicAXJPOEspmAX0r0nnqo5vNbOPz35FPxdLmIKyWQg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><strong>▍JS 相关</strong></p>
<p><em><em><em>*</em>****● 8****</em>*</em>**</p>
<hr>
<p><strong>JavaScript 秘密花园</strong></p>
<hr>
<p><a href="https://bonsaiden.github.io/JavaScript-Garden/zh/" target="_blank" rel="noopener noreferrer">https://bonsaiden.github.io/JavaScript-Garden/zh/</a></p>
<p>一个一直更新的JavaScript 的语法文档，主要会写如何去避免一些常见的错误，以及找到很难发现的 bug ，比较深入 JavaScript 的语言特性。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQg3YWFXv0QEFKjibVcNX8kRnApytu44tPoXYFdTLCxaD63gJ2zLjCibsbQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 9****</em>*</em>**</p>
<hr>
<p><strong>JS Tips - JS 技巧</strong></p>
<hr>
<p><a href="https://www.jstips.co" target="_blank" rel="noopener noreferrer">https://www.jstips.co</a></p>
<p>每天一个 Javascript 小知识。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgIeawDibp9fGDgSib5IRq7vkMVWiconjUibx3FOwrB5mxXGTw8uEm3ounxg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 10****</em>*</em>**</p>
<hr>
<p><strong>JSweekly - 技术周刊</strong></p>
<hr>
<p><a href="https://javascriptweekly.com" target="_blank" rel="noopener noreferrer">https://javascriptweekly.com</a></p>
<p>专门讲解 Javascript 的技术周刊。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgfo83Ok2fbVYGNfoH4z3ICQ89DcQ6KPtNUHyWmnvZbPVVF4C3XtD6Ig/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 11****</em>*</em>**</p>
<hr>
<p><strong>CDNJS - JavaScript 资料库</strong></p>
<hr>
<p><a href="https://cdnjs.com/libraries" target="_blank" rel="noopener noreferrer">https://cdnjs.com/libraries</a></p>
<p>CDNJS 为开发者提供最新的前端 Web 开发资源，免费使用，无使用限制。你可以直接在自己的网页上引用这些 JS 文件。进入 CDNJS 网站后，搜索你想要的资源库，找到后点击项目后方的[ Copy Script Tag] ，然后贴上就可以用了。目前 CDNJS 在 Web 前端的 CDN 服务中排名第二（第一名是 Google），性能出色。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQg85rl2ibr6cv1OynNoLZ0DRnUP2lO2Iib0ZWssGDhndTjNvw2CV8dIx9Q/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 12****</em>*</em>**</p>
<hr>
<p><strong>Beautiful Open - 开源 JS 库集合</strong></p>
<hr>
<p><a href="https://beautifulopen.com" target="_blank" rel="noopener noreferrer">https://beautifulopen.com</a></p>
<p>收集各类卓越设计的开源项目，大到CMS内容管理系统，小到常用的Javascript库，适合网站开发的用户使用。</p>
<p><img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 13****</em>*</em>**</p>
<hr>
<p><strong>JavaScript Fun - 代码库集合</strong></p>
<hr>
<p><a href="https://www.javascript.fun" target="_blank" rel="noopener noreferrer">https://www.javascript.fun</a></p>
<p>一个集合当下最流行的 JavaScript 代码库，显示流行排行，开发者可以轻松的找到想要最新的代码插件、工具和博客。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQg1kLtlgZVeBN4ibxzJDW2cDwhEQDcOXY7NkqKWEgWUEdP1JfbfrrOib8w/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><strong>▍社区和博客</strong></p>
<p><em><em><em>*</em>****● 14****</em>*</em>**</p>
<hr>
<p>**Stack Overflow - 编程人员问答网
**</p>
<hr>
<p><a href="https://stackoverflow.com" target="_blank" rel="noopener noreferrer">https://stackoverflow.com</a></p>
<p>全球IT界最受欢迎的技术问答网站之一，一个解决 bug 的社区，称为“ 编程界的十万个为什么 ”。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgDJIPRf0YsN6Ek3zj36IXFgIxOZkl3Y6UOffvBjlT6h37Qa1FGpbWsQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 15****</em>*</em>**</p>
<hr>
<p><strong>掘金 - 高质量技术社区</strong></p>
<hr>
<p><a href="https://juejin.im" target="_blank" rel="noopener noreferrer">https://juejin.im</a></p>
<p>掘金技术社区是质量很高的技术分享社区，技术大牛和极客们共同编辑筛选的优质干货，这些技术文章包括Android、iOS、前端、后端资源。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgy8ypdRbUIsZngjnd8Z3L7mdXdxWL4LttopCFWYIBeCChue9NRd3uvQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 16****</em>*</em>**</p>
<hr>
<p>**Codrops - 网页设计开发博客
**</p>
<hr>
<p><a href="https://tympanus.net" target="_blank" rel="noopener noreferrer">https://tympanus.net</a></p>
<p>发表技术文章和网页教程，提供经验，少踩坑，资源丰富很丰富，很多优秀的技术都是从这里来的。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgZiaddEaTtSQN6cLQWbS17icHibyn2JVbCJiahcdnW4hACVKPjEEEwP3qLg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><strong>▍在线 IDE</strong></p>
<p><em><em><em>*</em>****● 17****</em>*</em>**</p>
<hr>
<p><strong>CodePen</strong></p>
<hr>
<p><a href="https://codepen.io" target="_blank" rel="noopener noreferrer">https://codepen.io</a></p>
<p>一个网站前端设计开发平台，针对网站前端代码的一个工具，上面有各种效果的案例特效（炫技），可以在他们的 demo 基础上开发自己的前端设计。</p>
<p><img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 18****</em>*</em>**</p>
<hr>
<p><strong>CodeSandBox</strong></p>
<hr>
<p><a href="https://codesandbox.io" target="_blank" rel="noopener noreferrer">https://codesandbox.io</a></p>
<p>站如其名，CodeSandBox 网站提供一个在线开发环境的“沙盒”，主流的框架如 React、Vue、Angular 等，都可即开即用、实时编译预览，非常方便。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgvNvxGHOZA09OUbDfnBbt8FvwKSK63m1TwunngOnntcVq3tGFNSqw3w/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 19****</em>*</em>**</p>
<hr>
<p><strong>JS Bin</strong></p>
<hr>
<p><a href="https://jsbin.com" target="_blank" rel="noopener noreferrer">https://jsbin.com</a></p>
<p>另一个轻量级在线编辑器网站，界面简洁干净，临时想调试简单的 HTML 或 JS 代码可以考虑去这里试一试。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgrp10Z4k8DpibgwxAKAgvpNV6TekbJtGaiboic9oqDiaCrkkcdkF1uNXStg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><strong>▍资源类</strong></p>
<p><em><em><em>*</em>****● 20****</em>*</em>**</p>
<hr>
<p><strong>ICONSVG - 在线自定义设计SVG图标素材</strong></p>
<hr>
<p><a href="https://iconsvg.xyz" target="_blank" rel="noopener noreferrer">https://iconsvg.xyz</a></p>
<p>是一个在线可自定义设计SVG图标素材的网站，帮助前端设计师找到想要的图标素材，这些图标素材都是常用图标，可以点击官方提供的素材进行二次设计，同时也可以把设计好的图标导出。</p>
<p><img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 21****</em>*</em>**</p>
<hr>
<p><strong>OpenMoji - 免费表情符号库</strong></p>
<hr>
<p><a href="https://www.openmoji.org" target="_blank" rel="noopener noreferrer">https://www.openmoji.org</a></p>
<p>提供源代码的表情符号库，可免费下载使用。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgVhEsY3wuicCjibRjibc0QEKSL3VicaHyEZWOQhGNn7h518OYUNTUse5UVQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 22****</em>*</em>**</p>
<hr>
<p><strong>Share Icon - 免费矢量素材图库</strong></p>
<hr>
<p><a href="https://www.shareicon.net" target="_blank" rel="noopener noreferrer">https://www.shareicon.net</a></p>
<p>提供超过25万中ICON矢量图片素材的站点，120多种分类，所有的素材都提供PNG、SVG格式，素材有多种尺寸尺寸包括 512<em>512、256</em>256、128<em>128、64</em>64、32<em>32、16</em>16等，非常适合前端设计师收藏备用。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQgYN1yLpQicrKzZiaiaWuyrddQfuvjfGVNUQoDAmpooG50iaicibN0UHNUpfng/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 23****</em>*</em>**</p>
<hr>
<p><strong>tableconvert</strong> <strong>- 在线表格编辑器</strong></p>
<hr>
<p><a href="https://tableconvert.com" target="_blank" rel="noopener noreferrer">https://tableconvert.com</a></p>
<p>一个功能强大的在线表格编辑器，支持Excel、Markdown、JSON、CSV、HTML等格式的相互转换。当需要转换表格，又不能让它变形，不妨试试这款工具。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQggGjqVgMbcgRhD74tCNJicqfeNUAyL7lvmNzzLgmMbBAzcnpuGcbBQrw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 24****</em>*</em>**</p>
<hr>
<p><strong>Feathericons - 极简 ICON 图标集</strong></p>
<hr>
<p><a href="https://feathericons.com" target="_blank" rel="noopener noreferrer">https://feathericons.com</a></p>
<p>一个免费开源的简单而美丽的ICON图标集合，主要设计的使用范畴为应用系统、媒体控制、位置、天气、箭头、徽标等，可在移动端应用开发的时候使用，图标格式为SVG。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQg6nvhyFyqItHvTT1PAotaxqeFEJecXVz51KjB4RqeXdpDMZZy0oFPEQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
<p><em><em><em>*</em>****● 25****</em>*</em>**</p>
<hr>
<p><strong>HTML5 + CSS 3 免费模版</strong></p>
<hr>
<p><a href="https://html5up.net/" target="_blank" rel="noopener noreferrer">https://html5up.net/</a></p>
<p>提供大量的HTML5模版，用户可以自己分享和修改模版。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ibOEx83F8Y9ibbibzvJ2NV4cPDU6yg3CDQg7mnYicwybIzdESPUHWn3UiceibC1xgkr2ypqCh0F6AhTTHuuiacv09TiaoQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" loading="lazy"></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-16T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">SpringBoot将Bean放入Spring容器中的五种方式</title>
    <id>https://blog.ciberviler.top/dev/%E5%B0%86Bean%E6%94%BE%E5%85%A5Spring%E5%AE%B9%E5%99%A8%E4%B8%AD%E7%9A%847%E7%A7%8D%E6%96%B9%E5%BC%8F.html</id>
    <link href="https://blog.ciberviler.top/dev/%E5%B0%86Bean%E6%94%BE%E5%85%A5Spring%E5%AE%B9%E5%99%A8%E4%B8%AD%E7%9A%847%E7%A7%8D%E6%96%B9%E5%BC%8F.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">SpringBoot将Bean放入Spring容器中的五种方式</summary>
    <content type="html"><![CDATA[<h1 id="springboot将bean放入spring容器中的7-五-种方式" tabindex="-1"> SpringBoot将Bean放入Spring容器中的7(五)种方式</h1>
<h2 id="更新-2022年3月23日11-25-11" tabindex="-1"> 更新：2022年3月23日11:25:11</h2>
<h2 id="背景" tabindex="-1"> 背景</h2>
<p>我们谈到Spring的时候一定会提到IOC容器、DI依赖注入，Spring通过将一个个类标注为Bean的方法注入到IOC容器中，达到了控制反转的效果。那么我们刚开始接触Bean的时候，一定是使用xml文件，一个一个的注入，就例如下面这样。</p>
<div><pre><code> &lt;bean id="bean" />
</code></pre><div aria-hidden="true"><div></div></div></div><p>我们的项目一般很大的话，就需要成千上百个Bean去使用，这样写起来就很繁琐。那么Spring就帮我们实现了一种通过注解来实现注入的方法。只需要在你需要注入的类前面加上相应的注解，Spring就会帮助我们扫描到他们去实现注入。</p>
<blockquote>
<p>xml扫描包的方式</p>
</blockquote>
<div><pre><code> &lt;context:component-scan base-package="com.company.beandemo"/>
</code></pre><div aria-hidden="true"><div></div></div></div><h2 id="通过注解注入的一般形式" tabindex="-1"> 通过注解注入的一般形式</h2>
<p>一般情况下，注入Bean有一个最直白，最易懂的方式去实现注入，下面废话先不多说，先贴代码。</p>
<hr>
<ul>
<li>Bean类</li>
</ul>
<div><pre><code> public class MyBean{
 }
</code></pre><div aria-hidden="true"><div></div><div></div></div></div><ul>
<li>Configuration类</li>
</ul>
<div><pre><code> //创建一个class配置文件
 @Configuration
 public class MyConfiguration{
  //将一个Bean交由Spring进行管理
        @Bean
        public MyBean myBean(){
            return new MyBean();
        }
 }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>Test类</li>
</ul>
<p>与xml有一点不同，这里在Test中，实例化的不再是ClassPathXmlApplicationContext，而是获取的AnnotationConfigApplicationContext实例。</p>
<div><pre><code> ApplicationContext context = new AnnotationConfigApplicationContext(MyConfiguration.class);
 MyBean myBean = cotext.getBean("myBean",MyBean.class);
 System.out.println("myBean = " + myBean);
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><hr>
<p>上面的代码中MyBean也就是我们需要Spring去管理的一个Bean，他只是一个简单的类。而MyConfiguration中，我们首先用@Configuration注解去标记了该类，这样标明该类是一个Spring的一个配置类，在加载配置的时候会去加载他。</p>
<p>在MyConfiguration中我们可以看到有一个方法返回的是一个MyBean的实例，并且该方法上标注着@Bean的注解，标明这是一个注入Bean的方法，会将下面的返回的Bean注入IOC。</p>
<blockquote>
<p>基于微服务的思想，构建在 B2C 电商场景下的项目实战。核心技术栈，是 Spring Boot + Dubbo 。未来，会重构成 Spring Cloud Alibaba 。</p>
<p>项目地址：<a href="https://github.com/YunaiV/onemall" target="_blank" rel="noopener noreferrer">https://github.com/YunaiV/onemall</a></p>
</blockquote>
<h2 id="通过构造方法注入bean" tabindex="-1"> 通过构造方法注入Bean</h2>
<p>我们在生成一个Bean实例的时候，可以使用Bean的构造方法将Bean实现注入。直接看代码</p>
<hr>
<ul>
<li>Bean类</li>
</ul>
<div><pre><code> @Component
 public class MyBeanConstructor {

     private AnotherBean anotherBeanConstructor;

     @Autowired
     public MyBeanConstructor(AnotherBean anotherBeanConstructor){
         this.anotherBeanConstructor = anotherBeanConstructor;
     }

     @Override
     public String toString() {
         return "MyBean{" +
             "anotherBeanConstructor=" + anotherBeanConstructor +
             '}';
     }
 }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>AnotherBean类</li>
</ul>
<div><pre><code> @Component(value="Bean的id，默认为类名小驼峰")
 public class AnotherBean {
 }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><ul>
<li>Configuration类</li>
</ul>
<div><pre><code> @Configuration
 @ComponentScan("com.company.annotationbean")
 public class MyConfiguration{
 }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div></div></div><hr>
<p>这里我们可以发现，和一般方式注入的代码不一样了，我们来看看新的注解都是什么意思：</p>
<ul>
<li>@AutoWired</li>
</ul>
<p>简单粗暴，直接翻译过来的意思就是自动装配🔧，还不理解为什么叫自动装配🔧？看了下一个注解的解释你就知道了。若是在这里注入的时候指定一个Bean的id就要使用@Qualifier注解</p>
<ul>
<li>@Component（默认单例模式）</li>
</ul>
<p>什么？？这翻译过来是零件，怎么感觉像是修汽车？？是的，Spring管理Bean的方法就是修汽车的方式。我们在需要将一个类变成一个Bean被Spring可以注入的时候加上注解零件@Conmonent，那么我们就可以在加载Bean的时候把他像零件一样装配🔧到这个IOC汽车上了</p>
<p>在这里我们还有几个其他的注解也可以实现这个功能，也就是细化的@Component：</p>
<ul>
<li>@Controller 标注在Controller层</li>
<li>@Service 标注在Service层</li>
<li>@Repository 标注在dao层</li>
</ul>
<p>还是翻译，零件扫描，我们去看看括号里的“零件仓库”里面，哪些“零件”（类）需要被装载，Spring就会去扫描这个包，将里面所有标注了@Component的类进行注入。</p>
<p>这里的通过构造方法进行注入就很好理解了，我们在装配MyBean这个零件的时候，突然发现他必须在AnotherBean的基础上才能安装到IOC里面，那么我们就在每次装配MyBean的时候自动装配🔧一个AnotherBean进去。举个🌰吧：</p>
<p>还是以汽车为例，我们在踩油门出发之前，是不是必须发车？？这里的AutoWired的内容就像发车，你不发车，这个油门你踩断都没有用，他都不会走。</p>
<h2 id="通过set方法注入bean" tabindex="-1"> 通过set方法注入Bean</h2>
<p>我们可以在一个属性的set方法中去将Bean实现注入，看代码吧</p>
<hr>
<ul>
<li>MyBean类</li>
</ul>
<div><pre><code> @Component
 public class MyBeanSet {

     private AnotherBean anotherBeanSet;

     @Autowired
     public void setAnotherBeanSet(AnotherBean anotherBeanSet) {
         this.anotherBeanSet = anotherBeanSet;
     }

     @Override
     public String toString() {
         return "MyBeanSet{" +
             "anotherBeanSet=" + anotherBeanSet +
             '}';
     }
 }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>Configuration类 和 Test类</li>
</ul>
<p>同上一个，就不贴了</p>
<hr>
<p>这里我们发现在setter方法上我们有一个@AutoWired,与上面不同的是，我们不会在实例化该类时就自动装配🔧这个对象，而是在显式调用setter的时候去装配。</p>
<h2 id="通过属性去注入bean" tabindex="-1"> 通过属性去注入Bean</h2>
<p>我们前面两种注入的方式诸如时间不同，并且代码较多，若是通过属性，即就是</p>
<div><pre><code> @Component
 public class MyBeanProperty {

     @Autowired
     private AnotherBean anotherBeanProperty;

     @Override
     public String toString() {
         return "MyBeanProperty{" +
             "anotherBeanProperty=" + anotherBeanProperty +
             '}';
     }
 }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>这里我们可以看到我们这个类中需要使用AnotherBean这个实例对象，我们可以通过@AutoWired去自动装配它。</p>
<blockquote>
<p>对于有些小伙伴问私有属性，Spring怎么去加载它到IOC的？推荐去看看反射</p>
</blockquote>
<h2 id="通过list注入bean" tabindex="-1"> 通过List注入Bean</h2>
<ul>
<li>MyBeanList类</li>
</ul>
<div><pre><code> @Component
 public class MyBeanList {

     private List&lt;String> stringList;

     @Autowired
     public void setStringList(List&lt;String> stringList) {
         this.stringList = stringList;
     }

     public List&lt;String> getStringList() {
         return stringList;
     }
 }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li>MyConfiguration类</li>
</ul>
<div><pre><code> @Configuration
 @ComponentScan("annoBean.annotationbean")
 public class MyConfiguration {

     @Bean
     public List&lt;String> stringList(){
        List&lt;String> stringList = new ArrayList&lt;String>();
         stringList.add("List-1");
         stringList.add("List-2");
         return stringList;
     }
 }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>这里我们将MyBeanList进行了注入，对List中的元素会逐一注入。下面介绍另一种方式注入List</p>
<ul>
<li>MyConfiguration类</li>
</ul>
<div><pre><code> @Bean
    //通过该注解设定Bean注入的优先级，不一定连续数字
    @Order(34)
    public String string1(){
        return "String-1";
    }

    @Bean
    @Order(14)
    public String string2(){
        return "String-2";
    }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>注入与List中泛型一样的类型，会自动去匹配类型，及时这里没有任何List的感觉，只是String的类型，但他会去通过List的Bean的方式去注入。</p>
<blockquote>
<p>第二种方式的优先级高于第一种，当两个都存在的时候，若要强制去使用第一种方式，则要去指定Bean的id即可</p>
</blockquote>
<h2 id="通过map去注入bean" tabindex="-1"> 通过Map去注入Bean</h2>
<div><pre><code> @Component
 public class MyBeanMap {

     private Map&lt;String,Integer> integerMap;

     public Map&lt;String, Integer> getIntegerMap() {
         return integerMap;
     }

     @Autowired
     public void setIntegerMap(Map&lt;String, Integer> integerMap) {
         this.integerMap = integerMap;
     }
 }

 @Bean
    public Map&lt;String,Integer> integerMap(){
        Map&lt;String,Integer> integerMap = new HashMap&lt;String, Integer>();
        integerMap.put("map-1",1);
        integerMap.put("map-2",2);
        return integerMap;
    }

    @Bean
    public Integer integer1(){
        return 1;
    }

    @Bean
    public Integer integer2(){
        return 2;
    }
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>同样这里也具有两种方式去注入Map类型Bean，且第二种的优先值高于第一种</p>
<p>以上就是Bean通过注解注入的几种方式，大家可以对比着xml注入的方式去看。</p>
<h2 id="_2022-02-12" tabindex="-1"> 2022-02-12</h2>
<h2 id="_1、-configuration-bean" tabindex="-1"> 1、@Configuration + @Bean</h2>
<p>这种方式其实，在上一篇文章已经介绍过了，也是我们最常用的一种方式，@Configuration用来声明一个配置类，然后使用 @Bean 注解，用于声明一个bean，将其加入到Spring容器中。具体代码如下:</p>
<div><pre><code>@Configuration
public class MyConfiguration {
    @Bean
    public Person person() {
        Person person = new Person();
        person.setName("spring");
        return person;
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="_2、-componet-componentscan" tabindex="-1"> 2、@Componet + @ComponentScan</h2>
<p>这种方式也是我们用的比较多的方式，@Componet中文译为组件，放在类名上面，然后@ComponentScan放置在我们的配置类上，然后可以指定一个路径，进行扫描带有@Componet注解的bean，然后加至容器中。具体代码如下:</p>
<div><pre><code>@Component
public class Person {
    private String name;

    public String getName() {
     
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    @Override
    public String toString() {
        return "Person{" +
                "name='" + name + '\'' +
                '}';
    }
}

@ComponentScan(basePackages = "com.springboot.initbean.*")
public class Demo1 {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext applicationContext = new AnnotationConfigApplicationContext(Demo1.class);
        Person bean = applicationContext.getBean(Person.class);
        System.out.println(bean);
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>结果输出:</p>
<div><pre><code>Person{name='null'}
</code></pre><div aria-hidden="true"><div></div></div></div><p>表示成功将Person放置在了IOC容器中。</p>
<h2 id="_3、-import注解导入" tabindex="-1"> 3、@Import注解导入</h2>
<p>前两种方式，大家用的可能比较多，也是平时开发中必须要知道的，@Import注解用的可能不是特别多了，但是也是非常重要的，在进行Spring扩展时经常会用到，它经常搭配自定义注解进行使用，然后往容器中导入一个配置文件。关于@Import注解，我会多介绍一点，它有四种使用方式。这是@Import注解的源码，表示只能放置在类上。</p>
<div><pre><code>@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface Import {

    /**
   * 用于导入一个class文件
     * {@link Configuration @Configuration}, {@link ImportSelector},
     * {@link ImportBeanDefinitionRegistrar}, or regular component classes to import.
     */

    Class&lt;?>[] value();

}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="_3-1-import直接导入类" tabindex="-1"> 3.1 @Import直接导入类</h3>
<p>代码示例如下:</p>
<div><pre><code>public class Person {
    private String name;

    public String getName() {
     
        return name;
    }
     
    public void setName(String name) {
        this.name = name;
    }
     
    @Override
    public String toString() {
        return "Person{" +
                "name='" + name + '\'' +
                '}';
    }
}
/**
* 直接使用@Import导入person类，然后尝试从applicationContext中取，成功拿到
**/
@Import(Person.class)
public class Demo1 {

    public static void main(String[] args) {
        AnnotationConfigApplicationContext applicationContext = new AnnotationConfigApplicationContext(Demo1.class);
        Person bean = applicationContext.getBean(Person.class);
        System.out.println(bean);
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>上述代码直接使用@Import导入了一个类，然后自动的就被放置在IOC容器中了。注意 我们的Person类上 就不需要任何的注解了，直接导入即可。</p>
<h3 id="_3-2-import-importselector" tabindex="-1"> 3.2 @Import + ImportSelector</h3>
<p>其实在@Import注解的源码中，说的已经很清楚了，感兴趣的可以看下，我们实现一个ImportSelector的接口，然后实现其中的方法，进行导入。</p>
<p>代码如下:</p>
<div><pre><code>@Import(MyImportSelector.class)
public class Demo1 {

    public static void main(String[] args) {
        AnnotationConfigApplicationContext applicationContext = new AnnotationConfigApplicationContext(Demo1.class);
        Person bean = applicationContext.getBean(Person.class);
        System.out.println(bean);
    }
}

class MyImportSelector implements ImportSelector {
    @Override
    public String[] selectImports(AnnotationMetadata importingClassMetadata) {
        return new String[]{"com.springboot.pojo.Person"};
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>我自定义了一个 MyImportSelector 实现了 ImportSelector 接口，重写selectImports 方法，然后将我们要导入的类的全限定名写在里面即可，实现起来也是非常简单。</p>
<h3 id="_3-3-import-importbeandefinitionregistrar" tabindex="-1"> 3.3 @Import + ImportBeanDefinitionRegistrar</h3>
<p>这种方式也需要我们实现 ImportBeanDefinitionRegistrar 接口中的方法，具体代码如下:</p>
<div><pre><code>@Import(MyImportBeanDefinitionRegistrar.class)
public class Demo1 {

    public static void main(String[] args) {
        AnnotationConfigApplicationContext applicationContext = new AnnotationConfigApplicationContext(Demo1.class);
        Person bean = applicationContext.getBean(Person.class);
        System.out.println(bean);
    }
}

class MyImportBeanDefinitionRegistrar implements ImportBeanDefinitionRegistrar {

    @Override
    public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry) {
        // 构建一个beanDefinition, 关于beanDefinition我后续会介绍，可以简单理解为bean的定义.
        AbstractBeanDefinition beanDefinition = BeanDefinitionBuilder.rootBeanDefinition(Person.class).getBeanDefinition();
        // 将beanDefinition注册到Ioc容器中.
        registry.registerBeanDefinition("person", beanDefinition);
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>上述实现其实和Import的第二种方式差不多，都需要去实现接口，然后进行导入。接触到了一个新的概念，BeanDefinition，可以简单理解为bean的定义(bean的元数据)，也是需要放在IOC容器中进行管理的，先有bean的元数据，applicationContext再根据bean的元数据去创建Bean。</p>
<h3 id="_3-4-import-deferredimportselector" tabindex="-1"> 3.4 @Import + DeferredImportSelector</h3>
<p>这种方式也需要我们进行实现接口，其实它和@Import的第二种方式差不多，DeferredImportSelector 它是 ImportSelector 的子接口，所以实现的方法和第二种无异。只是Spring的处理方式不同，它和Spring Boot中的自动导入配置文件 延迟导入有关，非常重要。使用方式如下:</p>
<div><pre><code>@Import(MyDeferredImportSelector.class)
public class Demo1 {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext applicationContext = new AnnotationConfigApplicationContext(Demo1.class);
        Person bean = applicationContext.getBean(Person.class);
        System.out.println(bean);
    }
}
class MyDeferredImportSelector implements DeferredImportSelector {
    @Override
    public String[] selectImports(AnnotationMetadata importingClassMetadata) {
        // 也是直接将Person的全限定名放进去
        return new String[]{Person.class.getName()};
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>关于@Import注解的使用方式，大概就以上三种，当然它还可以搭配@Configuration注解使用，用于导入一个配置类。</p>
<h2 id="_4、使用factorybean接口" tabindex="-1"> 4、使用FactoryBean接口</h2>
<p>FactoryBean接口和BeanFactory千万不要弄混了，从名字其实可以大概的区分开，FactoryBean, 后缀为bean，那么它其实就是一个bean, BeanFactory，顾名思义 bean工厂，它是IOC容器的顶级接口，这俩接口都很重要。代码示例:</p>
<div><pre><code>@Configuration
public class Demo1 {
    @Bean
    public PersonFactoryBean personFactoryBean() {
        return new PersonFactoryBean();
    }

    public static void main(String[] args) {
        AnnotationConfigApplicationContext applicationContext = new AnnotationConfigApplicationContext(Demo1.class);
        Person bean = applicationContext.getBean(Person.class);
        System.out.println(bean);
    }
}

class PersonFactoryBean implements FactoryBean&lt;Person> {

    /**
     *  直接new出来Person进行返回.
     */
    @Override
    public Person getObject() throws Exception {
        return new Person();
    }
    /**
     *  指定返回bean的类型.
     */
    @Override
    public Class&lt;?> getObjectType() {
        return Person.class;
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>上述代码，我使用@Configuration + @Bean的方式将 PersonFactoryBean 加入到容器中，注意，我没有向容器中注入 Person, 而是直接注入的 PersonFactoryBean 然后从容器中拿Person这个类型的bean,成功运行。</p>
<h2 id="_5、使用-beandefinitionregistrypostprocessor" tabindex="-1"> 5、使用 BeanDefinitionRegistryPostProcessor</h2>
<p>其实这种方式也是利用到了 BeanDefinitionRegistry，在Spring容器启动的时候会执行 BeanDefinitionRegistryPostProcessor 的 postProcessBeanDefinitionRegistry 方法，大概意思就是等beanDefinition加载完毕之后，对beanDefinition进行后置处理，可以在此进行调整IOC容器中的beanDefinition，从而干扰到后面进行初始化bean。</p>
<p>具体代码如下:</p>
<div><pre><code>public class Demo1 {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext applicationContext = new AnnotationConfigApplicationContext();
        MyBeanDefinitionRegistryPostProcessor beanDefinitionRegistryPostProcessor = new MyBeanDefinitionRegistryPostProcessor();
        applicationContext.addBeanFactoryPostProcessor(beanDefinitionRegistryPostProcessor);
        applicationContext.refresh();
        Person bean = applicationContext.getBean(Person.class);
        System.out.println(bean);
    }
}

class MyBeanDefinitionRegistryPostProcessor implements BeanDefinitionRegistryPostProcessor {

    @Override
    public void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) throws BeansException {
        AbstractBeanDefinition beanDefinition = BeanDefinitionBuilder.rootBeanDefinition(Person.class).getBeanDefinition();
        registry.registerBeanDefinition("person", beanDefinition);
    }
    @Override
    public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException {
     
    }
}
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>上述代码中，我们手动向beanDefinitionRegistry中注册了person的BeanDefinition。最终成功将person加入到applicationContext中，上述的几种方式的具体原理，我后面会进行介绍。</p>
<h2 id="小结" tabindex="-1"> 小结</h2>
<p>向spring容器中加入bean的几种方式.</p>
<p>@Configuration + @Bean</p>
<p>@ComponentScan + @Component</p>
<p>@Import 配合接口进行导入</p>
<p>使用FactoryBean。</p>
<p>实现BeanDefinitionRegistryPostProcessor进行后置处理。</p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-02-12T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">微服务架构统一安全认证设计与实践</title>
    <id>https://blog.ciberviler.top/dev/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E8%AE%A4%E8%AF%81%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E8%B7%B5.html</id>
    <link href="https://blog.ciberviler.top/dev/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E8%AE%A4%E8%AF%81%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E8%B7%B5.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">微服务架构统一安全认证设计与实践</summary>
    <content type="html"><![CDATA[<h1 id="微服务架构统一安全认证设计与实践" tabindex="-1"> 微服务架构统一安全认证设计与实践</h1>
<h2 id="名词定义" tabindex="-1"> 名词定义</h2>
<blockquote>
<ul>
<li>Third-party application：第三方应用程序，本文中又称&quot;客户端&quot;（client）。</li>
<li>HTTP service：HTTP服务提供商，本文中简称&quot;服务提供商&quot;。</li>
<li>Resource Owner：资源所有者，本文中又称&quot;用户&quot;（user）,即登录用户。</li>
<li>User Agent：用户代理，本文中就是指浏览器。</li>
<li>Authorization server：认证服务器，即服务提供商专门用来处理认证的服务器。</li>
<li>Resource server：资源服务器，即服务提供商存放用户生成的资源的服务器。它与认证服务器，可以是同一台服务器，也可以是不同的服务器。</li>
</ul>
</blockquote>
<h2 id="研发背景" tabindex="-1"> 研发背景</h2>
<p>当企业应用系统逐渐增多后，每个系统单独管理各自的用户数据容易形成信息孤岛，分散的用户管理模式阻碍了企业应用向平台化演进。当企业的互联网业务发展到一定规模，构建统一的标准化账户管理体系将是必不可少的，因为它是企业互联网云平台的重要基础设施，能够为平台带来统一的帐号管理、身份认证、用户授权等基础能力，为企业带来诸如跨系统单点登录、第三方授权登录等基础能力，为构建开放平台和业务生态提供了必要条件。</p>
<p>单体应用体系下，应用是一个整体，一般针对所有的请求都会进行权限校验。请求一般会通过一个权限的拦截器进行权限的校验，在登录时将用户信息缓存到 session 中，后续访问则从缓存中获取用户信息。</p>
<p>随着 Restful API、微服务的兴起，基于 Token 的认证现在已经越来越普遍。Token 和 Session ID 不同，并非只是一个 key。Token 一般会包含用户的相关信息，通过验证 Token 就可以完成身份校验。</p>
<blockquote>
<p>基于 Token 认证的优势如下：</p>
</blockquote>
<ol>
<li>服务端无状态：Token 机制在服务端不需要存储 session 信息，因为 Token 自身包含了所有用户的相关信息。</li>
<li>性能较好，因为在验证 Token 时不用再去访问数据库或者远程服务进行权限校验，自然可以提升不少性能。</li>
<li>支持移动设备,支持跨程序调用，Cookie 是不允许垮域访问的，而 Token 则不存在这个问题。</li>
</ol>
<h2 id="研发目标" tabindex="-1"> 研发目标</h2>
<blockquote>
<p>通过标准安全认证流程，异构系统或跨服务间能够灵活地实现指定功能部件或服务的集成、统一的安全认证。</p>
</blockquote>
<ul>
<li>基于 Token 认证的一个典型流程如下：</li>
</ul>
<ol>
<li>用户输入登录信息（或者调用 Token 接口，传入用户信息），发送到身份认证服务进行认证（身份认证服务可以和服务端在一起，也可以分离，看微服务拆分情况了）。</li>
<li>身份验证服务验证登录信息是否正确，返回接口（一般接口中会包含用户基础信息、权限范围、有效时间等信息），客户端存储接口，可以存储在 Session 或者数据库中。</li>
<li>客户端将 Token 放在 HTTP 请求头中，发起相关 API 调用。</li>
<li>被调用的微服务，验证 Token 权限。</li>
<li>服务端返回相关资源和数据。</li>
</ol>
<h3 id="安全认证功能点" tabindex="-1"> 安全认证功能点</h3>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ecc54fb04d3e43e4834ddafb43d5703a~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"></p>
<ol>
<li>获取凭证, 第三方应用客户端使用客户端编码/安全码、资源所有者用户名/密码等证件信息从授权服务器上获取Access Token资源访问凭证。</li>
<li>登录授权，客户端携带Access Token凭证访问服务器资源，资源服务器验证Token、第三方应用凭证信息、资源所有者User合法性，通过Token读取资源所有者身份信息(user) 加载资源所有者的权限项执行登录。</li>
<li>访问鉴权，第三方应用客户端访问服务端资源，系统验证访问者Access Token合法性、权限信息，验证凭证（Access Token）正确，此时资源服务器就会返回资源信息。</li>
<li>凭证续约，Access token访问凭证过期需要进行凭证续约，刷新Token凭证有效期。</li>
</ol>
<h2 id="技术选型分析" tabindex="-1"> 技术选型分析</h2>
<blockquote>
<ol>
<li>系统授权采用OAuth2开放式授权标准密码模式。</li>
<li>Token采用JWT标准。</li>
</ol>
</blockquote>
<h3 id="_1-oauth开放授权" tabindex="-1"> 1. OAuth开放授权</h3>
<p>OAuth（Open Authorization，开放授权）是为用户资源的授权定义了一个安全、开放及简单的标准，第三方无需知道用户的账号及密码，就可获取到用户的授权信息。</p>
<p>主要的四种授权方式：</p>
<ul>
<li>授权码模式（authorization code）用在客户端与服务端应用之间授权码。</li>
<li>简化模式（implicit）用在移动app或者web app(这些app是在用户的设备上的，如在手机上调起微信来进行认证授权)。不通过第三方应用程序的服务器，直接在浏览器中向认证服务器申请令牌，跳过了&quot;授权码&quot;这个步骤，因此得名。所有步骤在浏览器中完成，令牌对访问者是可见的，且客户端不需要认证。</li>
<li>密码模式（resource owner password credentials）应用直接都是受信任的(都是由一家公司开发的)密码模式中，用户向客户端提供自己的用户名和密码。客户端使用这些信息，向&quot;服务商提供商&quot;索要授权。在这种模式中，用户必须把自己的密码给客户端，但是客户端不得储存密码。</li>
<li>客户端模式（client credentials）用在应用API访问客户端模式（Client Credentials Grant）指客户端以自己的名义，而不是以用户的名义，向&quot;服务提供商&quot;进行认证。严格地说，客户端模式并不属于OAuth框架所要解决的问题。在这种模式中，用户直接向客户端注册，客户端以自己的名义要求&quot;服务提供商&quot;提供服务，其实不存在授权问题。</li>
</ul>
<h3 id="_2-json-web-token-jwt" tabindex="-1"> 2. Json web token (JWT)</h3>
<p>Json web token (JWT), 是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（(RFC 7519).该token被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景。JWT的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该token也可直接被用于认证，也可被加密。</p>
<h2 id="认证流程逻辑" tabindex="-1"> 认证流程逻辑</h2>
<h3 id="_1-系统授权" tabindex="-1"> 1. 系统授权</h3>
<blockquote>
<p>第三方应用客户端使用客户端编码/安全码、资源所有者用户名/密码等证件信息从授权服务器上获取Access Token资源访问凭证。</p>
</blockquote>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3ea530be187b47bb9d7a0d511d42db00~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"> 系统授权颁发给客户应用Access Token <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a507ea017d34445f9a0ab0783e3ec159~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"></p>
<h3 id="_2-系统鉴权" tabindex="-1"> 2. 系统鉴权</h3>
<blockquote>
<p>客户端携带Access Token凭证访问服务器资源，资源服务器验证Token、第三方应用、资源所有者User合法性，通过Token读取资源所有者身份信息(user) 加载资源所有者的权限执行登录。</p>
</blockquote>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/788d357d31144b69bd1793e623fe1004~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"></p>
<blockquote>
<p>系统验证访问者Access Token合法性、权限信息，验证凭证（Access Token）正确，此时资源服务器就会返回资源信息。</p>
</blockquote>
<h3 id="_3-凭证续约" tabindex="-1"> 3. 凭证续约</h3>
<blockquote>
<p>Access token访问凭证过期需要进行凭证续约，刷新Token凭证有效期。</p>
</blockquote>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/58d905e0a5814997b63bb3afd65d0c2f~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"></p>
<h2 id="接口设计" tabindex="-1"> 接口设计</h2>
<h3 id="_1-授权凭证" tabindex="-1"> 1. 授权凭证</h3>
<blockquote>
<p>获取授权凭证，校验客户端身份信息、校验资源所有者身份信息，下发Token凭证。</p>
</blockquote>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/80dcd5ae585f4c22979a1ead93bdb762~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"></p>
<blockquote>
<p>客户端编码/安全码需要第三方应用到系统注册审核通过后生成。</p>
</blockquote>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a2bd4d9dc544810b83752ff33600327~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"> <img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9903bc421d7440158f33bf3a219b99df~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"></p>
<h3 id="_2-授权凭证续约" tabindex="-1"> 2. 授权凭证续约</h3>
<blockquote>
<p>获取续约授权凭证，校验客户端身份信息、校验RefreshToken凭证，下发Token凭证。</p>
</blockquote>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1f8ca2a8146649c5b350f4d5b42299c1~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"> <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dd197891eb284a119e992c389d412ca4~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"> <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/130844cf15c842619e1e2e21a355a970~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img" loading="lazy"></p>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-08T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">开发中报错异常解决</title>
    <id>https://blog.ciberviler.top/dev/%E6%8A%A5%E9%94%99%E5%BC%82%E5%B8%B8%E8%A7%A3%E5%86%B3.html</id>
    <link href="https://blog.ciberviler.top/dev/%E6%8A%A5%E9%94%99%E5%BC%82%E5%B8%B8%E8%A7%A3%E5%86%B3.html"/>
    <updated>2022-04-28T02:37:00.000Z</updated>
    <summary type="html">开发中报错异常解决</summary>
    <content type="html"><![CDATA[<h1 id="开发中报错异常解决" tabindex="-1"> 开发中报错异常解决</h1>
<p>2022年2月6日 开始整理开发中遇到的问题</p>
<h2 id="vue打包部署-刷新404" tabindex="-1"> vue打包部署 刷新404</h2>
<blockquote>
<p>2022年3月20日22:14:21</p>
</blockquote>
<p><code>vue hash</code>模式下，<code>URL</code>中存在<code>'#'</code>，用<code>'history'</code>模式就能解决这个问题。但是<code>history</code>模式会出现刷新页面后，页面出现404。解决的办法是用<code>nginx</code>配置一下。
在<code>nginx</code>的配置文件中修改</p>
<p><strong>方法一：</strong></p>
<div><pre><code>location <span>/</span><span>{</span>
    root   <span>/</span>data<span>/</span>nginx<span>/</span>html<span>;</span>
    index  index.html index.htm<span>;</span>
    <span>if</span> <span>(</span><span>!</span><span>-</span>e <span>$request_filename</span><span>)</span> <span>{</span>
        rewrite <span>^</span><span>/(.*) /</span>index.html last<span>;</span>
        <span>break</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>方法二：</strong>
vue.js官方教程里提到的</p>
<p><a href="https://router.vuejs.org/zh/guide/essentials/history-mode.html" target="_blank" rel="noopener noreferrer">https://router.vuejs.org/zh/guide/essentials/history-mode.html</a></p>
<div><pre><code>  <span><span>server</span></span> <span>{</span>
		<span><span>listen</span>       <span>80</span></span><span>;</span>
        <span><span>server_name</span>  localhost</span><span>;</span>
        
    	<span><span>location</span> /</span> <span>{</span>
            <span><span>root</span>   html</span><span>;</span>
            <span># 第一种方法</span>
            <span><span>try_files</span> <span>$uri</span> <span>$uri</span>/ /index.html</span><span>;</span>
            <span># 第二种方法，需要指向下面的@router否则会出现vue的路由在nginx中刷新出现404</span>
            <span>#try_files $uri $uri/ @router;</span>
            <span><span>index</span>  index.html index.htm</span><span>;</span>
        <span>}</span>
        <span>#对应上面的@router，主要原因是路由的路径资源并不是一个真实的路径，所以无法找到具体的文件</span>
        <span>#因此需要rewrite到index.html中，然后交给路由在处理请求资源</span>
        <span><span>location</span> @router</span> <span>{</span>
            <span><span>rewrite</span> ^.*$ /index.html last</span><span>;</span>
        <span>}</span> 
  <span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p><strong>方案三</strong></p>
<p>去掉这行代码。url上会出现带有#的地址。</p>
<div><pre><code>mode: 'history',
</code></pre><div aria-hidden="true"><div></div></div></div><h2 id="_1-spring-boot集成druid异常discard-long-time-none-received-connection" tabindex="-1"> 1.Spring Boot集成Druid异常discard long time none received connection.</h2>
<blockquote>
<p>2022年2月6日15:54:03</p>
</blockquote>
<h3 id="spring-boot集成druid异常" tabindex="-1"> Spring Boot集成Druid异常</h3>
<p>在Spring Boot集成Druid项目中，发现错误日志中频繁的出现如下错误信息：</p>
<div><pre><code>discard <span>long</span> time none received connection<span>.</span> <span>,</span> jdbcUrl <span>:</span> jdbc<span>:</span>mysql<span>:</span><span>/</span><span>/******?useSSL=false&amp;allowPublicKeyRetrieval=true&amp;useUnicode=true&amp;characterEncoding=UTF-8, version : 1.2.3, lastPacketReceivedIdleMillis : 172675
</span></code></pre><div aria-hidden="true"><div></div></div></div><p>经过排查发现是Druid版本导致的异常，在1.2.2及以前版本并未出现如此异常。而在其以上版本均存在此问题，下面就来分析一下异常原因及解决方案。</p>
<h3 id="异常分析" tabindex="-1"> 异常分析</h3>
<p>首先上面的异常并不影响程序的正常运行，但作为程序员看到程序中不停的出现异常还是难以忍受的。所以还是要刨根问底的解决一下的。</p>
<p>跟踪堆栈信息会发现对应的异常是从com.alibaba.druid.pool.DruidAbstractDataSource#testConnectionInternal方法中抛出的，对应的代码如下：</p>
<div><pre><code><span>if</span> <span>(</span>valid <span>&amp;&amp;</span> isMySql<span>)</span> <span>{</span> <span>// unexcepted branch</span>
    <span>long</span> lastPacketReceivedTimeMs <span>=</span> <span>MySqlUtils</span><span>.</span><span>getLastPacketReceivedTimeMs</span><span>(</span>conn<span>)</span><span>;</span>
    <span>if</span> <span>(</span>lastPacketReceivedTimeMs <span>></span> <span>0</span><span>)</span> <span>{</span>
        <span>long</span> mysqlIdleMillis <span>=</span> currentTimeMillis <span>-</span> lastPacketReceivedTimeMs<span>;</span>
        <span>if</span> <span>(</span>lastPacketReceivedTimeMs <span>></span> <span>0</span> <span>//</span>
                <span>&amp;&amp;</span> mysqlIdleMillis <span>>=</span> timeBetweenEvictionRunsMillis<span>)</span> <span>{</span>
            <span>discardConnection</span><span>(</span>holder<span>)</span><span>;</span>
            <span>String</span> errorMsg <span>=</span> <span>"discard long time none received connection. "</span>
                    <span>+</span> <span>", jdbcUrl : "</span> <span>+</span> jdbcUrl
                    <span>+</span> <span>", jdbcUrl : "</span> <span>+</span> jdbcUrl
                    <span>+</span> <span>", lastPacketReceivedIdleMillis : "</span> <span>+</span> mysqlIdleMillis<span>;</span>
            LOG<span>.</span><span>error</span><span>(</span>errorMsg<span>)</span><span>;</span>
            <span>return</span> <span>false</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>上述代码中，MySqlUtils.getLastPacketReceivedTimeMs(conn) 是获取上一次使用的时间，mysqlIdleMillis 就是计算出来空闲的时间，timeBetweenEvictionRunsMillis 是常量60秒。如果连接空闲了60秒以上，那就discardConnection(holder) 丢弃这个旧连接并顺带打印了一个日志LOG.warn(errorMsg)。</p>
<h3 id="原理追踪" tabindex="-1"> 原理追踪</h3>
<p>在上述代码中，我们看到进入该业务逻辑是有前提条件的，也就是valid和isMySql变量同时为true。isMySql为true是必须的，我们使用的本身就是<a href="https://cloud.tencent.com/product/cdb?from=10680" target="_blank" rel="noopener noreferrer">Mysql</a><a href="https://cloud.tencent.com/solution/database?from=10680" target="_blank" rel="noopener noreferrer">数据库</a>。那么是否可以让valid为false呢？这样不就不会进入该业务处理了吗？</p>
<p>来看看valid的来源，还是在该方法的上面：</p>
<div><pre><code><span>boolean</span> valid <span>=</span> validConnectionChecker<span>.</span><span>isValidConnection</span><span>(</span>conn<span>,</span> validationQuery<span>,</span> validationQueryTimeout<span>)</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>我们找到validConnectionChecker的Mysql实现子类MySqlValidConnectionChecker，该类中对isValidConnection的实现如下：</p>
<div><pre><code><span>public</span> <span>boolean</span> <span>isValidConnection</span><span>(</span><span>Connection</span> conn<span>,</span> <span>String</span> validateQuery<span>,</span> <span>int</span> validationQueryTimeout<span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
    <span>if</span> <span>(</span>conn<span>.</span><span>isClosed</span><span>(</span><span>)</span><span>)</span> <span>{</span>
        <span>return</span> <span>false</span><span>;</span>
    <span>}</span>

    <span>if</span> <span>(</span>usePingMethod<span>)</span> <span>{</span>
        <span>if</span> <span>(</span>conn <span>instanceof</span> <span>DruidPooledConnection</span><span>)</span> <span>{</span>
            conn <span>=</span> <span>(</span><span>(</span><span>DruidPooledConnection</span><span>)</span> conn<span>)</span><span>.</span><span>getConnection</span><span>(</span><span>)</span><span>;</span>
        <span>}</span>

        <span>if</span> <span>(</span>conn <span>instanceof</span> <span>ConnectionProxy</span><span>)</span> <span>{</span>
            conn <span>=</span> <span>(</span><span>(</span><span>ConnectionProxy</span><span>)</span> conn<span>)</span><span>.</span><span>getRawObject</span><span>(</span><span>)</span><span>;</span>
        <span>}</span>

        <span>if</span> <span>(</span>clazz<span>.</span><span>isAssignableFrom</span><span>(</span>conn<span>.</span><span>getClass</span><span>(</span><span>)</span><span>)</span><span>)</span> <span>{</span>
            <span>if</span> <span>(</span>validationQueryTimeout <span>&lt;=</span> <span>0</span><span>)</span> <span>{</span>
                validationQueryTimeout <span>=</span> DEFAULT_VALIDATION_QUERY_TIMEOUT<span>;</span>
            <span>}</span>

            <span>try</span> <span>{</span>
                ping<span>.</span><span>invoke</span><span>(</span>conn<span>,</span> <span>true</span><span>,</span> validationQueryTimeout <span>*</span> <span>1000</span><span>)</span><span>;</span>
            <span>}</span> <span>catch</span> <span>(</span><span>InvocationTargetException</span> e<span>)</span> <span>{</span>
                <span>Throwable</span> cause <span>=</span> e<span>.</span><span>getCause</span><span>(</span><span>)</span><span>;</span>
                <span>if</span> <span>(</span>cause <span>instanceof</span> <span>SQLException</span><span>)</span> <span>{</span>
                    <span>throw</span> <span>(</span><span>SQLException</span><span>)</span> cause<span>;</span>
                <span>}</span>
                <span>throw</span> e<span>;</span>
            <span>}</span>
            <span>return</span> <span>true</span><span>;</span>
        <span>}</span>
    <span>}</span>

    <span>String</span> query <span>=</span> validateQuery<span>;</span>
    <span>if</span> <span>(</span>validateQuery <span>==</span> <span>null</span> <span>||</span> validateQuery<span>.</span><span>isEmpty</span><span>(</span><span>)</span><span>)</span> <span>{</span>
        query <span>=</span> DEFAULT_VALIDATION_QUERY<span>;</span>
    <span>}</span>

    <span>Statement</span> stmt <span>=</span> <span>null</span><span>;</span>
    <span>ResultSet</span> rs <span>=</span> <span>null</span><span>;</span>
    <span>try</span> <span>{</span>
        stmt <span>=</span> conn<span>.</span><span>createStatement</span><span>(</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span>validationQueryTimeout <span>></span> <span>0</span><span>)</span> <span>{</span>
            stmt<span>.</span><span>setQueryTimeout</span><span>(</span>validationQueryTimeout<span>)</span><span>;</span>
        <span>}</span>
        rs <span>=</span> stmt<span>.</span><span>executeQuery</span><span>(</span>query<span>)</span><span>;</span>
        <span>return</span> <span>true</span><span>;</span>
    <span>}</span> <span>finally</span> <span>{</span>
        <span>JdbcUtils</span><span>.</span><span>close</span><span>(</span>rs<span>)</span><span>;</span>
        <span>JdbcUtils</span><span>.</span><span>close</span><span>(</span>stmt<span>)</span><span>;</span>
    <span>}</span>

<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>我们可以看到上述方法中有三个返回的地方：第一个连接已关闭；第二个使用ping的形式进行检查；第三，使用select 1的方式进行检查。而使用ping的形式检查时，无论是否抛异常都会返回true。这里我们禁用该模式即可。</p>
<p>进入ping的业务逻辑主要靠变量usePingMethod来判断，追踪代码会发现在这里进行的设置：</p>
<div><pre><code><span>public</span> <span>void</span> <span>configFromProperties</span><span>(</span><span>Properties</span> properties<span>)</span> <span>{</span>
    <span>String</span> property <span>=</span> properties<span>.</span><span>getProperty</span><span>(</span><span>"druid.mysql.usePingMethod"</span><span>)</span><span>;</span>
    <span>if</span> <span>(</span><span>"true"</span><span>.</span><span>equals</span><span>(</span>property<span>)</span><span>)</span> <span>{</span>
        <span>setUsePingMethod</span><span>(</span><span>true</span><span>)</span><span>;</span>
    <span>}</span> <span>else</span> <span>if</span> <span>(</span><span>"false"</span><span>.</span><span>equals</span><span>(</span>property<span>)</span><span>)</span> <span>{</span>
        <span>setUsePingMethod</span><span>(</span><span>false</span><span>)</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>那么，也就是说，当我们把系统属性druid.mysql.usePingMethod设置为false即可禁用该功能。</p>
<h3 id="禁用ping-method" tabindex="-1"> 禁用Ping Method</h3>
<p>找到了问题的根源，那么剩下的就是如何禁用了，通常有三种形式。</p>
<p>第一，在启动程序时在运行参数中增加：-Ddruid.mysql.usePingMethod=false。</p>
<p>第二，在Spring Boot项目中，可在启动类中添加如下静态代码快：</p>
<div><pre><code><span>static</span> <span>{</span>
    <span>System</span><span>.</span><span>setProperty</span><span>(</span><span>"druid.mysql.usePingMethod"</span><span>,</span><span>"false"</span><span>)</span><span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div></div></div><p>第三，类文件配置。在项目的DruidConfig类中新增加：</p>
<div><pre><code><span>/*
* 解决druid 日志报错：discard long time none received connection:xxx
* */</span>
<span>@PostConstruct</span>
<span>public</span> <span>void</span> <span>setProperties</span><span>(</span><span>)</span><span>{</span>
    <span>System</span><span>.</span><span>setProperty</span><span>(</span><span>"druid.mysql.usePingMethod"</span><span>,</span><span>"false"</span><span>)</span><span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><p>至此，已可以成功关闭该功能，异常信息再也不会出现了。</p>
<h3 id="为什么要清空空闲60秒以上的连接" tabindex="-1"> 为什么要清空空闲60秒以上的连接</h3>
<p>猜测，阿里给数据库设置的数据库空闲等待时间是60秒，mysql数据库到了空闲等待时间将关闭空闲的连接，以提升数据库服务器的处理能力。</p>
<p>MySQL的默认空闲等待时间是8小时，就是「wait_timeout」的配置值。如果数据库主动关闭了空闲的连接，而连接池并不知道，还在使用这个连接，就会产生异常。</p>
<h2 id="_2-数据库语句错误" tabindex="-1"> 2.数据库语句错误</h2>
<p>1.limit放在where后面</p>
<p>正确：</p>
<div><pre><code><span>select</span> <span>*</span> <span>from</span> <span>table</span> <span>where</span> <span>delete</span><span>=</span><span>1</span> <span>limit</span> <span>1</span><span>,</span><span>5</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div><p>错误：</p>
<div><pre><code><span>select</span> <span>*</span> <span>from</span> <span>table</span> <span>limit</span> <span>1</span><span>,</span><span>5</span> <span>where</span> <span>delete</span><span>=</span><span>1</span><span>;</span>
</code></pre><div aria-hidden="true"><div></div></div></div>]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-02-20T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
  <entry>
    <title type="html">数据库表结构文档生成工具</title>
    <id>https://blog.ciberviler.top/dev/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E7%BB%93%E6%9E%84%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7.html</id>
    <link href="https://blog.ciberviler.top/dev/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E7%BB%93%E6%9E%84%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7.html"/>
    <updated>2022-05-21T09:03:15.000Z</updated>
    <summary type="html">数据库表结构文档生成工具</summary>
    <content type="html"><![CDATA[<h1 id="数据库表结构文档生成工具" tabindex="-1"> 数据库表结构文档生成工具</h1>
<h2 id="特点" tabindex="-1"> 特点</h2>
<ul>
<li>
<p>简洁、轻量、设计良好</p>
</li>
<li>
<p>多数据库支持</p>
</li>
<li>
<p>多种格式文档</p>
</li>
<li>
<p>灵活扩展</p>
</li>
<li>
<p>支持自定义模板</p>
</li>
</ul>
<h2 id="数据库支持" tabindex="-1"> 数据库支持</h2>
<ul>
<li><input type="checkbox" id="task-item-0" checked="checked" disabled="disabled"><label for="task-item-0"> MySQL</label></li>
<li><input type="checkbox" id="task-item-1" checked="checked" disabled="disabled"><label for="task-item-1"> MariaDB</label></li>
<li><input type="checkbox" id="task-item-2" checked="checked" disabled="disabled"><label for="task-item-2"> TIDB</label></li>
<li><input type="checkbox" id="task-item-3" checked="checked" disabled="disabled"><label for="task-item-3"> Oracle</label></li>
<li><input type="checkbox" id="task-item-4" checked="checked" disabled="disabled"><label for="task-item-4"> SqlServer</label></li>
<li><input type="checkbox" id="task-item-5" checked="checked" disabled="disabled"><label for="task-item-5"> PostgreSQL</label></li>
<li><input type="checkbox" id="task-item-6" checked="checked" disabled="disabled"><label for="task-item-6"> Cache DB（2016）</label></li>
<li><input type="checkbox" id="task-item-7" disabled="disabled"><label for="task-item-7"> H2 （开发中）</label></li>
<li><input type="checkbox" id="task-item-8" disabled="disabled"><label for="task-item-8"> DB2  （开发中）</label></li>
<li><input type="checkbox" id="task-item-9" disabled="disabled"><label for="task-item-9"> HSQL  （开发中）</label></li>
<li><input type="checkbox" id="task-item-10" disabled="disabled"><label for="task-item-10"> SQLite（开发中）</label></li>
<li><input type="checkbox" id="task-item-11" disabled="disabled"><label for="task-item-11"> 瀚高（开发中）</label></li>
<li><input type="checkbox" id="task-item-12" disabled="disabled"><label for="task-item-12"> 达梦 （开发中）</label></li>
<li><input type="checkbox" id="task-item-13" disabled="disabled"><label for="task-item-13"> 虚谷  （开发中）</label></li>
<li><input type="checkbox" id="task-item-14" disabled="disabled"><label for="task-item-14"> 人大金仓（开发中）</label></li>
</ul>
<h2 id="文档生成支持" tabindex="-1"> 文档生成支持</h2>
<ul>
<li><input type="checkbox" id="task-item-15" checked="checked" disabled="disabled"><label for="task-item-15"> html</label></li>
<li><input type="checkbox" id="task-item-16" checked="checked" disabled="disabled"><label for="task-item-16"> word</label></li>
<li><input type="checkbox" id="task-item-17" checked="checked" disabled="disabled"><label for="task-item-17"> markdown</label></li>
</ul>
<h2 id="文档截图" tabindex="-1"> 文档截图</h2>
<ul>
<li><strong>html</strong></li>
</ul>
<p align="center">
   <img alt="HTML" src="https://images.gitee.com/uploads/images/2020/0622/161414_74cd0b68_1407605.png">
</p>
<p align="center">
   <img alt="screw-logo" src="https://images.gitee.com/uploads/images/2020/0622/161723_6da58c41_1407605.png">
</p>
<ul>
<li><strong>word</strong></li>
</ul>
<p align="center">
   <img alt="word" src="https://images.gitee.com/uploads/images/2020/0625/200946_1dc0717f_1407605.png">
</p>
<ul>
<li><strong>markdwon</strong></li>
</ul>
<p align="center">
   <img alt="markdwon" src="https://images.gitee.com/uploads/images/2020/0625/214749_7b15d8bd_1407605.png">
</p>
<p align="center">
   <img alt="markdwon" src="https://images.gitee.com/uploads/images/2020/0625/215006_3601e135_1407605.png">
</p>
<h2 id="使用方式" tabindex="-1"> 使用方式</h2>
<h3 id="普通方式" tabindex="-1"> 普通方式</h3>
<ul>
<li><strong>引入依赖</strong></li>
</ul>
<div><pre><code><span><span><span>&lt;</span>dependency</span><span>></span></span>
    <span><span><span>&lt;</span>groupId</span><span>></span></span>cn.smallbun.screw<span><span><span>&lt;/</span>groupId</span><span>></span></span>
    <span><span><span>&lt;</span>artifactId</span><span>></span></span>screw-core<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
    <span><span><span>&lt;</span>version</span><span>></span></span>${lastVersion}<span><span><span>&lt;/</span>version</span><span>></span></span>
 <span><span><span>&lt;/</span>dependency</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li><strong>编写代码</strong></li>
</ul>
<div><pre><code><span>/**
 * 文档生成
 */</span>
<span>void</span> <span>documentGeneration</span><span>(</span><span>)</span> <span>{</span>
   <span>//数据源</span>
   <span>HikariConfig</span> hikariConfig <span>=</span> <span>new</span> <span>HikariConfig</span><span>(</span><span>)</span><span>;</span>
   hikariConfig<span>.</span><span>setDriverClassName</span><span>(</span><span>"com.mysql.cj.jdbc.Driver"</span><span>)</span><span>;</span>
   hikariConfig<span>.</span><span>setJdbcUrl</span><span>(</span><span>"jdbc:mysql://127.0.0.1:3306/database"</span><span>)</span><span>;</span>
   hikariConfig<span>.</span><span>setUsername</span><span>(</span><span>"root"</span><span>)</span><span>;</span>
   hikariConfig<span>.</span><span>setPassword</span><span>(</span><span>"password"</span><span>)</span><span>;</span>
   <span>//设置可以获取tables remarks信息</span>
   hikariConfig<span>.</span><span>addDataSourceProperty</span><span>(</span><span>"useInformationSchema"</span><span>,</span> <span>"true"</span><span>)</span><span>;</span>
   hikariConfig<span>.</span><span>setMinimumIdle</span><span>(</span><span>2</span><span>)</span><span>;</span>
   hikariConfig<span>.</span><span>setMaximumPoolSize</span><span>(</span><span>5</span><span>)</span><span>;</span>
   <span>DataSource</span> dataSource <span>=</span> <span>new</span> <span>HikariDataSource</span><span>(</span>hikariConfig<span>)</span><span>;</span>
   <span>//生成配置</span>
   <span>EngineConfig</span> engineConfig <span>=</span> <span>EngineConfig</span><span>.</span><span>builder</span><span>(</span><span>)</span>
         <span>//生成文件路径</span>
         <span>.</span><span>fileOutputDir</span><span>(</span>fileOutputDir<span>)</span>
         <span>//打开目录</span>
         <span>.</span><span>openOutputDir</span><span>(</span><span>true</span><span>)</span>
         <span>//文件类型</span>
         <span>.</span><span>fileType</span><span>(</span><span>EngineFileType</span><span>.</span>HTML<span>)</span>
         <span>//生成模板实现</span>
         <span>.</span><span>produceType</span><span>(</span><span>EngineTemplateType</span><span>.</span>freemarker<span>)</span>
         <span>//自定义文件名称</span>
         <span>.</span><span>fileName</span><span>(</span><span>"自定义文件名称"</span><span>)</span><span>.</span><span>build</span><span>(</span><span>)</span><span>;</span>

   <span>//忽略表</span>
   <span>ArrayList</span><span><span>&lt;</span><span>String</span><span>></span></span> ignoreTableName <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
   ignoreTableName<span>.</span><span>add</span><span>(</span><span>"test_user"</span><span>)</span><span>;</span>
   ignoreTableName<span>.</span><span>add</span><span>(</span><span>"test_group"</span><span>)</span><span>;</span>
   <span>//忽略表前缀</span>
   <span>ArrayList</span><span><span>&lt;</span><span>String</span><span>></span></span> ignorePrefix <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
   ignorePrefix<span>.</span><span>add</span><span>(</span><span>"test_"</span><span>)</span><span>;</span>
   <span>//忽略表后缀    </span>
   <span>ArrayList</span><span><span>&lt;</span><span>String</span><span>></span></span> ignoreSuffix <span>=</span> <span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>;</span>
   ignoreSuffix<span>.</span><span>add</span><span>(</span><span>"_test"</span><span>)</span><span>;</span>
   <span>ProcessConfig</span> processConfig <span>=</span> <span>ProcessConfig</span><span>.</span><span>builder</span><span>(</span><span>)</span>
         <span>//指定生成逻辑、当存在指定表、指定表前缀、指定表后缀时，将生成指定表，其余表不生成、并跳过忽略表配置	</span>
		 <span>//根据名称指定表生成</span>
		 <span>.</span><span>designatedTableName</span><span>(</span><span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>)</span>
		 <span>//根据表前缀生成</span>
		 <span>.</span><span>designatedTablePrefix</span><span>(</span><span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>)</span>
		 <span>//根据表后缀生成	</span>
		 <span>.</span><span>designatedTableSuffix</span><span>(</span><span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>)</span>
         <span>//忽略表名</span>
         <span>.</span><span>ignoreTableName</span><span>(</span>ignoreTableName<span>)</span>
         <span>//忽略表前缀</span>
         <span>.</span><span>ignoreTablePrefix</span><span>(</span>ignorePrefix<span>)</span>
         <span>//忽略表后缀</span>
         <span>.</span><span>ignoreTableSuffix</span><span>(</span>ignoreSuffix<span>)</span><span>.</span><span>build</span><span>(</span><span>)</span><span>;</span>
   <span>//配置</span>
   <span>Configuration</span> config <span>=</span> <span>Configuration</span><span>.</span><span>builder</span><span>(</span><span>)</span>
         <span>//版本</span>
         <span>.</span><span>version</span><span>(</span><span>"1.0.0"</span><span>)</span>
         <span>//描述</span>
         <span>.</span><span>description</span><span>(</span><span>"数据库设计文档生成"</span><span>)</span>
         <span>//数据源</span>
         <span>.</span><span>dataSource</span><span>(</span>dataSource<span>)</span>
         <span>//生成配置</span>
         <span>.</span><span>engineConfig</span><span>(</span>engineConfig<span>)</span>
         <span>//生成配置</span>
         <span>.</span><span>produceConfig</span><span>(</span>processConfig<span>)</span>
         <span>.</span><span>build</span><span>(</span><span>)</span><span>;</span>
   <span>//执行生成</span>
   <span>new</span> <span>DocumentationExecute</span><span>(</span>config<span>)</span><span>.</span><span>execute</span><span>(</span><span>)</span><span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="maven-插件" tabindex="-1"> Maven 插件</h3>
<div><pre><code><span><span><span>&lt;</span>build</span><span>></span></span>
    <span><span><span>&lt;</span>plugins</span><span>></span></span>
        <span><span><span>&lt;</span>plugin</span><span>></span></span>
            <span><span><span>&lt;</span>groupId</span><span>></span></span>cn.smallbun.screw<span><span><span>&lt;/</span>groupId</span><span>></span></span>
            <span><span><span>&lt;</span>artifactId</span><span>></span></span>screw-maven-plugin<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
            <span><span><span>&lt;</span>version</span><span>></span></span>${lastVersion}<span><span><span>&lt;/</span>version</span><span>></span></span>
            <span><span><span>&lt;</span>dependencies</span><span>></span></span>
                <span>&lt;!-- HikariCP --></span>
                <span><span><span>&lt;</span>dependency</span><span>></span></span>
                    <span><span><span>&lt;</span>groupId</span><span>></span></span>com.zaxxer<span><span><span>&lt;/</span>groupId</span><span>></span></span>
                    <span><span><span>&lt;</span>artifactId</span><span>></span></span>HikariCP<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
                    <span><span><span>&lt;</span>version</span><span>></span></span>3.4.5<span><span><span>&lt;/</span>version</span><span>></span></span>
                <span><span><span>&lt;/</span>dependency</span><span>></span></span>
                <span>&lt;!--mysql driver--></span>
                <span><span><span>&lt;</span>dependency</span><span>></span></span>
                    <span><span><span>&lt;</span>groupId</span><span>></span></span>mysql<span><span><span>&lt;/</span>groupId</span><span>></span></span>
                    <span><span><span>&lt;</span>artifactId</span><span>></span></span>mysql-connector-java<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
                    <span><span><span>&lt;</span>version</span><span>></span></span>8.0.20<span><span><span>&lt;/</span>version</span><span>></span></span>
                <span><span><span>&lt;/</span>dependency</span><span>></span></span>
            <span><span><span>&lt;/</span>dependencies</span><span>></span></span>
            <span><span><span>&lt;</span>configuration</span><span>></span></span>
                <span>&lt;!--username--></span>
                <span><span><span>&lt;</span>username</span><span>></span></span>root<span><span><span>&lt;/</span>username</span><span>></span></span>
                <span>&lt;!--password--></span>
                <span><span><span>&lt;</span>password</span><span>></span></span>password<span><span><span>&lt;/</span>password</span><span>></span></span>
                <span>&lt;!--driver--></span>
                <span><span><span>&lt;</span>driverClassName</span><span>></span></span>com.mysql.cj.jdbc.Driver<span><span><span>&lt;/</span>driverClassName</span><span>></span></span>
                <span>&lt;!--jdbc url--></span>
                <span><span><span>&lt;</span>jdbcUrl</span><span>></span></span>jdbc:mysql://127.0.0.1:3306/xxxx<span><span><span>&lt;/</span>jdbcUrl</span><span>></span></span>
                <span>&lt;!--生成文件类型--></span>
                <span><span><span>&lt;</span>fileType</span><span>></span></span>HTML<span><span><span>&lt;/</span>fileType</span><span>></span></span>
                <span>&lt;!--打开文件输出目录--></span>
                <span><span><span>&lt;</span>openOutputDir</span><span>></span></span>false<span><span><span>&lt;/</span>openOutputDir</span><span>></span></span>
                <span>&lt;!--生成模板--></span>
                <span><span><span>&lt;</span>produceType</span><span>></span></span>freemarker<span><span><span>&lt;/</span>produceType</span><span>></span></span>
                <span>&lt;!--文档名称 为空时:将采用[数据库名称-描述-版本号]作为文档名称--></span>
                <span><span><span>&lt;</span>fileName</span><span>></span></span>测试文档名称<span><span><span>&lt;/</span>fileName</span><span>></span></span>
                <span>&lt;!--描述--></span>
                <span><span><span>&lt;</span>description</span><span>></span></span>数据库文档生成<span><span><span>&lt;/</span>description</span><span>></span></span>
                <span>&lt;!--版本--></span>
                <span><span><span>&lt;</span>version</span><span>></span></span>${project.version}<span><span><span>&lt;/</span>version</span><span>></span></span>
                <span>&lt;!--标题--></span>
                <span><span><span>&lt;</span>title</span><span>></span></span>数据库文档<span><span><span>&lt;/</span>title</span><span>></span></span>
            <span><span><span>&lt;/</span>configuration</span><span>></span></span>
            <span><span><span>&lt;</span>executions</span><span>></span></span>
                <span><span><span>&lt;</span>execution</span><span>></span></span>
                    <span><span><span>&lt;</span>phase</span><span>></span></span>compile<span><span><span>&lt;/</span>phase</span><span>></span></span>
                    <span><span><span>&lt;</span>goals</span><span>></span></span>
                        <span><span><span>&lt;</span>goal</span><span>></span></span>run<span><span><span>&lt;/</span>goal</span><span>></span></span>
                    <span><span><span>&lt;/</span>goals</span><span>></span></span>
                <span><span><span>&lt;/</span>execution</span><span>></span></span>
            <span><span><span>&lt;/</span>executions</span><span>></span></span>
        <span><span><span>&lt;/</span>plugin</span><span>></span></span>
    <span><span><span>&lt;/</span>plugins</span><span>></span></span>
<span><span><span>&lt;/</span>build</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h3 id="使用文章" tabindex="-1"> 使用文章</h3>
<ul>
<li>
<p><a href="https://my.oschina.net/mdxlcj/blog/4341399" target="_blank" rel="noopener noreferrer">SpringBoot整合screw生成数据库文档</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/Bo_U5_cl82hfQ6GmRs2vtA" target="_blank" rel="noopener noreferrer">还在手动整理数据库文档？试试这个工具</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/nPwFV7DN8Ogg54_crLlP3g" target="_blank" rel="noopener noreferrer">实用！一键生成数据库文档，堪称数据库界的Swagger</a></p>
</li>
</ul>
<h3 id="使用视频" tabindex="-1"> 使用视频</h3>
<ul>
<li>
<p><a href="https://www.bilibili.com/video/av456302504/" target="_blank" rel="noopener noreferrer">使用screw数据库文档生成工具快速生成数据库文档</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/rUde6XSGSG0jKuy0Wgf1Mw" target="_blank" rel="noopener noreferrer">微人事一键生成数据库文档！炫！</a></p>
</li>
</ul>
<h2 id="扩展模块" tabindex="-1"> 扩展模块</h2>
<h3 id="pojo生成功能" tabindex="-1"> pojo生成功能</h3>
<h4 id="功能简介" tabindex="-1"> 功能简介</h4>
<p>  pojo生成功能是基于screw延伸出的扩展模块,目前处于初步开发的状态。在日常的开发中,经过需求分析、建模之后,往往会先在数据库中建表,其次在进行代码的开发。那么pojo生成功能在这个阶段就可以帮助大家节省一些重复劳动了。使用pojo生成功能可以直接根据数据库生成对应的java pojo对象。这样后续的修改，开发都会很方便。</p>
<h4 id="数据库支持-1" tabindex="-1"> 数据库支持</h4>
<ul>
<li><input type="checkbox" id="task-item-18" checked="checked" disabled="disabled"><label for="task-item-18"> MySQL</label></li>
</ul>
<h4 id="使用方式-1" tabindex="-1"> 使用方式</h4>
<ul>
<li><strong>引入依赖</strong></li>
</ul>
<div><pre><code><span><span><span>&lt;</span>dependency</span><span>></span></span>
    <span><span><span>&lt;</span>groupId</span><span>></span></span>cn.smallbun.screw<span><span><span>&lt;/</span>groupId</span><span>></span></span>
    <span><span><span>&lt;</span>artifactId</span><span>></span></span>screw-extension<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
    <span><span><span>&lt;</span>version</span><span>></span></span>${lastVersion}<span><span><span>&lt;/</span>version</span><span>></span></span>
 <span><span><span>&lt;/</span>dependency</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div></div></div><ul>
<li><strong>编写代码</strong></li>
</ul>
<div><pre><code><span>/**
 * pojo生成
 */</span>
<span>void</span> <span>pojoGeneration</span><span>(</span><span>)</span> <span>{</span>
    <span>//数据源</span>
    <span>HikariConfig</span> hikariConfig <span>=</span> <span>new</span> <span>HikariConfig</span><span>(</span><span>)</span><span>;</span>
    hikariConfig<span>.</span><span>setDriverClassName</span><span>(</span><span>"com.mysql.cj.jdbc.Driver"</span><span>)</span><span>;</span>
    hikariConfig<span>.</span><span>setJdbcUrl</span><span>(</span><span>"jdbc:mysql://127.0.0.1:3306/screw"</span><span>)</span><span>;</span>
    hikariConfig<span>.</span><span>setUsername</span><span>(</span><span>"screw"</span><span>)</span><span>;</span>
    hikariConfig<span>.</span><span>setPassword</span><span>(</span><span>"screw"</span><span>)</span><span>;</span>
    <span>//设置可以获取tables remarks信息</span>
    hikariConfig<span>.</span><span>addDataSourceProperty</span><span>(</span><span>"useInformationSchema"</span><span>,</span> <span>"true"</span><span>)</span><span>;</span>
    hikariConfig<span>.</span><span>setMinimumIdle</span><span>(</span><span>2</span><span>)</span><span>;</span>
    hikariConfig<span>.</span><span>setMaximumPoolSize</span><span>(</span><span>5</span><span>)</span><span>;</span>
    <span>DataSource</span> dataSource <span>=</span> <span>new</span> <span>HikariDataSource</span><span>(</span>hikariConfig<span>)</span><span>;</span>

    <span>ProcessConfig</span> processConfig <span>=</span> <span>ProcessConfig</span><span>.</span><span>builder</span><span>(</span><span>)</span>
        <span>//指定生成逻辑、当存在指定表、指定表前缀、指定表后缀时，将生成指定表，其余表不生成、并跳过忽略表配置</span>
        <span>//根据名称指定表生成</span>
        <span>.</span><span>designatedTableName</span><span>(</span><span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>)</span>
        <span>//根据表前缀生成</span>
        <span>.</span><span>designatedTablePrefix</span><span>(</span><span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>)</span>
        <span>//根据表后缀生成</span>
        <span>.</span><span>designatedTableSuffix</span><span>(</span><span>new</span> <span>ArrayList</span><span><span>&lt;</span><span>></span></span><span>(</span><span>)</span><span>)</span><span>.</span><span>build</span><span>(</span><span>)</span><span>;</span>

    <span>//设置生成pojo相关配置</span>
    <span>PojoConfiguration</span> config <span>=</span> <span>new</span> <span>PojoConfiguration</span><span>(</span><span>)</span><span>;</span>
    <span>//设置文件存放路径</span>
    config<span>.</span><span>setPath</span><span>(</span><span>"/cn/smallbun/screw/"</span><span>)</span><span>;</span>
    <span>//设置包名</span>
    config<span>.</span><span>setPackageName</span><span>(</span><span>"cn.smallbun.screw"</span><span>)</span><span>;</span>
    <span>//设置是否使用lombok</span>
    config<span>.</span><span>setUseLombok</span><span>(</span><span>false</span><span>)</span><span>;</span>
    <span>//设置数据源</span>
    config<span>.</span><span>setDataSource</span><span>(</span>dataSource<span>)</span><span>;</span>
    <span>//设置命名策略</span>
    config<span>.</span><span>setNameStrategy</span><span>(</span><span>new</span> <span>HumpNameStrategy</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>//设置表过滤逻辑</span>
    config<span>.</span><span>setProcessConfig</span><span>(</span>processConfig<span>)</span><span>;</span>
    <span>//执行生成</span>
    <span>new</span> <span>PojoExecute</span><span>(</span>config<span>)</span><span>.</span><span>execute</span><span>(</span><span>)</span><span>;</span>
<span>}</span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><h2 id="常见问题" tabindex="-1"> 常见问题</h2>
<ul>
<li>
<p>生成后文档乱码？</p>
<p>MySQL：URL加入<code>?characterEncoding=UTF-8</code>。</p>
</li>
<li>
<p>Caused by: java.lang.NoSuchFieldError: VERSION_2_3_30？</p>
<p>检查项目<code>freemarker</code>依赖，这是由于版本过低造成的，升级版本为<code>2.3.30</code>即可。</p>
</li>
<li>
<p>java.lang.AbstractMethodError: oracle.jdbc.driver.T4CConnection.getSchema()Ljava/lang/String;</p>
<p>这是因为oracle驱动版本过低造成的，删除或屏蔽目前驱动版本，驱动添加升级为以下版本：</p>
<div><pre><code><span><span><span>&lt;</span>dependency</span><span>></span></span>
   <span><span><span>&lt;</span>groupId</span><span>></span></span>com.oracle.ojdbc<span><span><span>&lt;/</span>groupId</span><span>></span></span>
   <span><span><span>&lt;</span>artifactId</span><span>></span></span>ojdbc8<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
   <span><span><span>&lt;</span>version</span><span>></span></span>19.3.0.0<span><span><span>&lt;/</span>version</span><span>></span></span>
<span><span><span>&lt;/</span>dependency</span><span>></span></span>
<span><span><span>&lt;</span>dependency</span><span>></span></span>
   <span><span><span>&lt;</span>groupId</span><span>></span></span>cn.easyproject<span><span><span>&lt;/</span>groupId</span><span>></span></span>
   <span><span><span>&lt;</span>artifactId</span><span>></span></span>orai18n<span><span><span>&lt;/</span>artifactId</span><span>></span></span>
   <span><span><span>&lt;</span>version</span><span>></span></span>12.1.0.2.0<span><span><span>&lt;/</span>version</span><span>></span></span>
<span><span><span>&lt;/</span>dependency</span><span>></span></span>
</code></pre><div aria-hidden="true"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></li>
<li>
<p>MySQL数据库表和列字段有说明、生成文档没有说明？</p>
<p>URL链接加入<code>useInformationSchema=true</code>即可。</p>
</li>
<li>
<p>java.lang.AbstractMethodError: com.mysql.jdbc.JDBC4Connection.getSchema()Ljava/lang/String;</p>
<p>这是因为mysql驱动版本过低造成的，升级mysql驱动版本为最新即可。</p>
</li>
</ul>
]]></content>
    <author>
      <name>xlc520</name>
    </author>
    <category term="Java" scheme=""/>
    <contributor>
      <name>xlc520</name>
    </contributor>
    <published>2022-04-05T00:00:00.000Z</published>
    <rights>Copyright by xlc520</rights>
  </entry>
</feed>